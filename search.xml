<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[JDKæºç åˆ†æâ€”â€”HashMap]]></title>
    <url>%2F2018%2F09%2F03%2FJDK%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2FJDK%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94HashMap%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨Collectionæ¥å£ä¸­ç”¨çš„æœ€å¤šçš„æ˜¯ArrayListï¼Œåœ¨Mapæ¥å£ä¸­ç”¨çš„æœ€å¤šçš„ä¸€å®šæ˜¯HashMapï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥çœ‹çœ‹HashMapï¼ è¯¦ç»†æ³¨é‡Šï¼šæºç åˆ†æåœ°å€ æ¦‚è§ˆå®ƒæ˜¯åŸºäºå“ˆå¸Œè¡¨å®ç°çš„Mapæ¥å£ï¼Œå…è®¸nullçš„å€¼å’Œnullé”®ã€‚ HashMapçš„ä¸€ä¸ªå®ä¾‹æœ‰ä¸¤ä¸ªå½±å“å…¶æ€§èƒ½çš„å‚æ•°ï¼š åˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­ã€‚å®¹é‡æ˜¯å“ˆå¸Œè¡¨ä¸­çš„æ¡¶æ•°ï¼Œåˆå§‹å®¹é‡åªæ˜¯åˆ›å»ºå“ˆå¸Œè¡¨æ—¶çš„å®¹é‡ã€‚ è´Ÿè½½å› å­æ˜¯åœ¨å®¹é‡è‡ªåŠ¨å¢åŠ ä¹‹å‰å…è®¸å“ˆå¸Œè¡¨å……æ»¡ç¨‹åº¦çš„åº¦é‡ã€‚ å½“åœ¨æ•£åˆ—è¡¨ä¸­çš„æ¡ç›®çš„æ•°é‡è¶…è¿‡äº†è´Ÿè½½å› æ•°å’Œå®¹é‡çš„ä¹˜ç§¯ï¼Œå“ˆå¸Œè¡¨å°†è¢«é‡æ–°æ•£åˆ— ï¼ˆå³å†…éƒ¨æ•°æ®ç»“æ„è¢«é‡å»ºï¼‰ï¼Œä½¿å¾—å“ˆå¸Œè¡¨å…·æœ‰æ¡¶çš„å¤§çº¦ä¸¤å€ã€‚ ä½œä¸ºä¸€èˆ¬è§„åˆ™ï¼Œé»˜è®¤è´Ÿè½½å› å­ï¼ˆ0.75ï¼‰æä¾›äº†æ—¶é—´å’Œç©ºé—´æˆæœ¬ä¹‹é—´çš„è‰¯å¥½æŠ˜ä¸­ã€‚ æ›´é«˜çš„å€¼ä¼šé™ä½ç©ºé—´å¼€é”€ï¼Œä½†ä¼šå¢åŠ æŸ¥æ‰¾æˆæœ¬ï¼ˆåæ˜ åœ¨HashMapç±»çš„å¤§éƒ¨åˆ†æ“ä½œä¸­ï¼ŒåŒ…æ‹¬getå’Œput ï¼‰ã€‚ åœ¨è®¾ç½®å…¶åˆå§‹å®¹é‡æ—¶ï¼Œåº”è€ƒè™‘Mapä¸­é¢„æœŸçš„æ¡ç›®æ•°åŠå…¶è´Ÿè½½å› å­ï¼Œä»¥ä¾¿æœ€å°åŒ–é‡æ–°æ•£åˆ—æ“ä½œçš„æ•°é‡ã€‚ å¦‚æœåˆå§‹å®¹é‡å¤§äºæœ€å¤§æ¡ç›®æ•°é™¤ä»¥è´Ÿè½½å› å­ï¼Œåˆ™ä¸ä¼šå‘ç”Ÿé‡æ–°æ•£åˆ—æ“ä½œã€‚ æ³¨æ„ï¼ŒHashMapä¸åŒæ­¥ã€‚ å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å“ˆå¸Œæ˜ å°„ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨ç»“æ„ä¸Šä¿®æ”¹äº†æ˜ å°„ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»åœ¨å¤–éƒ¨è¿›è¡ŒåŒæ­¥ã€‚ ï¼ˆç»“æ„ä¿®æ”¹æ˜¯æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ˜ å°„çš„ä»»ä½•æ“ä½œ;ä»…æ”¹å˜ä¸å®ä¾‹å·²ç»åŒ…å«çš„Keyç›¸å…³è”çš„å€¼ä¸æ˜¯ç»“æ„ä¿®æ”¹ã€‚ï¼‰è¿™é€šå¸¸é€šè¿‡å¯¹è‡ªç„¶åœ°å°è£…æ˜ å°„çš„ä¸€äº›å¯¹è±¡ï¼ˆConcurrentMapç­‰ï¼‰è¿›è¡ŒåŒæ­¥æ¥å®ç°ã€‚ å¦‚æœæ²¡æœ‰è¿™æ ·çš„å¯¹è±¡å­˜åœ¨ï¼Œåº”è¯¥ä½¿ç”¨Collections.synchronizedMapæ–¹æ³•â€œåŒ…è£…â€ã€‚ æ‰€æœ‰è¿™ä¸ªç±»çš„æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨éƒ½æ˜¯å¿«é€Ÿå¤±è´¥çš„ ï¼šå¦‚æœæ˜ å°„åœ¨è¿­ä»£å™¨åˆ›å»ºä¹‹åçš„ä»»ä½•æ—¶é—´è¢«ç»“æ„åœ°ä¿®æ”¹ï¼Œé™¤äº†é€šè¿‡è¿­ä»£å™¨è‡ªå·±çš„removeæ–¹æ³•ä¹‹å¤–ï¼Œè¿­ä»£å™¨å°†æŠ›å‡ºä¸€ä¸ªConcurrentModificationException ã€‚ æ„é€ åœ¨æ„é€ æ–¹æ³•ä¸­ä¸»è¦å°±æ˜¯è®¾ç½®åˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­ï¼Œå¦‚ä¸‹é¢ï¼š123456789101112131415161718192021222324252627282930313233// æœ€å¤§å®¹é‡static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;// é»˜è®¤åˆå§‹å®¹é‡ï¼Œä¸€å®šæ˜¯2çš„næ¬¡æ–¹ï¼Œè¿™é‡Œæ˜¯16static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4;// é»˜è®¤è´Ÿè½½å› å­ï¼Œè¿™é‡Œæ˜¯0.75static final float DEFAULT_LOAD_FACTOR = 0.75f;// è¿™é‡Œæ˜¯Mapå­˜æ”¾æ¡ç›®çš„é˜ˆå€¼int threshold;// åˆå§‹çš„èŠ‚ç‚¹æ•°ç»„ï¼Œè¿™é‡ŒNodeæ˜¯ä¸ªåŒå‘èŠ‚ç‚¹é“¾è¡¨ï¼ˆä¸‹é¢æ³¨é‡Šä¸­ä¼šç›´æ¥è¯´tableï¼‰transient Node&lt;K,V&gt;[] table;public HashMap(int initialCapacity) &#123; this(initialCapacity, DEFAULT_LOAD_FACTOR);&#125;public HashMap(int initialCapacity, float loadFactor) &#123; // ... this.loadFactor = loadFactor; // å¯èƒ½å¤§å®¶è§‰å¾—é˜ˆå€¼åº”è¯¥éœ€è¦ä¹˜ä»¥è´Ÿè½½å› å­ï¼Œå…ˆåˆ«æ€¥ï¼Œå¾€åçœ‹ this.threshold = tableSizeFor(initialCapacity);&#125;// æ ¹æ®æ‰€ç»™çš„ç›®æ ‡å®¹é‡è¿”å›å¤§äºæˆ–ç­‰äº2çš„å¹‚æ¬¡æ–¹// æ„Ÿè§‰è¿™é‡ŒåŠç‚¸å¤©ï¼Œçœ‹ä¸æ‡‚çš„å¯ä»¥çœ‹åé¢å‚è€ƒçš„åšå®¢static final int tableSizeFor(int cap) &#123; // è¿™é‡Œä¸€å®šè¦å‡1ï¼Œä¸ç„¶å¯¹äºæœ¬æ¥å°±æ˜¯2çš„å¹‚æ¬¡æ–¹çš„æ•°ï¼Œä¼šå˜æˆåŸæ¥çš„ä¸¤å€ int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;&#125; è¿™é‡Œè§£ç­”ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦æ˜¯2çš„å¹‚æ¬¡æ–¹ï¼Ÿé¦–å…ˆæä¸€ä¸ªä¸œè¥¿å°±æ˜¯æ•£åˆ—åˆ°HashMapä¸­æ˜¯é€šè¿‡ä¸‹é¢çš„å…¬å¼ï¼šhash &amp;(cap-1) å‡è®¾capå®¹é‡ä¸º15ã€16ï¼Œé‚£ä¹ˆä»–ä»¬å‡1ä¹‹åçš„äºŒè¿›åˆ¶è¡¨è¾¾ä¸º1110ã€1111ï¼Œé‚£ä¹ˆ0001ã€0011ã€0101ã€0111, 1001ã€1011ã€1101è¿™äº›æ¡¶å°†æ°¸è¿œä¸ä¼šè¢«ç”¨åˆ°ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦2çš„å¹‚æ¬¡æ–¹ã€‚ è¿™é‡Œæ—¢ç„¶çœ‹åˆ°äº†hashæˆ‘ä»¬å°±çœ‹ä¸€ä¸‹HashMapçš„hashå‡½æ•°ä¼˜åŒ–ï¼š12345static final int hash(Object key) &#123; int h; // è¿™é‡Œå«æ‰°åŠ¨å‡½æ•°(åŠ å…¥é«˜ä½ç‰¹å¾)ï¼Œå‡å°‘hashç¢°æ’ï¼Œå…·ä½“çš„å¯ä»¥çœ‹åé¢å‚è€ƒé‡Œçš„æ–‡ç«  return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);&#125; å¢è¿™é‡Œä¼šæœ‰å¾ˆå¤šç»†èŠ‚ï¼Œéœ€è¦è€å¿ƒæ…¢æ…¢çœ‹ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172// hashå†²çªçš„é“¾è¡¨æ ‘åŒ–é˜ˆå€¼ï¼ˆè‡³å°‘ä¸º8ï¼‰static final int TREEIFY_THRESHOLD = 8;// ä»æ ‘è¿˜åŸä¸ºé“¾è¡¨é˜ˆå€¼ï¼ˆå°äº6ï¼‰static final int UNTREEIFY_THRESHOLD = 6;// å¢åŠ é”®å€¼å¯¹ï¼Œå¦‚æœkeyå·²å­˜åœ¨ï¼Œåˆ™è¦†ç›–public V put(K key, V value) &#123; // è¿”å›ç”Ÿæˆçš„èŠ‚ç‚¹ return putVal(hash(key), key, value, false, true);&#125;final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; // åˆå§‹èŠ‚ç‚¹æ•°ç»„tableä¸ºç©ºæˆ–è€…é•¿åº¦ä¸º0 if ((tab = table) == null || (n = tab.length) == 0) // ç”ŸæˆèŠ‚ç‚¹æ•°ç»„ï¼ˆè¿™é‡Œä¼šæ¶‰åŠåˆ°åˆå§‹åŒ–tableæˆ–æ‰©å®¹ï¼Œä¸‹é¢ä¼šè¯´ï¼‰ï¼Œå¹¶è¿”å›é•¿åº¦ n = (tab = resize()).length; // //å¦‚æœæ–°å­˜æ”¾çš„hashå€¼æ²¡æœ‰å†²çªï¼Œåˆ™æ”¾å…¥tab if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); else &#123; // å¦åˆ™å°±æ˜¯äº§ç”Ÿäº†hashå†²çª Node&lt;K,V&gt; e; K k; // å¦‚æœhashå€¼ç›¸ç­‰ä¸”keyå€¼ç›¸ç­‰, åˆ™ä»¤eæŒ‡å‘å†²çªçš„å¤´èŠ‚ç‚¹ if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; // å¦‚æœå¤´èŠ‚ç‚¹çš„keyå€¼ä¸æ–°æ’å…¥çš„keyå€¼ä¸ç­‰, å¹¶ä¸”å¤´ç»“ç‚¹æ˜¯TreeNodeç±»å‹,è¯´æ˜è¯¥hashå€¼å†²çªæ˜¯é‡‡ç”¨çº¢é»‘æ ‘è¿›è¡Œå¤„ç† else if (p instanceof TreeNode) // å¼ºè½¬ä¸ºTreeNodeï¼Œæ’å…¥é»‘çº¢æ ‘(æœ¬ç¯‡æ–‡ç« ä¸è°ˆé»‘çº¢æ ‘çš„æ“ä½œï¼Œå…·ä½“çš„é»‘çº¢æ ‘æ“ä½œçœ‹åç»­åšæ–‡ï¼Œä¸‹åŒ) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); // å¦åˆ™å°±æ˜¯é‡‡ç”¨é“¾è¡¨å¤„ç†hashå€¼å†²çª else &#123; // éå†å†²çªé“¾è¡¨, binCountè®°å½•hashå€¼å†²çªé“¾è¡¨ä¸­èŠ‚ç‚¹ä¸ªæ•° for (int binCount = 0; ; ++binCount) &#123; // //å½“éå†åˆ°å†²çªé“¾è¡¨çš„å°¾éƒ¨æ—¶ if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); // å†²çªé“¾è¡¨èŠ‚ç‚¹å¤§äº8ä¸ª if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st // çº¢é»‘æ ‘åŒ– treeifyBin(tab, hash); break; &#125; //å¦‚æœåœ¨å†²çªé“¾è¡¨ä¸­æ‰¾åˆ°ç›¸åŒkeyå€¼çš„èŠ‚ç‚¹ï¼Œç›´æ¥ç”¨æ–°çš„valueè¦†ç›–åŸæ¥çš„valueå€¼å³å¯ if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; if (e != null) &#123; // existing mapping for key V oldValue = e.value; // åˆ¤æ–­onlyIfAbsentæ˜¯å¦è¦†ç›– // trueè¡¨ç¤ºä»…å½“&lt;key,value&gt;ä¸å­˜åœ¨æ—¶è¿›è¡Œæ’å…¥, ä¸ºfalseè¡¨ç¤ºå¼ºåˆ¶è¦†ç›– if (!onlyIfAbsent || oldValue == null) e.value = value; // å¤„ç†è®¿é—®å›è°ƒåŠ¨ä½œ afterNodeAccess(e); return oldValue; &#125; &#125; // ä¿®æ”¹æ¬¡æ•°è‡ªå¢ ++modCount; // å½“é”®å€¼å¯¹æ•°é‡sizeè¾¾åˆ°ä¸´ç•Œå€¼threholdå, éœ€è¦è¿›è¡Œæ‰©å®¹æ“ä½œ if (++size &gt; threshold) resize(); // å¤„ç†æ’å…¥å›è°ƒåŠ¨ä½œ afterNodeInsertion(evict); return null;&#125; åˆå§‹åŒ–tableæˆ–è€…å¯¹tableè¿›è¡Œæ‰©å®¹(é»˜è®¤2å€)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697final Node&lt;K,V&gt;[] resize() &#123; // //oldTabå˜é‡æŒ‡å‘åŸæ¥çš„æ•°ç»„ Node&lt;K,V&gt;[] oldTab = table; // ç”¨æ¥åˆ¤æ–­æ˜¯æ‰©å®¹è¿˜æ˜¯åˆå§‹åŒ– int oldCap = (oldTab == null) ? 0 : oldTab.length; // oldThrå˜é‡ä¿å­˜åŸæ¥æ•°ç»„çš„é˜ˆå€¼ int oldThr = threshold; int newCap, newThr = 0; // å¦‚æœåŸæ¥å°±æœ‰ä¸œè¥¿ï¼Œå°±è¿›è¡Œæ‰©å®¹æ“ä½œ if (oldCap &gt; 0) &#123; // å½“å¤§äºæœ€å¤§å®¹é‡æ—¶ï¼Œä¸æ‰©å®¹ï¼Œåªæ˜¯æ”¹å˜é˜ˆå€¼ if (oldCap &gt;= MAXIMUM_CAPACITY) &#123; threshold = Integer.MAX_VALUE; return oldTab; &#125; // &lt;&lt; è¡¨ç¤ºä¹˜ä»¥2ï¼Œå˜ä¸ºåŸæ¥çš„2å€ï¼ˆåœ¨æ“ä½œé»˜è®¤å¤§å°çš„æƒ…å†µä¸‹ï¼‰ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) // æ–°é˜ˆå€¼ä¹Ÿå˜ä¸ºåŸæ¥çš„2å€ newThr = oldThr &lt;&lt; 1; // double threshold &#125; // oldCap=0, è¯´æ˜åŸæ¥çš„tableæ•°ç»„ä¸ºnullï¼Œå¼€å§‹åˆå§‹åŒ– // æ–°åˆ›å»ºçš„å®¹å™¨å®¹é‡ä¸ºåŸæ¥å®¹å™¨ä¸­è®¾å®šçš„ä¸´ç•Œå€¼ï¼ˆ16ï¼‰ else if (oldThr &gt; 0) // initial capacity was placed in threshold newCap = oldThr; else &#123; // zero initial threshold signifies using defaults // åœ¨æ²¡æœ‰è®¾ç½®é˜ˆå€¼çš„æƒ…å†µä¸‹ newCap = DEFAULT_INITIAL_CAPACITY; // åˆå§‹é˜ˆå€¼=é»˜è®¤è´Ÿè½½å› å­*é»˜è®¤åˆå§‹åŒ–å®¹é‡ newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); &#125; if (newThr == 0) &#123; // è¿™é‡Œå¯¹åº”çš„è®¾ç½®äº†é˜ˆå€¼çš„æƒ…å†µä¸‹çš„åˆå§‹åŒ–ï¼Œè®¾ç½®é˜ˆå€¼ float ft = (float)newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); &#125; // ç»™thresholdå¤åˆ¶ï¼Œè¿™é‡Œåº”è¯¥ä¹Ÿå°±è§£ç­”äº†å†æ„é€ é‚£èŠ‚æå‡ºçš„ç–‘é—®äº† threshold = newThr; // åˆ›å»ºæ–°æ•°ç»„ @SuppressWarnings(&#123;"rawtypes","unchecked"&#125;) Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; table = newTab; if (oldTab != null) &#123; // å¦‚æœåŸæ¥çš„æ•°ç»„ä¸­å­˜åœ¨å€¼, éœ€è¦å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼ä¿å­˜åˆ°æ–°æ•°ç»„ä¸­ for (int j = 0; j &lt; oldCap; ++j) &#123; Node&lt;K,V&gt; e; if ((e = oldTab[j]) != null) &#123;ã€ // é‡Šæ”¾çš„å¯¹è±¡åŠæ—¶ç½®ç©ºï¼Œç­‰å¾…gcå›æ”¶ oldTab[j] = null; if (e.next == null) // é‡æ–°hashè¿›å…¥æ–°çš„æ•°ç»„ newTab[e.hash &amp; (newCap - 1)] = e; //å¦‚æœåŸæ¥è¿™ä¸ªèŠ‚ç‚¹å·²ç»è½¬åŒ–ä¸ºçº¢é»‘æ ‘äº†ï¼Œ //é‚£ä¹ˆæˆ‘ä»¬å»å°†æ ‘ä¸Šçš„èŠ‚ç‚¹rehashä¹‹åæ ¹æ®hashå€¼æ”¾åˆ°æ–°åœ°æ–¹ else if (e instanceof TreeNode) ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); else &#123; // preserve order // è¿™è¯´æ˜åŸæ¥æ•°ç»„ä¸­ä¿å­˜çš„hashå€¼å­˜åœ¨å†²çª, ä½†æ˜¯å¹¶æ²¡æœ‰é‡‡ç”¨çº¢é»‘æ ‘å¯¹å†²çªçš„Hashå€¼è¿›è¡Œç®¡ç†, è€Œæ˜¯é‡‡ç”¨Nodeé“¾è¡¨è¿›è¡Œç®¡ç† Node&lt;K,V&gt; loHead = null, loTail = null; Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; do &#123; next = e.next; // å¦‚æœä¸ºçœŸï¼Œè¡¨æ˜åœ¨æ‰©å®¹å(e.hash &amp; (newCap - 1))è¿˜ä¼šå’Œe.hash &amp; (oldCap - 1)ä¸€æ · // å¦‚æœä¸ºå‡ï¼Œè¡¨åè¿™äº›èŠ‚ç‚¹å°†hashåœ¨ï¼ˆå½“å‰ä¸‹æ ‡ + oldCapï¼‰ä¸‹ // ä¸æ‡‚çš„å¯ä»¥åœ¨æ€è€ƒğŸ¤”ä¸€ä¸‹,ä½¿ç”¨è¿™ç§æ“ä½œï¼Œå¯ä»¥å‡å°‘é‡æ–°Hashè®¡ç®— if ((e.hash &amp; oldCap) == 0) &#123; if (loTail == null) loHead = e; else loTail.next = e; loTail = e; &#125; else &#123; if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; &#125; &#125; while ((e = next) != null); if (loTail != null) &#123; loTail.next = null; newTab[j] = loHead; &#125; if (hiTail != null) &#123; hiTail.next = null; newTab[j + oldCap] = hiHead; &#125; &#125; &#125; &#125; &#125; // //è¿”å›æ–°æ•°ç»„çš„å¼•ç”¨ return newTab;&#125; åˆ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263//åˆ é™¤keyå¯¹åº”çš„é”®å€¼å¯¹public V remove(Object key) &#123; Node&lt;K,V&gt; e; return (e = removeNode(hash(key), key, null, false, true)) == null ? null : e.value;&#125;// åˆ é™¤èŠ‚ç‚¹// å‚æ•°hashä¸ºkeyçš„hashå€¼;// å‚æ•°keyä¸ºè¦åˆ é™¤çš„keyé”®;// å‚æ•°valueä¸ºkeyå¯¹åº”çš„value;// å‚æ•°matchValueä¸ºtrueè¡¨æ˜åªæœ‰keyåœ¨HashMapä¸­å¯¹åº”å€¼ä¸ºvalueæ—¶æ‰åˆ é™¤; ä¸ºfalseè¡¨ç¤ºå¼ºåˆ¶åˆ é™¤;final Node&lt;K,V&gt; removeNode(int hash, Object key, Object value, boolean matchValue, boolean movable) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, index; // åœ¨tableä¸­æŸ¥æ‰¾å¯¹åº”hashå€¼ if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (p = tab[index = (n - 1) &amp; hash]) != null) &#123; Node&lt;K,V&gt; node = null, e; K k; V v; // å½“å¤´èŠ‚ç‚¹å°±åŒ¹é…åˆ°äº† if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) node = p; else if ((e = p.next) != null) &#123; // å¦‚æœå¤´èŠ‚ç‚¹æ˜¯ä¸ªæ ‘èŠ‚ç‚¹ if (p instanceof TreeNode) // ä»çº¢é»‘æ ‘ä¸­æ‰¾å–èŠ‚ç‚¹ node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key); else &#123; // ä»é“¾è¡¨ä¸­æ‰¾å–èŠ‚ç‚¹ do &#123; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) &#123; node = e; break; &#125; p = e; &#125; while ((e = e.next) != null); &#125; &#125; // åŒ¹é…æ‰¾åˆ°çš„èŠ‚ç‚¹çš„å€¼ if (node != null &amp;&amp; (!matchValue || (v = node.value) == value || (value != null &amp;&amp; value.equals(v)))) &#123; // æ ‘ä¸­ if (node instanceof TreeNode) ((TreeNode&lt;K,V&gt;)node).removeTreeNode(this, tab, movable); else if (node == p) // é¦–èŠ‚ç‚¹ tab[index] = node.next; else // é“¾è¡¨ä¸­ p.next = node.next; ++modCount; --size; afterNodeRemoval(node); // è¿”å›åˆ é™¤çš„èŠ‚ç‚¹ return node; &#125; &#125; return null;&#125; æ”¹æ”¹å˜å¯¹åº”keyçš„å€¼1234567891011121314151617181920212223242526272829303132333435public boolean replace(K key, V oldValue, V newValue) &#123; Node&lt;K,V&gt; e; V v; // æ ¹æ®keyæ‰¾å‡ºèŠ‚ç‚¹ if ((e = getNode(hash(key), key)) != null &amp;&amp; ((v = e.value) == oldValue || (v != null &amp;&amp; v.equals(oldValue)))) &#123; e.value = newValue; afterNodeAccess(e); return true; &#125; return false;&#125;final Node&lt;K,V&gt; getNode(int hash, Object key) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k; // æ‰¾å‡ºæ¡¶çš„å¤´ç»“ç‚¹ if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp; (first = tab[(n - 1) &amp; hash]) != null) &#123; // åˆ¤æ–­å¤´èŠ‚ç‚¹ if (first.hash == hash &amp;&amp; // always check first node ((k = first.key) == key || (key != null &amp;&amp; key.equals(k)))) return first; if ((e = first.next) != null) &#123; // åœ¨æ ‘ä¸­æ‰¾ if (first instanceof TreeNode) return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key); // åœ¨é“¾è¡¨ä¸­æ‰¾ do &#123; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) return e; &#125; while ((e = e.next) != null); &#125; &#125; return null;&#125; æŸ¥æ ¹æ®keyæŸ¥æ‰¾å€¼12345public V get(Object key) &#123; Node&lt;K,V&gt; e; // è¿™é‡Œçš„getNodeå’Œä¸Šé¢è§£æçš„ä¸€æ · return (e = getNode(hash(key), key)) == null ? null : e.value;&#125; å‚è€ƒ HashMapæºç æ³¨è§£ ä¹‹ é™æ€å·¥å…·æ–¹æ³•hash()ã€tableSizeFor()ï¼ˆå››ï¼‰ HashMapä¸­çš„hashå‡½æ•° å¼ºæ¨ğŸ‘ï¼šJavaæºç åˆ†æï¼šå…³äº HashMap 1.8 çš„é‡å¤§æ›´æ–°]]></content>
      <categories>
        <category>JDKæºç åˆ†æ</category>
      </categories>
      <tags>
        <tag>HashMap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JDKæºç åˆ†æâ€”â€”ArrayList]]></title>
    <url>%2F2018%2F09%2F02%2FJDK%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%2FJDK%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E2%80%94%E2%80%94ArrayList%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¤§å®¶åœ¨é›†åˆæ¡†æ¶ä¸­ç”¨çš„æœ€å¤šä¸€å®šæ˜¯ArrayListå§ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥ä¸€æ¢ç©¶ç«Ÿï¼ è¯¦ç»†æ³¨é‡Šï¼šæºç åˆ†æåœ°å€ æ¦‚è§ˆArrayListæ˜¯åŸºäºå¯å˜æ•°ç»„å®ç°äº†ï¼Œå…è®¸åŒ…æ‹¬ null åœ¨å†…çš„æ‰€æœ‰å…ƒç´ ã€‚ æ¯ä¸ª ArrayList å®ä¾‹éƒ½æœ‰ä¸€ä¸ªå®¹é‡ã€‚è¯¥å®¹é‡æ˜¯æŒ‡ç”¨æ¥å­˜å‚¨åˆ—è¡¨å…ƒç´ çš„æ•°ç»„çš„å¤§å°ã€‚å®ƒæ€»æ˜¯è‡³å°‘ç­‰äºåˆ—è¡¨çš„å¤§å°ã€‚éšç€å‘ ArrayList ä¸­ä¸æ–­æ·»åŠ å…ƒç´ ï¼Œå…¶å®¹é‡ä¹Ÿè‡ªåŠ¨å¢é•¿ã€‚ åœ¨æ·»åŠ å¤§é‡å…ƒç´ å‰ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ ensureCapacity æ“ä½œæ¥å¢åŠ  ArrayList å®ä¾‹çš„å®¹é‡ã€‚è¿™å¯ä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚ æ³¨æ„ï¼š æ­¤å®ç°ä¸æ˜¯åŒæ­¥çš„ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ª ArrayList å®ä¾‹ï¼Œè€Œå…¶ä¸­è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ä»ç»“æ„ä¸Šä¿®æ”¹äº†åˆ—è¡¨ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»ä¿æŒå¤–éƒ¨åŒæ­¥ã€‚ï¼ˆç»“æ„ä¸Šçš„ä¿®æ”¹æ˜¯æŒ‡ä»»ä½•æ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ çš„æ“ä½œï¼Œæˆ–è€…æ˜¾å¼è°ƒæ•´åº•å±‚æ•°ç»„çš„å¤§å°ï¼›ä»…ä»…è®¾ç½®å…ƒç´ çš„å€¼ä¸æ˜¯ç»“æ„ä¸Šçš„ä¿®æ”¹ã€‚ï¼‰è¿™ä¸€èˆ¬é€šè¿‡å¯¹è‡ªç„¶å°è£…è¯¥åˆ—è¡¨çš„å¯¹è±¡è¿›è¡ŒåŒæ­¥æ“ä½œæ¥å®Œæˆã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å¯¹è±¡ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ Collections.synchronizedList æ–¹æ³•å°†è¯¥åˆ—è¡¨â€œåŒ…è£…â€èµ·æ¥ã€‚è¿™æœ€å¥½åœ¨åˆ›å»ºæ—¶å®Œæˆï¼Œä»¥é˜²æ­¢æ„å¤–å¯¹åˆ—è¡¨è¿›è¡Œä¸åŒæ­¥çš„è®¿é—®ã€‚ æ­¤ç±»çš„ iterator å’Œ listIterator æ–¹æ³•è¿”å›çš„è¿­ä»£å™¨æ˜¯å¿«é€Ÿå¤±è´¥çš„ï¼šåœ¨åˆ›å»ºè¿­ä»£å™¨ä¹‹åï¼Œé™¤éé€šè¿‡è¿­ä»£å™¨è‡ªèº«çš„ remove æˆ– add æ–¹æ³•ä»ç»“æ„ä¸Šå¯¹åˆ—è¡¨è¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™åœ¨ä»»ä½•æ—¶é—´ä»¥ä»»ä½•æ–¹å¼å¯¹åˆ—è¡¨è¿›è¡Œä¿®æ”¹ï¼Œè¿­ä»£å™¨éƒ½ä¼šæŠ›å‡º ConcurrentModificationExceptionã€‚ ArrayListä»ç±» java.util.AbstractList ç»§æ‰¿äº†å­—æ®µ modCountï¼Œåœ¨è¿›è¡Œåºåˆ—åŒ–æˆ–è€…è¿­ä»£ç­‰æ“ä½œæ—¶ï¼Œéœ€è¦æ¯”è¾ƒæ“ä½œå‰å modCount æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœæ”¹å˜äº†éœ€è¦æŠ›å‡º ConcurrentModificationExceptionã€‚ æ„é€ 12345678910111213// é»˜è®¤æ•°ç»„åˆå§‹å¤§å°ä¸º10private static final int DEFAULT_CAPACITY = 10;public ArrayList(int initialCapacity) &#123; if (initialCapacity &gt; 0) &#123; this.elementData = new Object[initialCapacity]; &#125; else if (initialCapacity == 0) &#123; // è¿”å›ç©ºæ•°ç»„ this.elementData = EMPTY_ELEMENTDATA; &#125; else &#123; throw new IllegalArgumentException("Illegal Capacity: " + initialCapacity); &#125;&#125; å¢1234567891011121314151617181920212223242526272829303132333435363738394041424344454647// æ–°å¢å…ƒç´ public boolean add(E e) &#123; // ç¡®ä¿å®¹é‡è¶³å¤Ÿ ensureCapacityInternal(size + 1); // Increments modCount!! elementData[size++] = e; return true;&#125;private void ensureCapacityInternal(int minCapacity) &#123; // å¦‚æœæ˜¯é»˜è®¤åˆ›å»ºçš„æ•°ç»„ï¼Œåˆ™å’Œå®¹é‡é»˜è®¤å€¼æ¯”è¾ƒ if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123; minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); &#125; // ç¡®ä¿å®¹é‡è¶³å¤Ÿ ensureExplicitCapacity(minCapacity);&#125;private void ensureExplicitCapacity(int minCapacity) &#123; // ä¿®æ”¹æ“ä½œåŠ 1 modCount++; // overflow-conscious code // å¦‚æœéœ€è¦çš„å®¹é‡æ¯”æ•°ç»„é•¿åº¦å¤§ï¼Œåˆ™è¿›è¡Œæ‰©å®¹ if (minCapacity - elementData.length &gt; 0) grow(minCapacity);&#125;private void grow(int minCapacity) &#123; // overflow-conscious code // æ–°å®¹é‡å°†ä½¿åŸæ¥çš„1.5å€ int oldCapacity = elementData.length; int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); // 1.5å€è¿˜ä¸å¤Ÿçš„è¯ï¼Œå°±å°†å®¹é‡è®¾ç½®ä¸ºéœ€è¦çš„å¤§å° if (newCapacity - minCapacity &lt; 0) newCapacity = minCapacity; // å¦‚æœæ–°å®¹é‡æ¯”æœ€å¤§çš„æ•°ç»„å®¹é‡ï¼ˆInteger.MAX_VALUE - 8;ï¼‰è¿˜è¦å¤§ï¼Œåˆ™åˆ›å»ºæ›´å¤§çš„å®¹é‡ï¼ˆInteger.MAX_VALUEï¼‰ if (newCapacity - MAX_ARRAY_SIZE &gt; 0) newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: // Arrays.copyOf() æ˜¯æŠŠåŸæ•°ç»„æ•´ä¸ªå¤åˆ¶åˆ°æ–°æ•°ç»„ï¼Œè¿™ä¸ªä»£ä»·å¾ˆé«˜ // å› æ­¤æœ€å¥½åœ¨åˆ›å»º ArrayList å¯¹è±¡æ—¶å°±æŒ‡å®šå¤§æ¦‚çš„å®¹é‡å¤§å°ï¼Œå‡å°‘æ‰©å®¹æ“ä½œçš„æ¬¡æ•° elementData = Arrays.copyOf(elementData, newCapacity);&#125;private static int hugeCapacity(int minCapacity) &#123; if (minCapacity &lt; 0) // overflow throw new OutOfMemoryError(); return (minCapacity &gt; MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE;&#125; åˆ åˆ é™¤éœ€è¦å°† index+1 åé¢çš„å…ƒç´ éƒ½å¤åˆ¶åˆ° index ä½ç½®ä¸Šï¼Œè¯¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼Œæ‰€ä»¥ArrayList åˆ é™¤å…ƒç´ çš„ä»£ä»·æ˜¯éå¸¸é«˜çš„ã€‚123456789101112131415161718public E remove(int index) &#123; // éªŒè¯indexæ˜¯å¦è¶…å‡ºsizeå¤§å° rangeCheck(index); modCount++; // æ‹¿åˆ°å€¼ E oldValue = elementData(index); // ç»Ÿè®¡è¦ç§»åŠ¨çš„ä½æ•° int numMoved = size - index - 1; if (numMoved &gt; 0) // è°ƒç”¨ç³»ç»Ÿæ–¹æ³•å¼€å§‹æ‹·è´ System.arraycopy(elementData, index+1, elementData, index, numMoved); // å³æ—¶æ”¾å¼€å¼•ç”¨ï¼Œç­‰å¾…GC elementData[--size] = null; // clear to let GC do its work // è¿”å›è¢«åˆ é™¤çš„å…ƒç´  return oldValue;&#125; æ”¹12345678910public E set(int index, E element) &#123; // éªŒè¯indexæ˜¯å¦è¶…å‡ºsizeå¤§å° rangeCheck(index); // æ‹¿å‡ºåŸå€¼ E oldValue = elementData(index); // è®¾ç½®æ–°å€¼ elementData[index] = element; // è¿”å›è¢«æ›¿æ¢çš„å€¼ return oldValue;&#125; æŸ¥12345678910public E get(int index) &#123; // éªŒè¯indexæ˜¯å¦è¶…å‡ºsizeå¤§å° rangeCheck(index); return elementData(index);&#125;E elementData(int index) &#123; // æ‹¿å‡ºå€¼ return (E) elementData[index];&#125; åºåˆ—åŒ–ArrayList åŸºäºæ•°ç»„å®ç°ï¼Œå¹¶ä¸”å…·æœ‰åŠ¨æ€æ‰©å®¹ç‰¹æ€§ï¼Œå› æ­¤ä¿å­˜å…ƒç´ çš„æ•°ç»„ä¸ä¸€å®šéƒ½ä¼šè¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦å…¨éƒ¨è¿›è¡Œåºåˆ—åŒ–ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849// ä¿å­˜å…ƒç´ çš„æ•°ç»„ elementData ä½¿ç”¨ transient ä¿®é¥°ï¼Œè¯¥å…³é”®å­—å£°æ˜æ•°ç»„é»˜è®¤ä¸ä¼šè¢«åºåˆ—åŒ–transient Object[] elementData;// åºåˆ—åŒ–private void writeObject(java.io.ObjectOutputStream s) throws java.io.IOException&#123; // Write out element count, and any hidden stuff // è®°å½•ä¿®æ”¹æ¬¡æ•°ï¼Œåé¢å¯ä»¥æ ¹æ®ä»–åˆ¤æ–­ç»“æ„æ˜¯å¦å‘ç”Ÿäº†å˜åŒ– int expectedModCount = modCount; // å†™å…¥éé™æ€ï¼Œéæš‚æ—¶æ•°æ®åˆ°æµä¸­ s.defaultWriteObject(); // Write out size as capacity for behavioural compatibility with clone() // å†™å…¥å…ƒç´ ä¸ªæ•° s.writeInt(size); // Write out all elements in the proper order. // å†™å…¥å…ƒç´  for (int i=0; i&lt;size; i++) &#123; s.writeObject(elementData[i]); &#125; // æ¯”è¾ƒæ“ä½œå‰å modCount æ˜¯å¦æ”¹å˜ï¼Œå¦‚æœæ”¹å˜äº†éœ€è¦æŠ›å‡º ConcurrentModificationExceptionã€‚ if (modCount != expectedModCount) &#123; throw new ConcurrentModificationException(); &#125;&#125;// ååºåˆ—åŒ–private void readObject(java.io.ObjectInputStream s) throws java.io.IOException, ClassNotFoundException &#123; elementData = EMPTY_ELEMENTDATA; // Read in size, and any hidden stuff s.defaultReadObject(); // Read in capacity s.readInt(); // ignored if (size &gt; 0) &#123; // be like clone(), allocate array based upon size not capacity ensureCapacityInternal(size); Object[] a = elementData; // Read in all elements in the proper order. for (int i=0; i&lt;size; i++) &#123; a[i] = s.readObject(); &#125; &#125;&#125;]]></content>
      <categories>
        <category>JDKæºç åˆ†æ</category>
      </categories>
      <tags>
        <tag>ArrayList</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaé›†åˆæ¡†æ¶ç±»å›¾]]></title>
    <url>%2F2018%2F09%2F02%2FJava%E5%9F%BA%E7%A1%80%2FJava%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6%E7%B1%BB%E5%9B%BE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨é˜…è¯»é›†åˆæºç ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆç†è§£å…¶ä¸­å„ä¸ªæ¥å£ä»¥åŠç±»å›¾çš„å…³ç³»ã€‚åªè¦ç†æ¸…äº†å„ç§å…³ç³»ï¼Œä½ å¤§è‡´çš„å½±å“å°±æœ‰äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯æ·±å…¥æºç ï¼Œå»çœ‹å…·ä½“å®ç°ã€‚ é›†åˆæ¥å£å›¾ é›†åˆç±»å›¾ åç»­åé¢æˆ‘ä¹Ÿå°†å›´ç»•è¿™äº›ç±»åŠå‘¨è¾¹ç±»åšå‡ºJDkæºç åˆ†æï¼ï¼]]></content>
      <categories>
        <category>JavaåŸºç¡€</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RPCçŸ¥è¯†]]></title>
    <url>%2F2018%2F08%2F10%2F%E5%BE%AE%E6%9C%8D%E5%8A%A1%2FRPC%E7%9F%A5%E8%AF%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè½¬è‡ªå¾é–å³°|ä¸ªäººåšå®¢çš„RPCä¸“æ ï¼Œäº†è§£è¿™äº›æ‰èƒ½å»çœ‹çœ‹RPCæ¡†æ¶ï¼ï¼ï¼ RPCç³»åˆ—åšå®¢ ç®€å•äº†è§£RPCå®ç°åŸç† æ·±å…¥ç†è§£RPCä¹‹åºåˆ—åŒ–ç¯‡â€“Kryo æ·±å…¥ç†è§£RPCä¹‹åºåˆ—åŒ–ç¯‡â€“æ€»ç»“ç¯‡ æ·±å…¥ç†è§£RPCä¹‹åŠ¨æ€ä»£ç†ç¯‡ æ·±å…¥ç†è§£ RPC ä¹‹ä¼ è¾“ç¯‡ Motanä¸­ä½¿ç”¨å¼‚æ­¥RPCæ¥å£ æ·±å…¥ç†è§£RPCä¹‹åè®®ç¯‡ æ·±å…¥ç†è§£RPCä¹‹æœåŠ¡æ³¨å†Œä¸å‘ç°ç¯‡ æ·±å…¥ç†è§£ RPC ä¹‹é›†ç¾¤ç¯‡ è®¾è®¡RPCæ¥å£æ—¶ï¼Œä½ æœ‰è€ƒè™‘è¿‡è¿™äº›å—ï¼Ÿ ç®€å•RPCå¯ä»¥å‚è€ƒtodorex/rex_rpc]]></content>
      <categories>
        <category>å¾®æœåŠ¡</category>
      </categories>
      <tags>
        <tag>rpc</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nettyæºç ä¹‹ç¼–ç å™¨]]></title>
    <url>%2F2018%2F08%2F06%2FNetty%E6%BA%90%E7%A0%81%2FNetty%E6%BA%90%E7%A0%81%E4%B9%8B%E7%BC%96%E7%A0%81%E5%99%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸Šä¸€ç¯‡åšæ–‡è®²äº†è§£ç å™¨å¯¹åº”äº†è¯»äº‹ä»¶ï¼Œè¿™æ¬¡å°±è®²ä¸€ä¸‹ç¼–ç å™¨ï¼Œå¯¹åº”äº†å†™äº‹ä»¶ã€‚ ç¼–ç å™¨åŸºç±»åœ¨Nettyä¸­è§£ç å™¨çš„åŸºç±»æ˜¯MessageToByteEncoder ï¼Œç„¶åæˆ‘ä»¬è¦æ˜ç™½çš„æ˜¯MessageToByteEncoderå…¶å®æ˜¯ä¸€ä¸ªChannelOutboundHandlerAdapterã€‚ æˆ‘ä»¬åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¸»è¦å°±æ˜¯è¦†å†™å®ƒçš„encodeæ–¹æ³•ï¼š 1protected abstract void encode(ChannelHandlerContext ctx, I msg, ByteBuf out) throws Exception; ä¸€ä¸ªç¼–ç å™¨ç¼–ç çš„è¿‡ç¨‹ä¸»è¦æœ‰å¦‚ä¸‹6ä¸ªæ­¥éª¤ï¼š åŒ¹é…å¯¹è±¡ åˆ†é…å†…å­˜ ç¼–ç å®ç° é‡Šæ”¾å¯¹è±¡ ä¼ æ’­æ•°æ® é‡Šæ”¾å†…å­˜ å½“æˆ‘ä»¬çŸ¥é“MessageToByteEncoderæ˜¯ä¸€ä¸ªHandlerçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¼šå»æ‰¾å®ƒå¯¹äº‹ä»¶çš„å¤„ç†æ–¹æ³•ï¼Œä¸»è¦æ˜¯å†™äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°å†™äº‹ä»¶å¤„ç†æ–¹æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152// step 1public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception &#123; ByteBuf buf = null; try &#123; // åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿå¤„ç†è¯¥å¯¹è±¡ // step 2 if (acceptOutboundMessage(msg)) &#123; // èƒ½å¤„ç† I cast = (I) msg; // å†…å­˜åˆ†é…(é»˜è®¤åˆ†é…å †å¤–å†…å­˜ ) buf = allocateBuffer(ctx, cast, preferDirect); try &#123; // å¼€å§‹è°ƒç”¨æˆ‘ä»¬è¦†å†™çš„encodeæ–¹æ³•äº† encode(ctx, cast, buf); &#125; finally &#123; // é‡Šæ”¾å¯¹è±¡ ReferenceCountUtil.release(cast); &#125; if (buf.isReadable()) &#123; // ä¼ æ’­æ•°æ®ï¼Œä¸€ç›´ä¼ æ’­åˆ°headèŠ‚ç‚¹å¤„ç† ctx.write(buf, promise); &#125; else &#123; // å¦‚æœç¼–ç æ²¡æœ‰æˆåŠŸï¼Œåˆ™æ˜¯å¦å†…å­˜ buf.release(); ctx.write(Unpooled.EMPTY_BUFFER, promise); &#125; buf = null; &#125; else &#123; // ä¸èƒ½å¤„ç†ï¼Œåˆ™ç»§ç»­ä¼ æ’­ ctx.write(msg, promise); &#125; &#125; catch(EncoderException e) &#123; throw e; &#125; catch(Throwable e) &#123; throw new EncoderException(e); &#125; finally &#123; if (buf != null) &#123; buf.release(); &#125; &#125;&#125;// step 2private final TypeParameterMatcher matcher;public boolean acceptOutboundMessage(Object msg) throws Exception &#123; // step 3 return matcher.match(msg);&#125;// step 3public boolean match(Object msg) &#123; // ä¸»è¦å°±æ˜¯åˆ¤æ–­msgæ˜¯å¦æ˜¯MessageToByteEncoder&lt;I&gt;ä¸­çš„Iç±»å‹ return type.isInstance(msg);&#125; write()ä¹‹å‰è‡ªå·±åœ¨ChannelPipelineé‚£ç« åˆ†æåˆ°HeadContextçš„writeæ–¹æ³•ï¼Œæ²¡æœ‰ç»§ç»­å¾€ä¸‹åˆ†æï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåˆ†æï¼š å®ƒä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªè¿‡ç¨‹ï¼š directåŒ–ByteBuf æ’å…¥å†™é“¾è¡¨ è®¾ç½®å†™çŠ¶æ€ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101// step 1public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception &#123; // step 2 unsafe.write(msg, promise);&#125;// step 2public final void write(Object msg, ChannelPromise promise) &#123; // è¯¥å¯¹è±¡è´Ÿè´£ç¼“å†²å†™è¿›æ¥çš„æ•°æ® ä¼°ç®—å‡ºéœ€è¦å†™å…¥çš„ByteBufçš„size outboundBuffer = this.outboundBuffer; // ... int size; try &#123; // å°†å¾…å†™å…¥çš„å¯¹è±¡è¿‡æ»¤,æŠŠæ‰€æœ‰çš„éç›´æ¥å†…å­˜è½¬æ¢æˆç›´æ¥å†…å­˜DirectBuffer // step 3 msg = filterOutboundMessage(msg); // ä¼°ç®—å‡ºéœ€è¦å†™å…¥çš„ByteBufçš„size size = pipeline.estimatorHandle().size(msg); if (size &lt; 0) &#123; size = 0; &#125; &#125; catch(Throwable t) &#123; safeSetFailure(promise, t); ReferenceCountUtil.release(msg); return; &#125; // å°†ä¿¡æ¯æ·»åŠ åˆ°ä¼°ç®—å‡ºéœ€è¦å†™å…¥çš„ByteBufçš„size // step 4 outboundBuffer.addMessage(msg, size, promise);&#125;// step 3protected final Object filterOutboundMessage(Object msg) &#123; if (msg instanceof ByteBuf) &#123; ByteBuf buf = (ByteBuf) msg; if (buf.isDirect()) &#123; return msg; &#125; // è½¬æ¢æˆç›´æ¥å†…å­˜DirectBuffer return newDirectBuffer(buf); &#125; if (msg instanceof FileRegion) &#123; return msg; &#125;&#125;// step 4 ChannelOutboundBuffer// ä¸€ä¸ªé“¾è¡¨// Entry(flushedEntry) --&gt; ... Entry(unflushedEntry) --&gt; ... Entry(tailEntry)//// æŒ‡å‘ç¬¬ä¸€ä¸ªå·²ç»flushçš„èŠ‚ç‚¹private Entry flushedEntry;// æŒ‡å‘ç¬¬ä¸€ä¸ªæœªflushçš„èŠ‚ç‚¹private Entry unflushedEntry;// æŒ‡å‘æœ«å°¾èŠ‚ç‚¹private Entry tailEntry;public void addMessage(Object msg, int size, ChannelPromise promise) &#123; // å…³æ³¨è¿™ä¸‰ä¸ªæŒ‡é’ˆtailEntryã€tailEntryã€unflushedEntry // å…ˆåŒ…è£…æˆä¸€ä¸ªEntry Entry entry = Entry.newInstance(msg, size, total(msg), promise); // æ’å…¥é“¾è¡¨ if (tailEntry == null) &#123; flushedEntry = null; &#125; else &#123; Entry tail = tailEntry; tail.next = entry; &#125; tailEntry = entry; if (unflushedEntry == null) &#123; unflushedEntry = entry; &#125; // ç»Ÿè®¡å½“å‰éœ€è¦å†™å…¥åˆ°Socketç¼“å­˜åŒºçš„å­—èŠ‚ // step 5 incrementPendingOutboundBytes(entry.pendingSize, false);&#125;// step 5private void incrementPendingOutboundBytes(long size, boolean invokeLater) &#123; if (size == 0) &#123; return; &#125; long newWriteBufferSize = TOTAL_PENDING_SIZE_UPDATER.addAndGet(this, size); // é»˜è®¤ç¼“å†²åŒºä¸èƒ½è¶…è¿‡64ä¸ªå­—èŠ‚ if (newWriteBufferSize &gt; channel.config().getWriteBufferHighWaterMark()) &#123; // è®¾ç½®å†™çŠ¶æ€ setUnwritable(invokeLater); &#125;&#125;// step 6private void setUnwritable(boolean invokeLater) &#123; for (;;) &#123; final int oldValue = unwritable; final int newValue = oldValue | 1; if (UNWRITABLE_UPDATER.compareAndSet(this, oldValue, newValue)) &#123; if (oldValue == 0 &amp;&amp; newValue != 0) &#123; // ä¼ æ’­ä¸èƒ½å†™äº‹ä»¶ fireChannelWritabilityChanged(invokeLater); &#125; break; &#125; &#125;&#125; flush()writeä¸èƒ½å†™äº†å°±éœ€è¦flushäº†ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿä»HeadContextçš„flushæ–¹æ³•å¼€å§‹åˆ†æï¼š å®ƒä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªæ­¥éª¤ï¼š æ·»åŠ åˆ·æ–°æ ‡å¿—å¹¶è®¾ç½®å†™çŠ¶æ€ éå†bufferé˜Ÿåˆ—ï¼Œè¿‡æ»¤ByteBuf è°ƒç”¨JDKåº•å±‚çš„APIè¿›è¡Œè‡ªæ—‹å†™ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113// step 1public void flush(ChannelHandlerContext ctx) throws Exception &#123; // step 2 unsafe.flush();&#125;// step 2public final void flush() &#123; ChannelOutboundBuffer outboundBuffer = this.outboundBuffer; // step 3 outboundBuffer.addFlush(); // step 5 flush0();&#125;// step 3public void addFlush() &#123; // æŒ‡å‘unflushedEntry Entry entry = unflushedEntry; if (entry != null) &#123; if (flushedEntry == null) &#123; flushedEntry = entry; &#125; do &#123; // è®¾ç½®flushçš„æ•°é‡ flushed++; if (!entry.promise.setUncancellable()) &#123; int pending = entry.cancel(); // step 4 decrementPendingOutboundBytes(pending, false, true); &#125; entry = entry.next; &#125; while ( entry != null ); // å°†unflushedEntryè®¾ç½®ä¸ºnull unflushedEntry = null; &#125;&#125;// step 4private void decrementPendingOutboundBytes(long size, boolean invokeLater, boolean notifyWritability) &#123; long newWriteBufferSize = TOTAL_PENDING_SIZE_UPDATER.addAndGet(this, -size); // é»˜è®¤ç¼“å†²åŒºä½äº32ä¸ªå­—èŠ‚ï¼Œåˆ™å¯è®¾ç½®å¯å†™ if (notifyWritability &amp;&amp; newWriteBufferSize &lt; channel.config().getWriteBufferLowWaterMark()) &#123; // è®¾ç½®å¯å†™çŠ¶æ€ setWritable(invokeLater); &#125;&#125;// step 5protected void flush0() &#123; final ChannelOutboundBuffer outboundBuffer = this.outboundBuffer; if (outboundBuffer == null || outboundBuffer.isEmpty()) &#123; return; &#125; // ... // step 6 doWrite(outboundBuffer);&#125;// step 6 NioSocketChannelprotected void doWrite(ChannelOutboundBuffer in) throws Exception &#123; // æ‹¿åˆ°åº•å±‚çš„SocketChannelå‡†å¤‡å¼€å§‹åº•å±‚çš„æ“ä½œ SocketChannel ch = javaChannel(); // è·å–å¾ªç¯æ¬¡æ•°ï¼Œç›¸å½“äºä¸€ä¸ªè‡ªæ—‹é”ï¼Œé»˜è®¤16 int writeSpinCount = config().getWriteSpinCount(); do &#123; // å¦‚æœbufferé‡Œç©ºçš„ if ( in .isEmpty()) &#123; // æ¸…ç†OP_WRITEï¼Œé˜²æ­¢Reacotrçº¿ç¨‹å†æ¬¡å¤„ç†è¿™ä¸ªChannel clearOpWrite(); return; &#125; // è·å–èšåˆå†™çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œé»˜è®¤Integer.MAX_VALUE int maxBytesPerGatheringWrite = ((NioSocketChannelConfig) config).getMaxBytesPerGatheringWrite(); // æŠŠByteBufé‡Œçš„æ•°æ®å†™åˆ°åŸç”ŸBufferé‡Œ // step 7 ByteBuffer[] nioBuffers = in.nioBuffers(1024, maxBytesPerGatheringWrite); int nioBufferCnt = in.nioBufferCount(); // å¯¹éBufferå¯¹è±¡ï¼ˆFileRegionï¼‰çš„æ•°æ®è¿›è¡Œæ™®é€šçš„è¯»å†™ switch (nioBufferCnt) &#123; case 0: // æ²¡æˆåŠŸï¼Œè‡ªæ—‹ä¸€æ¬¡ writeSpinCount -= doWrite0( in ); break; case 1: // JDK NIO æ”¯æŒä¸€æ¬¡å†™å•ä¸ªByteBuffer ä»¥åŠ ä¸€æ¬¡å†™å¤šä¸ªByteBufferçš„èšé›†å†™æ¨¡å¼ // å¦‚æœåªæœ‰ä¸€ä¸ªbufferçš„æƒ…å†µä¸‹ï¼Œç›´æ¥æŠŠè¿™ä¸ªbufferå†™è¿›å» ByteBuffer buffer = nioBuffers[0]; int attemptedBytes = buffer.remaining(); // è°ƒç”¨JDKåº•å±‚çš„APIè¿›è¡Œå†™ï¼Œå®Œæ¯• final int localWrittenBytes = ch.write(buffer); if (localWrittenBytes &lt;= 0) &#123; incompleteWrite(true); return; &#125; adjustMaxBytesPerGatheringWrite(attemptedBytes, localWrittenBytes, maxBytesPerGatheringWrite); // é‡Šæ”¾ç¼“å­˜å¯¹è±¡ in.removeBytes(localWrittenBytes); --writeSpinCount; break; &#125; default: &#123; // å¤šä¸ªbufferçš„æƒ…å†µä¸‹ï¼Œå†™nioBufferCntä¸ªbufferè¿›å» long attemptedBytes = in.nioBufferSize(); final long localWrittenBytes = ch.write(nioBuffers, 0, nioBufferCnt); if (localWrittenBytes &lt;= 0) &#123; incompleteWrite(true); return; &#125; adjustMaxBytesPerGatheringWrite((int) attemptedBytes, (int) localWrittenBytes, maxBytesPerGatheringWrite); in .removeBytes(localWrittenBytes); --writeSpinCount; break; &#125; &#125; &#125; while ( writeSpinCount &gt; 0 ); incompleteWrite(writeSpinCount &lt; 0);&#125; çŸ¥é“writeå’Œflushé‚£ä¹ˆå°±å¾ˆå®¹æ˜“ç†è§£writeAndFlushå•¦ï¼ï¼ å‚è€ƒ ettyæºç åˆ†æä¹‹writeAndFlushå…¨è§£æ Nettyæºç åˆ†æâ€”â€”flushæµç¨‹ Netty æºç è§£æ â€”â€”â€” writeAndFlushæµç¨‹åˆ†æ]]></content>
      <categories>
        <category>Nettyæºç </category>
      </categories>
      <tags>
        <tag>Netty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nettyæºç ä¹‹è§£ç å™¨]]></title>
    <url>%2F2018%2F08%2F06%2FNetty%E6%BA%90%E7%A0%81%2FNetty%E6%BA%90%E7%A0%81%E4%B9%8B%E8%A7%A3%E7%A0%81%E5%99%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šNettyåœ¨å¸®æˆ‘ä»¬è§£å†³æ€§èƒ½çš„åŒæ—¶ï¼Œä¹Ÿæä¾›äº†ä¸°å¯Œçš„ç¼–è§£ç å™¨æ¥ä¸ºæˆ‘ä»¬ä¸šåŠ¡ä¸Šæä¾›ä¾¿åˆ©ï¼Œè¿™æ¬¡æˆ‘ä»¬å°±æ¥çœ‹çœ‹Nettyçš„è§£ç å™¨ã€‚ è§£ç å™¨åŸºç±»è§£ç ï¼šå°±æ˜¯å°†äºŒè¿›åˆ¶æ•°æ®æµè§£ç ä¸ºè‡ªå®šä¹‰æ•°æ®åŒ…ã€‚ åœ¨Nettyä¸­è§£ç å™¨çš„åŸºç±»æ˜¯ByteToMessageDecoderï¼Œç„¶åæˆ‘ä»¬è¦æ˜ç™½çš„æ˜¯ByteToMessageDecoderå…¶å®æ˜¯ä¸€ä¸ªChannelInboundHandlerAdapterã€‚ ä¸€ä¸ªè§£ç å™¨è§£ç çš„è¿‡ç¨‹ä¸»è¦æœ‰å¦‚ä¸‹ä¸‰ä¸ªæ­¥éª¤ï¼š ç´¯åŠ å­—èŠ‚æµ è°ƒç”¨å­ç±»çš„decodeæ–¹æ³•è¿›è¡Œè§£æ å°†è§£æåˆ°çš„ByteBufå‘ä¸‹ä¼ æ’­ å½“æˆ‘ä»¬çŸ¥é“ByteToMessageDecoderæ˜¯ä¸€ä¸ªHandlerçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ä¼šå»æ‰¾å®ƒå¯¹äº‹ä»¶çš„å¤„ç†æ–¹æ³•ï¼Œä¸»è¦æ˜¯è¯»äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°è¯»äº‹ä»¶å¤„ç†æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102// step 1ByteBuf cumulation;public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception &#123; // è§£ç å™¨æ˜¯ç›¸å¯¹äºByteBufè¿›è¡Œè§£ç çš„(åœ¨å…¥ç«™çš„æ—¶å€™å·²ç»å°è£…å¥½äº†ï¼Œå¯ä»¥å‚è€ƒè‡ªå·±ä¹‹å‰å…³äºPipelineçš„åšæ–‡) if (msg instanceof ByteBuf) &#123; // å­˜å‚¨è§£ç åçš„æ•°æ® List CodecOutputList out = CodecOutputList.newInstance(); try &#123; ByteBuf data = (ByteBuf) msg; // æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡ç´¯åŠ  first = cumulation == null; if (first) &#123; // ç¬¬ä¸€æ¬¡ cumulation = data; &#125; else &#123; // ä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œåˆ™è¿›è¡Œç´¯åŠ  // æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªç´¯åŠ å™¨çš„cumulateæ–¹æ³• step 2 cumulation = cumulator.cumulate(ctx.alloc(), cumulation, data); &#125; // è°ƒç”¨å­ç±»çš„decodeæ–¹æ³•è¿›è¡Œè§£æ // step 3 callDecode(ctx, cumulation, out); &#125; catch(DecoderException e) &#123; throw e; &#125; catch(Exception e) &#123; throw new DecoderException(e); &#125; finally &#123; int size = out.size(); decodeWasNull = !out.insertSinceRecycled(); // å°†è§£æåˆ°çš„å¯¹è±¡å‘ä¸‹ç»§ç»­ä¼ æ’­ // step 5 fireChannelRead(ctx, out, size); // å›æ”¶list out.recycle(); &#125; &#125; else &#123; // ä¸æ˜¯ByteBufå°±ç›´æ¥å‘ä¸‹ä¼ æ’­ ctx.fireChannelRead(msg); &#125;&#125;// step 2public ByteBuf cumulate(ByteBufAllocator alloc, ByteBuf cumulation, ByteBuf in ) &#123; final ByteBuf buffer; // å½“bufçš„æ•°æ®å¤§äºcumulationçš„å‰©ä½™å®¹é‡æ—¶ if (cumulation.writerIndex() &gt; cumulation.maxCapacity() - in.readableBytes() || cumulation.refCnt() &gt; 1 || cumulation.isReadOnly()) &#123; // è¿›è¡Œæ‰©å®¹(æ‰©å®¹å…¶å®å°±æ˜¯ä¸€ä¸ªå†…å­˜æ‹·è´æ“ä½œ) buffer = expandCumulation(alloc, cumulation, in.readableBytes()); &#125; else &#123; // ä¸ç„¶å°±ä¸æ‰©å®¹ buffer = cumulation; &#125; // å°†æ•°æ®å†™å…¥buf buffer.writeBytes(in); // é‡Šæ”¾ä¼ å…¥çš„buf in.release(); return buffer;&#125;// step 3protected void callDecode(ChannelHandlerContext ctx, ByteBuf in , List &lt; Object &gt; out) &#123; while ( in .isReadable()) &#123; int outSize = out.size(); // çœ‹listæ˜¯å¦æœ‰å¯¹è±¡ if (outSize &gt; 0) &#123; // æœ‰å¯¹è±¡åˆ™å°†listä¼ æ’­å‡ºå» fireChannelRead(ctx, out, outSize); // å¹¶æ¸…ç©ºlist out.clear(); outSize = 0; &#125; // è®°å½•å¯è¯»é•¿åº¦ int oldInputLength = in.readableBytes(); // å¼€å§‹è°ƒç”¨decodeæ–¹æ³•äº† // step 4 decodeRemovalReentryProtection(ctx, in, out); // ä»€ä¹ˆéƒ½æ²¡æœ‰è§£æå‡ºæ¥æ—¶ if (outSize == out.size()) &#123; // ä»£è¡¨å½“å‰çš„æ•°æ®ä¸èƒ½æ‹¼è£…æˆä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…ï¼Œbreakå‡†å¤‡ç­‰å¾…ä¸‹ä¸€æ¬¡æ•°æ®åŒ… if (oldInputLength == in.readableBytes()) &#123; break; &#125; else &#123; continue; &#125; &#125; &#125;&#125;// step 4final void decodeRemovalReentryProtection(ChannelHandlerContext ctx, ByteBuf in , List &lt; Object &gt; out) throws Exception &#123; // ... // å¼€å§‹è°ƒç”¨è§£ç å™¨å­ç±»çš„decodeæ–¹æ³•äº† decode(ctx, in, out); // ...&#125;// step 5static void fireChannelRead(ChannelHandlerContext ctx, CodecOutputList msgs, int numElements) &#123; for (int i = 0; i &lt; numElements; i++) &#123; // msgs.getUnsafe(i)ä¿è¯æˆbyteBuf // è¿™é‡Œå¯èƒ½å°±ä¼šä¼ æ’­åˆ°ä¸šåŠ¡çš„å¤„ç†å™¨ ctx.fireChannelRead(msgs.getUnsafe(i)); &#125;&#125; LineBasedFrameDecoderæˆ‘ä»¬æŒ‘é€‰äº†åŸºäºåˆ†éš”ç¬¦è§£ç å™¨LineBasedFrameDecoderæ¥åˆ†æï¼Œå®ƒå¯ä»¥åŒæ—¶å¤„ç† \nä»¥åŠ\r\nä¸¤ç§ç±»å‹çš„è¡Œåˆ†éš”ç¬¦ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„decodeæ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778// step 1 (è§£ç å™¨æ¨¡æ¿)protected final void decode(ChannelHandlerContext ctx, ByteBuf in , List &lt; Object &gt; out) throws Exception &#123; // step 2 Object decoded = decode(ctx, in); if (decoded != null) &#123; // æ‹†é™¤ä¸€ä¸ªæ•°æ®åŒ…å°±æ”¾è¿›Listé‡Œ out.add(decoded); &#125;&#125;// step 2 LineBasedFrameDecoderprivate boolean discarding;protected Object decode(ChannelHandlerContext ctx, ByteBuf buffer) throws Exception &#123; // æ‰¾åˆ°æ¢è¡Œç¬¦ä½ç½® final int eol = findEndOfLine(buffer); // ç¬¬ä¸€æ¬¡æ‹†åŒ…ä¸åœ¨ä¸¢å¼ƒæ¨¡å¼ä¸‹ if (!discarding) &#123; // éä¸¢å¼ƒæ¨¡å¼ä¸‹ // æ‰¾åˆ°åˆ†éš”ç¬¦ if (eol &gt;= 0) &#123; final ByteBuf frame; final int length = eol - buffer.readerIndex(); final int delimLength = buffer.getByte(eol) == '\r' ? 2 : 1; // åˆ¤æ–­æ‹†åŒ…çš„é•¿åº¦æ˜¯å¦å¤§äºå…è®¸çš„æœ€å¤§é•¿åº¦ï¼ŒmaxLengthæ„é€ æ—¶ä¼ å…¥ if (length &gt; maxLength) &#123; // è¶…å‡ºæœ€å¤§é•¿åº¦åˆ™ä¸¢å¼ƒè¿™æ®µæ•°æ®ï¼ŒæŠ›å‡ºå¼‚å¸¸ buffer.readerIndex(eol + delimLength); fail(ctx, length); return null; &#125; // è§£ç æ•°æ®æ˜¯å¦è¦åŒ…å«åˆ†éš”ç¬¦ if (stripDelimiter) &#123; // ä¸åŒ…å« frame = buffer.readRetainedSlice(length); buffer.skipBytes(delimLength); &#125; else &#123; // åŒ…å« frame = buffer.readRetainedSlice(length + delimLength); &#125; // è¿”å›æ‹†åŒ…åå°è£…æˆçš„å¸§ return frame; &#125; else &#123; // æ²¡æ‰¾åˆ°åˆ†éš”ç¬¦ final int length = buffer.readableBytes(); if (length &gt; maxLength) &#123; // å¦‚æœå¤§äºæœ€å¤§é•¿åº¦ï¼Œè¿›å…¥ä¸¢å¼ƒæ¨¡å¼ // ä¿å­˜ä¸¢å¼ƒé•¿åº¦ discardedBytes = length; buffer.readerIndex(buffer.writerIndex()); discarding = true; offset = 0; if (failFast) &#123; fail(ctx, "over " + discardedBytes); &#125; &#125; // ä¸å¤§äºï¼Œåˆ™è¿”å›null return null; &#125; &#125; else &#123; // ä¸¢å¼ƒæ¨¡å¼ä¸‹ if (eol &gt;= 0) &#123; // æ‰¾åˆ°åˆ†å‰²ç¬¦ final int length = discardedBytes + eol - buffer.readerIndex(); final int delimLength = buffer.getByte(eol) == '\r' ? 2 : 1; buffer.readerIndex(eol + delimLength); discardedBytes = 0; discarding = false; if (!failFast) &#123; fail(ctx, length); &#125; &#125; else &#123; // ä¿å­˜ä¸¢å¼ƒé•¿åº¦ discardedBytes += buffer.readableBytes(); // æ”¹å˜è¯»æŒ‡é’ˆä½ç½® buffer.readerIndex(buffer.writerIndex()); &#125; return null; &#125;&#125; æ€»ç»“å…¶ä»–çš„è§£ç å™¨ä¹Ÿå¯ä»¥æ ¹æ®LineBasedFrameDecoderçš„æ€è·¯å»åˆ†æã€‚å½“ç„¶æˆ‘ä»¬æœ€éœ€è¦å…³æ³¨çš„è¿˜æ˜¯æ•´ä¸ªè§£ç å™¨çš„è®¾è®¡æ€æƒ³ã€‚å­¦ä¼šå»æŠ½è±¡ä¸€ç±»ä¸œè¥¿ã€‚ å‚è€ƒ nettyæºç åˆ†æä¹‹æ‹†åŒ…å™¨çš„å¥¥ç§˜]]></content>
      <categories>
        <category>Nettyæºç </category>
      </categories>
      <tags>
        <tag>Netty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nettyæºç ä¹‹ChannelPipeline]]></title>
    <url>%2F2018%2F08%2F06%2FNetty%E6%BA%90%E7%A0%81%2FNetty%E6%BA%90%E7%A0%81%E4%B9%8BChannelPipeline%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå…¶å®å‰é¢å°±å¤šæ¬¡æåˆ°äº†ChannelPipelineï¼Œä½†æ˜¯éƒ½æ²¡æœ‰è¯¦ç»†è¯´æ˜ChannelPipelineæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å…·ä½“çœ‹çœ‹è¿™ä¸ªç®¡ç†å¤„ç†é€»è¾‘çš„æŠ½è±¡ä»¥åŠå¤„ç†é€»è¾‘çš„æŠ½è±¡ChannelHandlerã€‚ ChannelPipelineçš„åˆ›å»ºé€šè¿‡å‰é¢çš„è®²è§£ï¼Œæˆ‘ä»¬åº”è¯¥è¿˜è®°å¾—ä¸€ä¸ªChannelå¯¹åº”äº†ä¸€ä¸ªChannelPipelineï¼Œè€ŒChannelPipelineä¹Ÿå°±æ˜¯åœ¨åˆ›å»ºChannelçš„æ—¶å€™éšä¹‹åˆ›å»ºçš„ã€‚æˆ‘ä»¬å°±ä»é‚£é‡Œå¼€å§‹ã€‚ 1234567891011121314151617181920212223// step 1 AbstractChannelçš„åˆ›å»ºprotected AbstractChannel(Channel parent) &#123; this.parent = parent; id = newId(); unsafe = newUnsafe(); // step 2 ChannelPipelineçš„åˆ›å»º pipeline = newChannelPipeline();&#125;// step 2protected DefaultChannelPipeline newChannelPipeline() &#123; // step 3 return new DefaultChannelPipeline(this);&#125;// step 3protected DefaultChannelPipeline(Channel channel) &#123; // ç»‘å®šchannel this.channel = ObjectUtil.checkNotNull(channel, "channel"); // é»˜è®¤åˆ›å»ºä¸€ä¸ªç”±å¤´å°¾èŠ‚ç‚¹çš„åŒå‘é“¾è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹èŠ‚ç‚¹çš„ç±»å‹ tail = new TailContext(this); head = new HeadContext(this); head.next = tail; tail.prev = head;&#125; ChannelPipelineåˆ›å»ºå®Œæ¯•ï¼ï¼ èŠ‚ç‚¹çš„æ·»åŠ èŠ‚ç‚¹çš„æ·»åŠ æˆ‘ä»¬å¿…ç„¶è¦ä»æˆ‘ä»¬è§è¿‡çš„ChannelPipelineçš„addLast(handler)æ–¹æ³•å¼€å§‹åˆ†æï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960// step 1public final ChannelPipeline addLast(ChannelHandler handler) &#123; // step 2 return addLast(null, handler);&#125;// step 2public final ChannelPipeline addLast(String name, ChannelHandler handler) &#123; // step 3 return addLast(null, name, handler);&#125;// step 3public final ChannelPipeline addLast(EventExecutorGroup group, String name, ChannelHandler handler) &#123; final AbstractChannelHandlerContext newCtx; // åŒæ­¥ synchronized(this) &#123; // æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤èŠ‚ç‚¹ checkMultiplicity(handler); // å°†handleråŒ…è£…æˆèŠ‚ç‚¹ä¸Šä¸‹æ–‡ DefaultChannelHandlerContext // step 4 newCtx = newContext(group, filterName(name, handler), handler); // æ·»åŠ èŠ‚ç‚¹ step 7 addLast0(newCtx); &#125; // å›è°ƒå¤„ç†å™¨è¢«æ·»åŠ çš„æ–¹æ³• callHandlerAdded0(newCtx); return this;&#125;// step 4private AbstractChannelHandlerContext newContext(EventExecutorGroup group, String name, ChannelHandler handler) &#123; // step 5 return new DefaultChannelHandlerContext(this, childExecutor(group), name, handler);&#125;// step 5DefaultChannelHandlerContext(DefaultChannelPipeline pipeline, EventExecutor executor, String name, ChannelHandler handler) &#123; // step 6 isInBound,isOutBountå·²ç»ç¡®å®šäº† super(pipeline, executor, name, isInbound(handler), isOutbound(handler)); // ç»‘å®šhandler this.handler = handler;&#125;// step 6AbstractChannelHandlerContext(DefaultChannelPipeline pipeline, EventExecutor executor, String name, boolean inbound, boolean outbound) &#123; // è®¾å®šåå­— this.name = ObjectUtil.checkNotNull(name, "name"); // ç»‘å®špipeline this.pipeline = pipeline; // ç»‘å®šNioEventLoop this.executor = executor; // è¡¨ç¤ºè‡ªå·±æ˜¯inboundå¤„ç†å™¨è¿˜æ˜¯outboundå¤„ç†å™¨ï¼Œåé¢æ ¹æ®è¿™ä¸ªå€¼æ¥åˆ¤æ–­ this.inbound = inbound; this.outbound = outbound;&#125;// step 7private void addLast0(AbstractChannelHandlerContext newCtx) &#123; // æ·»åŠ åˆ°Pipelineçš„é‚£ä¸ªåŒå‘é“¾è¡¨ä¸­ AbstractChannelHandlerContext prev = tail.prev; newCtx.prev = prev; newCtx.next = tail; prev.next = newCtx; tail.prev = newCtx;&#125; èŠ‚ç‚¹çš„åˆ é™¤å’ŒChannelPipelineçš„addLast(handler)ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ChannelPipelineçš„remove(handler)æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627// step 1public final ChannelPipeline remove(ChannelHandler handler) &#123; // æˆ‘ä»¬çŸ¥é“èŠ‚ç‚¹æ˜¯ä¿è¯äº†handlerçš„AbstractChannelHandlerContext // step 2 remove(getContextOrDie(handler)); return this;&#125;// step 2private AbstractChannelHandlerContext remove(final AbstractChannelHandlerContext ctx) &#123; assert ctx != head &amp;&amp; ctx != tail; // åŒæ­¥ synchronized(this) &#123; // step 3 remove0(ctx); &#125; // å›è°ƒèŠ‚ç‚¹çš„åˆ é™¤æ–¹æ³• callHandlerRemoved0(ctx); return ctx;&#125;// step 3private static void remove0(AbstractChannelHandlerContext ctx) &#123; // å°±æ˜¯åŒå‘é“¾è¡¨çš„åˆ é™¤ AbstractChannelHandlerContext prev = ctx.prev; AbstractChannelHandlerContext next = ctx.next; prev.next = next; next.prev = prev;&#125; å…¥ç«™äº‹ä»¶çš„ä¼ æ’­å…¶å®æˆ‘ä»¬åº”è¯¥å·²ç»ç»å†è¿‡äº†ï¼Œæºå¤´éƒ½æ˜¯åœ¨ä»Unsafeå¯¹è±¡(å®ƒè´Ÿè´£æœ€åº•å±‚çš„IOæ“ä½œ)å‡ºå‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»NioEventLoopçš„è¿™ä¸€æ®µä»£ç å‡ºå‘ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192// step 1private void processSelectedKey(SelectionKey k, AbstractNioChannel ch) &#123; // ... if ((readyOps &amp; (SelectionKey.OP_READ | SelectionKey.OP_ACCEPT)) != 0 || readyOps == 0) &#123; // æ¥å—IOäº‹ä»¶ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨SeverSocketChannelå’ŒSocketChannelå¤„ç†çš„äº‹ä»¶æ˜¯ä¸ä¸€æ ·çš„ // æˆ‘ä»¬ä¸»è¦åˆ†æSocketChannelçš„è¯»äº‹ä»¶ï¼Œå¯¹åº”çš„Unsafeå¯¹è±¡æ˜¯NioByteUnSafe // step 2 unsafe.read(); &#125;&#125;// step 2 AbstractNioByteChannelçš„NioByteUnSafepublic final void read() &#123; final ChannelConfig config = config(); final ChannelPipeline pipeline = pipeline(); // åˆ›å»ºByteBufåˆ†é…å™¨ final ByteBufAllocator allocator = config.getAllocator(); // æ§åˆ¶è¿æ¥æ•° final RecvByteBufAllocator.Handle allocHandle = recvBufAllocHandle(); allocHandle.reset(config); ByteBuf byteBuf = null; do &#123; // åˆ†é…ä¸€ä¸ªbyteBuf byteBuf = allocHandle.allocate(allocator); // è¯»æ•°æ® allocHandle.lastBytesRead(doReadBytes(byteBuf)); allocHandle.incMessagesRead(1); readPending = false; // è§¦å‘è¯»äº‹ä»¶ï¼Œè¿™æ˜¯æˆ‘ä»¬è¦å…³æ³¨çš„é‡ç‚¹ // step 3 pipeline.fireChannelRead(byteBuf); byteBuf = null; &#125; while ( allocHandle . continueReading ()); allocHandle.readComplete(); // è§¦å‘è¯»å®Œæˆäº‹ä»¶ pipeline.fireChannelReadComplete();&#125;// step 3public final ChannelPipeline fireChannelRead(Object msg) &#123; // å‡ºå‘å¤´èŠ‚ç‚¹çš„è¯»äº‹ä»¶ // step 4 AbstractChannelHandlerContext.invokeChannelRead(head, msg); return this;&#125;// step 4static void invokeChannelRead(final AbstractChannelHandlerContext next, Object msg) &#123; final Object m = next.pipeline.touch(ObjectUtil.checkNotNull(msg, "msg"), next); // è°ƒç”¨å¤´èŠ‚ç‚¹çš„channelReadæ–¹æ³• // step 5 next.invokeChannelRead(m);&#125;// step 5private void invokeChannelRead(Object msg) &#123; // è°ƒç”¨å¤´èŠ‚ç‚¹çš„channelReadæ–¹æ³• // step 6 ((ChannelInboundHandler) handler()).channelRead(this, msg);&#125;// step 6public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception &#123; // ç»§ç»­ä¼ é€’è¯»äº‹ä»¶ // step 7 ctx.fireChannelRead(msg);&#125;// step 7public ChannelHandlerContext fireChannelRead(final Object msg) &#123; // æ‰¾åˆ°ä¸‹ä¸€ä¸ªå…¥ç«™èŠ‚ç‚¹ // step 8 findContextInbound // step 9 ä¼šé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œå¦‚æœæ¶ˆæ¯æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œé‚£ä¹ˆå°†ä¸€ç›´ä¼ é€’åˆ°tailèŠ‚ç‚¹(æœ€åä¸€ä¸ªinboundèŠ‚ç‚¹public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception &#123; onUnhandledInboundMessage(msg);&#125;) invokeChannelRead(findContextInbound(), msg); return this;&#125;// step 8private AbstractChannelHandlerContext findContextInbound() &#123; AbstractChannelHandlerContext ctx = this; do &#123; ctx = ctx.next; // å¯ä»¥çœ‹åˆ°æ˜¯æ ¹æ®æ ‡å¿—ä½æ¥åˆ¤å®šçš„ &#125; while (! ctx . inbound ); return ctx;&#125;// step 9 DefaultChannelPipelineçš„TailContextpublic void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception &#123; // step 10 onUnhandledInboundMessage(msg);&#125;protected void onUnhandledInboundMessage(Object msg) &#123; // å¦‚æœæ¶ˆæ¯ä¸€ç›´æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œå°†åœ¨tailèŠ‚ç‚¹è¢«é‡Šæ”¾ ReferenceCountUtil.release(msg);&#125; å‡ºç«™äº‹ä»¶çš„ä¼ æ’­å‡ºç«™äº‹ä»¶ä¸€èˆ¬æ˜¯å†™äº‹ä»¶ï¼Œæœ‰ä¸¤ç§å†™éœ€è¦åŒºåˆ«ä¸€ä¸‹ï¼šï¼ˆæ¥è‡ªnettyæºç ä¸­telnetä¾‹å­ï¼‰ 12ChannelFuture future = ctx.channel().write(response); // 1ChannelFuture future = ctx.write(response); // 2 æˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ç§ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455// step 1public void channelRead0(ChannelHandlerContext ctx, String request) throws Exception &#123; // step 2 ChannelFuture future = ctx.channel().write(response);&#125;// step 2 AbstractChannelpublic ChannelFuture write(Object msg) &#123; // step 3 return pipeline.write(msg);&#125;// step 3 DefaultChannelPipelinepublic final ChannelFuture write(Object msg) &#123; // ç›´æ¥è°ƒç”¨tailçš„å†™æ–¹æ³• // step 4 return tail.write(msg);&#125;// step 5 AbstractChannelHandlerContextpublic ChannelFuture write(Object msg) &#123; // step 6 return write(msg, newPromise());&#125;// step 6 AbstractChannelHandlerContextpublic ChannelFuture write(final Object msg, final ChannelPromise promise) &#123; // åŠ ä¸Šæ˜¯å¦flushçš„ä¿¡æ¯ // step 7 write(msg, false, promise);&#125;// step 7private void write(Object msg, boolean flush, ChannelPromise promise) &#123; // å’Œè¿›ç«™ç›¸è¯†ï¼Œè¿™é‡Œæ‰¾çš„å‡ºç«™èŠ‚ç‚¹ AbstractChannelHandlerContext next = findContextOutbound(); final Object m = pipeline.touch(msg, next); EventExecutor executor = next.executor(); if (flush) &#123; next.invokeWriteAndFlush(m, promise); &#125; else &#123; // è°ƒç”¨ä¸‹ä¸€ä¸ªå‡ºç«™èŠ‚ç‚¹çš„å†™æ–¹æ³• next.invokeWrite(m, promise); &#125;&#125;// step 7private void invokeWrite(Object msg, ChannelPromise promise) &#123; // step 8 invokeWrite0(msg, promise);&#125;// step 8private void invokeWrite0(Object msg, ChannelPromise promise) &#123; // step 9 ä¼šç›´æ¥è°ƒç”¨åˆ°HeadContextçš„writeæ–¹æ³• ((ChannelOutboundHandler) handler()).write(this, msg, promise);&#125;// step 9public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception &#123; // åˆ©ç”¨unsafeå†™å…¥(æ˜ç™½æµç¨‹å°±å¥½ï¼Œå…³äºå…·ä½“æ€ä¹ˆå†™å…¥å°†æ”¾åˆ°ç¼–ç å™¨çš„åšæ–‡ä¸Š) unsafe.write(msg, promise);&#125; ç¬¬äºŒç§æƒ…å†µï¼š 12345678910// step 1public void channelRead0(ChannelHandlerContext ctx, String request) throws Exception &#123; // step 2 ChannelFuture future = ctx.write(response);&#125;// step 2public ChannelFuture write(final Object msg, final ChannelPromise promise) &#123; // ç›´æ¥ä»å½“å‰èŠ‚ç‚¹å†™ï¼Œåé¢å°±å’Œç¬¬ä¸€ç§æƒ…å†µä¸€æ ·äº† write(msg, false, promise);&#125; å‚è€ƒ nettyæºç åˆ†æä¹‹pipeline(ä¸€) nettyæºç åˆ†æä¹‹pipeline(äºŒ)]]></content>
      <categories>
        <category>Nettyæºç </category>
      </categories>
      <tags>
        <tag>Netty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nettyæºç ä¹‹æ–°è¿æ¥æ¥å…¥]]></title>
    <url>%2F2018%2F08%2F06%2FNetty%E6%BA%90%E7%A0%81%2FNetty%E6%BA%90%E7%A0%81%E4%B9%8B%E6%96%B0%E8%BF%9E%E6%8E%A5%E6%8E%A5%E5%85%A5%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¹‹å‰å¯¹æœåŠ¡ç«¯å’ŒNioEventLoopéƒ½æœ‰äº†ä¸€å®šçš„åˆ†æï¼Œç›¸ä¿¡å¤§å®¶çš„æœåŠ¡ç«¯åº”è¯¥å·²ç»è™šä½ä»¥å¾…äº†ã€‚å¥½çš„ï¼Œæˆ‘ä»¬ç°åœ¨å°±å¼€å§‹åˆ†ææ–°è¿æ¥æ¥å…¥ã€‚ æ–°è¿æ¥æ£€æµ‹ç”¨è¿‡NIOçš„äººéƒ½ä¼šçŸ¥é“æ–°è¿æ¥æ£€æµ‹åº”è¯¥åœ¨å¤„ç†selectå‡ºæ¥çš„SelectedKeyä¸­å‡ºç°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä»è¿™å¼€å§‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960// step 1private void processSelectedKey(SelectionKey k, AbstractNioChannel ch) &#123; final AbstractNioChannel.NioUnsafe unsafe = ch.unsafe(); eventLoop = ch.eventLoop(); int readyOps = k.readyOps(); if ((readyOps &amp; SelectionKey.OP_CONNECT) != 0) &#123; int ops = k.interestOps(); ops &amp;= ~SelectionKey.OP_CONNECT; k.interestOps(ops); unsafe.finishConnect(); &#125; if ((readyOps &amp; SelectionKey.OP_WRITE) != 0) &#123; ch.unsafe().forceFlush(); &#125; // ä¼šè¿›å…¥åˆ°è¿™é‡Œ(æ¥æ”¶è¿æ¥) if ((readyOps &amp; (SelectionKey.OP_READ | SelectionKey.OP_ACCEPT)) != 0 || readyOps == 0) &#123; // step 2 unsafe.read(); &#125;&#125;// step 2 AbstractNioMessageChannelpublic void read() &#123; final ChannelConfig config = config(); final ChannelPipeline pipeline = pipeline(); // æ§åˆ¶è¯»å–è¿æ¥çš„é€Ÿç‡ï¼Œé»˜è®¤ä¸€æ¬¡è¯»å–16ä¸ªè¿æ¥ final RecvByteBufAllocator.Handle allocHandle = unsafe().recvBufAllocHandle(); allocHandle.reset(config); do &#123; // step 3 int localRead = doReadMessages(readBuf); // å¯¹è¿æ¥æ•°å¢åŠ  allocHandle.incMessagesRead(localRead); &#125; while ( allocHandle . continueReading ()); int size = readBuf.size(); for (int i = 0; i &lt; size; i++) &#123; readPending = false; // è§¦å‘è¯»äº‹ä»¶ï¼Œç»‘å®šåˆ°NioEventLoop pipeline.fireChannelRead(readBuf.get(i)); &#125; readBuf.clear(); allocHandle.readComplete(); pipeline.fireChannelReadComplete();&#125;// step 3protected int doReadMessages(List &lt; Object &gt; buf) throws Exception &#123; // ç†Ÿæ‚‰çš„acceptæ–¹æ³•ï¼Œç†Ÿæ‚‰çš„javaChannel()æ‹¿åˆ°serverSocketChannel // step 4 SocketChannel ch = SocketUtils.accept(javaChannel()); // å°è£…æˆNioSocketChannelï¼Œè¿›å…¥åˆ›å»ºéƒ¨åˆ† buf.add(new NioSocketChannel(this, ch));&#125;// step 4public static SocketChannel accept(final ServerSocketChannel serverSocketChannel) throws IOException &#123; // è¿”å›SocketChannel(æ–°å‡ºæ¥çš„AccessControllerè¿˜éœ€è¦ç ”ç©¶) return AccessController.doPrivileged(new PrivilegedExceptionAction &lt; SocketChannel &gt; () &#123;@Override public SocketChannel run() throws IOException &#123; return serverSocketChannel.accept(); &#125; &#125;);&#125; æ£€æµ‹å®Œæ¯•ï¼ï¼ï¼ åˆ›å»ºChannel123456789101112131415161718192021222324252627282930// step 1 NioSocketChannelpublic NioSocketChannel(Channel parent, SocketChannel socket) &#123; super(parent, socket); // åŒæ ·åˆ›å»ºä¸€ä¸ªconfigï¼Œè¿™é‡Œè®¾ç½®äº†ç¦æ­¢Nagleç®—æ³•(è®©æ•°æ®å°½å¿«å‘å‡ºå»ï¼Œè€Œä¸æ˜¯è®©å°æ•°æ®åŒ…å˜å¤§å†å‘) config = new NioSocketChannelConfig(this, socket.socket());&#125;// step 2 AbstractNioByteChannelprotected AbstractNioByteChannel(Channel parent, SelectableChannel ch) &#123; // è¿™é‡Œè¦å‡†å¤‡ç»‘å®šè¯»äº‹ä»¶äº† // step 3 super(parent, ch, SelectionKey.OP_READ);&#125;// step 3protected AbstractNioChannel(Channel parent, SelectableChannel ch, int readInterestOp) &#123; // step 4 super(parent); this.ch = ch; // è®¾å®šä¸ºå¯¹è¯»äº‹ä»¶æ„Ÿå…´è¶£ this.readInterestOp = readInterestOp; // è®¾ç½®ä¸ºéé˜»å¡ ch.configureBlocking(false);&#125;// step 4protected AbstractChannel(Channel parent) &#123; this.parent = parent; // ä¹Ÿç»™è‡ªå·±åˆ†é…è¿™äº›ä¸œè¥¿ id = newId(); unsafe = newUnsafe(); pipeline = newChannelPipeline();&#125; Channelæ³¨å†Œç»‘å®š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849// step 1 DefaultChannelPipelinepublic final ChannelPipeline fireChannelRead(Object msg) &#123; // step 2 AbstractChannelHandlerContext.invokeChannelRead(head, msg); return this;&#125;// step 2static void invokeChannelRead(final AbstractChannelHandlerContext next, Object msg) &#123; final Object m = next.pipeline.touch(ObjectUtil.checkNotNull(msg, "msg"), next); // è¿˜æ˜¯é‚£ä¸ªçº¿ç¨‹ç”Ÿæˆå™¨ EventExecutor executor = next.executor(); // step 3 next.invokeChannelRead(m);&#125;// step 3private void invokeChannelRead(Object msg) &#123; // step 4 å®ƒä¼šä¸€ç›´è®²äº‹ä»¶ä¼ æ’­åˆ°å†æœåŠ¡ç«¯å¯åŠ¨è¿‡ç¨‹ä¸­æ·»åŠ åˆ°Pipelineçš„ServerBootstrapAcceptor ((ChannelInboundHandler) handler()).channelRead(this, msg);&#125;// step 4 ServerBootstrapé‡Œçš„ServerBootstrapAcceptorpublic void channelRead(ChannelHandlerContext ctx, Object msg) &#123; final Channel child = (Channel) msg; // è®¾ç½®ä¸€ç³»åˆ—ä¿¡æ¯ child.pipeline().addLast(childHandler); setChannelOptions(child, childOptions, logger); for (Entry &lt; AttributeKey &lt; ?&gt;, Object &gt; e: childAttrs) &#123; child.attr((AttributeKey &lt; Object &gt; ) e.getKey()).set(e.getValue()); &#125; // å¿½ç•¥ç»†èŠ‚ï¼Œå…³æ³¨registeræ–¹æ³•(è¿™é‡Œæ˜¯childGroup) // step 5 childGroup.register(child);&#125;// step 5 MultithreadEventLoopGrouppublic ChannelFuture register(Channel channel) &#123; // è¿™é‡Œçš„nextæ–¹æ³•ä¼šå»æ‹¿åˆ°ä¹‹å‰ServerChannelåˆå§‹åŒ–çš„EventLoopæ•°ç»„çš„ä¸€ä¸ª // step 6 return next().register(channel);&#125;// step 6 SingleThreadEventLooppublic ChannelFuture register(Channel channel) &#123; // çœ‹åˆ°è¿™é‡Œä¼šå‘ç°æ³¨å†Œæµç¨‹åŸºæœ¬å’ŒServerSocketChanneæ˜¯ä¸€æ ·çš„ // step 7 return register(new DefaultChannelPromise(channel, this));&#125;// step 7public ChannelFuture register(final ChannelPromise promise) &#123; // çœ‹åˆ°è¿™é‡Œï¼Œå‰©ä¸‹çš„åŸºæœ¬ä¸Šå°±å¯ä»¥å‚è€ƒæœåŠ¡ç«¯å¯åŠ¨æµç¨‹äº† promise.channel().unsafe().register(this, promise);&#125; æ€»ç»“ ServerSocketChannelç»‘å®šçš„EventLoopè½®è¯¢åˆ°æœ‰æ–°çš„è¿æ¥è¿›å…¥ é€šè¿‡å°è£…jdkåº•å±‚çš„channelåˆ›å»º NioSocketChannelä»¥åŠä¸€ç³»åˆ—çš„nettyæ ¸å¿ƒç»„ä»¶ å°†è¯¥cahnnelé€šè¿‡chooserï¼Œé€‰æ‹©ä¸€ä¸ªEventLoopç»‘å®šä¸Šå» æ³¨å†Œè¯»äº‹ä»¶ï¼Œå¼€å§‹æ–°è¿æ¥çš„è¯»å†™ï¼ˆå¯ä»¥å‚è€ƒæœåŠ¡ç«¯å¯åŠ¨æµç¨‹ï¼‰ å‚è€ƒ nettyæºç åˆ†æä¹‹æ–°è¿æ¥æ¥å…¥å…¨è§£æ]]></content>
      <categories>
        <category>Nettyæºç </category>
      </categories>
      <tags>
        <tag>Netty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nettyæºç ä¹‹NioEventLoop]]></title>
    <url>%2F2018%2F08%2F06%2FNetty%E6%BA%90%E7%A0%81%2FNetty%E6%BA%90%E7%A0%81%E4%B9%8BNioEventLoop%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè°ˆåˆ°Nettyå°±é¿å…ä¸äº†å»è°ˆReactoræ¨¡å¼ï¼Œä¸æ‡‚çš„åŒå­¦åŒè‡ªè¡Œé¢å‘æœç´¢å¼•æ“ã€‚åœ¨Nettyä¸­çš„Reactorçº¿ç¨‹çš„å…·ä½“å®ç°å°±æ˜¯NioEventLoopã€‚ NioEventLoopåˆ›å»ºæˆ‘ä»¬å…ˆæ€»ç»“è¿™ä¸ªè¿‡ç¨‹çš„æµç¨‹ï¼š è®¾ç½®EventLoopæ•°é‡ åˆ›å»ºçº¿ç¨‹åˆ›å»ºå™¨ åˆ›å»ºNioEventLoopï¼ˆé…ç½®selectorå’ŒtaskQueueç­‰å‚æ•°ï¼‰ åˆ›å»ºçº¿ç¨‹é€‰æ‹©å™¨ æˆ‘ä»¬å›åˆ°ä¸Šä¸€ä¸ªä¾‹å­çš„ï¼š 12EventLoopGroup bossGroup = new NioEventLoopGroup(1); // ç”¨äºå¤„ç†serverChannelEventLoopGroup workerGroup = new NioEventLoopGroup(); // ç”¨äºå¤„ç†channel æˆ‘ä»¬è¿›å…¥åˆ°NioEventLoopGroupçš„æ„é€ æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120// step 1public NioEventLoopGroup(int nThreads) &#123; // æ²¡æœ‰ä¼ é€’çº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º0 // step 2 this(nThreads, (Executor) null);&#125;// step 2public NioEventLoopGroup(int nThreads, Executor executor) &#123; // ç»‘å®šé»˜è®¤çš„SelectorProvider // step 3 this(nThreads, executor, SelectorProvider.provider());&#125;// step 4public NioEventLoopGroup(int nThreads, Executor executor, final SelectorProvider selectorProvider) &#123; // ç»‘å®šé»˜è®¤çš„Selectorç­–ç•¥å·¥å‚ï¼Œå¯èƒ½select()é˜»å¡æˆ–è€…é‡è¯• // step 5 this(nThreads, executor, selectorProvider, DefaultSelectStrategyFactory.INSTANCE);&#125;// step 5public NioEventLoopGroup(int nThreads, Executor executor, final SelectorProvider selectorProvider, final SelectStrategyFactory selectStrategyFactory) &#123; // è°ƒç”¨çˆ¶ç±»MultithreadEventLoopGroupæ„é€ æ–¹æ³•ï¼Œç»‘å®šRejectedExecutionHandler(ï¼Ÿï¼Ÿ) // step 6 super(nThreads, executor, selectorProvider, selectStrategyFactory, RejectedExecutionHandlers.reject());&#125;// step 6 MultithreadEventLoopGroupprotected MultithreadEventLoopGroup(int nThreads, Executor executor, Object...args) &#123; // step 7 æŸ¥çœ‹é»˜è®¤çº¿ç¨‹ä¸ªæ•° // step 8 super(nThreads == 0 ? DEFAULT_EVENT_LOOP_THREADS: nThreads, executor, args);&#125;// step 7static &#123; // æˆ‘ä»¬å‘ç°æ˜¯ä¸¤å€çš„CPUæ ¸æ•°(å½“ç„¶è¿™é‡Œæ˜¯workGroup) DEFAULT_EVENT_LOOP_THREADS = Math.max(1, SystemPropertyUtil.getInt("io.netty.eventLoopThreads", NettyRuntime.availableProcessors() * 2));&#125;// step 8protected MultithreadEventExecutorGroup(int nThreads, Executor executor, Object...args) &#123; // ç»‘å®šäº†DefaultEventExecutorChooserå·¥å‚(è¯¥å·¥å‚é»˜è®¤è½®è¯¢ç­–ç•¥) // step 9 this(nThreads, executor, DefaultEventExecutorChooserFactory.INSTANCE, args);&#125;// step 9protected MultithreadEventExecutorGroup(int nThreads, Executor executor, EventExecutorChooserFactory chooserFactory, Object...args) &#123; // ** åˆ›å»ºçº¿ç¨‹å™¨ç”Ÿæˆå™¨ // step 10 executor = new ThreadPerTaskExecutor(newDefaultThreadFactory()); // äº‹ä»¶æ‰§è¡Œå™¨æ•°ç»„ children = new EventExecutor[nThreads]; for (int i = 0; i &lt; nThreads; i++) &#123; // ** åˆ›å»º NioEventLoop // step 11 children[i] = newChild(executor, args); &#125; // ** åˆ›å»ºçº¿ç¨‹é€‰æ‹©å™¨ // step 15 chooser = chooserFactory.newChooser(children); Set &lt; EventExecutor &gt; childrenSet = new LinkedHashSet &lt; EventExecutor &gt; (children.length); Collections.addAll(childrenSet, children); readonlyChildren = Collections.unmodifiableSet(childrenSet);&#125;// step 10public final class ThreadPerTaskExecutor implements Executor &#123; private final ThreadFactory threadFactory; public ThreadPerTaskExecutor(ThreadFactory threadFactory) &#123; // ç»‘å®šçº¿ç¨‹å·¥å‚ this.threadFactory = threadFactory; &#125; @Override public void execute(Runnable command) &#123; threadFactory.newThread(command).start(); &#125;&#125;// step 11protected EventLoop newChild(Executor executor, Object...args) throws Exception &#123; // ç»‘å®šSelectStrategyå’ŒRejectedExecutionHandler // step 12 return new NioEventLoop(this, executor, (SelectorProvider) args[0], ((SelectStrategyFactory) args[1]).newSelectStrategy(), (RejectedExecutionHandler) args[2]);&#125;// step 12 NioEventLoopprivate volatile int ioRatio = 50;NioEventLoop(NioEventLoopGroup parent, Executor executor, SelectorProvider selectorProvider, SelectStrategy strategy, RejectedExecutionHandler rejectedExecutionHandler) &#123; super(parent, executor, false, DEFAULT_MAX_PENDING_TASKS, rejectedExecutionHandler); // ä¿å­˜selectorProvider provider = selectorProvider; // è¿™é‡Œåˆ›å»ºselectorï¼Œé‡Œé¢åˆ›å»ºäº†SelectedSelectionKeySet final SelectorTuple selectorTuple = openSelector(); // ä¿å­˜selector ä¸€ä¸ªselectorä¼šä¸ä¸€ä¸ªEventLoopåšå”¯ä¸€çš„ç»‘å®š selector = selectorTuple.selector; // ä¿å­˜unwrappedSelector(è¿™ä¸ªåœ¨å‰ä¸€ç¯‡åšæ–‡çš„æ—¶å€™ç”¨åˆ°äº†) unwrappedSelector = selectorTuple.unwrappedSelector; selectStrategy = strategy;&#125;// step 13 SingleThreadEventLoopprotected SingleThreadEventLoop(EventLoopGroup parent, Executor executor, boolean addTaskWakesUp, int maxPendingTasks, RejectedExecutionHandler rejectedExecutionHandler) &#123; // step 14 super(parent, executor, addTaskWakesUp, maxPendingTasks, rejectedExecutionHandler); // ä¿å­˜äº†ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ— tailTasks = newTaskQueue(maxPendingTasks);&#125;// step 14 SingleThreadEventExecutorprotected SingleThreadEventExecutor(EventExecutorGroup parent, Executor executor, boolean addTaskWakesUp, int maxPendingTasks, RejectedExecutionHandler rejectedHandler) &#123; super(parent); this.addTaskWakesUp = addTaskWakesUp; this.maxPendingTasks = Math.max(16, maxPendingTasks); // ä¿å­˜ çº¿ç¨‹å™¨ç”Ÿæˆå™¨ this.executor = ObjectUtil.checkNotNull(executor, "executor"); // ä»»åŠ¡é˜Ÿåˆ— taskQueue = newTaskQueue(this.maxPendingTasks); rejectedExecutionHandler = ObjectUtil.checkNotNull(rejectedHandler, "rejectedHandler");&#125;// step 15public EventExecutorChooser newChooser(EventExecutor[] executors) &#123; // è¿™é‡Œæ ¹æ®eventLoopçš„ä¸ªæ•°è¿›è¡Œäº†ä¼˜åŒ–(è‡ªè¡Œäº†è§£) if (isPowerOfTwo(executors.length)) &#123; return new PowerOfTwoEventExecutorChooser(executors); &#125; else &#123; return new GenericEventExecutorChooser(executors); &#125;&#125; åˆ›å»ºå®Œæˆï¼ï¼ï¼ NioEventLoopå¯åŠ¨å®ƒçš„ç¬¬ä¸€æ¬¡å¯åŠ¨è¿˜æ˜¯è¦å›åˆ°å‰ä¸€ç¯‡åšæ–‡çš„è¿™ä¸€ä¸ªæ­¥éª¤ä¸­ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879// step 1 AbstractBootstrappublic final void register(EventLoop eventLoop, final ChannelPromise promise) &#123; // æ‹¿åˆ°ä¹‹å‰ç»‘å®šçš„eventLoop AbstractChannel.this.eventLoop = eventLoop; // step 2 è¿›å…¥inEventLoopæ–¹æ³•ä¸­ if (eventLoop.inEventLoop()) &#123; register0(promise); &#125; else &#123; // æ‰€ä»¥è¿›å…¥è¿™é‡Œäº† // step 4 eventLoop.execute(new Runnable() &#123;@Override public void run() &#123; register0(promise); &#125; &#125;); &#125;&#125;// step 2 AbstractEventExecutorpublic boolean inEventLoop() &#123; // è¿™ä¸ªæ—¶å€™å½“å‰çº¿ç¨‹ä¸ºä¸»çº¿ç¨‹ // step 3 return inEventLoop(Thread.currentThread());&#125;// step 3 SingleThreadEventExecutorpublic boolean inEventLoop(Thread thread) &#123; // è¯¥ç±»ä¸­çš„threadä¸ºnullï¼Œæ‰€æœ‰è¿”å›false return thread == this.thread;&#125;// step 4public void execute(Runnable task) &#123; // è¿˜æ˜¯ä¸»çº¿ç¨‹ï¼Œè¿˜æ˜¯false boolean inEventLoop = inEventLoop(); // å°†ä»»åŠ¡æ·»åŠ åˆ°é˜Ÿåˆ— addTask(task); if (!inEventLoop) &#123; // å¼€å¯çº¿ç¨‹ // step 4 startThread(); &#125; if (!addTaskWakesUp &amp;&amp; wakesUpForTask(task)) &#123; wakeup(inEventLoop); &#125;&#125;// step 4private void startThread() &#123; // state é»˜è®¤ä¸ºST_NOT_STARTEDæ²¡æœ‰å¯åŠ¨ if (state == ST_NOT_STARTED) &#123; // åŸå­æ›´æ–°ä¸ºå¼€å§‹ if (STATE_UPDATER.compareAndSet(this, ST_NOT_STARTED, ST_STARTED)) &#123; // step 5 doStartThread(); &#125; &#125;&#125;// step 5private void doStartThread() &#123; // è¿˜è®°å¾—é‚£ä¸ªexecutorå—ï¼Œå°±æ˜¯é‚£ä¸ªçº¿ç¨‹ç”Ÿæˆå™¨ // step 6 executor.execute(new Runnable() &#123;@Override public void run() &#123; thread = Thread.currentThread(); // æ‰§è¡Œè‡ªå·±çš„runæ–¹æ³• // step 8 SingleThreadEventExecutor.this.run(); &#125;);&#125;// step 6 ThreadPerTaskExecutorpublic void execute(Runnable command) &#123; // åˆ›å»ºçº¿ç¨‹å¹¶å¼€å¯çº¿ç¨‹ // step 7 newThread() // start() è¿”å›åˆ°run() step 6 threadFactory.newThread(command).start();&#125;// step 7public Thread newThread(Runnable r) &#123; // è¿™é‡Œå¯ä»¥çœ‹å‡ºä¸¤ç‚¹ï¼Œ1ï¼Œè¿”å›äº†ä¸€ä¸ªä¼˜åŒ–è¿‡çš„FastThreadLocalRunnableï¼›2ï¼Œçœ‹åˆ°äº†çº¿ç¨‹å // çº¿ç¨‹åçš„ç”±æ¥å¯ä»¥ç™¾åº¦ Thread t = newThread(FastThreadLocalRunnable.wrap(r), prefix + nextId.incrementAndGet()); return t;&#125; å¯åŠ¨å®Œæ¯•äº†ï¼ï¼ï¼ NioEventLoopæ‰§è¡Œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243// step 1 è¿™é‡Œå°±æ˜¯çœŸçš„reactorçº¿ç¨‹çœŸæ­£å¼€å§‹å¹²æ´»çš„åœ°æ–¹protected void run() &#123; // æ­»å¾ªç¯ï¼Œå¹²ä¸‰ä»¶äº‹ // 1. select // 2. process selected keys // 3. run tasks for (;;) &#123; try &#123; // è¿˜æœ‰ä»»åŠ¡åœ¨æ‰§è¡Œç­‰ç€ï¼Œæ²¡æœ‰äº†ï¼Œå°±å¼€å§‹select switch (selectStrategy.calculateStrategy(selectNowSupplier, hasTasks())) &#123; case SelectStrategy.CONTINUE: continue; case SelectStrategy.SELECT: // 1. è½®è¯¢æ³¨å†Œåˆ°EventLoopçš„Selectorä¸Šçš„æ‰€æœ‰channelIOäº‹ä»¶ // wakenUp è¡¨ç¤ºæ˜¯å¦åº”è¯¥å”¤é†’æ­£åœ¨é˜»å¡çš„selectæ“ä½œï¼Œæ¯æ¬¡å¼€å§‹éƒ½ç½®ä¸ºfalse // step 2 select(wakenUp.getAndSet(false)); if (wakenUp.get()) &#123; selector.wakeup(); &#125; // fall through default: &#125; // 2. å¤„ç†äº§ç”ŸIOäº‹ä»¶çš„channel // step 3 processSelectedKeys(); // 3. å¤„ç†ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½†æ˜¯ä¸èƒ½è¶…è¿‡ä¸€ä¸ªæ—¶é—´ // step 8 runAllTasks(ioTime * (100 - ioRatio) / ioRatio); &#125; &#125;&#125; // step 2 è½®è¯¢æ³¨å†Œåˆ°EventLoopçš„Selectorä¸Šçš„æ‰€æœ‰channelIOäº‹ä»¶private void select(boolean oldWakenUp) throws IOException &#123; Selector selector = this.selector; try &#123; int selectCnt = 0; long currentTimeNanos = System.nanoTime(); // è®¾ç½®æˆªæ­¢æ—¶é—´(å½“å‰æ—¶é—´ + å®šæ—¶ä»»åŠ¡çš„å°†è¦æˆªæ­¢çš„æ—¶é—´) // nettyé‡Œé¢å®šæ—¶ä»»åŠ¡é˜Ÿåˆ—æ˜¯æŒ‰ç…§å»¶è¿Ÿæ—¶é—´ä»å°åˆ°å¤§è¿›è¡Œæ’åº // delayNanos(currentTimeNanos)æ–¹æ³•å³å–å‡ºç¬¬ä¸€ä¸ªå®šæ—¶ä»»åŠ¡çš„å»¶è¿Ÿæ—¶é—´ long selectDeadLineNanos = currentTimeNanos + delayNanos(currentTimeNanos); for (;;) &#123; long timeoutMillis = (selectDeadLineNanos - currentTimeNanos + 500000L) / 1000000L; // å¦‚æœè¶…å‡ºæˆªæ­¢æ—¶é—´0.5ms if (timeoutMillis &lt;= 0) &#123; if (selectCnt == 0) &#123; // å¦‚æœåœ¨è·³å‡ºä¹‹å‰å‘ç°è¿˜æ²¡æœ‰è¿›è¡Œè¿‡selectæ“ä½œå°±æ‰§è¡Œä¸€æ¬¡selectNow()(ä¸ä¼šé˜»å¡) selector.selectNow(); selectCnt = 1; &#125; break; &#125; // è½®è¯¢è¿‡ç¨‹ä¸­å‘ç°æœ‰ä»»åŠ¡åŠ å…¥ï¼Œä¸­æ–­æœ¬æ¬¡è½®è¯¢ if (hasTasks() &amp;&amp; wakenUp.compareAndSet(false, true)) &#123; selector.selectNow(); selectCnt = 1; break; &#125; // é˜»å¡æ—¶è½®è¯¢ int selectedKeys = selector.select(timeoutMillis); selectCnt++; if (selectedKeys != 0 || oldWakenUp || wakenUp.get() || hasTasks() || hasScheduledTasks()) &#123; // è¿™é‡Œè¿˜æä¾›äº†4ç§æ–¹å¼æ¥ä¸­æ–­è½®è¯¢ // - è½®è¯¢åˆ°ioäº‹ä»¶, // - ç”¨æˆ·ä¸»åŠ¨å”¤é†’ // - ä»»åŠ¡é˜Ÿåˆ—æœ‰ä»»åŠ¡ // - æœ‰å®šæ—¶ä»»åŠ¡éœ€è¦è¢«å¤„ç† break; &#125; // è¿™é‡Œå°±å¾ˆé‡è¦äº†ï¼Œçœ‹çœ‹Nettyæ˜¯æ€ä¹ˆè§£å†³JDK NIOçš„ç©ºè½®è®­bugçš„ long time = System.nanoTime(); if (time - TimeUnit.MILLISECONDS.toNanos(timeoutMillis) &gt;= currentTimeNanos) &#123; // æœ‰æ•ˆè½®è¯¢ï¼Œé‡ç½®æ ‡å¿—ä½ selectCnt = 1; &#125; else if (SELECTOR_AUTO_REBUILD_THRESHOLD &gt; 0 &amp;&amp; selectCnt &gt;= SELECTOR_AUTO_REBUILD_THRESHOLD) &#123; // å½“ç©ºè½®è®­çš„æ¬¡æ•°è¶…è¿‡SELECTOR_AUTO_REBUILD_THRESHOLD(é»˜è®¤512)æ—¶ï¼Œå°±å¼€å§‹é‡å»ºSelector // step 3 rebuildSelector(); selector = this.selector; // Select again to populate selectedKeys. selector.selectNow(); selectCnt = 1; break; &#125; currentTimeNanos = time; &#125; &#125;&#125; // step 3public void rebuildSelector() &#123; // step 4 rebuildSelector0();&#125;// step 4private void rebuildSelector0() &#123; final Selector oldSelector = selector; final SelectorTuple newSelectorTuple; // åˆ›å»ºä¸€ä¸ªæ–°çš„selector newSelectorTuple = openSelector(); int nChannels = 0; for (SelectionKey key: oldSelector.keys()) &#123; Object a = key.attachment(); int interestOps = key.interestOps(); // å–æ¶ˆkeyåœ¨æ—§çš„selectorä¸Šçš„äº‹ä»¶æ³¨å†Œ key.cancel(); // å°†æ‰€æœ‰channelé‡æ–°æ³¨å†Œåˆ°æ–°çš„selectorä¸Š SelectionKeynewKey = key.channel().register(newSelectorTuple.unwrappedSelector, interestOps, a); nChannels++; &#125; // eventLoopç»‘å®šæ–°çš„seletor selector = newSelectorTuple.selector; unwrappedSelector = newSelectorTuple.unwrappedSelector;&#125;// step 5private void processSelectedKeys() &#123; // å¯å®šä¸ä¸ºç©ºï¼Œå› ä¸ºåœ¨NioEventLoop çš„ openSelectoræ–¹æ³•ä¸­åˆ›å»ºäº† if (selectedKeys != null) &#123; // ä¸ºä»€ä¹ˆè¯´SelectedKeysæ˜¯ä¼˜åŒ–è¿‡çš„ï¼Œæ˜¯å› ä¸ºåŸç”Ÿçš„SelectedKeysæ˜¯Setï¼Œæ·»åŠ ä¸€ä¸ªäº‹ä»¶ä¸ºO(logn) // ä¼˜åŒ–è¿‡åä½¿ç”¨æ•°ç»„æ¥æ“ä½œï¼Œæ·»åŠ ä¸€ä¸ªäº‹ä»¶ä¸ºO(1) // å…·ä½“çš„å¯ä»¥å‚è€ƒé—ªç”µä¾ çš„åšå®¢ï¼Œæˆ‘è¿™é‡Œå°±ä¸å¤šè¯´äº† // step 6 processSelectedKeysOptimized(); &#125; else &#123; processSelectedKeysPlain(selector.selectedKeys()); &#125;&#125;// step 6private void processSelectedKeysOptimized() &#123; for (int i = 0; i &lt; selectedKeys.size; ++i) &#123; final SelectionKey k = selectedKeys.keys[i]; // è®©å¯¹è±¡å¯ä»¥è¢«GC selectedKeys.keys[i] = null; final Object a = k.attachment(); if (a instanceof AbstractNioChannel) &#123; // æ‹¿åˆ°æºå¸¦çš„channel // step 7 processSelectedKey(k, (AbstractNioChannel) a); &#125; else &#123;@SuppressWarnings("unchecked") NioTask &lt; SelectableChannel &gt; task = (NioTask &lt; SelectableChannel &gt; ) a; processSelectedKey(k, task); &#125; if (needsToSelectAgain) &#123; selectedKeys.reset(i + 1); selectAgain(); i = -1; &#125; &#125;&#125;// step 7private void processSelectedKey(SelectionKey k, AbstractNioChannel ch) &#123; // æ‹¿åˆ°NioEventLoopçš„Unsafeå¯¹è±¡ final AbstractNioChannel.NioUnsafe unsafe = ch.unsafe(); // æ‹¿åˆ°NioEventLoopçš„eventLoopå¯¹è±¡ eventLoop = ch.eventLoop(); // æ‹¿åˆ°äº‹ä»¶ int readyOps = k.readyOps(); // è¿æ¥äº‹ä»¶å¤„ç† if ((readyOps &amp; SelectionKey.OP_CONNECT) != 0) &#123; int ops = k.interestOps(); // è·å¾—æ„Ÿå…´è¶£çš„äº‹ä»¶ ops &amp;= ~SelectionKey.OP_CONNECT; // é‡æ–°æ³¨å†Œ k.interestOps(ops); // å®Œæˆé“¾æ¥ unsafe.finishConnect(); &#125; // å†™äº‹ä»¶å¤„ç† if ((readyOps &amp; SelectionKey.OP_WRITE) != 0) &#123; ch.unsafe().forceFlush(); &#125; // è¯»äº‹ä»¶(work)æˆ–è€…å»ºç«‹è¿æ¥äº‹ä»¶ï¼ˆbossï¼‰å¤„ç† if ((readyOps &amp; (SelectionKey.OP_READ | SelectionKey.OP_ACCEPT)) != 0 || readyOps == 0) &#123; // éƒ½æ˜¯readæ–¹æ³•ï¼Œåªæ˜¯å®ç°ä¸åŒ unsafe.read(); &#125;&#125;// step 8 å¤„ç†ä»»åŠ¡é˜Ÿåˆ—protected boolean runAllTasks(long timeoutNanos) &#123; // å°†å®šæ—¶ä»»åŠ¡æ”¾å…¥æ™®é€šä»»åŠ¡é˜Ÿåˆ—(å®ƒæ˜¯ä¸€ä¸ªå¤šç”Ÿäº§è€…å•æ¶ˆè´¹è€…é˜Ÿåˆ—) // step 9 fetchFromScheduledTaskQueue(); // æ‹¿å‡ºä¸€ä¸ªæ™®é€šä»»åŠ¡ Runnable task = pollTask(); if (task == null) &#123; // è¿è¡Œæ”¶å°¾ä»»åŠ¡é˜Ÿåˆ—tailTasks afterRunningAllTasks(); return false; &#125; // è®¡ç®—å‡ºæœ¬æ¬¡å¾ªç¯çš„èƒ½å¤Ÿè¿è¡Œçš„æœ€å¤šæ—¶é—´ final long deadline = ScheduledFutureTask.nanoTime() + timeoutNanos; long runTasks = 0; long lastExecutionTime; for (;;) &#123; // æ‰§è¡Œä»»åŠ¡(è¿™é‡Œä¸€å®šè¦å¤šè°ƒè¯•å‡ æ¬¡æ‰ä¼šæœ‰æ„Ÿè§‰ï¼Œä»»åŠ¡é˜Ÿåˆ—çš„æ„Ÿè§‰ä¸€ä¸‹å­å°±å‡ºæ¥äº†) // step 10 safeExecute(task); runTasks++; // ç”±äºScheduledFutureTask.nanoTime()æ¯”è¾ƒè€—æ—¶ï¼Œæ‰€ä»¥æ²¡64æ¬¡æ¯”è¾ƒä¸€æ¬¡æ˜¯å¦è¶…æ—¶ if ((runTasks &amp; 0x3F) == 0) &#123; lastExecutionTime = ScheduledFutureTask.nanoTime(); if (lastExecutionTime &gt;= deadline) &#123; break; &#125; &#125; task = pollTask(); if (task == null) &#123; lastExecutionTime = ScheduledFutureTask.nanoTime(); break; &#125; &#125; afterRunningAllTasks(); this.lastExecutionTime = lastExecutionTime; return true;&#125;// step 9private boolean fetchFromScheduledTaskQueue() &#123; long nanoTime = AbstractScheduledEventExecutor.nanoTime(); // å®šæ—¶ä»»åŠ¡é˜Ÿåˆ—æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå¹¶ä¸”ä»»åŠ¡å®ç°äº†compareToæ–¹æ³•ï¼Œå¯ä»¥è¿”å›å¿«éœ€è¦è¢«æ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡ Runnable scheduledTask = pollScheduledTask(nanoTime); while (scheduledTask != null) &#123; if (!taskQueue.offer(scheduledTask)) &#123; // å¦‚æœæ™®é€šé˜Ÿåˆ—æ»¡äº†ï¼Œå°±åˆæ”¾å›å» scheduledTaskQueue().add((ScheduledFutureTask &lt; ?&gt;) scheduledTask); return false; &#125; // æ‹¿åˆ°å®šæ—¶ä»»åŠ¡ scheduledTask = pollScheduledTask(nanoTime); &#125; return true;&#125;// step 10protected static void safeExecute(Runnable task) &#123; // å°±åªæ˜¯è¿è¡Œè¿™ä¸ªä»»åŠ¡ï¼Œä½†æ˜¯ä¸€ä¸ªå‡ºé”™äº†ï¼Œä¹Ÿä¼šç»§ç»­è¿›è¡Œä¸‹å» task.run();&#125; æ‰§è¡Œå®Œæ¯•ï¼ï¼ï¼ æ€»ç»“è™½ç„¶è¿˜æ˜¯æœ‰å¾ˆå¤šç»†èŠ‚æ²¡æœ‰è°ƒè¯•åˆ°ï¼Œä½†æ˜¯å¤§æ¦‚çš„æµç¨‹åº”è¯¥éƒ½èµ°äº†ä¸€éï¼Œå¸Œæœ›å¤šè°ƒè¯•ï¼Œç„¶åæ‰ä¼šæ·±æ„ŸEventLoopçš„åŠï¼ï¼ å‚è€ƒ nettyæºç åˆ†æä¹‹æ­å¼€reactorçº¿ç¨‹çš„é¢çº±ï¼ˆä¸€ï¼‰ nettyæºç åˆ†æä¹‹æ­å¼€reactorçº¿ç¨‹çš„é¢çº±ï¼ˆäºŒï¼‰ nettyæºç åˆ†æä¹‹æ­å¼€reactorçº¿ç¨‹çš„é¢çº±ï¼ˆä¸‰ï¼‰]]></content>
      <categories>
        <category>Nettyæºç </category>
      </categories>
      <tags>
        <tag>Netty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nettyæºç ä¹‹æœåŠ¡ç«¯å¯åŠ¨]]></title>
    <url>%2F2018%2F08%2F06%2FNetty%E6%BA%90%E7%A0%81%2FNetty%E6%BA%90%E7%A0%81%E4%B9%8B%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%90%AF%E5%8A%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šNettyå¯åŠ¨å•¦ï¼å¼€å¿ƒè„¸ï¼ä½†æ˜¯è¿™åˆå¯èƒ½æ˜¯ä¸€ç¯‡åˆè‡­åˆé•¿ç”±ç»•çš„æ–‡ç« ï¼Œéœ€è¦ç‚¹è€å¿ƒï¼Œéœ€è¦ç‚¹åŠ¨æ‰‹èƒ½åŠ›ã€‚æ— å¥ˆè„¸ï¼ï¼ï¼ Netty Exampleæˆ‘é€‰æ‹©äº†Nettyæºç ä¸­çš„EchoServeræ¥ä½œä¸ºä¾‹å­ï¼Œå®ƒåœ¨io.netty.example.echoåŒ…ä¸‹ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼ˆå¿½ç•¥ç»†èŠ‚ï¼Œä¸“æ³¨æ ¸å¿ƒï¼‰ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041public final class EchoServer &#123; public static void main(String[] args) throws Exception &#123; static final int PORT = Integer.parseInt(System.getProperty("port", "8007")); // é…ç½®Serverç«¯ // AbstractBootstrapçš„group EventLoopGroup bossGroup = new NioEventLoopGroup(1); // ServerBootstrapçš„childGroup EventLoopGroup workerGroup = new NioEventLoopGroup(); final EchoServerHandler serverHandler = new EchoServerHandler(); try &#123; // åœ¨å®ƒåˆ›å»ºçš„è¿‡ç¨‹ä¸­ä¼šç»‘å®šä¸€ä¸ªServerBootstrapConfigä¿å­˜å®ƒçš„å±æ€§ ServerBootstrap b = new ServerBootstrap(); // æ–¹æ³•é“¾é…ç½®ç±»ï¼Œå¯ä»¥å­¦ä¹  // æœåŠ¡ç«¯çš„Bootstrapæ‰æœ‰ä¸¤ä¸ªå‚æ•°çš„groupæ–¹æ³• b.group(bossGroup, workerGroup) // è®¾ç½®AbstractBootstrapçš„channelFactoryå‚æ•° .channel(NioServerSocketChannel.class) // è®¾ç½®AbstractBootstrapçš„optionså‚æ•°(å¸¸é‡æ± å®ç°ï¼ŒConcurrentMap),å¯ä»¥å­¦ä¹  .option(ChannelOption.SO_BACKLOG, 100) // è®¾ç½®AbstractBootstrapçš„handlerå‚æ•°ï¼Œè¿™é‡Œé…ç½®äº†ä¸€ä¸ªæ—¥å¿—å¤„ç†ç±» .handler(new LoggingHandler(LogLevel.INFO)) // è®¾ç½®ServerBootstrapçš„childHandlerå‚æ•° .childHandler(new ChannelInitializer&lt;SocketChannel&gt;() &#123; @Override public void initChannel(SocketChannel ch) throws Exception &#123; ChannelPipeline p = ch.pipeline(); p.addLast(serverHandler); &#125; &#125;); // æœåŠ¡ç«¯å¯åŠ¨(ä¸€åˆ‡åˆ†æçš„æºå¤´) ChannelFuture f = b.bind(PORT).sync(); // ç­‰å¾…æœåŠ¡ç«¯å…³é—­socket f.channel().closeFuture().sync(); &#125; finally &#123; // ä¼˜é›…å…³é—­ä¸¤ç»„æ­»å¾ªç¯ bossGroup.shutdownGracefully(); workerGroup.shutdownGracefully(); &#125; &#125;&#125; æºç åˆ†æä¸Šé¢çš„ä¾‹å­çš„æ³¨é‡Šå·²ç»å¾ˆæ¸…æ¥šäº†ï¼Œåœ¨å¯åŠ¨ä¹‹å‰ä¸»è¦å°±æ˜¯åœ¨é…ç½®å¯åŠ¨ç±»ServerBootstrapã€‚ç°åœ¨æˆ‘å°±ä¸‹é¢çš„å¯åŠ¨æ–¹æ³•å¼€å§‹æ·±å…¥åˆ†æ(debugï¼Œä»£ç å±•ç¤ºä¼šå¿½ç•¥ç»†èŠ‚)ï¼š 1ChannelFuture f = b.bind(PORT).sync(); Bootstrapç›¸å…³æˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™ä¸ªç±»å¹²äº†ä»€ä¹ˆï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109// step 1public ChannelFuture bind(int inetPort) &#123; // é€šè¿‡ç«¯å£ç”Ÿæˆä¸€ä¸ªInetSocketAddress // step 2 return bind(new InetSocketAddress(inetPort));&#125;// step 2public ChannelFuture bind(SocketAddress localAddress) &#123; // éªŒè¯groupå’ŒchannelFactoryæ˜¯å¦ä¼ è¿›æ¥äº† validate(); // éç©ºåˆ¤æ–­ï¼Œè¿™é‡Œåªè¯´ä¸€æ¬¡ï¼Œå¤§çš„å·¥ç¨‹é¡¹ç›®ï¼Œå¿…é¡»é€šè¿‡é˜²å¾¡æ€§ç¼–ç¨‹æ¥å¢å¼ºé²æ£’æ€§ if (localAddress == null) &#123; throw new NullPointerException("localAddress"); &#125; // step 3 return doBind(localAddress);&#125;// step 3private ChannelFuture doBind(final SocketAddress localAddress) &#123; // åˆå§‹åŒ–serverChannelï¼Œå¹¶å°†eventloopæ³¨å†Œåˆ°serverChannelä¸Š // step 4 final ChannelFuture regFuture = initAndRegister(); // è·å–åˆšåˆšåˆ›å»ºçš„serverChannelï¼Œç”±äºä¹‹åéƒ½ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ç”¨finalä¿®é¥° final Channel channel = regFuture.channel(); // ç»‘å®šåœ°å€ doBind0(regFuture, channel, localAddress, promise);&#125;// step 4final ChannelFuture initAndRegister() &#123; Channel channel = null; // ç”Ÿæˆä¸€ä¸ªserverChannel // è¿™é‡Œçš„channelFactoryæˆ‘ä»¬åœ¨ä¾‹å­ä»‹ç»è¿‡ï¼Œå…¶å®å°±æ˜¯åœ¨å·¥å‚ä¸­åˆ©ç”¨åå°„ç”Ÿæˆå¯¹åº”çš„channel // è¿™é‡Œæˆ‘ä»¬ä¼šåœ¨NioServerSocketChannelç±»ä¸­åˆ†æå®ƒæ„é€ æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ(å¯ä»¥ç›´æ¥è·³è¿‡å»çœ‹) channel = channelFactory.newChannel(); // åˆå§‹åŒ–serverChannel // step 5 init(channel); // config().group()å°±æ˜¯é€šè¿‡ServerBootstrapConfigæ‹¿åˆ°bossGroupæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨registeræ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥EventLoopGroupåˆ†æ(å¯ä»¥ç›´æ¥è·³è¿‡å»çœ‹) // MultithreadEventLoopGroupçš„ step 1 ChannelFuture regFuture = config().group().register(channel); return regFuture;&#125;// step 5 ServerBootstrapå…·ä½“å®ç°private final Map &lt; ChannelOption &lt; ?&gt;,Object &gt; childOptions;private final Map &lt; AttributeKey &lt; ?&gt;,Object &gt; childOptions;private final ServerBootstrapConfig config = new ServerBootstrapConfig(this);private volatile EventLoopGroup childGroup;private volatile ChannelHandler childHandler;void init(Channel channel) throws Exception &#123; // æ‹¿åˆ°è®¾ç½®çš„AbstractBootstrapçš„options final Map &lt; ChannelOption &lt; ?&gt;, Object &gt; options = options0(); // åŒæ­¥ synchronized(options) &#123; // è®¾ç½®optionsï¼Œè·Ÿä¸‹å»æˆ‘ä»¬ä¼šå‘ç°å°†optionsæ”¾å…¥NioServerSocketChannelConfigä¸­ setChannelOptions(channel, options, logger); &#125; // åŒoptionsè®¾ç½® final Map &lt; AttributeKey &lt; ?&gt;, Object &gt; attrs = attrs0(); synchronized(attrs) &#123; for (Entry &lt; AttributeKey &lt; ?&gt;, Object &gt; e: attrs.entrySet()) &#123;@SuppressWarnings("unchecked") AttributeKey &lt; Object &gt; key = (AttributeKey &lt; Object &gt; ) e.getKey(); channel.attr(key).set(e.getValue()); &#125; &#125; // æ‹¿åˆ°ChannelPipeline ChannelPipeline p = channel.pipeline(); // æ‹¿åˆ°ä¹‹å‰æ³¨å…¥çš„childGroupå’ŒchildHandler final EventLoopGroup currentChildGroup = childGroup; final ChannelHandler currentChildHandler = childHandler; // è®¾ç½®childOptionså’ŒchildOptionsï¼Œè¿™äº›æ˜¯åº”ç”¨äºä»¥åæ–°æ¥å…¥çš„channel final Entry &lt; ChannelOption &lt; ?&gt;, Object &gt; [] currentChildOptions; final Entry &lt; AttributeKey &lt; ?&gt;, Object &gt; [] currentChildAttrs; synchronized(childOptions) &#123; currentChildOptions = childOptions.entrySet().toArray(newOptionArray(0)); &#125; synchronized(childAttrs) &#123; currentChildAttrs = childAttrs.entrySet().toArray(newAttrArray(0)); &#125; // åŠ å…¥æ–°è¿æ¥å¤„ç†å™¨ p.addLast(new ChannelInitializer &lt; Channel &gt; () &#123;@Override public void initChannel(final Channel ch) throws Exception &#123; final ChannelPipeline pipeline = ch.pipeline(); // å°†ä¼šè·å¾—æœ€æ—©ä¹‹å‰è®¾ç½®çš„new LoggingHandler(LogLevel.INFO) ChannelHandler handler = config.handler(); // æ–°å¢ä¸€ä¸ªæ–°è¿æ¥æ¥å…¥å™¨ServerBootstrapAcceptorï¼Œå…·ä½“çš„å¯ä»¥çœ‹ä¹‹åçš„åšæ–‡ ch.eventLoop().execute(new Runnable() &#123;@Override public void run() &#123; pipeline.addLast(new ServerBootstrapAcceptor(ch, currentChildGroup, currentChildHandler, currentChildOptions, currentChildAttrs)); &#125; &#125;); &#125; &#125;);&#125;// step 6private static void doBind0(final ChannelFuture regFuture, final Channel channel, final SocketAddress localAddress, final ChannelPromise promise) &#123; // åˆæ˜¯å¼‚æ­¥ä»»åŠ¡ï¼ŒNettyéšå¤„å¯è§ channel.eventLoop().execute(new Runnable() &#123;@Override public void run() &#123; if (regFuture.isSuccess()) &#123; // AbstractChannel step 11 channel.bind(localAddress, promise).addListener(ChannelFutureListener.CLOSE_ON_FAILURE); &#125; else &#123; promise.setFailure(regFuture.cause()); &#125; &#125; &#125;);&#125; Channelç›¸å…³åˆ›å»ºä¸€ä¸ªNioServerSocketChannelå¯¹è±¡ä¼šå‘ç”Ÿä»€ä¹ˆï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149private static final SelectorProvider DEFAULT_SELECTOR_PROVIDER = SelectorProvider.provider();// ServerSocketChannelçš„ä¸€ç³»åˆ—é…ç½®å±æ€§private final ServerSocketChannelConfig config;// step 1(é»˜è®¤æ„é€ å‡½æ•°)public NioServerSocketChannel() &#123; // step 2ï¼Œstep 3 this(newSocket(DEFAULT_SELECTOR_PROVIDER));&#125;// step 2private static ServerSocketChannel newSocket(SelectorProvider provider) &#123; // åˆ©ç”¨JDK NIO åˆ›å»ºçš„SeveSocketrChannel return provider.openServerSocketChannel();&#125;// step 3public NioServerSocketChannel(ServerSocketChannel channel) &#123; // step 4 super(null, channel, SelectionKey.OP_ACCEPT); // é…ç½®NioServerSocketChannelConfig(åˆå§‹åŒ–ä¼šç”¨åˆ°) config = new NioServerSocketChannelConfig(this, javaChannel().socket());&#125;// step 4 AbstractNioMessageChannelprotected AbstractNioMessageChannel(Channel parent, SelectableChannel ch, int readInterestOp) &#123; // step 5 super(parent, ch, readInterestOp);&#125;// step 5 AbstractNioChannelprivate final SelectableChannel ch;protected final int readInterestOp;protected AbstractNioChannel(Channel parent, SelectableChannel ch, int readInterestOp) &#123; // step 6 super(parent); // ä¿å­˜åŸç”Ÿçš„ServerSocketChannel this.ch = ch; // ä¿å­˜æ„Ÿå…´è¶£çš„äº‹ä»¶(SelectionKey.OP_ACCEPTï¼Œ1&lt;&lt;4) this.readInterestOp = readInterestOp; // å°†Channelè®¾ç½®ä¸ºéé˜»å¡ ch.configureBlocking(false);&#125;// step 6 AbstractChannelprivate final Channel parent;private final ChannelId id;private final Unsafe unsafe;private final DefaultChannelPipeline pipeline;protected AbstractChannel(Channel parent) &#123; this.parent = parent; // ç”Ÿæˆchannelçš„å”¯ä¸€æ ‡è¯†ï¼Œè‡ªå·±å¯ä»¥å»çœ‹çœ‹å®ç° id = newId(); // ç”Ÿæˆunsafeå¯¹è±¡(è¿›è¡Œåº•å±‚çš„IOæ“ä½œ)ï¼Œä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œéœ€è¦å…·ä½“å®ç°ï¼Œå®ƒçš„æŠ½è±¡ç±»ä¹Ÿåœ¨AbstractChannelä¸­ unsafe = newUnsafe(); // ç”ŸæˆChannelPipeline // step 7 pipeline = newChannelPipeline();&#125;// step 7protected DefaultChannelPipeline newChannelPipeline() &#123; // æˆ‘ä»¬å°†åœ¨DefaultChannelPipelineåˆ†æ return new DefaultChannelPipeline(this);&#125;// step 8 AbstractChannelpublic final void register(EventLoop eventLoop, final ChannelPromise promise) &#123; // ç»‘å®šäº†eventLoop AbstractChannel.this.eventLoop = eventLoop; // ... ä¸“æ³¨äºæ ¸å¿ƒ // step 9 register0(promise); // ...&#125;// step 9private void register0(ChannelPromise promise) &#123; // å½“ç„¶æ˜¯ç¬¬ä¸€æ¬¡æ³¨å†Œï¼Œtrue boolean firstRegistration = neverRegistered; // step 10 doRegister(); // æ³¨å†Œä¹‹åè®¾ç½®æ ‡å¿—ä½ neverRegistered = false; registered = true; // pipelineä¹‹åçš„åšæ–‡ä¼šè¯´ pipeline.invokeHandlerAddedIfNeeded(); safeSetSuccess(promise); // è§¦å‘æ³¨å†Œå®Œæˆäº‹ä»¶ï¼Œè¿˜ä¼šä¼ æ’­pipeline.fireChannelActive(); pipeline.fireChannelRegistered(); // åˆ¤æ–­æ˜¯å¦ç»‘å®šï¼Œä¼šè°ƒç”¨åº•å±‚NIOåˆ›å»ºçš„channelï¼Œåº”è¯¥ä¸ºfalse // é‚£ä¹ˆä»€ä¹ˆæ—¶å€™å»ºç«‹è¿æ¥çš„å‘¢ï¼Œæ€ä¹ˆæ‰¾ï¼Œå¯ä»¥å‚è€ƒåé¢åˆ—å‡ºçš„é—ªç”µä¾ çš„åšæ–‡ï¼Œè¿™ä¸ªå‡½æ•°åˆ†æå®Œäº† // æˆ‘ä»¬åº”è¯¥å›åˆ°AbstractBootstrapçš„ step 6 ç»§ç»­åˆ†æ if (isActive()) &#123; if (firstRegistration) &#123; pipeline.fireChannelActive(); &#125; else if (config().isAutoRead()) &#123; beginRead(); &#125; &#125;&#125;// step 10protected void doRegister() throws Exception &#123; // åˆ©ç”¨jdkåº•å±‚å°†channelæ³¨å†Œåˆ°selectorä¸Šï¼Œ0è¡¨ç¤ºä¸å…³å¿ƒä»»ä½•äº‹ä»¶ï¼Œthisæ˜¯ä¸ºäº†å½“NIOæ£€æµ‹åˆ°äº‹ä»¶æ—¶å¯ä»¥å¯¹nettyçš„channelè¿›è¡Œæ“ä½œ selectionKey = javaChannel().register(eventLoop().unwrappedSelector(), 0, this);&#125;// step 11public ChannelFuture bind(SocketAddress localAddress, ChannelPromise promise) &#123; // DefaultChannelPipeline step 2 return pipeline.bind(localAddress, promise);&#125;// step 12public final void bind(final SocketAddress localAddress, final ChannelPromise promise) &#123; // è‚¯å®šè¿˜æ²¡æœ‰å»ºç«‹è¿æ¥ boolean wasActive = isActive(); // step 13 doBind(localAddress); // è¿™é‡ŒisActive()åº”è¯¥è¦è¿”å›trueäº† if (!wasActive &amp;&amp; isActive()) &#123; invokeLater(new Runnable() &#123;@Override public void run() &#123; // è§¦å‘ç«¯å£ç»‘å®šäº‹ä»¶ï¼Œæˆ‘ä»¬å°†ä¼šè§¦å‘HeadContextçš„channelActiveæ–¹æ³• // ChannelPipeline step 5 pipeline.fireChannelActive(); &#125; &#125;); &#125; safeSetSuccess(promise);&#125;// step 13protected void doBind(SocketAddress localAddress) throws Exception &#123; // åˆ°è¿™é‡Œå°±æ˜¯è¿›è¡Œåº•å±‚çš„ç»‘å®š if (PlatformDependent.javaVersion() &gt;= 7) &#123; javaChannel().bind(localAddress, config.getBacklog()); &#125; else &#123; javaChannel().socket().bind(localAddress, config.getBacklog()); &#125;&#125;// step 14 AbstractChannelpublic Channel read() &#123; // DefaultChannelPipeline step 7 pipeline.read(); return this;&#125;// step 16 AbstractNioChannelçš„AbstractNioUnsafeprotected void doBeginRead() throws Exception &#123; // è¿˜è®°å¾—åœ¨åˆå§‹åŒ–AbstractNioChannelæ—¶ä¿å­˜çš„readInterestOpå’Œåœ¨channelæ³¨å†Œè¿‡ç¨‹ä¸­çš„selectionKeyå—ï¼Œä¸è®°å¾—å¾€ä¸Šçœ‹ä¸€çœ‹ final SelectionKey selectionKey = this.selectionKey; // éœ€è¦è¯» readPending = true; // æ‹¿åˆ°å…·ä½“çš„å€¼ï¼Œ1&lt;&lt;4=16 final int interestOps = selectionKey.interestOps(); if ((interestOps &amp; readInterestOp) == 0) &#123; // å‡†å¤‡å‘Šè¯‰Selectoréœ€è¦å…³æ³¨SelectionKey.OP_ACCEPTäº‹ä»¶ selectionKey.interestOps(interestOps | readInterestOp); &#125;&#125; ChannelPipelineç›¸å…³12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576// step 1 DefaultChannelPipelinefinal AbstractChannelHandlerContext head;final AbstractChannelHandlerContext tail;private final Channel channel;protected DefaultChannelPipeline(Channel channel) &#123; // ç»‘å®šchannel(å¦‚æœä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå­¦ä¹ å†™å·¥å…·ç±») this.channel = ObjectUtil.checkNotNull(channel, "channel"); // é»˜è®¤çš„ä¸¤ä¸ªèŠ‚ç‚¹ tail = new TailContext(this); head = new HeadContext(this); // å½¢æˆåŒå‘é“¾è¡¨ head.next = tail; tail.prev = head;&#125;// step 2 DefaultChannelPipelinepublic final ChannelFuture bind(SocketAddress localAddress, ChannelPromise promise) &#123; // è¿™ä¸ªtailä¹‹å‰å°±è®¾ç½®è¿‡äº† // step 3 return tail.bind(localAddress, promise);&#125;// step 3 AbstractChannelHandlerContextpublic ChannelFuture bind(final SocketAddress localAddress, final ChannelPromise promise) &#123; // å¯»æ‰¾tailä¹‹å‰çš„ä¸€ä¸ªèŠ‚ç‚¹ final AbstractChannelHandlerContext next = findContextOutbound(); EventExecutor executor = next.executor(); if (executor.inEventLoop()) &#123; // è°ƒç”¨ä¸‹ä¸€ä¸ªAbstractChannelHandlerContextçš„invokeBindæ–¹æ³•ï¼Œä¸€ç›´åˆ°æ‰¾åˆ°HeadContext // step 4 next.invokeBind(localAddress, promise); &#125; else &#123; safeExecute(executor, new Runnable() &#123;@Override public void run() &#123; next.invokeBind(localAddress, promise); &#125; &#125;, promise, null); &#125; return promise;&#125;// step 4public void bind(ChannelHandlerContext ctx, SocketAddress localAddress, ChannelPromise promise) throws Exception &#123; // çœ‹åˆ°unsafeå°±çŸ¥é“è¦è¿›è¡Œåº•å±‚æ“ä½œçš„ // è¿›å…¥ AbstractChannelçš„Unsafe step 12 unsafe.bind(localAddress, promise);&#125;// step 5 DefaultChannelPipelineçš„HeadContextpublic void channelActive(ChannelHandlerContext ctx) throws Exception &#123; // ç»‘å®šæ—¶é—´å°†ä¼šä¸€ç›´ä¼ æ’­ä¸‹å» ctx.fireChannelActive(); // step 6 æ·±å…¥åˆ†æ readIfIsAutoRead();&#125;// step 6 DefaultChannelPipelineçš„HeadContextprivate void readIfIsAutoRead() &#123; // æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹åˆ°isAutoRead()æ–¹æ³•é»˜è®¤è¿”å›ä¸º1 if (channel.config().isAutoRead()) &#123; // è¿›å…¥ AbstractChannel step 14 // å¯¹äºæœåŠ¡ç«¯channelçš„è¯»æ¥è¯´å°±è¯´å¯ä»¥ç»‘å®šè¿æ¥äº† channel.read(); &#125;&#125;// step 7 DefaultChannelPipelinepublic final ChannelPipeline read() &#123; // ä»tailèŠ‚ç‚¹ä¸€ç›´è¿½å¯»åˆ°headï¼Œæ‰¾åˆ° unsafe.beginRead() // step 8 tail.read(); return this;&#125;// step 8 DefaultChannelPipelineçš„HeadContextpublic final void beginRead() &#123; // ä¼šä¸€ç›´æ‰¾åˆ°AbstractNioChannelçš„AbstractNioUnsafeçš„doBeginRead step 16 doBeginRead();&#125; EventLoopç›¸å…³123456789101112131415161718192021// step 1 MultithreadEventLoopGroup@Overridepublic ChannelFuture register(Channel channel) &#123; // next()å°†ä¼šé€šè¿‡é€‰æ‹©å™¨ï¼ˆä¹‹åçš„åšæ–‡ä¼šè®²åˆ°ï¼‰æ‹¿åˆ°ä¸€ä¸ªEventLoop // step 2 return next().register(channel);&#125;// step2 SingleThreadEventLooppublic ChannelFuture register(Channel channel) &#123; // step 3 return register(new DefaultChannelPromise(channel, this));&#125;// step 3public ChannelFuture register(final ChannelPromise promise) &#123; // é€šè¿‡unsafe()æ–¹æ³•å¾—åˆ°Unsafeå¯¹è±¡ï¼ˆç»‘å®šåœ¨channelä¸Šçš„é‚£ä¸ªï¼‰æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå®ƒè¦å¼€å§‹åº•å±‚æ“ä½œæ³¨å†Œäº† // æˆ‘ä»¬æˆ‘ä»¬åˆè¦å›åˆ°AbstractChannelå»äº†ï¼Œçœ‹çœ‹å®ƒçš„registeræ³¨å†Œæ–¹æ³• // Channel step 8 promise.channel().unsafe().register(this, promise); return promise;&#125; æ€»ç»“ è®¾ç½®å¯åŠ¨ç±»å‚æ•° åˆ›å»ºæœåŠ¡ç«¯Channelï¼ŒåŒæ—¶åˆ›å»ºChannelConfig,ChannelId,ChannelPipeline,ChannelHandler,Unsafeç­‰ åˆå§‹åŒ–æœåŠ¡ç«¯Channelï¼Œè®¾ç½®ä¸€äº›attrï¼Œoptionï¼Œä»¥åŠè®¾ç½®å­channelçš„attrï¼Œoptionï¼Œç»™æœåŠ¡ç«¯channelæ·»åŠ æ–°channelæ¥å…¥å™¨ å°†Channelæ³¨å†Œåˆ°Selectorï¼Œå¹¶è§¦å‘addHandler,registerç­‰äº‹ä»¶ è¿›è¡Œç«¯å£ç»‘å®šï¼Œå¹¶è§¦å‘activeäº‹ä»¶ï¼ŒåŒæ—¶æ³¨å†ŒACCEPTäº‹ä»¶ å‚è€ƒ nettyæºç åˆ†æä¹‹æœåŠ¡ç«¯å¯åŠ¨å…¨è§£æ]]></content>
      <categories>
        <category>Nettyæºç </category>
      </categories>
      <tags>
        <tag>Netty</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‘†è„±çƒ‚ä»£ç ä¹‹Effective Java Third Edition]]></title>
    <url>%2F2018%2F07%2F23%2F%E6%91%86%E8%84%B1%E7%83%82%E4%BB%A3%E7%A0%81%2F%E6%91%86%E8%84%B1%E7%83%82%E4%BB%A3%E7%A0%81%E4%B9%8BEffective-Java-Third-Edition%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè¶Šå­¦è¶Šè¿·èŒ«ï¼Œæœ‰æ‰€è°“çš„é‡ç‚¹å—ï¼Ÿæˆ‘åæ­£ç°åœ¨è¿˜å¼„ä¸æ¸…æ¥šï¼Œæ—¢ç„¶å¼„ä¸æ¸…æ¥šï¼Œé‚£å°±å¥½å¥½ä¸“æ³¨äºè„šä¸‹å§ã€‚æˆ‘æ›¾ç»çœ‹è¿‡ä¸€éEffective Javaç¬¬äºŒç‰ˆï¼Œå¯èƒ½é‚£ä¸ªæ—¶å€™çš„ä»£ç é‡è¿˜ä¸å¤Ÿå§ï¼Œä¸èƒ½ç†è§£å…¶ç²¾é«“ï¼Œç°åœ¨çœ‹çœ‹æ‰èƒ½å›å‘³ä¸€ç‚¹ã€‚åˆšå¥½ä»Šå¹´å¹´åˆç¬¬ä¸‰ç‰ˆï¼ˆè‹±æ–‡ç‰ˆï¼‰ä¹Ÿå‡ºæ¥ï¼Œæ–°å¢äº†Java7ã€8ã€9çš„ä¸€äº›æ¡ç›®ï¼Œè¿™é‡Œä¹Ÿå°±æƒ³åˆ—ä¸€äº›ç¬¬ä¸‰ç‰ˆçš„ç›®å½•ï¼Œä¾›è‡ªå·±æŸ¥æ‰¾ä¸å®è·µï¼Œå¸Œæœ›è‡ªå·±èƒ½å¤Ÿçœ‹åˆ°æ¡ç›®å°±èƒ½è¯´å‡ºæ‰€ä»¥ç„¶æ¥ï¼Œä¹Ÿæƒ³ç¿»è¯‘ä¸€ä¸‹æ–°å¢çš„ä¸€äº›æ¡ç›®ã€‚å¤§å®¶ä¹Ÿå¯ä»¥äº’ç›¸äº¤æµã€‚ ç¬¬ä¸€ç«  å¼•è¨€ï¼ˆé‡è¦ï¼‰ç¬¬äºŒç«  åˆ›å»ºå’Œé”€æ¯å¯¹è±¡ç¬¬1æ¡ è€ƒè™‘ç”¨é™æ€å·¥å‚æ–¹æ³•ä»£æ›¿æ„é€ å™¨ï¼ˆJava8ï¼Œ9 æ›´æ–°ï¼‰ç¬¬2æ¡ é‡åˆ°å¤šä¸ªæ„é€ å™¨å‚æ•°æ—¶è¦è€ƒè™‘ç”¨å»ºé€ è€…æ¨¡å¼ç¬¬3æ¡ é€šè¿‡ç§æœ‰æ„é€ å™¨æˆ–è€…æšä¸¾ç±»å‹å¼ºåŒ–å•ä¾‹å±æ€§ç¬¬4æ¡ é€šè¿‡ç§æœ‰æ„é€ å™¨å¼ºåŒ–ä¸å¯å®ä¾‹åŒ–çš„èƒ½åŠ›ç¬¬5æ¡ ä¾èµ–æ³¨å…¥ä¼˜å…ˆç¡¬è¿æ¥èµ„æºï¼ˆæ–°å¢ï¼‰ç¬¬6æ¡ é¿å…åˆ›å»ºä¸å¿…è¦çš„å¯¹è±¡ï¼ˆJava9 æ›´æ–°ï¼‰ç¬¬7æ¡ æ¶ˆé™¤è¿‡æœŸçš„å¯¹è±¡å¼•ç”¨ç¬¬8æ¡ é¿å…ä½¿ç”¨æ€»ç»“æ–¹æ³•å’Œæ¸…ç†å™¨ï¼ˆJava 7ï¼Œ9 æ›´æ–°ï¼‰ç¬¬9æ¡ try-with-resourcesä¼˜å…ˆtry-finallyï¼ˆJava 7 æ–°å¢ï¼‰ç¬¬ä¸‰ç«  æ‰€æœ‰å¯¹è±¡é€šç”¨çš„æ–¹æ³•ç¬¬10æ¡ è¦†å†™equalsæ—¶å€™è¯·éµå®ˆé€šç”¨è§„å®šç¬¬11æ¡ è¦†å†™equalsæ—¶å€™æ€»è¦è¦†å†™hashCodeç¬¬12æ¡ å§‹ç»ˆè¦†å†™toStringç¬¬13æ¡ è°¨æ…å¾—è¦†å†™cloneç¬¬14æ¡ è€ƒè™‘å®ç°Comparableæ¥å£ç¬¬å››ç«  ç±»å’Œæ¥å£ç¬¬15æ¡ ä½¿ç±»å’Œæˆå‘˜å¯è®¿é—®æ€§æœ€å°åŒ–ï¼ˆJava9 æ›´æ–°ï¼‰ç¬¬16æ¡ åœ¨å…¬æœ‰ç±»ä¸­ä½¿ç”¨è®¿é—®æ–¹æ³•è€Œéå…¬æœ‰åŸŸç¬¬17æ¡ ä½¿å¯å˜æ€§æœ€å°åŒ–ç¬¬18æ¡ å¤åˆä¼˜å…ˆäºç»§æ‰¿ç¬¬19æ¡ è¦ä¹ˆä¸ºç»§æ‰¿è€Œè®¾è®¡å¹¶æä¾›æ–‡æ¡£ï¼Œè¦ä¹ˆç¦æ­¢ç»§æ‰¿ï¼ˆJava8ï¼Œ9 æ›´æ–°ï¼‰ç¬¬20æ¡ æ¥å£ä¼˜å…ˆäºæŠ½è±¡ç±»ç¬¬21æ¡ ä¸ºåä»£è®¾è®¡æ¥å£ï¼ˆJava8 æ–°å¢ï¼‰ç¬¬22æ¡ æ¥å£åªç”¨äºå®šä¹‰ç±»å‹ç¬¬23æ¡ ç±»å±‚æ¬¡ä¼˜å…ˆäºæ ‡ç­¾ç±»ç¬¬24æ¡ ä¼˜å…ˆè€ƒè™‘é™æ€æˆå‘˜ç±»è€Œä¸æ˜¯éé™æ€æˆå‘˜ç±»ç¬¬25æ¡ å°†æºæ–‡ä»¶é™åˆ¶ä¸ºå•ä¸ªé¡¶å±‚ç±»ï¼ˆæ–°å¢ï¼‰ç¬¬äº”ç«  æ³›å‹ç¬¬26æ¡ ä¸è¦ä½¿ç”¨åŸç”Ÿç±»å‹ç¬¬27æ¡ æ¶ˆé™¤éé¦–æ£€è­¦å‘Šç¬¬28æ¡ åˆ—è¡¨ä¼˜å…ˆäºæ•°ç»„ç¬¬29æ¡ ä¼˜å…ˆè€ƒè™‘æ³›å‹ç¬¬30æ¡ ä¼˜å…ˆè€ƒè™‘æ³›å‹æ–¹æ³•ç¬¬31æ¡ ä½¿ç”¨æœ‰ç•Œé€šé…ç¬¦æå‡APIçµæ´»æ€§ç¬¬32æ¡ è°¨æ…ç»„åˆæ³›å‹å’Œå¯å˜å‚æ•°ï¼ˆJava 7ï¼Œ9 æ–°å¢ï¼‰ç¬¬33æ¡ ä¼˜å…ˆè€ƒè™‘ç±»å‹å®‰å…¨çš„å¼‚æ„å®¹å™¨ç¬¬å…­ç«  æšä¸¾å’Œæ³¨è§£ç¬¬34æ¡ ç”¨enumä»£æ›¿intå¸¸é‡ç¬¬35æ¡ ç”¨å®ä¾‹åŸŸä»£æ›¿åºæ•°ç¬¬36æ¡ ç”¨EnumSetä»£æ›¿ä½åŸŸç¬¬37æ¡ ç”¨EnumMapä»£æ›¿åºæ•°ç´¢å¼•ç¬¬38æ¡ ç”¨æ¥å£æ¨¡æ‹Ÿå¯æ‰©å±•çš„æšä¸¾ç¬¬39æ¡ æ³¨è§£ä¼˜äºå‘½åæ¨¡å¼ç¬¬40æ¡ åšæŒä½¿ç”¨Overrideæ³¨è§£ç¬¬41æ¡ æ ‡è®°æ¥å£å®šä¹‰ç±»å‹ç¬¬ä¸ƒç«  Lambdaè¡¨è¾¾å¼å’Œæµç¬¬42æ¡ Lambdaè¡¨è¾¾å¼ä¼˜äºåŒ¿åç±»ï¼ˆJava8 æ–°å¢ï¼‰ç¬¬43æ¡ æ–¹æ³•å¼•ç”¨ä¼˜äºLambdaè¡¨è¾¾å¼ï¼ˆJava8 æ–°å¢ï¼‰ç¬¬44æ¡ ä¼˜å…ˆä½¿ç”¨æ ‡å‡†çš„å‡½æ•°å¼æ¥å£ï¼ˆJava8 æ–°å¢ï¼‰ç¬¬45æ¡ è°¨æ…ä½¿ç”¨æµï¼ˆJava8 æ–°å¢ï¼‰ç¬¬46æ¡ åœ¨æµä¸­ä¼˜å…ˆä½¿ç”¨æ— å‰¯ä½œç”¨çš„å‡½æ•°ï¼ˆJava8 æ–°å¢ï¼‰ç¬¬47æ¡ åœ¨è¿”å›ç±»å‹ä¸­Collectionä¼˜å…ˆäºStreamï¼ˆJava8 æ–°å¢ï¼‰ç¬¬48æ¡ ä½¿ç”¨å¹¶è¡Œæµçš„æ—¶å€™è¦å°å¿ƒï¼ˆJava8 æ–°å¢ï¼‰ç¬¬å…«ç«  æ–¹æ³•ç¬¬49æ¡ æ£€æŸ¥å‚æ•°çš„æœ‰æ•ˆæ€§ï¼ˆJava7 æ›´æ–°ï¼‰ç¬¬50æ¡ å¿…è¦æ—¶è¿›è¡Œä¿æŠ¤æ€§æ‹·è´ï¼ˆJava8 æ›´æ–°ï¼‰ç¬¬51æ¡ è°¨æ…è®¾è®¡æ–¹æ³•ç­¾åç¬¬52æ¡ æ…ç”¨é‡è½½ç¬¬53æ¡ æ…ç”¨å¯å˜å‚æ•°ç¬¬54æ¡ è¿”å›ç©ºé›†åˆæˆ–è€…æ•°ç»„ï¼Œè€Œä¸æ˜¯nullç¬¬55æ¡ è°¨æ…è¿”å›Optionalï¼ˆJava8 æ–°å¢ï¼‰ç¬¬56æ¡ ä¸ºæ‰€æœ‰å¯¼å‡ºçš„APIå…ƒç´ å†™æ–‡æ¡£æ³¨é‡Šï¼ˆJava7ï¼Œ8ï¼Œ9 æ›´æ–°ï¼‰ç¬¬ä¹ç«  é€šç”¨ç¨‹åºè®¾è®¡ç¬¬57æ¡ å°†å±€éƒ¨å˜é‡çš„ä½œç”¨åŸŸæœ€å°åŒ–ç¬¬58æ¡ for-eachå¾ªç¯ä¼˜å…ˆäºä¼ ç»Ÿforå¾ªç¯ç¬¬59æ¡ äº†è§£å’Œä½¿ç”¨ç±»åº“ï¼ˆJava7ï¼Œ9 æ›´æ–°ï¼‰ç¬¬60æ¡ å¦‚æœéœ€è¦ç²¾ç¡®çš„ç­”æ¡ˆï¼Œè¯·é¿å…ä½¿ç”¨floatå’Œdoubleç¬¬61æ¡ åŸºæœ¬ç±»å‹ä¼˜å…ˆäºè£…ç®±åŸºæœ¬ç±»å‹ç¬¬62æ¡ å¦‚æœæœ‰å…¶ä»–ç±»å‹æ›´åˆé€‚ï¼Œåˆ™å°½é‡é¿å…ä½¿ç”¨Stringç¬¬63æ¡ å½“å¿ƒStringè¿æ¥çš„æ€§èƒ½ç¬¬64æ¡ é€šè¿‡æ¥å£å¼•ç”¨å¯¹è±¡ç¬¬65æ¡ æ¥å£ä¼˜å…ˆäºåå°„æœºåˆ¶ç¬¬66æ¡ è°¨æ…ä½¿ç”¨æœ¬åœ°æ–¹æ³•ç¬¬67æ¡ è°¨æ…åœ°è¿›è¡Œä¼˜åŒ–ç¬¬68æ¡ éµå®ˆæ™®éæ¥å—çš„å‘½åæƒ¯ä¾‹ç¬¬åç«  å¼‚å¸¸ç¬¬69æ¡ åªé’ˆå¯¹å¼‚å¸¸çš„æƒ…å†µæ‰ä½¿ç”¨å¼‚å¸¸ç¬¬70æ¡ å¯¹å¯æ¢å¤çš„æƒ…å†µä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¯¹ç¼–ç¨‹é”™è¯¯ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸ç¬¬71æ¡ é¿å…ä¸å¿…è¦åœ°ä½¿ç”¨å—æ£€å¼‚å¸¸ç¬¬72æ¡ ä¼˜å…ˆä½¿ç”¨æ ‡å‡†çš„å¼‚å¸¸ç¬¬73æ¡ æŠ›å‡ºä¸æŠ½è±¡ç›¸å¯¹åº”çš„å¼‚å¸¸ç¬¬74æ¡ æ¯ä¸ªæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½è¦æœ‰æ–‡æ¡£ç¬¬75æ¡ åœ¨ç»†èŠ‚æ¶ˆæ¯ä¸­åŒ…å«èƒ½æ•è·å¤±è´¥çš„ä¿¡æ¯ç¬¬76æ¡ åŠªåŠ›ä½¿å¤±è´¥ä¿æŒåŸå­æ€§ç¬¬77æ¡ ä¸è¦é¡¾ç•¥å¼‚å¸¸ç¬¬åä¸€ç«  å¹¶å‘ç¬¬78æ¡ åŒæ­¥è®¿é—®å…±äº«çš„å¯å˜æ•°æ®ç¬¬79æ¡ é¿å…è¿‡åº¦åŒæ­¥ç¬¬80æ¡ executorsï¼Œtaskï¼Œstreamä¼˜å…ˆäºçº¿ç¨‹ï¼ˆJava7ï¼Œ8æ›´æ–°ï¼‰ç¬¬81æ¡ å¹¶å‘å·¥å…·ä¼˜å…ˆäºwaitå’Œnotifyç¬¬82æ¡ çº¿ç¨‹å®‰å…¨æ–‡æ¡£åŒ–ç¬¬83æ¡ æ…ç”¨å»¶è¿Ÿåˆå§‹åŒ–ç¬¬84æ¡ ä¸è¦ä¾èµ–çº¿ç¨‹è°ƒåº¦å™¨ï¼ˆJava7 æ›´æ–°ï¼‰ç¬¬åäºŒç«  åºåˆ—åŒ–ç¬¬85æ¡ å…¶ä»–é€‰æ‹©ä¼˜å…ˆäºJavaåºåˆ—åŒ–ï¼ˆæ–°å¢ï¼‰ç¬¬86æ¡ è°¨æ…å®ç°Serializableæ¥å£ç¬¬87æ¡ è€ƒè™‘ä½¿ç”¨è‡ªå®šä¹‰çš„åºåˆ—åŒ–å½¢å¼ç¬¬88æ¡ ä¿æŠ¤æ€§ç¼–å†™readObjectæ–¹æ³•ç¬¬89æ¡ å¯¹äºå®ä¾‹æ§åˆ¶ï¼Œæšä¸¾ç±»å‹ä¼˜å…ˆäºreadResolveç¬¬90æ¡ è€ƒè™‘ç”¨åºåˆ—åŒ–ä»£ç†ä»£æ›¿åºåˆ—åŒ–å®ä¾‹å‚è€ƒ Effective Java ç¬¬ä¸‰ç‰ˆæœ‰ä»€ä¹ˆæ–°æ–™ è¯‘ ã€ŠEffective Java ç¬¬ä¸‰ç‰ˆã€‹æ–°æ¡ç›®ä»‹ç»]]></content>
      <categories>
        <category>æ‘†è„±çƒ‚ä»£ç </category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SpringBoot+Git+Jenkins+Dockerå®ç°CI/CD]]></title>
    <url>%2F2018%2F07%2F18%2F%E8%BF%90%E7%BB%B4%2FSpringBoot-Git-Jenkins-Docker%E5%AE%9E%E7%8E%B0CI-CD%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç°åœ¨DevOpsè¿™ä¹ˆè¿è¡Œï¼Œä½ æ²¡æœ‰ç†ç”±ä¸å»äº†è§£ï¼Œä¸å»å®è·µï¼Œè¿™æ¬¡å°±ä»¥Springbootä¸ºåº•ï¼Œåˆ©ç”¨Gitï¼Œjenkinsï¼ŒDockerå®ç°æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²ï¼ å¼€å‘æµç¨‹ä¸‹é¢æ˜¯å¸¸ç”¨çš„å¼€å‘æµç¨‹å›¾ï¼š æˆ‘ä»¬ç®€å•è¯´è¯´è¿™å¼ å›¾ï¼šé¦–å…ˆæˆ‘ä»¬ä¼šå°†ä»£ç æ–‡ä»¶ã€æµ‹è¯•æ–‡ä»¶ä»¥åŠDockerfileéƒ½å­˜åœ¨ä»£ç ä»“åº“é‡Œï¼Œç‰ˆæœ¬æ§åˆ¶åˆ©ç”¨gitï¼Œè¿™é‡Œä»£ç ä»“åº“æœ‰å¾ˆå¤šé€‰æ‹©ï¼Œæ¯”å¦‚githubã€ç äº‘(æœ¬æ¬¡ä½¿ç”¨)ã€Codingä»¥åŠè‡ªå·±æ­å»ºçš„gitlabã€‚ç„¶åç”±æŒç»­é›†æˆå·¥å…·è¿›è¡Œè‡ªåŠ¨åŒ–æ„å»ºï¼ŒåŒ…æ‹¬äº†æµ‹è¯•ã€ç¼–è¯‘ã€æ‰“åŒ…ã€æ„å»ºé•œåƒã€æ¨é€é•œåƒåˆ°ä»“åº“ï¼ˆæœ‰å¾ˆå¤šé€‰æ‹©ï¼Œå¦‚dockerå®˜æ–¹ä»“åº“ï¼Œæ—¶é€Ÿè¿ã€è‡ªå·±æ­å»ºçš„Registryï¼‰ã€å¯åŠ¨æœåŠ¡ç­‰æ“ä½œï¼ŒæŒç»­é›†æˆå·¥å…·ä¹Ÿæœ‰å¾ˆå¤šé€‰æ‹©ï¼Œæ¯”å¦‚Jenkins(è¿™æ¬¡ä½¿ç”¨)ã€Gitlab CIã€Trivas CIã€‚è¿™é‡Œä½¿ç”¨çš„å®¹å™¨æ˜¯Dockerï¼Œè¿™é‡ŒDockerçš„ç¼–æ’å·¥å…·å¯ä»¥é€‰æ‹©Swarmï¼Œä¹Ÿå¯ä»¥æ˜¯K8Sã€‚ æœ¬æ¬¡å®ç°æµç¨‹å¦‚ä¸‹ï¼š pushä»£ç åˆ°ç äº‘è§¦å‘WebHook Jenkinsä»ç äº‘æ‹‰å–ä»£ç  mavenæ„å»ºä»£ç  buildé•œåƒ pushé•œåƒåˆ°é•œåƒä»“åº“ éƒ¨ç½²æœåŠ¡ é…ç½®å…³äºJdkã€Gitã€Mavençš„é…ç½®è¿™é‡Œå°±ä¸è¯´ï¼Œè‡ªå·±é¢å‘æœç´¢å¼•æ“ã€‚è¿™é‡Œä¸»è¦è¯´Jenkinså’Œç äº‘çš„é…ç½®ã€‚ Jenkinså®‰è£…é…ç½® ä¸‹è½½Jenkinsï¼ˆé‡‡ç”¨waråŒ…å®‰è£…ï¼‰ å°†waråŒ…æ”¾å…¥Tomcatçš„webappsç›®å½•ä¸‹ è¿›å…¥YourHostIp:8080/jenkinsè·¯å¾„ä¸‹è¿›è¡ŒJenkinsçš„åˆå§‹åŒ–ï¼Œæˆ‘ä»¬è¿›å…¥ ç”¨æˆ·è‡ªå®šä¹‰æ’ä»¶ å®‰è£…ç•Œé¢ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„æ„å»ºæ–¹å¼é€‰æ‹©éœ€è¦å®‰è£…çš„æ’ä»¶ï¼Œæœ¬æ¬¡ä½¿ç”¨çš„Pipelinesæ–¹å¼è¿›è¡Œæ„å»ºï¼ŒPipelinesæ–¹å¼æ˜¯Jenkins2æ¨èçš„æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„å»ºPipelinesç›¸å…³çš„æ’ä»¶è¿›è¡Œå®‰è£…ï¼Œå½“ç„¶å¾…ä¼šè¿›å…¥Jenkinså®‰è£…ä¹Ÿè¡Œã€‚ é…ç½®ç”¨æˆ·åå’Œå¯†ç  å…¨å±€å·¥å…·é…ç½®ï¼ˆä»ç³»ç»Ÿç®¡ç†è¿›å…¥å…¨å±€å·¥å…·é…ç½®ï¼Œé…ç½®Jdkã€Gitã€Mavenï¼‰ å®‰å…¨é…ç½®ï¼ˆä»ç³»ç»Ÿç®¡ç†è¿›å…¥å…¨å±€å®‰å…¨é…ç½®ï¼‰,å¦‚ä¸‹å›¾ï¼š Jenkinsæ„å»ºä»»åŠ¡ æ–°å»ºä»»åŠ¡ï¼Œæ„å»ºä¸€ä¸ªæµæ°´çº¿ä»»åŠ¡ï¼ˆPipelineï¼‰ åœ¨é…ç½®é‡Œæ„å»ºè§¦å‘å™¨ï¼Œå¦‚ä¸‹å›¾ï¼š æ„å»ºPipelineè„šæœ¬ï¼ˆPipelineè„šæœ¬å†™æ³•è§å‚è€ƒï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758 #!groovy pipeline&#123; agent any //å®šä¹‰ä»“åº“åœ°å€ environment &#123; REPOSITORY=&quot;https://gitee.com/todorex/springboot_docker_git_jenkins_demo.git&quot; &#125; stages &#123; stage(&apos;è·å–ä»£ç &apos;)&#123; steps &#123; echo &quot;start fetch code from git:$&#123;REPOSITORY&#125;&quot; // æ¸…ç©ºå½“å‰ç›®å½• deleteDir() // æ‹‰å–ä»£ç  git &quot;$&#123;REPOSITORY&#125;&quot; // æ¸…ç©ºä¹‹å‰çš„å®¹å™¨ sh &apos;docker stop $(docker ps -a -q)&apos; sh &apos;docker rm $(docker ps -a -q)&apos; &#125; &#125; stage(&apos;Maven æ„å»º&apos;)&#123; steps &#123; echo &quot;start compile&quot; // åˆ‡æ¢ç›®å½• dir(&apos;demo&apos;) &#123; // é‡æ–°æ‰“åŒ… sh &apos;mvn -Dmaven.test.skip=true -U clean install&apos; &#125; &#125; &#125; stage(&apos;æ„å»ºé•œåƒ&apos;)&#123; steps &#123; echo &quot;start build image&quot; dir(&apos;demo&apos;) &#123; // buildé•œåƒ sh &apos;docker build -t todorex/springboot_docker_git_jenkins_demo:1.0 .&apos; // ç™»å½•é•œåƒä»“åº“ sh &apos;docker login -u your_username -p your_password&apos; // æ¨é€é•œåƒåˆ°é•œåƒä»“åº“ sh &apos;docker push todorex/springboot_docker_git_jenkins_demo:1.0&apos; &#125; &#125; &#125; stage(&apos;å¯åŠ¨æœåŠ¡&apos;)&#123; steps &#123; echo &quot;start demo&quot; // éƒ¨ç½²æœåŠ¡ sh &apos;docker run -d -p 8888:8888 --name=demo todorex/springboot_docker_git_jenkins_demo:1.0&apos; &#125; &#125; &#125;&#125; SSHçš„é…ç½®ä¸ºäº†é¿å…jenkinsæ‹‰å–ä»£ç æ—¶éœ€è¦è¾“å…¥å¯†ç ï¼Œè¿™é‡Œéœ€è¦é…ç½®SSHå…å¯†ç æ‹‰å–ã€‚å¦‚ä¸‹å›¾ï¼š WebHooksé…ç½®å½“ä½ æ¯æ¬¡å¯¹ä»£ç ä»“åº“è¿›è¡Œpushæ“ä½œæ—¶ï¼Œä¼šè‡ªåŠ¨é€šçŸ¥jenkinsè¿›è¡Œæ„å»º æµ‹è¯•è¿™æ¬¡é¡¹ç›®çš„ä»£ç ä»“åº“ä¸ºï¼šspringboot_docker_git_jenkins_demo å…³äºDockerfileä»¥åŠdocker-compose.ymlçš„ç¼–å†™ï¼Œè‡ªå·±ä¹Ÿå»é¢å‘æœç´¢å¼•æ“çœ‹çœ‹å§ã€‚ å½“æˆ‘ä»¬pushä»£ç ä¹‹åï¼Œjenkinså°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œæ„å»ºã€‚å¦‚ä¸‹å›¾ï¼š PSï¼šç¬¬ä¸€æ¬¡æ¯”è¾ƒæ…¢æ˜¯å› ä¸ºè¦å®‰è£…Mavenä¾èµ–ï¼Œåé¢å°±å¥½äº†ã€‚ æ€»ç»“è¿™é‡Œåªæ˜¯å±•ç¤ºäº†ä¸€ä¸ªCI/CDçš„å¼€å‘æµç¨‹ï¼Œå…³äºå…·ä½“æŠ€æœ¯ç»†èŠ‚ï¼Œæ— è®ºæ˜¯Jenkinsè¿˜æ˜¯Dockeréƒ½éœ€è¦æ·±å…¥å­¦ä¹ ï¼ŒåŠ æ²¹ï¼Œéªšå¹´ï¼ å‚è€ƒ SpringBoot+Docker+Git+Jenkinså®ç°ç®€æ˜“çš„æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½² Jenkins pipelineï¼špipeline è¯­æ³•è¯¦è§£]]></content>
      <categories>
        <category>è¿ç»´</category>
      </categories>
      <tags>
        <tag>SpringBoot</tag>
        <tag>Git</tag>
        <tag>Jenkins</tag>
        <tag>Docker</tag>
        <tag>CI</tag>
        <tag>CD</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mavenä½¿ç”¨æ•´ç†]]></title>
    <url>%2F2018%2F07%2F06%2F%E5%B7%A5%E5%85%B7%2FMaven%E4%BD%BF%E7%94%A8%E6%95%B4%E7%90%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä½¿ç”¨Javaè¯­è¨€æ¥å¼€å‘ä½ çš„é¡¹ç›®ï¼ŒåŸºæœ¬ä¸Šéƒ½å°‘ä¸äº†Mavenï¼Œå› ä¸ºæœ‰äº†å®ƒçœŸæ˜¯å¤ªæ–¹ä¾¿äº†ï¼ ä»€ä¹ˆæ˜¯MavenMavenæ˜¯ä¸€ç§ç”¨æ¥ç®¡ç†Javaé¡¹ç›®çš„å·¥å…·ã€ä½†ä¸æ˜¯é‚£ç§é‚£ç§ç”¨æ¥ç®¡ç†èµ„æºè§„åˆ’å’Œè°ƒåº¦çš„å·¥å…·ã€‚ç›¸åï¼Œå®ƒå¤„ç†çš„æ—¶ä¸€ä¸ªå…·ä½“çš„é¡¹ç›®æ‰€æ¶‰åŠçš„å„ç§ä»»åŠ¡ï¼Œå¦‚ç¼–è¯‘ã€æµ‹è¯•ã€æ‰“åŒ…ä»¥åŠéƒ¨ç½²ã€‚ MavenåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š ä¸€ç»„ç”¨äºå¤„ç†ç®¡ç†ä¾èµ–(ä»ä¸­å¤®ä»“åº“æ‹‰å–çš„jaråŒ…)ã€ç›®å½•ç»“æ„ä»¥åŠæ„å»ºå·¥ä½œæµçš„çº¦å®šã€‚ åŸºäºè¿™äº›çº¦å®šå®ç°çš„æ ‡å‡†åŒ–å¯ä»¥æå¤§åœ°ç®€åŒ–å¼€å‘è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¸¸ç”¨çš„ç›®å½•ç»“æ„ä½¿å¾—å¼€å‘è€…å¯ä»¥æ›´åŠ å®¹æ˜“è·Ÿä¸Šä¸ç†Ÿæ‚‰çš„é¡¹ç›®çš„èŠ‚å¥ã€‚ ä¸€ä¸ªç”¨äºé¡¹ç›®é…ç½®çš„XML Schemaï¼šé¡¹ç›®å¯¹è±¡æ¨¡å‹(Project Object Model)ï¼Œç®€ç§°POMã€‚ æ¯ä¸€ä¸ªMavené¡¹ç›®éƒ½æ‹¥æœ‰ä¸€ä¸ªPOMæ–‡ä»¶ï¼Œå¹¶å‘½åä¸ºpom.xmlï¼ŒåŒ…å«Mavenç”¨äºç®¡ç†è¯¥é¡¹ç›®çš„æ‰€æœ‰çš„é…ç½®ä¿¡æ¯ã€‚ ä¸€ä¸ªå§”æ‰˜å¤–éƒ¨ç»„ä»¶æ¥æ‰§è¡Œé¡¹ç›®ä»»åŠ¡çš„æ’ä»¶ç»“æ„ã€‚ è¿™ç®€åŒ–äº†æ›´æ–°ä¸€é›†æ‰©å±•Mavenèƒ½åŠ›çš„è¿‡ç¨‹ã€‚ Mavenå®‰è£…PSï¼š ä¸Šé¢æåˆ°äº†Mavenå¸®æˆ‘ä»¬ç®¡ç†ä¾èµ–ï¼Œæ˜¯é€šè¿‡ä»ä¸­å¤®ä»“åº“æ‹‰å–jaråŒ…(ä¾èµ–)æ¥å®ç°ï¼Œä½†æ˜¯ç”±äºMavençš„ä¸­å¤®ä»“åº“åœ¨å›½å¤–ï¼Œæ‹‰å–ä¼šæ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¼šé€šè¿‡é…ç½®é˜¿é‡Œäº‘é•œåƒæ¥åŠ å¿«é€Ÿåº¦ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥Nexusæ­å»ºè‡ªå·±çš„ç§æœ‰ä»“åº“ã€‚ Mavenå®‰è£…æ•™ç¨‹ é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“ POMPOMæ–‡ä»¶å¤§çº²å¦‚ä¸‹ï¼š12345678910&lt;project&gt; // æ ¹å…ƒç´  &lt;groupId/&gt; &lt;artifactId/&gt; &lt;version/&gt; // ä¸Šé¢ä¸‰ä¸ª(GAVåæ ‡)å”¯ä¸€åœ°å®šä¹‰Mavené¡¹ç›®çš„å€¼ &lt;packaging/&gt; // é¡¹ç›®æ‰“åŒ…æ–¹å¼ï¼Œé»˜è®¤å€¼æ˜¯jar &lt;properties/&gt; // åœ¨POMä¸­å¼•ç”¨çš„å±æ€§ï¼Œä¸€èˆ¬ä¼šæ”¾ç‰ˆæœ¬ä¿¡æ¯ &lt;dependencies/&gt; //æ„å»ºå½“å‰é¡¹ç›®æ‰€éœ€è¦çš„å…¶ä»–Mavené¡¹ç›® &lt;build/&gt; // æ„å»ºæ”¹é¡¹ç›®æ‰€éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡çš„é…ç½® &lt;profiles/&gt; // ä¸ºä¸åŒçš„ç”¨ä¾‹è‡ªå®šä¹‰POMï¼Œä¸€èˆ¬ç”¨æ¥é…ç½®ç¯å¢ƒçš„åˆ‡æ¢&lt;/project&gt; Mavenæ„ä»¶ä»»ä½•å¯ä»¥è¢«Mavençš„åæ ‡ç³»ç»Ÿ(GAV)å”¯ä¸€æ ‡è¯†çš„å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªMavenæ„ä»¶ã€‚ Mavenæ„ä»¶çš„ç±»å‹ç”±pomæ–‡ä»¶çš„å…ƒç´ æŒ‡å®šã€‚æœ€å¸¸ç”¨çš„å€¼æ˜¯pomã€jarã€earã€warä»¥åŠmaven-pluginã€‚ POMæ–‡ä»¶ä½¿ç”¨æ–¹å¼ é»˜è®¤çš„ï¼šç”¨äºæ„å»ºä¸€ä¸ªæ„ä»¶ çˆ¶POMï¼šæä¾›ä¸€ä¸ªç”±å­é¡¹ç›®ç»§æ‰¿çš„å•ä¸ªé…ç½®ä¿¡æ¯æºï¼Œå­é¡¹ç›®é€šè¿‡å£°æ˜è¿™ä¸ªpomæ–‡ä»¶ä½œä¸ºå®ƒä»¬çš„å…ƒç´ å€¼ èšåˆå™¨ï¼šç”¨äºæ„å»ºä¸€ç»„å£°æ˜ä¸ºçš„é¡¹ç›®ï¼Œè¿™äº›å­é¡¹ç›®ä½äºå…¶å½“å‰èšåˆå™¨é¡¹ç›®çš„æ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªéƒ½åŒ…å«æœ‰ä»–è‡ªå·±çš„pomæ–‡ä»¶ PSï¼š ä½œä¸ºçˆ¶pomæˆ–è€…èšåˆå™¨çš„pomæ–‡ä»¶çš„å…ƒç´ çš„å€¼å°†æ˜¯pomã€‚ GAVåæ ‡POMå®šä¹‰äº†5ç§ç§°ä¸ºåæ ‡çš„å…ƒç´ ï¼Œç”¨äºæ ‡è¯†Mavenæ„ä»¶ï¼Œé¦–å­—æ¯ç¼©å†™GAVæŒ‡çš„æ˜¯å¿…é¡»å§‹ç»ˆæŒ‡å®šçš„3ä¸ªåæ ‡ã€ã€ çš„é¦–å­—æ¯ã€‚ ä¸‹é¢çš„åæ ‡æ˜¯æŒ‰ç…§ä»–ä»¬åœ¨åæ ‡è¡¨è¾¾å¼ä¸­å‡ºç°çš„é¡ºåºåˆ—å‡ºï¼š æ˜¯é¡¹ç›®æˆ–è€…é¡¹ç›®ç»„çš„å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ã€‚è¿™é€šå¸¸æ˜¯Javaæºä»£ç ä½¿å‘˜å·¥çš„å…¨é™å®šçš„JavaåŒ…åã€‚ä¾‹å¦‚ï¼Œio.nettyã€com.googleã€‚ ç”¨äºæ ‡è¯†å’ŒæŸä¸ªç›¸å…³çš„ä¸åŒçš„æ„ä»¶ã€‚ä¾‹å¦‚ï¼Œnetty-allã€netty-handlerã€‚ æ˜¯æŒ‡å’Œé¡¹ç›®ç›¸å…³çš„ä¸»è¦æ„ä»¶çš„ç±»å‹(å¯¹åº”äºæ„ä»¶çš„POMæ–‡ä»¶ä¸­çš„å€¼)ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯jarï¼Œæ­¤å¤–è¿˜æœ‰pomã€earã€‚ æ ‡è¯†äº†æ„ä»¶çš„ç‰ˆæœ¬ã€ä¾‹å¦‚1.1ã€2.0-SNAPSHOTã€4.1.9.Finalã€‚ ç”¨äºåŒºåˆ†å±äºç›¸åŒçš„POMä½†æ˜¯å´è¢«ä»¥ä¸åŒæ–¹å¼æ„å»ºçš„æ„ä»¶ã€‚ä¾‹å¦‚ï¼Œjavadockã€sourcesã€jdk16ã€jdk17ã€‚ ä¸€ä¸ªå®Œæ•´çš„åæ ‡è¡¨è¾¾å¼å…·æœ‰å¦‚ä¸‹æ ¼å¼ï¼š1actifactId:groupId:packaging:version:classifier POMæ–‡ä»¶å¿…é¡»å£°æ˜å®ƒæ‰€ç®¡ç†çš„æ„ä»¶çš„åæ ‡ï¼Œä¸€ä¸ªå…·æœ‰å¦‚ä¸‹åæ ‡çš„é¡¹ç›®ï¼š1234&lt;groupId&gt;io.netty&lt;/groupId&gt;&lt;artifactId&gt;netty-all&lt;/artifactId&gt;&lt;version&gt;4.1.9.Final&lt;/version&gt;&lt;packaging&gt;jar&lt;/packaging&gt; å°†ä¼šäº§ç”Ÿä¸€ä¸ªå…·æœ‰ä»¥ä¸‹æ ¼å¼çš„åç§°çš„æ„ä»¶ï¼šartifactId-&lt;version&gt;.&lt;packaging&gt; ä¾èµ–ä¾èµ–å¼•å…¥é¡¹ç›®çš„ä¾èµ–æ˜¯æŒ‡ç¼–è¯‘å’Œæ‰§è¡Œå®ƒæ‰€éœ€è¦çš„å¤–éƒ¨æ„ä»¶ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ çš„é¡¹ç›®çš„ä¾èµ–é¡¹ä¹Ÿä¼šæœ‰å®ƒè‡ªå·±çš„ä¾èµ–ã€‚æˆ‘ä»¬ç§°è¿™äº›ä¾èµ–ä¸ºä½ çš„é¡¹ç›®çš„ä¼ é€’ä¾èµ–ã€‚ä¸€ä¸ªè´Ÿè´£çš„é¡¹ç›®å¯èƒ½ä¼šæœ‰ä¸€ä¸ªæ·±å±‚çº§çš„ä¾èµ–æ ‘ã€‚Maven æä¾›äº†å„ç§ç”¨äºå¸®åŠ©ç†è§£å’Œç®¡ç†å®ƒçš„å·¥å…·ï¼Œå¦‚æ‰§è¡Œmvn dependency:treeã€‚ Mavençš„å£°æ˜åœ¨POMçš„å…ƒç´ ä¸­ï¼š12345678910&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId/&gt; &lt;artifactId/&gt; &lt;version/&gt; &lt;type/&gt; &lt;scope/&gt; &lt;systemPath/&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åœ¨å£°æ˜ä¸­ï¼ŒGAVåæ ‡æ˜¯å¿…ä¸å¯å°‘çš„ã€‚typeå’Œscopeå…ƒç´ å¯¹äºé‚£äº›å€¼ä¸åˆ†åˆ«æ˜¯é»˜è®¤å€¼jarå’Œcompileçš„ä¾èµ–æ¥è¯´ä¹Ÿæ˜¯å¿…é¡»çš„ã€‚ å…³äºscopeæŒ‡çš„æ˜¯ä¾èµ–èŒƒå›´ï¼Œå³classpathï¼ŒMavené‡Œæœ‰3ç±»ä¾èµ–èŒƒå›´ï¼š ç¼–è¯‘ æµ‹è¯• è¿è¡Œ å…ƒç´ å…·æœ‰ä»¥ä¸‹å€¼ï¼ˆä¾èµ–èŒƒå›´ï¼‰ï¼š compileï¼šç¼–è¯‘ï¼ˆé»˜è®¤ï¼‰ runtimeï¼šè¿è¡Œ providedï¼šå¯¹äºç¼–è¯‘å’Œæµ‹è¯•æœ‰æ•ˆï¼Œè¿è¡Œæ—¶æ— æ•ˆ testï¼šæµ‹è¯• importï¼šä½¿ç”¨åœ¨ä¸­ï¼Œå¯¼å…¥å…¶ä»–é¡¹ç›®çš„ systemPathï¼šä¸providedä¸€ç›´ï¼Œä½†æ˜¯éœ€è¦æŒ‡å®šä¾èµ–æ–‡ä»¶çš„ç»å¯¹ä½ç½® ä¾èµ–ç®¡ç†POMçš„å…ƒç´ å¯ä»¥åŒ…å«è¢«å…¶ä»–é¡¹ç›®ä½¿ç”¨çš„å£°æ˜ï¼ˆä½†ä¸æ‹‰å–ï¼‰ï¼Œè¿™æ ·çš„POMçš„å­é¡¹ç›®ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™äº›å£°æ˜ï¼Œå…¶ä»–é¡¹ç›®å¯ä»¥ç”¨è¿‡ä½¿ç”¨å…ƒç´ å€¼æ¥å¯¼å…¥ä»–ä»¬ã€‚ å¼•ç”¨äº†å…ƒç´ çš„é¡¹ç›®å¯ä»¥ä½¿ç”¨å®ƒæ‰€å£°æ˜çš„ä¾èµ–ï¼Œè€Œä¸éœ€è¦æŒ‡å®šä»–ä»¬çš„åæ ‡ï¼Œå¦‚æœä¸­çš„åœ¨ç¨åæ”¹å˜ï¼Œåˆ™æ‰€æœ‰åº”ç”¨å®ƒçš„poméƒ½ä¼šæ”¹å˜ã€‚ æœ€ä½³å®è·µï¼šåœ¨åŸPOMä¸­çš„æ‰€æœ‰ç‰ˆæœ¬éƒ½åˆ©ç”¨å…ƒç´ æ§åˆ¶ã€‚ æ„ä»¶çš„ç”Ÿå‘½å‘¨æœŸMavençš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ä¸ºäº†å¯¹æ‰€æœ‰çš„æ„å»ºè¿‡ç¨‹è¿›è¡ŒæŠ½è±¡å’Œç»Ÿä¸€ã€‚è¿™ä¸ªç”Ÿå‘½å‘¨æœŸåŒ…å«äº†é¡¹ç›®çš„æ¸…ç†ã€åˆå§‹åŒ–ã€ç¼–è¯‘ã€æµ‹è¯•ã€æ‰“åŒ…ã€é›†æˆæµ‹è¯•ã€éªŒè¯ã€éƒ¨ç½²å’Œç«™ç‚¹ç”Ÿæˆç­‰å‡ ä¹æ‰€æœ‰æ„å»ºæ­¥éª¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡ æ‰€æ‰€æœ‰çš„é¡¹ç›®çš„æ„å»ºï¼Œéƒ½èƒ½æ˜ å°„åˆ°è¿™æ ·ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸä¸Šã€‚ Mavenæ‹¥æœ‰ä¸‰å¥—ç›¸äº’ç‹¬ç«‹ç”Ÿå‘½å‘¨æœŸï¼Œä»–ä»¬åˆ†åˆ«ä¸ºcleanã€defaultå’Œsiteã€‚cleanç”Ÿå‘½å‘¨æœŸçš„ç›®çš„æ˜¯æ¸…ç†é¡¹ç›®ã€defaultç”Ÿå‘½å‘¨æœŸçš„ç›®çš„æ˜¯æ„å»ºé¡¹ç›®ã€siteç”Ÿå‘½å‘¨æœŸçš„ç›®çš„æ˜¯å»ºç«‹é¡¹ç›®ç«™ç‚¹ã€‚æ¯ä¸ªç”Ÿå‘½å‘¨æœŸåŒ…å«ä¸€äº›é˜¶æ®µï¼Œè¿™äº›é˜¶æ®µæ˜¯æœ‰é¡ºåºçš„ï¼Œå¹¶ä¸”åé¢çš„é˜¶æ®µä¾èµ–äºå‰é¢çš„é˜¶æ®µã€‚ä½†æ˜¯ä¸‰å¥—ç”Ÿå‘½å‘¨æœŸæœ¬èº«æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚æˆ‘ä»¬æŒ‰ç…§æ—¥å¸¸çš„éœ€æ±‚ï¼Œæˆ‘ä»¬åªè¯´å‰ä¸¤ä¸ªã€‚ cleanç”Ÿå‘½å‘¨æœŸå®ƒåŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼š pre-cleanï¼šæ‰§è¡Œæ¸…ç†å‰è¦å®Œæˆçš„å·¥ä½œã€‚ cleanï¼šæ¸…ç†ä¸Šä¸€æ¬¡æ„å»ºç”Ÿæˆçš„æ–‡ä»¶ã€‚ post-cleanï¼šæ‰§è¡Œä¸€äº›æ¸…ç†åéœ€è¦å®Œæˆçš„å·¥ä½œã€‚ defaultç”Ÿå‘½å‘¨æœŸdefaultç”Ÿå‘½å‘¨æœŸå®šä¹‰äº†çœŸæ­£æ„å»ºæ—¶æ‰€éœ€è¦æ‰§è¡Œçš„è€Œæ‰€æœ‰æ­¥éª¤ï¼Œè¿™é‡Œä¹Ÿåªæ˜¯åˆ—å‡ºé‡è¦çš„é˜¶æ®µï¼š validateï¼šæ£€æŸ¥é¡¹ç›®æ˜¯å¦æ­£ç¡® compileï¼šç¼–è¯‘é¡¹ç›®çš„æºä»£ç  testï¼šä½¿ç”¨å•å…ƒæµ‹è¯•æ¡†æ¶è¿›è¡Œæµ‹è¯•ï¼Œæµ‹è¯•ä»£ç ä¸ä¼šè¢«æ‰“åŒ…éƒ¨ç½² packageï¼šå°†ç¼–è¯‘çš„ä»£ç æ‰“åŒ…ä¸ºå¯å‘å¸ƒçš„æ ¼å¼ï¼Œå¦‚jar verifyï¼šéªŒè¯è½¯ä»¶åŒ…æ˜¯å¦æœ‰æ•ˆ installï¼šå°†åŒ…å®‰è£…åˆ°æœ¬åœ°ä»“åº“ä¸­ï¼Œå¯ä»¥ä¾›æœ¬åœ°å…¶ä»–Mavené¡¹ç›®ä½¿ç”¨ deployï¼šå°†åŒ…å¤åˆ¶åˆ°è¿œç¨‹ä»“åº“ä¸­ï¼Œå¯ä»¥ä¾›å…¶ä»–å¼€å‘äººå‘˜ä½¿ç”¨ æ’ä»¶è™½ç„¶Mavenåè°ƒäº†æ‰€æœ‰æ„å»ºç”Ÿå‘½å‘¨æœŸé˜¶æ®µçš„æ‰§è¡Œï¼Œä½†æ˜¯ä»–å¹¶æ²¡æœ‰ç›´æ¥å®ç°å®ƒä»¬ï¼Œè€Œæ˜¯å°†ä»–ä»¬å§”æ‰˜ç»™äº†æ’ä»¶ã€‚è¿™äº›æ’ä»¶æ˜¯maven-pluginç±»å‹çš„æ„ä»¶(æ‰“åŒ…ä¸ºJARæ–‡ä»¶)ã€‚Mavenä¸ºæ ‡å‡†æ„ä»¶ç”Ÿå‘½å‘¨æœŸæ‰€å®šä¹‰çš„æ‰€æœ‰ä»»åŠ¡éƒ½æä¾›äº†æ’ä»¶ï¼Œä½†æ›´å¤šçš„æ˜¯ç”±ç¬¬ä¸‰æ–¹ç”Ÿäº§çš„ï¼Œç”¨äºå¤„ç†å„ç§è‡ªå®šä¹‰çš„ä»»åŠ¡ã€‚ æ’ä»¶ç›®æ ‡æ¯ä¸ªæ’ä»¶éƒ½æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯ä¸ªæ’ä»¶åŠŸèƒ½å¯¹åº”äº†æ’ä»¶ä¸€ä¸ªç›®æ ‡ã€‚å¦‚æˆ‘ä»¬ä¹‹å‰åˆ†æä¾èµ–çš„maven-dependency-pluginï¼Œå®ƒå°±æœ‰åå¤šä¸ªç›®æ ‡ï¼Œå¦‚ä¸‹ï¼š1234// å‘½ä»¤è¡Œå†’å·å‰é¢æ˜¯æ’ä»¶ï¼Œå†’å·åé¢æ˜¯ç›®æ ‡ï¼ˆåŠŸèƒ½ï¼‰mvn dependency:analyzemvn dependency:treemvn dependency:list æ’ä»¶ç»‘å®šMavençš„ç”Ÿå‘½å‘¨æœŸä¸æ’ä»¶ç›¸äº’ç»‘å®šï¼Œç”¨ä»¥å®Œæˆå®é™…çš„æ„å»ºä»»åŠ¡ã€‚ å†…ç½®ç»‘å®šä¸ºäº†è®©ç”¨æˆ·å‡ ä¹ä¸ç”¨ä»»ä½•é…ç½®å°±èƒ½æ„å»ºMavené¡¹ç›®ï¼ŒMavenä¸ºä¸€äº›ä¸»è¦çš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µç»‘å®šäº†å¾ˆå¤šæ’ä»¶çš„ç›®æ ‡ï¼Œå¦‚ï¼š maven-clean-plugin:cleanç»‘å®šäº†clean maven-compiler-plugin:compileç»‘å®šäº†compile maven-surefire-plugin:testç»‘å®šäº†test maven-jar-plugin:jarç»‘å®špackageé»˜è®¤ maven-install-plugin:installç»‘å®šäº†install è‡ªå®šä¹‰ç»‘å®šé™¤äº†å†…ç½®ç»‘å®šä¹‹å¤–ï¼Œç”¨æˆ·è¿˜èƒ½å¤Ÿè‡ªå·±é€‰æ‹©å°†æŸä¸ªæ’ä»¶ç›®æ ‡ç»‘å®šåˆ°ç”Ÿå‘½å‘¨æœŸçš„æŸä¸ªé˜¶æ®µä¸Šã€‚å¦‚ä¸‹ï¼š12345678910111213141516171819202122&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;!--å¼•å…¥æ’ä»¶--&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;!--æ„å»ºä»»åŠ¡--&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;attach-source&lt;/id&gt; &lt;!--ç»‘å®šé˜¶æ®µ--&gt; &lt;phase&gt;verify&lt;/phase&gt; &lt;!--ç»‘å®šç›®æ ‡--&gt; &lt;goals&gt; &lt;goal&gt;jar-no-fork&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; å¾ˆå¤šæ’ä»¶çš„ç›®æ ‡åœ¨ç¼–å†™æ˜¯å°±å·²ç»å®šä¹‰äº†é»˜è®¤ç»‘å®šé˜¶æ®µï¼Œå¯ä»¥åˆ©ç”¨maven-help-pluginæŸ¥çœ‹æ’ä»¶è¯¦ç»†ä¿¡æ¯ï¼Œäº†è§£æ’ä»¶ç›®æ ‡çš„é»˜è®¤ç»‘å®šé˜¶æ®µã€‚è¿è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š1mvn help:describe -Dplugin=org.apache.maven.plugins:maven-source-plugin:3.0.1 å¦‚æœå¤šä¸ªç›®æ ‡è¢«ç»‘å®šåˆ°åŒä¸€ä¸ªé˜¶æ®µçš„æ—¶å€™ï¼Œè¿™äº›æ’ä»¶å£°æ˜çš„å…ˆåé¡ºåºå†³å®šäº†ç›®æ ‡çš„æ‰§è¡Œé¡ºåºã€‚ æ’ä»¶é…ç½®å‘½ä»¤è¡Œæ’ä»¶é…ç½®å¾ˆå¤šæ’ä»¶ç›®æ ‡çš„å‚æ•°éƒ½æ˜¯æ”¯æŒå‘½ä»¤è¡Œé…ç½®çš„ï¼Œç”¨æˆ·å¯ä»¥åœ¨Mavenå‘½ä»¤ä¸­ä½¿ç”¨-Då‚æ•°ï¼Œå¹¶ä¼´éšå‚æ•°é”®=å‚æ•°å€¼çš„å½¢å¼æ¥é…ç½®æ’ä»¶ç›®æ ‡çš„å‚æ•°ï¼Œå¦‚ä¸Šmvn helpã€‚ POMä¸­æ’ä»¶å…¨å±€é…ç½®ä¸ºäº†é¿å…æ’ä»¶å‚æ•°é‡å¤ä¹¦å†™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨pomè¿›è¡Œå…¨å±€é…ç½®ï¼Œå¦‚ä¸‹ï¼š1234567891011&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;configuration&gt; &lt;!--ç¼–è¯‘Java1.8ç‰ˆæœ¬çš„æºæ–‡ä»¶--&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;!--ç”Ÿæˆä¸JVM1.8å…¼å®¹çš„å­—èŠ‚ç æ–‡ä»¶--&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;/configuration&gt;&lt;/plugin&gt; æ’ä»¶ç®¡ç†POMçš„å…ƒç´ å¯ä»¥åŒ…å«è¢«å…¶ä»–é¡¹ç›®ä½¿ç”¨çš„å£°æ˜ï¼ˆä½†ä¸æ‹‰å–ï¼‰ï¼Œè¿™æ ·çš„POMçš„å­é¡¹ç›®ä¼šè‡ªåŠ¨ç»§æ‰¿è¿™äº›å£°æ˜ã€‚ å¼•ç”¨äº†å…ƒç´ çš„é¡¹ç›®å¯ä»¥ä½¿ç”¨å®ƒæ‰€å£°æ˜çš„ä¾èµ–ï¼Œè€Œä¸éœ€è¦æŒ‡å®šä»–ä»¬çš„åæ ‡ï¼Œå¦‚æœä¸­çš„åœ¨ç¨åæ”¹å˜ï¼Œåˆ™æ‰€æœ‰åº”ç”¨å®ƒçš„poméƒ½ä¼šæ”¹å˜ã€‚ æœ€ä½³å®è·µï¼šåœ¨åŸPOMä¸­çš„æ‰€æœ‰ç‰ˆæœ¬éƒ½åˆ©ç”¨å…ƒç´ æ§åˆ¶ã€‚ èšåˆå’Œç»§æ‰¿èšåˆå¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€æ¬¡æ„å»ºä¸¤ä¸ªé¡¹ç›®ï¼Œè€Œä¸æ˜¯åˆ°ä¸¤ä¸ªæ¨¡å—çš„ç›®å½•ä¸‹åˆ†åˆ«æ‰§è¡Œmvnå‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Mavenèšåˆã€‚ æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªèšåˆæ„ä»¶ï¼ˆé™¤äº†pomæ–‡ä»¶ï¼ˆpackagingéœ€è¦ä¸ºpomï¼‰ï¼Œå…¶ä»–å¯ä»¥éƒ½ä¸è¦ï¼‰ï¼Œç„¶ååœ¨èšåˆæ„ä»¶ç›®å½•ä¸‹åˆ›å»ºä¸¤ä¸ªæ„ä»¶ï¼Œå¹¶åœ¨èšåˆæ„ä»¶ä¸‹åˆ©ç”¨æ¥å£°æ˜ï¼Œæ¯ä¸ªmoduleçš„å€¼éƒ½æ˜¯ä¸€ä¸ªå½“å‰ç›®å½•çš„ç›¸å¯¹ç›®å½•ï¼Œå¦‚ä¸‹ï¼š1234&lt;modules&gt; &lt;module&gt;email&lt;/module&gt; &lt;module&gt;user&lt;/module&gt;&lt;/modules&gt; ç»§æ‰¿å¦‚æœä¸¤ä¸ªé¡¹ç›®æœ‰é‡å¤çš„ä¾èµ–æˆ–æ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»§æ‰¿ã€‚ æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªçˆ¶æ„ä»¶ï¼ˆé™¤äº†pomæ–‡ä»¶ï¼ˆpackagingéœ€è¦ä¸ºpomï¼‰ï¼Œå…¶ä»–å¯ä»¥éƒ½ä¸è¦ï¼‰ï¼Œç„¶ååœ¨çˆ¶æ„ä»¶ç›®å½•ä¸‹åˆ›å»ºä¸¤ä¸ªå­æ„ä»¶ï¼Œå¹¶åœ¨å­æ„ä»¶ä¸‹åˆ©ç”¨æ¥å£°æ˜ç»§æ‰¿å…³ç³»ï¼Œå¦‚ä¸‹ï¼š123456&lt;parent&gt; &lt;groupId/&gt; &lt;artifactId/&gt; &lt;version/&gt; &lt;relativePath&gt;çˆ¶pomçš„ç›¸å¯¹è·¯å¾„&lt;/relativePath&gt;&lt;/parent&gt; å‚è€ƒ Mavenå®‰è£…æ•™ç¨‹ é…ç½®é˜¿é‡Œäº‘é•œåƒä»“åº“ ã€ŠMavenå®æˆ˜ã€‹ Maven æ ‡ç­¾]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitä½¿ç”¨æ•´ç†]]></title>
    <url>%2F2018%2F07%2F05%2F%E5%B7%A5%E5%85%B7%2FGit%E4%BD%BF%E7%94%A8%E6%95%B4%E7%90%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè™½ç„¶æ—¥å¸¸ä½¿ç”¨gitï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™æ€»æ˜¯ä¼šå¿˜è®°ä¸€äº›æ“ä½œï¼Œéš¾å…ä¼šé¢å‘æœç´¢å¼•æ“æŸ¥æ‰¾ã€‚æ‰€ä»¥è¿™é‡Œå°±æ€»ç»“ä¸€ä¸‹ã€‚ ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿè°ˆåˆ°Gitï¼Œå°±éœ€è¦å…ˆè¯´è¯´ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå°±æ˜¯èƒ½è‡ªåŠ¨å¸®æˆ‘ä»¬è®°å½•æ¯æ¬¡æ–‡ä»¶çš„æ”¹åŠ¨çš„ä¸€ä¸ªè½¯ä»¶ï¼Œè€ŒGitå°±æ˜¯å®ƒçš„ä¸€ç§å®ç°ã€‚æƒ³æƒ³æˆ‘ä»¬å†™è®ºæ–‡è¿˜æ˜¯å†™ä»£ç ï¼Œæ˜¯ä¸æ˜¯æœ‰äº†ä»–å°±å¾ˆæ–¹ä¾¿äº†ï¼Œå†ä¹Ÿä¸ç”¨è‡ªå·±æ‰‹åŠ¨å¤‡ä»½æ¯ä¸€æ¬¡ä¿®æ”¹äº†ã€‚ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿåˆåˆ†ä¸ºé›†ä¸­å¼å’Œåˆ†å¸ƒå¼ã€‚ é›†ä¸­å¼ï¼ˆSVNï¼‰ é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„ç‰ˆæœ¬åº“æ˜¯é›†ä¸­å­˜æ”¾åœ¨ä¸­å¤®æœåŠ¡å™¨çš„ï¼Œè€Œæˆ‘ä»¬åœ¨å¹²æ´»çš„æ—¶å€™ï¼Œç”¨çš„éƒ½æ˜¯è‡ªå·±çš„ç”µè„‘ï¼Œæ‰€ä»¥è¦å…ˆä»ä¸­å¤®æœåŠ¡å™¨å–å¾—æœ€æ–°çš„ç‰ˆæœ¬ï¼Œç„¶åå¼€å§‹å¹²æ´»ï¼Œå¹²å®Œæ´»äº†ï¼Œå†æŠŠè‡ªå·±çš„æ´»æ¨é€ç»™ä¸­å¤®æœåŠ¡å™¨ã€‚ é—®é¢˜ï¼šå¿…é¡»è”ç½‘æ‰èƒ½å·¥ä½œï¼›ä¸­å¤®æœåŠ¡å™¨è¦æ˜¯å‡ºäº†é—®é¢˜ï¼Œæ‰€æœ‰äººéƒ½æ²¡æ³•å¹²æ´»äº† åˆ†å¸ƒå¼ï¼ˆGitï¼‰ æ¯ä¸ªäººçš„ç”µè„‘ä¸Šéƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬åº“ï¼Œè¿™æ ·ï¼Œä½ å·¥ä½œçš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦è”ç½‘äº†ï¼Œå› ä¸ºç‰ˆæœ¬åº“å°±åœ¨ä½ è‡ªå·±çš„ç”µè„‘ä¸Šã€‚åœ¨åŒæ–¹åä½œçš„æ—¶å€™ï¼Œå¦‚æœä½ åœ¨è‡ªå·±ç”µè„‘ä¸Šæ”¹äº†æ–‡ä»¶Aï¼Œä½ çš„åŒäº‹ä¹Ÿåœ¨ä»–çš„ç”µè„‘ä¸Šæ”¹äº†æ–‡ä»¶Aï¼Œè¿™æ—¶ï¼Œä½ ä»¬ä¿©ä¹‹é—´åªéœ€æŠŠå„è‡ªçš„ä¿®æ”¹æ¨é€ç»™å¯¹æ–¹ï¼Œå°±å¯ä»¥äº’ç›¸çœ‹åˆ°å¯¹æ–¹çš„ä¿®æ”¹äº†ã€‚ åœ¨å®é™…ä½¿ç”¨åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„æ—¶å€™ï¼Œå…¶å®å¾ˆå°‘åœ¨ä¸¤äººä¹‹é—´çš„ç”µè„‘ä¸Šæ¨é€ç‰ˆæœ¬åº“çš„ä¿®æ”¹ï¼Œè€Œä¸”å¦‚æœä½ ä»¬ä¿©ä¸åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œä¸¤å°ç”µè„‘ä¹Ÿäº’ç›¸è®¿é—®ä¸äº†ã€‚æ‰€ä»¥åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿé€šå¸¸ä¹Ÿæœ‰ä¸€å°å……å½“â€œä¸­å¤®æœåŠ¡å™¨â€çš„ç”µè„‘ï¼Œä½†è¿™ä¸ªæœåŠ¡å™¨çš„ä½œç”¨ä»…ä»…æ˜¯ç”¨æ¥æ–¹ä¾¿â€œäº¤æ¢â€å¤§å®¶çš„ä¿®æ”¹ï¼Œæ²¡æœ‰å®ƒå¤§å®¶ä¹Ÿä¸€æ ·å¹²æ´»ï¼Œåªæ˜¯äº¤æ¢ä¿®æ”¹ä¸æ–¹ä¾¿è€Œå·²ã€‚ Gitä½¿ç”¨Gitå®‰è£…è¿™é‡Œå°±ä¸å¤šè¯´äº†ï¼Œæ¨èå»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™å®‰è£…æ•™ç¨‹ã€‚ GitåŒºåŸŸ å·¥ä½œåŒºï¼ˆWorkspaceï¼‰ï¼šåœ¨è®¡ç®—æœºèƒ½çœ‹åˆ°çš„ç›®å½•ã€‚ ç¼“å­˜åŒºï¼ˆIndex/Stageï¼‰ï¼šä¸´æ—¶ä¿å­˜æˆ‘ä»¬çš„æ”¹åŠ¨ã€‚ ç‰ˆæœ¬åº“ï¼ˆRepositoryï¼‰ï¼šå·¥ä½œåŒºæœ‰ä¸€ä¸ªéšè—çš„ç›®å½•.gitï¼Œå®ƒæ˜¯Gitçš„æœ¬åœ°ç‰ˆæœ¬åº“ã€‚ è¿œç¨‹ä»“åº“ï¼ˆRemoteï¼‰ï¼šâ€œGitä¸­å¤®æœåŠ¡å™¨â€ï¼Œæ‰˜ç®¡åœ¨ç½‘ç»œä¸­çš„é¡¹ç›®çš„ç‰ˆæœ¬åº“ï¼Œå¯ä¾›å¤šäººåä½œå¼€å‘ã€‚ï¼ˆå›½å¤–æœ‰åŸºä½¬ä¿±ä¹éƒ¨Githubï¼Œå›½å†…æœ‰ç äº‘ã€Codingã€è¿˜æœ‰å¯ä¸ªäººæˆ–è€…å…¬å¸å®šåˆ¶çš„GitLabï¼Œè¯·æŒ‰éœ€é€‰æ‹©ï¼‰ Gitä¸ªäººæ“ä½œåœ¨ä¸Šé¢çš„åŒºåŸŸå›¾ä¸­ï¼Œå…¶å®æˆ‘ä»¬å·²ç»çœ‹åˆ°å¾ˆå¤šæ“ä½œï¼Œè¿™é‡Œæˆ‘å†æ€»ç»“ä¸€ä¸‹ï¼š æ–°å»ºä»“åº“ åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªGitä»“åº“ 1git init åœ¨å½“å‰ç›®å½•å…‹éš†ä¸€ä¸ªä»“åº“ 1git clone [url] å¢åŠ æ–‡ä»¶ æ·»åŠ æŒ‡å®šæ–‡ä»¶/ç›®å½•åˆ°æš‚å­˜åŒº 1git add [file]/[dir] æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼ˆæ…ç”¨ï¼Œå°¤å…¶åœ¨IDEä¸­ï¼Œå› ä¸ºå®ƒä¼šåŒ…å«IDEçš„é…ç½®æ–‡ä»¶ï¼Œå¦‚IDEAçš„.ideaå’Œimlæ–‡ä»¶ï¼‰ 1git add . æäº¤æ–‡ä»¶ æäº¤ç¼“å­˜åŒºçš„æ–‡ä»¶åˆ°ä»“åº“åŒº 1git commit -m [æ”¹å˜ä¿¡æ¯] æŸ¥çœ‹ä¿¡æ¯ æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶ 1git status æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„ç‰ˆæœ¬å†å² 1git log æ ¹æ®å…³é”®è¯æœç´¢æäº¤å†å² 1git log -S [keyword] æ˜¾ç¤ºæš‚å­˜åŒºä¸å·¥ä½œåŒºçš„å·®å¼‚ 1git diff æ˜¾ç¤ºå·¥ä½œåŒºä¸å½“å‰åˆ†æ”¯æœ€æ–°çš„commitä¹‹é—´çš„å·®å¼‚ git diff HEAD(å½“å‰æœ€æ–°commit) ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ 1git push [remote] [branch] è¿œç¨‹åŒæ­¥ ä¸‹è½½è¿œç¨‹ä»“åº“çš„å˜åŠ¨ 1git fetch [remoteè¿œç¨‹ä»“åº“å] [åˆ†æ”¯]:[æœ¬åœ°æ–°åˆ†æ”¯] æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“ 1git remote -v æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯ 1git remote show [branch] å¢åŠ ä¸€ä¸ªè¿œç¨‹ä»“åº“å¹¶å‘½å git remote add [shortname=remote] [url] ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ 1git push [remote] [branch] å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª git push [remote] --force æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ git push [remote] -all æ’¤é”€ æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº 1git checkout [file] æ¢å¤æŸä¸ªcommitçš„æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒºä¸å·¥ä½œåŒº 1git checkout [commit] [file] æ¢å¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº 1git checkout . é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´ git reset --hard é‡ç½®å½“å‰åˆ†æ”¯çš„HEADï¼ˆæŒ‡é’ˆï¼ŒæŒ‡å‘commit-idï¼‰ä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œä¸æŒ‡å®šcommitä¸€è‡´ git reset --hard [commit] åè€…çš„æ‰€æœ‰å˜åŒ–éƒ½å°†è¢«å‰è€…æŠµæ¶ˆï¼Œå¹¶åº”ç”¨å½“å‰åˆ†æ”¯ git revert [commit] æš‚æ—¶å°†æœªæäº¤çš„å˜åŒ–ç§»é™¤ï¼Œç¨åå†ç§»å…¥ git stash git stash pop Gitå¤šäººåä½œå¤šäººåä½œå°±ä¼šæ¶‰åŠåˆ°åˆ†æ”¯çš„æ¦‚å¿µï¼ˆå…¶å®å•äººå¼€å‘ä¹Ÿä¼šé‡åˆ°ï¼Œåªæ˜¯å¤šäººä¼šæ›´å¸¸è§ï¼‰ æˆ‘ä»¬å…ˆçœ‹çœ‹ä¸‹é¢çš„å›¾ï¼š è¿™å¼ å›¾å¯ä»¥å¾ˆæ¸…æ¥šè®©æˆ‘ä»¬è®¤è¯†åˆ°åœ¨å·¥ä½œä¸­ä½¿ç”¨gitå·¥ä½œæµçš„å¼€å‘æµç¨‹ã€‚Masteråˆ†æ”¯æ˜¯çº¿ä¸Šåˆ†æ”¯ï¼Œæˆ‘ä»¬åœ¨å¼€å‘æ–°åŠŸèƒ½çš„æ—¶å€™ä¸ä¼šå»åŠ¨å®ƒï¼ŒHotfixåˆ†æ”¯æ˜¯å¦‚æœå‡ºäº†bugå°±æ‹‰ä¸€æ¡bugåˆ†æ”¯å¿«é€Ÿä¿®å¤åˆå¹¶åˆ°masteråˆ†æ”¯é‡Œã€‚æˆ‘ä»¬å¹³æ—¶å¼€å‘éƒ½æ˜¯å…ˆä»Masteråˆ†æ”¯æ‹‰å‡ºä¸€æ¡Developåˆ†æ”¯ï¼Œåœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šè¿›è¡Œå¼€å‘ã€‚æ¯ä¸ªäººä¸€èˆ¬éƒ½ä¼šè´Ÿè´£é¡¹ç›®çš„ä¸€ä¸ªç‰¹æ€§åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆä¼šä»Developåˆ†æ”¯æ‹‰å‡ºå‡ ä¸ªFeatureåˆ†æ”¯ã€‚åœ¨å¼€å‘æµ‹è¯•å®Œæˆåæˆ‘ä»¬å½¢æˆReleaseåˆ†æ”¯ï¼Œå†æ¬¡æ£€éªŒåå°†å®ƒä¸Masteråˆ†æ”¯åˆå¹¶ï¼Œç„¶åæˆ‘ä»¬ä¹‹åReleaseåˆ†æ”¯æ‹‰å‡ºDevelopåˆ†æ”¯è¿›è¡Œæ–°ä¸€è½®çš„å¼€å‘ã€‚ Gitåˆ†æ”¯ åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯ 1git branch åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯ 1git branch -r åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯ 1git branch -a æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯ 1git branch [branch-name] æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯ 1git checkout -b [branch] åˆ‡æ¢åˆ°å½“å‰æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æŒ‡å®šå·¥ä½œåŒº 1git checkout [branch-name] åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯ 1git checkout - å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œåœ¨ç°æœ‰åˆ†æ”¯ä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´ 1git branch --set-upstream [branch] [remote-branch] åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ 1git merge [branch] åˆ é™¤è¿œç¨‹åˆ†æ”¯ 1git branch -d [branch-name] åä½œå†²çªåœ¨å¤šäººåä½œçš„è¿‡ç¨‹ä¸­è‚¯å®šä¼šç¢°åˆ°è¿™æ ·çš„é—®é¢˜ï¼šå¦‚æœä½ çš„å°ä¼™ä¼´å·²ç»å‘ä¸€ä¸ªåˆ†æ”¯æ¨é€äº†ä»–çš„æäº¤ï¼Œè€Œç¢°å·§ä½ ä¹Ÿå¯¹åŒä¸ªåˆ†æ”¯çš„åŒæ ·çš„æ–‡ä»¶ä½œäº†ä¿®æ”¹ï¼Œå¹¶è¯•å›¾æ¨é€ï¼Œé‚£ä¹ˆå°±ä¼šæäº¤è¢«æ‹’ç»ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å…ˆï¼š1git pull ç­‰ä»·äºï¼š12git fetch temp(ä¸´æ—¶åˆ†æ”¯)git merge temp è¿™ä¸ªæ—¶å€™åˆgitä¼šå°†ä½ ä»¬ä¸¤ä¸ªäººå¯¹æ–‡ä»¶çš„ä¿®æ”¹éƒ½å‘ˆç°åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä½ éœ€è¦åœ¨ä¸ä½ çš„å°ä¼™ä¼´å•†é‡å‡ºä¸€ä¸ªæœ€ç»ˆç‰ˆï¼Œä¿®æ”¹ä¹‹åå†æäº¤ä¸Šå»ã€‚ IDEAä¸Gitå¯èƒ½å¤§å®¶å¯¹ä½¿ç”¨å‘½ä»¤è¡Œå¹¶ä¸æ„Ÿå†’ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿä¸ºå¤§å®¶æ‰¾äº†ä¸€ä»½IDEAçš„gitä½¿ç”¨æ•™ç¨‹ï¼Œè‡³æ­¤å¤§å®¶åªè¦ç‚¹ç‚¹ç‚¹å°±å¥½äº†ã€‚å½“ç„¶è¿™é‡Œè¿˜ä¼šæœ‰å¾ˆå¤šæˆ‘æ²¡æœ‰æ¶‰åŠåˆ°çš„åœ°æ–¹ï¼Œå°±éœ€è¦å¹³æ—¶å¤šç§¯ç´¯äº†ã€‚ åˆ«æ€¥ï¼Œåˆ«æ€¥ï¼ï¼è¿˜è¦æœ€åä¸€ç‚¹å°±æ˜¯ .gitignore äº†ï¼ æˆ‘ä»¬å‘ç°åœ¨ä½¿ç”¨IDEAçš„æ—¶å€™ï¼Œä»–é»˜è®¤ä¼šè¦æ±‚æˆ‘ä»¬æŠŠæ‰€æœ‰çš„æ–‡ä»¶åŠ å…¥åˆ°gitæ§åˆ¶é‡Œï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å¾ˆå¤šIDEAçš„è‡ªå¸¦é…ç½®æ–‡ä»¶æ˜¯ä¸ç”¨ä¹Ÿæ²¡æœ‰å¿…è¦åŠ å…¥gitï¼ˆä¹‹å‰åœ¨è¯´git add . çš„æ—¶å€™ä¹Ÿè¯´è¿‡ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨IDEAçš„.gitignoreæ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬å¿½ç•¥è¿™äº›æ²¡æœ‰å¿…è¦çš„æ’ä»¶ï¼Œè¿™é‡Œä¹Ÿæ”¾ä¸€ä¸ª.gitignoreæ•™ç¨‹ã€‚ å‚è€ƒ å»–é›ªå³°çš„gitæ•™ç¨‹ è¯¦è§£git fetchä¸git pullçš„åŒºåˆ« ç‰ˆæœ¬æ§åˆ¶ä¹‹IDEAä½¿ç”¨Git å¦‚ä½•åœ¨IntelliJ IDEAä¸­ä½¿ç”¨.ignoreæ’ä»¶å¿½ç•¥ä¸å¿…è¦æäº¤çš„æ–‡ä»¶]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>IDEA</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„Java ç½‘ç»œIO]]></title>
    <url>%2F2018%2F05%2F21%2FJava%E5%9F%BA%E7%A1%80%2F%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84Java-%E7%BD%91%E7%BB%9CIO%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¯èƒ½å¾ˆå¤šåŒå­¦ä¸€çœ‹Java Java ç½‘ç»œIOï¼Œå¿ƒé‡Œè‚¯å®šä¼šè§‰å¾—è¿™ä¸ªæœ‰ä»€ä¹ˆå¥½è®²çš„ï¼Œä¸å°±æ˜¯Socketå—ï¼Œè¯´å¯¹ä¹Ÿå¯¹ï¼Œå› ä¸ºä»–è®²åˆ°äº†BIO(åŒæ­¥é˜»å¡IO)ï¼Œä½†æ˜¯å´ä¸çŸ¥è¿˜æœ‰NIO(åŒæ­¥éé˜»å¡IO)ï¼ŒAIO(å¼‚æ­¥éé˜»å¡IO)ï¼ é¡¹ç›®æºç å…³äºBIOã€NIOä»¥åŠAIOçš„ä»£ç éƒ½æ”¾åœ¨githubä¸Šäº†ï¼Œæ³¨é‡Šåº”è¯¥å¾ˆè¯¦ç»†äº†ï¼Œå¤§å®¶æœ‰éœ€è¦çš„å¯ä»¥çœ‹ä¸€ä¸‹ï¼šä½ ä¸çŸ¥é“çš„é‚£äº›Javaç½‘ç»œIOï¼ˆBIOã€NIOã€AIOï¼‰ åŒæ­¥orå¼‚æ­¥ é˜»å¡oréé˜»å¡åœ¨è°ˆåˆ°IOçš„æ—¶å€™ï¼Œé¿å…ä¸äº†å¬åˆ°åŒæ­¥ã€å¼‚æ­¥ã€é˜»å¡ã€éé˜»å¡è¿™å‡ ä¸ªåè¯æˆ–è€…æ˜¯ä»–ä»¬çš„ç»„åˆè¯ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæ„Ÿåˆ°è¿·æƒ‘ä¸è§£ã€‚ åŒæ­¥orå¼‚æ­¥åŒæ­¥å’Œå¼‚æ­¥æ˜¯ç›¸å¯¹äºIOäº‹ä»¶(è¯»å†™æ“ä½œ)è€Œè¨€çš„ åŒæ­¥ï¼šåœ¨è¿›è¡ŒIOæ“ä½œæ—¶ï¼Œç¨‹åºä¸èƒ½å¹²åˆ«çš„äº‹æƒ…ï¼Œç­‰ç€IOäº‹ä»¶å®Œæˆä¹‹åæ‰èƒ½å»åšåˆ«çš„äº‹æƒ… å¼‚æ­¥ï¼šä¸å…³å¿ƒIOå¤„ç†æ“ä½œ(å› ä¸ºæŠŠIOæ“ä½œäº¤ç»™æ“ä½œç³»ç»Ÿå¹²äº†)ï¼Œåœ¨å¤„ç†IOçš„æ—¶å€™ï¼Œå¯ä»¥å»åšåˆ«çš„äº‹æƒ…ï¼Œç„¶åç­‰å¾…IOäº‹ä»¶å¤„ç†å®Œæˆçš„é€šçŸ¥ é˜»å¡oréé˜»å¡é˜»å¡å’Œéé˜»å¡æ˜¯ç›¸å¯¹äºæ•°æ®è€Œè¨€çš„ é˜»å¡ï¼šå¦‚æœæ•°æ®æ²¡æœ‰å‡†å¤‡å¥½ï¼Œç¨‹åºå°±ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å¥½äº†æ‰å¾€ä¸‹æ‰§è¡Œ éé˜»å¡ï¼šä¸ç®¡æ•°æ®æœ‰æ²¡æœ‰å‡†å¤‡å¥½ï¼Œç¨‹åºéƒ½å¾€ä¸‹è¿›è¡Œ è¿™é‡Œæ˜¯è‡ªå·±çœ‹åˆ°çš„ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥ç»“åˆèµ·æ¥ç†è§£ï¼š å¦‚æœä½ æƒ³åƒä¸€ä»½å®«ä¿é¸¡ä¸ç›–é¥­ï¼š åŒæ­¥é˜»å¡ï¼šä½ åˆ°é¥­é¦†ç‚¹é¤ï¼Œç„¶ååœ¨é‚£ç­‰ç€ï¼Œè¿˜è¦ä¸€è¾¹å–Šï¼šå¥½äº†æ²¡å•Šï¼ï¼ˆIOæ“ä½œ[æ‹¿é¥­]æ²¡æœ‰å¹²å¥½ï¼Œé¢„æƒ³ä¹‹å¤–çš„äº‹éƒ½ä¸èƒ½å¹²ï¼Œæ•°æ®[é¥­]æ²¡æœ‰å¥½ï¼Œå°±ä¸€ç›´ç­‰ç€ï¼‰ åŒæ­¥éé˜»å¡ï¼šåœ¨é¥­é¦†ç‚¹å®Œé¤ï¼Œå°±å»é›ç‹—äº†ã€‚ä¸è¿‡æºœä¸€ä¼šå„¿ï¼Œå°±å›é¥­é¦†å–Šä¸€å£°ï¼šå¥½äº†æ²¡å•Šï¼ï¼ˆIOæ“ä½œ[æ‹¿é¥­]æ²¡æœ‰å¹²å¥½ï¼Œé¢„æƒ³ä¹‹å¤–çš„äº‹éƒ½ä¸èƒ½å¹²ï¼Œæ•°æ®[é¥­]æ²¡æœ‰å¥½ï¼Œä½†æ˜¯ä¸ç”¨ä¸€ç›´ç­‰ç€ï¼Œå¯ä»¥ç»§ç»­å¹²é¢„å…ˆå®‰æ’çš„äº‹[é›ç‹—]ï¼Œä½†æ˜¯éœ€è¦æ—¶ä¸æ—¶å»é—®ä¸€ä¸‹é¥­æœ‰æ²¡æœ‰å¥½ï¼‰ å¼‚æ­¥é˜»å¡ï¼šé›ç‹—çš„æ—¶å€™ï¼Œæ¥åˆ°é¥­é¦†ç”µè¯ï¼Œè¯´é¥­åšå¥½äº†ï¼Œè®©æ‚¨äº²è‡ªå»æ‹¿ã€‚ï¼ˆIOæ“ä½œ[æ‹¿é¥­]æ²¡æœ‰å¹²å¥½ï¼Œä½†æ˜¯æˆ‘æƒ³å¹²å•¥å°±å¹²å•¥ï¼Œç­‰ç€é€šçŸ¥å°±å¥½ï¼Œæ•°æ®[é¥­]æ²¡æœ‰å¥½ï¼Œå°±ä¸€ç›´ç­‰ç€å»æ‹¿é¥­ï¼‰ å¼‚æ­¥éé˜»å¡ï¼šé¥­é¦†æ‰“ç”µè¯è¯´ï¼Œæˆ‘ä»¬çŸ¥é“æ‚¨çš„ä½ç½®ï¼Œä¸€ä¼šç»™ä½ é€è¿‡æ¥ï¼Œå®‰å¿ƒé›ç‹—å°±å¯ä»¥äº†ã€‚ï¼ˆIOæ“ä½œ[æ‹¿é¥­]æ²¡æœ‰å¹²å¥½ï¼Œä½†æ˜¯æˆ‘æƒ³å¹²å•¥å°±å¹²å•¥ï¼Œç­‰ç€é€šçŸ¥å°±å¥½ï¼Œæ•°æ®[é¥­]æ²¡æœ‰å¥½ï¼Œä½†æ˜¯ä¸ç”¨ä¸€ç›´ç­‰ç€ï¼Œå¯ä»¥ç»§ç»­å¹²é¢„å…ˆå®‰æ’çš„äº‹ï¼‰ I/Oæ¨¡å‹Unixå®šä¹‰äº†äº”ç§I/Oæ¨¡å‹ï¼Œå¦‚ä¸‹ï¼š é˜»å¡I/O éé˜»å¡I/O I/Oå¤ç”¨ï¼ˆselectã€pollã€linux 2.6ç§æ”¹è¿›çš„epollï¼‰ ä¿¡å·é©±åŠ¨IOï¼ˆSIGIOï¼‰ å¼‚æ­¥I/Oï¼ˆPOSIXçš„aio_ç³»åˆ—å‡½æ•°ï¼‰ ä¸‹å›¾æ˜¯äº”ç§I/Oæ¨¡å‹çš„æ¯”è¾ƒï¼š POSIXæŠŠI/Oæ“ä½œåˆ’åˆ†æˆä¸¤ç±»ï¼š åŒæ­¥I/O: åŒæ­¥I/Oæ“ä½œå¯¼è‡´è¯·æ±‚é˜»å¡ï¼Œç›´è‡³æ“ä½œå®Œæˆ å¼‚æ­¥I/O: å¼‚æ­¥I/Oæ“ä½œä¸å¯¼è‡´è¯·æ±‚é˜»å¡ ä»ä¸Šé¢çš„å›¾ä¸­å¯ä»¥çœ‹å‡ºUnixçš„å‰å››ç§I/Oæ¨¡å‹éƒ½æ˜¯åŒæ­¥I/O, åªæœ‰æœ€åä¸€ç§æ‰æ˜¯å¼‚æ­¥I/Oã€‚ æˆ‘ä»¬åœ¨çœ‹çœ‹Javaä¸­çš„IOåˆ†ç±»ï¼š ä¼ ç»Ÿçš„Java BIO (blocking I/O)æ˜¯Unix I/Oæ¨¡å‹ä¸­çš„ç¬¬ä¸€ç§ã€‚ Java NIOä¸­å¦‚æœä¸ä½¿ç”¨selectæ¨¡å¼ï¼Œè€ŒåªæŠŠchannelé…ç½®æˆnonblockingåˆ™æ˜¯ç¬¬äºŒç§æ¨¡å‹ã€‚ Java NIO selectå®ç°çš„æ˜¯ä¸€ç§å¤šè·¯å¤ç”¨I/Oã€‚åº•å±‚ä½¿ç”¨epollæˆ–è€…ç›¸åº”çš„pollç³»ç»Ÿè°ƒç”¨ã€‚ ç¬¬å››ç§æ¨¡å‹JDKåº”è¯¥æ˜¯æ²¡æœ‰å®ç°ã€‚ Java NIO2å¢åŠ äº†å¯¹ç¬¬äº”ç§æ¨¡å‹çš„æ”¯æŒï¼Œä¹Ÿå°±æ˜¯AIOã€‚ BIOç½‘ç»œç¼–ç¨‹ä¼ ç»Ÿçš„åŒæ­¥é˜»å¡æ¨¡å‹(BIO)å¼€å‘ä¸­ï¼ŒServerSocketè´Ÿè´£ç»‘å®šIPåœ°å€ï¼Œå¯åŠ¨ç›‘å¬ç«¯å£ï¼›Socketè´Ÿè´£å‘èµ·è¿æ¥æ“ä½œã€‚è¿æ¥æˆåŠŸåï¼ŒåŒæ–¹é€šè¿‡è¾“å…¥å’Œè¾“å‡ºæµè¿›è¡ŒåŒæ­¥é˜»å¡å¼é€šä¿¡ã€‚ ç®€å•çš„æè¿°ä¸€ä¸‹BIOçš„æœåŠ¡ç«¯é€šä¿¡æ¨¡å‹ï¼šé‡‡ç”¨BIOé€šä¿¡æ¨¡å‹çš„æœåŠ¡ç«¯ï¼Œé€šå¸¸ç”±ä¸€ä¸ªç‹¬ç«‹çš„Acceptorçº¿ç¨‹è´Ÿè´£ç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå®ƒæ¥æ”¶åˆ°å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ä¹‹åä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹è¿›è¡Œé“¾è·¯å¤„ç†æ²¡å¤„ç†å®Œæˆåï¼Œé€šè¿‡è¾“å‡ºæµè¿”å›åº”ç­”ç»™å®¢æˆ·ç«¯ï¼Œçº¿ç¨‹é”€æ¯ã€‚å³å…¸å‹çš„ä¸€è¯·æ±‚ä¸€åº”ç­”é€šä¿¡æ¨¡å‹ã€‚å¦‚ä¸‹å›¾ï¼š è¯¥æ¨¡å‹æœ€å¤§çš„é—®é¢˜å°±æ˜¯ç¼ºä¹å¼¹æ€§ä¼¸ç¼©èƒ½åŠ›ï¼Œå½“å®¢æˆ·ç«¯å¹¶å‘è®¿é—®é‡å¢åŠ åï¼ŒæœåŠ¡ç«¯çš„çº¿ç¨‹ä¸ªæ•°å’Œå®¢æˆ·ç«¯å¹¶å‘è®¿é—®æ•°å‘ˆ1:1çš„æ­£æ¯”å…³ç³»ï¼ŒJavaä¸­çš„çº¿ç¨‹ä¹Ÿæ˜¯æ¯”è¾ƒå®è´µçš„ç³»ç»Ÿèµ„æºï¼Œçº¿ç¨‹æ•°é‡å¿«é€Ÿè†¨èƒ€åï¼Œç³»ç»Ÿçš„æ€§èƒ½å°†æ€¥å‰§ä¸‹é™ï¼Œéšç€è®¿é—®é‡çš„ç»§ç»­å¢å¤§ï¼Œç³»ç»Ÿæœ€ç»ˆå°±æ­»æ‰äº†ã€‚ ä¸ºäº†æ”¹è¿›è¿™ç§ä¸€è¿æ¥ä¸€çº¿ç¨‹çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ± æ¥ç®¡ç†è¿™äº›çº¿ç¨‹ï¼ˆéœ€è¦äº†è§£æ›´å¤šè¯·å‚è€ƒå‰é¢æä¾›çš„æ–‡ç« ï¼‰ï¼Œå®ç°1ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹å¤„ç†Nä¸ªå®¢æˆ·ç«¯çš„æ¨¡å‹ï¼ˆä½†æ˜¯åº•å±‚è¿˜æ˜¯ä½¿ç”¨çš„åŒæ­¥é˜»å¡I/Oï¼‰ï¼Œé€šå¸¸è¢«ç§°ä¸ºâ€œä¼ªå¼‚æ­¥I/Oæ¨¡å‹â€œã€‚ä¼ªå¼‚æ­¥I/Oæ¨¡å‹å›¾å¦‚ä¸‹ï¼š æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä½¿ç”¨CachedThreadPoolçº¿ç¨‹æ± ï¼Œå…¶å®é™¤äº†èƒ½è‡ªåŠ¨å¸®æˆ‘ä»¬ç®¡ç†çº¿ç¨‹ï¼ˆå¤ç”¨ï¼‰ï¼Œçœ‹èµ·æ¥ä¹Ÿå°±åƒæ˜¯1:1çš„å®¢æˆ·ç«¯ï¼šçº¿ç¨‹æ•°æ¨¡å‹ï¼Œè€Œä½¿ç”¨FixedThreadPoolæˆ‘ä»¬å°±æœ‰æ•ˆçš„æ§åˆ¶äº†çº¿ç¨‹çš„æœ€å¤§æ•°é‡ï¼Œä¿è¯äº†ç³»ç»Ÿæœ‰é™çš„èµ„æºçš„æ§åˆ¶ï¼Œå®ç°äº†N:Mçš„ä¼ªå¼‚æ­¥I/Oæ¨¡å‹ã€‚ä½†æ˜¯ï¼Œæ­£å› ä¸ºé™åˆ¶äº†çº¿ç¨‹æ•°é‡ï¼Œå¦‚æœå‘ç”Ÿå¤§é‡å¹¶å‘è¯·æ±‚ï¼Œè¶…è¿‡æœ€å¤§æ•°é‡çš„çº¿ç¨‹å°±åªèƒ½ç­‰å¾…ï¼Œç›´åˆ°çº¿ç¨‹æ± ä¸­çš„æœ‰ç©ºé—²çš„çº¿ç¨‹å¯ä»¥è¢«å¤ç”¨ã€‚è€Œå¯¹Socketçš„è¾“å…¥æµå°±è¡Œè¯»å–æ—¶ï¼Œä¼šä¸€ç›´é˜»å¡ã€‚ æ‰€ä»¥åœ¨è¯»å–æ•°æ®è¾ƒæ…¢æ—¶ï¼ˆæ¯”å¦‚æ•°æ®é‡å¤§ã€ç½‘ç»œä¼ è¾“æ…¢ç­‰ï¼‰ï¼Œå¤§é‡å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå…¶ä»–æ¥å…¥çš„æ¶ˆæ¯ï¼Œåªèƒ½ä¸€ç›´ç­‰å¾…ï¼Œè¿™å°±æ˜¯æœ€å¤§çš„å¼Šç«¯ã€‚ PSï¼š æºç éƒ½åœ¨githubä¸Šã€‚ NIOç½‘ç»œç¼–ç¨‹NIO(åŒæ­¥éé˜»å¡IO)æä¾›äº†ä¸ä¼ ç»ŸBIOæ¨¡å‹ä¸­çš„Socketå’ŒServerSocketç›¸å¯¹åº”çš„SocketChannelå’ŒServerSocketChannelä¸¤ç§ä¸åŒçš„å¥—æ¥å­—é€šé“å®ç°ã€‚æ–°å¢çš„ç€ä¸¤ç§é€šé“éƒ½æ”¯æŒé˜»å¡å’Œéé˜»å¡ä¸¤ç§æ¨¡å¼ã€‚é˜»å¡æ¨¡å¼ä½¿ç”¨å°±åƒä¼ ç»Ÿä¸­çš„æ”¯æŒä¸€æ ·ï¼Œæ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯æ€§èƒ½å’Œå¯é æ€§éƒ½ä¸å¥½ï¼›éé˜»å¡æ¨¡å¼æ­£å¥½ä¸ä¹‹ç›¸åã€‚å¯¹äºä½è´Ÿè½½ã€ä½å¹¶å‘çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥é˜»å¡I/Oæ¥æå‡å¼€å‘é€Ÿç‡å’Œæ›´å¥½çš„ç»´æŠ¤æ€§ï¼›å¯¹äºé«˜è´Ÿè½½ã€é«˜å¹¶å‘çš„ï¼ˆç½‘ç»œï¼‰åº”ç”¨ï¼Œåº”ä½¿ç”¨NIOçš„éé˜»å¡æ¨¡å¼æ¥å¼€å‘ã€‚ åœ¨ç”¨NIOè¿›è¡Œå¼€å‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹NIOçš„å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š ç¼“å†²åŒº BufferBufferæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸€äº›è¦å†™å…¥æˆ–è€…è¯»å‡ºçš„æ•°æ®ã€‚åœ¨NIOåº“ä¸­ï¼Œæ‰€æœ‰æ•°æ®éƒ½æ˜¯ç”¨ç¼“å†²åŒºå¤„ç†çš„ã€‚åœ¨è¯»å–æ•°æ®æ—¶ï¼Œå®ƒæ˜¯ç›´æ¥è¯»åˆ°ç¼“å†²åŒºä¸­çš„ï¼›åœ¨å†™å…¥æ•°æ®æ—¶ï¼Œä¹Ÿæ˜¯å†™å…¥åˆ°ç¼“å†²åŒºä¸­ã€‚ä»»ä½•æ—¶å€™è®¿é—®NIOä¸­çš„æ•°æ®ï¼Œéƒ½æ˜¯é€šè¿‡ç¼“å†²åŒºè¿›è¡Œæ“ä½œã€‚ ç¼“å†²åŒºå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¹¶æä¾›äº†å¯¹æ•°æ®ç»“æ„åŒ–è®¿é—®ä»¥åŠç»´æŠ¤è¯»å†™ä½ç½®ç­‰ä¿¡æ¯ã€‚å…·ä½“çš„ç¼“å­˜åŒºæœ‰è¿™äº›ï¼šByteBuffeã€CharBufferã€ ShortBufferã€IntBufferã€LongBufferã€FloatBufferã€DoubleBufferã€‚ä»–ä»¬å®ç°äº†ç›¸åŒçš„æ¥å£ï¼šBufferã€‚ é€šé“ Channelæˆ‘ä»¬å¯¹æ•°æ®çš„è¯»å–å’Œå†™å…¥è¦é€šè¿‡Channelï¼Œå®ƒå°±åƒæ°´ç®¡ä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªé€šé“ã€‚é€šé“ä¸åŒäºæµçš„åœ°æ–¹å°±æ˜¯é€šé“æ˜¯åŒå‘çš„ï¼Œå¯ä»¥ç”¨äºè¯»ã€å†™å’ŒåŒæ—¶è¯»å†™æ“ä½œã€‚åº•å±‚çš„æ“ä½œç³»ç»Ÿçš„é€šé“ä¸€èˆ¬éƒ½æ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥å…¨åŒå·¥çš„Channelæ¯”æµèƒ½æ›´å¥½çš„æ˜ å°„åº•å±‚æ“ä½œç³»ç»Ÿçš„APIã€‚ Channelä¸»è¦åˆ†ä¸¤å¤§ç±»ï¼š SelectableChannelï¼šç”¨æˆ·ç½‘ç»œè¯»å†™ FileChannelï¼šç”¨äºæ–‡ä»¶æ“ä½œ ç½‘ç»œç¼–ç¨‹ä¸­æ¶‰åŠçš„ServerSocketChannelå’ŒSocketChanneléƒ½æ˜¯SelectableChannelçš„å­ç±»ã€‚ å¤šè·¯å¤ç”¨å™¨ SelectorSelectoræä¾›é€‰æ‹©å·²ç»å°±ç»ªçš„ä»»åŠ¡çš„èƒ½åŠ›ï¼šSelectorä¼šä¸æ–­è½®è¯¢æ³¨å†Œåœ¨å…¶ä¸Šçš„Channelï¼Œå¦‚æœæŸä¸ªChannelä¸Šé¢å‘ç”Ÿè¯»æˆ–è€…å†™äº‹ä»¶ï¼Œè¿™ä¸ªChannelå°±å¤„äºå°±ç»ªçŠ¶æ€ï¼Œä¼šè¢«Selectorè½®è¯¢å‡ºæ¥ï¼Œç„¶åé€šè¿‡SelectionKeyå¯ä»¥è·å–å°±ç»ªChannelçš„é›†åˆï¼Œè¿›è¡Œåç»­çš„I/Oæ“ä½œã€‚ ä¸€ä¸ªSelectorå¯ä»¥åŒæ—¶è½®è¯¢å¤šä¸ªChannel(æ‰€ä»¥æ˜¯éé˜»å¡çš„)ï¼Œå› ä¸ºJDKä½¿ç”¨äº†epoll()ä»£æ›¿ä¼ ç»Ÿçš„selectå®ç°ï¼Œæ‰€ä»¥æ²¡æœ‰æœ€å¤§è¿æ¥å¥æŸ„1024/2048çš„é™åˆ¶ã€‚æ‰€ä»¥ï¼Œåªéœ€è¦ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£Selectorçš„è½®è¯¢ï¼Œå°±å¯ä»¥æ¥å…¥æˆåƒä¸Šä¸‡çš„å®¢æˆ·ç«¯ã€‚ åˆ›å»ºNIOæœåŠ¡ç«¯çš„é€šä¿¡æµç¨‹æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹é¢è¿™ç§é€šä¿¡åºåˆ—å›¾ï¼š PSï¼š æºç éƒ½åœ¨githubä¸Šã€‚ AIOç½‘ç»œç¼–ç¨‹å¼‚æ­¥çš„å¥—æ¥å­—é€šé“æ˜¯çœŸæ­£çš„å¼‚æ­¥éé˜»å¡I/Oï¼Œå¯¹åº”äºUNIXç½‘ç»œç¼–ç¨‹ä¸­çš„äº‹ä»¶é©±åŠ¨I/Oï¼ˆAIOï¼‰ã€‚ä»–ä¸éœ€è¦è¿‡å¤šçš„Selectorå¯¹æ³¨å†Œçš„é€šé“è¿›è¡Œè½®è¯¢å³å¯å®ç°å¼‚æ­¥è¯»å†™ï¼Œä»è€Œç®€åŒ–äº†NIOçš„ç¼–ç¨‹æ¨¡å‹ã€‚ AIO(å¼‚æ­¥éé˜»å¡IO)æä¾›äº†ä¸ä¼ ç»ŸBIOæ¨¡å‹ä¸­çš„Socketå’ŒServerSocketç›¸å¯¹åº”çš„AsynchronousSocketChannelå’ŒAsynchronousServerSocketChannelä¸¤ç§ä¸åŒçš„å¥—æ¥å­—é€šé“å®ç°ã€‚ å¼‚æ­¥çš„å¤„ç†å¼‚æ­¥æ— éæ˜¯é€šçŸ¥ç³»ç»Ÿåšä¸€ä»¶äº‹æƒ…ã€‚ç„¶åå¿˜æ‰å®ƒï¼Œè‡ªå·±åšå…¶ä»–äº‹æƒ…å»äº†ã€‚å¾ˆå¤šæ—¶å€™ç³»ç»Ÿåšå®ŒæŸä¸€ä»¶äº‹æƒ…åéœ€è¦ä¸€äº›åç»­çš„æ“ä½œã€‚æ€ä¹ˆåŠï¼Ÿè¿™æ—¶å€™å°±æ˜¯å‘Šè¯‰å¼‚æ­¥è°ƒç”¨å¦‚ä½•åšåç»­å¤„ç†ã€‚é€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼š å°†æ¥å¼: å½“ä½ å¸Œæœ›ä¸»çº¿ç¨‹å‘èµ·å¼‚æ­¥è°ƒç”¨ï¼Œå¹¶è½®è¯¢ç­‰å¾…ç»“æœçš„æ—¶å€™ä½¿ç”¨å°†æ¥å¼; å›è°ƒå¼: å¸¸è¯´çš„å¼‚æ­¥å›è°ƒå°±æ˜¯å®ƒã€‚ PSï¼š AIOçš„ä»£ç ä¸»è¦åŸºäºå›è°ƒå¼ï¼Œæºç éƒ½åœ¨githubä¸Šã€‚ BIOã€NIOã€AIOé€‚ç”¨åœºæ™¯åˆ†æ: BIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®æ¯”è¾ƒå°ä¸”å›ºå®šçš„æ¶æ„ï¼Œè¿™ç§æ–¹å¼å¯¹æœåŠ¡å™¨èµ„æºè¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼ŒJDK1.4ä»¥å‰çš„å”¯ä¸€é€‰æ‹©ï¼Œä½†ç¨‹åºç›´è§‚ç®€å•æ˜“ç†è§£ã€‚ NIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒçŸ­ï¼ˆè½»æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚èŠå¤©æœåŠ¡å™¨ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼ŒJDK1.4å¼€å§‹æ”¯æŒã€‚ AIOæ–¹å¼ä½¿ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒé•¿ï¼ˆé‡æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚ç›¸å†ŒæœåŠ¡å™¨ï¼Œå……åˆ†è°ƒç”¨OSå‚ä¸å¹¶å‘æ“ä½œï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼ŒJDK7å¼€å§‹æ”¯æŒã€‚ å‚è€ƒ Javaä¸­BIO,NIO,AIOçš„ç†è§£ Linux selectå’Œpollç³»ç»Ÿè°ƒç”¨ java aio ç¼–ç¨‹ Java ç½‘ç»œIOç¼–ç¨‹æ€»ç»“ï¼ˆBIOã€NIOã€AIOå‡å«å®Œæ•´å®ä¾‹ä»£ç ï¼‰ Javaä¹‹IO,BIO,NIO,AIOçŸ¥å¤šå°‘ï¼Ÿ ServerSocketChannelçš„ç”¨æ³•è¯¦è§£ (001)javaä¸­çš„AIO]]></content>
      <categories>
        <category>JavaåŸºç¡€</category>
      </categories>
      <tags>
        <tag>BIO</tag>
        <tag>NIO</tag>
        <tag>AIO</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HTTPåè®®]]></title>
    <url>%2F2018%2F05%2F20%2F%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%2FHTTP%E5%8D%8F%E8%AE%AE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä½œä¸ºWebå¼€å‘äººå‘˜ï¼Œå¯èƒ½ä½ æœ€éœ€è¦æ·±å…¥å­¦ä¹ çš„å°±æ˜¯HTTPåè®®äº†å§ï¼ HTTPè®¤è¯†HTTPåè®®æ˜¯Hyper Text TransferProtocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™,å®ƒæ˜¯ä¸€ä¸ªåŸºäºTCP/IPé€šä¿¡åè®®æ¥ä¼ é€’æ•°æ®ï¼ˆHTML æ–‡ä»¶, å›¾ç‰‡æ–‡ä»¶, æŸ¥è¯¢ç»“æœç­‰ï¼‰çš„åº”ç”¨å±‚åè®®ã€‚å®ƒå·¥ä½œäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯æ¶æ„ä¹‹ä¸Šã€‚æµè§ˆå™¨ä½œä¸ºHTTPå®¢æˆ·ç«¯é€šè¿‡URLå‘HTTPæœåŠ¡ç«¯å³WEBæœåŠ¡å™¨å‘é€æ‰€æœ‰è¯·æ±‚ã€‚WebæœåŠ¡å™¨æ ¹æ®æ¥æ”¶åˆ°çš„è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯å‘é€å“åº”ä¿¡æ¯ã€‚ HTTPç‰¹ç‚¹ ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰GETã€HEADã€POSTã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸æœåŠ¡å™¨è”ç³»çš„ç±»å‹ä¸åŒã€‚ç”±äºHTTPåè®®ç®€å•ï¼Œä½¿å¾—HTTPæœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚ çµæ´»ï¼šHTTPå…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”±Content-TypeåŠ ä»¥æ ‡è®°ã€‚ HTTP 0.9å’Œ1.0ä½¿ç”¨éæŒç»­è¿æ¥ï¼šé™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚HTTP 1.1ä½¿ç”¨æŒç»­è¿æ¥ï¼šä¸å¿…ä¸ºæ¯ä¸ªwebå¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œä¸€ä¸ªè¿æ¥å¯ä»¥ä¼ é€å¤šä¸ªå¯¹è±¡ï¼Œé‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚ æ— çŠ¶æ€ï¼šHTTPåè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚ PSï¼š HTTPåè®®æ˜¯æ— çŠ¶æ€çš„å’ŒConnection: keep-aliveçš„åŒºåˆ«ï¼š æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆçŠ¶æ€ã€‚ä»å¦ä¸€æ–¹é¢è®²ï¼Œæ‰“å¼€ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µå’Œä½ ä¹‹å‰æ‰“å¼€è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ã€‚HTTPæ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„é¢å‘è¿æ¥çš„åè®®ï¼Œæ— çŠ¶æ€ä¸ä»£è¡¨HTTPä¸èƒ½ä¿æŒTCPè¿æ¥ï¼Œæ›´ä¸èƒ½ä»£è¡¨HTTPä½¿ç”¨çš„æ˜¯UDPåè®®ï¼ˆæ— è¿æ¥ï¼‰ã€‚ ä»HTTP/1.1èµ·ï¼Œé»˜è®¤éƒ½å¼€å¯äº†Keep-Aliveï¼Œä¿æŒè¿æ¥ç‰¹æ€§ï¼Œç®€å•åœ°è¯´ï¼Œå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¸ä¼šå…³é—­ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ã€‚Keep-Aliveä¸ä¼šæ°¸ä¹…ä¿æŒè¿æ¥ï¼Œå®ƒæœ‰ä¸€ä¸ªä¿æŒæ—¶é—´ï¼Œå¯ä»¥åœ¨ä¸åŒçš„æœåŠ¡å™¨è½¯ä»¶ï¼ˆå¦‚Apacheï¼‰ä¸­è®¾å®šè¿™ä¸ªæ—¶é—´ã€‚ HTTPå·¥ä½œåŸç†HTTPåè®®å®šä¹‰Webå®¢æˆ·ç«¯å¦‚ä½•ä»WebæœåŠ¡å™¨è¯·æ±‚Webé¡µé¢ï¼Œä»¥åŠæœåŠ¡å™¨å¦‚ä½•æŠŠWebé¡µé¢ä¼ é€ç»™å®¢æˆ·ç«¯ã€‚HTTPåè®®é‡‡ç”¨äº†è¯·æ±‚/å“åº”æ¨¡å‹ã€‚å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡ï¼ŒæœåŠ¡å™¨å°†è¿”å›ä¸€ä¸ªå“åº”æŠ¥æ–‡ã€‚ ä»¥ä¸‹æ˜¯ HTTP è¯·æ±‚æ­¥éª¤ï¼š å®¢æˆ·ç«¯è¿æ¥åˆ°WebæœåŠ¡å™¨ï¼šä¸€ä¸ªHTTPå®¢æˆ·ç«¯ï¼Œé€šå¸¸æ˜¯æµè§ˆå™¨ï¼Œä¸WebæœåŠ¡å™¨çš„HTTPç«¯å£ï¼ˆé»˜è®¤ä¸º80ï¼‰å»ºç«‹ä¸€ä¸ªTCPå¥—æ¥å­—è¿æ¥ã€‚ä¾‹å¦‚ï¼šhttp://www.todorex.comã€‚ å‘é€HTTPè¯·æ±‚ï¼šé€šè¿‡TCPå¥—æ¥å­—ï¼Œå®¢æˆ·ç«¯å‘WebæœåŠ¡å™¨å‘é€ä¸€ä¸ªæ–‡æœ¬çš„è¯·æ±‚æŠ¥æ–‡ã€‚ æœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶è¿”å›HTTPå“åº”WebæœåŠ¡å™¨è§£æè¯·æ±‚ï¼Œå®šä½è¯·æ±‚èµ„æºã€‚æœåŠ¡å™¨å°†èµ„æºå¤æœ¬å†™åˆ°TCPå¥—æ¥å­—ï¼Œç”±å®¢æˆ·ç«¯è¯»å–ã€‚ é‡Šæ”¾è¿æ¥TCPè¿æ¥ï¼šè‹¥è¯·æ±‚æŠ¥æ–‡é¦–éƒ¨çš„connection æ¨¡å¼ä¸ºcloseï¼Œåˆ™æœåŠ¡å™¨ä¸»åŠ¨å…³é—­TCPè¿æ¥ï¼Œå®¢æˆ·ç«¯è¢«åŠ¨å…³é—­è¿æ¥ï¼Œé‡Šæ”¾TCPè¿æ¥;è‹¥connection æ¨¡å¼ä¸ºkeepaliveï¼Œåˆ™è¯¥è¿æ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ï¼Œåœ¨è¯¥æ—¶é—´å†…å¯ä»¥ç»§ç»­æ¥æ”¶è¯·æ±‚ã€‚ å®¢æˆ·ç«¯æµè§ˆå™¨è§£æHTMLå†…å®¹å®¢æˆ·ç«¯æµè§ˆå™¨é¦–å…ˆè§£æå“åº”æŠ¥æ–‡ï¼Œç„¶åå®¢æˆ·ç«¯æµè§ˆå™¨è¯»å–å“åº”æ•°æ®HTMLï¼Œæ ¹æ®HTMLçš„è¯­æ³•å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–ï¼Œå¹¶åœ¨æµè§ˆå™¨çª—å£ä¸­æ˜¾ç¤ºã€‚ HTTPæŠ¥æ–‡ä¹‹è¯·æ±‚æŠ¥æ–‡è¯·æ±‚æŠ¥æ–‡ç”±è¯·æ±‚è¡Œ(è¯·æ±‚æ–¹æ³•ã€URLã€åè®®ç‰ˆæœ¬)ã€è¯·æ±‚å¤´éƒ¨ã€ç©ºè¡Œ(å›è½¦+æ¢è¡Œ)å’Œè¯·æ±‚æ•°æ®(ä¸»ä½“)å››ä¸ªéƒ¨åˆ†ç»„æˆã€‚å¦‚ä¸‹å›¾ï¼š å®ƒçš„ä¾‹å­å¦‚ä¸‹ï¼š è¯·æ±‚æŠ¥æ–‡ä¹‹URLHTTPä½¿ç”¨ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifiers, URIï¼‰æ¥ä¼ è¾“æ•°æ®å’Œå»ºç«‹è¿æ¥ã€‚URIåŒ…å«äº†ç”¨äºæŸ¥æ‰¾æŸä¸ªèµ„æºçš„è¶³å¤Ÿçš„ä¿¡æ¯ã€‚ ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼ˆUniform Resource Locator, URLï¼‰æ˜¯äº’è”ç½‘ä¸Šç”¨æ¥æ ‡è¯†æŸä¸€å¤„èµ„æºçš„åœ°ç‚¹ï¼Œæ‰€ä»¥å¯è§URLæ˜¯URIçš„å­é›†ã€‚ä»¥ä¸‹é¢è¿™ä¸ªURLä¸ºä¾‹ï¼Œä»‹ç»ä¸‹æ™®é€šURLçš„å„éƒ¨åˆ†ç»„æˆï¼š http://www.aspxfans.com:8080/news/index.asp?boardID=5&amp;ID=24618&amp;page=1#name ä»ä¸Šé¢çš„URLå¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªå®Œæ•´çš„URLåŒ…æ‹¬ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š åè®®éƒ¨åˆ†ï¼šè¯¥URLçš„åè®®éƒ¨åˆ†ä¸ºâ€œhttp:â€ï¼Œè¿™ä»£è¡¨ç½‘é¡µä½¿ç”¨çš„æ˜¯HTTPåè®®ã€‚åœ¨Internetä¸­å¯ä»¥ä½¿ç”¨å¤šç§åè®®ï¼Œå¦‚HTTPï¼ŒFTPç­‰ç­‰æœ¬ä¾‹ä¸­ä½¿ç”¨çš„æ˜¯HTTPåè®®ã€‚åœ¨â€HTTPâ€åé¢çš„â€œ//â€ä¸ºåˆ†éš”ç¬¦ã€‚ åŸŸåéƒ¨åˆ†ï¼šè¯¥URLçš„åŸŸåéƒ¨åˆ†ä¸ºâ€œwww.aspxfans.comâ€ã€‚ä¸€ä¸ªURLä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨IPåœ°å€ä½œä¸ºåŸŸåä½¿ç”¨ã€‚åœ¨å»ºç«‹TCPè¿æ¥çš„æ—¶å€™ç”¨çš„å°±æ˜¯IPåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸŸåæ˜¯å› ä¸ºæœ‰äº†DNSåŸŸåè§£æã€‚ ç«¯å£éƒ¨åˆ†ï¼šè·Ÿåœ¨åŸŸååé¢çš„æ˜¯ç«¯å£ï¼ŒåŸŸåå’Œç«¯å£ä¹‹é—´ä½¿ç”¨â€œ:â€ä½œä¸ºåˆ†éš”ç¬¦ã€‚ç«¯å£ä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ï¼Œå¦‚æœçœç•¥ç«¯å£éƒ¨åˆ†ï¼Œå°†é‡‡ç”¨é»˜è®¤ç«¯å£ï¼ŒHTTPé»˜è®¤çš„ç«¯å£å·ä¸º80ï¼ŒHTTPSçš„ç«¯å£å·ä¸º443ã€‚ è™šæ‹Ÿç›®å½•éƒ¨åˆ†ï¼šä»åŸŸååçš„ç¬¬ä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°æœ€åä¸€ä¸ªâ€œ/â€ä¸ºæ­¢ï¼Œæ˜¯è™šæ‹Ÿç›®å½•éƒ¨åˆ†ã€‚è™šæ‹Ÿç›®å½•ä¹Ÿä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ã€‚æœ¬ä¾‹ä¸­çš„è™šæ‹Ÿç›®å½•æ˜¯â€œ/news/â€ã€‚ æ–‡ä»¶åéƒ¨åˆ†ï¼šä»åŸŸååçš„æœ€åä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°â€œ?â€ä¸ºæ­¢ï¼Œæ˜¯æ–‡ä»¶åéƒ¨åˆ†ï¼Œå¦‚æœæ²¡æœ‰â€œ?â€,åˆ™æ˜¯ä»åŸŸååçš„æœ€åä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°â€œ#â€ä¸ºæ­¢ï¼Œæ˜¯æ–‡ä»¶éƒ¨åˆ†ï¼Œå¦‚æœæ²¡æœ‰â€œï¼Ÿâ€å’Œâ€œ#â€ï¼Œé‚£ä¹ˆä»åŸŸååçš„æœ€åä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°ç»“æŸï¼Œéƒ½æ˜¯æ–‡ä»¶åéƒ¨åˆ†ã€‚æœ¬ä¾‹ä¸­çš„æ–‡ä»¶åæ˜¯â€œindex.aspâ€ã€‚æ–‡ä»¶åéƒ¨åˆ†ä¹Ÿä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ï¼Œå¦‚æœçœç•¥è¯¥éƒ¨åˆ†ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„æ–‡ä»¶åï¼Œä¸€èˆ¬ä¸ºindex.htmlã€‚ é”šéƒ¨åˆ†ï¼šä»â€œ#â€å¼€å§‹åˆ°æœ€åï¼Œéƒ½æ˜¯é”šéƒ¨åˆ†(HTMLçš„èŠ‚ç‚¹)ã€‚æœ¬ä¾‹ä¸­çš„é”šéƒ¨åˆ†æ˜¯â€œnameâ€ã€‚é”šéƒ¨åˆ†ä¹Ÿä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ã€‚ å‚æ•°éƒ¨åˆ†ï¼šä»â€œï¼Ÿâ€å¼€å§‹åˆ°â€œ#â€ä¸ºæ­¢ä¹‹é—´çš„éƒ¨åˆ†ä¸ºå‚æ•°éƒ¨åˆ†ï¼Œåˆç§°æœç´¢éƒ¨åˆ†ã€æŸ¥è¯¢éƒ¨åˆ†ã€‚æœ¬ä¾‹ä¸­çš„å‚æ•°éƒ¨åˆ†ä¸ºâ€œboardID=5&amp;ID=24618&amp;page=1â€ã€‚å‚æ•°å¯ä»¥å…è®¸æœ‰å¤šä¸ªå‚æ•°ï¼Œå‚æ•°ä¸å‚æ•°ä¹‹é—´ç”¨â€œ&amp;â€ä½œä¸ºåˆ†éš”ç¬¦ã€‚ è¯·æ±‚æŠ¥æ–‡ä¹‹è¯·æ±‚æ–¹æ³•æ ¹æ®HTTPæ ‡å‡†ï¼ŒHTTPè¯·æ±‚å¯ä»¥ä½¿ç”¨å¤šç§è¯·æ±‚æ–¹æ³•ã€‚HTTP1.0å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼š GET, POST å’Œ HEADæ–¹æ³•ã€‚HTTP1.1æ–°å¢äº†å…­ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONS, PUT, DELETE, TRACEï¼ŒCONNECTå’ŒPATCH æ–¹æ³•ã€‚ è¿™å…«ç§æ–¹æ³•(åŠ¨ä½œ)è¡¨æ˜äº†è¯·æ±‚çš„URLæŒ‡å®šçš„èµ„æºçš„æ“ä½œæ–¹å¼ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š æ–¹æ³• æ“ä½œæ–¹å¼ GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ HEAD ç±»ä¼¼äºgetè¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´ POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ PUT ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ CONNECT HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ OPTIONS å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ TRACE å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ PATCH ç”¨æ¥å°†å±€éƒ¨ä¿®æ”¹åº”ç”¨äºæŸä¸€èµ„æº PSï¼š GETå’ŒPOSTçš„åŒºåˆ«ï¼š GETæäº¤çš„æ•°æ®ä¼šæ”¾åœ¨URLä¹‹åï¼Œä»¥?åˆ†å‰²URLå’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;ç›¸è¿ï¼Œå¦‚EditPosts.aspx?name=test1&amp;id=123456. POSTæ–¹æ³•æ˜¯æŠŠæäº¤çš„æ•°æ®æ”¾åœ¨HTTPåŒ…çš„Bodyä¸­ã€‚ GETæäº¤çš„æ•°æ®å¤§å°æœ‰é™åˆ¶ï¼Œæœ€å¤šåªèƒ½æœ‰1024å­—èŠ‚ï¼ˆå› ä¸ºæµè§ˆå™¨å¯¹URLçš„é•¿åº¦æœ‰é™åˆ¶ï¼‰ï¼Œè€ŒPOSTæ–¹æ³•æäº¤çš„æ•°æ®æ²¡æœ‰é™åˆ¶ã€‚ GETæ–¹å¼æäº¤æ•°æ®ï¼Œä¼šå¸¦æ¥å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œé€šè¿‡GETæ–¹å¼æäº¤æ•°æ®æ—¶ï¼Œç”¨æˆ·åå’Œå¯†ç å°†å‡ºç°åœ¨URLä¸Šï¼Œå¦‚æœé¡µé¢å¯ä»¥è¢«ç¼“å­˜æˆ–è€…å…¶ä»–äººå¯ä»¥è®¿é—®è¿™å°æœºå™¨ï¼Œå°±å¯ä»¥ä»å†å²è®°å½•è·å¾—è¯¥ç”¨æˆ·çš„è´¦å·å’Œå¯†ç ã€‚ è¯·æ±‚æŠ¥æ–‡ä¹‹é€šç”¨é¦–éƒ¨å¸¸è§çš„é€šç”¨é¦–éƒ¨å¦‚ä¸‹ï¼š Pragmaï¼šæŒ‡å®šâ€œno-cacheâ€å€¼è¡¨ç¤ºæœåŠ¡å™¨å¿…é¡»è¿”å›ä¸€ä¸ªåˆ·æ–°åçš„æ–‡æ¡£ï¼Œå³ä½¿å®ƒæ˜¯ä»£ç†æœåŠ¡å™¨è€Œä¸”å·²ç»æœ‰äº†é¡µé¢çš„æœ¬åœ°æ‹·è´ï¼›åœ¨HTTP/1.1ç‰ˆæœ¬ä¸­ï¼Œå®ƒå’ŒCache-Control:no-cacheä½œç”¨ä¸€æ¨¡ä¸€æ ·ã€‚Pargmaåªæœ‰ä¸€ä¸ªç”¨æ³•ï¼Œ ä¾‹å¦‚ï¼š Pragma: no-cacheæ³¨æ„: åœ¨HTTP/1.0ç‰ˆæœ¬ä¸­ï¼Œåªå®ç°äº†Pragema:no-cache, æ²¡æœ‰å®ç°Cache-Control Cache-Controlï¼šæŒ‡å®šè¯·æ±‚å’Œå“åº”éµå¾ªçš„ç¼“å­˜æœºåˆ¶ã€‚ç¼“å­˜æŒ‡ä»¤æ˜¯å•å‘çš„ï¼ˆå“åº”ä¸­å‡ºç°çš„ç¼“å­˜æŒ‡ä»¤åœ¨è¯·æ±‚ä¸­æœªå¿…ä¼šå‡ºç°ï¼‰ï¼Œä¸”æ˜¯ç‹¬ç«‹çš„ï¼ˆåœ¨è¯·æ±‚æ¶ˆæ¯æˆ–å“åº”æ¶ˆæ¯ä¸­è®¾ç½®Cache-Controlå¹¶ä¸ä¼šä¿®æ”¹å¦ä¸€ä¸ªæ¶ˆæ¯å¤„ç†è¿‡ç¨‹ä¸­çš„ç¼“å­˜å¤„ç†è¿‡ç¨‹ï¼‰ã€‚è¯·æ±‚æ—¶çš„ç¼“å­˜æŒ‡ä»¤åŒ…æ‹¬no-cacheã€no-storeã€max-ageã€max-staleã€min-freshã€only-if-cachedï¼Œå“åº”æ¶ˆæ¯ä¸­çš„æŒ‡ä»¤åŒ…æ‹¬public(å¯ä»¥è¢«ä»»ä½•ç¼“å­˜æ‰€ç¼“å­˜)ã€private(å†…å®¹åªç¼“å­˜åˆ°ç§æœ‰ç¼“å­˜ä¸­)ã€no-cache(æ‰€æœ‰å†…å®¹éƒ½ä¸ä¼šè¢«ç¼“å­˜)ã€no-storeã€no-transformã€must-revalidateã€proxy-revalidateã€max-ageã€s-maxageã€‚ Connectionï¼šä¹‹å‰å·²ç»è¯´è¿‡ï¼Œä¸»è¦æ˜¯æ§åˆ¶TCPè¿æ¥æ˜¯å¦åœ¨è¯·æ±‚å®Œé©¬ä¸Šç«¯å¼€ã€‚ Dateï¼šè¡¨ç¤ºæ¶ˆæ¯å‘é€çš„æ—¶é—´ã€‚ è¯·æ±‚æŠ¥æ–‡ä¹‹è¯·æ±‚é¦–éƒ¨å¸¸è§çš„è¯·æ±‚é¦–éƒ¨å¦‚ä¸‹ï¼š If-Modified-Sinceï¼šæŠŠæµè§ˆå™¨ç«¯ç¼“å­˜é¡µé¢çš„æœ€åä¿®æ”¹æ—¶é—´å‘é€åˆ°æœåŠ¡å™¨å»ï¼ŒæœåŠ¡å™¨ä¼šæŠŠè¿™ä¸ªæ—¶é—´ä¸æœåŠ¡å™¨ä¸Šå®é™…æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœæ—¶é—´ä¸€è‡´ï¼Œé‚£ä¹ˆè¿”å›304ï¼Œå®¢æˆ·ç«¯å°±ç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ–‡ä»¶ã€‚å¦‚æœæ—¶é—´ä¸ä¸€è‡´ï¼Œå°±ä¼šè¿”å›200å’Œæ–°çš„æ–‡ä»¶å†…å®¹ã€‚å®¢æˆ·ç«¯æ¥åˆ°ä¹‹åï¼Œä¼šä¸¢å¼ƒæ—§æ–‡ä»¶ï¼ŒæŠŠæ–°æ–‡ä»¶ç¼“å­˜èµ·æ¥ï¼Œå¹¶æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸­ã€‚ If-None-Matchï¼šIf-None-Matchå’ŒETagä¸€èµ·å·¥ä½œï¼Œå·¥ä½œåŸç†æ˜¯åœ¨HTTP Responseä¸­æ·»åŠ ETagä¿¡æ¯ã€‚ å½“ç”¨æˆ·å†æ¬¡è¯·æ±‚è¯¥èµ„æºæ—¶ï¼Œå°†åœ¨HTTP Request ä¸­åŠ å…¥If-None-Matchä¿¡æ¯(ETagçš„å€¼)ã€‚å¦‚æœæœåŠ¡å™¨éªŒè¯èµ„æºçš„ETagæ²¡æœ‰æ”¹å˜ï¼ˆè¯¥èµ„æºæ²¡æœ‰æ›´æ–°ï¼‰ï¼Œå°†è¿”å›ä¸€ä¸ª304çŠ¶æ€å‘Šè¯‰å®¢æˆ·ç«¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ–‡ä»¶ã€‚å¦åˆ™å°†è¿”å›200çŠ¶æ€å’Œæ–°çš„èµ„æºå’ŒEtagã€‚ Acceptï¼šæµè§ˆå™¨ç«¯å¯ä»¥æ¥å—çš„MIMEç±»å‹ã€‚ä¾‹å¦‚ï¼šAccept: text/html ä»£è¡¨æµè§ˆå™¨å¯ä»¥æ¥å—æœåŠ¡å™¨å›å‘çš„ç±»å‹ä¸º text/html ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„htmlæ–‡æ¡£ï¼Œå¦‚æœæœåŠ¡å™¨æ— æ³•è¿”å›text/htmlç±»å‹çš„æ•°æ®ï¼ŒæœåŠ¡å™¨åº”è¯¥è¿”å›ä¸€ä¸ª406é”™è¯¯(non acceptable)ã€‚é€šé…ç¬¦ * ä»£è¡¨ä»»æ„ç±»å‹ï¼Œä¾‹å¦‚ Accept: */* ä»£è¡¨æµè§ˆå™¨å¯ä»¥å¤„ç†æ‰€æœ‰ç±»å‹ï¼Œ(ä¸€èˆ¬æµè§ˆå™¨å‘ç»™æœåŠ¡å™¨éƒ½æ˜¯å‘è¿™ä¸ª)ã€‚ Accept-Encodingï¼šæµè§ˆå™¨ç”³æ˜è‡ªå·±å¯æ¥æ”¶çš„ç¼–ç æ–¹æ³•ï¼Œé€šå¸¸æŒ‡å®šå‹ç¼©æ–¹æ³•ï¼Œæ˜¯å¦æ”¯æŒå‹ç¼©ï¼Œæ”¯æŒä»€ä¹ˆå‹ç¼©æ–¹æ³•ï¼ˆgzipï¼Œdeflateï¼‰;Servletèƒ½å¤Ÿå‘æ”¯æŒgzipçš„æµè§ˆå™¨è¿”å›ç»gzipç¼–ç çš„HTMLé¡µé¢ã€‚è®¸å¤šæƒ…å½¢ä¸‹è¿™å¯ä»¥å‡å°‘5åˆ°10å€çš„ä¸‹è½½æ—¶é—´ã€‚ä¾‹å¦‚ï¼š Accept-Encoding: gzip, deflateã€‚å¦‚æœè¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªåŸŸï¼ŒæœåŠ¡å™¨å‡å®šå®¢æˆ·ç«¯å¯¹å„ç§å†…å®¹ç¼–ç éƒ½å¯ä»¥æ¥å—ã€‚ Accept-Languageï¼šæµè§ˆå™¨ç”³æ˜è‡ªå·±æ¥æ”¶çš„è¯­è¨€ã€‚è¯­è¨€è·Ÿå­—ç¬¦é›†çš„åŒºåˆ«ï¼šä¸­æ–‡æ˜¯è¯­è¨€ï¼Œä¸­æ–‡æœ‰å¤šç§å­—ç¬¦é›†ï¼Œæ¯”å¦‚big5ï¼Œgb2312ï¼Œgbkç­‰ç­‰ï¼›ä¾‹å¦‚ï¼šAccept-Language: en-usã€‚å¦‚æœè¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªæŠ¥å¤´åŸŸï¼ŒæœåŠ¡å™¨å‡å®šå®¢æˆ·ç«¯å¯¹å„ç§è¯­è¨€éƒ½å¯ä»¥æ¥å—ã€‚ Accept-Charsetï¼šæµè§ˆå™¨å¯æ¥å—çš„å­—ç¬¦é›†ã€‚å¦‚æœåœ¨è¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è®¾ç½®è¿™ä¸ªåŸŸï¼Œç¼ºçœè¡¨ç¤ºä»»ä½•å­—ç¬¦é›†éƒ½å¯ä»¥æ¥å—ã€‚ User-Agentï¼šå‘Šè¯‰HTTPæœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨çš„åç§°å’Œç‰ˆæœ¬ Refererï¼šåŒ…å«ä¸€ä¸ªURLï¼Œç”¨æˆ·ä»è¯¥URLä»£è¡¨çš„é¡µé¢å‡ºå‘è®¿é—®å½“å‰è¯·æ±‚çš„é¡µé¢ã€‚æä¾›äº†Requestçš„ä¸Šä¸‹æ–‡ä¿¡æ¯çš„æœåŠ¡å™¨ï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯ä»å“ªä¸ªé“¾æ¥è¿‡æ¥çš„ï¼Œæ¯”å¦‚ä»æˆ‘ä¸»é¡µä¸Šé“¾æ¥åˆ°ä¸€ä¸ªæœ‹å‹é‚£é‡Œï¼Œä»–çš„æœåŠ¡å™¨å°±èƒ½å¤Ÿä»HTTP Refererä¸­ç»Ÿè®¡å‡ºæ¯å¤©æœ‰å¤šå°‘ç”¨æˆ·ç‚¹å‡»æˆ‘ä¸»é¡µä¸Šçš„é“¾æ¥è®¿é—®ä»–çš„ç½‘ç«™ã€‚ Hostï¼šï¼ˆå‘é€è¯·æ±‚æ—¶ï¼Œè¯¥å¤´åŸŸæ˜¯å¿…éœ€çš„ï¼‰ä¸»è¦ç”¨äºæŒ‡å®šè¢«è¯·æ±‚èµ„æºçš„Internetä¸»æœºå’Œç«¯å£å·ï¼Œå®ƒé€šå¸¸ä»HTTP URLä¸­æå–å‡ºæ¥çš„ã€‚HTTP/1.1è¯·æ±‚å¿…é¡»åŒ…å«ä¸»æœºå¤´åŸŸï¼Œå¦åˆ™ç³»ç»Ÿä¼šä»¥400çŠ¶æ€ç è¿”å›ã€‚ Authorizationï¼šæˆæƒä¿¡æ¯ï¼Œé€šå¸¸å‡ºç°åœ¨å¯¹æœåŠ¡å™¨å‘é€çš„WWW-Authenticateå¤´çš„åº”ç­”ä¸­ã€‚ä¸»è¦ç”¨äºè¯æ˜å®¢æˆ·ç«¯æœ‰æƒæŸ¥çœ‹æŸä¸ªèµ„æºã€‚å½“æµè§ˆå™¨è®¿é—®ä¸€ä¸ªé¡µé¢æ—¶ï¼Œå¦‚æœæ”¶åˆ°æœåŠ¡å™¨çš„å“åº”ä»£ç ä¸º401ï¼ˆæœªæˆæƒï¼‰ï¼Œå¯ä»¥å‘é€ä¸€ä¸ªåŒ…å«Authorizationè¯·æ±‚æŠ¥å¤´åŸŸçš„è¯·æ±‚ï¼Œè¦æ±‚æœåŠ¡å™¨å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚ Rangeï¼šå¯ä»¥è¯·æ±‚å®ä½“çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­èŒƒå›´ã€‚ Cookieï¼šæœ€é‡è¦çš„è¯·æ±‚å¤´ä¹‹ä¸€, å°†cookieçš„å€¼å‘é€ç»™HTTPæœåŠ¡å™¨ã€‚ è¯·æ±‚æŠ¥æ–‡ä¹‹å®ä½“é¦–éƒ¨å¸¸è§çš„å®ä½“é¦–éƒ¨å¦‚ä¸‹ï¼š Content-Typeï¼šè¯´æ˜äº†å®ä½“ä¸»ä½“å†…å¯¹è±¡çš„åª’ä½“ç±»å‹ã€‚ Content-Lengthï¼šè¡¨ç¤ºè¯·æ±‚æ¶ˆæ¯æ­£æ–‡çš„é•¿åº¦ã€‚ Content-Rangeï¼šç”¨äºæŒ‡å®šæ•´ä¸ªå®ä½“ä¸­çš„ä¸€éƒ¨åˆ†çš„æ’å…¥ä½ç½®ï¼Œä»–ä¹ŸæŒ‡ç¤ºäº†æ•´ä¸ªå®ä½“çš„é•¿åº¦ã€‚åœ¨æœåŠ¡å™¨å‘å®¢æˆ·è¿”å›ä¸€ä¸ªéƒ¨åˆ†å“åº”ï¼Œå®ƒå¿…é¡»æè¿°å“åº”è¦†ç›–çš„èŒƒå›´å’Œæ•´ä¸ªå®ä½“é•¿åº¦ã€‚ä¸€èˆ¬æ ¼å¼ï¼šContent-Range:bytes-unitSPfirst-byte-pos-last-byte-pos/entity-lengthã€‚ Content-Encodingï¼šWEBæœåŠ¡å™¨è¡¨æ˜è‡ªå·±ä½¿ç”¨äº†ä»€ä¹ˆå‹ç¼©æ–¹æ³•ï¼ˆgzipï¼Œdeflateï¼‰å‹ç¼©å“åº”ä¸­çš„å¯¹è±¡ã€‚åªæœ‰åœ¨è§£ç ä¹‹åæ‰å¯ä»¥å¾—åˆ°Content-Typeå¤´æŒ‡å®šçš„å†…å®¹ç±»å‹ã€‚ Content-Languageï¼šWEBæœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨è‡ªå·±å“åº”çš„å¯¹è±¡æ‰€ç”¨çš„è‡ªç„¶è¯­è¨€ã€‚ è¯·æ±‚æŠ¥æ–‡ä¹‹å…¶ä»–é¦–éƒ¨ P3Pï¼šç”¨äºè·¨åŸŸè®¾ç½®Cookie, è¿™æ ·å¯ä»¥è§£å†³iframeè·¨åŸŸè®¿é—®cookieçš„é—®é¢˜ã€‚ HTTPæŠ¥æ–‡ä¹‹å“åº”æŠ¥æ–‡å“åº”æŠ¥æ–‡ç”±çŠ¶æ€è¡Œ(åè®®ç‰ˆæœ¬ã€çŠ¶æ€ç ã€æ¶ˆæ¯çŠ¶æ€)ã€å“åº”å¤´éƒ¨ã€ç©ºè¡Œ(å›è½¦+æ¢è¡Œ)å’Œå“åº”æ•°æ®(ä¸»ä½“)å››ä¸ªéƒ¨åˆ†ç»„æˆã€‚å¦‚ä¸‹å›¾ï¼š å®ƒçš„ä¾‹å­å¦‚ä¸‹ï¼š å“åº”æŠ¥æ–‡çš„é€šç”¨é¦–éƒ¨å’Œå®ä½“é¦–éƒ¨ä»¥åŠå…¶ä»–é¦–éƒ¨éƒ½å’Œè¯·æ±‚æŠ¥æ–‡å·®ä¸å¤šï¼Œæˆ‘ä»¬ä¸»è¦è®²è§£å“åº”é¦–éƒ¨ã€‚ å“åº”æŠ¥æ–‡ä¹‹å“åº”é¦–éƒ¨ Allowï¼šæœåŠ¡å™¨æ”¯æŒå“ªäº›è¯·æ±‚æ–¹æ³• Expiresï¼šæŒ‡æ˜åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™è®¤ä¸ºæ–‡æ¡£å·²ç»è¿‡æœŸï¼Œä»è€Œä¸å†ç¼“å­˜å®ƒï¼Œé‡æ–°ä»æœåŠ¡å™¨è·å–ï¼Œä¼šæ›´æ–°ç¼“å­˜ã€‚è¿‡æœŸä¹‹å‰ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚HTTP1.1çš„å®¢æˆ·ç«¯å’Œç¼“å­˜ä¼šå°†éæ³•çš„æ—¥æœŸæ ¼å¼ï¼ˆåŒ…æ‹¬0ï¼‰çœ‹ä½œå·²ç»è¿‡æœŸã€‚egï¼šä¸ºäº†è®©æµè§ˆå™¨ä¸è¦ç¼“å­˜é¡µé¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†Expireså®ä½“æŠ¥å¤´åŸŸï¼Œè®¾ç½®ä¸º0ã€‚ Set-Cookieï¼šéå¸¸é‡è¦çš„header, ç”¨äºæŠŠcookieå‘é€åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œæ¯ä¸€ä¸ªå†™å…¥cookieéƒ½ä¼šç”Ÿæˆä¸€ä¸ªSet-Cookieã€‚ Last-Modifiedï¼šç”¨äºæŒ‡ç¤ºèµ„æºçš„æœ€åä¿®æ”¹æ—¥æœŸå’Œæ—¶é—´ã€‚Last-Modifiedä¹Ÿå¯ç”¨setDateHeaderæ–¹æ³•æ¥è®¾ç½®ã€‚ Serverï¼šæŒ‡æ˜HTTPæœåŠ¡å™¨ç”¨æ¥å¤„ç†è¯·æ±‚çš„è½¯ä»¶ä¿¡æ¯ã€‚ Locationï¼šç”¨äºé‡å®šå‘ä¸€ä¸ªæ–°çš„ä½ç½®ï¼ŒåŒ…å«æ–°çš„URLåœ°å€ã€‚è¡¨ç¤ºå®¢æˆ·åº”å½“åˆ°å“ªé‡Œå»æå–æ–‡æ¡£ã€‚Locationé€šå¸¸ä¸æ˜¯ç›´æ¥è®¾ç½®çš„ï¼Œè€Œæ˜¯é€šè¿‡HttpServletResponseçš„sendRedirectæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åŒæ—¶è®¾ç½®çŠ¶æ€ä»£ç ä¸º302ã€‚Locationå“åº”æŠ¥å¤´åŸŸå¸¸ç”¨åœ¨æ›´æ¢åŸŸåçš„æ—¶å€™ã€‚ WWW-Authenticateï¼šè¯¥å“åº”æŠ¥å¤´åŸŸå¿…é¡»è¢«åŒ…å«åœ¨401ï¼ˆæœªæˆæƒçš„ï¼‰å“åº”æ¶ˆæ¯ä¸­ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°401å“åº”æ¶ˆæ¯æ—¶å€™ï¼Œå¹¶å‘é€AuthorizationæŠ¥å¤´åŸŸè¯·æ±‚æœåŠ¡å™¨å¯¹å…¶è¿›è¡ŒéªŒè¯æ—¶ï¼ŒæœåŠ¡ç«¯å“åº”æŠ¥å¤´å°±åŒ…å«è¯¥æŠ¥å¤´åŸŸã€‚ HTTPä¹‹çŠ¶æ€ç çŠ¶æ€ä»£ç æœ‰ä¸‰ä½æ•°å­—ç»„æˆï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«ï¼Œå…±åˆ†äº”ç§ç±»åˆ«: çŠ¶æ€ç  è¯´æ˜ 1xx æŒ‡ç¤ºä¿¡æ¯â€“è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç† 2xx æˆåŠŸâ€“è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ã€ç†è§£ã€æ¥å— 3xx é‡å®šå‘â€“è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œ 4xx å®¢æˆ·ç«¯é”™è¯¯â€“è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç° 5xx æœåŠ¡å™¨ç«¯é”™è¯¯â€“æœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚ å¸¸ç”¨çš„çŠ¶æ€ç å¦‚ä¸‹ï¼š çŠ¶æ€ç  è¯´æ˜ 200 OK å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ 400 Bad Request å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£ 401 Unauthorized è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨ 403 Forbidden æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡ 404 Not Found è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œegï¼šè¾“å…¥äº†é”™è¯¯çš„URL 500 Internal Server Error æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯ 503 Server Unavailable æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸ å‚è€ƒ ã€Šå›¾è§£HTTPã€‹ å…³äºHTTPåè®®ï¼Œä¸€ç¯‡å°±å¤Ÿäº† HTTPåè®®è¯¦è§£]]></content>
      <categories>
        <category>è®¡ç®—æœºç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TCPåè®®]]></title>
    <url>%2F2018%2F05%2F18%2F%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%2FTCP%E5%8D%8F%E8%AE%AE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šTCPä½œä¸ºä¼ è¾“å±‚çš„ä¸€å¤§åè®®ï¼Œè™½ç„¶æ²¡æœ‰UDPç®€å•ï¼Œä½†æ˜¯èƒœåœ¨å¯é ã€‚ TCPè®¤è¯†TCP(ä¼ è¾“æ§åˆ¶åè®®) æ˜¯ä¸€ç§é¢å‘è¿æ¥ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚åè®®ã€‚TCPåœ¨ä¼ é€æ•°æ®ä¹‹å‰ä¼šå…ˆç›¸äº’å‘é€ä¸€äº›é¢„å¤‡æŠ¥æ–‡æ®µåå•†ä¸€äº›å‚æ•°ï¼Œæ¯”å¦‚åºå·ç­‰ç­‰ï¼ŒTCPå°†ç”¨æˆ·æ•°æ®æ‰“åŒ…æˆæŠ¥æ–‡æ®µï¼Œå‘é€æ•°æ®åå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¦ä¸€ç«¯å¯¹æ”¶åˆ°çš„æ•°æ®è¿›è¡Œç¡®è®¤ï¼Œå¯¹å¤±åºçš„æ•°æ®é‡æ–°æ’åºï¼Œä¸¢å¼ƒé‡å¤æ•°æ®ï¼ŒTCPæä¾›ç«¯åˆ°ç«¯çš„æµé‡æ§åˆ¶ï¼Œå¹¶è®¡ç®—å’ŒéªŒè¯ä¸€ä¸ªå¼ºåˆ¶æ€§çš„ç«¯åˆ°ç«¯æ ¡éªŒå’Œã€‚ TCPç‰¹ç‚¹ TCPæ˜¯é¢å‘è¿æ¥çš„ï¼Œé€šä¿¡å‰éœ€è¦å»ºç«‹è¿æ¥ï¼Œé€šä¿¡ç»“æŸéœ€è¦é‡Šæ”¾è¿æ¥ã€‚ TCPæä¾›å¯é äº¤ä»˜æœåŠ¡ï¼Œå¯é æŒ‡çš„æ˜¯ï¼šTCPå‘é€çš„æ•°æ®æ— é‡å¤ã€æ— ä¸¢å¤±ã€æ— é”™è¯¯ã€ä¸å‘é€ç«¯é¡ºåºä¸€è‡´ã€‚ TCPæ˜¯é¢å‘å­—èŠ‚æµçš„ï¼Œé¢å‘å­—èŠ‚æµæŒ‡çš„æ˜¯ï¼šTCPä»¥å­—èŠ‚ä¸ºå•ä½ã€‚è™½ç„¶ä¼ è¾“çš„è¿‡ç¨‹ä¸­æ•°æ®è¢«åˆ’åˆ†æˆä¸€ä¸ªä¸ªæ•°æ®æŠ¥ï¼Œä½†è¿™åªæ˜¯ä¸ºäº†æ–¹ä¾¿ä¼ è¾“ï¼Œæ¥æ”¶ç«¯æœ€ç»ˆæ¥å—åˆ°çš„æ•°æ®å°†ä¸å‘é€ç«¯çš„æ•°æ®ä¸€æ¨¡ä¸€æ ·ã€‚ TCPæä¾›å…¨åŒå·¥é€šä¿¡ï¼Œå…¨åŒå·¥é€šä¿¡æŒ‡çš„æ˜¯ï¼šTCPçš„ä¸¤ç«¯æ—¢å¯ä»¥ä½œä¸ºå‘é€ç«¯ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ¥æ”¶ç«¯ã€‚ ä¸€æ¡TCPè¿æ¥çš„ä¸¤ç«¯åªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼ŒTCPåªèƒ½æä¾›ç‚¹åˆ°ç‚¹çš„é€šä¿¡ï¼Œè€ŒUDPå¯ä»¥ä»»æ„æ–¹å¼çš„é€šä¿¡ã€‚ TCPé¦–éƒ¨ 16ä½ç«¯å£å·:åŒ…å«æºç«¯å£å’Œç›®çš„ç«¯å£ï¼Œå®¢æˆ·ç«¯é€šå¸¸ä½¿ç”¨ç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©çš„ä¸´æ—¶ç«¯å£å·ï¼Œè€ŒæœåŠ¡å™¨åˆ™ä½¿ç”¨è‡ªä¸»å®šä¹‰ç«¯å£å·. 32ä½åºå·:ä¸€æ¬¡TCPé€šä¿¡è¿‡ç¨‹ä¸­ä¸€ä¸ªä¼ è¾“æ–¹å‘ä¸Šçš„å­—èŠ‚æµçš„æ¯ä¸ªå­—èŠ‚çš„ç¼–å·ï¼Œä¾‹å¦‚:Aå‘é€ç»™Bçš„ç¬¬ä¸€ä¸ªTCPæŠ¥æ–‡æ®µä¸­ï¼Œåºå·å€¼è¢«ç³»ç»Ÿåˆå§‹åŒ–ä¸ºæŸä¸ªéšæœºå€¼ISNï¼Œé‚£ä¹ˆåœ¨è¯¥ä¼ è¾“æ–¹å‘ä¸Šï¼Œåç»­çš„TCPæŠ¥æ–‡æ®µä¸­åºå·å€¼å°†è¢«ç³»ç»Ÿè®¾ç½®ä¸ºISNåŠ ä¸Šè¯¥æŠ¥æ–‡æ®µæ‰€æºå¸¦æ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚åœ¨æ•´ä¸ªå­—èŠ‚æµä¸­çš„åç§»ã€‚ 32ä½çš„ç¡®è®¤å·: ç”¨ä½œå¯¹å¦å¤–ä¸€æ–¹å‘é€æ¥çš„TCPæŠ¥æ–‡æ®µçš„å“åº”ï¼Œå…¶å€¼æ˜¯æ”¶åˆ°çš„TCPæŠ¥æ–‡æ®µçš„åºå·å€¼åŠ 1ã€‚ 4ä½å¤´éƒ¨é•¿åº¦: æ ‡è¯†TCPå¤´éƒ¨æœ‰å¤šå°‘ä¸ª32bit(4å­—èŠ‚)ï¼Œæœ€å¤§60å­—èŠ‚. 6ä½æ ‡å¿—ä½: URG:è¡¨ç¤ºç´§æ€¥æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ. ACK:è¡¨ç¤ºç¡®è®¤å·æ˜¯å¦æœ‰æ•ˆï¼Œæˆ‘ä»¬ç§°æºå¸¦ACKæ ‡å¿—çš„TCPæŠ¥æ–‡æ®µä¸ºç¡®è®¤æŠ¥æ–‡æ®µ. PSH:æç¤ºæ¥æ”¶ç«¯åº”ç”¨ç¨‹åºåº”è¯¥ç«‹å³ä»TCPæ¥æ”¶ç¼“å†²åŒºä¸­è¯»èµ°æ•°æ®,ä¸ºæ¥æ”¶æ•°æ®è…¾å‡ºç©ºé—´. RST:è¡¨ç¤ºè¦æ±‚å¯¹æ–¹é‡æ–°å»ºç«‹è¿æ¥(å¤ä½æŠ¥æ–‡æ®µ) SYN:è¡¨ç¤ºè¯·æ±‚å»ºç«‹ä¸€ä¸ªè¿æ¥(åŒæ­¥æŠ¥æ–‡æ®µ); FIN:è¡¨ç¤ºé€šçŸ¥å¯¹æ–¹æœ¬ç«¯è¦å…³é—­è¿æ¥äº†(ç»“æŸæŠ¥æ–‡æ®µ); 16ä½çª—å£å¤§å°:TCPæµé‡çš„ä¸€ä¸ªæ§åˆ¶æ‰‹æ®µ,,å®ƒå‘ŠçŸ¥æ˜¯å¯¹æ–¹æœ¬ç«¯çš„TCPæ¥æ”¶ç¼“å†²åŒºè¿˜èƒ½å®¹çº³å¤šå°‘å­—èŠ‚çš„æ•°æ®ï¼Œè¿™æ ·å¯¹æ–¹å°±å¯ä»¥æ§åˆ¶å‘é€æ•°æ®çš„é€Ÿåº¦. 16ä½æ ¡éªŒå’Œ:ç”±å‘é€ç«¯å¡«å……ï¼Œæ¥æ”¶ç«¯å¯¹TCPæŠ¥æ–‡æ®µæ‰§è¡ŒCRCç®—æ³•ï¼ˆå¾ªç¯å†—ä½™ç æ£€éªŒï¼Œä¸UDPä¸€æ ·ï¼‰ï¼Œæ£€éªŒTCPå¤´éƒ¨åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦æŸåï¼Œä¸ä»…åŒ…æ‹¬TCPå¤´éƒ¨ï¼Œä¹ŸåŒ…æ‹¬æ•°æ®éƒ¨åˆ†ã€‚ 16ä½ç´§æ€¥æŒ‡é’ˆ:æ˜¯ä¸€ä¸ªæ­£çš„åç§»é‡.å®ƒå’Œåºå·å­—æ®µçš„å€¼ç›¸åŠ è¡¨ç¤ºæœ€åä¸€ä¸ªç´§æ€¥æ•°æ®çš„ä¸‹ä¸€ä¸ªå­—èŠ‚çš„åºå·. é€‰é¡¹å­—æ®µï¼Œä¸Šè¿°å­—æ®µéƒ½æ˜¯æ¯ä¸ªTCPå¤´éƒ¨å¿…é¡»è¦æœ‰çš„ï¼Œè€Œé€‰é¡¹å­—æ®µæ˜¯å¯é€‰çš„ï¼Œä¸”é•¿åº¦å¯å˜ï¼Œæœ€é•¿40å­—èŠ‚ã€‚ æœ€å¸¸ç”¨çš„é€‰é¡¹å­—æ®µä¸ºMMSï¼šæœ€å¤§æŠ¥æ–‡é•¿åº¦ã€‚ TCPè¿æ¥å»ºç«‹(ä¸‰æ¬¡æ¡æ‰‹) TCPåè®®ä¸­ï¼Œä¸»åŠ¨å‘èµ·è¯·æ±‚çš„ä¸€ç«¯ç§°ä¸ºå®¢æˆ·ç«¯ï¼Œè¢«åŠ¨è¿æ¥çš„ä¸€ç«¯ç§°ä¸ºæœåŠ¡ç«¯ã€‚ä¸ç®¡æ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼ŒTCPè¿æ¥å»ºç«‹å®Œåéƒ½èƒ½å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚ æ¡æ‰‹å‰ï¼šæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½ä¸ºCLOSEDçŠ¶æ€ï¼Œåœ¨é€šä¿¡å¼€å§‹å‰ï¼ŒåŒæ–¹éƒ½å¾—åˆ›å»ºå„è‡ªçš„ä¼ è¾“æ§åˆ¶å—ï¼ˆTCBï¼‰ã€‚æœåŠ¡å™¨åˆ›å»ºå®ŒTCBåéè¿›å…¥LISTENçŠ¶æ€ï¼Œæ­¤æ—¶å‡†å¤‡æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„è¿æ¥è¯·æ±‚ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚è¯¥æŠ¥æ–‡æ®µçš„å¤´éƒ¨ä¸­SYN=1ï¼ŒACK=0ï¼Œ(è¡¨ç¤ºè¯¥æŠ¥æ–‡æ®µä¸ºè¿æ¥è¯·æ±‚æŠ¥æ–‡) seq=x(xä¸ºæœ¬æ¬¡TCPé€šä¿¡çš„å­—èŠ‚æµçš„åˆå§‹åºå·)ã€‚è¯·æ±‚å‘é€åï¼Œå®¢æˆ·ç«¯ä¾¿è¿›å…¥SYN-SENTçŠ¶æ€ã€‚ ç¬¬äºŒæ¬¡æ¡æ‰‹ ï¼šæœåŠ¡ç«¯æ”¶åˆ°è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå¦‚æœåŒæ„è¿æ¥ï¼Œåˆ™ä¼šå‘é€ä¸€ä¸ªåº”ç­”ï¼šSYN=1ï¼ŒACK=1ï¼Œ(è¡¨ç¤ºè¯¥æŠ¥æ–‡æ®µä¸ºè¿æ¥åŒæ„çš„åº”ç­”æŠ¥æ–‡) seq=yï¼Œ(è¡¨ç¤ºæœåŠ¡ç«¯ä½œä¸ºå‘é€è€…æ—¶ï¼Œå‘é€å­—èŠ‚æµçš„åˆå§‹åºå·) ack=x+1(è¡¨ç¤ºæœåŠ¡ç«¯å¸Œæœ›ä¸‹ä¸€ä¸ªæ•°æ®æŠ¥å‘é€åºå·ä»x+1å¼€å§‹çš„å­—èŠ‚)ã€‚è¯¥åº”ç­”å‘é€å®Œæˆåä¾¿è¿›å…¥SYN-RCVDçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ ï¼šå½“å®¢æˆ·ç«¯æ”¶åˆ°è¿æ¥åŒæ„çš„åº”ç­”åï¼Œè¿˜è¦å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªç¡®è®¤æŠ¥æ–‡æ®µï¼Œè¡¨ç¤ºï¼šæœåŠ¡ç«¯å‘æ¥çš„è¿æ¥åŒæ„åº”ç­”å·²ç»æˆåŠŸæ”¶åˆ°ã€‚è¯¥æŠ¥æ–‡æ®µçš„å¤´éƒ¨ä¸ºï¼šACK=1ï¼Œseq=x+1ï¼Œack=y+1ã€‚å®¢æˆ·ç«¯å‘å®Œè¿™ä¸ªæŠ¥æ–‡æ®µåä¾¿è¿›å…¥ESTABLISHEDçŠ¶æ€ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ªåº”ç­”åä¹Ÿè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œæ­¤æ—¶è¿æ¥çš„å»ºç«‹å®Œæˆï¼ PSï¼šä¸ºä»€ä¹ˆè¿æ¥å»ºç«‹éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡æ¡æ‰‹ï¼Ÿ é˜²æ­¢å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µè¢«æœåŠ¡ç«¯æ¥æ”¶ï¼Œä»è€Œäº§ç”Ÿé”™è¯¯ï¼Œå¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŒ‡çš„æ˜¯ï¼šè‹¥å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€çš„è¿æ¥è¯·æ±‚ä¸¢å¤±ï¼Œå®¢æˆ·ç«¯ç­‰å¾…åº”ç­”è¶…æ—¶åå°±ä¼šå†æ¬¡å‘é€è¿æ¥è¯·æ±‚ï¼Œæ­¤æ—¶ï¼Œä¸Šä¸€ä¸ªè¿æ¥è¯·æ±‚å°±æ˜¯å¤±æ•ˆçš„ã€‚ è‹¥å»ºç«‹è¿æ¥åªéœ€ä¸¤æ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡ç«¯åœ¨æ”¶åˆ°è¿æ¥è¯·æ±‚åå°±è¿›å…¥ESTABLISHEDçŠ¶æ€ã€‚æ­¤æ—¶å¦‚æœç½‘ç»œæ‹¥å¡ï¼Œå®¢æˆ·ç«¯å‘é€çš„è¿æ¥è¯·æ±‚è¿Ÿè¿Ÿåˆ°ä¸äº†æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯ä¾¿è¶…æ—¶é‡å‘è¯·æ±‚ï¼Œæ­¤æ—¶ï¼Œå¦‚æœé‚£ä¸ªå¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠµè¾¾äº†æœåŠ¡ç«¯ï¼Œä½†æ­¤æ—¶çš„å®¢æˆ·ç«¯æ—©å·²è¿›å…¥CLOSEDçŠ¶æ€ï¼ŒæœåŠ¡ç«¯å°†ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œè¿™æ ·æµªè´¹æœåŠ¡ç«¯è¿æ¥èµ„æºã€‚ TCPè¿æ¥é‡Šæ”¾(å››æ¬¡æ¡æ‰‹)TCPè¿æ¥å‘é€æ•°æ®æ˜¯åŒå‘çš„ï¼Œå› æ­¤åœ¨å››æ¬¡æŒ¥æ‰‹ä¸­ï¼Œå‰ä¸¤æ¬¡æŒ¥æ‰‹ç”¨äºæ–­å¼€ä¸€ä¸ªæ–¹å‘çš„è¿æ¥ï¼Œåä¸¤æ¬¡æŒ¥æ‰‹ç”¨äºæ–­å¼€å¦ä¸€æ–¹å‘çš„è¿æ¥ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ ï¼šè‹¥Aè®¤ä¸ºæ•°æ®å‘é€å®Œæˆï¼Œåˆ™å®ƒéœ€è¦å‘Bå‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚ã€‚è¯¥è¯·æ±‚åªæœ‰æŠ¥æ–‡å¤´ï¼Œå¤´ä¸­æºå¸¦çš„ä¸»è¦å‚æ•°ä¸ºï¼šFIN=1ï¼Œ(è¡¨ç¤ºè¯¥æŠ¥æ–‡æ®µæ˜¯ä¸€ä¸ªè¿æ¥é‡Šæ”¾è¯·æ±‚) seq=u(u-1æ˜¯Aå‘Bå‘é€çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·)ã€‚æ­¤æ—¶ï¼ŒAå°†è¿›å…¥FIN-WAIT-1çŠ¶æ€ã€‚ ç¬¬äºŒæ¬¡æ¡æ‰‹ ï¼šBæ”¶åˆ°è¿æ¥é‡Šæ”¾è¯·æ±‚åï¼Œä¼šé€šçŸ¥ç›¸åº”çš„åº”ç”¨ç¨‹åºï¼Œå‘Šè¯‰å®ƒAå‘Bè¿™ä¸ªæ–¹å‘çš„è¿æ¥å·²ç»é‡Šæ”¾ã€‚æ­¤æ—¶Bè¿›å…¥CLOSE-WAITçŠ¶æ€ï¼Œå¹¶å‘Aå‘é€è¿æ¥é‡Šæ”¾çš„åº”ç­”ï¼Œå…¶æŠ¥æ–‡å¤´åŒ…å«ï¼š ACK=1ï¼Œ(è¡¨ç¤ºåº”ç­”) seq=v (v-1æ˜¯Bå‘Aå‘é€çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·)ï¼Œack=u+1(è¡¨ç¤ºå¸Œæœ›æ”¶åˆ°ä»ç¬¬u+1ä¸ªå­—èŠ‚å¼€å§‹çš„æŠ¥æ–‡æ®µï¼Œå¹¶ä¸”å·²ç»æˆåŠŸæ¥æ”¶äº†å‰uä¸ªå­—èŠ‚)ã€‚Aæ”¶åˆ°è¯¥åº”ç­”ï¼Œè¿›å…¥FIN-WAIT-2çŠ¶æ€ï¼Œç­‰å¾…Bå‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚ã€‚ç¬¬äºŒæ¬¡æŒ¥æ‰‹å®Œæˆåï¼ŒAåˆ°Bæ–¹å‘çš„è¿æ¥å·²ç»é‡Šæ”¾ï¼ŒBä¸ä¼šå†æ¥æ”¶æ•°æ®ï¼ŒAä¹Ÿä¸ä¼šå†å‘é€æ•°æ®ã€‚ä½†Båˆ°Aæ–¹å‘çš„è¿æ¥ä»ç„¶å­˜åœ¨ï¼ŒBå¯ä»¥ç»§ç»­å‘Aå‘é€æ•°æ®ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ ï¼šå½“Bå‘Aå‘å®Œæ‰€æœ‰æ•°æ®åï¼Œå‘Aå‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚ï¼Œè¯·æ±‚å¤´ï¼šFIN=1ï¼ŒACK=1ï¼Œseq=wï¼Œack=u+1ã€‚Bä¾¿è¿›å…¥LAST-ACKçŠ¶æ€ã€‚ ç¬¬å››æ¬¡æ¡æ‰‹ ï¼šAæ”¶åˆ°é‡Šæ”¾è¯·æ±‚åï¼Œå‘Bå‘é€ç¡®è®¤åº”ç­”ï¼Œæ­¤æ—¶Aè¿›å…¥TIME-WAITçŠ¶æ€ã€‚è¯¥çŠ¶æ€ä¼šæŒç»­2MSL(æŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´)æ—¶é—´ï¼Œè‹¥è¯¥æ—¶é—´æ®µå†…æ²¡æœ‰Bçš„é‡å‘è¯·æ±‚çš„è¯ï¼Œå°±è¿›å…¥CLOSEDçŠ¶æ€ï¼Œæ’¤é”€TCBã€‚å½“Bæ”¶åˆ°ç¡®è®¤åº”ç­”åï¼Œä¹Ÿä¾¿è¿›å…¥CLOSEDçŠ¶æ€ï¼Œæ’¤é”€TCBã€‚ TCPçš„å¯é ä¼ è¾“TCPé‡‡ç”¨äº†æ ¡éªŒå’Œã€è¿æ¥ç®¡ç†ã€åºåˆ—å·ã€ç¡®è®¤åº”ç­”ï¼Œé‡å‘æ§åˆ¶ã€æ»‘åŠ¨çª—å£åè®®ï¼ˆè¿ç»­ARQåè®®ã€æµæ§åˆ¶ã€æ‹¥å¡æ§åˆ¶ï¼‰ç­‰æœºåˆ¶æ¥ä¿è¯å®ƒçš„å¯é æ€§ã€‚ æ ¡éªŒå’ŒTCPå’ŒUDPæ ¡éªŒå’Œçš„æ–¹å¼ä¸€è‡´ï¼Œå¯ä»¥å‚ç…§å¦ä¸€ç¯‡åšå®¢â€”â€”UDPåè®® è¿æ¥ç®¡ç†å…¶å®å°±æ˜¯åˆ©ç”¨å»ºç«‹è¿æ¥æ—¶çš„ä¸‰æ¬¡æ¡æ‰‹æ¥æé«˜å¯é æ€§ã€‚ é€šè¿‡åºåˆ—å·ä¸ç¡®è®¤åº”ç­”åœ¨TCPä¸­ï¼Œå½“å‘é€ç«¯çš„æ•°æ®åˆ°è¾¾æ¥æ”¶ä¸»æœºæ—¶ï¼Œæ¥æ”¶ç«¯ä¸»æœºä¼šè¿”å›ä¸€ä¸ªæ”¶åˆ°æ¶ˆæ¯çš„é€šçŸ¥ï¼Œè¿™ä¸ªæ¶ˆæ¯å«åšç¡®è®¤åº”ç­”(ACK)ï¼Œæ¯”å¦‚å®¢æˆ·ç«¯å‘é€[æ•°æ®(1-1000)]ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯å°†ä¼šå›åº”[ç¡®è®¤åº”ç­”(ä¸‹ä¸€ä¸ªæ•°1001)]ã€‚åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰ç­‰åˆ°ç¡®è®¤åº”ç­”ï¼Œå‘é€ç«¯ä¼šè®¤ä¸ºæ•°æ®å·²ç»ä¸¢å¤±ï¼Œå¹¶è¿›è¡Œé‡å‘ã€‚ æ»‘åŠ¨çª—å£åè®®(è¿ç»­ARQåè®®)æ¦‚å¿µå…ˆç®€å•è¯´è¯´ARQ(Automatic Repeat reQuest)åè®®(è‡ªåŠ¨é‡ä¼ è¯·æ±‚åè®®)ï¼š å½“è¯·æ±‚å¤±è´¥æ—¶å®ƒä¼šè‡ªåŠ¨é‡ä¼ ï¼Œç›´åˆ°è¯·æ±‚è¢«æ­£ç¡®æ¥æ”¶ä¸ºæ­¢ã€‚è¿™ç§æœºåˆ¶ä¿è¯äº†æ¯ä¸ªåˆ†ç»„éƒ½èƒ½è¢«æ­£ç¡®æ¥æ”¶ã€‚ å†çœ‹è¿ç»­ARQåè®®ï¼šåœ¨ARQåè®®å‘é€è€…æ¯æ¬¡åªèƒ½å‘é€ä¸€ä¸ªåˆ†ç»„ï¼Œåœ¨åº”ç­”åˆ°æ¥å‰å¿…é¡»ç­‰å¾…ã€‚è€Œè¿ç»­ARQåè®®çš„å‘é€è€…æ‹¥æœ‰ä¸€ä¸ªå‘é€çª—å£ï¼Œå‘é€è€…å¯ä»¥åœ¨æ²¡æœ‰å¾—åˆ°åº”ç­”çš„æƒ…å†µä¸‹è¿ç»­å‘é€çª—å£ä¸­çš„åˆ†ç»„ã€‚ å‘é€çª—å£ å‘é€çª—å£çš„å¤§å°ç”±æ¥æ”¶çª—å£çš„å‰©ä½™å¤§å°å†³å®šã€‚æ¥æ”¶è€…ä¼šæŠŠå½“å‰æ¥æ”¶çª—å£çš„å‰©ä½™å¤§å°å†™å…¥åº”ç­”TCPæŠ¥æ–‡æ®µçš„å¤´éƒ¨ï¼Œå‘é€è€…æ”¶åˆ°åº”ç­”åæ ¹æ®è¯¥å€¼å’Œå½“å‰ç½‘ç»œæ‹¥å¡æƒ…å†µè®¾ç½®å‘é€çª—å£çš„å¤§å°ã€‚å‘é€çª—å£çš„å¤§å°æ˜¯ä¸æ–­å˜åŒ–çš„ã€‚ å‘é€çª—å£(p1-p3)ç”±ä¸‰ä¸ªæŒ‡é’ˆæ„æˆï¼š p1ï¼šp1æŒ‡å‘å‘é€çª—å£çš„åæ²¿ï¼Œå®ƒåé¢çš„å­—èŠ‚è¡¨ç¤ºå·²ç»å‘é€ä¸”å·²æ”¶åˆ°åº”ç­”ã€‚ p2ï¼šp2æŒ‡å‘å°šæœªå‘é€çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ã€‚p1-p2é—´çš„å­—èŠ‚è¡¨ç¤ºå·²ç»å‘é€ï¼Œä½†è¿˜æ²¡æ”¶åˆ°ç¡®è®¤åº”ç­”ã€‚è¿™éƒ¨åˆ†çš„å­—èŠ‚ä»éœ€ä¿ç•™ï¼Œå› ä¸ºå¯èƒ½è¿˜è¦è¶…æ—¶é‡å‘ã€‚p2-p3é—´çš„å­—èŠ‚è¡¨ç¤ºå¯ä»¥å‘é€ï¼Œä½†è¿˜æ²¡æœ‰å‘é€çš„å­—èŠ‚ã€‚ p3ï¼šp3æŒ‡å‘å‘é€çª—å£çš„å‰æ²¿ï¼Œå®ƒå‰é¢çš„å­—èŠ‚å°šæœªå‘é€ï¼Œä¸”ä¸å…è®¸å‘é€ã€‚ å‘é€è€…æ¯æ”¶åˆ°ä¸€ä¸ªåº”ç­”ï¼Œåæ²¿å°±å¯ä»¥å‘å‰ç§»åŠ¨æŒ‡å®šçš„å­—èŠ‚ã€‚æ­¤æ—¶è‹¥çª—å£å¤§å°ä»ç„¶æ²¡å˜ï¼Œå‰æ²¿ä¹Ÿå¯ä»¥å‘å‰ç§»åŠ¨æŒ‡å®šå­—èŠ‚ã€‚å½“p2å’Œå‰æ²¿é‡åˆæ—¶ï¼Œå‘é€è€…å¿…é¡»ç­‰å¾…ç¡®è®¤åº”ç­”ã€‚ æ¥æ”¶çª—å£ æ¥æ”¶è€…æ”¶åˆ°çš„å­—èŠ‚ä¼šå­˜å…¥æ¥æ”¶çª—å£ï¼Œæ¥æ”¶è€…ä¼šå¯¹å·²ç»æ­£ç¡®æ¥æ”¶çš„æœ‰åºå­—èŠ‚è¿›è¡Œç´¯è®¡ç¡®è®¤ï¼Œå‘é€å®Œç¡®è®¤åº”ç­”åï¼Œæ¥æ”¶çª—å£å°±å¯ä»¥å‘å‰ç§»åŠ¨æŒ‡å®šå­—èŠ‚ã€‚å¦‚æœæŸäº›å­—èŠ‚å¹¶æœªæŒ‰åºæ”¶åˆ°ï¼Œæ¥æ”¶è€…åªä¼šç¡®è®¤æœ€åä¸€ä¸ªæœ‰åºçš„å­—èŠ‚ï¼Œä»è€Œä¹±åºçš„å­—èŠ‚å°±ä¼šè¢«é‡æ–°å‘é€ã€‚ æµæ§åˆ¶æ¦‚å¿µè®©å‘é€ç«¯æ ¹æ®æ¥æ”¶ç«¯çš„å®é™…æ¥æ”¶èƒ½åŠ›æ§åˆ¶å‘é€çš„æ•°æ®é‡ã€‚ ç›®çš„é˜²æ­¢æ¥æ”¶ç«¯åœ¨é«˜è´Ÿè·çš„æƒ…å†µä¸‹æ¥æ”¶æ•°æ®ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™å¦‚æœæ¥æ”¶ç«¯ä¼šå°†æœ¬åº”è¯¥æ¥æ”¶çš„æ•°æ®ä¸¢å¼ƒï¼Œå°±åˆä¼šè§¦å‘é‡å‘æœºåˆ¶ï¼Œä»è€Œå¯¼è‡´ç½‘ç»œæµé‡çš„æ— ç«¯æµªè´¹ã€‚ å…·ä½“å®ç°æ¥æ”¶ç«¯ä¸»åŠ¨å‘å‘é€ç«¯ä¸»æœºé€šçŸ¥è‡ªå·±å¯ä»¥æ¥å—æ•°æ®çš„å¤§å°ï¼Œäºæ˜¯å‘é€ç«¯ä¼šå‘é€ä¸è¶…è¿‡è¿™ä¸ªé™åº¦çš„æ•°æ®ã€‚è¿™ä¸ªå¤§å°é™åº¦å°±æ˜¯æ¥æ”¶çª—å£å¤§å°ï¼Œæ‰€ä»¥æµæ§åˆ¶å°±æ˜¯åˆ©ç”¨æ»‘åŠ¨çª—å£åè®®å®ç°çš„ã€‚ æ­»é”é—®é¢˜å½“å‘é€è€…æ”¶åˆ°äº†ä¸€ä¸ªçª—å£ä¸º0çš„åº”ç­”ï¼Œå‘é€è€…ä¾¿åœæ­¢å‘é€ï¼Œç­‰å¾…æ¥æ”¶è€…çš„ä¸‹ä¸€ä¸ªåº”ç­”ã€‚ä½†æ˜¯å¦‚æœè¿™ä¸ªçª—å£ä¸ä¸º0çš„åº”ç­”åœ¨ä¼ è¾“è¿‡ç¨‹ä¸¢å¤±ï¼Œå‘é€è€…ä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œè€Œæ¥æ”¶è€…ä»¥ä¸ºå‘é€è€…å·²ç»æ”¶åˆ°è¯¥åº”ç­”ï¼Œç­‰å¾…æ¥æ”¶æ–°æ•°æ®ï¼Œè¿™æ ·åŒæ–¹å°±ç›¸äº’ç­‰å¾…ï¼Œä»è€Œäº§ç”Ÿæ­»é”ã€‚ä¸ºäº†é¿å…æ­¤ç±»é—®é¢˜çš„å‘ç”Ÿï¼Œå‘é€ç«¯ä¸»æœºä¼šæ—¶ä¸æ—¶å‘é€ä¸€ä¸ªå«åšçª—å£æ¢æµ‹çš„æ•°æ®æ®µï¼Œæ­¤æ•°æ®æ®µä»…å«ä¸€ä¸ªä»¥è·å–æœ€æ–°çª—å£çš„å¤§å°ä¿¡æ¯ã€‚ æ‹¥å¡æ§åˆ¶æ‹¥å¡æ§åˆ¶å’Œæµæ§åˆ¶çš„åŒºåˆ«ï¼Ÿ æ‹¥å¡æ§åˆ¶ï¼šæ‹¥å¡æ§åˆ¶æ˜¯ä½œç”¨äºç½‘ç»œçš„ï¼Œå®ƒæ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œé¿å…å‡ºç°ç½‘ç»œè´Ÿè½½è¿‡å¤§çš„æƒ…å†µ æµæ§åˆ¶ï¼šæµæ§åˆ¶æ˜¯ä½œç”¨äºæ¥æ”¶è€…çš„ï¼Œå®ƒæ˜¯æ§åˆ¶å‘é€è€…çš„å‘é€é€Ÿåº¦ä»è€Œä½¿æ¥æ”¶è€…æ¥å¾—åŠæ¥æ”¶ æ‹¥å¡æƒ…å†µè§‚å¯Ÿæ‹¥å¡çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šä¸€æ˜¯è¶…æ—¶ï¼ŒäºŒæ˜¯è¿ç»­æ¥æ”¶åˆ°3ä¸ªé‡å¤ACKã€‚ PSï¼šä¸ºä»€ä¹ˆæ˜¯3ä¸ªè¿ç»­çš„ACKï¼šç”±äºæˆ‘ä»¬ä¸çŸ¥é“ä¸€ä¸ªé‡å¤çš„ACKæ˜¯ç”±ä¸€ä¸ªä¸¢å¤±çš„æŠ¥æ–‡å¼•èµ·çš„ï¼Œè¿˜æ˜¯ç”±äºä»…ä»…å‡ºç°äº†å‡ ä¸ªæŠ¥æ–‡æ®µçš„é‡æ–°æ’åºå¼•èµ·çš„ï¼Œå› æ­¤æˆ‘ä»¬ç­‰å¾…å°‘é‡çš„é‡å¤çš„ACKåˆ°æ¥ã€‚å› ä¸ºè‹¥åªæ˜¯ä¸€äº›æŠ¥æ–‡æ®µçš„é‡æ–°æ’åºå¼•èµ·çš„ï¼Œä¸€èˆ¬åœ¨é‡æ–°æ’åºæŠ¥æ–‡æ®µå®Œæˆå¹¶äº§ç”Ÿä¸€ä¸ªæ–°çš„ACKä¹‹å‰åªå¯èƒ½äº§ç”Ÿ1-2ä¸ªé‡å¤çš„ACKã€‚ æ‹¥å¡çš„ä¸åŒå¤„ç†æ–¹å¼å¯¹äºç”±äºè¶…æ—¶é‡ä¼ è®¤ä¸ºçš„æ‹¥å¡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯é‡ä¼ æŠ¥æ–‡æ®µï¼Œç„¶åè¿›å…¥æ…¢å¯åŠ¨ç®—æ³•(ä¸‹æ–¹)ï¼›å¯¹äºç”±äºæ¥æ”¶åˆ°3ä¸ªé‡å¤çš„ACKè®¤ä¸ºçš„æ‹¥å¡ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ç«‹å³é‡ä¼ æŠ¥æ–‡æ®µï¼Œç„¶åè¿›å…¥æ‹¥å¡é¿å…ç®—æ³•(ä¸‹æ–¹)ã€‚è¿™æ ·å¤„ç†çš„åŸå› æ˜¯å› ä¸ºå½“å› ä¸ºå®šæ—¶å™¨è¶…æ—¶ï¼Œæ­¤æ—¶ç½‘ç»œä¸­å¯èƒ½å·²ç»å¾ˆæ‹¥å¡ï¼Œæ•°æ®ç¡®è®¤çš„ACKå·²ç»æ— æ³•å‘é€å›æ¥ï¼Œå› æ­¤æˆ‘ä»¬ç«‹å³å‡å°‘æ³¨å…¥ç½‘ç»œä¸­çš„æ•°æ®ï¼Œä½¿ç”¨æ…¢å¯åŠ¨æ‹¥å¡çª—å£å‡å°ä¸º1ï¼›è€Œå¯¹äºæ”¶åˆ°,3ä¸ªé‡å¤çš„ACKè¯´æ˜è¿˜æœ‰å…¶ä»–çš„æŠ¥æ–‡æ®µåˆ°è¾¾äº†ç›®çš„åœ°(å› ä¸ºæ¥æ”¶æ–¹åªæœ‰åœ¨æ”¶åˆ°å¤±åºçš„æŠ¥æ–‡æ®µæ—¶æ‰ä¼šäº§ç”Ÿé‡å¤çš„ACKè€Œä¸”è¿˜æœ‰é‡å¤çš„ACKå‘é€å›æ¥)ï¼Œä¹Ÿå³æ”¶å‘ä¸¤ç«¯è¿˜æœ‰æ•°æ®çš„æµåŠ¨ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…ä½¿ç”¨æ…¢å¯åŠ¨çªç„¶å‡å°‘æ³¨å…¥ç½‘ç»œçš„æ•°æ®ã€‚ æ…¢å¯åŠ¨ç®—æ³• å’Œ æ‹¥å¡é¿å…ç®—æ³•å‘é€æ–¹ç»´æŠ¤ä¸€ä¸ªå‘é€çª—å£ï¼Œå‘é€çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡æƒ…å†µ(æ‹¥å¡çª—å£)ï¼Œå‘é€çª—å£æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚å‘é€æ–¹è¿˜ç»´æŠ¤ä¸€ä¸ªæ…¢å¯åŠ¨é˜ˆå€¼ã€‚ å‘é€çª—å£ &lt; æ…¢å¯åŠ¨é˜ˆå€¼ï¼šä½¿ç”¨æ…¢å¯åŠ¨ç®—æ³•(æŒ‡æ•°çº§) å‘é€çª—å£ &gt; æ…¢å¯åŠ¨é˜ˆå€¼ï¼šä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•(çº¿æ€§åŠ ä¸€) å‘é€çª—å£ = æ…¢å¯åŠ¨é˜ˆå€¼ï¼šä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•æˆ–æ‹¥å¡é¿å…ç®—æ³• ç®—æ³•çš„å…·ä½“è¿‡ç¨‹ï¼š é€šä¿¡å¼€å§‹æ—¶ï¼Œä½¿ç”¨æ…¢å¯åŠ¨ç®—æ³•ï¼Œå‘é€æ–¹çš„å‘é€çª—å£è®¾ä¸º1ï¼Œå¹¶å‘é€ç¬¬ä¸€ä¸ªåˆ†ç»„M1ï¼› æ¥æ”¶æ–¹æ”¶åˆ°M1åï¼Œè¿”å›ç¡®è®¤åº”ç­”ï¼Œæ­¤æ—¶å‘é€æ–¹å‘é€çª—å£æ‰©å¤§ä¸¤å€ï¼Œå¹¶å‘é€M2ã€M3ï¼›ï¼ˆå³ï¼Œå‘é€æ–¹æ¯æ¬¡æ”¶åˆ°ç¡®è®¤åº”ç­”åï¼Œéƒ½å°†å‘é€çª—å£è®¾ä¸ºå½“å‰å€¼çš„ä¸¤å€ï¼‰ è‹¥å‘é€çª—å£&gt;æ…¢å¯åŠ¨é˜ˆå€¼ï¼Œåˆ™ä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•ï¼Œæ¯æ¬¡æ”¶åˆ°ç¡®è®¤åº”ç­”åéƒ½å°†å‘é€çª—å£+1ï¼› è‹¥å‘é€æ–¹å‡ºç°äº†è¶…æ—¶é‡ä¼ ï¼Œåˆ™è¡¨æ˜ç½‘ç»œå‡ºç°æ‹¥å¡ï¼Œæ­¤æ—¶ï¼š æ…¢å¯åŠ¨é˜ˆå€¼è®¾ä¸ºå½“å‰å‘é€çª—å£çš„ä¸€åŠï¼› å‘é€çª—å£è®¾ä¸º1ï¼› å¯ç”¨æ‹¥å¡é¿å…ç®—æ³•ï¼› PSï¼šå‘é€è¶…æ—¶é‡ä¼ æ—¶ï¼Œå‘é€çª—å£æœ‰å¯èƒ½å·²ç»è¶…è¿‡äº†æ…¢å¼€å§‹é—¨é™ï¼Œä¹Ÿæœ‰å¯èƒ½è¿˜æ²¡è¶…è¿‡ï¼›æ­¤æ—¶ä¸ç®¡ä½•ç§æƒ…å†µï¼Œéƒ½ä¸€å¾‹å¯ç”¨æ‹¥å¡é¿å…ç®—æ³•ï¼Œå¹¶æ‰§è¡Œä¸Šè¿°ä¸‰æ­¥æ“ä½œï¼ æ…¢å¼€å§‹ç®—æ³•çš„ä½œç”¨ï¼šæ…¢å¼€å§‹ç®—æ³•å°†å‘é€çª—å£ä»å°æ‰©å¤§ï¼Œè€Œä¸”æŒ‰æŒ‡æ•°çº§æ‰©å¤§ï¼Œä»è€Œé¿å…ä¸€å¼€å§‹å°±å¾€ç½‘ç»œä¸­æ³¨å…¥è¿‡å¤šçš„åˆ†ç»„ä»è€Œå¯¼è‡´æ‹¥å¡ï¼›å®ƒå°†çª—å£æ…¢æ…¢æ‰©å¤§çš„è¿‡ç¨‹å…¶å®ä¹Ÿåœ¨æ¢æµ‹ç½‘ç»œæ‹¥å¡æƒ…å†µçš„è¿‡ç¨‹ï¼Œå½“å‘ç°å‡ºç°æ‹¥å¡æ—¶ï¼ŒåŠæ—¶é™ä½å‘é€é€Ÿåº¦ï¼Œä»è€Œå‡ç¼“ç½‘ç»œæ‹¥å¡ã€‚ æ‹¥å¡é¿å…ç®—æ³•çš„ä½œç”¨ï¼šæ‹¥å¡é¿å…ç®—æ³•ä½¿å‘é€çª—å£ä»¥çº¿æ€§æ–¹å¼å¢é•¿ï¼Œè€ŒéæŒ‡æ•°çº§å¢é•¿ï¼Œä»è€Œä½¿ç½‘ç»œæ›´åŠ ä¸å®¹æ˜“å‘ç”Ÿæ‹¥å¡ã€‚ å¿«é‡ä¼ å’Œå¿«æ¢å¤å½“å› æ”¶åˆ°ä¸‰ä¸ªåŠä¸‰ä¸ªä»¥ä¸Šçš„é‡å¤ACKæ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹æ‹¥å¡æ§åˆ¶æ–¹æ³•ï¼š æ”¶åˆ°3ä¸ªé‡å¤çš„ACKï¼Œå°†æ…¢å¯åŠ¨é˜ˆå€¼è®¾ä¸ºå½“å‰æ‹¥å¡çª—å£å¤§å°çš„ä¸€åŠ æ­¤æ—¶ç«‹å³é‡ä¼ ä¸¢å¤±çš„æŠ¥æ–‡ä¸ç”¨ç­‰åˆ°å®šæ—¶å™¨è¶…æ—¶(è¶…æ—¶é‡ä¼ )ï¼Œæ­¤ä¸ºå¿«é‡ä¼ ã€‚ æ­¤åå¼€å§‹æ‰§è¡Œæ‹¥å¡é¿å…è€Œä¸æ˜¯æ…¢å¯åŠ¨ï¼Œæ­¤ä¸ºå¿«æ¢å¤ã€‚ TCPçš„åº”ç”¨å½“å¯¹ç½‘ç»œé€šè®¯è´¨é‡æœ‰è¦æ±‚çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼šæ•´ä¸ªæ•°æ®è¦å‡†ç¡®æ— è¯¯çš„ä¼ é€’ç»™å¯¹æ–¹ï¼Œè¿™å¾€å¾€ç”¨äºä¸€äº›è¦æ±‚å¯é çš„åº”ç”¨ã€‚å¸¸è§çš„ä½¿ç”¨UDPåè®®çš„åº”ç”¨å¦‚ä¸‹ï¼š HTTP(è¶…æ–‡æœ¬ä¼ è¾“åè®®) FTP(æ–‡ä»¶ä¼ è¾“åè®®) POPã€SMTP(é‚®ä»¶ä¼ è¾“åè®®) Telnetã€Telnet(è¿œç¨‹è¿æ¥åè®®) QQæ–‡ä»¶ä¼ è¾“ å‚è€ƒ è®¡ç®—æœºç½‘ç»œä¼ è¾“å±‚çŸ¥è¯†ç‚¹å…¨è¦†ç›– TCPåè®®è¯¦è§£â€”å­¦ä¹ ç¬”è®° TCPåè®®]]></content>
      <categories>
        <category>è®¡ç®—æœºç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>TCP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UDPåè®®]]></title>
    <url>%2F2018%2F05%2F17%2F%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%2FUDP%E5%8D%8F%E8%AE%AE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šUDPä½œä¸ºä¼ è¾“å±‚çš„ä¸€å¤§åè®®ï¼Œè™½ç„¶æ²¡æœ‰TCPå¯é ï¼Œä½†æ˜¯å´èƒœåœ¨ç®€å•ã€‚ UDPè®¤è¯†UDP(ç”¨æˆ·æ•°æ®æŠ¥åè®®) æ˜¯ä¸€ç§ç®€å•çš„é¢å‘æ•°æ®æŠ¥ã€æ— è¿æ¥ã€ä¼ è¾“å±‚åè®®ï¼Œå¹¶ä¸”ä¿ç•™äº†ä¿¡æ¯è¾¹ç•Œã€‚UDPä¸æä¾›é”™è¯¯æ ¡æ­£ï¼Œä¸ä¿è¯æœ‰åºï¼Œæ— æ³•å»é‡å¤ï¼Œæ²¡æœ‰æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶ï¼Œä¸èƒ½ä¿è¯æ•°æ®ä¸€å®šåˆ°è¾¾ç›®çš„åœ°ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æ ¡éªŒå’Œæä¾›é”™è¯¯ä¾¦æµ‹ã€‚UDPæä¾›çš„çš„æ˜¯ä¸å¯é ä¼ è¾“ï¼Œå› æ­¤è¦æœ‰åº”ç”¨å±‚æ¥æä¾›è¿™äº›åŠŸèƒ½ã€‚ UDPç‰¹ç‚¹ UDPåªåœ¨IPæ•°æ®æŠ¥æœåŠ¡çš„åŸºç¡€ä¸Šå¢åŠ äº†å°‘é‡çš„åŠŸèƒ½ï¼šåˆ©ç”¨ç«¯å£å·æ˜¯å®ç°åˆ†ç”¨ã€å¯¹æ•´ä¸ªæŠ¥æ–‡çš„å·®é”™æ£€æµ‹ã€‚ UDPæ˜¯æ— è¿æ¥çš„ï¼Œé€šä¿¡å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œé€šä¿¡ç»“æŸä¹Ÿæ— éœ€é‡Šæ”¾è¿æ¥ã€‚ UDPæ˜¯ä¸å¯é çš„ å®ƒæ˜¯å°½åŠ›è€Œä¸ºäº¤ä»˜ï¼Œä¸èƒ½ç¡®ä¿æ¯ä¸€ä¸ªæ•°æ®æŠ¥éƒ½é€è¾¾ã€‚ UDPæ˜¯é¢å‘æŠ¥æ–‡çš„ï¼Œé¢å‘æŠ¥æ–‡å°±æ˜¯æŒ‡ï¼šUDPæ•°æ®ä¼ è¾“çš„å•ä½æ˜¯æŠ¥æ–‡ï¼Œä¸”ä¸ä¼šå¯¹æ•°æ®ä½œä»»ä½•æ‹†åˆ†å’Œæ‹¼æ¥ æ“ä½œã€‚åœ¨å‘é€ç«¯ï¼Œåº”ç”¨ç¨‹åºç»™ä¼ è¾“å±‚çš„UDPä»€ä¹ˆæ ·çš„æ•°æ®ï¼ŒUDPä¸ä¼šå¯¹æ•°æ®è¿›è¡Œåˆ‡åˆ†ï¼Œåªå¢åŠ ä¸€ä¸ªUDPå¤´å¹¶äº¤ç»™ç½‘ç»œå±‚ã€‚åœ¨æ¥æ”¶ç«¯ï¼ŒUDPæ”¶åˆ°ç½‘ç»œå±‚çš„æ•°æ®æŠ¥åï¼Œå»é™¤IPæ•°æ®æŠ¥å¤´éƒ¨åéäº¤ç»™åº”ç”¨å±‚ï¼Œä¸ä¼šä½œä»»ä½•æ‹¼æ¥æ“ä½œã€‚ ç›¸æ¯”äºTCPï¼ŒUDPæ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼ŒUDPå§‹ç»ˆä»¥æ’å®šçš„é€Ÿç‡å‘é€æ•°æ®ï¼Œå¹¶ä¸ä¼šæ ¹æ®ç½‘ç»œæ‹¥å¡æƒ…å†µå¯¹å‘é€é€Ÿç‡ä½œè°ƒæ•´ã€‚è¿™ç§æ–¹å¼æœ‰åˆ©æœ‰å¼Šã€‚å¼Šç«¯ï¼šç½‘ç»œæ‹¥å¡æ—¶æœ‰äº›æŠ¥æ–‡å¯èƒ½ä¼šä¸¢å¤±ï¼Œå› æ­¤UDPä¸å¯é ã€‚ä¼˜ç‚¹ï¼šæœ‰äº›ä½¿ç”¨åœºæ™¯å…è®¸æŠ¥æ–‡ä¸¢å¤±ï¼Œå¦‚ï¼šç›´æ’­ã€è¯­éŸ³é€šè¯ï¼Œä½†å¯¹å®æ—¶æ€§è¦æ±‚å¾ˆé«˜ï¼Œæ­¤æ—¶UDPè¿˜æ˜¯å¾ˆæœ‰ç”¨æ­¦ä¹‹åœ°çš„ã€‚ UDPæ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šã€å¤šå¯¹ä¸€é€šä¿¡ï¼›è€ŒTCPåªæ”¯æŒä¸€å¯¹ä¸€é€šä¿¡ã€‚ UDPé¦–éƒ¨å¼€é”€å°ï¼Œåªæœ‰8å­—èŠ‚ã€‚è€ŒTCPå¤´éƒ¨è‡³å°‘ç”±20å­—èŠ‚ï¼Œç›¸æ¯”äºTCPè¦é«˜æ•ˆå¾ˆå¤šã€‚ UDPæ•°æ®åŒ…é¦–éƒ¨ UDPæ•°æ®åŒ…é¦–éƒ¨è§£æ 16ä½æºç«¯å£å·ï¼šå‘é€ç«¯åº”ç”¨ç¨‹åºä½¿ç”¨çš„ç«¯å£å·ï¼Œç”¨äºåŒºåˆ†æ•°æ®æŠ¥æ¥è‡ªå“ªä¸ªè¿›ç¨‹ï¼Œå¤šè·¯å¤ç”¨ä¸€ä¸ªä¼ è¾“å±‚ï¼ˆå¤ç”¨ï¼šåœ¨å‘é€ç«¯ï¼Œå¤šä¸ªåº”ç”¨è¿›ç¨‹å…¬ç”¨ä¸€ä¸ªä¼ è¾“å±‚ï¼‰ã€‚ 16ä½ç›®çš„ç«¯å£å·ï¼šæ•°æ®é€å¾€æ¥æ”¶ç«¯å“ªä¸ªåº”ç”¨ç¨‹åºï¼Œåˆ©ç”¨ç«¯å£å·å®ç°å¤šè·¯åˆ†ç”¨ï¼ˆåˆ†ç”¨ï¼šåœ¨æ¥æ”¶ç«¯ï¼Œä¼ è¾“å±‚ä¼šæ ¹æ®ç«¯å£å·å°†æ•°æ®åˆ†æ´¾ç»™ä¸åŒçš„åº”ç”¨è¿›ç¨‹ï¼‰ã€‚ 16ä½UDPé•¿åº¦ï¼šUDPæ•°æ®æŠ¥é¦–éƒ¨å’ŒUDPæ•°æ®æŠ¥æ•°æ®éƒ¨åˆ†æ€»å­—èŠ‚æ•°ï¼Œæœ€å°å€¼ä¸º8å­—èŠ‚(ä»…æœ‰é¦–éƒ¨)ï¼Œæœ€å¤§å€¼ä¸º65535å­—èŠ‚ã€‚ 16ä½UDPæ£€éªŒå’Œï¼šUDPçš„æ ¡éªŒå’Œæ˜¯å¯é€‰çš„ï¼ŒTCPæ˜¯å¿…éœ€çš„ã€‚UDPçš„æ ¡éªŒå’Œè¦†ç›–é¦–éƒ¨åŠæ•°æ®éƒ¨åˆ†ã€‚åœ¨ä¸‹ä¸€èŠ‚ã€‚ æ•°æ®ï¼šè¦å‘é€çš„æ•°æ®ï¼Œå¯ä»¥ä¸ºç©º(0å­—èŠ‚)ã€‚ UDPæ£€éªŒå’ŒUDPæ ¡éªŒå’Œçš„å†…å®¹è¶…å‡ºäº†UDPæ•°æ®æŠ¥æ–‡æœ¬èº«çš„èŒƒå›´ï¼Œå®é™…ä¸Šï¼Œå®ƒçš„å€¼æ˜¯é€šè¿‡è®¡ç®—UDPæ•°æ®æŠ¥åŠä¸€ä¸ªä¼ªåŒ…å¤´è€Œå¾—åˆ°çš„ã€‚æ ¡éªŒå’Œçš„è®¡ç®—æ–¹æ³•ä¸é€šç”¨çš„ä¸€æ ·ï¼Œéƒ½æ˜¯ç´¯åŠ æ±‚å’Œã€‚å®ƒçš„æ ¡éªŒå’Œçš„æ£€éªŒèŒƒå›´å¦‚ä¸‹å›¾ï¼š ä¼ªé¦–éƒ¨å¹¶éUDPæ•°æ®æŠ¥ä¸­å®é™…çš„æœ‰æ•ˆæˆåˆ†ã€‚ä¼ªé¦–éƒ¨æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­çš„ä¿¡æ¯æ˜¯ä»æ•°æ®æŠ¥æ‰€åœ¨IPåˆ†ç»„å¤´çš„åˆ†ç»„å¤´ä¸­æå–çš„ï¼Œæ—¢ä¸å‘ä¸‹ä¼ é€ä¹Ÿä¸å‘ä¸Šé€’äº¤ï¼Œè€Œä»…ä»…æ˜¯ä¸ºè®¡ç®—æ ¡éªŒå’Œã€‚è¿™æ ·çš„æ ¡éªŒå’Œï¼Œæ—¢æ ¡éªŒäº†UDPç”¨æˆ·æ•°æ®çš„æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ä»¥åŠUDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ï¼Œåˆæ£€éªŒäº†IPæ•°æ®æŠ¥çš„æºIPåœ°å€å’Œç›®çš„IPåœ°å€ã€‚ä¼ªæŠ¥å¤´ä¿è¯UDPæ•°æ®å•å…ƒåˆ°è¾¾æ­£ç¡®çš„ç›®çš„åœ°å€ã€‚ æ ¡éªŒæ–¹å¼ï¼š ã€ŠTCP/IP è¯¦è§£ã€‹å·ä¸€ ç¬¬ä¸€ç‰ˆä¸­å¦‚ä¸‹è®¡ç®—æ£€éªŒå’Œå­—æ®µçš„å€¼ï¼š å‘é€æ–¹è®¡ç®—UDPæ£€éªŒå’Œï¼šé¦–å…ˆæŠŠæ£€éªŒå’Œå­—æ®µç½®ä¸º0ï¼ŒæŠŠä¸Šå›¾ä¸­,å„éƒ¨åˆ†æ•°æ®(åŒ…æ‹¬UDPä¼ªé¦–éƒ¨åŠå¡«å……å­—æ®µ)æŒ‰æ¯16bitè¿›è¡ŒäºŒè¿›åˆ¶åç æ±‚å’Œ(è‹¥æœ€é«˜ä½äº§ç”Ÿè¿›ä½å°±åŠ åˆ°æœ€ä½ä½ä¸Šå»)ï¼Œæ‰€æ±‚ç»“æœå°±æ˜¯16bitUDPæ£€éªŒå’Œå­—æ®µçš„å€¼ã€‚ æ¥æ”¶æ–¹è®¡ç®—UDPæ£€éªŒå’Œï¼šå¯¹æ”¶åˆ°çš„UDPæ•°æ®æŠ¥(åŠ ä¸Šäº†UDPé¦–éƒ¨å’Œå¡«å……å­—èŠ‚)æŒ‰æ¯16bitè¿›è¡ŒäºŒè¿›åˆ¶åç æ±‚å’Œ(è‹¥æœ€é«˜ä½äº§ç”Ÿè¿›ä½å°±åŠ åˆ°æœ€ä½ä½ä¸Šå»)ï¼Œè‹¥ç»“æœä¸ºå…¨1ï¼Œåˆ™UDPæ•°æ®æŠ¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰å‡ºç°å·®é”™ï¼Œå¦åˆ™æ•°æ®æŠ¥æœ‰å·®é”™ã€‚ ã€ŠTCP/IP è¯¦è§£ã€‹å·ä¸€ ç¬¬äºŒç‰ˆä¸­å¦‚ä¸‹è®¡ç®—æ£€éªŒå’Œå­—æ®µçš„å€¼ï¼š å‘é€æ–¹è®¡ç®—UDPæ£€éªŒå’Œï¼šé¦–å…ˆæŠŠæ£€éªŒå’Œå­—æ®µç½®ä¸º0ï¼ŒæŠŠä¸Šå›¾ä¸­,å„éƒ¨åˆ†æ•°æ®(åŒ…æ‹¬UDPä¼ªé¦–éƒ¨åŠå¡«å……å­—æ®µ)æŒ‰æ¯16bitè¿›è¡ŒäºŒè¿›åˆ¶åç æ±‚å’Œ(è‹¥æœ€é«˜ä½äº§ç”Ÿè¿›ä½å°±åŠ åˆ°æœ€ä½ä½ä¸Šå»)ï¼Œæœ€åç»“æœå†æŒ‰ä½å–åï¼Œæ‰€å¾—ç»“æœå°±æ˜¯16bitUDPæ£€éªŒå’Œå­—æ®µçš„å€¼ã€‚ æ¥æ”¶æ–¹è®¡ç®—UDPæ£€éªŒå’Œï¼šå¯¹æ”¶åˆ°çš„UDPæ•°æ®æŠ¥(åŠ ä¸Šäº†UDPé¦–éƒ¨å’Œå¡«å……å­—èŠ‚)æŒ‰æ¯16bitè¿›è¡ŒäºŒè¿›åˆ¶åç æ±‚å’Œ(è‹¥æœ€é«˜ä½äº§ç”Ÿè¿›ä½å°±åŠ åˆ°æœ€ä½ä½ä¸Šå»)ï¼Œå†æŒ‰ä½å–åï¼Œè‹¥ç»“æœä¸ºå…¨0ï¼Œåˆ™UDPæ•°æ®æŠ¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰å‡ºç°å·®é”™ï¼Œå¦åˆ™æ•°æ®æŠ¥æœ‰å·®é”™ã€‚å› ä¸ºæ£€éªŒå’Œçš„å€¼ä»ä¸ä¸º0xFFFF UDPæœåŠ¡å™¨ä¸‰ç±»åœ°å€ç»‘å®š æœ¬åœ°åœ°å€ è¿œç«¯åœ°å€ æè¿° LocalIP:Lport ForeignIP:Fport åªé™äºä¸€ä¸ªå®¢æˆ· LocalIP:Lport *:* åªé™äºä¸€ä¸ªæœ¬åœ°IPå’Œç«¯å£çš„æ•°æ®åŒ… *:port *:* æ¥æ”¶å‘é€åˆ°Lportçš„æ‰€æœ‰æ•°æ®åŒ… ç¬¬ä¸€è¡Œä¸­æœåŠ¡å™¨é™å®šäº†åªä»æœ¬åœ°Localè¿™ä¸ªIPåœ°å€çš„Lportç«¯å£æ¥æ”¶æ•°æ®æŠ¥ï¼Œè€Œä¸”åªæ¥æ”¶æ¥è‡ªIPä¸ºForeignä¸”ç«¯å£ä¸ºFportå‘æ¥çš„æ•°æ®ã€‚ ç¬¬äºŒè¡Œä¸­æœåŠ¡å™¨é™å®šäº†åªä»æœ¬åœ°LocalIPè¿™ä¸ªIPåœ°å€çš„Lportç«¯å£æ¥æ”¶æ•°æ®æŠ¥ï¼Œä½†å¯ä»¥æ¥æ”¶ä»»ä½•ä¸»æœºå‘é€çš„æ•°æ®ã€‚ ç¬¬ä¸‰è¡Œä¸­æœåŠ¡å™¨åªé™å®šäº†æ¥æ”¶æ•°æ®çš„ç«¯å£å·ï¼Œå› æ­¤ä»»ä½•ä¸€ä¸ªæœ¬åœ°æ¥å£IPéƒ½å¯ä»¥æ¥æ”¶å®ƒï¼Œè€Œä¸”æ•°æ®å¯ä»¥æ¥è‡ªä»»ä½•ä¸»æœºå‘é€çš„æ•°æ®ã€‚ UDPçš„åº”ç”¨å½“å¯¹ç½‘ç»œé€šè®¯è´¨é‡è¦æ±‚ä¸é«˜çš„æ—¶å€™ï¼Œè¦æ±‚ç½‘ç»œé€šè®¯é€Ÿåº¦èƒ½å°½é‡çš„å¿«ï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨UDPã€‚å¸¸è§çš„ä½¿ç”¨UDPåè®®çš„åº”ç”¨å¦‚ä¸‹ï¼š QQè¯­è¨€å’Œè§†é¢‘ DNS(åŸŸåæœåŠ¡å™¨) NFS(ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ) TFTP(æ™®é€šæ–‡ä»¶ä¼ è¾“åè®®) å‚è€ƒ UDPåè®® UDPåè®®çš„åº”ç”¨]]></content>
      <categories>
        <category>è®¡ç®—æœºç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>UDP</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®åº“äº‹åŠ¡]]></title>
    <url>%2F2018%2F05%2F11%2F%E6%95%B0%E6%8D%AE%E5%BA%93%2F%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ•°æ®åº“äº‹åŠ¡åœ¨æ•°æ®åº“æ“ä½œä¸­æ˜¯ååˆ†é‡è¦çš„ï¼Œå› ä¸ºå®ƒè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¿™æ ·æ‰èƒ½ä¿è¯æ•°æ®åº“çš„æ•°æ®çš„å®Œæ•´æ€§ä¸ä¸€è‡´æ€§ã€‚ ä»€ä¹ˆæ˜¯äº‹åŠ¡æ„æˆå•ä¸€é€»è¾‘å·¥ä½œå•å…ƒçš„æ“ä½œé›†åˆã€‚ äº‹åŠ¡æ˜¯è®¿é—®å¹¶å¯èƒ½æ›´æ–°å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒï¼Œäº‹åŠ¡é€šå¸¸ç”¨å½¢å¦‚begin transaction å’Œ end transactionæ¥ç•Œå®šï¼Œäº‹åŠ¡ç”±å®ƒä»¬ä¹‹é—´æ‰§è¡Œçš„å…¨ä½“æ“ä½œç»„æˆã€‚ ä¸¾ä¸ªä¾‹å­ï¼šå°†é’±ä»ä¸€ä¸ªè´¦æˆ·è½¬åˆ°å¦ä¸€ä¸ªè´¦æˆ·å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè¯¥äº‹åŠ¡åŒ…æ‹¬åˆ†åˆ«å¯¹ä¸¤ä¸ªè´¦æˆ·çš„æ›´æ–°ã€‚ ACIDç‰¹æ€§ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ½æ­£ç¡®æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ½ä¸æ‰§è¡Œã€‚ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡å¼€å§‹å‰å’Œäº‹åŠ¡ç»“æŸåï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§çº¦æŸæ²¡æœ‰è¢«ç ´åã€‚æ¯”å¦‚ä¸Šé¢è½¬è´¦ä¾‹å­ä¸­ï¼Œä¸¤ä¸ªè´¦æˆ·çš„æ€»é‡‘é¢å°±æ˜¯å®Œæ•´æ€§çº¦æŸï¼Œå› ä¸ºä»–ä»¬çš„æ€»é‡‘é¢æ˜¯ä¸å˜çš„ã€‚ä½†æ˜¯åœ¨å¹¶å‘äº‹åŠ¡ä¸­ï¼Œä¸€è‡´æ€§å¾ˆå®¹æ˜“è¢«ç ´åï¼Œéœ€è¦æˆ‘ä»¬ç‰¹åˆ«æ³¨æ„ã€‚ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šäº‹åŠ¡çš„æ‰§è¡Œæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå®ƒä»¬ä¸ä¼šç›¸äº’å¹²æ‰°ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸ä¼šçœ‹åˆ°å¦ä¸€ä¸ªæ­£åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„äº‹åŠ¡çš„æ•°æ®ã€‚ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡ç»“æŸåï¼Œäº‹åŠ¡çš„ç»“æœå¿…é¡»æ˜¯æ°¸ä¹…ä¿å­˜çš„ã€‚å³ä½¿æ•°æ®åº“å‘ç”Ÿå´©æºƒï¼Œåœ¨æ•°æ®åº“æ¢å¤åäº‹åŠ¡æäº¤çš„ç»“æœä»ç„¶ä¸ä¼šä¸¢å¤±ã€‚ ç¡®ä¿éš”ç¦»æ€§æœ‰å¯èƒ½å¯¹ç³»ç»Ÿæ€§èƒ½é€ æˆè¾ƒå¤§çš„ä¸åˆ©å½±å“ï¼Œç”±äºè¿™ä¸ªåŸå› ï¼Œä¸€äº›åº”ç”¨åœ¨éš”ç¦»æ€§ä¸Šé‡‡å–ä¸€äº›å¦¥åã€‚ äº‹åŠ¡çš„åˆ†ç±» æ‰å¹³äº‹åŠ¡(Flat Transactions)ï¼šå®ƒæ˜¯å®é™…ç”Ÿäº§ç¯å¢ƒä¸­æœ€å¸¸ç”¨ã€æœ€ç®€å•çš„äº‹åŠ¡ç±»å‹ã€‚åœ¨æ‰å¹³äº‹åŠ¡ä¸­ï¼Œæ‰€æœ‰æ“ä½œéƒ½å¤„äºåŒä¸€å±‚æ¬¡ï¼Œå…¶ç”±begin transactionå¼€å§‹ï¼Œcommitæˆ–rollbackç»“æŸï¼Œå…¶é—´çš„æ“ä½œæ˜¯åŸå­çš„ï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½å›æ»šï¼Œå› æ­¤æ‰å¹³äº‹åŠ¡æ˜¯åº”ç”¨ç¨‹åºç§°ä¸ºåŸå­æ“ä½œçš„çš„åŸºæœ¬ç»„æˆæ¨¡å—ã€‚ä½†æ˜¯å‘ç”Ÿé”™è¯¯æ—¶éƒ½éœ€è¦å›æ»šåˆ°äº‹åŠ¡çš„èµ·å§‹ä½ç½®ï¼Œæ— æ³•å›æ»šéƒ¨åˆ†æ“ä½œï¼Œæ‰€ä»¥å›æ»šå¼€é”€å¤ªå¤§ã€‚ å¸¦æœ‰ä¿å­˜ç‚¹çš„æ‰å¹³äº‹åŠ¡(Flat Transactions with Savepoints)ï¼š é™¤äº†æ”¯æŒæ‰å¹³äº‹åŠ¡æ”¯æŒçš„æ“ä½œå¤–ï¼Œå…è®¸åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å›æ»šåŒä¸€äº‹åŠ¡ä¸­è¾ƒæ—©çš„ä¸€ä¸ªçŠ¶æ€ã€‚è¿™æ˜¯å› ä¸ºæŸäº›äº‹åŠ¡å¯èƒ½åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°çš„é”™è¯¯å¹¶ä¸ä¼šå¯¼è‡´æ‰€æœ‰çš„æ“ä½œéƒ½æ— æ•ˆï¼Œæ”¾å¼ƒæ•´ä¸ªäº‹åŠ¡ä¸åˆä¹è¦æ±‚ï¼Œå¼€é”€å¤ªå¤§ï¼Œä¿å­˜ç‚¹ç”¨æ¥é€šçŸ¥äº‹åŠ¡ç³»ç»Ÿåº”è¯¥è®°ä½äº‹åŠ¡å½“å‰çš„çŠ¶æ€ï¼Œä»¥ä¾¿å½“ä¹‹åå‘ç”Ÿé”™è¯¯æ—¶ï¼Œäº‹åŠ¡èƒ½å›åˆ°ä¿å­˜ç‚¹å½“æ—¶çš„çŠ¶æ€ã€‚ é“¾äº‹åŠ¡(Chained Transactions)ï¼šåœ¨æäº¤ä¸€ä¸ªäº‹åŠ¡æ—¶ï¼Œé‡Šæ”¾ä¸éœ€è¦çš„æ•°æ®å¯¹è±¡ï¼Œå°†å¿…è¦çš„å¤„ç†ä¸Šä¸‹æ–‡éšå¼åœ°ä¼ ç»™ä¸‹ä¸€ä¸ªè¦å¼€å§‹çš„äº‹åŠ¡ï¼Œæäº¤äº‹åŠ¡æ“ä½œå’Œå¼€å§‹ä¸‹ä¸€ä¸ªäº‹åŠ¡æ“ä½œ å°†åˆå¹¶ä¸ºä¸€ä¸ªåŸå­æ“ä½œï¼Œè¿™æ„å‘³ç€ä¸‹ä¸€ä¸ªäº‹åŠ¡å°†çœ‹åˆ°ä¸Šä¸€ä¸ªäº‹åŠ¡çš„ç»“æœï¼Œå°±å¥½åƒä¸€ä¸ªäº‹åŠ¡ä¸­è¿›è¡Œçš„ä¸€æ ·ã€‚å’Œå¸¦æœ‰ä¿å­˜ç‚¹çš„æ‰å¹³äº‹åŠ¡ä¸åŒçš„æ˜¯ï¼Œå¸¦æœ‰ä¿å­˜ç‚¹çš„æ‰å¹³äº‹åŠ¡èƒ½å›æ»šåˆ°ä»»æ„æ­£ç¡®çš„ä¿å­˜ç‚¹ï¼Œè€Œé“¾äº‹åŠ¡ä¸­çš„å›æ»šä»…é™å½“å‰äº‹åŠ¡ï¼Œå³åªèƒ½æ¢å¤åˆ°æœ€è¿‘çš„ä¸€ä¸ªä¿å­˜ç‚¹ã€‚ åµŒå¥—äº‹åŠ¡(Nested Transactions)ï¼šç”±ä¸€ä¸ªé¡¶å±‚äº‹åŠ¡(top-level transaction)æ§åˆ¶ç€å„ä¸ªå±‚æ¬¡çš„äº‹åŠ¡ï¼Œé¡¶å±‚äº‹åŠ¡ä¹‹ä¸‹åµŒå¥—çš„äº‹åŠ¡è¢«ç§°ä¸ºå­äº‹åŠ¡ã€‚åµŒå¥—äº‹åŠ¡æ˜¯ç”±è‹¥å¹²äº‹åŠ¡ç»„æˆçš„ä¸€æ£µæ ‘ï¼Œå­æ ‘æ—¢å¯ä»¥æ˜¯åµŒå¥—äº‹åŠ¡ä¹Ÿå¯ä»¥æ˜¯æ‰å¹³äº‹åŠ¡ï¼Œå¤„åœ¨å¶èŠ‚ç‚¹çš„äº‹åŠ¡æ˜¯æ‰å¹³äº‹åŠ¡ï¼Œä½†æ˜¯æ¯ä¸ªäº‹åŠ¡ä»æ ¹åˆ°å¶èŠ‚ç‚¹çš„è·ç¦»å¯ä»¥è¯´æ˜¯ä¸åŒçš„ã€‚å­äº‹åŠ¡æ—¢å¯ä»¥æäº¤ä¹Ÿå¯ä»¥å›æ»šã€‚ä½†æ˜¯å®ƒçš„æäº¤æ“ä½œå¹¶ä¸é©¬ä¸Šç”Ÿæ•ˆã€‚é™¤éå…¶çˆ¶äº‹åŠ¡å·²ç»æäº¤ã€‚æ ‘ä¸­çš„ä»»æ„äº‹åŠ¡å›æ»šä¼šå¼•èµ·å®ƒçš„æ‰€æœ‰å­äº‹åŠ¡ä¸€åŒå›æ»šï¼Œæ•…å­äº‹åŠ¡ä»…ä¿ç•™ACIç‰¹æ€§è€Œä¸å…·æœ‰Dç‰¹æ€§ã€‚ åˆ†å¸ƒå¼äº‹åŠ¡(Distributed Transactions)ï¼šé€šå¸¸æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç¯å¢ƒä¸‹è¿è¡Œçš„æ‰å¹³äº‹åŠ¡ï¼Œå› æ­¤éœ€è¦æ ¹æ®æ•°æ®æ‰€åœ¨ä½ç½®è®¿é—®ç½‘ç»œä¸­çš„ä¸åŒèŠ‚ç‚¹ã€‚ æ•°æ®åº“å¹¶å‘è®¿é—®ä¼šå‡ºç°çš„é—®é¢˜è¯»é—®é¢˜ è„è¯»ï¼šAäº‹åŠ¡è¯»å–Bäº‹åŠ¡å°šæœªæäº¤çš„æ›´æ”¹æ•°æ®ï¼Œå¹¶åœ¨è¿™ä¸ªæ•°æ®çš„åŸºç¡€ä¸Šè¿›è¡Œæ“ä½œï¼Œè¿™æ—¶å€™å¦‚æœäº‹åŠ¡Bå›æ»šï¼Œé‚£ä¹ˆAäº‹åŠ¡è¯»åˆ°çš„æ•°æ®æ˜¯ä¸è¢«æ‰¿è®¤çš„ã€‚ è™šåº¦ï¼ˆä¸å¯é‡å¤è¯»ï¼‰ï¼šAäº‹åŠ¡è¯»å–äº†Bäº‹åŠ¡å·²ç»æäº¤çš„æ›´æ”¹æ•°æ®ã€‚å‡å¦‚Aåœ¨å–æ¬¾äº‹åŠ¡çš„è¿‡ç¨‹ä¸­ï¼ŒBå¾€è¯¥è´¦æˆ·è½¬è´¦100ï¼ŒAä¸¤æ¬¡è¯»å–çš„ä½™é¢å‘ç”Ÿä¸ä¸€è‡´ã€‚é˜²æ­¢è¯»åˆ°æ›´æ”¹æ•°æ®ï¼Œéœ€è¦å¯¹æ“ä½œçš„æ•°æ®æ·»åŠ è¡Œçº§é”ã€‚ å¹»è¯»ï¼šAäº‹åŠ¡è¯»å–Bäº‹åŠ¡æäº¤çš„æ–°å¢æ•°æ®ã€‚ä¾‹å¦‚é“¶è¡Œç³»ç»Ÿåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ä¸¤æ¬¡ç»Ÿè®¡å­˜æ¬¾è´¦æˆ·çš„æ€»é‡‘é¢ï¼Œåœ¨ä¸¤æ¬¡ç»Ÿè®¡ä¸­ï¼Œåˆšå¥½æ–°å¢äº†ä¸€ä¸ªå­˜æ¬¾è´¦æˆ·ï¼Œå­˜å…¥äº†100ï¼Œè¿™æ—¶å€™ä¸¤æ¬¡ç»Ÿè®¡çš„æ€»é‡‘é¢ä¸ä¸€è‡´ã€‚ é˜²æ­¢è¯»åˆ°æ–°å¢æ•°æ®ï¼Œéœ€è¦å¯¹æ“ä½œçš„æ•°æ®æ·»åŠ è¡¨çº§é”ã€‚ æ›´æ–°é—®é¢˜ ç¬¬ä¸€ç±»ä¸¢å¤±æ›´æ–°ï¼šAäº‹åŠ¡æ’¤é”€æ—¶ï¼ŒæŠŠå·²ç»æäº¤çš„Bäº‹åŠ¡çš„æ›´æ–°æ•°æ®è¦†ç›–äº†ã€‚ ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°ï¼šAäº‹åŠ¡è¦†ç›–Bäº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œé€ æˆBäº‹åŠ¡æ‰€åšçš„æ“ä½œä¸¢å¤±ã€‚ äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæ•°æ®åº“é€šè¿‡å¤šç§å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼ˆå¸¸ç”¨çš„æœ‰ä¸¤é˜¶æ®µå°é”å’Œå¿«ç…§éš”ç¦»ï¼‰è§£å†³å¹¶å‘è®¿é—®çš„é—®é¢˜ã€‚ä½†æ˜¯ç›´æ¥ä½¿ç”¨å¹¶å‘æ§åˆ¶æœºåˆ¶æ˜¯å¾ˆå¤æ‚çš„ï¼Œæ•°æ®åº“ç»™ç”¨æˆ·æä¾›äº†ä¸åŒçš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œåªè¦è®¾ç½®äº†äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œæ•°æ®åº“å°±ä¼šåˆ†æäº‹åŠ¡ä¸­çš„sqlè¯­å¥ç„¶åè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å¹¶å‘æ§åˆ¶æœºåˆ¶ã€‚ å››ç§éš”ç¦»çº§åˆ«å¦‚ä¸‹ï¼š å¯ä¸²è¡ŒåŒ–(SERIALIZABLE)ï¼šä¿è¯å¯ä¸²è¡ŒåŒ–è°ƒåº¦ï¼Œä¸å…è®¸å‡ºç°ä»»ä½•é—®é¢˜ã€‚ å¯é‡å¤è¯»(REPEATABLE READ) ï¼šåªå…è®¸è¯»å–å·²æäº¤çš„æ•°æ®ï¼Œè€Œä¸”åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸¤æ¬¡è¯»å–ä¸€ä¸ªæ•°æ®é¡¹æœŸé—´ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½æ›´æ–°è¯¥æ•°ï¼Œå•ä¸è¦æ±‚è¯¥äº‹åŠ¡ä¸å…¶ä»–äº‹åŠ¡å¯ä¸²è¡ŒåŒ–ã€‚ å·²æäº¤è¯»(READ COMMITTED)ï¼šåªå…è®¸è¯»å–å·²æäº¤çš„æ•°æ®ï¼Œä½†ä¸è¦æ±‚å¯é‡å¤è¯»ã€‚ æœªæäº¤è¯»(READ UNCOMMITTED)ï¼šå…è®¸è¯»å–æœªæäº¤çš„æ•°æ®ï¼Œè¿™æ˜¯SQLå…è®¸çš„æœ€ä½ä¸€è‡´æ€§çº§åˆ«ã€‚ ä¸åŒçš„éš”ç¦»çº§åˆ«å¯¹å¹¶å‘é—®é¢˜çš„è§£å†³æƒ…å†µå¦‚ä¸‹å›¾ï¼š éš”ç¦»çº§åˆ« è„è¯» è™šè¯» å¹»è¯» ç¬¬ä¸€åˆ—ä¸¢å€¼æ›´æ–° ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–° å¯ä¸²è¡ŒåŒ–(SERIALIZABLE) ä¸å…è®¸ ä¸å…è®¸ ä¸å…è®¸ ä¸å…è®¸ ä¸å…è®¸ å¯é‡å¤è¯»(REPEATABLE READ) ä¸å…è®¸ ä¸å…è®¸ å…è®¸ ä¸å…è®¸ ä¸å…è®¸ å·²æäº¤è¯»(READ COMMITTED) ä¸å…è®¸ å…è®¸ å…è®¸ ä¸å…è®¸ å…è®¸ æœªæäº¤è¯»(READ UNCOMMITTED) å…è®¸ å…è®¸ å…è®¸ ä¸å…è®¸ å…è®¸ å‚è€ƒ ã€Šæ•°æ®åº“ç³»ç»Ÿæ¦‚å¿µã€‹ æ•°æ®åº“äº‹åŠ¡è¯¦è§£ æ•°æ®åº“å¹¶å‘äº‹åŠ¡å­˜åœ¨çš„é—®é¢˜ï¼ˆè„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ç­‰ï¼‰ æ•°æ®åº“çš„äº‹åŠ¡ä¸å¹¶å‘æ§åˆ¶ MySQLä¸­äº‹åŠ¡çš„åˆ†ç±» æ•°æ®åº“éš”ç¦»çº§åˆ«åŠå…¶å®ç°åŸç†]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®åº“èŒƒå¼]]></title>
    <url>%2F2018%2F05%2F10%2F%E6%95%B0%E6%8D%AE%E5%BA%93%2F%E6%95%B0%E6%8D%AE%E5%BA%93%E8%8C%83%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè®¾è®¡å¥½æ•°æ®åº“çš„è¡¨çš„å‰æå°±æ˜¯è¦æ»¡è¶³æ›´é«˜çº§åˆ«æ•°æ®åº“çš„èŒƒå¼ï¼Œå½“ç„¶çº§åˆ«ä¸æ˜¯è¶Šé«˜è¶Šå¥½ï¼Œä½†æ˜¯è‡³å°‘ä¸å·®ï¼ æ•°æ®åº“èŒƒå¼çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ å‡å°‘æ•°æ®å†—ä½™ æ¶ˆé™¤å¼‚å¸¸ï¼ˆæ’å…¥å¼‚å¸¸ï¼Œæ›´æ–°å¼‚å¸¸ï¼Œåˆ é™¤å¼‚å¸¸ï¼‰ ç¼ºç‚¹ æŸ¥è¯¢æ—¶è¦è”ç»“å¤šä¸ªè¡¨ï¼Œå¢åŠ äº†æŸ¥è¯¢çš„å¤æ‚åº¦ æŸ¥è¯¢æ—¶éœ€è¦è”ç»“å¤šä¸ªè¡¨ï¼Œé™ä½äº†æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½ ä»€ä¹ˆæ˜¯èŒƒå¼(NF Normal Form)èŒƒå¼æ˜¯ä¸€å¼ æ•°æ®è¡¨çš„è¡¨ç»“æ„æ‰€ç¬¦åˆçš„æŸç§è®¾è®¡æ ‡å‡†ï¼Œæ»¡è¶³é«˜ç­‰çº§çš„èŒƒå¼çš„å…ˆå†³æ¡ä»¶æ˜¯æ»¡è¶³ä½ç­‰çº§èŒƒå¼ã€‚ äº”å¤§èŒƒå¼ä»¥ä¸‹èŒƒå¼çš„åŸºæœ¬æ¦‚å¿µå¯ä»¥å‚ç…§æˆ‘çš„å¦ä¸€ç¯‡åšæ–‡ï¼šå…³ç³»å‹æ•°æ®åº“çš„åŸºç¡€æ¦‚å¿µï¼›å…·ä½“æ¡ˆä¾‹å¯ä»¥å‚ç…§è¿™ç¯‡åšæ–‡ï¼šæ•°æ®åº“èŒƒå¼é‚£äº›äº‹ ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ å¦‚æœä¸€ä¸ªå…³ç³»æ¨¡å¼Rçš„æ‰€æœ‰å±æ€§éƒ½æ˜¯ä¸å¯åˆ†çš„åŸºæœ¬æ•°æ®é¡¹ï¼Œåˆ™Râˆˆ1NF ç¬¬ä¸€èŒƒå¼å°±æ˜¯æ¯ä¸€ä¸ªå±æ€§éƒ½ä¸å¯å†åˆ†ã€‚ä¸ç¬¦åˆç¬¬ä¸€èŒƒå¼åˆ™â€œä¸èƒ½â€ç§°ä¸ºå…³ç³»æ•°æ®åº“ï¼Œå› ä¸ºä½ å¯ä»¥ä¸€å¼ è¡¨æå®šæ‰€æœ‰ï¼Œè€Œä¸ç”¨äº§ç”Ÿå…³ç³»ã€‚ ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ è‹¥å…³ç³»æ¨¡å¼Râˆˆ1NFï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªéä¸»å±æ€§éƒ½å®Œå…¨å‡½æ•°ä¾èµ–äºRçš„ç ï¼Œåˆ™Râˆˆ2NF è¡¨ä¸­çš„å±æ€§å¿…é¡»å®Œå…¨ä¾èµ–äºå…¨éƒ¨ä¸»é”®ï¼Œè€Œä¸æ˜¯éƒ¨åˆ†ä¸»é”®ã€‚æ‰€ä»¥åªæœ‰ä¸€ä¸ªä¸»é”®çš„è¡¨å¦‚æœç¬¦åˆç¬¬ä¸€èŒƒå¼ï¼Œé‚£ä¸€å®šæ˜¯ç¬¬äºŒèŒƒå¼ å‡å°‘æ•°æ®å®¹å†—ä½™å’Œå‡å°‘æ›´æ–°å¼‚å¸¸ ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ è‹¥å…³ç³»æ¨¡å¼Râˆˆ2NFï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªéä¸»å±æ€§å¯¹äºç éƒ½ä¸å­˜åœ¨ä¼ é€’å‡½æ•°ä¾èµ–ï¼Œåˆ™Râˆˆ3NF æ¶ˆé™¤äº†éä¸»å±æ€§å¯¹äºç çš„ä¼ é€’å‡½æ•°ä¾èµ– å‡å°‘æ•°æ®å®¹å†—ä½™å’Œå‡å°‘å¸¸æ’å…¥å¼‚å¸¸ï¼Œæ›´æ–°å¼‚å¸¸ï¼Œåˆ é™¤å¼‚å¸¸ å·´æ–¯-ç§‘å¾·èŒƒå¼ï¼ˆBCNFï¼‰ è‹¥å…³ç³»æ¨¡å¼Râˆˆ3NFï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªä¸»å±æ€§å¯¹äºç éƒ½ä¸å­˜åœ¨éƒ¨åˆ†ä¸ä¼ é€’å‡½æ•°ä¾èµ–ï¼Œåˆ™RâˆˆBCNF æ¶ˆé™¤ä¸»å±æ€§å¯¹äºç çš„éƒ¨åˆ†ä¸ä¼ é€’å‡½æ•°ä¾èµ–ï¼ŒBCNFæ˜¯åœ¨ç¬¬ä¸‰èŒƒå¼çš„åŸºç¡€ä¸Šçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œæ—¢æ¯ä¸ªè¡¨ä¸­åªæœ‰ä¸€ä¸ªå€™é€‰é”®ã€‚ å‡å°‘æ’å…¥å¼‚å¸¸ï¼Œæ›´æ–°å¼‚å¸¸ä¸åˆ é™¤å¼‚å¸¸ ç¬¬å››èŒƒå¼ï¼ˆ4NFï¼‰ è‹¥å…³ç³»æ¨¡å¼Râˆˆ1NFï¼Œå¹¶ä¸”åªå…è®¸çš„éå¹³å‡¡å¤šå€¼ä¾èµ–æ˜¯å‡½æ•°ä¾èµ–ï¼Œä¸å…è®¸å­˜åœ¨å…¶ä»–éå¹³å‡¡ä¸”éå‡½æ•°ä¾èµ–çš„å¤šå€¼ä¾èµ–ï¼Œåˆ™Râˆˆ4NFã€‚ å¹³å‡¡çš„å¤šå€¼ä¾èµ–å±äºç¬¬å››èŒƒå¼ å‡å°‘æ•°æ®å®¹å†—ä½™å’Œå‡å°‘å¸¸æ’å…¥å¼‚å¸¸ï¼Œæ›´æ–°å¼‚å¸¸ï¼Œåˆ é™¤å¼‚å¸¸ æ€»ç»“æ•°æ®åº“è®¾è®¡åº”ç”¨çš„èŒƒå¼ä¸æ˜¯è¶Šé«˜è¶Šå¥½ï¼Œè¦çœ‹å®é™…æƒ…å†µè€Œå®šã€‚ç¬¬ä¸‰èŒƒå¼å·²ç»å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘äº†æ•°æ®å†—ä½™ï¼Œå¹¶ä¸”å‡å°‘äº†é€ æˆæ’å…¥å¼‚å¸¸ï¼Œæ›´æ–°å¼‚å¸¸ï¼Œå’Œåˆ é™¤å¼‚å¸¸äº†ã€‚å¤§å¤šæ•°æƒ…å†µåº”ç”¨åˆ°ç¬¬ä¸‰èŒƒå¼å·²ç»è¶³å¤Ÿï¼Œåœ¨ä¸€å®šæƒ…å†µä¸‹ç¬¬äºŒèŒƒå¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ å‚è€ƒ è§£é‡Šä¸€ä¸‹å…³ç³»æ•°æ®åº“çš„ç¬¬ä¸€ç¬¬äºŒç¬¬ä¸‰èŒƒå¼ æ•°æ®åº“èŒƒå¼é‚£äº›äº‹ æ•°æ®åº“ä¸­çš„èŒƒå¼å’Œå¤šå€¼ä¾èµ–]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³ç³»å‹æ•°æ®åº“çš„åŸºç¡€æ¦‚å¿µ]]></title>
    <url>%2F2018%2F05%2F10%2F%E6%95%B0%E6%8D%AE%E5%BA%93%2F%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨å­¦ä¹ æˆ–è€…è®¾è®¡å…³ç³»å‹æ•°æ®åº“ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å…ˆå­¦ä¹ å…³ç³»å‹æ•°æ®åº“çš„åŸºç¡€æ¦‚å¿µã€‚ æ•°æ®åº“å…³ç³»æ¨¡å‹æ•°æ®åº“ç»“æ„ å…³ç³»æ•°æ®åº“ç”±è¡¨çš„é›†åˆæ„æˆï¼Œæ¯ä¸ªè¡¨æœ‰å”¯ä¸€çš„åå­—ã€‚ åœ¨å…³ç³»æ¨¡å‹çš„æœ¯è¯­ä¸­ï¼Œå…³ç³»ç”¨æ¥æŒ‡ä»£è¡¨ï¼Œå…ƒç»„ç”¨æ¥æŒ‡ä»£è¡Œ ï¼Œå±æ€§ç”¨æ¥æŒ‡ä»£è¡¨ä¸­çš„åˆ—ï¼Œå…³ç³»å®ä¾‹ç”¨æ¥æŒ‡ä»£ä¸€ä¸ªå…³ç³»çš„ç‰¹å®šå®ä¾‹ã€‚ å¯¹äºå…³ç³»çš„æ¯ä¸ªå±æ€§ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªå…è®¸å–å€¼çš„é›†åˆï¼Œç§°ä¸ºè¯¥å±æ€§çš„åŸŸã€‚ å¦‚æœåŸŸä¸­çš„å…ƒç´ è¢«çœ‹åšæ˜¯ä¸å¯å†åˆ†çš„å•å…ƒï¼Œåˆ™åŸŸæ˜¯åŸå­çš„ã€‚ æ•°æ®åº“æ¨¡å¼ æ•°æ®åº“æ¨¡å¼æ˜¯æ•°æ®åº“çš„é€»è¾‘è®¾è®¡ï¼Œæ•°æ®åº“å®ä¾‹æ˜¯ç»™å®šæ—¶åˆ»æ•°æ®åº“æ•°æ®çš„ä¸€ä¸ªå¿«ç…§ã€‚ å…³ç³»å¯¹åº”äºç¨‹åºè®¾è®¡è¯­è¨€ä¸­å˜é‡çš„å®šä¹‰ï¼Œå…³ç³»æ¨¡å¼å¯¹åº”äºç¨‹åºè®¾è®¡è¯­è¨€ä¸­ç±»å‹çš„å®šä¹‰ï¼Œå…³ç³»å®ä¾‹å¯¹åº”äºç¨‹åºè®¾è®¡è¯­è¨€ä¸­å˜é‡çš„å€¼ã€‚ å…³ç³»æ¨¡å¼ç”±å±æ€§åºåˆ—åŠå„å±æ€§å¯¹åº”çš„åŸŸç»„æˆã€‚ ç  è¶…ç æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„é›†åˆï¼Œè¿™äº›å±æ€§çš„é›†åˆå¯ä»¥ä½¿æˆ‘ä»¬åœ¨ä¸€ä¸ªå…³ç³»ä¸­å”¯ä¸€åœ°è¡¨ç¤ºä¸€ä¸ªå…ƒç»„ã€‚ å¦‚æœKæ˜¯ä¸€ä¸ªè¶…ç ï¼Œé‚£ä¹ˆKçš„ä»»æ„è¶…é›†ä¹Ÿæ˜¯è¶…ç ï¼Œä»–ä»¬çš„ä»»æ„çœŸå­é›†éƒ½ä¸èƒ½ç§°ä¸ºè¶…ç ï¼Œè¿™æ ·æœ€å°çš„è¶…ç ç§°ä¸ºå€™é€‰ç (ç ),å€™é€‰ç ä¸­ä»»ä½•ä¸€ä¸ªå±æ€§ç§°ä¸ºä¸»å±æ€§ï¼Œå…¶å®ƒä¸ºéä¸»å±æ€§ã€‚ ä¸»ç ä»£è¡¨è¢«æ•°æ®åº“è®¾è®¡è€…ç”¨æ¥åœ¨ä¸€ä¸ªå…³ç³»æ±‡æ€»åŒºåˆ†ä¸åŒå…ƒç»„çš„å€™é€‰ç ï¼Œä¸»ç åº”è¯¥é€‰æ‹©é‚£äº›å€¼ä»ä¸æˆ–æå°‘å˜åŒ–çš„å±æ€§ã€‚ ä¸€ä¸ªå…³ç³»æ¨¡å¼(r1)å¯èƒ½åœ¨å®ƒçš„å±æ€§ä¸­åŒ…å«å¦ä¸€ä¸ªå…³ç³»æ¨¡å¼(r2)çš„ä¸»ç ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§åœ¨r1ä¸Šç§°åšå‚ç…§r2çš„å¤–ç ã€‚å…³ç³»r1è¢«ç§°ä¸ºå¤–ç ä¾èµ–çš„å‚ç…§å…³ç³»ï¼Œr2è¢«ç§°ä¸ºå¤–ç çš„è¢«å‚ç…§å…³ç³»ã€‚ å‡½æ•°ä¾èµ–è‹¥åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œåœ¨å±æ€§ï¼ˆæˆ–å±æ€§ç»„ï¼‰Xçš„å€¼ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œå¿…å®šèƒ½ç¡®å®šå±æ€§Yçš„å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¯´Yå‡½æ•°ä¾èµ–äºXï¼Œå†™ä½œ X â†’ Yã€‚ å®Œå…¨å‡½æ•°ä¾èµ– åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œè‹¥ X â†’ Yï¼Œä¸”å¯¹äº X çš„ä»»ä½•ä¸€ä¸ªçœŸå­é›†ï¼ˆå‡å¦‚å±æ€§ç»„ X åŒ…å«è¶…è¿‡ä¸€ä¸ªå±æ€§çš„è¯ï¼‰ï¼ŒX â†’ Y ä¸æˆç«‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§° Y å¯¹äº X å®Œå…¨å‡½æ•°ä¾èµ–ï¼Œè®°ä½œ X Fâ†’ Yã€‚ï¼ˆé‚£ä¸ªFåº”è¯¥å†™åœ¨ç®­å¤´çš„æ­£ä¸Šæ–¹ï¼‰ éƒ¨åˆ†å‡½æ•°ä¾èµ– å‡å¦‚ Y å‡½æ•°ä¾èµ–äº Xï¼Œä½†åŒæ—¶ Y å¹¶ä¸å®Œå…¨å‡½æ•°ä¾èµ–äº Xï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç§° Y éƒ¨åˆ†å‡½æ•°ä¾èµ–äº Xï¼Œè®°ä½œ X Pâ†’ Yã€‚ï¼ˆé‚£ä¸ªPåº”è¯¥å†™åœ¨ç®­å¤´çš„æ­£ä¸Šæ–¹ï¼‰ ä¼ é€’å‡½æ•°ä¾èµ– åœ¨ Y ä¸åŒ…å«äº Xï¼Œä¸” X ä¸å‡½æ•°ä¾èµ–äº Yè¿™ä¸ªå‰æä¸‹ï¼Œå‡å¦‚ Z å‡½æ•°ä¾èµ–äº Yï¼Œä¸” Y å‡½æ•°ä¾èµ–äº X ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç§° Z ä¼ é€’å‡½æ•°ä¾èµ–äº X ï¼Œè®°ä½œ X Tâ†’ Zã€‚ï¼ˆé‚£ä¸ªTåº”è¯¥å†™åœ¨ç®­å¤´çš„æ­£ä¸Šæ–¹ï¼‰ å¤šå€¼ä¾èµ–è‹¥åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œåœ¨å±æ€§é›†X, Y, å’ŒZæ˜¯Uçš„å­é›†ï¼Œå¹¶ä¸”Z=U-X-Yï¼Œå½“ä¸”ä»…å½“è¡¨ä¸­çš„è®°å½•ä¸Šå½“Xï¼ŒZç¡®å®šæ—¶ï¼Œå±æ€§Yæœ‰ä¸€ç»„å€¼ï¼Œè¿™ç»„å€¼ä»…ä»…å†³å®šäºå±æ€§Xå€¼è€Œä¸å±æ€§Zå€¼æ— å…³ï¼Œå¤šå€¼ä¾èµ–X-&gt;-&gt;Yæˆç«‹ã€‚å¦‚æœæŠŠä¸Šé¢çš„ä¸€ç»„æ”¹ä¸ºä¸€ä¸ªï¼Œé‚£ä¹ˆå¤šå€¼ä¾èµ–å°±å˜æˆäº†å‡½æ•°ä¾èµ–ã€‚å½“ç„¶ä¸€ä¸ªå€¼ç»„æˆçš„ç»„ä¹Ÿæ˜¯ç»„ï¼Œæ‰€ä»¥è¯´ï¼Œå‡½æ•°ä¾èµ–æ˜¯å¤šå€¼ä¾èµ–çš„ç‰¹æ®Šæƒ…å†µã€‚ å¹³å‡¡çš„å¤šå€¼ä¾èµ– è‹¥X-&gt;-&gt;Yï¼Œè€ŒZç­‰äºç©ºé›†ï¼Œåˆ™ç§°X-&gt;-&gt;Yä¸ºå¹³å‡¡çš„å¤šå€¼ä¾èµ–ï¼Œå±æ€§é›†åˆä¸­åˆ†ä¸ºä¸¤ä¸ªçœŸå­é›†ï¼Œæ¯ä¸€ä¸ªXå¯¹åº”ä¸€ç»„Yçš„å–å€¼ éå¹³å‡¡çš„å¤šå€¼ä¾èµ– è‹¥X-&gt;-&gt;Yï¼Œè€ŒZä¸ç­‰äºç©ºé›†ï¼Œåˆ™ç§°X-&gt;-&gt;Yä¸ºéå¹³å‡¡çš„å¤šå€¼ä¾èµ– å‚è€ƒ ã€Šæ•°æ®åº“ç³»ç»Ÿæ¦‚å¿µã€‹]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQLå¿…çŸ¥å¿…ä¼š]]></title>
    <url>%2F2018%2F05%2F07%2F%E6%95%B0%E6%8D%AE%E5%BA%93%2FMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%2F</url>
    <content type="text"><![CDATA[å¼•:è™½ç„¶ç”¨äº†è¿™ä¹ˆä¹…çš„æ•°æ®åº“ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä½¿ç”¨èµ·æ¥éš¾å…ä¼šå»æŸ¥æ€ä¹ˆä½¿ç”¨ï¼Œè¿™æ ·ä¸‹å»ä¹Ÿä¸æ˜¯åŠæ³•ï¼Œæ‰€ä»¥è‡ªå·±å°±åœ¨è¿™é‡Œä»¥Mysqlä¸ºä¾‹æ€»ç»“ä¸€ä¸‹ç»å¸¸ç”¨åˆ°çš„åœ°æ–¹ã€‚ åŸºæœ¬æ³¨æ„ç‚¹ SQLå…³é”®å­—ä½¿ç”¨å¤§å†™ï¼Œæ‰€æœ‰åˆ—å’Œè¡¨åä½¿ç”¨å°å†™ SQLè¯­å¥ç”±å­å¥æ„æˆï¼Œä¸€ä¸ªå­å¥é€šå¸¸ç”±ä¸€ä¸ªå…³é”®å­—å’Œä¸€ä¸ªæ•°æ®ç»„æˆï¼Œå­å¥çš„é¡ºåºä¸€èˆ¬ä¸º: SELECT æ•°æ® FROM æ•°æ® WHERE æ•°æ® GROUP BY æ•°æ® HAVING æ•°æ® ORDER BY æ•°æ® LIMIT æ•°æ® é€šé…ç¬¦æœç´¢çš„å¤„ç†ä¸€èˆ¬è¦æ¯”å…¶ä»–æœç´¢æ‰€èŠ±æ—¶é—´é•¿ï¼Œä¸è¦è¿‡åº¦ä½¿ç”¨é€šé…ç¬¦ï¼Œå¦‚æœè¦ï¼Œå°±åº”è¯¥å°†é€šé…ç¬¦æ”¾åœ¨æœç´¢é›†åˆå°çš„æœç´¢ä¸Š å¤šæ•°DBMSä½¿ +æˆ–||æ¥å®ç°æ‹¼æ¥ï¼ŒMYSQLåˆ™ä½¿ Concatå‡½æ•°æ¥å®ç° æ•°æ®åº“åˆ—èˆ¬ç§°ä¸ºåˆ—ï¼Œè®¡ç®—å­—æ®µä¸€èˆ¬ç§°ä¸ºå­—æ®µ MySQLä½¿ç”¨çš„æ—¥æœŸæ ¼å¼å¿…é¡»æ˜¯yyyy-mm-dd WHEREåœ¨æ•°æ®åˆ†ç»„å‰è¿›è¡Œè¿‡æ»¤ï¼ŒHAVINGåœ¨æ•°æ®åˆ†ç»„åè¿›è¡Œè¿‡æ»¤ å­æŸ¥è¯¢æœ€å¸¸è§çš„ä½¿ç”¨æ˜¯åœ¨WHEREå­å¥çš„INæ“ä½œç¬¦å åœ¨åˆ é™¤æˆ–æ›´æ–°è¡¨ä¹‹å‰å…ˆSELECTå‡ºæ¥ï¼Œé˜²æ­¢åˆ é”™ åˆ©ç”¨å¤–é”®çº¦æŸï¼Œé˜²æ­¢åˆ é™¤ä¸å…¶ä»–è¡¨ç›¸å…³è”çš„è¡Œ MySQLåŸºæœ¬ä½¿ç”¨ MySQLå¸®åŠ© ç›¸å…³å‘½ä»¤ -h/â€“help MySQLæœåŠ¡å¯åŠ¨å’Œå…³é—­ mysql.server start/stop MySQLè¿æ¥ mysql -u ç”¨æˆ·å -p å¯†ç  -h ä¸»æœºå -P ç«¯å£ ï¼ˆé»˜è®¤ç”¨æˆ·åä¸ºä½¿ç”¨è€…åï¼Œä¸»æœºåé»˜è®¤ä¸ºlocalhostï¼Œç«¯å£é»˜è®¤ä¸º3306ï¼‰ é€€å‡ºå‘½ä»¤è¡Œ quit/exit æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“ SHOW DATABASES ä½¿ç”¨æ•°æ®åº“ USE æ•°æ®åº“å æ˜¾ç¤ºæŸåº“ä¸‹æ‰€æœ‰çš„è¡¨ SHOW TABLES æ˜¾ç¤ºæŸè¡¨ä¸‹é¢çš„åˆ— SHOW COLUMNS FROM è¡¨å / DISCRIBE è¡¨å æ˜¾ç¤ºæœåŠ¡å™¨çš„çŠ¶æ€ä¿¡æ¯ SHOW STATUS æ˜¾ç¤ºåˆ›å»ºç‰¹å®šæ•°æ®åº“æˆ–è¡¨çš„MySQLè¯­å¥ SHOW CREATE DATABASE æ•°æ®åº“å / TABLE è¡¨å å®‰å…¨ç®¡ç† ç”¨æˆ·ç®¡ç† USE mysql SELECT user FROM user CREATE USER rex IDENTIFIED BY â€˜å¯†ç â€™ //åˆ›å»ºç”¨æˆ·è´¦å· RENAME USER rex TO rex1 // ä¿®æ”¹ç”¨æˆ·å DROP USER rex // åˆ é™¤ç”¨æˆ·è´¦å· SHOW GRANTS FOR rex // æ˜¾ç¤ºrexçš„æƒé™ï¼ŒUSAGE ON .è¡¨ç¤ºæ²¡æœ‰æƒé™ GRANT SELECT ON æ•°æ®åº“/è¡¨.* TO rex // ç»™rexå¯¹æ•°æ®åº“/è¡¨çš„è¯»æƒé™ REVOKE SELECT ON æ•°æ®åº“/è¡¨.* TO rex // æ’¤é”€rexå¯¹æ•°æ®åº“/è¡¨çš„è¯»æƒé™ æ›´æ”¹å¯†ç  SET PASSWORD FOR rex = Password â€˜æ–°å¯†ç â€™ SET PASSWORD = Password â€˜æ–°å¯†ç â€™ // ä¿®æ”¹å½“å‰ç”¨æˆ·çš„å¯†ç  æ•°æ®åº“ç»´æŠ¤ æ•°æ®åº“å¤‡ä»½ ä½¿ç”¨mysqldump ä½¿ç”¨mysqlhotcopy ä½¿ç”¨BACKUP TABLEæˆ–SELECT INTO OUTFILE ç»´æŠ¤æ•°æ®åº“ ANALYZE/CHECK TABLE è¡¨å // æ£€æŸ¥è¡¨é”®æ˜¯å¦æ­£ç¡® OPTIMIZE TABLE è¡¨å // å›æ”¶æ‰€ç”¨ç©ºé—´ æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ é”™è¯¯æ—¥å¿—ï¼šé€šå¸¸ä¸º/data/hostname.errï¼Œå¯é€šè¿‡â€“log-errorä¿®æ”¹æ–‡ä»¶ æŸ¥è¯¢æ—¥å¿—ï¼šé€šå¸¸ä¸º/data/hostname.logï¼Œå¯é€šè¿‡â€“logä¿®æ”¹æ–‡ä»¶ äºŒè¿›åˆ¶æ–‡ä»¶ï¼šé€šå¸¸ä¸º/data/hostname-bin ç¼“æ…¢æŸ¥è¯¢æ—¥å¿—ï¼šé€šå¸¸ä¸º/data/hostname-slow.logï¼Œå¯é€šè¿‡hostname-slow- queriesä¿®æ”¹æ–‡ä»¶ åˆ›å»ºå’Œæ“çºµè¡¨ åˆ›å»ºè¡¨ CREATE IF NOT EXISTS TABLE è¡¨å(id int NOT NULL AUTO_INCREMENT ,â€¦, PRIMARY KEY(id)) ENGINE=InnoDB æ›´æ–°è¡¨ ALTER TABLE è¡¨å ADD ç±»å‹ // å¢åŠ åˆ— ALTER TABLE è¡¨1 ADD CONSTRAINT fkè¡¨1è¡¨2 FOREIGN KEY(è¡¨2id) REFERENCES è¡¨2(è¡¨2id) åˆ é™¤è¡¨ DROP TABLE è¡¨å é‡å‘½åè¡¨ RENAME TABLE è¡¨å1 TO è¡¨å2 æŸ¥è¯¢æ•°æ®åŸºæœ¬æŸ¥è¯¢æ•°æ® æ£€ç´¢å•ä¸ªåˆ— SELECT prod_name FROM product æ£€ç´¢å¤šä¸ªåˆ— SELECT prod_id, prod_name FROM product æ£€ç´¢æ‰€æœ‰åˆ— SELECT * FROM product æ£€ç´¢ä¸åŒçš„è¡Œ SELECT DISTINCT vend_id FROM product é™åˆ¶ç»“æœçš„è¡Œæ•°ä¸ºå‰5æ¡/ç¬¬äºŒä¸ª5æ¡ SELECT * FROM product LIMIT 5 / LIMIT 5(å¼€å§‹ä½ç½®ï¼Œç¬¬ä¸€è¡Œå…¶å®ç¬¬0 è¡Œ),5(è¦æ£€ç´¢çš„è¡Œæ•°) SELECT * FROM product LIMIT 5 (åç§»é‡) OFFSET 5 (å¼€å§‹ä½ç½®) æ’åºæ£€ç´¢æ•°æ® æŒ‰ä¸€ä¸ªåˆ—æ’åº SELECT prod_name FROM product ORDER BY prod_name æŒ‰å¤šä¸ªåˆ—æ’åº(å…ˆæŒ‰prod_priceæ’åºï¼Œå¦‚æœç›¸åŒï¼Œåˆ™æ¯”è¾ƒprod_name) SELECT prod_id, prod_price, prod_name FROM product ORDER BY prod_price, prod_name æŒ‡å®šæ’åºæ–¹å‘(é»˜è®¤å‡åºASCï¼Œé™åºDESC) SELECT prod_id, prod_price, prod_name FROM product ORDER BY prod_price DESC è¿‡æ»¤æ•°æ® WHEREå­å¥è¿‡æ»¤ SELECT prod_name, prod_price FROM product WHERE prod_price = 2.50 WHEREå­å¥æ“ä½œç¬¦ æ“ä½œç¬¦ | è¯´æ˜â€”|â€”= | ç­‰äº&lt;&gt; | ä¸ç­‰äº!= | ä¸ç­‰äº&lt; | å°äº&lt;= | å°äºç­‰äº> | å¤§äº>= | å¤§äºç­‰äºBETWEENâ€¦ AND | åœ¨æŒ‡å®šçš„ä¸¤ä¸ªå€¼ä¹‹é—´(mysqlåŒ…æ‹¬ä¸¤ç«¯)NOT BETWEENâ€¦ AND | ä¸åœ¨æŒ‡å®šçš„ä¸¤ä¸ªå€¼ä¹‹é—´(mysqlä¸åŒ…æ‹¬ä¸¤ç«¯) ç©ºå€¼æ£€æŸ¥(éœ€è¦æ³¨æ„nullå’Œæ²¡æœ‰å€¼å¾—åŒºåˆ«) SELECT prod_name FROM products WHERE prod_price IS NULL æ•°æ®è¿‡æ»¤æ“ä½œç¬¦ æ“ä½œç¬¦ | è¯´æ˜ â€”|â€” AND | ä¸”ï¼ˆä¼˜å…ˆçº§æ¯”ORé«˜ï¼‰ OR | æˆ– IN | åœ¨æŒ‡å®šèŒƒå›´å†…ï¼Œå¦‚WHERE id IN (1002 1003) NOT IN | ä¸åœ¨æŒ‡å®šèŒƒå›´å†… æ•°æ®è¿‡æ»¤é€šé…ç¬¦(åˆ©ç”¨LIKEæ“ä½œç¬¦) æ“ä½œç¬¦ | è¯´æ˜ â€”|â€” % | è¡¨ç¤ºä»»æ„å­—ç¬¦å‡ºç°çš„ä»»æ„æ¬¡æ•° _ | è¡¨ç¤ºå•ä¸ªå­—ç¬¦ ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæœç´¢(æ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨è‡ªè¡Œæœç´¢) SELECT * FROM product WHERE prod_name REGEXP â€˜.000â€™ OR prod_name REGEXP â€˜1000|2000â€™ OR prod_name REGEXP â€˜[123] Tonâ€™ åˆ›å»ºè®¡ç®—å­—æ®µè®¡ç®—å­—ç¬¦æ˜¯è¿è¡Œæ—¶åœ¨SELECTè¯­å¥å†…åˆ›å»ºçš„ã€‚ æ‹¼æ¥å­—æ®µ(Concatå‡½æ•°) SELECT Concat(vend_name,â€™(â€˜,vend_country,â€™)â€™) FROM vendors ä½¿ç”¨åˆ«å(åˆ—åï¼Œè¡¨åéƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½¿ç”¨å…³é”®å­—ASï¼Œä¹Ÿå¯çœç•¥) SELECT Concat(RTrim(vend_name),â€™(â€˜, RTrim(vend_country),â€™)â€™) AS vend_title FROM vendors æ‰§è¡Œç®—æœ¯è®¡ç®—(åŠ å‡ä¹˜é™¤) SELECT quantity*item_price AS expanded_price FROM orderitems ä½¿ç”¨æ•°æ®å¤„ç†å‡½æ•° æ–‡æœ¬å¤„ç†å‡½æ•°å‡½æ•° | è¯´æ˜â€”|â€”Left() | è¿”å›ä¸²å·¦è¾¹çš„å­—ç¬¦Right() | è¿”å›ä¸²å³è¾¹çš„å­—ç¬¦Length() | è¿”å›ä¸²çš„é•¿åº¦Locate() | æ‰¾å‡ºä¸€ä¸ªä¸²çš„å­ä¸²Lower() | å°†ä¸²è½¬åŒ–ä¸ºå°å†™Upper() | å°†ä¸²è½¬åŒ–ä¸ºå¤§å†™LRrim() | å»æ‰ä¸²å·¦è¾¹çš„ç©ºæ ¼RTrim() | å»æ‰ä¸²å³è¾¹çš„ç©ºæ ¼Trim() | å»æ‰ä¸²ä¸¤è¾¹çš„ç©ºæ ¼SubString() | è¿”å›å­ä¸²çš„å­—ç¬¦ æ—¥æœŸå’Œæ—¶é—´å¤„ç†å‡½æ•° å‡½æ•° | è¯´æ˜ â€”|â€” AddDate() | å¢åŠ ä¸€ä¸ªæ—¥æœŸ(å¤©ã€å‘¨ç­‰) AddTime() | å¢åŠ ä¸€ä¸ªæ—¶é—´(æ—¶ã€åˆ†ç­‰) CurDate() | è¿”å›å½“å‰çš„æ—¥æœŸ CurTime() | è¿”å›å½“å‰çš„æ—¶é—´ Date() | è¿”å›æ—¥æœŸæ—¶é—´çš„æ—¥æœŸéƒ¨åˆ† DateDiff() | è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹å·® Date_Format() | è¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„æ—¥æœŸæˆ–æ—¶é—´ä¸² Day() | è¿”å›ä¸€ä¸ªæ—¥æœŸçš„å¤©æ•°éƒ¨åˆ†ï¼Œç±»æ¨å¹´æœˆæ—¥ï¼Œæ—¶åˆ†ç§’ Now() | è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´ æ•°å€¼å¤„ç†å‡½æ•° å‡½æ•° | è¯´æ˜ â€”|â€” Abs() | è¿”å›ä¸€ä¸ªæ•°çš„ç»å¯¹å€¼ Cos() | è¿”å›ä¸€ä¸ªè§’åº¦çš„ä½™å¼¦ï¼Œç±»æ¨æ­£å¼¦ Exp() | è¿”å›ä¸€ä¸ªæ•°çš„æŒ‡æ•°å€¼ Mod() | è¿”å›é™¤æ•°æ“ä½œçš„ä½™æ•° Rand() | è¿”å›ä¸€ä¸ªéšæœºæ•° Sqrt() | è¿”å›ä¸€ä¸ªæ•°çš„å¹³æ–¹æ ¹ æ±‡æ€»æ•°æ® èšé›†å‡½æ•° å‡½æ•° | è¯´æ˜ â€”|â€” AVG() | è¿”å›æŸåˆ—çš„å¹³å‡å€¼ COUNT() | è¿”å›æŸåˆ—çš„è¡Œæ•° MAX() | è¿”å›æŸåˆ—çš„æœ€å¤§å€¼ MIN() | è¿”å›æŸåˆ—çš„æœ€å°å€¼ SUM() | è¿”å›æŸåˆ—çš„æ€»å’Œ åˆ†ç»„æ•°æ® åˆ›å»ºåˆ†ç»„(å…ˆåˆ†ç»„åèšé›†) SELECT vend_id COUNT(*) AS num_prods FROM product GROUP BY vend_id è¿‡æ»¤åˆ†ç»„ SELECT cust_id COUNT() AS orders FROM order GROUP BY cust_id HAVING COUNT()&gt;=2 ä½¿ç”¨å­æŸ¥è¯¢ åˆ©ç”¨å­æŸ¥è¯¢è¿›è¡Œè¿‡æ»¤(æ‰¾å‡ºä¹°TNT2çš„é¡¾å®¢ä¿¡æ¯) SELECT cust_name, cust_contact FROM customers WHERE cust_id IN (SELECT cust_id FROM order WHERE order_num IN (SELECT order_num FROM orderitem WHERE prod_id=â€™TNT2â€™)) ä½¿ç”¨è®¡ç®—å­—æ®µä½¿ç”¨å­æŸ¥è¯¢(æ˜¾ç¤ºé¡¾å®¢çš„ä¿¡æ¯å’Œè®¢å•é‡) SELECT cust_name, cust_state, (SELECT COUNT (*) FROM order WHERE order.cust_id = customer.cust_id) AS orders FROM customer è”ç»“è¡¨æŸ¥è¯¢ è”ç»“æŸ¥è¯¢(æ²¡æœ‰WHEREå­å¥ä¼šäº§ç”Ÿç¬›å¡å°”ç§¯) SELECT vend_name, prod_name FROM vendor, product, WHERE vendor.vend_id = product.vend_id å†…éƒ¨è”ç»“(ç­‰å€¼è”ç»“ï¼Œé¦–é€‰) SELECT vend_name, prod_name FROM vendor INNER JOIN product ON vendor.vend_id = product.vend_id å¤šè¡¨è”ç»“ SELECT vend_name, prod_name, quantity FROM vendor, product, orderitem WHERE product.vend_id = vendor.vend_id AND orderitem.prod_id = product.prod_id è‡ªè”ç»“(ä¸€èˆ¬è”ç»“æŸ¥è¯¢è¦æ¯”å­æŸ¥è¯¢å¿«) ELECT p1.prod_id, p1.prod_name FROM product p1, product p2 WHERE p1.vend_id = p2.vend_id AND p2.prod_id = â€˜DTNTRâ€™ è‡ªç„¶è”ç»“(æ’é™¤ä¸€ä¸ªåˆ—å¤šæ¬¡å‡ºç°ï¼Œä½¿æ¯ä¸ªåˆ—åªè¿”å›ä¸€æ¬¡; å¤§éƒ¨åˆ†å†…éƒ¨è”ç»“éƒ½æ˜¯è‡ªç„¶è”ç»“) å¤–éƒ¨è”ç»“(è”ç»“åŒ…æ‹¬äº†é‚£äº›åœ¨ç›¸å…³è¡¨æ²¡æœ‰å…³è”è¡Œçš„è¡Œï¼Œå·¦å¤–è”ç»“(å·¦è¾¹çš„æ‰€æœ‰è¡Œå¿…å‡ºç°)ï¼Œå³å¤–è”ç»“(å³è¾¹çš„æ‰€æœ‰è¡Œå¿…å‡ºç°)) SELECT vend_name, prod_name FROM vendor LEFT OUTER JOIN product ON vendor.vend_id = product.vend_id ç»„åˆæŸ¥è¯¢ åˆ›å»ºç»„åˆæŸ¥è¯¢(å¤§éƒ¨åˆ†ä½¿ç”¨WHEREå­å¥æ›´å¿«ï¼Œä½†æ˜¯å¯¹äºå¤šä¸ªè¡¨ä½¿ç”¨UNIONå¯èƒ½æ›´ç®€å•ï¼Œé‡å¤è¡Œä¼šè¢«è‡ªåŠ¨å–æ¶ˆï¼Œå¦‚æœä¸å–æ¶ˆï¼Œä½¿ç”¨UNION ALL) SELECT vend_id, prod_id, prod_price FROM product WHERE prod_price &lt;=5 UNION SELECT vend_id, prod_id, prod_price FROM product WHERE vend_id IN (1001, 1002) æ’å…¥æ•°æ® æ’å…¥ä¸€è¡Œæ•°æ®(å¦‚æœæ˜¯å®Œæ•´çš„è¡Œï¼Œå¯ä»¥ä¸å†™åˆ—åï¼Œä½†æ˜¯è¦æ³¨æ„å€¼çš„é¡ºåº) INSERT INTO customer(åˆ—å) VALUES(ç±»åå¯¹åº”çš„å€¼) æ’å…¥å¤šä¸ªè¡Œ INSERT INTO customer(åˆ—å) VALUES(ç±»åå¯¹åº”çš„å€¼),VALUES(ç±»åå¯¹åº”çš„å€¼) æ’å…¥æ£€ç´¢å‡ºçš„æ•°æ® INSERT INTO customer(åˆ—å) SELECT (åˆ—å) FROM è¡¨å æ›´æ–°æ•°æ® æ›´æ–°è¡¨ä¸­ç‰¹å®šçš„åˆ—(ä¸€å®šä¸è¦å¿˜äº†WHEREå­å¥) UPDATE customer SET åˆ—å = å€¼ WHERE å­å¥ æ›´æ–°å¤šåˆ— UPDATE customer SET åˆ—å = å€¼,åˆ—å = å€¼ WHERE å­å¥ åˆ é™¤æ•°æ® åˆ é™¤ç‰¹å®šçš„è¡Œ DELETE FROM è¡¨ WHERE å­å¥ ä½¿ç”¨è§†å›¾ åˆ›å»ºè§†å›¾ CREATE VIEW è§†å›¾å AS SELECT è¯­å¥ æŸ¥çœ‹åˆ›å»ºè§†å›¾çš„è¯­å¥ SHOW CREATE VIEW è§†å›¾å åˆ é™¤è§†å›¾ DROP VIEW è§†å›¾å æ›´æ–°è§†å›¾ï¼ˆå…ˆåˆ é™¤åŸè§†å›¾ï¼Œå†åˆ›å»ºæ–°è§†å›¾ï¼‰ å‚è€ƒ ã€ŠMySQLå¿…çŸ¥å¿…ä¼šã€‹]]></content>
      <categories>
        <category>æ•°æ®åº“</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HelloWorld_Shiro Activity]]></title>
    <url>%2F2018%2F05%2F03%2FHelloWorld%2FHelloWorld-Shiro-Activity%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè®°å¾—å»å¹´æš‘å‡è¦å¼„å·¥ä½œæµActivityæ²¡æœ‰å¼„å‡ºæ¥ï¼Œè¿™æ¬¡åˆšå¥½çœ‹åˆ°äº†ä¸€ä¸ªåŸºäºShiroå’ŒActivityçš„è€ƒå‹¤é¡¹ç›®ï¼Œå°±æƒ³å†™ä¸€ä¸‹äº†ï¼ æŠ€æœ¯ç‚¹ å‰ç«¯æ¨¡æ¿å¼•æ“ï¼šVelocityï¼ˆä¸åšé‡ç‚¹è®²è§£ï¼Œå®ƒçš„é¡µé¢ä¸»è¦ä½¿ç”¨çš„BootStrapçš„Adminå¼€æºæ¡†æ¶ï¼‰ åå°ï¼šSSMæ¡†æ¶ ä»»åŠ¡è°ƒåº¦æ¡†æ¶ï¼šQuartz å·¥ä½œæµå¼•æ“ï¼šActivity æƒé™æ§åˆ¶æ¡†æ¶ï¼šShiro é¡¹ç›®åŠŸèƒ½ åˆ©ç”¨Shiroå®ç°ç™»å½•æ¨¡å—å¹¶å®ç°æƒé™æ§åˆ¶ å®ç°æŸ¥çœ‹å‡ºå‹¤è®°å½• åˆ©ç”¨Quartzå®ç°å®šæ—¶ä»»åŠ¡ï¼Œæ¯å¤©å‡Œæ™¨æ‰«ææ²¡æœ‰æ‰“å¡è®°å½•çš„å‘˜å·¥å¹¶è®°å½• åˆ©ç”¨Activityå®ç°è¡¥ç­¾æµç¨‹ é¡¹ç›®æºç HelloWorld_Shiro Activity ä¹‹ WorkAttendanceè€ƒå‹¤é¡¹ç›® é‡ç‚¹æºç è¯´æ˜åˆ©ç”¨Shiroå®ç°ç™»å½•ä¸æƒé™æ§åˆ¶æˆ‘ä»¬è¿™é‡Œä¸»è¦åˆ©ç”¨äº†Shiroæ¥è¿›è¡Œç™»å½•éªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹çœ‹Shiroæ¶æ„ï¼Œå¦‚ä¸‹å›¾ï¼š Subjectä¸»è¦æ˜¯å­˜å‚¨äº†è®¿é—®ä¿¡æ¯ SecurityManageræ˜¯Shiroçš„æ ¸å¿ƒï¼Œä»–ä¸»è¦ç”¨äºåè°ƒShiroå†…éƒ¨å„ç§å®‰å…¨ç»„ä»¶ Realmç”¨äºè¿æ¥Shiroå’Œå®¢æˆ·ç³»ç»Ÿçš„ç”¨æˆ·æ•°æ®çš„æ¡¥æ¢ã€‚ä¸€æ—¦ShiroçœŸæ­£éœ€è¦è®¿é—®å„ç§å®‰å…¨ç›¸å…³çš„æ•°æ®ï¼ˆæ¯”å¦‚ä½¿ç”¨ç”¨æˆ·è´¦æˆ·æ¥åšç”¨æˆ·èº«ä»½éªŒè¯ä»¥åŠæƒé™éªŒè¯ï¼‰æ—¶ï¼Œä»–æ€»æ˜¯é€šè¿‡è°ƒç”¨ç³»ç»Ÿé…ç½®çš„å„ç§Realmæ¥è¯»å–æ•°æ®ï¼Œå¯ä»¥å¯¹æ¯”ä¸ºSpringSecurityçš„Providerã€‚ Shrioé…ç½®æ–‡ä»¶ä¸»è¦æ˜¯WorkAttendance/src/main/resources/spring-shiro.xmlï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é™¤äº†é…ç½®Realmå’ŒSecurityManagerï¼Œè¿˜è¦é…ç½®ä¸€ä¸ªShiroFilterè¿‡æ»¤é“¾ï¼Œè¿™ä¸ªè¿‡æ»¤é“¾ä¸»è¦é…ç½®è¦æ‹¦æˆªæˆ–è€…å¿½ç•¥çš„è·¯å¾„ï¼Œå¯ä»¥å¯¹æ¯”ä¸ºSpringSecurityçš„é…ç½®ç±»WebSecurityConfigurerAdapterã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£æ¥å®ç°è·¯å¾„æƒé™æ§åˆ¶ï¼Œå¦‚: @RequiresPermissions(â€œattend:attendListâ€) æˆ‘ä»¬çœ‹çœ‹ç™»å½•æºä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879// LoginControllerçš„éªŒè¯ç™»å½•çš„æ–¹æ³•public String checkLogin(HttpServletRequest request) throws UnsupportedEncodingException, NoSuchAlgorithmException &#123; String username = request.getParameter("username"); String pwd = request.getParameter("password"); // ç»„è£…æˆTokenç»™Realmä½¿ç”¨ UsernamePasswordToken token = new UsernamePasswordToken(username,pwd); // ç­‰åˆ°ç™»å½•è®¿é—®ä¿¡æ¯ Subject subject = SecurityUtils.getSubject(); try &#123; // è¿›å…¥Realmè¿›è¡Œè®¤è¯ subject.login(token); // è®¾ç½®sessionè¿‡æœŸæ—¶é—´ SecurityUtils.getSubject().getSession().setTimeout(1800000); &#125; catch (Exception e) &#123; return "login_fail"; &#125; return "login_succ";&#125;// è‡ªå®šä¹‰çš„Realmpublic class MyRealm extends AuthorizingRealm &#123; @Autowired private UserService userService;// æˆæƒ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123; // PrincipalCollection,å¯ä»¥ç†è§£èº«ä»½ä¸Šä¸‹æ–‡ String username = (String) principalCollection.getPrimaryPrincipal(); User user = userService.findUserByUserName(username); SimpleAuthorizationInfo authorizationInfo = new SimpleAuthorizationInfo(); for(Role role :user.getRoleList())&#123; authorizationInfo.addRole(role.getRole()); for(Permission permission :role.getPermissionList())&#123; authorizationInfo.addStringPermission(permission.getPermission()); &#125; &#125; return authorizationInfo; &#125;// ç™»å…¥éªŒè¯ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123; // UsernamePasswordTokenå°è£…äº†ç”¨æˆ·åå’Œå¯†ç  UsernamePasswordToken usernamePasswordToke = (UsernamePasswordToken)authenticationToken; String username = usernamePasswordToke.getUsername(); User user = userService.findUserByUserName(username); if(user==null)&#123; return null; &#125;else &#123; // ä¼šä½¿ç”¨è‡ªå®šä¹‰çš„è´¦å·å¯†ç æ ¡éªŒå™¨è¿›è¡ŒéªŒè¯ï¼Œå¹¶è¿”å›AuthenticationInfo AuthenticationInfo info = new SimpleAuthenticationInfo(user.getUsername(), user.getPassword(), getName()); SecurityUtils.getSubject().getSession().setAttribute("userInfo",user); return info; &#125; &#125;&#125;// è‡ªå®šä¹‰çš„å¯†ç éªŒè¯å™¨ï¼Œé…ç½®æ–‡ä»¶ä¸­é…ç½®public class CustomCredentialsMatcher extends SimpleCredentialsMatcher &#123; @Override public boolean doCredentialsMatch(AuthenticationToken authenticationToken, AuthenticationInfo authenticationInfo) &#123; // å¯¹æ¯”ç”¨æˆ·ç™»å…¥çš„æ•°æ®ä¸æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥çš„ä¿¡æ¯ try &#123; UsernamePasswordToken usernamePasswordToken = (UsernamePasswordToken) authenticationToken; // ç”¨æˆ·ç™»å½•çš„å¯†ç  String password = String.valueOf(usernamePasswordToken.getPassword()); Object tokenCredentials = MD5Utils.encryptPassword(password); // getCredentials()å’Œequalséƒ½æ˜¯SimpleCredentialsMatcherè‡ªå¸¦çš„æ–¹æ³• Object acountCredentials = getCredentials(authenticationInfo); return equals(tokenCredentials,acountCredentials); &#125; catch (NoSuchAlgorithmException e) &#123; e.printStackTrace(); &#125; catch (UnsupportedEncodingException e) &#123; e.printStackTrace(); &#125; return false; &#125;&#125; åˆ©ç”¨Quartzå®ç°å®šæ—¶ä»»åŠ¡å®ƒçš„æ ¸å¿ƒå…ƒç´ å…³ç³»å›¾å¦‚ä¸‹ï¼š å®ƒçš„é…ç½®æ–‡ä»¶åœ¨WorkAttendance/src/main/resources/spring-job.xmlï¼Œæˆ‘ä»¬ä¹Ÿä¸»è¦å°±æ˜¯é…ç½®SchedulerFactoryï¼ŒTriggerå’ŒJobã€‚é‡Œé¢å…³äºcronExpressionå¯ä»¥ä½¿ç”¨åœ¨çº¿Cronè¡¨è¾¾å¼ç”Ÿæˆå™¨æ¥ç¡®å®šæˆ–è€…ä¹¦å†™ã€‚ æˆ‘ä»¬çœ‹çœ‹å®šæ—¶ä»»åŠ¡çš„æºä»£ç ï¼š12345678910// å…¶å®å¾ˆç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­ä»¥åŠé…ç½®å¥½è¦è§¦å‘çš„ç±»å’Œæ–¹æ³•äº†public class AttendCheckTask &#123; @Autowired private AttendService attendService; // JobMethod public void checkAttend() &#123; attendService.checkAttend(); &#125;&#125; åˆ©ç”¨Activityå®ç°è¡¥ç­¾æµç¨‹å®ƒçš„é…ç½®æ–‡ä»¶ä¸»è¦åœ¨WorkAttendance/src/main/resources/spring-activity.xmlï¼Œæˆ‘ä»¬ä¸»è¦å°±æ˜¯é…ç½®processEngineFactoryï¼ŒprocessEngineConfigurationï¼ˆä¼šè®¾ç½®è‡ªåŠ¨å»ºè¡¨23å¼ ä»¥åŠè¦éƒ¨ç½²çš„æµç¨‹èµ„æºï¼‰ä»¥åŠå„ä¸ªæœåŠ¡ç±»ã€‚ å…³äºæµç¨‹èµ„æºæˆ‘ä»¬å¯ä»¥åˆ©ç”¨IDEAçš„actiBPMæ’ä»¶å»ç”»è¿™ä¸ªæµç¨‹å›¾ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è®¾ç½®å¥½å„ä¸ªIDï¼Œå› ä¸ºæˆ‘ä»¬åé¢éœ€è¦ç”¨åˆ°å®ƒã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å®ƒçš„æ ¸å¿ƒä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859// 1. å¼€å§‹æµç¨‹å¹¶æäº¤ä»»åŠ¡public void startReAttendFlow(ReAttend reAttend) &#123; // ä»å…¬å¸ç»„ç»‡æ¶æ„ä¸­ï¼ŒæŸ¥è¯¢åˆ°æ­¤äººä¸Šçº§é¢†å¯¼äººç”¨æˆ·å // è¿™é‡Œæ‰‹åŠ¨è®¾ç½® reAttend.setCurrentHandler("rex666"); reAttend.setStatus(RE_ATTEND_STATUS_ONGOING); // æ’å…¥æ•°æ®åº“è¡¥ç­¾è¡¨(IDè‡ªå¢) reAttendMapper.insertSelective(reAttend); // å°†ä¸€äº›éœ€è¦çš„å‚æ•°æ”¾å…¥æµç¨‹ä¸­ä¼ é€’ï¼Œå³Variables Map&lt;String, Object&gt; map = new HashMap&lt;String, Object&gt;(); map.put(RE_ATTEND_SIGN, reAttend); // åé¢éœ€è¦æ ¹æ®æµç¨‹ä¸­çš„å˜é‡åæ¥è·å– map.put(NEXT_HANDLER, reAttend.getCurrentHandler()); // è·å¾—æµç¨‹å®ä¾‹ ProcessInstance instance = runtimeService.startProcessInstanceByKey(RE_ATTEND_FLOW_ID, map); // è·å¾—ä»»åŠ¡ Task task = taskService.createTaskQuery().processInstanceId(instance.getId()).singleResult(); // æäº¤ç”¨æˆ·è¡¥ç­¾ä»»åŠ¡ taskService.complete(task.getId(), map);&#125;// 2. å½“å‰å¤„ç†äººè·å¾—éœ€è¦å¤„ç†çš„ä»»åŠ¡public List&lt;ReAttend&gt; listTasks(String userName) &#123; //è½¬æ¢æˆé¡µé¢å®ä½“ éœ€è¦è¿”å›çš„å¯¹è±¡ List&lt;ReAttend&gt; reAttendList = new ArrayList&lt;ReAttend&gt;(); List&lt;Task&gt; taskList = taskService.createTaskQuery().processVariableValueEquals(userName).list(); if (CollectionUtils.isNotEmpty(taskList)) &#123; for (Task task : taskList) &#123; Map&lt;String, Object&gt; variable = taskService.getVariables(task.getId()); ReAttend reAttend = (ReAttend) variable.get(RE_ATTEND_SIGN); reAttend.setTaskId(task.getId()); reAttendList.add(reAttend); &#125; &#125; return reAttendList;&#125;// 3.å½“å‰å¤„ç†äººå¤„ç†ä»»åŠ¡@Transactionalpublic void approve(ReAttend reAttend) &#123; // éœ€è¦å¤„ç†çš„ä»»åŠ¡ Task task = taskService.createTaskQuery().taskId(reAttend.getTaskId()).singleResult(); // å¦‚æœåŒæ„ if (("" + RE_ATTEND_STATUS_PSSS).equals(reAttend.getApproveFlag())) &#123; Attend attend = new Attend(); attend.setId(reAttend.getAttendId()); attend.setAttendStatus(ATTEND_STATUS_NORMAL); // å°†å‡ºå‹¤æ•°æ®çš„çŠ¶æ€ä»å¼‚å¸¸å˜ä¸ºæ­£å¸¸ attendMapper.updateByPrimaryKeySelective(attend); // å®¡æ‰¹é€šè¿‡ï¼Œä¿®æ”¹è¡¥ç­¾æ•°æ®çŠ¶æ€ reAttend.setStatus(RE_ATTEND_STATUS_PSSS); reAttendMapper.updateByPrimaryKeySelective(reAttend); &#125; else if (("" + RE_ATTEND_STATUS_REFUSE.toString()).equals(reAttend.getApproveFlag())) &#123; reAttend.setStatus(RE_ATTEND_STATUS_REFUSE); reAttendMapper.updateByPrimaryKeySelective(reAttend); &#125; // å®Œæˆä»»åŠ¡ taskService.complete(task.getId());&#125; å…¶ä»–è¿™ä¸ªé¡¹ç›®å…³äºå‰ç«¯é¡µé¢å‰ç«¯æ¨¡æ¿å¼•æ“Velocityï¼ŒSSMæ¶æ„ï¼ŒMybatisè‡ªåŠ¨ç”Ÿæˆæ’ä»¶ä»¥åŠåˆ†é¡µæ–¹æ³•ï¼Œè¿™é‡Œéƒ½ä¸å†å¤šè¯´ï¼Œé¡¹ç›®çš„æ³¨é‡Šåº”è¯¥ç®—æ˜¯å¾ˆå…¨äº†ï¼Œè®¤çœŸçœ‹å°±è¡Œã€‚ å‚è€ƒä¸è‡´è°¢ SSMå®æˆ˜-ç ç å‘˜å·¥è€ƒå‹¤ç³»ç»Ÿ]]></content>
      <categories>
        <category>HelloWorld</category>
      </categories>
      <tags>
        <tag>SSM</tag>
        <tag>Shiro</tag>
        <tag>Activity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HelloWorld_SpringBoot Angular]]></title>
    <url>%2F2018%2F04%2F25%2FHelloWorld%2FHelloWorld-SpringBoot-Angular%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå‰æ®µæ—¶é—´å†™äº†ä¸ªå‰åå°ä¸åˆ†ç¦»çš„SSMLoginï¼Œå¤§å®¶å¯èƒ½ä¼šè§‰å¾—å‰åå°ä¸åˆ†ç¦»å¤ªlowï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨SpringBoot+Angularæ­å»ºäº†ä¸€ä¸ªåˆ©ç”¨Tokenæ¥è¿›è¡Œèº«ä»½éªŒè¯çš„å‰åå°åˆ†ç¦»ç™»å½•Demoé¡¹ç›®ã€‚ é¡¹ç›®æºç SpringBoot+Angular Angularå‰ç«¯æœ¬æ–‡å‰ç«¯åŸºäºAngularå®˜æ–¹æ ·ä¾‹Tour of Heroesï¼Œè¯·å…ˆåˆ°å®˜ç½‘ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥æ‹·è´è‡ªå·±çš„é¡¹ç›®æºç ï¼ˆä¸è¿‡æœ€å¥½è¿˜æ˜¯ä¸€æ­¥æ­¥æ¥ï¼Œå…ˆå»å®˜ç½‘ä¸‹è½½æºç ï¼‰ï¼Œè¿™æ¬¡å‰ç«¯ä¸æ˜¯ä¸»è¦è®²è§£çš„åœ°æ–¹ï¼Œæ‰€ä»¥å®˜ç½‘æºç éƒ¨åˆ†å°±ä¸è¯´äº†ï¼Œè‡ªå·±å»çœ‹ã€‚æˆ‘åªè¯´å¢åŠ çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ loginç»„ä»¶ä¸‹é¢æ˜¯ç™»å½•çš„tsä»£ç ï¼š1234567891011121314151617181920212223242526272829export class LoginComponent implements OnInit &#123; // ç”¨æ¥æ¥æ”¶åå°çš„æ•°æ® model: any = &#123;&#125;; //æ³¨å…¥ä¾èµ–å¯¹è±¡ constructor( private router: Router, private authenticationService: AuthenticationService, ) &#123; &#125; ngOnInit() &#123; // é‡ç½®ç™»å½•çŠ¶æ€ this.authenticationService.logout(); &#125; login() &#123; // åˆ©ç”¨authenticationServiceè·å–å¯¹è±¡ this.authenticationService.login(this.model.username, this.model.password).subscribe( result =&gt; &#123; if (result) &#123; // ç™»å½•æˆåŠŸï¼Œè°ƒåˆ¶è·¯ç”± this.router.navigate(['dashboard']); &#125; else &#123; this.log('Username or Password is incorrect'); &#125; &#125; ) &#125;&#125; AuthenticationServiceæœåŠ¡çœ‹çœ‹å®ƒçš„ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849// httpå¤´ï¼Œä½¿ç”¨jsonä¼ é€’æ•°æ®const httpOptions = &#123; headers: new HttpHeaders(&#123;'Content-Type': 'application/json'&#125;)&#125;;@Injectable()export class AuthenticationService &#123; // è®¤è¯çš„url private url: string = `$&#123;environment.apiURL&#125;/auth`; constructor(private http: HttpClient) &#123; &#125; login(username: string, password: string): Observable&lt;boolean&gt; &#123; return this.http.post&lt;any&gt;(this.url,JSON.stringify(&#123;username: username, password: password&#125;),httpOptions).pipe( tap(response =&gt; &#123; // è·å¾—tokenè®¤è¯ let token = response.token; if (token) &#123; // å­˜å‚¨tokenåˆ°æµè§ˆå™¨localStorageä¸­ï¼Œä»¥åæ¯æ¬¡éƒ½å¸¦ç€å®ƒå»è¯·æ±‚æ•°æ® localStorage.setItem('currentUser',token); &#125; &#125;), catchError(err =&gt; &#123; console.error(err); return of (false); &#125; ) ) &#125; // ä»localStorageè·å¾—token getToken(): String &#123; return localStorage.getItem('currentUser'); &#125; logout(): void &#123; // æ¸…ç©ºtokenï¼Œé‚£ä¹ˆæ²¡æœ‰Tokenä¹Ÿå°±ä¸èƒ½åˆ·æ–°é¡µé¢äº† localStorage.removeItem('currentUser'); &#125; isLoggedIn(): boolean &#123; var token: String = this.getToken(); return token &amp;&amp; token.length &gt; 0; &#125;&#125; AuthenticationInterceptoræ‹¦æˆªå™¨æœ‰äº†è¿™ä¸ªæ‹¦æˆªå™¨ï¼Œä»¥åæ‰€æœ‰çš„è¯·æ±‚éƒ½è¿‡ç»è¿‡è¿™é‡Œï¼Œçœ‹çœ‹å®ƒçš„ä»£ç ï¼š12345678910111213141516171819@Injectable()export class AuthenticationInterceptor implements HttpInterceptor &#123; // next ç›¸å½“äºJava Filter çš„chain intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123; const idToken = localStorage.getItem('currentUser'); if (idToken) &#123; // å°†åŸæ¥çš„è¯·æ±‚åŠ ä¸ŠtokenåŒ…è£…æˆæ–°çš„è¯·æ±‚å‘é€ const cloned = req.clone(&#123; headers: req.headers.set('Authorization', 'Bearer ' + idToken) &#125;); return next.handle(cloned); &#125; else &#123; return next.handle(req); &#125; &#125;&#125; CanActivateAuthGuardä¿å«æœ‰äº†CanActivateAuthGuardå°±èƒ½å¤Ÿé˜²æ­¢æœªç™»å½•ç”¨æˆ·è®¿é—®å…¶ä»–é¡µé¢ï¼Œçœ‹çœ‹å®ƒçš„ä»£ç ï¼š12345678910111213141516171819@Injectable()export class CanActivateAuthGuard implements CanActivate &#123; constructor( public router: Router, private authService: AuthenticationService ) &#123;&#125; canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot) &#123; if (this.authService.isLoggedIn()) &#123; // å¯ä»¥é€šè¿‡ return true; &#125; // ä¸èƒ½é€šè¿‡ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢ this.router.navigate(['/login']); return false; &#125;&#125; Springbootåå°æˆ‘ä»¬é¦–å…ˆè¦å¯¹SpringBootçš„é¡¹ç›®ç»“æ„æœ‰ä¸ªç†Ÿæ‚‰çš„è®¤è¯†ï¼Œå¦‚æœä¸çŸ¥é“çš„å¯ä»¥å…ˆç¨å¾®äº†è§£ä¸€ä¸‹ä»–ï¼Œä»–å¤ªæ£’äº†ã€‚è¿™æ¬¡å¼€å‘ä¹Ÿæ˜¯ä¸Šå¸æ¨¡å¼ã€‚ SpringSecurityæƒé™æ§åˆ¶é¦–å…ˆæˆ‘ä»¬è¦å¯¹å‰å°çš„è¯·æ±‚è¿›è¡Œè®¤è¯ï¼Œåˆ©ç”¨é…ç½®æ–‡ä»¶è®¾ç½®ä¸€äº›å€¼ï¼š12345678910111213# æ§åˆ¶è·¨åŸŸè®¿é—®cors: allowedOrigins: &quot;*&quot; allowedMethods: GET,POST,DELETE,PUT,OPTIONS allowedHeaders: Origin,X-Requested-With,Content-Type,Accept,Accept-Encoding,Accept-Language,Host,Referer,Connection,User-Agent,Authorization# tokené…ç½®jwt: header: Authorization secret: mySecret expiration: 7200 issuer: IATA authenticationPath: /auth SpringSecurityé…ç½®ç±»åœ¨com.todorex.config.WebSecurityConfigç±»ä¸­ï¼Œåœ¨è¿™ä¸ªç±»ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯é…ç½®è®¤è¯è·¯å¾„ã€è·¨åŸŸè®¿é—®ä»¥åŠè¿‡æ»¤å™¨ç­‰è®¾ç½®ã€‚ SpringSecurityè‡ªå®šä¹‰è¿‡æ»¤å™¨åœ¨com.todorex.config.AuthenticationTokenFilterç±»ä¸­ï¼Œä¸»è¦æ˜¯éªŒè¯tokenï¼Œä½†ä¸é‡æ–°è®¡ç®—tokenã€‚ tokenç”Ÿæˆæ–¹æ³•åœ¨com.todorex.util.JwtTokenUtilç±»ä¸­ï¼Œä¸»è¦æœ‰ç”Ÿæˆtokenä»¥åŠéªŒè¯tokençš„æ–¹æ³•ã€‚ Contollerä¸»è¦æ˜¯æ§åˆ¶å¤„ç†URLï¼Œå…¶ä¸­æ¯”è¾ƒé‡è¦çš„å°±æ˜¯com.todorex.controller.AuthenticationControllerç±»ï¼Œå®ƒæ˜¯ç”¨æ¥è¿›è¡Œæƒé™è®¤è¯çš„ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„ä»£ç ï¼š123456789101112131415161718192021222324252627282930@RestController@RequestMapping(produces = MediaType.APPLICATION_JSON_VALUE)public class AuthenticationController &#123; @Autowired private AuthenticationManager authenticationManager; @Autowired private JwtTokenUtil jwtTokenUtil; @Autowired private UserDetailsService userDetailsService; // è¯·æ±‚è·¯å¾„(/auth) @PostMapping(value = "$&#123;jwt.authenticationPath&#125;") public AuthenticationResponse login(@RequestBody AuthenticationRequest request) throws AuthenticationException &#123; // å¯¹åŒ…è£…è¿‡åçš„UsernamePasswordAuthenticationTokenç²¾å¿ƒå†åŒ…è£…æˆAuthentication final Authentication authentication = authenticationManager.authenticate(new UsernamePasswordAuthenticationToken(request.getUsername(), request.getPassword())); // å°†è¯¥è®¤è¯æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼ˆé¿å…å¤šæ¬¡éªŒè¯ï¼‰ // SecurityContextHolderç”¨äºå­˜å‚¨å®‰å…¨ä¸Šä¸‹æ–‡ï¼ˆsecurity contextï¼‰çš„ä¿¡æ¯ SecurityContextHolder.getContext().setAuthentication(authentication); final UserDetails userDetails = userDetailsService.loadUserByUsername(request.getUsername()); // å®é™…åº”ç”¨ä¸­ï¼Œç”Ÿæˆtokenæ—¶å¯èƒ½ä¼šç”¨åˆ°æ›´å¤šçš„å‚æ•° final String token = jwtTokenUtil.generate(userDetails.getUsername()); // è¿”å›Token return new AuthenticationResponse(token); &#125;&#125; å…¶ä»–éƒ½æ˜¯æ™®é€šçš„Controllerï¼Œä½†æ˜¯å¯¹äºURLçš„è®¾è®¡æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯ç”¨Restfulé£æ ¼çš„URLï¼Œè¿™ç§é£æ ¼æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å‚è€ƒä¸‹é¢çš„åšæ–‡ï¼šã€Restfulã€‘ä¸‰åˆ†é’Ÿå½»åº•äº†è§£Restfulæœ€ä½³å®è·µã€‚ Serviceä¸»è¦æ˜¯å¤„ç†ä¸šåŠ¡çš„ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„çš„è¿™ä¸ªç±»ï¼šcom.todorex.service.UserDetailsServiceImplï¼Œæˆ‘ä»¬éœ€è¦å®ç°UserDetailsServiceæ¥å£ï¼Œå› ä¸ºSpringSecurityæ–¹æ³•ä¼šç”¨åˆ°ï¼Œçœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839@Servicepublic class UserDetailsServiceImpl implements UserDetailsService&#123; @Autowired private UserRepository userRepository; @Override public UserDetails loadUserByUsername(String s) throws UsernameNotFoundException &#123; User user = userRepository.findByUsername(s); if (user == null) &#123; throw new UsernameNotFoundException(String.format("No user found with username '%s'.", s)); &#125; else &#123; return create(user); &#125; &#125; /** * åŒ…è£…æˆSpringSecurityéœ€è¦çš„User * @param user * @return */ private static org.springframework.security.core.userdetails.User create(User user) &#123; return new org.springframework.security.core.userdetails.User(user.getUsername(), user.getPassword(), mapToGrantedAuthorities(user.getAuthorities())); &#125; /** * åŒ…è£…æƒé™ * @param authorities * @return */ private static List&lt;GrantedAuthority&gt; mapToGrantedAuthorities(List&lt;Authority&gt; authorities) &#123; // Java8è¯­æ³• return authorities.stream() .map(authority -&gt; new SimpleGrantedAuthority(authority.getName().name())) .collect(Collectors.toList()); &#125;&#125; Daoè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„JPAï¼Œå®ƒå†…éƒ¨å®ç°æ˜¯Hibernateï¼Œæˆ‘ä»¬åªè¦å…ˆå®šä¹‰Entityå†å®šä¹‰Daoç±»å°±å¯ä»¥äº†ã€‚ EntityEntityå®šä¹‰ä¹‹åå¯ä»¥æ ¹æ®å®ä½“è‡ªåŠ¨å»ºè¡¨ï¼ˆå¯åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼‰ï¼Œå¦‚ä¸‹ï¼š1234567# jpaé…ç½® jpa: database: MYSQL show-sql: true hibernate: # è¡¨ä¸å­˜åœ¨å°±è‡ªåŠ¨å»ºè¡¨ ddl-auto: create DaoDaoæ¥å£åªè¦ç»§æ‰¿JpaRepositoryå°±ä¼šæœ‰å¾ˆå¤šå†…ç½®æ–¹æ³•ï¼Œå¦‚æœè¦è‡ªå·±å†™SQLä¹Ÿå¯ä»¥å‚ç…§com.todorex.HeroRepositoryçš„å†™æ³•ã€‚ å•å…ƒæµ‹è¯•æˆ‘ä»¬å¯ä»¥å…ˆå®šä¹‰æ€»çš„æ¥å£ï¼š1234@RunWith(SpringRunner.class)@SpringBootTestpublic class SpringBootTestAbstract &#123;&#125; ç„¶åæ¯ä¸ªè¦æµ‹è¯•çš„ç±»ç»§æ‰¿ä»–å°±å¯ä»¥äº†ï¼Œé¿å…äº†é‡å¤é…ç½®ï¼ŒIDEAè¿˜æœ‰å¾ˆå¤šæŠ€å·§ï¼Œè‡ªå·±å¯ä»¥å»baiduã€googleï¼Œè¿™é‡Œä¹Ÿä¸¾ä¸ªä¾‹å­ï¼š12345678910111213141516public class DataSourceTest extends SpringBootTestAbstract&#123; @Autowired ApplicationContext applicationContext; @Autowired DataSourceProperties dataSourceProperties; @Test public void testDataSource() throws Exception &#123; // è·å–é…ç½®çš„æ•°æ®æº DataSource dataSource = applicationContext.getBean(DataSource.class); // æŸ¥çœ‹é…ç½®æ•°æ®æºä¿¡æ¯ System.out.println(dataSource); System.out.println(dataSource.getClass().getName()); System.out.println(dataSourceProperties); &#125;&#125; æ—¥å¿—SpringBooté»˜è®¤ä½¿ç”¨logbackä½œä¸ºæ—¥å¿—æ¡†æ¶ï¼Œæˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹é…ç½®ï¼š123456789# æ—¥å¿—é…ç½®logging: level: # é…ç½®åŒ…ä»¥åŠè¾“å‡ºç­‰çº§ com.todorex: debug pattern: console: &quot;%d - %msg%n&quot; path: /var/localLog/ file: /var/localLog/springbootdemo.log å‚è€ƒ Angular 5é›†æˆSpring Boot,Spring Security,JWTå’ŒCORS Angular_Heroesæ•™ç¨‹ æ­ç§˜SpringSecurity(ä¸€)_è¯·æ±‚è®¤è¯è¿‡ç¨‹ æ­ç§˜SpringBoot(ä¸€)_SpringBootè¿è¡ŒåŸç† ã€Restfulã€‘ä¸‰åˆ†é’Ÿå½»åº•äº†è§£Restfulæœ€ä½³å®è·µ ä»€ä¹ˆæ˜¯ JWT â€“ JSON WEB TOKEN ajax è·¨åŸŸ CROS Spring Boot æ—¥å¿—é…ç½®(è¶…è¯¦ç»†)]]></content>
      <categories>
        <category>HelloWorld</category>
      </categories>
      <tags>
        <tag>SpringBoot</tag>
        <tag>SpringSecurity</tag>
        <tag>JWT</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜SpringSecurity(ä¸€)_è¯·æ±‚è®¤è¯è¿‡ç¨‹]]></title>
    <url>%2F2018%2F04%2F25%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98SpringSecurity-%E4%B8%80-%E8%AF%B7%E6%B1%82%E8%AE%A4%E8%AF%81%E8%BF%87%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæœ‰äº†Springä½œä¸ºåŸºç¡€ï¼ŒSpringå®¶æ—çš„å¾ˆå¤šæ¡†æ¶éƒ½æ˜¾å¾—é‚£ä¹ˆæ£’ï¼Œå°¤å…¶æ˜¯Springbootçš„å‡ºç°ï¼Œç®€åŒ–äº†é…ç½®ï¼Œå®¶æ—æ¡†æ¶å°±æ˜¾å¾—æ›´æ£’äº†ï¼Œæˆ‘ä»¬è¿™æ¬¡åˆ†æä¸€ä¸‹å…¶ä¸­çš„SpringSecurityï¼Œæˆ‘ä»¬ä¼šç”±è¯·æ±‚è®¤è¯è¿‡ç¨‹ï¼Œæ¥åˆ†æå…¶ä¸­çš„å„ä¸ªç»„ä»¶ï¼ ä¸€æ¬¡è®¤è¯è¿‡ç¨‹ å¤§å®¶å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå·¥ç¨‹ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥çœ‹çœ‹æˆ‘çš„SpringBoot+Angularå·¥ç¨‹debugéªŒè¯æˆ‘ç”»çš„æµç¨‹å›¾ã€‚ æ ¸å¿ƒç»„ä»¶Filteråœ¨æœ€å¼€å§‹debugçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¼šå‘ç°pring Securityä½¿ç”¨äº†springSecurityFillterChianä½œä¸ºäº†å®‰å…¨è¿‡æ»¤çš„å…¥å£ï¼Œæˆ‘åªä»‹ç»å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„è¿‡æ»¤å™¨ã€‚ SecurityContextPersistenceFilterä¸¤ä¸ªä¸»è¦èŒè´£ï¼š è¯·æ±‚æ¥ä¸´æ—¶ï¼Œåˆ›å»ºSecurityContextå®‰å…¨ä¸Šä¸‹æ–‡ä¿¡æ¯ è¯·æ±‚ç»“æŸæ—¶æ¸…ç©ºSecurityContextHolderï¼ˆå¯è·å¾—å½“å‰æ“ä½œçš„ç”¨æˆ·æ˜¯è°ï¼Œè¯¥ç”¨æˆ·æ˜¯å¦å·²ç»è¢«è®¤è¯ï¼Œä»–æ‹¥æœ‰å“ªäº›è§’è‰²æƒé™ç­‰ä¿¡æ¯ï¼‰ã€‚ æˆ‘ä»¬çœ‹çœ‹å®ƒçš„æºç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public class SecurityContextPersistenceFilter extends GenericFilterBean &#123; static final String FILTER_APPLIED = "__spring_security_scpf_applied"; // å®‰å…¨ä¸Šä¸‹æ–‡å­˜å‚¨çš„ä»“åº“ private SecurityContextRepository repo; public SecurityContextPersistenceFilter() &#123; // HttpSessionSecurityContextRepositoryæ˜¯SecurityContextRepositoryæ¥å£çš„ä¸€ä¸ªå®ç°ç±» // ä½¿ç”¨HttpSessionæ¥å­˜å‚¨SecurityContext this(new HttpSessionSecurityContextRepository()); &#125; public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException &#123; HttpServletRequest request = (HttpServletRequest)req; HttpServletResponse response = (HttpServletResponse)res; if(request.getAttribute("__spring_security_scpf_applied") != null) &#123; chain.doFilter(request, response); &#125; else &#123; boolean debug = this.logger.isDebugEnabled(); request.setAttribute("__spring_security_scpf_applied", Boolean.TRUE); if(this.forceEagerSessionCreation) &#123; HttpSession session = request.getSession(); if(debug &amp;&amp; session.isNew()) &#123; this.logger.debug("Eagerly created session: " + session.getId()); &#125; &#125; // åŒ…è£…requestï¼Œresponse HttpRequestResponseHolder holder = new HttpRequestResponseHolder(request, response); // ä»Sessionä¸­è·å–å®‰å…¨ä¸Šä¸‹æ–‡ä¿¡æ¯ SecurityContext contextBeforeChainExecution = this.repo.loadContext(holder); boolean var13 = false; try &#123; var13 = true; // è¯·æ±‚å¼€å§‹æ—¶ï¼Œè®¾ç½®å®‰å…¨ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¿™æ ·å°±é¿å…äº†ç”¨æˆ·ç›´æ¥ä»Sessionä¸­è·å–å®‰å…¨ä¸Šä¸‹æ–‡ä¿¡æ¯ SecurityContextHolder.setContext(contextBeforeChainExecution); chain.doFilter(holder.getRequest(), holder.getResponse()); var13 = false; &#125; finally &#123; if(var13) &#123; SecurityContext contextAfterChainExecution = SecurityContextHolder.getContext();\ //è¯·æ±‚ç»“æŸåï¼Œæ¸…ç©ºå®‰å…¨ä¸Šä¸‹æ–‡ä¿¡æ¯ SecurityContextHolder.clearContext(); this.repo.saveContext(contextAfterChainExecution, holder.getRequest(), holder.getResponse()); request.removeAttribute("__spring_security_scpf_applied"); &#125; &#125; ... &#125; &#125;&#125; UsernamePasswordAuthenticationFilterè¿™ä¸ªå¯èƒ½æ˜¯æˆ‘ä»¬é‡è§æœ€å¤šçš„è¿‡æ»¤å™¨äº†ï¼Œä¸€ä¸ªæœ€ç›´è§‚çš„ä¸šåŠ¡åœºæ™¯ä¾¿æ˜¯å…è®¸ç”¨æˆ·åœ¨è¡¨å•ä¸­è¾“å…¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œè€Œè¿™èƒŒåç”¨åˆ°çš„å°±æ˜¯UsernamePasswordAuthenticationFilterã€‚è¿™ä¸ªè¿‡æ»¤å™¨ä¹Ÿå¯ä»¥è§è¯æˆ‘ä»¬ä¹‹å‰ç”»çš„æ—¶åºå›¾ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„æºç ï¼š123456789101112131415161718192021public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException &#123; if(this.postOnly &amp;&amp; !request.getMethod().equals("POST")) &#123; throw new AuthenticationServiceException("Authentication method not supported: " + request.getMethod()); &#125; else &#123; // è·å–ç”¨æˆ·åï¼Œå¯†ç  String username = this.obtainUsername(request); String password = this.obtainPassword(request); if(username == null) &#123; username = ""; &#125; if(password == null) &#123; password = ""; &#125; username = username.trim(); // ç”ŸæˆAuthenticationï¼Œä¸‹é¢ä¼šä»‹ç» UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(username, password); this.setDetails(request, authRequest); // è®²Authenticationäº¤ç»™AuthenticationManagerè®¤è¯ return this.getAuthenticationManager().authenticate(authRequest); &#125; &#125; è‡ªå®šä¹‰Filterå½“è‡ªå¸¦çš„Filterä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚æ—¶ï¼ˆä¾‹å¦‚æˆ‘ä»¬è¦å…ˆå¯¹tokenè¿›è¡Œè®¤è¯ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œåªè¦ç»§æ‰¿å„ç§Filteræ¥å£ï¼Œå¹¶å®ç°å…¶ä¸­æ–¹æ³•å³å¯ã€‚ Authenticationå…ˆçœ‹ä»–çš„æºç ï¼š12345678910111213public interface Authentication extends Principal, Serializable &#123; // æƒé™ä¿¡æ¯åˆ—è¡¨ Collection&lt;? extends GrantedAuthority&gt; getAuthorities(); // å¯†ç ä¿¡æ¯ï¼Œç”¨æˆ·è¾“å…¥çš„å¯†ç å­—ç¬¦ä¸²ï¼Œåœ¨è®¤è¯è¿‡åé€šå¸¸ä¼šè¢«ç§»é™¤ï¼Œç”¨äºä¿éšœå®‰å…¨ Object getCredentials(); // ç»†èŠ‚ä¿¡æ¯ï¼Œå®ƒè®°å½•äº†è®¿é—®è€…çš„ipåœ°å€å’ŒsessionIdçš„å€¼ã€‚ Object getDetails(); // æœ€é‡è¦çš„èº«ä»½ä¿¡æ¯ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿”å›çš„æ˜¯UserDetailsæ¥å£çš„å®ç°ç±» Object getPrincipal(); // æ˜¯å¦å·²è®¤è¯ boolean isAuthenticated(); void setAuthenticated(boolean var1) throws IllegalArgumentException;&#125; ä»å®ƒçš„æºç å¯ä»¥çŸ¥é“å®ƒæ‹¥æœ‰çš„æƒé™ä¿¡æ¯åˆ—è¡¨ï¼Œå¯†ç ï¼Œç”¨æˆ·ç»†èŠ‚ä¿¡æ¯ï¼Œç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œè®¤è¯ä¿¡æ¯ã€‚ å®ƒæœ‰å¾ˆå¤šå®ç°ç±»ï¼Œæ¯”å¦‚æµç¨‹å›¾ä¸­çš„UsernamePasswordAuthenticationTokenï¼Œä»¥åŠAnonymousAuthenticationTokenç­‰ã€‚ AuthenticationManagerå…ˆçœ‹çœ‹å®ƒçš„æºç ï¼š1234public interface AuthenticationManager &#123; // ä¸»è¦æ˜¯è®¤è¯ä¼ è¿›æ¥çš„Authentication Authentication authenticate(Authentication var1) throws AuthenticationException;&#125; å®ƒæœ€æœ‰ç”¨çš„å®ç°ç±»å°±æ˜¯æµç¨‹å›¾ä¸­çš„ProviderManagerï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®ƒçš„æºç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public class ProviderManager implements AuthenticationManager, MessageSourceAware, InitializingBean &#123; // ç»´æŠ¤ä¸€ä¸ªAuthenticationProvideråˆ—è¡¨ private List&lt;AuthenticationProvider&gt; providers; private boolean eraseCredentialsAfterAuthentication; public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123; Class&lt;? extends Authentication&gt; toTest = authentication.getClass(); AuthenticationException lastException = null; // è¦ä»æ–°è¿”å›çš„Authentication Authentication result = null; // éå†AuthenticationProvideråˆ—è¡¨ Iterator var6 = this.getProviders().iterator(); while(var6.hasNext()) &#123; AuthenticationProvider provider = (AuthenticationProvider)var6.next(); if(provider.supports(toTest)) &#123; try &#123; // å¯¹ä¼ è¿›æ¥çš„authenticationè¿›è¡Œè®¤è¯ result = provider.authenticate(authentication); if(result != null) &#123; // å°†å±æ€§å¤åˆ¶ç»™result this.copyDetails(authentication, result); break; &#125; &#125; catch (AccountStatusException var11) &#123; ... &#125; &#125; &#125; if(result == null &amp;&amp; this.parent != null) &#123; try &#123; // å¦‚æœåˆ—è¡¨é‡Œçš„Provideréƒ½ä¸æ”¯æŒè¯¥authenticationï¼Œåˆ™åˆ°çˆ¶ç±»æŸ¥æ‰¾ result = this.parent.authenticate(authentication); &#125; catch (ProviderNotFoundException var9) &#123; ; &#125; catch (AuthenticationException var10) &#123; lastException = var10; &#125; &#125; if(result != null) &#123; if(this.eraseCredentialsAfterAuthentication &amp;&amp; result instanceof CredentialsContainer) &#123; // æ“¦é™¤å¯†ç ä¿¡æ¯ ((CredentialsContainer)result).eraseCredentials(); &#125; this.eventPublisher.publishAuthenticationSuccess(result); return result; &#125; else &#123; ... &#125; &#125; AuthenticationProviderçœ‹çœ‹å®ƒçš„æºç å…ˆï¼š123456public interface AuthenticationProvider &#123; // è®¤è¯ Authentication authenticate(Authentication var1) throws AuthenticationException; // åˆ¤æ–­æ˜¯å¦æ”¯æŒä¼ è¿›æ¥çš„Authentication boolean supports(Class&lt;?&gt; var1);&#125; æˆ‘ä»¬æ¥ç€çœ‹çœ‹å®ƒæœ€å¸¸ç”¨çš„ä¸€ä¸ªå®ç°DaoAuthenticationProviderã€‚ä¹Ÿçœ‹çœ‹å®ƒçš„æºç ï¼š1234567891011121314151617181920212223242526272829303132333435public class DaoAuthenticationProvider extends AbstractUserDetailsAuthenticationProvider &#123; // å¯†ç åŠ å¯†å™¨ private PasswordEncoder passwordEncoder; // åŠ è½½ç”¨æˆ·çš„UserDetailsService private UserDetailsService userDetailsService; protected void additionalAuthenticationChecks(UserDetails userDetails, UsernamePasswordAuthenticationToken authentication) throws AuthenticationException &#123; if(authentication.getCredentials() == null) &#123; ... &#125; else &#123; // éªŒè¯å¯†ç  String presentedPassword = authentication.getCredentials().toString(); if(!this.passwordEncoder.matches(presentedPassword, userDetails.getPassword())) &#123; ... &#125; &#125; &#125; // æœ€æ ¸å¿ƒçš„æ–¹æ³• protected final UserDetails retrieveUser(String username, UsernamePasswordAuthenticationToken authentication) throws AuthenticationException &#123; this.prepareTimingAttackProtection(); try &#123; // è·å¾—UserDetails UserDetails loadedUser = this.getUserDetailsService().loadUserByUsername(username); if(loadedUser == null) &#123; ... &#125; else &#123; return loadedUser; &#125; &#125; catch (UsernameNotFoundException var4) &#123; ... &#125; &#125;&#125; UserDetailsServiceå…ˆçœ‹çœ‹å®ƒçš„æºç ï¼š123public interface UserDetailsService &#123; UserDetails loadUserByUsername(String var1) throws UsernameNotFoundException;&#125; è¿™ä¸ªæ¥å£çš„å®ç°ç±»æœ‰JdbcDaoImplï¼ˆè´Ÿè´£ä»æ•°æ®åº“åŠ è½½ç”¨æˆ·ï¼‰ç­‰ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®ç°è¿™ä¸ªæ¥å£ã€‚åªè¦å®ç°loadUserByUsernameæ–¹æ³•å³å¯ã€‚ å†çœ‹çœ‹UserDetailsæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ çœ‹çœ‹å®ƒæºç ï¼š12345678910111213141516public interface UserDetails extends Serializable &#123; // æƒé™å±æ€§ Collection&lt;? extends GrantedAuthority&gt; getAuthorities(); // å¯†ç å±æ€§ String getPassword(); // ç”¨æˆ·åå±æ€§ String getUsername(); // è´¦æˆ·æ˜¯å¦è¿‡æœŸ boolean isAccountNonExpired(); // è´¦æˆ·æ˜¯å¦è¢«é” boolean isAccountNonLocked(); // å¯†ç æ˜¯å¦è¿‡æœŸ boolean isCredentialsNonExpired(); // æ˜¯å¦å¯ç”¨ boolean isEnabled();&#125; å®ƒä»£è¡¨äº†æœ€è¯¦ç»†çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸ªæ¥å£æ¶µç›–äº†ä¸€äº›å¿…è¦çš„ç”¨æˆ·ä¿¡æ¯å­—æ®µï¼Œå…·ä½“çš„å®ç°ç±»å¯¹å®ƒè¿›è¡Œäº†æ‰©å±•ã€‚è¿™é‡Œæˆ‘ä»¬æ™®é€šçš„Userç±»ä¹Ÿå¯ä»¥å®ç°è¿™ä¸ªæ¥å£ã€‚ æ ¸å¿ƒé…ç½®é€šè¿‡æˆ‘ä»¬ä¸Šé¢å¯¹æ ¸å¿ƒç»„ä»¶çš„è§£è¯»å†ç»“åˆæµç¨‹æµå°±åº”è¯¥å¯ä»¥ç†è§£SpringSecurityçš„è¯·æ±‚è®¤è¯è¿‡ç¨‹ã€‚ä½†æ˜¯ä¸å¯èƒ½æˆ‘ä»¬å¯¹æ‰€æœ‰çš„è·¯å¾„éƒ½éœ€è¦è®¤è¯ï¼Œæˆ–è€…è¯´å®ƒæ€»è¦æä¾›ä¸€ä¸ªä¸œè¥¿è®©æˆ‘ä»¬é…ç½®å®ƒçš„ç»†èŠ‚ï¼Œé‚£å°±æ˜¯WebSecurityConfigurerAdapteræ¥å£ï¼Œå®ƒä¸»è¦ä½¿ç”¨äº†é€‚é…å™¨æ¨¡å¼ã€‚æˆ‘ä»¬ä¸»è¦çœ‹çœ‹æˆ‘ä»¬éœ€è¦è¦†ç›–å®ƒçš„æ–¹æ³•ï¼š12345678910111213public abstract class WebSecurityConfigurerAdapter implements WebSecurityConfigurer&lt;WebSecurity&gt; &#123; // é…ç½®AuthenticationManagerBuilder protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123; this.disableLocalConfigureAuthenticationBldr = true; &#125; // é…ç½®WebSecurity public void configure(WebSecurity web) throws Exception &#123; &#125; // é…ç½®HttpSecurity protected void configure(HttpSecurity http) throws Exception &#123; ((HttpSecurity)((HttpSecurity)((AuthorizedUrl)http.authorizeRequests().anyRequest()).authenticated().and()).formLogin().and()).httpBasic(); &#125;&#125; é…ç½®AuthenticationManagerBuilderæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®ƒçš„ä½¿ç”¨æ¡ˆä¾‹ï¼š123456789public class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123; auth .inMemoryAuthentication() .withUser("admin").password("admin").roles("USER"); &#125;&#125; æƒ³è¦åœ¨WebSecurityConfigurerAdapterä¸­è¿›è¡Œè®¤è¯ç›¸å…³çš„é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨configure(AuthenticationManagerBuilder auth)æš´éœ²ä¸€ä¸ªAuthenticationManagerçš„å»ºé€ å™¨ï¼šAuthenticationManagerBuilder ã€‚å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬ä¾¿å®Œæˆäº†å†…å­˜ä¸­ç”¨æˆ·çš„é…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™é‡Œè®²è‡ªå·±å®šä¹‰çš„UserDetailServiceæ³¨å…¥ã€‚ é…ç½®WebSecurityæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®ƒçš„ä½¿ç”¨æ¡ˆä¾‹ï¼š12345678910111213141516171819202122232425262728293031public class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Override protected void configure(HttpSecurity http) throws Exception &#123; http // é…ç½®è·¯å¾„æ‹¦æˆªï¼Œè¡¨æ˜è·¯å¾„è®¿é—®æ‰€å¯¹åº”çš„æƒé™ï¼Œè§’è‰²ï¼Œè®¤è¯ä¿¡æ¯ã€‚ .authorizeRequests() .antMatchers("/resources/**", "/signup", "/about").permitAll() .antMatchers("/admin/**").hasRole("ADMIN") .antMatchers("/db/**").access("hasRole('ADMIN') and hasRole('DBA')") .anyRequest().authenticated() .and() // é…ç½®è¡¨å•è®¤è¯ .formLogin() .usernameParameter("username") .passwordParameter("password") .failureForwardUrl("/login?error") .loginPage("/login") .permitAll() .and() // é…ç½®æ³¨é”€ .logout() .logoutUrl("/logout") .logoutSuccessUrl("/index") .permitAll() .and() // é…ç½®basicç™»å½• .httpBasic() .disable(); &#125;&#125; æ–¹æ³•é‡Œçš„å„é¡¹é…ç½®åˆ†åˆ«ä»£è¡¨äº†httpè¯·æ±‚ç›¸å…³çš„å®‰å…¨é…ç½®ï¼Œè¿™äº›é…ç½®é¡¹æ— ä¸€ä¾‹å¤–çš„è¿”å›äº†Configurerç±»ï¼Œè€Œæ‰€æœ‰çš„httpç›¸å…³é…ç½®å¯ä»¥é€šè¿‡æŸ¥çœ‹HttpSecurityçš„ä¸»è¦æ–¹æ³•å¾—çŸ¥ã€‚ WebSecurityBuilderæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®ƒçš„ä½¿ç”¨æ¡ˆä¾‹ï¼š12345678public class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Override public void configure(WebSecurity web) throws Exception &#123; web .ignoring() .antMatchers("/resources/**"); &#125;&#125; è¿™ä¸ªé…ç½®ä¸­å¹¶ä¸ä¼šå‡ºç°å¤ªå¤šçš„é…ç½®ä¿¡æ¯ã€‚ æ¶æ„ å°†è¿™ä¸ªæ¶æ„å›¾ç»“åˆæµç¨‹å›¾æˆ‘ä»¬ä¼šå¯ä»¥å¤§è‡´æ€»ç»“å‡ºæ ¸å¿ƒç»„ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œæœ‰åˆ©äºæˆ‘ä»¬æˆ‘ä»¬æ›´å¥½çš„ç†è§£SpringSecurityçš„æ¶æ„ä»¥åŠè¯·æ±‚è®¤è¯è¿‡ç¨‹ã€‚ å‚è€ƒ Spring Security(ä¸€)â€“Architecture Overview Spring Securityæºç åˆ†æä¸€ï¼šSpring Securityè®¤è¯è¿‡ç¨‹]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>SpringSecurity</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜SpringBoot(ä¸€)_SpringBootè¿è¡ŒåŸç†]]></title>
    <url>%2F2018%2F04%2F21%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98SpringBoot-%E4%B8%80-SpringBoot%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¯èƒ½ä½ æ—©å·²å¼€å§‹ä½¿ç”¨SpringBootï¼Œä½†æ˜¯ä½ å´ä¸çŸ¥é“SpringBootæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œä»–åˆæ˜¯æ€ä¹ˆè¿è¡Œçš„ï¼Œè¿™é‡Œç»™ä½ ç­”æ¡ˆï¼ SpringBootæ˜¯ä»€ä¹ˆç”¨è¿‡Springçš„äººéƒ½çŸ¥é“ï¼Œä½ è‚¯å®šéœ€è¦äº›å¾ˆå¤šå¾ˆå¤šçš„XMLæ¥ç”¨é…ç½®å¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œä½ è‚¯å®šåŒå€¦äº†ã€‚è¿™ä¸ªæ—¶å€™SpringBootå‡ºç°äº†ï¼ŒSpringBootæ˜¯ç”±Pivotalå›¢é˜Ÿæä¾›çš„å…¨æ–°æ¡†æ¶ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ç”¨æ¥ç®€åŒ–æ–°Springåº”ç”¨çš„åˆå§‹æ­å»ºä»¥åŠå¼€å‘è¿‡ç¨‹ã€‚è¯¥æ¡†æ¶ä½¿ç”¨äº†ç‰¹å®šçš„æ–¹å¼æ¥è¿›è¡Œé…ç½®ï¼Œä»è€Œä½¿å¼€å‘äººå‘˜ä¸å†éœ€è¦å®šä¹‰æ ·æ¿åŒ–çš„é…ç½®ï¼ˆæƒ³æƒ³è‚¯å®šä¼šå¾ˆå¼€å¿ƒï¼‰ã€‚ æ ¸å¿ƒç†å¿µä¹ æƒ¯ä¼˜äºé…ç½® SpringBootä¸Spring Frameworkçš„åŒºåˆ«åšä¸ªä¸‹é¢çš„æ¯”å–»ï¼š SpringFramework å°±åƒä¸€ä¸ªå¤§å‹ç”µå­å™¨ä»¶ç”Ÿäº§å…¬å¸ï¼Œå®ƒç”Ÿäº§çš„ç”µå­å™¨ä»¶ï¼ˆæ¯”å¦‚zookeeperï¼Œredisç­‰æ•´åˆåŒ…ï¼‰éƒ½å¾ˆä¼˜ç§€ï¼Œå½“å…¶ä»–å°å…¬å¸ï¼ˆå¼€å‘è€…ï¼‰ç”Ÿäº§æœºå™¨äººï¼ˆé¡¹ç›®ï¼‰éœ€è¦ä½¿ç”¨åˆ°å®ƒçš„ç”µå­å™¨ä»¶æ—¶ï¼Œå°±å‘ç°éœ€è¦å¤§é‡çš„ç„Šæ¥å·¥ä½œï¼ˆé…ç½®XMLï¼‰æ¥è¿æ¥è‡ªå·±çš„ç”µå­å™¨ä»¶ï¼ˆzookeeperï¼Œredisï¼‰ï¼Œè¿™æ ·çœŸçš„å¤ªè€—æ—¶äº†ï¼Œè€ŒSpringBoot å°±åƒè¿™ä¸ªç”µå­å™¨ä»¶ç”Ÿäº§å…¬å¸åœ¨åŸæ¥ç”µå­å™¨ä»¶çš„åŸºç¡€ä¸ŠåŒ…è£…å‡ºæ¥çš„è®¸å¤šç»Ÿä¸€çš„æ’å£ï¼ˆå„ç§starterï¼‰ï¼Œè¿™äº›æ’å¤´å¯ä»¥ä¸å°å…¬å¸çš„ç”µå­å™¨ä»¶å¯ä»¥ç›´æ¥è¿æ¥ï¼Œä¸éœ€è¦ç„Šæ¥å·¥ä½œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ é€šè¿‡ä¸Šé¢çš„æ¯”å–»æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ä»–ä»¬ä¸¤è€…çš„åŒºåˆ«ï¼Œä¹Ÿå‘ç°å…¶å®SpringBootå¹¶ä¸æ˜¯ä»€ä¹ˆæ–°ä¸œè¥¿ï¼Œå®ƒåªæ˜¯åŸæ¥Springçš„åŸºç¡€ä¸Šé‡æ–°åŒ…è£…è¿‡ï¼Œä»è€Œç®€åŒ–äº†Springçš„ç›¸å…³é…ç½®ã€‚ SpringBootçš„æ ¸å¿ƒåŠŸèƒ½ SpringBootå¯ä»¥ä»¥jaråŒ…çš„å½¢å¼ç‹¬ç«‹è¿è¡Œï¼Œå› ä¸ºSpringBootå†…åµŒServletå®¹å™¨ï¼Œå¦‚Tomcatã€Jettyã€‚ Springä¼šæ ¹æ®ç±»è·¯å¾„ä¸­çš„jaråŒ…ã€ç±»ï¼Œä¸ºjaråŒ…é‡Œçš„ç±»è‡ªåŠ¨é…ç½®Beanï¼Œæå¤§å‡å°‘äº†æˆ‘ä»¬è¦ä½¿ç”¨çš„é…ç½®ã€‚ æä¾›starter(èµ·åŠ¨æœº)ç®€åŒ–äº†Mavené…ç½®(ä¾èµ–åŠ è½½)ï¼Œä¸€ä¸ªstarterä¾èµ–æŠµäº†å¥½å‡ ä¸ªä¾èµ–ã€‚ SpringBootè¿è¡ŒåŸç† å¯¹äºSpringBootå·¥ç¨‹æˆ‘ä»¬æ€»æ˜¯å…ˆçœ‹åˆ°å®ƒçš„å¯åŠ¨ç±»ï¼Œå¦‚ä¸‹ï¼š 1234567@SpringBootApplicationpublic class SpringbootLoginApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(SpringbootLoginApplication.class, args); &#125;&#125; å¯¹äºSpringBootçš„è¿ä½œåŸç†ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆä»å¯åŠ¨ç±»çš„@SpringBootApplicationæ³¨è§£æ¥åˆ†æï¼Œè¿™ä¸ªæ³¨è§£æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œæˆ‘ä»¬è¿›å…¥å®ƒçš„æºç çœ‹çœ‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Inherited@SpringBootConfiguration@EnableAutoConfiguration@ComponentScan( excludeFilters = &#123;@Filter( type = FilterType.CUSTOM, classes = &#123;TypeExcludeFilter.class&#125;), @Filter( type = FilterType.CUSTOM, classes = &#123;AutoConfigurationExcludeFilter.class&#125;)&#125;)public @interface SpringBootApplication &#123; @AliasFor( annotation = EnableAutoConfiguration.class ) Class&lt;?&gt;[] exclude() default &#123;&#125;; @AliasFor( annotation = EnableAutoConfiguration.class ) String[] excludeName() default &#123;&#125;; @AliasFor( annotation = ComponentScan.class, attribute = "basePackages" ) String[] scanBasePackages() default &#123;&#125;; @AliasFor( annotation = ComponentScan.class, attribute = "basePackageClasses" ) Class&lt;?&gt;[] scanBasePackageClasses() default &#123;&#125;;&#125; æ€»å¾—æ¥è¯´æœ€é‡è¦çš„å°±æ˜¯@SpringBootConfigurationï¼Œ@EnableAutoConfigurationï¼Œ@ComponentScanè¿™ä¸‰ä¸ªæ³¨è§£ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªåˆ†æï¼š @SpringBootConfiguration æˆ‘ä»¬è¿›å…¥è¯¥æ³¨è§£ï¼Œæˆ‘å‘ç°å®ƒçš„ä»£ç å¦‚ä¸‹ï¼š 123456@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Configurationpublic @interface SpringBootConfiguration &#123;&#125; ä½ ä¼šå‘ç°å…¶æ ¸å¿ƒæ³¨è§£å°±æ˜¯@Configurationï¼Œå®ƒå¯¹äºæˆ‘ä»¬æ¥è¯´åº”è¯¥ä¸é™Œç”Ÿï¼Œå› ä¸ºå®ƒå°±æ˜¯Javaé…ç½®å½¢å¼çš„Spring Iocå®¹å™¨çš„é…ç½®ç±»ä½¿ç”¨çš„é‚£ä¸ª@Configurationï¼ˆç›¸å½“äºXMLé…ç½®æ–‡ä»¶çš„ä¸€ä¸ªBeanï¼‰ï¼ŒSpringBootç¤¾åŒºæ¨èä½¿ç”¨åŸºäºJavaConfigçš„é…ç½®å½¢å¼ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œçš„å¯åŠ¨ç±»æ ‡æ³¨äº†@Configurationä¹‹åï¼Œæœ¬èº«å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªIoCå®¹å™¨çš„é…ç½®ç±»ã€‚ @ComponentScan è¿™ä¸ªæ³¨è§£å¾ˆç®€å•ï¼Œå¾ˆå¸¸è§ï¼Œä½†æ˜¯ä¹Ÿå¾ˆé‡è¦ã€‚å®ƒä¸»è¦çš„ä½œç”¨å°±æ˜¯è‡ªåŠ¨æ‰«æå¹¶åŠ è½½ç¬¦åˆæ¡ä»¶çš„ç»„ä»¶ï¼ˆæ¯”å¦‚@Controllerå’Œ@Serviceç­‰ï¼‰æˆ–è€…beanå®šä¹‰ï¼Œæœ€ç»ˆå°†è¿™äº›beanå®šä¹‰åŠ è½½åˆ°IoCå®¹å™¨ä¸­ã€‚æˆ‘ä»¬çœ‹çœ‹å®ƒçš„æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839@Retention(RetentionPolicy.RUNTIME)@Target(&#123;ElementType.TYPE&#125;)@Documented@Repeatable(ComponentScans.class)public @interface ComponentScan &#123;// è®¾ç½®é»˜è®¤è·¯å¾„@AliasFor("basePackages")String[] value() default &#123;&#125;;// å¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤Springæ¡†æ¶å®ç°ä¼šä»å£°æ˜@ComponentScanæ‰€åœ¨ç±»çš„packageè¿›è¡Œæ‰«æã€‚// æ‰€ä»¥SpringBootçš„å¯åŠ¨ç±»æœ€å¥½æ˜¯æ”¾åœ¨root packageä¸‹ï¼Œå› ä¸ºé»˜è®¤ä¸æŒ‡å®šbasePackagesã€‚@AliasFor("value")String[] basePackages() default &#123;&#125;;Class&lt;?&gt;[] basePackageClasses() default &#123;&#125;;Class&lt;? extends BeanNameGenerator&gt; nameGenerator() default BeanNameGenerator.class;Class&lt;? extends ScopeMetadataResolver&gt; scopeResolver() default AnnotationScopeMetadataResolver.class;ScopedProxyMode scopedProxy() default ScopedProxyMode.DEFAULT;// æ‰«æç±»å‹String resourcePattern() default "**/*.class";// å¯è®¾ç½®è¿‡æ»¤å™¨boolean useDefaultFilters() default true;ComponentScan.Filter[] includeFilters() default &#123;&#125;;ComponentScan.Filter[] excludeFilters() default &#123;&#125;;// é…ç½®æ‡’åŠ è½½ï¼Œå¦‚æœæ²¡è¢«ä½¿ç”¨ï¼Œå°±å…ˆä¸ç”ŸæˆBeanboolean lazyInit() default false;@Retention(RetentionPolicy.RUNTIME)@Target(&#123;&#125;)public @interface Filter &#123; FilterType type() default FilterType.ANNOTATION; @AliasFor("classes") Class&lt;?&gt;[] value() default &#123;&#125;; @AliasFor("value") Class&lt;?&gt;[] classes() default &#123;&#125;; String[] pattern() default &#123;&#125;;&#125;&#125; @EnableAutoConfiguration è¿™ä¸ªæ³¨è§£å¯ä»¥è¯´æ˜¯SpringBootè‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒäº†ï¼Œç°å¸¸é‡è¦ã€‚æˆ‘ä»¬è¿›å»çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š 1234567891011121314@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Inherited@AutoConfigurationPackage// å€ŸåŠ©@Importçš„å¸®åŠ©ï¼Œå°†æ‰€æœ‰ç¬¦åˆè‡ªåŠ¨é…ç½®æ¡ä»¶çš„beanå®šä¹‰åŠ è½½åˆ°IoCå®¹å™¨@Import(&#123;AutoConfigurationImportSelector.class&#125;)public @interface EnableAutoConfiguration &#123; String ENABLED_OVERRIDE_PROPERTY = "spring.boot.enableautoconfiguration"; Class&lt;?&gt;[] exclude() default &#123;&#125;; String[] excludeName() default &#123;&#125;;&#125; æˆ‘ä»¬éœ€è¦å¥½å¥½çœ‹çœ‹AutoConfigurationImportSelectorï¼Œå®ƒåˆ©ç”¨SpringFactoriesLoader.loadFactoryNamesæ–¹æ³•æ¥æ‰«æå…·æœ‰META-INF/spring.factories æ–‡ä»¶çš„jaråŒ…ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234protected List&lt;String&gt; getCandidateConfigurations(AnnotationMetadata metadata, AnnotationAttributes attributes) &#123;List&lt;String&gt; configurations = SpringFactoriesLoader.loadFactoryNames(this.getSpringFactoriesLoaderFactoryClass(), this.getBeanClassLoader());return configurations;&#125; é…åˆ@EnableAutoConfigurationä½¿ç”¨çš„è¯ï¼Œå®ƒæ›´å¤šæ˜¯æä¾›ä¸€ç§é…ç½®æŸ¥æ‰¾çš„åŠŸèƒ½æ”¯æŒï¼Œå³æ ¹æ®@EnableAutoConfigurationçš„å®Œæ•´ç±»åå¦‚org.springframework.boot.autoconfigure.EnableAutoConfigurationä½œä¸ºæŸ¥æ‰¾çš„Key,è·å–å¯¹åº”çš„ä¸€ç»„@Configurationç±»ï¼Œå¹¶å°†å…¶ä¸­org.springframework.boot.autoconfigure.EnableAutoConfigurationå¯¹åº”çš„é…ç½®é¡¹å®ä¾‹åŒ–ä¸ºå¯¹åº”çš„æ ‡æ³¨äº†@Configurationçš„JavaConfigå½¢å¼çš„IoCå®¹å™¨é…ç½®ç±»ï¼Œç„¶åæ±‡æ€»ä¸ºä¸€ä¸ªï¼ˆç›¸å½“äºä¸€ä¸ªXMLæ–‡ä»¶ï¼‰å¹¶åŠ è½½åˆ°IoCå®¹å™¨ï¼ˆå’ŒSpringä¸€æ ·ï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹çœ‹spring-boot-autoconfigure.jar é‡Œå°±æœ‰ä¸€ä¸ªspring.factories æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶ä¸­å£°æ˜äº†æœ‰å“ªäº›è‡ªåŠ¨é…ç½®ã€‚æˆ‘ä»¬çœ‹ä¸€ç‚¹ç‚¹ï¼š 12345# Auto Configureorg.springframework.boot.autoconfigure.EnableAutoConfiguration=\org.springframework.boot.autoconfigure.admin.SpringApplicationAdminJmxAutoConfiguration,\# é…ç½®AOPå¯¹è±¡org.springframework.boot.autoconfigure.aop.AopAutoConfiguration,\ çœ‹å®Œ@SpringBootApplicationæ³¨è§£ï¼Œæˆ‘ä»¬å†çœ‹çœ‹SpringApplicationçš„runæ–¹æ³•ã€‚ æˆ‘ä»¬é€šè¿‡debugå‘ç°å°†è¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼š 1234public static ConfigurableApplicationContext run(Class&lt;?&gt;[] primarySources, String[] args) &#123; // ä¼šå…ˆåˆ›å»ºSpringApplicationå¯¹è±¡å®ä¾‹ï¼Œç„¶åè°ƒç”¨å®ƒçš„å®ä¾‹runæ–¹æ³• return (new SpringApplication(primarySources)).run(args);&#125; æˆ‘ä»¬çœ‹çœ‹åœ¨å®ä¾‹åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ä»–åšäº†ä»€ä¹ˆï¼š 123456789101112131415161718192021222324public SpringApplication(ResourceLoader resourceLoader, Class... primarySources) &#123; this.sources = new LinkedHashSet(); // bannerçš„æ‰“å°æ¨¡å¼ï¼Œæ­¤æ—¶æ˜¯æ§åˆ¶å°æ¨¡å¼ this.bannerMode = Mode.CONSOLE; // å¼€å¯æ—¥å¿— this.logStartupInfo = true; // å¯ç”¨CommandLineProperties this.addCommandLineProperties = true; // å¼€å¯headlessæ¨¡å¼æ”¯æŒï¼ŒHeadlessæ¨¡å¼æ˜¯åœ¨ç¼ºå°‘æ˜¾ç¤ºå±ã€é”®ç›˜æˆ–è€…é¼ æ ‡æ—¶çš„ç³»ç»Ÿé…ç½®ï¼ˆè‡ªè¡Œäº†è§£ï¼‰ this.headless = true // å¯ç”¨æ³¨å†ŒShutdownHookï¼Œç”¨äºåœ¨éWebåº”ç”¨ä¸­å…³é—­IoCå®¹å™¨å’Œèµ„æº this.registerShutdownHook = true; this.additionalProfiles = new HashSet(); this.resourceLoader = resourceLoader; this.primarySources = new LinkedHashSet(Arrays.asList(primarySources)); // åˆ¤æ–­æ˜¯å¦æ˜¯webè¿è¡Œç¯å¢ƒ(Servlet) this.webApplicationType = this.deduceWebApplicationType(); // è®¾ç½®åˆå§‹åŒ–å™¨(åœ¨META-INF/spring.factories æ–‡ä»¶é‡Œï¼Œå¯æ‰©å±•) this.setInitializers(this.getSpringFactoriesInstances(ApplicationContextInitializer.class)); // è®¾ç½®ç›‘å¬å™¨(åœ¨META-INF/spring.factories æ–‡ä»¶é‡Œï¼Œå¯æ‰©å±•) this.setListeners(this.getSpringFactoriesInstances(ApplicationListener.class)); // æ¨æ–­å¹¶è®¾ç½®mainæ–¹æ³•çš„å®šä¹‰ç±» this.mainApplicationClass = this.deduceMainApplicationClass();&#125; SpringApplicationå®ä¾‹åˆå§‹åŒ–å®Œæˆå¹¶ä¸”å®Œæˆè®¾ç½®åï¼Œå°±å¼€å§‹æ‰§è¡Œrunæ–¹æ³•çš„é€»è¾‘ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859public ConfigurableApplicationContext run(String... args) &#123; // å¼€å¯ä»»åŠ¡æ‰§è¡Œæ—¶é—´ç›‘å¬å™¨ StopWatch stopWatch = new StopWatch(); stopWatch.start(); ConfigurableApplicationContext context = null; Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = new ArrayList(); // è®¾ç½®ç³»ç»Ÿå±æ€§ this.configureHeadlessProperty(); //å¼€å¯å¹¿æ’­ï¼Œå®£å‘ŠSpringBootè¦å¼€å§‹æ‰§è¡Œäº† SpringApplicationRunListeners listeners = this.getRunListeners(args); listeners.starting(); Collection exceptionReporters; try &#123; ApplicationArguments applicationArguments = new DefaultApplicationArguments(args); // åˆ›å»ºå¹¶é…ç½®å½“å‰Spring Bootåº”ç”¨å°†è¦ä½¿ç”¨çš„Environmentï¼ˆåŒ…æ‹¬é…ç½®è¦ä½¿ç”¨çš„PropertySourceä»¥åŠProfileï¼‰ã€‚ ConfigurableEnvironment environment = this.prepareEnvironment(listeners, applicationArguments); // å®£å‘ŠSpringBootåº”ç”¨ä½¿ç”¨çš„Environmentå‡†å¤‡å¥½äº†ã€‚ this.configureIgnoreBeanInfo(environment); // å†³å®šæ˜¯å¦æ‰“å°Banner Banner printedBanner = this.printBanner(environment); // æ ¹æ®ç”¨æˆ·æ˜¯å¦æ˜ç¡®è®¾ç½®äº†applicationContextClassç±»å‹ï¼Œå†³å®šè¯¥ä¸ºå½“å‰SpringBootåº”ç”¨åˆ›å»ºä»€ä¹ˆç±»å‹çš„ApplicationContext // ç„¶åæ ¹æ®æ¡ä»¶å†³å®šæ˜¯å¦æ·»åŠ ShutdownHookï¼Œå†³å®šæ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰çš„BeanNameGeneratorï¼Œå†³å®šæ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰çš„ResourceLoaderï¼Œ // æœ€é‡è¦çš„æ˜¯å°†ä¹‹å‰å‡†å¤‡å¥½çš„Environmentè®¾ç½®ç»™åˆ›å»ºå¥½çš„ApplicationContextä½¿ç”¨ã€‚ context = this.createApplicationContext(); // å¾—åˆ°å¼‚å¸¸æŠ¥å‘Šè€… exceptionReporters = this.getSpringFactoriesInstances(SpringBootExceptionReporter.class, new Class[]&#123;ConfigurableApplicationContext.class&#125;, new Object[]&#123;context&#125;); // ApplicationContextåˆ›å»ºå¥½ä¹‹åï¼Œéå†è°ƒç”¨ApplicationContextInitializerçš„initializeï¼ˆapplicationContextï¼‰æ–¹æ³•æ¥å¯¹å·²ç»åˆ›å»ºå¥½çš„ApplicationContextè¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†ã€‚ // éå†è°ƒç”¨æ‰€æœ‰SpringApplicationRunListenerçš„contextPrepared()æ–¹æ³•ã€‚ // å°†ä¹‹å‰é€šè¿‡@EnableAutoConfigurationè·å–çš„æ‰€æœ‰é…ç½®ä»¥åŠå…¶ä»–å½¢å¼çš„IoCå®¹å™¨é…ç½®åŠ è½½åˆ°å·²ç»å‡†å¤‡å®Œæ¯•çš„ApplicationContext // (å¾ˆé‡è¦ï¼Œå¯ä»¥è¿›å…¥çœ‹çœ‹) this.prepareContext(context, environment, listeners, applicationArguments, printedBanner); // åˆå§‹åŒ–æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»ï¼Œè°ƒç”¨ApplicationContextçš„refresh()æ–¹æ³• this.refreshContext(context); // è°ƒç”¨æ‰€æœ‰çš„SpringApplicationRunListenerçš„finished()æ–¹æ³•ï¼Œå®£å‘ŠSpringBootå·²ç»å®Œæˆäº†ApplicationContextåˆå§‹åŒ–çš„å…¨éƒ¨è¿‡ç¨‹ã€‚ this.afterRefresh(context, applicationArguments); //å…³é—­ä»»åŠ¡æ‰§è¡Œæ—¶é—´ç›‘å¬å™¨ stopWatch.stop(); if(this.logStartupInfo) &#123; // //å¦‚æœå¼€å¯æ—¥å¿—ï¼Œåˆ™æ‰“å°æ‰§è¡Œçš„æ—¶é—´ (new StartupInfoLogger(this.mainApplicationClass)).logStarted(this.getApplicationLog(), stopWatch); &#125; listeners.started(context); this.callRunners(context, applicationArguments); &#125; catch (Throwable var10) &#123; // //è°ƒç”¨å¼‚å¸¸åˆ†æå™¨æ‰“å°æŠ¥å‘Šï¼Œè°ƒç”¨æ‰€æœ‰çš„SpringApplicationRunListenerçš„finished()æ–¹æ³•å°†å¼‚å¸¸ä¿¡æ¯å‘å¸ƒå‡ºå» this.handleRunFailure(context, var10, exceptionReporters, listeners); throw new IllegalStateException(var10); &#125; try &#123; listeners.running(context); return context; &#125; catch (Throwable var9) &#123; this.handleRunFailure(context, var9, exceptionReporters, (SpringApplicationRunListeners)null); throw new IllegalStateException(var9); &#125;&#125; å‚è€ƒ Spring Bootå¹²è´§ç³»åˆ—ï¼šï¼ˆä¸‰ï¼‰å¯åŠ¨åŸç†è§£æ Spring Bootå­¦ä¹ ç¬”è®°03â€“æ·±å…¥äº†è§£SpringBootçš„å¯åŠ¨è¿‡ç¨‹ spring bootåº”ç”¨å¯åŠ¨åŸç†åˆ†æ]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>SpringBoot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HelloWorld_SSMLogin]]></title>
    <url>%2F2018%2F04%2F17%2FHelloWorld%2FHelloWorld-SSMLogin%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæƒ³ç€æ€ä¹ˆæ•™ä¸€ä¸ªäººå¿«é€Ÿå…¥é—¨SSMï¼Œè®²åŸç†æ˜¯çœŸçš„å¤ªè´¹æ—¶é—´ï¼Œè¿˜æ˜¯ä»¥æ­å»ºå…·ä½“æµç¨‹åŠ ä¸Šæºç æ¯”è¾ƒå¥½å§ï¼Œå…ˆæ¨¡ä»¿ï¼Œååˆ›æ–°å˜›ï¼ é¡¹ç›®æ¶æ„é¡¹ç›®ä»“åº“åœ°å€ æˆ‘ä»¬å…ˆæŠŠæ–‡ä»¶å¤¹åˆ›å»ºå¥½ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å…ˆç›´æ¥ä»æˆ‘ä»“åº“åœ°å€æŠŠå®ƒå…‹éš†ä¸‹æ¥ï¼Œåˆ é™¤å…¶ä¸­éƒ¨åˆ†çš„ä»£ç æ–‡ä»¶ã€‚ é…ç½®æ–‡ä»¶è§£æé…ç½®æ–‡ä»¶é‡Œé¢éƒ½æœ‰æ³¨é‡Šï¼Œå¤§å®¶å¯ä»¥å¯¹ç…§ç€çœ‹ï¼š pom.xmlæ–‡ä»¶pomæ–‡ä»¶ä½œä¸ºMavenå·¥ç¨‹çš„æ ¸å¿ƒï¼Œä¸»è¦æ˜¯ç”¨æ¥å¼•å…¥jaråŒ…çš„ï¼Œåœ¨æˆ‘çš„pomæ–‡ä»¶ä¸­ä¹Ÿè¯¦ç»†åˆ—å‡ºäº†æˆ‘ä»¬éœ€è¦å“ªäº›åŒ…ï¼Œä»¥åŠå“ªäº›åŒ…æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ã€‚ web.xmlæ–‡ä»¶web.xmlä½œä¸ºWebåŠŸèƒ½çš„æ ¸å¿ƒï¼Œä¸»è¦æ˜¯è®¾ç½®äº†å¦‚ä½•æ¥å—è¯·æ±‚ï¼Œè¿™é‡Œä¼šç»“åˆSpringMVCçš„å‰ç«¯æ§åˆ¶å™¨ç±»DispatcherServletä½œä¸ºè¯·æ±‚åˆ†å‘çš„æ ¸å¿ƒServletï¼Œä»¥åŠåœ¨ç¬¬ä¸€æ¬¡åŠ è½½è¿‡ç¨‹ä¸­ï¼Œåå°æœåŠ¡éœ€è¦åŠ è½½å“ªäº›é…ç½®æ–‡ä»¶ã€‚ ssmé…ç½®æ–‡ä»¶ï¼ˆä¾é Springæ•´åˆï¼‰æˆ‘ä»¬çœ‹åˆ°springæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«å¯¹åº”äº†daoï¼Œserviceï¼Œwebä¸‰å±‚çš„Beané…ç½®ã€‚ spring-dao-config.xmlæ–‡ä»¶è¿™é‡Œä¸»è¦æ˜¯é…ç½®æ•°æ®åº“è¿æ¥æ± ï¼ˆæ•°æ®æºï¼‰ï¼Œä»¥åŠæ³¨å…¥SqlSessionFactoryå’Œæ‰€æœ‰åœ¨com.todorex.daoä¸‹å¾—æ‰€æœ‰Daoæ¥å£ã€‚ spring-service-config.xmlæ–‡ä»¶è¿™é‡Œä¸»è¦é…ç½®æ‰«æå¹¶æ³¨å…¥com.todorex.serviceåŒ…ä¸‹æ‰€æœ‰Serviceæ³¨è§£ç±»ï¼Œä»¥åŠé…ç½®äº‹åŠ¡ç®¡ç†å™¨ã€‚ spring-web-config.xmlæ–‡ä»¶è¿™é‡Œä¸»è¦é…ç½®æ‰«æå¹¶æ³¨å…¥com.todorex.controlleråŒ…ä¸‹æ‰€æœ‰Controlleræ³¨è§£ç±»ï¼Œä»¥åŠé…ç½®è§†å›¾è§£æå™¨ã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªè¶…çº§é‡è¦çš„å°±æ˜¯é…ç½®å¤„ç†é™æ€èµ„æºçš„æ–¹å¼ã€‚ mybatis-config.xmlæ–‡ä»¶è¿™é‡Œä¸»è¦æ˜¯è®¾ç½®mybatisçš„å…¨å±€å±æ€§ã€‚ jdbc.propertiesæ–‡ä»¶è¿™é‡Œä¸»è¦é…ç½®æ•°æ®åº“è¿æ¥çš„ç›¸å…³ä¿¡æ¯ã€‚ log4j.propertiesæ–‡ä»¶è¿™é‡Œä¸»è¦é…ç½®æ—¥å¿—è®°å½•çš„ç›¸å…³ä¿¡æ¯ã€‚ é…ç½®æ–‡ä»¶éƒ½é…ç½®å®Œäº†ï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥å¼€å§‹å†™ä»£ç äº†! SSMä»£ç éœ€æ±‚å®ç°ç”¨æˆ·çš„ç™»å½•ä¸æ³¨é”€ã€‚ ä¸Šå¸è§†è§’å¼€å‘ï¼ˆæˆ‘éœ€è¦ä»€ä¹ˆå°±é€ ä»€ä¹ˆï¼‰æˆ‘éœ€è¦ä¸€ä¸ªèƒ½å¤„ç†æˆ‘çš„è¯·æ±‚ï¼ˆURLï¼‰çš„ControllerçŸ¥é“è¦controllerï¼Œæˆ‘ä»¬å°±é€ ä¸€ä¸ªï¼Œæˆ‘ä»¬åœ¨com.todorex.controlleråŒ…ä¸‹æ–°å»ºä¸€ä¸ªLoginControllerç±»ã€‚ Controllerçš„ä½œç”¨ä¸»è¦æ˜¯æ ¹æ®ä½ è¯·æ±‚çš„URLæ¥åšä¸åŒçš„äº‹ï¼ˆå¯¹åº”çš„æ–¹æ³•ï¼‰ï¼Œç»“æœæ˜¯è¿”å›ä¸€ä¸ªModelAndViewï¼ˆå½“ç„¶Viewå’ŒModelä¹Ÿå¯ä»¥åˆ†å¼€ï¼‰ï¼Œå¦‚æœæ–¹æ³•çš„é€»è¾‘åªæ˜¯é¡µé¢é—´çš„è·³è½¬å’Œç®€å•æ•°æ®å¤„ç†ï¼Œæˆ‘ä»¬å°±ç”¨ä¸åˆ°Serviceäº†ï¼Œå¦‚è¿‡æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸šåŠ¡å¤„ç†ä»¥åŠæ“ä½œæ•°æ®åº“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°Serviceäº†ã€‚ PSï¼šè¿™é‡Œéœ€è¦æ³¨æ„è¯·æ±‚è½¬å‘å’Œè¯·æ±‚é‡å®šå‘çš„åŒºåˆ«ï¼ˆæ³¨é‡Šä¸­æœ‰ï¼‰ æˆ‘éœ€è¦ä¸€ä¸ªèƒ½å¤„ç†ä¸šåŠ¡çš„Serviceåœ¨serviceå±‚è®¾è®¡ä¸€ä¸ªå¥½çš„æ¥å£æ˜¯è‡³å…³é‡è¦çš„ï¼ˆæˆ‘ä»¬è¿˜æ˜¯HelloWorldï¼Œä»¥åæœ‰ç»éªŒäº†è‡ªç„¶èƒ½è®¾è®¡å¾—å¥½ä¸€äº›ï¼‰ï¼Œå¦‚æœå®ç°ç±»æœ‰å¤šä¸ªçš„è¯ ï¼Œå¯ä»¥ç”¨@Service(â€œuserService1â€)æ¥æ³¨å…¥ï¼Œ@Resource(name=â€userService1â€) æ¥å¯¹åº”è·å–ã€‚åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½ä¼šæ¶‰åŠåˆ°æ•°æ®åº“æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°Daoäº†ã€‚ æˆ‘éœ€è¦ä¸€ä¸ªèƒ½å¤„ç†æ•°æ®çš„Daoè¿™é‡Œæˆ‘ä»¬è¦æ˜ç¡®ä¸€ç‚¹ï¼šä¸€ä¸ªDaoæ¥å£å¯¹åº”ä¸€ä¸ªMapperæ–‡ä»¶ï¼ŒDaoå®šä¹‰æ¥å£æ–¹æ³•ï¼ŒMapperæ–‡ä»¶å®ç°è¯¥æ–¹æ³•çš„sqlè¯­å¥ã€‚ æ—¥å¿—è¿™é‡Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå°±æ˜¯è®°å½•ç™»å½•ç”¨æˆ·çš„åå­—å’Œæ—¶é—´ï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š1234567891011121314151617public class LoginController &#123; // è·å¾—æ—¥å¿—å¯¹è±¡ Logger logger = Logger.getLogger(LoginController.class); @RequestMapping(value = "/checkLogin",method = RequestMethod.POST) public String checkLogin(User user, Model model) &#123; user = userService.checkLogin(user.getUsername(),user.getPassword()); if (user != null) &#123; // æ—¥å¿—è®°å½•ç”¨æˆ·ç™»å½• logger.info(user.getUsername()+"åœ¨"+new Date() + "ç™»å½•è¿‡!"); model.addAttribute("user",user); return "redirect:/success"; &#125; else &#123; return "redirect:/fail"; &#125; &#125;&#125; å•å…ƒæµ‹è¯• é…ç½®ä¸€ä¸ªåŸºç±»ï¼ˆç”¨äºåŠ è½½é…ç½®æ–‡ä»¶ï¼‰ 123456@RunWith(SpringJUnit4ClassRunner.class) //ä½¿ç”¨junit4è¿›è¡Œæµ‹è¯•// å¯¼å…¥å¤šä¸ªé…ç½®æ–‡ä»¶@ContextConfiguration(locations=&#123;"classpath:spring/spring-*.xml","classpath:mybatis-config.xml"&#125;) //åŠ è½½é…ç½®æ–‡ä»¶//æ‰€æœ‰ç»§æ‰¿è¯¥ç±»çš„æµ‹è¯•ç±»éƒ½ä¼šéµå¾ªè¯¥é…ç½®public class BaseJunit4Test &#123;&#125; åœ¨å„ä¸ªå¯¹åº”çš„åŒ…ä¸‹å»ºç«‹å•å…ƒæµ‹è¯•ï¼Œå¦‚; 12345678910public class UserDaoTest extends BaseJunit4Test &#123; @Autowired private UserDao userDao; @Test public void TestFindByUsername() &#123; User user = userDao.findByUsername("rex"); System.out.println(user); &#125;&#125; é¡µé¢ç¼–å†™è¿™é‡Œåªä¸¾ä¸€ä¸ªä¾‹å­ï¼ˆå…¶å®ä¸»è¦å°±æ˜¯jspçš„ç”¨æ³•ï¼‰,success.jsp:123456789101112131415161718192021222324252627&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;&lt;%--å¼•å…¥jstlæ ‡ç­¾åº“ï¼Œå¾ˆé‡è¦--%&gt;&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; &lt;title&gt;Insert title here&lt;/title&gt;&lt;/head&gt;&lt;!--æ·»åŠ èƒŒæ™¯å›¾ç‰‡--&gt;&lt;body background=&quot;image/success.jpg&quot;&gt;&lt;div style=&quot;margin: auto&quot;&gt;&lt;div&gt; &lt;%--åˆ©ç”¨jstlæ ‡ç­¾è·å–sessionä¸­çš„userçš„å€¼--%&gt; &lt;strong style=&quot;font-size: 100px;color: red&quot;&gt; $&#123;sessionScope.user.username&#125;!&lt;/strong&gt; &lt;strong style=&quot;font-size: 100px;color: blue&quot;&gt; ï¼Œä½ ä»–å¦ˆç™»å½•æˆåŠŸäº†&lt;/strong&gt;&lt;/div&gt;&lt;form action=&quot;/LoginDemo/outLogin&quot; &gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-success col-lg-12&quot; style=&quot;font-size: 100px;text-align: center&quot;&gt;é€€å‡ºç™»å½•&lt;/button&gt;&lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ç»ˆäºå¤§åŠŸå‘Šæˆï¼ï¼ï¼ å‚è€ƒSSMæ­å»º(æ•´åˆ)+ç”¨æˆ·æ¨¡å—(ç™»å½•å’Œæ³¨é”€)å®ç°]]></content>
      <categories>
        <category>HelloWorld</category>
      </categories>
      <tags>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
        <tag>Mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜Mybatis(äºŒ)_Mybatiså·¥ä½œåŸç†]]></title>
    <url>%2F2018%2F04%2F16%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98Mybatis-%E4%BA%8C-Mybatis%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šäº†è§£å®ŒMybatisçš„æ¶æ„ï¼Œé‚£ä¹ˆå®ƒçš„æ‰§è¡Œæµç¨‹åˆæ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ Mybatisä¸»è¦ç»„ä»¶åŠå·¥ä½œæµç¨‹ä¸»è¦ç»„ä»¶ Configurationï¼šMyBatisæ‰€æœ‰çš„é…ç½®ä¿¡æ¯éƒ½ç»´æŒåœ¨Configurationå¯¹è±¡ä¹‹ä¸­ SqlSessionï¼šä½œä¸ºMyBatisæ¥å£å±‚çš„AOPï¼Œè¡¨ç¤ºå’Œæ•°æ®åº“äº¤äº’çš„ä¼šè¯ï¼Œå®Œæˆå¿…è¦æ•°æ®åº“å¢åˆ æ”¹æŸ¥åŠŸèƒ½ Executorï¼šMyBatisæ‰§è¡Œå™¨ï¼Œæ˜¯MyBatis è°ƒåº¦çš„æ ¸å¿ƒï¼Œè´Ÿè´£SQLè¯­å¥çš„ç”Ÿæˆå’ŒæŸ¥è¯¢ç¼“å­˜çš„ç»´æŠ¤ StatementHandlerï¼šå°è£…äº†JDBC Statementæ“ä½œï¼Œè´Ÿè´£å¯¹JDBC statement çš„æ“ä½œï¼Œå¦‚è®¾ç½®å‚æ•°ã€å°†Statementç»“æœé›†è½¬æ¢æˆListé›†åˆ ParameterHandlerï¼šè´Ÿè´£å¯¹ç”¨æˆ·ä¼ é€’çš„å‚æ•°è½¬æ¢æˆJDBC Statement æ‰€éœ€è¦çš„å‚æ•° resultSetHandlerï¼šè´Ÿè´£å°†JDBCè¿”å›çš„ResultSetç»“æœé›†å¯¹è±¡è½¬æ¢æˆListç±»å‹çš„é›†åˆ TypeHandlerï¼šè´Ÿè´£javaæ•°æ®ç±»å‹å’Œjdbcæ•°æ®ç±»å‹ä¹‹é—´çš„æ˜ å°„å’Œè½¬æ¢ MappedStatementï¼šMappedStatementç»´æŠ¤äº†ä¸€æ¡èŠ‚ç‚¹çš„å°è£… SqlSourceï¼šè´Ÿè´£æ ¹æ®ç”¨æˆ·ä¼ é€’çš„parameterObjectï¼ŒåŠ¨æ€åœ°ç”ŸæˆSQLè¯­å¥ï¼Œå°†ä¿¡æ¯å°è£…åˆ°BoundSqlå¯¹è±¡ä¸­ï¼Œå¹¶è¿”å› BoundSqlï¼šè¡¨ç¤ºåŠ¨æ€ç”Ÿæˆçš„SQLè¯­å¥ä»¥åŠç›¸åº”çš„å‚æ•°ä¿¡æ¯ å·¥ä½œæµç¨‹å›¾ è¿™å¼ å›¾ä¹Ÿè¶…çº§æ£’ï¼ˆNice å…„Deiï¼‰ï¼Œåœ¨ä¸‹é¢å‚è€ƒä¹Ÿå°†çœ‹åˆ°å‡ºå¤„ã€‚æˆ‘ä»¬ä¸‹é¢çš„æºç åˆ†æä¹Ÿä¼šå‚è€ƒè¿™å¼ å›¾ã€‚ Mybatisåˆå§‹åŒ–æºç åˆ†æ è·å–é…ç½®æ–‡ä»¶åˆ›å»ºSqlSessionFactory 123String resource = &quot;mybatis-config.xml&quot;;InputStream inputStream = Resources.getResourceAsStream(resource);SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); è¿›å…¥åˆ°SqlSessionFactoryçš„buildæ–¹æ³• 123456789101112131415161718public SqlSessionFactory build(InputStream inputStream, String environment, Properties properties) &#123; SqlSessionFactory var5; try &#123; // è§£æåˆšåˆšåˆ›å»ºçš„é…ç½®æ–‡ä»¶æ–‡ä»¶æµ XMLConfigBuilder parser = new XMLConfigBuilder(inputStream, environment, properties); var5 = this.build(parser.parse()); &#125; catch (Exception var14) &#123; throw ExceptionFactory.wrapException("Error building SqlSession.", var14); &#125; finally &#123; ErrorContext.instance().reset(); try &#123; inputStream.close(); &#125; catch (IOException var13) &#123; ; &#125; &#125; return var5;&#125; ä¼šè¿›å…¥åˆ°XMLConfigBuilderçš„parseæ–¹æ³•å»è§£æé…ç½®æ–‡ä»¶çš„å…·ä½“å†…å®¹ç”ŸæˆConfigurationå¯¹è±¡ 1234567891011121314151617181920212223242526272829303132333435public Configuration parse() &#123; if(this.parsed) &#123; throw new BuilderException("Each XMLConfigBuilder can only be used once."); &#125; else &#123; this.parsed = true; // è§£æé…ç½®æ–‡ä»¶ this.parseConfiguration(this.parser.evalNode("/configuration")); return this.configuration; &#125;&#125;private void parseConfiguration(XNode root) &#123; try &#123; // è§£æ&lt;properties&gt;èŠ‚ç‚¹ï¼Œæ•°æ®æºé…ç½®æ–‡ä»¶ this.propertiesElement(root.evalNode("properties")); // è§£æ&lt;typeAliases&gt;èŠ‚ç‚¹ï¼Œåˆ«åèŠ‚ç‚¹ this.typeAliasesElement(root.evalNode("typeAliases")); // è§£æ&lt;plugins&gt;èŠ‚ç‚¹ï¼Œæ’ä»¶èŠ‚ç‚¹ this.pluginElement(root.evalNode("plugins")); // è§£æ&lt;objectFactory&gt;èŠ‚ç‚¹ this.objectFactoryElement(root.evalNode("objectFactory")); // è§£æ&lt;reflectorFactory&gt;èŠ‚ç‚¹ this.objectWrapperFactoryElement(root.evalNode("objectWrapperFactory")); // è§£æ&lt;settings&gt;èŠ‚ç‚¹ this.settingsElement(root.evalNode("settings")); // è§£æ&lt;environments&gt;èŠ‚ç‚¹ this.environmentsElement(root.evalNode("environments")); this.databaseIdProviderElement(root.evalNode("databaseIdProvider")); this.typeHandlerElement(root.evalNode("typeHandlers")); // è§£æ&lt;mappers&gt;èŠ‚ç‚¹ï¼Œå¾ˆé‡è¦ this.mapperElement(root.evalNode("mappers")); &#125; catch (Exception var3) &#123; throw new BuilderException("Error parsing SQL Mapper Configuration. Cause: " + var3, var3); &#125;&#125; æˆ‘ä»¬æœ€å…³å¿ƒçš„å¯èƒ½å°±æ˜¯mapperçš„è§£æäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿›å…¥mapperElementæ–¹æ³•çœ‹çœ‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869private void mapperElement(XNode parent) throws Exception &#123; if(parent != null) &#123; Iterator i$ = parent.getChildren().iterator(); while(true) &#123; // éå†&lt;mappers&gt;ä¸‹æ‰€æœ‰å­èŠ‚ç‚¹ while(i$.hasNext()) &#123; XNode child = (XNode)i$.next(); String resource; // å¦‚æœå½“å‰èŠ‚ç‚¹ä¸º&lt;package&gt; if("package".equals(child.getName())) &#123; // è·å–&lt;package&gt;çš„nameå±æ€§ï¼ˆè¯¥å±æ€§å€¼ä¸ºmapper classæ‰€åœ¨çš„åŒ…åï¼‰ resource = child.getStringAttribute("name"); // å°†è¯¥åŒ…ä¸‹çš„æ‰€æœ‰Mapper Classæ³¨å†Œåˆ°configurationçš„mapperRegistryå®¹å™¨ä¸­ this.configuration.addMappers(resource); &#125; else &#123; // ä¾æ¬¡è·å–resourceã€urlã€classå±æ€§ resource = child.getStringAttribute("resource"); String url = child.getStringAttribute("url"); String mapperClass = child.getStringAttribute("class"); XMLMapperBuilder mapperParser; InputStream inputStream; // è§£æresourceå±æ€§ï¼ˆMapper.xmlæ–‡ä»¶çš„è·¯å¾„ï¼‰ if(resource != null &amp;&amp; url == null &amp;&amp; mapperClass == null) &#123; ErrorContext.instance().resource(resource); // å°†Mapper.xmlæ–‡ä»¶è§£ææˆè¾“å…¥æµ inputStream = Resources.getResourceAsStream(resource); // ä½¿ç”¨XMLMapperBuilderè§£æMapper.xmlï¼Œå¹¶å°†Mapper Classæ³¨å†Œè¿›configurationå¯¹è±¡çš„mapperRegistryå®¹å™¨ä¸­ mapperParser = new XMLMapperBuilder(inputStream, this.configuration, resource, this.configuration.getSqlFragments()); // è¿™ä¸ªå¾ˆé‡è¦ï¼Œçœ‹çœ‹å…·ä½“æ€ä¹ˆè§£æ mapperParser.parse(); &#125; else if(resource == null &amp;&amp; url != null &amp;&amp; mapperClass == null) &#123; // è§£æurlå±æ€§ï¼ˆMapper.xmlæ–‡ä»¶çš„è·¯å¾„ï¼‰ ErrorContext.instance().resource(url); inputStream = Resources.getUrlAsStream(url); mapperParser = new XMLMapperBuilder(inputStream, this.configuration, url, this.configuration.getSqlFragments()); mapperParser.parse(); &#125; else &#123; // è§£æclasså±æ€§ï¼ˆMapper Classçš„å…¨é™å®šåï¼‰ if(resource != null || url != null || mapperClass == null) &#123; throw new BuilderException("A mapper element may only specify a url, resource or class, but not more than one."); &#125; // å°†Mapper Classçš„æƒé™å®šåè½¬åŒ–æˆClasså¯¹è±¡ Class&lt;?&gt; mapperInterface = Resources.classForName(mapperClass); this.configuration.addMapper(mapperInterface); &#125; &#125; &#125; return; &#125; &#125; &#125;public void parse() &#123; if(!this.configuration.isResourceLoaded(this.resource)) &#123; // è§£æ&lt;mapper&gt;èŠ‚ç‚¹ this.configurationElement(this.parser.evalNode("/mapper")); // å°†è¯¥Mapper.xmlæ·»åŠ è‡³configurationçš„LoadedResourceå®¹å™¨ä¸­ï¼Œä¸‹å›æ— éœ€å†è§£æ this.configuration.addLoadedResource(this.resource); // å°†è¯¥Mapper.xmlå¯¹åº”çš„Mapper Classæ³¨å†Œè¿›configurationçš„mapperRegistryå®¹å™¨ä¸­ï¼Œå¾ˆé‡è¦ï¼Œä¸‹é©¬éœ€è¦ä»”ç»†çœ‹çœ‹ this.bindMapperForNamespace(); &#125; this.parsePendingResultMaps(); this.parsePendingChacheRefs(); this.parsePendingStatements();&#125; bindMapperForNamespaceæå…¶é‡è¦ï¼Œå› ä¸ºè¿™é‡Œä¼šç»™Mapperæ¥å£åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œæˆ‘ä»¬çœ‹çœ‹æºç ï¼š 12345678910111213141516171819private void bindMapperForNamespace() &#123; // è·å–å½“å‰æ˜ å°„æ–‡ä»¶å¯¹åº”çš„DAOæ¥å£çš„å…¨é™å®šå String namespace = this.builderAssistant.getCurrentNamespace(); if(namespace != null) &#123; // å°†å…¨é™å®šåè§£ææˆClasså¯¹è±¡ Class boundType = null; try &#123; boundType = Resources.classForName(namespace); &#125; catch (ClassNotFoundException var4) &#123; ; &#125; if(boundType != null &amp;&amp; !this.configuration.hasMapper(boundType)) &#123; // å°†å½“å‰Mapper.xmlæ ‡æ³¨ä¸ºå·²åŠ è½½ä¸‹å›å°±ä¸ç”¨å†åŠ è½½äº† this.configuration.addLoadedResource("namespace:" + namespace); // å°†Mapperæ¥å£çš„Classå¯¹è±¡æ³¨å†Œè¿›configurationä¸­ï¼ˆå…¶å®æ˜¯åœ¨configurationçš„MapperRegistryé‡Œé¢ï¼‰ this.configuration.addMapper(boundType); &#125; &#125;&#125; æˆ‘ä»¬å†è¿›å…¥åˆ°this.configuration.addMapperæ–¹æ³•ä¸­çœ‹çœ‹ä¼šåšäº›ä»€ä¹ˆï¼š 12345678910111213141516171819202122232425public &lt;T&gt; void addMapper(Class&lt;T&gt; type) &#123; this.mapperRegistry.addMapper(type);&#125;public &lt;T&gt; void addMapper(Class&lt;T&gt; type) &#123; if(type.isInterface()) &#123; if(this.hasMapper(type)) &#123; throw new BindingException("Type " + type + " is already known to the MapperRegistry."); &#125; boolean loadCompleted = false; try &#123; // åˆ›å»ºMapperProxyFactoryå¯¹è±¡ï¼ˆç”¨äºåˆ›å»ºDAOæ¥å£çš„ä»£ç†å¯¹è±¡ï¼‰ï¼Œå¹¶putè¿›knownMappersä¸­ // ä¸ºåé¢çš„åˆ›å»ºMapperä»£ç†å¯¹è±¡åšå‡†å¤‡ this.knownMappers.put(type, new MapperProxyFactory(type)); MapperAnnotationBuilder parser = new MapperAnnotationBuilder(this.config, type); parser.parse(); loadCompleted = true; &#125; finally &#123; if(!loadCompleted) &#123; this.knownMappers.remove(type); &#125; &#125; &#125;&#125; ç­‰Mapperå…¨éƒ½è§£æå¥½ä¹‹åï¼Œåˆå§‹åŒ–å·¥ä½œåŸºæœ¬å°±å®Œæˆäº†ã€‚ Mybatiså·¥ä½œæµç¨‹æºç åˆ†æ åˆ›å»ºSqlSessionå¯¹è±¡ 123456789101112131415161718192021222324252627282930SqlSession sqlSession = sqlSessionFactory.openSession();public SqlSession openSession() &#123; // ä»æ•°æ®æºåˆ›å»ºSqlSessionä¼šè¯å¯¹è±¡ return this.openSessionFromDataSource(this.configuration.getDefaultExecutorType(), (TransactionIsolationLevel)null, false);&#125;private SqlSession openSessionFromDataSource(ExecutorType execType, TransactionIsolationLevel level, boolean autoCommit) &#123; Transaction tx = null; DefaultSqlSession var8; try &#123; // åˆå§‹åŒ–è¯»å–äº†Environmenté‡Œé¢çš„æ•°æ®æºä»¥åŠäº‹åŠ¡é…ç½® Environment environment = this.configuration.getEnvironment(); // è·å–äº‹åŠ¡å·¥å‚ TransactionFactory transactionFactory = this.getTransactionFactoryFromEnvironment(environment); tx = transactionFactory.newTransaction(environment.getDataSource(), level, autoCommit); // ç”ŸæˆMyBatisæ‰§è¡Œå™¨ Executor executor = this.configuration.newExecutor(tx, execType); // åˆ›å»ºDefaultSqlSessionå¯¹è±¡ var8 = new DefaultSqlSession(this.configuration, executor, autoCommit); &#125; catch (Exception var12) &#123; this.closeTransaction(tx); throw ExceptionFactory.wrapException("Error opening session. Cause: " + var12, var12); &#125; finally &#123; ErrorContext.instance().reset(); &#125; return var8;&#125; ä»SqlSessionå¯¹è±¡è·å¾—Mapperï¼ˆåé¢ä¼šçœ‹åˆ°è¿™æ˜¯ä¸ªä»£ç†å¯¹è±¡ï¼‰ï¼Œçœ‹çœ‹æ‰§è¡Œæµç¨‹ï¼š 1234567891011121314151617181920212223242526272829303132UserMapper userMapper = sqlSession.getMapper(UserMapper.class);public &lt;T&gt; T getMapper(Class&lt;T&gt; type) &#123; // è¿›å…¥configuration return this.configuration.getMapper(type, this);&#125;public &lt;T&gt; T getMapper(Class&lt;T&gt; type, SqlSession sqlSession) &#123; // è°ƒç”¨configurationå¯¹è±¡çš„apperRegistryçš„getMapperæ–¹æ³• return this.mapperRegistry.getMapper(type, sqlSession);&#125;public &lt;T&gt; T getMapper(Class&lt;T&gt; type, SqlSession sqlSession) &#123; // è¿™ä¸ªæ˜¯åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­è§£æmapperæ—¶ç”Ÿæˆçš„ï¼Œç°æœ‰çœ‹åˆ°äº†Mapperå¯¹è±¡çš„å·¥å‚ MapperProxyFactory&lt;T&gt; mapperProxyFactory = (MapperProxyFactory)this.knownMappers.get(type); if(mapperProxyFactory == null) &#123; throw new BindingException("Type " + type + " is not known to the MapperRegistry."); &#125; else &#123; try &#123; // ç”ŸæˆMapperå®ä¾‹ï¼Œè¿›å…¥çœ‹çœ‹ return mapperProxyFactory.newInstance(sqlSession); &#125; catch (Exception var5) &#123; throw new BindingException("Error getting mapper instance. Cause: " + var5, var5); &#125; &#125;&#125;public T newInstance(SqlSession sqlSession) &#123; // åŸæ¥è¿™ä¸ªè¿˜æ˜¯ä¸ªä»£ç†å¯¹è±¡ MapperProxy&lt;T&gt; mapperProxy = new MapperProxy(sqlSession, this.mapperInterface, this.methodCache); return this.newInstance(mapperProxy);&#125; è·å¾—Mapperä»£ç†å¯¹è±¡æˆ‘çœ‹çœ‹ä»–æ˜¯æ€ä¹ˆæ‰§è¡ŒMapperæ¥å£çš„æ–¹æ³•çš„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354List&lt;User&gt; userList = userMapper.selectList();// ä¸€è¿›å»å°±å‘ç°ç›´æ¥åˆ°äº†invokeæ–¹æ³•ï¼Œç›¸å½“äºæŠŠæ–¹æ³•çš„æ‰§è¡Œéƒ½äº¤ç»™äº†ä»£ç†å¯¹è±¡å»æ‰§è¡Œpublic Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; if(Object.class.equals(method.getDeclaringClass())) &#123; try &#123; return method.invoke(this, args); &#125; catch (Throwable var5) &#123; throw ExceptionUtil.unwrapThrowable(var5); &#125; &#125; else &#123; // ä»å½“å‰ä»£ç†å¯¹è±¡å¤„ç†ç±»MapperProxyçš„methodCacheå±æ€§ä¸­è·å–MapperMethodå¯¹è±¡,å¦‚æœmethodCacheä¸­æ²¡æœ‰å°±åˆ›å»ºå¹¶åŠ è¿›å»ã€‚ MapperMethod mapperMethod = this.cachedMapperMethod(method); // è¯¥æ–¹æ³•å°±ä¼šè°ƒç”¨JDBCæ‰§è¡Œç›¸åº”çš„SQLè¯­å¥ return mapperMethod.execute(this.sqlSession, args); &#125;&#125;public Object execute(SqlSession sqlSession, Object[] args) &#123; Object param; Object result; // æ¯”å¯¹mapperæ ‡ç­¾ if(SqlCommandType.INSERT == this.command.getType()) &#123; param = this.method.convertArgsToSqlCommandParam(args); result = this.rowCountResult(sqlSession.insert(this.command.getName(), param)); &#125; else if(SqlCommandType.UPDATE == this.command.getType()) &#123; param = this.method.convertArgsToSqlCommandParam(args); result = this.rowCountResult(sqlSession.update(this.command.getName(), param)); &#125; else if(SqlCommandType.DELETE == this.command.getType()) &#123; param = this.method.convertArgsToSqlCommandParam(args); result = this.rowCountResult(sqlSession.delete(this.command.getName(), param)); &#125; else &#123; if(SqlCommandType.SELECT != this.command.getType()) &#123; throw new BindingException("Unknown execution method for: " + this.command.getName()); &#125; if(this.method.returnsVoid() &amp;&amp; this.method.hasResultHandler()) &#123; this.executeWithResultHandler(sqlSession, args); result = null; &#125; else if(this.method.returnsMany()) &#123; // æœ€ç»ˆä¼šè¿›å…¥è¿™é‡Œ result = this.executeForMany(sqlSession, args); &#125; else if(this.method.returnsMap()) &#123; result = this.executeForMap(sqlSession, args); &#125; else &#123; param = this.method.convertArgsToSqlCommandParam(args); result = sqlSession.selectOne(this.command.getName(), param); &#125; &#125; if(result == null &amp;&amp; this.method.getReturnType().isPrimitive() &amp;&amp; !this.method.returnsVoid()) &#123; throw new BindingException("Mapper method '" + this.command.getName() + " attempted to return null from a method with a primitive return type (" + this.method.getReturnType() + ")."); &#125; else &#123; return result; &#125;&#125; MapperMethodåˆ°åº•å¦‚ä½•å»æ‰§è¡ŒexecuteForMap(sqlSession, args)çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç»§ç»­è¿›å…¥ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145private &lt;E&gt; Object executeForMany(SqlSession sqlSession, Object[] args) &#123; // å°†å‚æ•°æ‹¼æ¥åˆ°SQL Object param = this.method.convertArgsToSqlCommandParam(args); List result; if(this.method.hasRowBounds()) &#123; RowBounds rowBounds = this.method.extractRowBounds(args); result = sqlSession.selectList(this.command.getName(), param, rowBounds); &#125; else &#123; // è¿›å…¥åˆ°è¿™é‡Œï¼Œè®©sqlSessionæ¥å¤„ç† result = sqlSession.selectList(this.command.getName(), param); &#125; return !this.method.getReturnType().isAssignableFrom(result.getClass())?(this.method.getReturnType().isArray()?this.convertToArray(result):this.convertToDeclaredCollection(sqlSession.getConfiguration(), result)):result;&#125;public &lt;E&gt; List&lt;E&gt; selectList(String statement, Object parameter) &#123; return this.selectList(statement, parameter, RowBounds.DEFAULT);&#125;public &lt;E&gt; List&lt;E&gt; selectList(String statement, Object parameter, RowBounds rowBounds) &#123; List var6; try &#123; // æ ¹æ®StatementId(com.todorex.UserMapper.selectList)ï¼Œ // åœ¨é…ç½®å¯¹è±¡Configurationä¸­æŸ¥æ‰¾ç›¸å¯¹åº”çš„MappedStatement MappedStatement ms = this.configuration.getMappedStatement(statement); // å°†æŸ¥è¯¢ä»»åŠ¡å§”æ‰˜ç»™MyBatis çš„æ‰§è¡Œå™¨ Executor List&lt;E&gt; result = this.executor.query(ms, this.wrapCollection(parameter), rowBounds, Executor.NO_RESULT_HANDLER); var6 = result; &#125; catch (Exception var10) &#123; throw ExceptionFactory.wrapException("Error querying database. Cause: " + var10, var10); &#125; finally &#123; ErrorContext.instance().reset(); &#125; return var6;&#125;public &lt;E&gt; List&lt;E&gt; query(MappedStatement ms, Object parameterObject, RowBounds rowBounds, ResultHandler resultHandler) throws SQLException &#123; // æ ¹æ®å…·ä½“ä¼ å…¥çš„å‚æ•°ï¼ŒåŠ¨æ€åœ°ç”Ÿæˆéœ€è¦æ‰§è¡Œçš„SQLè¯­å¥ï¼Œç”¨BoundSqlå¯¹è±¡è¡¨ç¤º BoundSql boundSql = ms.getBoundSql(parameterObject); // ä¸ºå½“å‰çš„æŸ¥è¯¢åˆ›å»ºä¸€ä¸ªç¼“å­˜Key CacheKey key = this.createCacheKey(ms, parameterObject, rowBounds, boundSql); // å†è¿›å» return this.query(ms, parameterObject, rowBounds, resultHandler, key, boundSql);&#125;public &lt;E&gt; List&lt;E&gt; query(MappedStatement ms, Object parameterObject, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql) throws SQLException &#123; // è·å¾—ç¼“å­˜å¯¹è±¡ Cache cache = ms.getCache(); if(cache != null) &#123; this.flushCacheIfRequired(ms); if(ms.isUseCache() &amp;&amp; resultHandler == null) &#123; this.ensureNoOutParams(ms, parameterObject, boundSql); // å¦‚æœç¼“å­˜ä¸­æœ‰æŸ¥è¯¢ç»“æœï¼Œåˆ™è¿”å›æŸ¥è¯¢ç»“æœ List&lt;E&gt; list = (List)this.tcm.getObject(cache, key); if(list == null) &#123; // å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰æŸ¥è¯¢ç»“æœåˆ™æŸ¥è¯¢æ•°æ®åº“ list = this.delegate.query(ms, parameterObject, rowBounds, resultHandler, key, boundSql); // å°†æŸ¥è¯¢ç»“æœæ”¾å…¥ç¼“å­˜ä¸­ this.tcm.putObject(cache, key, list); &#125; return list; &#125; &#125; // å¦‚æœæ²¡æœ‰ç¼“å­˜å¯¹è±¡åˆ™æŸ¥è¯¢æ•°æ®åº“ï¼ˆè¿›å…¥è¿™é‡Œï¼‰ return this.delegate.query(ms, parameterObject, rowBounds, resultHandler, key, boundSql);&#125;public &lt;E&gt; List&lt;E&gt; query(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql) throws SQLException &#123; ErrorContext.instance().resource(ms.getResource()).activity("executing a query").object(ms.getId()); if(this.closed) &#123; throw new ExecutorException("Executor was closed."); &#125; else &#123; if(this.queryStack == 0 &amp;&amp; ms.isFlushCacheRequired()) &#123; this.clearLocalCache(); &#125; List list; try &#123; ++this.queryStack; list = resultHandler == null?(List)this.localCache.getObject(key):null; if(list != null) &#123; this.handleLocallyCachedOutputParameters(ms, key, parameter, boundSql); &#125; else &#123; // ç¼“å­˜ä¸­æ²¡æœ‰å€¼ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®ï¼ˆè¿›å…¥è¿™é‡Œï¼‰ list = this.queryFromDatabase(ms, parameter, rowBounds, resultHandler, key, boundSql); &#125; &#125; finally &#123; --this.queryStack; &#125; return list; &#125;&#125;private &lt;E&gt; List&lt;E&gt; queryFromDatabase(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, CacheKey key, BoundSql boundSql) throws SQLException &#123; this.localCache.putObject(key, ExecutionPlaceholder.EXECUTION_PLACEHOLDER); List list; try &#123; // æ‰§è¡ŒæŸ¥è¯¢è¿”å›List ç»“æœï¼ˆè¿›å…¥è¿™é‡Œï¼‰ list = this.doQuery(ms, parameter, rowBounds, resultHandler, boundSql); &#125; finally &#123; // æ¸…æ¥šä¹‹å‰çš„ç¼“å­˜ this.localCache.removeObject(key); &#125; // å°†æŸ¥è¯¢çš„ç»“æœæ”¾å…¥ç¼“å­˜ä¹‹ä¸­ this.localCache.putObject(key, list); if(ms.getStatementType() == StatementType.CALLABLE) &#123; this.localOutputParameterCache.putObject(key, parameter); &#125; return list;&#125; public &lt;E&gt; List&lt;E&gt; doQuery(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql) throws SQLException &#123; Statement stmt = null; List var9; try &#123; Configuration configuration = ms.getConfiguration(); // åˆ›å»ºStatementHandlerå¯¹è±¡æ¥æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ StatementHandler handler = configuration.newStatementHandler(this.wrapper, ms, parameter, rowBounds, resultHandler, boundSql); // åˆ©ç”¨StatementHandlerå¯¹è±¡åˆ›å»ºjava.Sql.Statementå¯¹è±¡ï¼ˆè¿›å…¥è¿™é‡Œï¼‰ stmt = this.prepareStatement(handler, ms.getStatementLog()); // è°ƒç”¨StatementHandler.query()æ–¹æ³•ï¼Œè¿”å›Listç»“æœé›† ï¼ˆè¿›å…¥è¿™é‡Œï¼‰ var9 = handler.query(stmt, resultHandler); &#125; finally &#123; this.closeStatement(stmt); &#125; return var9;&#125;private Statement prepareStatement(StatementHandler handler, Log statementLog) throws SQLException &#123; // åˆ›å»ºè¿æ¥ Connection connection = this.getConnection(statementLog); // åˆ›å»ºjava.Sql.Statementå¯¹è±¡ï¼Œä¼ é€’ç»™StatementHandlerå¯¹è±¡ Statement stmt = handler.prepare(connection); // å¯¹åˆ›å»ºçš„Statementå¯¹è±¡è®¾ç½®å‚æ•°ï¼Œå³è®¾ç½®SQLè¯­å¥ä¸­å ä½ç¬¦è®¾ç½®ä¸ºæŒ‡å®šçš„å‚æ•° handler.parameterize(stmt); return stmt;&#125;public &lt;E&gt; List&lt;E&gt; query(Statement statement, ResultHandler resultHandler) throws SQLException &#123; // è°ƒç”¨preparedStatemntçš„execute()æ–¹æ³•ï¼Œç„¶åå°†resultSetäº¤ç»™ResultSetHandlerå¤„ç† PreparedStatement ps = (PreparedStatement)statement; ps.execute(); // ä½¿ç”¨ResultHandleræ¥å¤„ç†ResultSetï¼ˆè¿›å…¥è¿™é‡Œï¼‰ return this.resultSetHandler.handleResultSets(ps);&#125; ç»ˆäºæŸ¥è¯¢å®Œäº†ï¼Œç°åœ¨å¯ä»¥å¤„ç†ç»“æœäº†ï¼Œæˆ‘ä»¬çœ‹çœ‹handleResultSets(Statement stmt)æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738public List&lt;Object&gt; handleResultSets(Statement stmt) throws SQLException &#123; ErrorContext.instance().activity("handling results").object(this.mappedStatement.getId()); // æœ€åçš„ç»“æœé›† List&lt;Object&gt; multipleResults = new ArrayList(); int resultSetCount = 0; ResultSetWrapper rsw = this.getFirstResultSet(stmt); List&lt;ResultMap&gt; resultMaps = this.mappedStatement.getResultMaps(); int resultMapCount = resultMaps.size(); this.validateResultMapsCount(rsw, resultMapCount); while(rsw != null &amp;&amp; resultMapCount &gt; resultSetCount) &#123; // è·å¾—resultMap ResultMap resultMap = (ResultMap)resultMaps.get(resultSetCount); // è¿™é‡Œæ‰å¼€å§‹å¤„ç†ï¼ˆè¿™é‡Œè‡ªå·±å»çœ‹å§ï¼Œåæ­£ä¼šå…ˆå¤„ç†è¡Œå€¼ï¼Œç„¶åæ˜ å°„æˆå¯¹è±¡ï¼Œå’ŒJDBCä¸€æ ·ï¼‰ this.handleResultSet(rsw, resultMap, multipleResults, (ResultMapping)null); rsw = this.getNextResultSet(stmt); this.cleanUpAfterHandlingResultSet(); ++resultSetCount; &#125; String[] resultSets = this.mappedStatement.getResulSets(); if(resultSets != null) &#123; while(rsw != null &amp;&amp; resultSetCount &lt; resultSets.length) &#123; ResultMapping parentMapping = (ResultMapping)this.nextResultMaps.get(resultSets[resultSetCount]); if(parentMapping != null) &#123; String nestedResultMapId = parentMapping.getNestedResultMapId(); ResultMap resultMap = this.configuration.getResultMap(nestedResultMapId); this.handleResultSet(rsw, resultMap, (List)null, parentMapping); &#125; rsw = this.getNextResultSet(stmt); this.cleanUpAfterHandlingResultSet(); ++resultSetCount; &#125; &#125; return this.collapseSingleResultList(multipleResults);&#125; å‚è€ƒ ç»ˆç»“ç¯‡ï¼šMyBatisåŸç†æ·±å…¥è§£æï¼ˆä¸€ï¼‰ MyBatisæºç è§£æ(äºŒ)â€”â€”åŠ¨æ€ä»£ç†å®ç°å‡½æ•°è°ƒç”¨]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜Mybatis(ä¸€)_Mybatisæ¶æ„]]></title>
    <url>%2F2018%2F04%2F16%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98Mybatis-%E4%B8%80-Mybatis%E6%9E%B6%E6%9E%84%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä»JDBCåˆ°Hibernateå†åˆ°Mybatisï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨å¾ˆå¤šæ¡†æ¶ï¼Œä½†æ˜¯ä½ å´ä¸çŸ¥é“æ¡†æ¶ä¸ºä½ è§£å†³ä»€ä¹ˆäº†æˆ–æ˜¯ä¸çŸ¥é“å®ƒçš„æ•´ä¸ªæ¶æ„ï¼Œæˆ‘ä»¬è¿™é‡Œå°±æ˜¯å¸®ä½ è§£å†³è¿™äº›é—®é¢˜ï¼ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨MybatisJDBCçš„ä½¿ç”¨æ¯ä¸€ä¸ªäººå­¦Javaçš„æ•°æ®åº“æ“ä½œåº”è¯¥éƒ½æ˜¯ä»JDBCå¼€å§‹ï¼Œå®ƒåŸºæœ¬æœ‰ä»¥ä¸‹7ä¸ªæ­¥éª¤ï¼š åŠ è½½JDBCé©±åŠ¨ å»ºç«‹å¹¶è·å–æ•°æ®åº“è¿æ¥ åˆ›å»º JDBC Statements å¯¹è±¡ è®¾ç½®SQLè¯­å¥çš„ä¼ å…¥å‚æ•° æ‰§è¡ŒSQLè¯­å¥å¹¶è·å¾—æŸ¥è¯¢ç»“æœ å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œè½¬æ¢å¤„ç†å¹¶å°†å¤„ç†ç»“æœè¿”å›ï¼› é‡Šæ”¾ç›¸å…³èµ„æºï¼ˆå…³é—­Connectionï¼Œå…³é—­Statementï¼Œå…³é—­ResultSetï¼‰ï¼› JDBCç›¸åº”çš„é—®é¢˜ æ•°æ®åº“è¿æ¥é¢‘ç¹çš„å¼€å¯å’Œå…³é—­æœ¬èº«å°±é€ æˆäº†èµ„æºçš„æµªè´¹ï¼Œå½±å“ç³»ç»Ÿçš„æ€§èƒ½ SQLè¯­å¥åŸºæœ¬éƒ½æ•£è½åœ¨å„ä¸ªJAVAç±»ä¸­å¯è¯»æ€§å¾ˆå·®ï¼Œä¸åˆ©äºç»´æŠ¤ä»¥åŠåšæ€§èƒ½è°ƒä¼˜ã€‚ åœ¨åå°ä»£ç ä¸­è‡ªå·±éœ€è¦æ ¹æ®è¯·æ±‚çš„ä¼ å…¥å‚æ•°ï¼ˆå‚æ•°ä¸ªæ•°å’Œé¡ºåºéƒ½ä¸ç¡®å®šï¼‰å»æ‹¼å‡‘ç›¸åº”çš„SQLè¯­å¥ã€‚ æ‰§è¡ŒSQLè¯­å¥åï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªResultSetç»“æœé›†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦å°†ResultSetå¯¹è±¡çš„æ•°æ®å–å‡ºæ¥ï¼Œä¸ç„¶ç­‰åˆ°é‡Šæ”¾èµ„æºæ—¶å°±å–ä¸åˆ°è¿™äº›ç»“æœä¿¡æ¯äº†ã€‚ SQLé‡å¤çš„é—®é¢˜ï¼Œä¸åˆ©äºç»´æŠ¤å’Œå¤ç”¨ã€‚ Mybatisç›¸åº”çš„è§£å†³ æ•°æ®åº“è¿æ¥çš„è·å–å’Œå…³é—­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æ¥è§£å†³èµ„æºæµªè´¹çš„é—®é¢˜ã€‚é€šè¿‡è¿æ¥æ± å°±å¯ä»¥åå¤åˆ©ç”¨å·²ç»å»ºç«‹çš„è¿æ¥å»è®¿é—®æ•°æ®åº“äº†ã€‚å‡å°‘è¿æ¥çš„å¼€å¯å’Œå…³é—­çš„æ—¶é—´ã€‚ï¼ˆæ•°æ®åº“è¿æ¥æ± ä»¥åŠæ•°æ®æºçš„é…ç½®ï¼‰ å°†è¿™äº›SQLè¯­å¥ç»Ÿä¸€é›†ä¸­æ”¾åˆ°é…ç½®æ–‡ä»¶æˆ–è€…æ•°æ®åº“é‡Œé¢ï¼ˆä»¥key-valueçš„æ ¼å¼å­˜æ”¾ï¼‰ã€‚ç„¶åé€šè¿‡SQLè¯­å¥çš„keyå€¼å»è·å–å¯¹åº”çš„SQLè¯­å¥ã€‚ï¼ˆMapperæ–‡ä»¶ï¼‰ ä½¿ç”¨ä¸€ç§æœ‰åˆ«äºSQLçš„è¯­æ³•æ¥åµŒå…¥å˜é‡ï¼ˆæ¯”å¦‚ä½¿ç”¨ï¼ƒå˜é‡åï¼‰ã€‚è¿™æ ·ï¼ŒSQLè¯­å¥ç»è¿‡è§£æåå°±å¯ä»¥åŠ¨æ€çš„ç”Ÿæˆç¬¦åˆä¸Šä¸‹æ–‡çš„SQLè¯­å¥ã€‚ï¼ˆMapperæ–‡ä»¶é‡Œé¢çš„SQLè¯­å¥ï¼‰ å°†ç»“æœä¸åšä»»ä½•å¤„ç†å°±ç›´æ¥è¿”å›ï¼Œä¹Ÿæœ‰å¯èƒ½å°†ç»“æœè½¬æ¢æˆä¸€ä¸ªJavaBeanå¯¹è±¡è¿”å›ã€ä¸€ä¸ªMapè¿”å›ã€ä¸€ä¸ªListè¿”å›ç­‰ï¼Œè€Œä¸”å¯ä»¥å°†SQLè¯­å¥å’Œä¼ å…¥å‚æ•°ä¸¤éƒ¨åˆ†åˆèµ·æ¥å¯ä»¥ä½œä¸ºæ•°æ®ç¼“å­˜çš„keyå€¼ã€‚ï¼ˆè¯­å¥æ ‡ç­¾è¿”å›ç»“æœçš„é…ç½®ï¼‰ å°†é‡å¤çš„ä»£ç æŠ½ç¦»å‡ºæ¥æˆä¸ºç‹¬ç«‹çš„ä¸€ä¸ªç±»ï¼Œç„¶ååœ¨å„ä¸ªéœ€è¦ä½¿ç”¨çš„åœ°æ–¹è¿›è¡Œå¼•ç”¨ï¼ˆSQLä»£ç å—ï¼‰ Mybatisæ¶æ„ è¿™å¼ å›¾è¶…çº§æ£’ï¼Œå¯ä»¥åœ¨åé¢çš„å‚è€ƒæ‰¾åˆ°å‡ºå¤„ã€‚æˆ‘ä»¬å°±æŒ‰ç…§è¿™ä¸ª4å±‚è¿›è¡Œåˆ†æï¼š æ¥å£å±‚æ¥å£è°ƒç”¨æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š åŸºäºStatementId(å‘½åç©ºé—´+è¯­å¥id)ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 1List&lt;?&gt;|int|void sqlSession select|update|delete|insert(statementId,params) åŸºäºMapperæ¥å£ MyBatis å°†é…ç½®æ–‡ä»¶ä¸­çš„æ¯ä¸€ä¸ª èŠ‚ç‚¹æŠ½è±¡ä¸ºä¸€ä¸ª Mapper æ¥å£,è¿™ä¸ªæ¥å£ä¸­å£°æ˜çš„æ–¹æ³•å’Œ èŠ‚ç‚¹ä¸­çš„ èŠ‚ç‚¹é¡¹å¯¹åº”ï¼Œå³ èŠ‚ç‚¹çš„idå€¼ä¸ºMapper æ¥å£ä¸­çš„æ–¹æ³•åç§°ï¼ŒparameterType å€¼è¡¨ç¤ºMapper å¯¹åº”æ–¹æ³•çš„å…¥å‚ç±»å‹ï¼Œè€ŒresultMap å€¼åˆ™å¯¹åº”äº†Mapper æ¥å£è¡¨ç¤ºçš„è¿”å›å€¼ç±»å‹æˆ–è€…è¿”å›ç»“æœé›†çš„å…ƒç´ ç±»å‹ã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š 1234567891011&lt;mapper namespace="com.todorex.UserMapper"&gt; &lt;select id="selectList" resultType="com.todorex.User"&gt; select * from user &lt;/select&gt;&lt;/mapper&gt;public interface UserMapper &#123; List&lt;User&gt; selectList();&#125; æ ¹æ®MyBatis çš„é…ç½®è§„èŒƒé…ç½®å¥½åï¼Œé€šè¿‡SqlSession.getMapper(UserMapper.class)æ–¹æ³•ï¼ŒMyBatisä¼šæ ¹æ®ç›¸åº”çš„æ¥å£å£°æ˜çš„æ–¹æ³•ä¿¡æ¯ï¼Œé€šè¿‡åŠ¨æ€ä»£ç†æœº åˆ¶ ç”Ÿæˆä¸€ä¸ªMapper å®ä¾‹ï¼Œæˆ‘ä»¬è°ƒç”¨Mapperæ¥å£çš„æŸä¸€ä¸ªæ–¹æ³•æ—¶ï¼ŒMyBatisä¼šæ ¹æ®è¿™ä¸ªæ–¹æ³•çš„æ–¹æ³•åå’Œå‚æ•°ç±»å‹ï¼Œç¡®å®šStatementIdï¼Œåº•å±‚è¿˜æ˜¯é€šè¿‡StatementIdæ¥å®ç°å¯¹æ•°æ®åº“çš„æ“ä½œï¼ŒMyBatiså¼•ç”¨Mapperæ¥å£è¿™ç§è°ƒç”¨æ–¹å¼æ˜¯ä¸ºäº†æ»¡è¶³é¢å‘æ¥å£ç¼–ç¨‹çš„éœ€ è¦ã€‚ï¼ˆå…¶å®è¿˜æœ‰ä¸€ä¸ªåŸå› æ˜¯åœ¨äºï¼Œé¢å‘æ¥å£çš„ç¼–ç¨‹ï¼Œä½¿å¾—ç”¨æˆ·åœ¨æ¥å£ä¸Šå¯ä»¥ä½¿ç”¨æ³¨è§£æ¥é…ç½®SQLè¯­å¥ï¼Œè¿™æ ·å°±å¯ä»¥è„±ç¦»XMLé…ç½®æ–‡ä»¶ï¼‰ã€‚ æ•°æ®å¤„ç†å±‚æ•°æ®å¤„ç†å±‚å¯ä»¥è¯´æ˜¯MyBatisçš„æ ¸å¿ƒï¼Œå®ƒè¦å®Œæˆä¸¤ä¸ªåŠŸèƒ½ï¼š é€šè¿‡ä¼ å…¥å‚æ•°æ„å»ºåŠ¨æ€SQLè¯­å¥ MyBatis é€šè¿‡ä¼ å…¥çš„å‚æ•°å€¼ï¼Œä½¿ç”¨ OGNLè¡¨è¾¾å¼ æ¥åŠ¨æ€åœ°æ„é€ SQLè¯­å¥ï¼Œä½¿å¾—MyBatisæœ‰å¾ˆå¼ºçš„çµæ´»æ€§å’Œæ‰©å±•æ€§ã€‚å‚æ•°æ˜ å°„æŒ‡çš„æ˜¯å¯¹äºjava æ•°æ®ç±»å‹å’Œjdbcæ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼šè¿™é‡Œæœ‰åŒ…æ‹¬ä¸¤ä¸ªè¿‡ç¨‹ï¼š æŸ¥è¯¢é˜¶æ®µï¼Œæˆ‘ä»¬è¦å°†javaç±»å‹çš„æ•°æ®ï¼Œè½¬æ¢æˆjdbcç±»å‹çš„æ•°æ®ï¼Œé€šè¿‡ preparedStatement.setXXX() æ¥è®¾å€¼ è¿”å›é˜¶æ®µï¼Œæˆ‘ä»¬è¦å¯¹resultsetæŸ¥è¯¢ç»“æœé›†çš„jdbcType æ•°æ®è½¬æ¢æˆjava æ•°æ®ç±»å‹ SQLè¯­å¥çš„æ‰§è¡Œä»¥åŠå°è£…æŸ¥è¯¢ç»“æœé›†æˆList åŠ¨æ€SQLè¯­å¥ç”Ÿæˆä¹‹åï¼ŒMyBatis å°†æ‰§è¡ŒSQLè¯­å¥ï¼Œå¹¶å°†å¯èƒ½è¿”å›çš„ç»“æœé›†è½¬æ¢æˆList åˆ—è¡¨ã€‚MyBatis åœ¨å¯¹ç»“æœé›†çš„å¤„ç†ä¸­ï¼Œæ”¯æŒç»“æœé›†å…³ç³»ä¸€å¯¹å¤šå’Œå¤šå¯¹ä¸€çš„è½¬æ¢ï¼Œå¹¶ä¸”æœ‰ä¸¤ç§æ”¯æŒæ–¹å¼ï¼Œä¸€ç§ä¸ºåµŒå¥—æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯åµŒå¥—ç»“æœé›†çš„æŸ¥è¯¢ã€‚ æ¡†æ¶æ”¯æŒå±‚ äº‹åŠ¡ç®¡ç†æœºåˆ¶ äº‹åŠ¡ç®¡ç†æœºåˆ¶å¯¹äºORMæ¡†æ¶è€Œè¨€æ˜¯ä¸å¯ç¼ºå°‘çš„ä¸€éƒ¨åˆ†ï¼Œäº‹åŠ¡ç®¡ç†æœºåˆ¶çš„è´¨é‡ä¹Ÿæ˜¯è€ƒé‡ä¸€ä¸ªORMæ¡†æ¶æ˜¯å¦ä¼˜ç§€çš„ä¸€ä¸ªæ ‡å‡†ã€‚ è¿æ¥æ± ç®¡ç†æœºåˆ¶ ç”±äºåˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥æ‰€å ç”¨çš„èµ„æºæ¯”è¾ƒå¤§ï¼Œå¯¹äºæ•°æ®ååé‡å¤§å’Œè®¿é—®é‡éå¸¸å¤§çš„åº”ç”¨è€Œè¨€ï¼Œè¿æ¥æ± çš„è®¾è®¡å°±æ˜¾å¾—éå¸¸é‡è¦ã€‚ ç¼“å­˜æœºåˆ¶ ä¸ºäº†æé«˜æ•°æ®åˆ©ç”¨ç‡å’Œå‡å°æœåŠ¡å™¨å’Œæ•°æ®åº“çš„å‹åŠ›ï¼ŒMyBatis ä¼šå¯¹äºä¸€äº›æŸ¥è¯¢æä¾›ä¼šè¯çº§åˆ«çš„æ•°æ®ç¼“å­˜ï¼Œä¼šå°†å¯¹æŸä¸€æ¬¡æŸ¥è¯¢ï¼Œæ”¾ç½®åˆ°SqlSession ä¸­ï¼Œåœ¨å…è®¸çš„æ—¶é—´é—´éš”å†…ï¼Œå¯¹äºå®Œå…¨ç›¸åŒçš„æŸ¥è¯¢ï¼ŒMyBatisä¼šç›´æ¥å°†ç¼“å­˜ç»“æœè¿”å›ç»™ç”¨æˆ·ï¼Œè€Œä¸ç”¨å†åˆ°æ•°æ®åº“ä¸­æŸ¥æ‰¾ã€‚ SQLè¯­å¥çš„é…ç½®æ–¹å¼ ä¼ ç»Ÿçš„MyBatis é…ç½®SQLè¯­å¥æ–¹å¼å°±æ˜¯ä½¿ç”¨XMLæ–‡ä»¶è¿›è¡Œé…ç½®çš„ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ä¸èƒ½å¾ˆå¥½åœ°æ”¯æŒé¢å‘æ¥å£ç¼–ç¨‹çš„ç†å¿µï¼Œä¸ºäº†æ”¯æŒé¢å‘æ¥å£çš„ç¼–ç¨‹ï¼ŒMyBatis å¼•å…¥äº†Mapperæ¥å£çš„æ¦‚å¿µï¼Œé¢å‘æ¥å£çš„å¼•å…¥ï¼Œå¯¹ä½¿ç”¨æ³¨è§£æ¥é…ç½®SQLè¯­å¥æˆä¸ºå¯èƒ½ï¼Œç”¨æˆ·åªéœ€è¦åœ¨æ¥å£ä¸Šæ·»åŠ å¿…è¦çš„æ³¨è§£å³å¯ï¼Œä¸ç”¨å†å»é…ç½®XMLæ–‡ä»¶äº†ï¼Œä½†æ˜¯ï¼Œç›®å‰çš„MyBatis åªæ˜¯å¯¹æ³¨è§£é…ç½®SQLè¯­å¥æä¾›äº†æœ‰é™çš„æ”¯æŒï¼ŒæŸäº›é«˜çº§åŠŸèƒ½è¿˜æ˜¯è¦ä¾èµ–XMLé…ç½®æ–‡ä»¶é…ç½®SQL è¯­å¥ã€‚ å¼•å¯¼å±‚å¼•å¯¼å±‚æ˜¯é…ç½®å’Œå¯åŠ¨MyBatisé…ç½®ä¿¡æ¯çš„æ–¹å¼ã€‚MyBatis æä¾›ä¸¤ç§æ–¹å¼æ¥å¼•å¯¼MyBatisï¼š åŸºäºXMLé…ç½®æ–‡ä»¶çš„æ–¹å¼ åŸºäºJava API çš„æ–¹å¼ èŒƒä¾‹å¯ä»¥æŸ¥çœ‹å®˜æ–¹ä½¿ç”¨æ‰‹å†Œï¼šMybatiså®˜æ–¹ä½¿ç”¨æ‰‹å†Œ å‚è€ƒ ç»ˆç»“ç¯‡ï¼šMyBatisåŸç†æ·±å…¥è§£æï¼ˆä¸€ï¼‰]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜SpringMVC(ä¸€)_.SpringMVCå¤§å…¨è§£]]></title>
    <url>%2F2018%2F04%2F15%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98SpringMVC-%E4%B8%80-SpringMVC%E5%A4%A7%E5%85%A8%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç°åœ¨åŸºäºæ‰€æœ‰çš„Webåº”ç”¨éƒ½ç¦»ä¸å¼€Springï¼Œç”¨äº†Springï¼Œä½ è‡ªç„¶ä¼šå»ç”¨ä»–å®¶çš„MVCæ¡†æ¶â€”â€”SpringMVCï¼æ‰€ä»¥æŒæ¡SpringMVCä¹Ÿæ˜¯éå¸¸é‡è¦çš„ã€‚ SpringMVCè¯·æ±‚å¤„ç†æµç¨‹æ€»è§ˆæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢ä¸€å¼ å›¾æ¥ä»‹ç»SpringMVCçš„æ ¸å¿ƒç»„ä»¶å’Œè¯·æ±‚å¤„ç†æµç¨‹ï¼š æµç¨‹ä¸­å‡ºç°çš„æ ¸å¿ƒç»„ä»¶å¦‚ä¸‹ï¼š DispatcherServletæ˜¯springmvcä¸­çš„å‰ç«¯æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ¥æ”¶requestå¹¶å°†requestè½¬å‘ç»™å¯¹åº”çš„å¤„ç†ç»„ä»¶. HanlerMappingæ˜¯springmvcä¸­å®Œæˆurlåˆ°controlleræ˜ å°„çš„ç»„ä»¶.DispatcherServletæ¥æ”¶request,ç„¶åä»HandlerMappingæŸ¥æ‰¾å¤„ç†requestçš„controller. Controllerï¼ˆHandlerAdapterï¼‰å¤„ç†request,å¹¶è¿”å›ModelAndViewå¯¹è±¡,Controlleræ˜¯springmvcä¸­è´Ÿè´£å¤„ç†requestçš„ç»„ä»¶(ç±»ä¼¼äºstruts2ä¸­çš„Action) ModelAndViewæ˜¯å°è£…Modelå¯¹è±¡å’ŒViewå¯¹è±¡çš„ç»„ä»¶ ViewResolveræ˜¯è§†å›¾è§£æå™¨ï¼Œè´Ÿè´£è§£æModelAndViewå¯¹è±¡ç”Ÿæˆå¯¹åº”çš„Viewå¯¹è±¡ Viewè§†å›¾ç»„ä»¶ï¼Œå¤åˆ¶æ¸²æŸ“é¡µé¢ æ•´ä¸ªæµç¨‹çš„å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š å½“requeståˆ°æ¥æ—¶ï¼ŒDispatcherServletå¯¹requestè¿›è¡Œæ•è·ï¼Œå¹¶æ‰§è¡ŒdoServiceæ–¹æ³•ï¼Œç»§è€Œæ‰§è¡ŒdoDispatchæ–¹æ³•ã€‚ HandlerMappingè§£æè¯·æ±‚ï¼Œå¹¶ä¸”è¿”å›HandlerExecutionChainï¼ˆå…¶ä¸­åŒ…å«å¯¹åº”çš„controllerå’Œinterceptorsï¼‰ é€šè¿‡HandlerExecutionChainå¾—åˆ°Handlerç›¸å…³ç±»ï¼ŒHandlerå…ˆæ‰§è¡Œæ‹¦æˆªå™¨çš„preç›¸å…³æ–¹æ³•ï¼Œæ¥ç€æ‰§è¡Œhandleræ–¹æ³•ï¼Œæœ€åè°ƒç”¨æ‹¦æˆªå™¨çš„postç›¸å…³æ–¹æ³• è§£æhandleræ–¹æ³•è¿”å›çš„ModelAndView æ ¹æ®ViewResolverï¼ˆå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ï¼Œä¹Ÿå°±æ˜¯è§†å›¾è§£æå™¨ï¼‰ç”ŸæˆViewå¯¹è±¡ Viewå¯¹è±¡æ¸²æŸ“é¡µé¢å¹¶responseç»™å®¢æˆ·ç«¯ SpringMVCè¯·æ±‚å¤„ç†åˆå§‹åŒ–æºç åˆ†æ é¦–å…ˆï¼ŒTomcatæ¯æ¬¡å¯åŠ¨æ—¶éƒ½ä¼šåŠ è½½å¹¶è§£æ/WEB-INF/web.xmlæ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥å…ˆä»web.xmlæ‰¾çªç ´å£ï¼ˆDispatcherServletçš„é…ç½®ï¼‰ï¼Œä¸»è¦ä»£ç å¦‚ä¸‹ï¼ˆæˆ‘ä»¬æ¯æ¬¡éƒ½ä¼šè¿™æ ·é…ç½®ï¼‰ï¼š 123456789101112131415161718&lt;servlet &gt; &lt;servlet-name &gt;spring-mvc&lt;/servlet-name&gt; &lt;!-- DispatcherServletç±»ï¼Œè¿™ä¸ªç±»åœ¨spring-mvcçš„åŒ…ä¸‹é¢ --&gt; &lt;servlet-class &gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;!-- åˆå§‹åŒ–å‚æ•°ï¼Œè¿™é‡Œä¸»è¦æ˜¯è¯»å–SpringMVCçš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š é…ç½®æ³¨è§£é©±åŠ¨ï¼Œé™æ€èµ„æºæ˜ å°„ï¼Œè§†å›¾è§£æå™¨ï¼Œè‡ªåŠ¨æ‰«æè£…é…ç­‰ç›¸å…³ä¿¡æ¯ã€‚ --&gt; &lt;init-param &gt; &lt;param-name &gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value &gt;classpath:/spring-mvc.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;!-- å¯åŠ¨æ—¶åŠ è½½ --&gt; &lt;load-on-startup &gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping &gt; &lt;servlet-name &gt;spring-mvc&lt;/servlet-name&gt; &lt;url-pattern &gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; è¿›å…¥DispatchServletçš„åˆ†æï¼Œå…ˆçœ‹å®ƒçš„ç±»å›¾ï¼š å®ƒæ˜¯ä¸€ä¸ªServletçš„å­ç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦ä¸“æ³¨äºå®ƒçš„initã€serviceï¼ˆåç»­åˆ†æï¼‰ã€doGetã€doPostç­‰ç›¸å…³æ–¹æ³•ï¼Œåœ¨å®ƒçš„çˆ¶ç±»HttpServeltBeanï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†initæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617public final void init() throws ServletException &#123; try &#123; // è·å–Servletä¸­çš„initå‚æ•°ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªBeanWapperå¯¹è±¡ï¼Œç”±å­ç±»çœŸæ­£æ‰§è¡ŒBeanWrapperçš„åˆå§‹åŒ–å·¥ä½œ // ä½†æ˜¯HttpServeltBeançš„å­ç±»å¹¶æ²¡æœ‰è¦†ç›–å…¶initBeanWrapperæ–¹æ³•ï¼Œæ‰€ä»¥åˆ›å»ºçš„BeanWrapperæ²¡æœ‰ç”¨ PropertyValues pvs = new HttpServletBean.ServletConfigPropertyValues(this.getServletConfig(), this.requiredProperties); BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(this); ResourceLoader resourceLoader = new ServletContextResourceLoader(this.getServletContext()); bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, this.getEnvironment())); this.initBeanWrapper(bw); bw.setPropertyValues(pvs, true); &#125; catch (BeansException var4) &#123; this.logger.error("Failed to set bean properties on servlet '" + this.getServletName() + "'", var4); throw var4; &#125; // è¿™é‡Œè¿›è¦è¿›å…¥åˆ°Frameworkçš„initServletBeanæ–¹æ³•äº† this.initServletBean();&#125; ä»ä¸Šé¢çš„initæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç”±å®ƒçš„initServletBeanæ–¹æ³•è¿›å…¥åˆ°FrameworkServletçš„initServletBeanæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š 123456789101112131415protected final void initServletBean() throws ServletException &#123; long startTime = System.currentTimeMillis(); try &#123; // åˆ›å»ºSpringå®¹å™¨ï¼Œå¹¶è°ƒç”¨onRefreshæ–¹æ³•æ¥å®Œæˆé…ç½®æ–‡ä»¶çš„åŠ è½½ this.webApplicationContext = this.initWebApplicationContext(); this.initFrameworkServlet(); &#125; catch (ServletException var5) &#123; this.logger.error("Context initialization failed", var5); throw var5; &#125; catch (RuntimeException var6) &#123; this.logger.error("Context initialization failed", var6); throw var6; &#125;&#125; åœ¨å®¹å™¨åŠ è½½çš„è¿‡ç¨‹ä¸­ä¼šè°ƒç”¨DispatchServletçš„initStrategiesæ–¹æ³•æ¥å®ŒæˆDispatchservletä¸­å®šä¹‰çš„åˆå§‹åŒ–å·¥ä½œï¼Œçœ‹DispatchServletçš„æºç ï¼š 12345678910111213141516171819202122232425262728protected void onRefresh(ApplicationContext context) &#123; this.initStrategies(context);&#125;// åˆå§‹åŒ–SpringMVCæ¡†æ¶éœ€è¦çš„8ä¸ªç»„ä»¶ï¼Œè¿™8ä¸ªç»„ä»¶å¯¹åº”8ä¸ªbeanå¯¹è±¡ä¿å­˜åœ¨DispatchServletç±»ä¸­protected void initStrategies(ApplicationContext context) &#123; // ç”¨äºå¤„ç†æ–‡ä»¶ä¸Šä¼ æœåŠ¡ï¼Œå°†RequeståŒ…è£…æˆDefaultMultipartHttpServletRequest this.initMultipartResolver(context); // ç”¨äºå¤„ç†åº”ç”¨çš„å›½é™…åŒ–é—®é¢˜ï¼Œæ§åˆ¶åº”ç”¨ä¸­çš„å­—ç¬¦ç¼–ç é—®é¢˜ this.initLocaleResolver(context); // ç”¨äºå®šä¹‰ä¸€ä¸ªä¸»é¢˜ this.initThemeResolver(context); // ç”¨äºå®šä¹‰ç”¨æˆ·è®¾ç½®çš„è¯·æ±‚æ˜ å°„å…³ç³»ï¼Œå°†ç”¨æˆ·è¯·æ±‚çš„URLæ˜ å°„åæ‰èƒ½ä¸€ä¸ªä¸ªHandlerå®ä¾‹ // å¦‚æœæ²¡æœ‰å®šä¹‰HandlerMappingï¼Œå°†è·å–é»˜è®¤çš„BeanNameURLHandlerMappingå’ŒDefaultAnnotaionHandlerMapping this.initHandlerMappings(context); // ç”¨äºæ ¹æ®Handlerçš„ç±»å‹å®šä¹‰ä¸åŒçš„å¤„ç†è§„åˆ™ï¼ˆè°ƒç”¨Controllerå®ä¾‹ï¼‰ï¼Œé»˜è®¤çš„ä¸ºï¼š // HttpRequestHandlerAdapterã€SimpleControllerHandlerAdapterã€ThrowawayControllerAdapterã€AnnotationMethodHandlerAdapter this.initHandlerAdapters(context); // å½“Handleå¤„ç†å‡ºé”™æ—¶ï¼Œä¼šé€šè¿‡è¿™ä¸ªHandleræ¥ç»Ÿä¸€å¤„ç†ï¼Œé»˜è®¤ä¸ºSimpleMappingExceptionResolverï¼Œ // å°†é”™è¯¯æ—¥å¿—è®°å½•åœ¨æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”è·³è½¬åˆ°é»˜è®¤çš„é”™è¯¯é¡µé¢ this.initHandlerExceptionResolvers(context); // å°†æŒ‡å®šçš„ViewNameæŒ‰ç…§å®šä¹‰çš„requestToViewNameTranslatoræ›¿æ¢æˆæƒ³è¦çš„æ ¼å¼ï¼Œå¦‚åŠ ä¸Šå‰ç¼€æˆ–è€…åç¼€ã€‚ this.initRequestToViewNameTranslator(context); // ç”¨äºå°†Viewè§£ææˆé¡µé¢ï¼Œåœ¨ViewResolversä¸­å¯ä»¥è®¾ç½®å¤šä¸ªè§£æç­–ç•¥ï¼Œé»˜è®¤çš„è§£æç­–ç•¥ä¸ºInternalResourceViewResolverï¼ŒæŒ‰ç…§JSPé¡µé¢æ¥è§£æ this.initViewResolvers(context); // ä¸ºä¸€ä¸ªè¯·æ±‚å­˜å‚¨æ„å›¾ä¸ºå¦å¤–ä¸€ä¸ªè¯·æ±‚æ‰€ä½¿ç”¨çš„å±æ€§æä¾›äº†ä¸€æ¡é€”å¾„(é€šå¸¸å­˜å‚¨åœ¨session) this.initFlashMapManager(context);&#125; SpringMVCè¯·æ±‚å¤„ç†æµç¨‹æºç åˆ†æå…³æ³¨å®Œåˆå§‹åŒ–initæ–¹æ³•ï¼Œæˆ‘ä»¬è¦è¿›å…¥æ­£å¼çš„æµç¨‹åˆ†æäº†ï¼Œå…¶å®å°±æ˜¯åœ¨seviceæ–¹æ³•é‡Œé¢(åœ¨å…¶çˆ¶ç±»FrameworkServleté‡Œ)ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„æºç ï¼š1234567protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; if(HttpMethod.PATCH.matches(request.getMethod())) &#123; this.processRequest(request, response); &#125; else &#123; super.service(request, response); &#125;&#125; æ ¹æ®serviceæ–¹æ³•ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥è°ƒè¯•è¿›å…¥service â€“&gt; processRequest â€“&gt; doServiceï¼ˆå°†ApplicationContextã€localeResolverã€themeResolverç­‰å¯¹è±¡æ·»åŠ åˆ°requestä¸­ä»¥ä¾¿åé¢ä½¿ç”¨ï¼‰ â€“&gt; doDispatchï¼Œæˆ‘ä»¬æœ€ç»ˆå°†ç›®å…‰å®šä½åœ¨doDispatchï¼Œå› ä¸ºä»å®ƒçš„æ–¹æ³•ä½“å°±å¯ä»¥çœ‹å‡ºå®ƒæ˜¯æ•´ä¸ªSpringMVCçš„æ ¸å¿ƒæ–¹æ³•ã€‚æˆ‘ä»¬çœ‹çœ‹DispatchServleté‡Œé¢çš„doDispatchæ–¹æ³•æºç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception &#123; HttpServletRequest processedRequest = request; HandlerExecutionChain mappedHandler = null; boolean multipartRequestParsed = false; WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request); try &#123; try &#123; ModelAndView mv = null; Exception dispatchException = null; try &#123; // //å¤„ç†æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ processedRequest = this.checkMultipart(request); multipartRequestParsed = processedRequest != request; // è§£æè¯·æ±‚ï¼ˆåŒ¹é…URLï¼‰ï¼Œè·å–HandlerExecutionChainå¯¹è±¡ mappedHandler = this.getHandler(processedRequest); if(mappedHandler == null || mappedHandler.getHandler() == null) &#123; this.noHandlerFound(processedRequest, response); return; &#125; // ä»HandlerExecutionChainå¯¹è±¡è·å–HandlerAdapterå¯¹è±¡ï¼Œå®é™…ä¸Šæ˜¯ä»HandlerMappingå¯¹è±¡ä¸­è·å– HandlerAdapter ha = this.getHandlerAdapter(mappedHandler.getHandler()); String method = request.getMethod(); boolean isGet = "GET".equals(method); if(isGet || "HEAD".equals(method)) &#123; long lastModified = ha.getLastModified(request, mappedHandler.getHandler()); if(this.logger.isDebugEnabled()) &#123; this.logger.debug("Last-Modified value for [" + getRequestUri(request) + "] is: " + lastModified); &#125; if((new ServletWebRequest(request, response)).checkNotModified(lastModified) &amp;&amp; isGet) &#123; return; &#125; &#125; // åœ¨controlleræ–¹æ³•æ‰§è¡Œå‰ï¼Œæ‰§è¡Œæ‹¦æˆªå™¨çš„ç›¸å…³æ–¹æ³•ï¼ˆpreï¼‰ if(!mappedHandler.applyPreHandle(processedRequest, response)) &#123; return; &#125; // æ‰§è¡ŒHandlerAdapterå¯¹è±¡çš„handleæ–¹æ³•ï¼Œè¿”å›ModelAndView mv = ha.handle(processedRequest, response, mappedHandler.getHandler()); if(asyncManager.isConcurrentHandlingStarted()) &#123; return; &#125; this.applyDefaultViewName(processedRequest, mv); // åœ¨controlleræ–¹æ³•æ‰§è¡Œåï¼Œæ‰§è¡Œæ‹¦æˆªå™¨çš„ç›¸å…³æ–¹æ³•ï¼ˆpostï¼‰ mappedHandler.applyPostHandle(processedRequest, response, mv); &#125; catch (Exception var19) &#123; dispatchException = var19; &#125; // è¿›è¡Œè§†å›¾è§£æ this.processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException); &#125; catch (Exception var20) &#123; this.triggerAfterCompletion(processedRequest, response, mappedHandler, var20); &#125; catch (Error var21) &#123; this.triggerAfterCompletionWithError(processedRequest, response, mappedHandler, var21); &#125; &#125; finally &#123; if(asyncManager.isConcurrentHandlingStarted()) &#123; if(mappedHandler != null) &#123; mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response); &#125; &#125; else if(multipartRequestParsed) &#123; this.cleanupMultipart(processedRequest); &#125; &#125; &#125; ä¸Šé¢æ˜¯æ•´ä½“çš„æµç¨‹ï¼Œä¸‹é¢æˆ‘ä»¬å…·ä½“åˆ°å¯¹MVCæ¶æ„çš„ä¸‰ä¸ªæ¨¡å—çš„åˆ†æï¼š Controlï¼ˆCï¼‰Spring MVCçš„Controlä¸»è¦ç”±HandlerMappingå’ŒHandlerAdaptersä¸¤ä¸ªç»„ä»¶æä¾›ã€‚ HandlerMappingå¹¶æ²¡æœ‰è§„å®šè¿™ä¸ªURLä¸åº”ç”¨çš„å¤„ç†ç±»å¦‚ä½•æ˜ å°„ï¼Œåœ¨è¿™ä¸ªæ¥å£ä¸­åªå®šä¹‰äº†æ ¹æ®URLå¿…é¡»è¿”å›ä¸€ä¸ªç”±HandlerExecutionChainä»£ç†çš„å¤„ç†é“¾ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå¤„ç†é“¾ä¸­æ·»åŠ ä»»æ„çš„HandlerAdapterså®ä¾‹æ¥å¤„ç†è¿™ä¸ªURLå¯¹åº”çš„è¯·æ±‚ã€‚è¿™ä¸ªå’ŒServletè§„èŒƒä¸­çš„filterå¤„ç†æ˜¯ç±»ä¼¼çš„ã€‚ HandlerMappingçš„åˆå§‹åŒ–ï¼ˆå¯ä»¥å‚ç…§HandlerMappingçš„å­ç±»SimpleUrlHandlerMappingé‡Œé¢çš„initApplicationContextæ–¹æ³•ä»£ç ï¼‰ HandlerMappingçš„åˆå§‹åŒ–å·¥ä½œå®Œæˆçš„ä¸¤ä¸ªæœ€é‡è¦çš„å·¥ä½œå°±æ˜¯å°†URLä¸Handlerçš„å¯¹åº”å…³ç³»ä¿å­˜åœ¨handlerMapé›†åˆä¸­ï¼Œå¹¶å°†æ‰€æœ‰çš„interceptorså¯¹è±¡ä¿å­˜åœ¨adaptedInterceptorsæ•°ç»„ä¸­ï¼Œç­‰åˆ°è¯·æ±‚åˆ°æ¥æ—¶æ‰§è¡Œæ‰€æœ‰çš„adaptedInterceptorsæ•°ç»„ä¸­çš„Interceptorå¯¹è±¡ï¼Œæ‰€æœ‰çš„Interceptorå¯¹è±¡å¿…é¡»å®ç°HandlerInterceptoræ¥å£ã€‚ HandlerAdapter(å¯ä»¥çœ‹æˆController)çš„åˆå§‹åŒ–ï¼ˆå¯ä»¥å‚ç…§HandlerAdapterçš„å­ç±»SimpleControllerHandlerAdapteré‡Œé¢çš„ä»£ç ï¼‰ HandlerAdapterçš„åˆå§‹åŒ–å·¥ä½œä¸»è¦æ˜¯åˆ›å»ºä¸€ä¸ªHandlerAdapterå¯¹è±¡ï¼Œå°†è¿™ä¸ªHandlerAdapterå¯¹è±¡ä¿å­˜åœ¨DispatcherServletçš„HandlerAdaptersé›†åˆä¸­ã€‚å½“SpringMVCå°†æŸä¸ªURLå¯¹åº”åˆ°æŸä¸ªHandleræ—¶ï¼Œåœ¨HandlerAdaptersé›†åˆä¸­æŸ¥è¯¢é‚£ä¸ªHandlerAdapterså¯¹è±¡supportsè¿™ä¸ªHandlerï¼Œé‚£ä¹ˆHandlerAdapterså°±ä¼šè¢«è¿”å›ï¼ˆè®¾è®¡æ¨¡å¼ï¼‰ï¼Œå¹¶è°ƒç”¨è¿™ä¸ªHandlerAdaptersæ¥å£å¯¹åº”çš„æ–¹æ³•ã€‚å¦‚æœè¿™ä¸ªHandlerAdapterså¯¹è±¡æ˜¯SimpleControllerHandlerAdapterï¼Œåˆ™å°†è°ƒç”¨å…¶ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)æ–¹æ³•ã€‚å¦‚æœç”¨æˆ·æ²¡æœ‰å®šä¹‰HandlerAdapterçš„å®ç°ç±»ï¼Œé»˜è®¤çš„ä¸ºï¼šHttpRequestHandlerAdapterã€SimpleControllerHandlerAdapterã€ThrowawayControllerAdapterã€AnnotationMethodHandlerAdapterã€‚ Controlçš„è°ƒç”¨é€»è¾‘æ ¹æ®DispatcherServletçš„doDispathæ–¹æ³•æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡getHandleræ–¹æ³•åŒ¹é…åˆ°æŸä¸ªHandlerå¹¶è¿”å›è¿™ä¸ªHandlerçš„å¤„ç†é“¾HandlerExecutionChainå¯¹è±¡ï¼Œè€Œè¿™ä¸ªHandlerExecutionChainå¯¹è±¡å°†ä¼šåŒ…å«ä¸€ä¸ªåŒ¹é…ä¸Šçš„HandlerAdapterä»¥åŠç”¨æˆ·è‡ªå®šä¹‰çš„å¤šä¸ªHandlerInterceptorå¯¹è±¡ã€‚æˆ‘ä»¬å…ˆçœ‹HandlerInterceptoræ¥å£ï¼Œåœ¨HandlerInterceptoræ¥å£ä¸­æœ‰ä¸‰ä¸ªæ–¹æ³•å¦‚ä¸‹ï¼š123456789public interface HandlerInterceptor &#123; // åœ¨Handleræ‰§è¡Œå‰ boolean preHandle(HttpServletRequest var1, HttpServletResponse var2, Object var3) throws Exception; // åœ¨Handleræ‰§è¡Œå void postHandle(HttpServletRequest var1, HttpServletResponse var2, Object var3, ModelAndView var4) throws Exception; // åœ¨Viewæ¸²æŸ“å®Œæˆåï¼ŒDispatchServletè¿”å›ä¹‹å‰æ‰§è¡Œã€‚ // PSï¼šå½“preHandlerè¿”å›falseæ—¶ï¼Œå½“å‰çš„è¯·æ±‚å°†åœ¨æ‰§è¡Œå®Œè¯¥æ–¹æ³•åç›´æ¥è¿”å›ï¼ŒHandlerä¸å†æ‰§è¡Œ void afterCompletion(HttpServletRequest var1, HttpServletResponse var2, Object var3, Exception var4) throws Exception;&#125; æˆ‘ä»¬ç„¶åçœ‹çœ‹HandlerExecutionChainç±»çš„getHandleræ–¹æ³•ï¼Œä½ ä¼šå‘ç°è¿”å›çš„æ˜¯Objectå¯¹è±¡ï¼Œæ‰€ä»¥åœ¨è¿™é‡ŒHandlerå¯¹è±¡æ˜¯æ²¡æœ‰ç±»å‹çš„ï¼ŒHandlerçš„ç±»å‹æ˜¯ç”±HandlerAdapterï¼ˆåŒ¹é…åˆ°çš„ï¼‰å†³å®šçš„ã€‚æ¥ä¸‹é‡Œæ‰§è¡ŒHandlerå¯¹è±¡çš„å…·ä½“æ–¹æ³•ï¼Œå¦‚æœHandlerå¯¹è±¡çš„ç›¸åº”æ–¹æ³•è¿”å›ä¸€ä¸ªModelAndViewå¯¹è±¡ï¼Œæ¥ä¸‹å»å°±å»æ‰§è¡ŒViewæ¸²æŸ“ã€‚ Modelï¼ˆMï¼‰Modelå®ä¾‹æ—¢åœ¨ä¸šåŠ¡é€»è¾‘å±‚è¢«ä½¿ç”¨ï¼Œä¹Ÿåœ¨æ¸²æŸ“é¡µé¢ä¸­è¢«ä½¿ç”¨ï¼Œæˆ‘ä»¬è¿™é‡Œä¸»è¦è®²ä¸€ä¸‹åœ¨é¡µé¢æ¨¡æ¿æ¸²æŸ“ä¸­çš„ä½¿ç”¨ã€‚ å¦‚æœHandlerè¿”å›äº†ModelAndViewå¯¹è±¡ï¼Œé‚£ä¹ˆè¯´æ˜Handleréœ€è¦ä¼ ä¸€ä¸ªModelå®ä¾‹ç»™Viewå»æ¸²æŸ“æ¨¡æ¿ã€‚å¯ä»¥è¯´ModelAndViewå¯¹è±¡å°±æ˜¯è¿æ¥ä¸šåŠ¡é€»è¾‘å±‚ä¸Viewè§†å›¾å±‚çš„æ¡¥æ¢ï¼Œå¯¹SpringMVCæ¥è¯´å®ƒä¹Ÿæ˜¯è¿æ¥Handlerä¸Viewçš„æ¡¥æ¢ã€‚ ModelAndViewå¯¹è±¡ä¼šæŒæœ‰ä¸€ä¸ªModelMapå¯¹è±¡å’Œä¸€ä¸ªViewå¯¹è±¡ï¼ˆå¯ä»¥æŸ¥çœ‹ModelAndViewçš„æºç ï¼‰ï¼ŒModelMapå¯¹è±¡å°±æ˜¯æ‰§è¡Œæ¨¡æ¿æ¸²æŸ“æ—¶æ‰€éœ€è¦çš„å˜é‡å¯¹åº”çš„å®ä¾‹ï¼ˆå¯¹åº”åˆ°Struts2çš„å€¼æ ˆï¼‰ï¼Œå¦‚JSPé€šè¿‡request.getAttribute(String)è·å¾—JSTLæ ‡ç­¾åå¯¹åº”çš„å¯¹è±¡ã€‚ModelMapå…¶å®ä¹Ÿæ˜¯ä¸ªMapï¼Œåœ¨Handlerä¸­å°†æ¨¡æ¿éœ€è¦çš„å¯¹è±¡å­˜åœ¨è¿™ä¸ªMapä¸­ï¼Œç„¶åä¼ é€’åˆ°Viewå¯¹åº”çš„ViewResolversä¸­ã€‚ Viewï¼ˆVï¼‰Spring MVCçš„Viewä¸»è¦ç”±RequestToViewNameTranslatorå’ŒViewResolverä¸¤ä¸ªç»„ä»¶æä¾›ã€‚ RequestToViewNameTranslatoræ”¯æŒç”¨æˆ·è‡ªå®šä¹‰å¯¹ViewNameçš„è§£æï¼Œå¦‚åŠ ä¸Šå‰ç¼€æˆ–è€…åç¼€ç­‰ã€‚ ViewResolverä¼šæ ¹æ®ç”¨æˆ·çš„è¯·æ±‚çš„ViewNameåˆ›å»ºåˆé€‚çš„æ¨¡æ¿å¼•æ“ï¼ˆè§£æå™¨ï¼‰æ¥æ¸²æŸ“æœ€ç»ˆçš„é¡µé¢ã€‚ViewResolverä¼šæ ¹æ®ViewNameåˆ›å»ºä¸€ä¸ªViewå¯¹è±¡ï¼Œè°ƒç”¨Viewå¯¹è±¡çš„renderæ–¹æ³•æ¸²æŸ“é¡µé¢ã€‚ æˆ‘ä»¬é‡ç‚¹å…³æ³¨è¿™ä¸ªViewResolverï¼Œå…ˆçœ‹ä»–çš„ç±»å›¾ï¼š æˆ‘ä»¬ä»UrlBaseViewResolverå¯¹è±¡çš„loadViewæ–¹æ³•-&gt;buildViewæ–¹æ³•å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä»£ç ï¼š 12345678910protected AbstractUrlBasedView buildView(String viewName) throws Exception &#123; AbstractUrlBasedView view = (AbstractUrlBasedView)BeanUtils.instantiateClass(this.getViewClass()); view.setUrl(this.getPrefix() + viewName + this.getSuffix()); String contentType = this.getContentType(); if(contentType != null) &#123; view.setContentType(contentType); &#125; ... çœç•¥ return view;&#125; ç»“åˆç±»å›¾å¯ä»¥å‘ç°ä¸åŒçš„è§£æå™¨ç”Ÿæˆçš„Viewå¯¹è±¡æ˜¯ä¸ä¸€æ ·çš„ã€‚ è·å¾—Viewå¯¹è±¡ä¹‹åå°±å¯ä»¥è°ƒç”¨Viewå¯¹è±¡çš„renderæ–¹æ³•æ¸²æŸ“é¡µé¢ã€‚ å‚è€ƒ ã€Šæ·±å…¥åˆ†æJava WebæŠ€æœ¯å†…å¹•ã€‹ ä¸€æ­¥æ­¥åˆ†æSpringMVCæºç ]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜Spring(å››)_Springè®¾è®¡æ¨¡å¼]]></title>
    <url>%2F2018%2F04%2F12%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98Spring-%E5%9B%9B-Spring%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè¯´å®Œäº†IOCå’ŒAOPï¼ˆè™½ç„¶å¯èƒ½è¿˜æ˜¯ä¸å¤Ÿæ·±å…¥ï¼Œä¸å¤Ÿå…¨é¢ï¼Œä½†æ˜¯å¯¹äºè‡ªå·±è¿˜æ˜¯æœ‰ä¸€å®šçš„æ”¶è·ï¼Œæ—¥åæœ‰æ–°çš„é¢†æ‚Ÿå†æ¥è°ƒæ•´ï¼‰ï¼Œå†æ¥è¯´è¯´Springè¿™ä¹ˆä¼˜ç§€çš„æ¡†æ¶æ‰€ä½¿ç”¨çš„çš„è®¾è®¡æ¨¡å¼ï¼Œå¯è°“éåœ°éƒ½æ˜¯ï¼Œæˆ‘å°±è‡ªå·±çœ‹åˆ°å†™ä¸€ä¸‹ã€‚ å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å•ä¾‹æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„å•ä¾‹æ¨¡å¼å¯ä»¥åœ¨org.springframework.beans.factory.config.AbstractFactoryBeanç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚çœ‹çœ‹å®ƒçš„getObjectæ–¹æ³•ï¼š1234public final T getObject() throws Exception &#123; // å¦‚æœæ˜¯å•ä¾‹ä¸”å·²ç»åˆå§‹åŒ–ï¼Œå°±ç›´æ¥è¿”å› return this.isSingleton()?(this.initialized?this.singletonInstance:this.getEarlySingletonInstance()):this.createInstance();&#125; å·¥å‚æ–¹æ³•æ¨¡å¼å·¥å‚æ–¹æ³•æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„å·¥å‚æ–¹æ³•æ¨¡å¼å¯ä»¥åœ¨org.springframework.beans.factory.BeanFactoryç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸‹é¢çš„ä»£ç ï¼š1234public interface BeanFactory &#123; // æ ¹æ®å”¯ä¸€æ ‡è¯†æ¥è·å¾—Beanå¯¹è±¡ Object getBean(String var1) throws BeansException;&#125; æŠ½è±¡å·¥å‚æ¨¡å¼æŠ½è±¡å·¥å‚æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥åœ¨org.springframework.beans.factory.BeanFactoryç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚é€šè¿‡å®ƒçš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥ä»Springçš„å®¹å™¨è®¿é—®beanã€‚æ ¹æ®é‡‡ç”¨çš„ç­–ç•¥ï¼ŒgetBeanæ–¹æ³•å¯ä»¥è¿”å›å·²åˆ›å»ºçš„å¯¹è±¡ï¼ˆå…±äº«å®ä¾‹ï¼Œå•ä¾‹ä½œç”¨åŸŸï¼‰æˆ–åˆå§‹åŒ–æ–°çš„å¯¹è±¡ï¼ˆåŸå‹ä½œç”¨åŸŸï¼‰ã€‚åœ¨BeanFactoryçš„å®ç°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åŒºåˆ†ï¼šClassPathXmlApplicationContextï¼ŒXmlWebApplicationContextï¼ŒStaticWebApplicationContextï¼ŒStaticPortletApplicationContextï¼ŒGenericApplicationContextï¼ŒStaticApplicationContextï¼Œç›¸å½“äºä¸åŒçš„Creatorã€‚ å»ºé€ è€…æ¨¡å¼å»ºé€ è€…æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å»ºé€ è€…æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„å»ºé€ è€…æ¨¡å¼å¯ä»¥åœ¨org.springframework.beans.factory.support.BeanDefinitionBuilderç±»ä¸­æ£€ç´¢è¿™ä¸ªé€»è¾‘ã€‚è¿™æ˜¯ä¸€ä¸ªå…è®¸æˆ‘ä»¬ä»¥ç¼–ç¨‹æ–¹å¼å®šä¹‰beançš„ç±»ã€‚BeanDefinitionBuilderåŒ…å«å‡ ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬ä¸ºAbstractBeanDefinitionæŠ½è±¡ç±»çš„ç›¸å…³å®ç°è®¾ç½®å€¼ï¼Œæ¯”å¦‚ä½œç”¨åŸŸï¼Œå·¥å‚æ–¹æ³•ï¼Œå±æ€§ç­‰ã€‚æƒ³çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¯·æŸ¥çœ‹ä»¥ä¸‹è¿™äº›æ–¹æ³•ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041public class BeanDefinitionBuilder &#123; private AbstractBeanDefinition beanDefinition; // è®¾ç½®Beançš„çˆ¶ç±»å public BeanDefinitionBuilder setParentName(String parentName) &#123; this.beanDefinition.setParentName(parentName); return this; &#125; // è®¾ç½®Beançš„å·¥å‚æ–¹æ³• public BeanDefinitionBuilder setFactoryMethod(String factoryMethod) &#123; this.beanDefinition.setFactoryMethodName(factoryMethod); return this; &#125; // è®¾ç½®Beançš„æ„é€ å‡½æ•°å‚æ•° public BeanDefinitionBuilder addConstructorArgValue(Object value) &#123; this.beanDefinition.getConstructorArgumentValues().addIndexedArgumentValue( this.constructorArgIndex++, value); return this; &#125; // æ·»åŠ Beançš„å±æ€§å€¼ public BeanDefinitionBuilder addPropertyValue(String name, Object value) &#123; this.beanDefinition.getPropertyValues().add(name, value); return this; &#125; // è®¾ç½®Beançš„åˆå§‹åŒ–æ–¹æ³• public BeanDefinitionBuilder setInitMethodName(String methodName) &#123; this.beanDefinition.setInitMethodName(methodName); return this; &#125; // è¿”å›å»ºé€ å¥½çš„å¯¹è±¡ public AbstractBeanDefinition getBeanDefinition() &#123; this.beanDefinition.validate(); return this.beanDefinition; &#125;&#125; åŸå‹æ¨¡å¼åŸå‹æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”åŸå‹æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„åŸå‹æ¨¡å¼å¯ä»¥åœ¨org.springframework.beans.factory.support.AbstractBeanFactoryç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚å®ƒä½¿ç”¨ä¸€ç§ç‰¹å®šçš„åŸå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå…ˆåˆå§‹åŒ–beanåŸå‹ä½œç”¨åŸŸ(å…‹éš†)ã€‚æ–°å¯¹è±¡åŸºäºé…ç½®æ–‡ä»¶ä¸­çš„beanå®šä¹‰ã€‚ æ¨¡æ¿æ¨¡å¼æ¨¡æ¿æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”æ¨¡æ¿æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„æ¨¡æ¿æ¨¡å¼å¯ä»¥åœ¨org.springframework.context.support.AbstractApplicationContextç±»ä»¥åŠå®ƒçš„å®ç°ç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚å®ƒçš„æ¨¡æ¿æ–¹æ³•æ˜¯refreshæ–¹æ³•ï¼Œè€ŒrefreshBeanFactoryä»¥åŠgetBeanFactoryç­‰æ–¹æ³•éƒ½ç”±å­ç±»å…·ä½“å®ç°ã€‚ è®¿é—®è€…æ¨¡å¼è®¿é—®è€…æ¨¡å¼æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è®¿é—®è€…æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„è®¿é—®è€…æ¨¡å¼å¯ä»¥åœ¨org.springframework.beans.factory.config.BeanDefinitionVisitorç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚è¯¥å¯¹è±¡ç”¨äºè§£æbeanå…ƒæ•°æ®å¹¶å°†å…¶è§£æä¸ºStringï¼ˆä¾‹å¦‚ï¼šå…·æœ‰ä½œç”¨åŸŸæˆ–å·¥å‚æ–¹æ³•åç§°çš„XMLå±æ€§ï¼‰æˆ–Objectï¼ˆä¾‹å¦‚ï¼šæ„é€ å‡½æ•°å®šä¹‰ä¸­çš„å‚æ•°ï¼‰ã€‚å·²è§£æçš„å€¼åœ¨ä¸åˆ†æçš„beanå…³è”çš„BeanDefinitionå®ä¾‹ä¸­è¿›è¡Œåˆ¤æ–­è®¾ç½®ã€‚å…·ä½“çš„æºç è¯·çœ‹BeanDefinitionVisitorçš„ä»£ç ç‰‡æ®µï¼š12345678910111213141516171819202122232425262728public class BeanDefinitionVisitor &#123; public void visitBeanDefinition(BeanDefinition beanDefinition) &#123; visitParentName(beanDefinition); visitBeanClassName(beanDefinition); visitFactoryBeanName(beanDefinition); visitFactoryMethodName(beanDefinition); visitScope(beanDefinition); visitPropertyValues(beanDefinition.getPropertyValues()); ConstructorArgumentValues cas = beanDefinition. getConstructorArgumentValues(); visitIndexedArgumentValues(cas. getIndexedArgumentValues()); visitGenericArgumentValues(cas. getGenericArgumentValues()); &#125; protected void visitParentName(BeanDefinition beanDefinition) &#123; String parentName = beanDefinition.getParentName(); if (parentName != null) &#123; String resolvedName = resolveStringValue(parentName); if (!parentName.equals(resolvedName)) &#123; beanDefinition.setParentName(resolvedName); &#125; &#125;&#125;&#125; ä»£ç†æ¨¡å¼ä»£ç†æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”ä»£ç†æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„ä»£ç†æ¨¡å¼å¯ä»¥åœ¨org.springframework.aop.framework.ProxyFactoryBeanç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚è¯¦ç»†è¯´æ˜å¯ä»¥å‚ç…§ä¸Šä¸€ç¯‡æ–‡ç« ã€‚ ç­–ç•¥æ¨¡å¼ç­–ç•¥æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”ç­–ç•¥æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„ç­–ç•¥æ¨¡å¼å¯ä»¥åœ¨org.springframework.aop.framework.DefaultAopProxyFactoryç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ã€‚çœ‹ä¸€ä¸‹è¿™ä¸ªç±»çš„æºç ï¼š1234567891011121314151617public class DefaultAopProxyFactory implements AopProxyFactory, Serializable &#123; public AopProxy createAopProxy(AdvisedSupport config) throws AopConfigException &#123; if(!config.isOptimize() &amp;&amp; !config.isProxyTargetClass() &amp;&amp; !this.hasNoUserSuppliedProxyInterfaces(config)) &#123; return new JdkDynamicAopProxy(config); &#125; else &#123; Class&lt;?&gt; targetClass = config.getTargetClass(); if(targetClass == null) &#123; throw new AopConfigException("TargetSource cannot determine target class: Either an interface or a target is required for proxy creation."); &#125; else &#123; // æ ¹æ®ç›®æ ‡ç±»æ˜¯å¦æœ‰æ¥å£è€Œé‡‡å–ä¸åŒçš„ç­–ç•¥ return (AopProxy)(!targetClass.isInterface() &amp;&amp; !Proxy.isProxyClass(targetClass)?new ObjenesisCglibAopProxy(config):new JdkDynamicAopProxy(config)); &#125; &#125; &#125;&#125; é€‚é…å™¨æ¨¡å¼é€‚é…å™¨æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”é€‚é…å™¨æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„é€‚é…å™¨æ¨¡å¼å¯ä»¥åœ¨org.springframework.aop.framework.adapter.DefaultAdvisorAdapterRegistryç±»ä¸­çœ‹åˆ°è¿™ä¸ªé€»è¾‘ï¼ŒSpringéœ€è¦å°†æ¯ä¸ªAdviceï¼ˆé€šçŸ¥ï¼‰éƒ½å°è£…æˆå¯¹åº”çš„æ‹¦æˆªå™¨ç±»å‹ï¼Œè¿”å›ç»™å®¹å™¨ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨é€‚é…å™¨æ¨¡å¼å¯¹Adviceè¿›è¡Œè½¬æ¢ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹å…·ä½“çš„ä»£ç ï¼š12345678910111213141516171819202122232425// Adapteepublic interface MethodBeforeAdvice extends BeforeAdvice &#123; void before(Method method, Object[] args, Object target) throws Throwable; &#125;// Targetpublic interface AdvisorAdapter &#123; boolean supportsAdvice(Advice advice); MethodInterceptor getInterceptor(Advisor advisor); &#125;// Adapterclass MethodBeforeAdviceAdapter implements AdvisorAdapter, Serializable &#123; public boolean supportsAdvice(Advice advice) &#123; return (advice instanceof MethodBeforeAdvice); &#125; public MethodInterceptor getInterceptor(Advisor advisor) &#123; MethodBeforeAdvice advice = (MethodBeforeAdvice) advisor.getAdvice(); return new MethodBeforeAdviceInterceptor(advice); &#125; &#125; è§‚å¯Ÿè€…æ¨¡å¼è§‚å¯Ÿè€…æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è§‚å¯Ÿè€…æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„è§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ç›¸å…³çš„äº‹ä»¶ä¼ è¾“çœ‹åˆ°è¿™ä¸ªé€»è¾‘ï¼Œå…·ä½“ä¸€ç‚¹åœ¨AbstractApplicationContextä¸org.springframework.context.ApplicationListenerä»¥åŠorg.springframework.context.event.ApplicationEventMulticasterä¸­çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç›¸å…³ä»£ç ï¼š123456789101112131415161718192021222324public abstract class AbstractApplicationContext extends DefaultResourceLoader implements ConfigurableApplicationContext, DisposableBean &#123; // å®šä¹‰ä¼ æ’­è€…ï¼Œç”¨æ¥ä¼ æ’­æ¶ˆæ¯ private ApplicationEventMulticaster applicationEventMulticaster; // æ³¨å†Œç›‘å¬è€… protected void registerListeners() &#123; ... &#125;&#125;public interface ApplicationEventMulticaster &#123; void addApplicationListener(ApplicationListener&lt;?&gt; var1); void addApplicationListenerBean(String var1); void removeApplicationListener(ApplicationListener&lt;?&gt; var1); void removeApplicationListenerBean(String var1); void removeAllListeners(); void multicastEvent(ApplicationEvent var1); void multicastEvent(ApplicationEvent var1, ResolvableType var2);&#125; è§£é‡Šå™¨æ¨¡å¼è§£é‡Šå™¨æ¨¡å¼çš„çš„åŸç†å¯ä»¥å‚ç…§è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è§£é‡Šå™¨æ¨¡å¼ã€‚ Springåº”ç”¨åˆ°çš„è§£é‡Šå™¨æ¨¡å¼ä¸»è¦ä»¥Spring Expression Languageï¼ˆSpELï¼‰ä¸ºä¾‹ã€‚SpELæ˜¯ä¸€ç§ç”±Springçš„org.springframework.expression.ExpressionParserå®ç°åˆ†æå’Œæ‰§è¡Œçš„è¯­è¨€ã€‚è¿™äº›å®ç°ä½¿ç”¨ä½œä¸ºå­—ç¬¦ä¸²ç»™å‡ºçš„Spelè¡¨è¾¾å¼ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºorg.springframework.expression.Expressionçš„å®ä¾‹ã€‚ä¸Šä¸‹æ–‡ç»„ä»¶ç”±org.springframework.expression.EvaluationContextå®ç°è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼šStandardEvaluationContextã€‚ å‚è€ƒå‚è€ƒäº†è¶…çº§å¤šï¼Œéƒ½å¿«å¿˜äº†ï¼Œå„ä½å¤§ä½¬ä¸è¦ä»‹æ„ï¼]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Centos7åˆ©ç”¨Nginxé…ç½®HTTPS]]></title>
    <url>%2F2018%2F04%2F12%2F%E5%B7%A5%E5%85%B7%2FCentos7%E5%88%A9%E7%94%A8Nginx%E9%85%8D%E7%BD%AEHTTPS%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæœ€è¿‘åœ¨åšä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºé¡¹ç›®ï¼Œå‘çˆ¹çš„å°ç¨‹åºä¸ä»…éœ€è¦httpsåè®®ï¼Œè€Œä¸”è¿˜è¦æ˜¯80ç«¯å£æ‰èƒ½è®¿é—®åå°ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹Nginxçš„å®‰è£…è¿‡ç¨‹ä¸HTTPSçš„é…ç½®ã€‚ Ngnixçš„å®‰è£…ç”±äºåé¢Nginxéœ€è¦æ·»åŠ æ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨æºç å®‰è£…ï¼Œå…·ä½“å®‰è£…æ–¹æ³•å¯ä»¥å‚è€ƒ èµ°è¿›Linux_è½¯ä»¶å®‰è£… ä¸­çš„æºç å®‰è£…ä¸€èŠ‚ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æˆ‘ä»¬åœ¨ äº§ç”Ÿmakefileæ–‡ä»¶çš„æ—¶å€™ éœ€è¦åŠ ä¸€äº›configure argumentsï¼Œä»¥ä¾¿å®‰è£…ç›¸å…³æ¨¡å—ã€‚å¦‚ä¸‹ï¼š1./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-file-aio --with-http_realip_module å®‰è£…å®Œä¹‹åå¯ä»¥åˆ©ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹Ngnixç‰ˆæœ¬åŠå…¶ç¼–è¯‘å‚æ•°ï¼š12345678/usr/local/nginx/sbin/nginx -V// è¾“å‡ºå¦‚ä¸‹ç»“æœå°±æ˜¯å¯¹çš„nginx version: nginx/1.11.6built by gcc 4.8.5 20150623 (Red Hat 4.8.5-16) (GCC)built with OpenSSL 1.0.2k-fips 26 Jan 2017TLS SNI support enabledconfigure arguments: --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-file-aio --with-http_realip_module ç„¶åæˆ‘ä»¬æµ‹è¯•æ–°çš„nginxç¨‹åºæ˜¯å¦æ­£ç¡®ï¼š12345/usr/local/nginx/sbin/nginx -t// è¾“å‡ºå¦‚ä¸‹ç»“æœJå°±è¡¨é¢å®‰è£…æˆåŠŸnginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is oknginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful é…ç½®HTTPSSSLè¯ä¹¦ç”³è¯·SSLè¯ä¹¦éµå®ˆ SSLï¼ˆSecure Sockets Layer å®‰å…¨å¥—æ¥å±‚ï¼‰åè®®ï¼Œç”±å—ä¿¡ä»»çš„æ•°å­—è¯ä¹¦é¢å‘æœºæ„CAï¼Œåœ¨éªŒè¯æœåŠ¡å™¨èº«ä»½åé¢å‘ï¼Œå…·æœ‰æœåŠ¡å™¨èº«ä»½éªŒè¯å’Œæ•°æ®ä¼ è¾“åŠ å¯†åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ æƒ³è¦ä½¿ç”¨httpså°±éœ€è¦æ‹¥æœ‰SSLè¯ä¹¦ã€‚ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨opensslè¯ä¹¦æ¥ä¸¾ä¾‹ï¼Œå¾®ä¿¡å°ç¨‹åºå®˜ç½‘ä¹Ÿæ˜¯ä½¿ç”¨opensslæ¥è¿›è¡ŒHTTPSæœåŠ¡å™¨é…ç½®ã€‚ ç”Ÿæˆç§é’¥ 1234567891011// è¿›å…¥nginxçš„å®‰è£…ç›®å½•cd /usr/local/nginx// åˆ›å»ºä¸€ä¸ªå­˜æ”¾ç§é’¥çš„æ–‡ä»¶å¤¹ï¼ˆè‡ªå®šä¹‰ï¼‰mkdir key// è¿›å…¥keyæ–‡ä»¶å¤¹cd key// ç”Ÿæˆç§é’¥openssl genrsa -out server.key 2048 ç”Ÿæˆcsræ–‡ä»¶ 12345678910111213141516// CSR æ˜¯Certificate Signing Requestçš„ç¼©å†™ï¼Œå³è¯ä¹¦ç­¾åè¯·æ±‚ï¼Œ// è¿™ä¸æ˜¯è¯ä¹¦ï¼Œå¯ä»¥ç®€å•ç†è§£æˆå…¬é’¥ï¼Œç”Ÿæˆè¯ä¹¦æ—¶è¦æŠŠè¿™ä¸ªæäº¤ç»™æƒå¨çš„è¯ä¹¦é¢å‘æœºæ„ã€‚// ç”Ÿæˆcsræ–‡ä»¶openssl req -new -key server.key -out certreq.csr// è¾“å…¥ä¸Šé¢çš„å‘½ä»¤åä¼šè¦æ±‚ä½ è¾“å…¥ä¸€äº›ä¿¡æ¯ï¼šCountry Nameï¼š CN //æ‚¨æ‰€åœ¨å›½å®¶çš„ISOæ ‡å‡†ä»£å·ï¼Œä¸­å›½ä¸ºCNState or Province Nameï¼šguandong //æ‚¨å•ä½æ‰€åœ¨åœ°çœ/è‡ªæ²»åŒº/ç›´è¾–å¸‚Locality Nameï¼šshenzhen //æ‚¨å•ä½æ‰€åœ¨åœ°çš„å¸‚/å¿/åŒºOrganization Nameï¼š Tencent Technology (Shenzhen) Company Limited //æ‚¨å•ä½/æœºæ„/ä¼ä¸šåˆæ³•çš„åç§°Organizational Unit Nameï¼š R&amp;D //éƒ¨é—¨åç§°Common Nameï¼š www.example.com //é€šç”¨åï¼Œç½‘ç«™åŸŸåã€‚æ­¤é¡¹å¿…é¡»ä¸æ‚¨è®¿é—®æä¾›SSLæœåŠ¡çš„æœåŠ¡å™¨æ—¶æ‰€åº”ç”¨çš„åŸŸåå®Œå…¨åŒ¹é…ã€‚Email Addressï¼š //æ‚¨çš„é‚®ä»¶åœ°å€ï¼Œä¸å¿…è¾“å…¥ï¼Œç›´æ¥å›è½¦è·³è¿‡&quot;extra&quot;attributes // ä»¥ä¸‹ä¿¡æ¯ä¸å¿…è¾“å…¥ï¼Œå›è½¦è·³è¿‡ç›´åˆ°å‘½ä»¤æ‰§è¡Œå®Œæ¯•ã€‚ ç”Ÿæˆcrtè¯ä¹¦ 12// CRT å³ certificateçš„ç¼©å†™ï¼Œå³è¯ä¹¦ã€‚openssl x509 -req -days 365 -in certreq.csr -signkey server.key -out certreq.crt Nginxé…ç½®SSLåŠ å¯†æƒ³è¦httpså°±è¦ç›‘å¬443ç«¯å£ï¼Œnginx.confå·²ç»é¢„ç•™å‡ºäº†serverï¼Œåªè¦æˆ‘ä»¬æŠŠæ³¨é‡Šå»æ‰å¼€å¯å³å¯ã€‚ 12345678910111213141516171819202122232425// ç¼–è¾‘Ngnixé…ç½®æ–‡ä»¶vim /usr/local/nginx/conf/nginx.conf// ä¿®æ”¹ç›‘å¬443ç«¯å£çš„Serverï¼Œä½¿å…¶å¦‚ä¸‹ï¼šserver &#123; listen 443 ssl; server_name www.example.com; ssl on; # ssl_certificateè¯ä¹¦å…¶å®æ˜¯ä¸ªå…¬é’¥ï¼Œå®ƒä¼šè¢«å‘é€åˆ°è¿æ¥æœåŠ¡å™¨çš„æ¯ä¸ªå®¢æˆ·ç«¯ ssl_certificate /usr/local/nginx/key/certreq.crt; # ssl_certificate_keyç§é’¥æ˜¯ç”¨æ¥è§£å¯†çš„ï¼Œæ‰€ä»¥å®ƒçš„æƒé™è¦å¾—åˆ°ä¿æŠ¤ä½†nginxçš„ä¸»è¿›ç¨‹èƒ½å¤Ÿè¯»å– ssl_certificate_key /usr/local/nginx/key/server.key; ssl_session_timeout 5m; # æŒ‡å®šSSLæœåŠ¡å™¨ç«¯æ”¯æŒçš„åè®®ç‰ˆæœ¬ ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # é€‰æ‹©åŠ å¯†ç®—æ³• ssl_ciphers HIGH:!aNULL:!MD5; # ssl_ciphers ALLï¼š!ADHï¼š!EXPORT56ï¼šRC4+RSAï¼š+HIGHï¼š+MEDIUMï¼š+LOWï¼š+SSLv2ï¼š+EXP; # åœ¨ä½¿ç”¨SSLv3å’ŒTLSåè®®æ—¶æŒ‡å®šæœåŠ¡å™¨çš„åŠ å¯†ç®—æ³•è¦ä¼˜å…ˆäºå®¢æˆ·ç«¯çš„åŠ å¯†ç®—æ³• ssl_prefer_server_ciphers on; # è™½ç„¶æˆ‘ä»¬è¦ä½¿ç”¨HTTPSï¼Œä½†æ˜¯æœåŠ¡å™¨çš„ç¨‹åºæ¥æ”¶çš„è¿˜æ˜¯HTTPï¼Œæ‰€ä»¥è¦åšä¸ªåå‘ä»£ç† location /&#123; proxy_pass http://localhost:8080; &#125;&#125; è¿™æ ·è™½ç„¶å¯ä»¥åˆ©ç”¨httpsæ¥è®¿é—®æˆ‘ä»¬çš„ipï¼Œä½†æ˜¯å¯¹äºæµè§ˆå™¨è¿˜æ˜¯ä¸å—ä¿¡ä»»çš„ã€‚ å¯¼å…¥è¯ä¹¦å¦‚æœä½ æ˜¯æ‰¾ä¸€ä¸ªçŸ¥åçš„SSLè¯ä¹¦é¢å‘æœºæ„å¦‚VeriSignã€Wosignã€StartSSLç­¾å‘çš„è¯ä¹¦ï¼Œå¹¶ä¸”æµè§ˆå™¨å·²ç»å†…ç½®å¹¶ä¿¡ä»»äº†è¿™äº›æ ¹è¯ä¹¦ï¼Œå¦‚æœä½ æ˜¯è‡ªå»ºè¯ä¹¦ï¼ˆå‘æˆ‘ä»¬åˆšæ‰é‚£æ ·ï¼‰æˆ–è·å¾—äºŒçº§è¯ä¹¦æˆæƒï¼Œé‚£ä¹ˆå°±éœ€è¦å°†è¯ä¹¦æ·»åŠ åˆ°æµè§ˆå™¨ï¼Œè¿™æ ·åœ¨è®¿é—®ç«™ç‚¹æ—¶æ‰ä¸ä¼šæ˜¾ç¤ºä¸å®‰å…¨è¿æ¥ã€‚ä¸å¤Ÿä¹°è¯ä¹¦å¾®ä¿¡å°ç¨‹åºä¼šä¸æ”¯æŒã€‚ è¯ä¹¦ç”Ÿæˆçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè¿™é‡Œè¯´ä¸¤ç§ï¼š è´­ä¹°é˜¿é‡Œäº‘çš„å…è´¹è¯ä¹¦ è´­ä¹°GETSSLå®˜ç½‘è¯ä¹¦ è´­ä¹°å¥½è¯ä¹¦å¹¶ä¸‹è½½åï¼ˆå¯ä»¥å°†è¯ä¹¦å’Œç§é’¥æ”¾åˆ°ä¹‹å‰çš„keyç›®å½•ï¼‰éœ€è¦ä»æ–°é…ç½®nginx.confæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š123456789101112131415server &#123; listen 443 ssl; server_name www.example.com; ssl on; # pemæ˜¯crtçš„ä¸€ç§ï¼Œå†…å®¹æ˜¯BASE64ç¼–ç ï¼ŒApacheå’Œ*NIXæœåŠ¡å™¨åå‘äºä½¿ç”¨è¿™ç§ç¼–ç æ ¼å¼ ssl_certificate /usr/local/nginx/key/*.pem; ssl_certificate_key /usr/local/nginx/key/*.key; ssl_session_timeout 5m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers HIGH:!aNULL:!MD5; ssl_prefer_server_ciphers on; location /&#123; proxy_pass http://localhost:8080; &#125;&#125; å‚è€ƒ linux nginxé…ç½®https opensslã€x509ã€crtã€cerã€keyã€csrã€sslã€tls è¿™äº›éƒ½æ˜¯ä»€ä¹ˆé¬¼?]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>HTTPS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜Spring(ä¸‰)_Springä¹‹AOP]]></title>
    <url>%2F2018%2F04%2F11%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98Spring-%E4%B8%89-Spring%E4%B9%8BAOP%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå‰ä¸€èŠ‚è®²åˆ°Springçš„æ ¸å¿ƒæ¦‚å¿µIOCï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä¸æåˆ°Springçš„å¦ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µAOPï¼Œæˆ‘ä»¬å…ˆæ˜¯å…ˆè®²ä¸€ä¸‹å®ƒçš„æ¦‚å¿µä¸åŸç†å®ç°ï¼Œç„¶ååœ¨è®²Springä¸­AOPçš„å®ç°ã€‚ AOPAOPæ€æƒ³AOPï¼ˆAspect Oriented Programmingçš„ç¼©å†™ï¼Œæ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ˜¯å¯¹OOPçš„ä¸€ç§è¡¥å……ã€‚ é¢å‘å¯¹è±¡(OOP)å¼•å…¥äº†ç»§æ‰¿ã€å¤šæ€ã€å°è£…ï¼Œå°†ç³»ç»Ÿçš„ä¸šåŠ¡åŠŸèƒ½æŒ‰ç…§æ¨¡å—åˆ’åˆ†ï¼Œæ¯ä¸ªæ¨¡å—ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç±»æ¥è¡¨ç¤ºã€‚è€Œå¯¹äºä¸€äº›ç³»ç»ŸåŠŸèƒ½ï¼Œæ— æ³•ä½¿ç”¨OOPçš„æ€æƒ³æ¥å®ç°å®ƒä»¬ã€‚è¿™äº›ç³»ç»ŸåŠŸèƒ½å¾€å¾€ç©¿æ’åœ¨ä¸šåŠ¡åŠŸèƒ½çš„å„å¤„ï¼Œå’Œä¸šåŠ¡ä»£ç è€¦åˆåœ¨ä¸€èµ·ï¼›è€Œä¸”ç³»ç»ŸåŠŸèƒ½å¾€å¾€ä¼šè¢«é‡å¤ä½¿ç”¨ï¼Œè¿™å°±å¯¼è‡´äº†æ¨¡å—ä¸åˆ©äºå¤ç”¨ï¼Œè¿™å°±æ˜¯ä½¿ç”¨OOPå®ç°ç³»ç»ŸåŠŸèƒ½çš„å¼Šç«¯ã€‚ AOPå³ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå®ƒæŠŠç³»ç»Ÿéœ€æ±‚æŒ‰ç…§åŠŸèƒ½åˆ†é—¨å½’ç±»ï¼ŒæŠŠå®ƒä»¬å°è£…åœ¨ä¸€ä¸ªä¸ªåˆ‡é¢ä¸­ï¼Œç„¶åå†æŒ‡å®šè¿™äº›ç³»ç»ŸåŠŸèƒ½å¾€ä¸šåŠ¡åŠŸèƒ½ï¼Œä¸»è¦åº”ç”¨äºæƒé™è®¤è¯ã€æ—¥å¿—ï¼Œäº‹åŠ¡ç­‰ã€‚ å®ƒçš„ä¸»è¦æ˜¯å¥½å¤„å¦‚ä¸‹ï¼š é™ä½æ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦ ä½¿ç³»ç»Ÿå®¹æ˜“æ‰©å±• æ›´å¥½çš„ä»£ç å¤ç”¨ã€‚ AOPå®ç°åŸç†å®ç°AOPçš„æŠ€æœ¯ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼šä¸€æ˜¯é‡‡ç”¨åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œåˆ©ç”¨æˆªå–æ¶ˆæ¯çš„æ–¹å¼ï¼Œå¯¹è¯¥æ¶ˆæ¯è¿›è¡Œè£…é¥°ï¼Œä»¥å–ä»£åŸæœ‰å¯¹è±¡è¡Œä¸ºçš„æ‰§è¡Œï¼›äºŒæ˜¯é‡‡ç”¨é™æ€ç»‡å…¥çš„æ–¹å¼ï¼Œå¼•å…¥ç‰¹å®šçš„è¯­æ³•åˆ›å»ºâ€œæ–¹é¢â€ï¼Œä»è€Œä½¿å¾—ç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘æœŸé—´ç»‡å…¥æœ‰å…³â€œæ–¹é¢â€çš„ä»£ç ã€‚è€ŒSpringé‡‡ç”¨çš„æ˜¯åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œå…³äºåŠ¨æ€ä»£ç†çš„å®ç°å¯ä»¥å‚ç…§è‡ªå·±ä¹‹å‰çš„åšå®¢ è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”ä»£ç†æ¨¡å¼ä¸€æ–‡ä¸­çš„åŠ¨æ€ä»£ç†è¿™ä¸€èŠ‚å»äº†è§£ã€‚ SpringAOPå®ç°Springçš„AOPå®ç°éµå®ˆAOPè”ç›Ÿçš„çº¦å®šã€‚åŒæ—¶Springåˆæ‰©å±•äº†å®ƒï¼Œå¢åŠ äº†Pointcutã€Advisorç­‰ä¸€äº›æ¥å£ä½¿å¾—å…¶æ›´åŠ çµæ´»ã€‚ Spring AOPçš„åŸºæœ¬æ¦‚å¿µ åˆ‡é¢ï¼ˆAspectï¼‰ï¼šç±»ä¼¼äºOOPä¸­çš„Classï¼Œä¸€ä¸ªAspectå­˜æ”¾ä¸€ä¸ªç³»ç»ŸåŠŸèƒ½çš„æ‰€æœ‰é€»è¾‘ã€‚åˆ‡é¢ç”¨Springçš„ Advisoræˆ–æ‹¦æˆªå™¨å®ç°ã€‚ è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€äº‹ä»¶ï¼Œå¦‚æ–¹æ³•è¢«è°ƒç”¨æ—¶ã€æŠ›å‡ºå¼‚å¸¸æ—¶ã€‚ åˆ‡å…¥ç‚¹ï¼ˆPointcutï¼‰ï¼šæŒ‡å®šä¸€ä¸ªé€šçŸ¥å°†è¢«å¼•å‘çš„ä¸€ç³»åˆ—è¿æ¥ç‚¹çš„é›†åˆã€‚AOPæ¡†æ¶å¿…é¡»å…è®¸å¼€å‘è€…æŒ‡å®šåˆ‡å…¥ç‚¹ï¼šä¾‹å¦‚ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚ Springå®šä¹‰äº†Pointcutæ¥å£ï¼Œç”¨æ¥ç»„åˆMethodMatcherå’ŒClassFilterï¼Œå¯ä»¥é€šè¿‡åå­—å¾ˆæ¸…æ¥šçš„ç†è§£ï¼Œ MethodMatcheræ˜¯ç”¨æ¥æ£€æŸ¥ç›®æ ‡ç±»çš„æ–¹æ³•æ˜¯å¦å¯ä»¥è¢«åº”ç”¨æ­¤é€šçŸ¥ï¼Œè€ŒClassFilteræ˜¯ç”¨æ¥æ£€æŸ¥Pointcutæ˜¯å¦åº”è¯¥åº”ç”¨åˆ°ç›®æ ‡ç±»ä¸Šã€‚ å¼•å…¥ï¼ˆIntroductionï¼‰: æ·»åŠ æ–¹æ³•æˆ–å­—æ®µåˆ°è¢«é€šçŸ¥çš„ç±»ã€‚ Springå…è®¸å¼•å…¥æ–°çš„æ¥å£åˆ°ä»»ä½•è¢«é€šçŸ¥çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¼•å…¥ä½¿ä»»ä½•å¯¹è±¡å®ç° IsModifiedæ¥å£ï¼Œæ¥ç®€åŒ–ç¼“å­˜ã€‚Springä¸­è¦ä½¿ç”¨Introduction, å¯æœ‰é€šè¿‡DelegatingIntroductionInterceptoræ¥å®ç°é€šçŸ¥ï¼Œé€šè¿‡DefaultIntroductionAdvisoræ¥é…ç½®Adviceå’Œä»£ç†ç±»è¦å®ç°çš„æ¥å£ã€‚ ç›®æ ‡å¯¹è±¡ï¼ˆTarget Objectï¼‰: åŒ…å«è¿æ¥ç‚¹çš„å¯¹è±¡ã€‚ä¹Ÿè¢«ç§°ä½œè¢«é€šçŸ¥æˆ–è¢«ä»£ç†å¯¹è±¡ï¼ˆPOJOï¼‰ã€‚ AOPä»£ç†ï¼ˆAOP Proxyï¼‰: AOPæ¡†æ¶åˆ›å»ºçš„å¯¹è±¡ï¼ŒåŒ…å«é€šçŸ¥ã€‚ åœ¨Springä¸­ï¼ŒAOPä»£ç†å¯ä»¥æ˜¯JDKåŠ¨æ€ä»£ç†æˆ–è€…CGLIBä»£ç†ã€‚ ç»‡å…¥ï¼ˆWeavingï¼‰: ç»„è£…æ–¹é¢æ¥åˆ›å»ºä¸€ä¸ªè¢«é€šçŸ¥å¯¹è±¡ã€‚è¿™å¯ä»¥åœ¨ç¼–è¯‘æ—¶å®Œæˆï¼ˆä¾‹å¦‚ä½¿ç”¨AspectJç¼–è¯‘å™¨ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶å®Œæˆã€‚Springå’Œå…¶ä»–çº¯Java AOPæ¡†æ¶ä¸€æ ·ï¼Œåœ¨è¿è¡Œæ—¶å®Œæˆç»‡å…¥ã€‚ é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šå…·ä½“çš„æ¨ªåˆ‡é€»è¾‘ï¼›Springä¸­æœ‰äº”ç§Adviceï¼š å‰ç½®é€šçŸ¥ï¼ˆBefore Adviceï¼‰ åç½®é€šçŸ¥ï¼ˆAfter Adviceï¼‰ è¿”å›é€šçŸ¥ï¼ˆAfter Return Adviceï¼‰ ç¯ç»•é€šçŸ¥ï¼ˆAround Adviceï¼‰ æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ï¼ˆAfter Throwing Adviceï¼‰ SpringAOPåŠ¨æ€ä»£ç†Spring AOPä¸­ä½¿ç”¨äº†ä¸¤ç§åŠ¨æ€ä»£ç†ï¼Œä¸€ç§æ˜¯JDKçš„åŠ¨æ€ä»£ç†ï¼Œä¸€ç§CGLIBçš„åŠ¨æ€ä»£ç†ã€‚JDKçš„åŠ¨æ€ä»£ç†å¿…é¡»æŒ‡å®šæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å·²ç»è¢«ä»£ç†å¯¹è±¡å®ç°äº†çš„ï¼›è€ŒCGLIBä»£ç†åˆ™ä¸éœ€è¦æŒ‡å®šæ¥å£ã€‚ JDKåŠ¨æ€ä»£ç†å¦‚æœè¢«ä»£ç†å¯¹è±¡å®ç°äº†éœ€è¦è¢«ä»£ç†çš„æ¥å£ï¼Œåˆ™ä½¿ç”¨JDKçš„åŠ¨æ€ä»£ç†ã€‚æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥çœ‹è¿™ä¸ªè¿‡ç¨‹ï¼š é¦–å…ˆæ˜ç¡®æˆ‘ä»¬ä½¿è¦ç”Ÿæˆä¸€ä¸ªä»£ç†ï¼Œè€ŒSpringçš„å†…éƒ¨æœºåˆ¶æ˜¯ç”±FactoryBeançš„getObjectæ–¹æ³•æ¥äº§ç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä¸€æ­¥æ­¥debugåˆ°è¿™ä¸ªæ–¹æ³•è¡Œï¼ˆåœ¨FactoryBeanRegistrySupportç±»çš„doGetObjectFromFactoryBeanä¸­ï¼‰ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæ–¹æ³•çš„æºä»£ç ï¼š 123456789101112131415public Object getObject() throws BeansException &#123; // åˆå§‹åŒ–é€šçŸ¥å™¨é“¾ï¼Œä¸ºä»£ç†å¯¹è±¡é…ç½®é€šçŸ¥å™¨é“¾ã€‚ this.initializeAdvisorChain(); //åŒºåˆ†SingleTonå’ŒProtoTypeï¼Œç”Ÿæˆå¯¹åº”çš„Proxy if(this.isSingleton()) &#123; // åªæœ‰SingleTonçš„Beanæ‰ä¼šä¸€å¼€å§‹å°±åˆå§‹åŒ–ï¼ŒProtoTypeçš„åªæœ‰åœ¨è¯·æ±‚çš„æ—¶å€™æ‰ä¼šåˆå§‹åŒ–ï¼Œä»£ç†ä¹Ÿä¸€æ · return this.getSingletonInstance(); &#125; else &#123; if(this.targetName == null) &#123; this.logger.warn("Using non-singleton proxies with singleton targets is often undesirable. Enable prototype proxies by setting the 'targetName' property."); &#125; return this.newPrototypeInstance(); &#125;&#125; åˆ°è¾¾getObjectæ–¹æ³•åï¼Œæˆ‘ä»¬éœ€è¦å»çœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆåˆå§‹åŒ–é€šçŸ¥é“¾çš„å°±æ˜¯initializeAdvisorChainçš„ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243 private synchronized void initializeAdvisorChain() throws AopConfigException, BeansException &#123; // åˆå§‹åŒ–è¿‡ç¨‹çš„æ ‡å¿—ä½advisorChainInitializedï¼Œè¿™ä¸ªæ ‡å¿—ç”¨æ¥è¡¨ç¤ºé€šçŸ¥å™¨é“¾æ˜¯å¦å·²ç»åˆå§‹åŒ–ã€‚ if(!this.advisorChainInitialized) &#123; if(!ObjectUtils.isEmpty(this.interceptorNames)) &#123; if(this.beanFactory == null) &#123; throw new IllegalStateException("No BeanFactory available anymore (probably due to serialization) - cannot resolve interceptor names " + Arrays.asList(this.interceptorNames)); &#125; if(this.interceptorNames[this.interceptorNames.length - 1].endsWith("*") &amp;&amp; this.targetName == null &amp;&amp; this.targetSource == EMPTY_TARGET_SOURCE) &#123; throw new AopConfigException("Target required after globals"); &#125; String[] var1 = this.interceptorNames; int var2 = var1.length; for(int var3 = 0; var3 &lt; var2; ++var3) &#123; String name = var1[var3]; if(this.logger.isTraceEnabled()) &#123; this.logger.trace("Configuring advisor or advice '" + name + "'"); &#125; if(name.endsWith("*")) &#123; if(!(this.beanFactory instanceof ListableBeanFactory)) &#123; throw new AopConfigException("Can only use global advisors or interceptors with a ListableBeanFactory"); &#125; this.addGlobalAdvisor((ListableBeanFactory)this.beanFactory, name.substring(0, name.length() - "*".length())); &#125; else &#123; Object advice; if(!this.singleton &amp;&amp; !this.beanFactory.isSingleton(name)) &#123; advice = new ProxyFactoryBean.PrototypePlaceholderAdvisor(name); &#125; else &#123; advice = this.beanFactory.getBean(name); &#125; this.addAdvisorOnChainCreation(advice, name); &#125; &#125; &#125; this.advisorChainInitialized = true; &#125;&#125; åˆå§‹åŒ–åªæ˜¯åœ¨åº”ç”¨ç¬¬ä¸€æ¬¡é€šè¿‡ProxyFactoryBeanè·å–ä»£ç†å¯¹è±¡çš„æ—¶å€™ã€‚å®Œæˆè¿™ä¸ªåˆå§‹åŒ–ä¹‹åï¼Œæ¥ç€ä¼šè¯»å–é…ç½®ä¸­å‡ºç°çš„æ‰€æœ‰é€šçŸ¥å™¨ï¼ˆæŠŠé€šçŸ¥å™¨çš„åå­—äº¤ç»™å®¹å™¨çš„getBeanï¼ŒIOCå®¹å™¨çš„å›è°ƒè·å–é€šçŸ¥å™¨ï¼‰ï¼ŒæŠŠé€šçŸ¥å™¨åŠ å…¥æ‹¦æˆªå™¨é“¾ï¼ˆaddAdvisoronChainCreationå®ç°ï¼‰ã€‚ ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œåˆ©ç”¨ProxyFactoryBeançš„getSingletonInstanceæ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021 private synchronized Object getSingletonInstance() &#123; if(this.singletonInstance == null) &#123; //è¿™é‡Œä¼šè°ƒç”¨getBeanï¼Œè·å–è¢«ä»£ç†å¯¹è±¡ this.targetSource = this.freshTargetSource(); if(this.autodetectInterfaces &amp;&amp; this.getProxiedInterfaces().length == 0 &amp;&amp; !this.isProxyTargetClass()) &#123; // æ ¹æ® AOP æ¡†æ¶åˆ¤æ–­éœ€è¦ä»£ç†çš„æ¥å£ Class&lt;?&gt; targetClass = this.getTargetClass(); if(targetClass == null) &#123; throw new FactoryBeanNotInitializedException("Cannot determine target class for proxy"); &#125; //è¿™é‡Œæ˜¯è®¾ç½®ä»£ç†å¯¹è±¡çš„æ¥å£ this.setInterfaces(ClassUtils.getAllInterfacesForClass(targetClass, this.proxyClassLoader)); &#125; super.setFrozen(this.freezeProxy); //è¿™é‡Œæ–¹æ³•ä¼šä½¿ç”¨ProxyFactoryç”Ÿæˆéœ€è¦çš„Proxy this.singletonInstance = this.getProxy(this.createAopProxy()); &#125; return this.singletonInstance;&#125; è¿›å…¥ProxyCreatorSupportçš„createAopProxyï¼Œæºç å¦‚ä¸‹ï¼š 1234567 protected final synchronized AopProxy createAopProxy() &#123;if (!this.active) &#123; activate();&#125;//é€šè¿‡AopProxyFactoryå–å¾—AopProxyï¼ŒAopProxyFactoryæ˜¯åœ¨åˆå§‹åŒ–å‡½æ•°ä¸­å®šä¹‰çš„ï¼Œä½¿ç”¨çš„æ˜¯DefaultAopProxyFactoryreturn getAopProxyFactory().createAopProxy(this);&#125; é‚£ä¹ˆDefaultAopProxyFactoryå¦‚ä½•ç”ŸæˆAopProxyäº†ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ï¼ŒJdkDynamicAopProxyå’ŒCglibProxyFactory,DefaultAopProxyFactoryçš„createAopProxyçš„æºç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223 public class DefaultAopProxyFactory implements AopProxyFactory, Serializable &#123; @Override public AopProxy createAopProxy(AdvisedSupport config) throws AopConfigException &#123; if (config.isOptimize() || config.isProxyTargetClass() || hasNoUserSuppliedProxyInterfaces(config)) &#123; //è·å–é…ç½®çš„ç›®æ ‡å¯¹è±¡ Class&lt;?&gt; targetClass = config.getTargetClass(); if (targetClass == null) &#123; //å¦‚æœæ²¡æœ‰ç›®æ ‡å¯¹è±¡ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œæé†’AOPåº”ç”¨æä¾›æ­£ç¡®çš„ç›®æ ‡é…ç½® throw new AopConfigException("TargetSource cannot determine target class: " + "Either an interface or a target is required for proxy creation."); &#125; // è¿™ä¸ªåˆ¤æ–­å¾ˆé‡è¦ï¼Œé€šè¿‡ç›®æ ‡ç±»æ˜¯å¦æ˜¯æ¥å£æ¥å†³å®šé‡‡ç”¨ä»€ä¹ˆä»£ç†æ–¹å¼ if (targetClass.isInterface() || Proxy.isProxyClass(targetClass)) &#123; return new JdkDynamicAopProxy(config); &#125; //ç”±äºCGLIBæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹ç±»åº“ï¼Œæ‰€ä»¥éœ€è¦åœ¨CLASSPATHä¸­é…ç½® return new ObjenesisCglibAopProxy(config); &#125; else &#123; return new JdkDynamicAopProxy(config); &#125; &#125;&#125; ç”±äºæˆ‘ä»¬è¿™é‡Œç›®æ ‡ç±»æ˜¯æ¥å£ï¼Œæ‰€ä»¥é‡‡ç”¨JdkDynamicAopProxy ç”ŸæˆAopProxyä»£ç†å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹JdkDynamicAopProxyçš„invokeæ–¹æ³•æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; Object oldProxy = null; boolean setProxyContext = false; TargetSource targetSource = this.advised.targetSource; Class&lt;?&gt; targetClass = null; Object target = null; Object var13; try &#123; if(!this.equalsDefined &amp;&amp; AopUtils.isEqualsMethod(method)) &#123; Boolean var20 = Boolean.valueOf(this.equals(args[0])); return var20; &#125; if(!this.hashCodeDefined &amp;&amp; AopUtils.isHashCodeMethod(method)) &#123; Integer var18 = Integer.valueOf(this.hashCode()); return var18; &#125; if(method.getDeclaringClass() == DecoratingProxy.class) &#123; Class var17 = AopProxyUtils.ultimateTargetClass(this.advised); return var17; &#125; Object retVal; // Advisedæ¥å£æˆ–è€…å…¶çˆ¶æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•,ç›´æ¥åå°„è°ƒç”¨,ä¸åº”ç”¨é€šçŸ¥ if(!this.advised.opaque &amp;&amp; method.getDeclaringClass().isInterface() &amp;&amp; method.getDeclaringClass().isAssignableFrom(Advised.class)) &#123; retVal = AopUtils.invokeJoinpointUsingReflection(this.advised, method, args); return retVal; &#125; if(this.advised.exposeProxy) &#123; oldProxy = AopContext.setCurrentProxy(proxy); setProxyContext = true; &#125; //è·å¾—ç›®æ ‡å¯¹è±¡çš„ç±» target = targetSource.getTarget(); if(target != null) &#123; targetClass = target.getClass(); &#125; // è·å¾—æ‹¦æˆªé“¾ List&lt;Object&gt; chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass); // å¦‚æœæ²¡æœ‰å¯ä»¥åº”ç”¨åˆ°æ­¤æ–¹æ³•çš„é€šçŸ¥(Interceptor)ï¼Œæ­¤ç›´æ¥åå°„è°ƒç”¨ method.invoke(target, args) if(chain.isEmpty()) &#123; Object[] argsToUse = AopProxyUtils.adaptArgumentsIfNecessary(method, args); retVal = AopUtils.invokeJoinpointUsingReflection(target, method, argsToUse); &#125; else &#123; //åˆ›å»ºMethodInvocation MethodInvocation invocation = new ReflectiveMethodInvocation(proxy, target, method, args, targetClass, chain); // å¤„ç†é€šçŸ¥ retVal = invocation.proceed(); &#125; Class&lt;?&gt; returnType = method.getReturnType(); if(retVal != null &amp;&amp; retVal == target &amp;&amp; returnType != Object.class &amp;&amp; returnType.isInstance(proxy) &amp;&amp; !RawTargetAccess.class.isAssignableFrom(method.getDeclaringClass())) &#123; retVal = proxy; &#125; else if(retVal == null &amp;&amp; returnType != Void.TYPE &amp;&amp; returnType.isPrimitive()) &#123; throw new AopInvocationException("Null return value from advice does not match primitive return type for: " + method); &#125; var13 = retVal; &#125; finally &#123; if(target != null &amp;&amp; !targetSource.isStatic()) &#123; targetSource.releaseTarget(target); &#125; if(setProxyContext) &#123; AopContext.setCurrentProxy(oldProxy); &#125; &#125; return var13; &#125; CGLIBåŠ¨æ€ä»£ç†å¦‚æœè¢«ä»£ç†å¯¹è±¡æ²¡æœ‰å®ç°éœ€è¦è¢«ä»£ç†çš„æ¥å£ï¼Œåˆ™ä½¿ç”¨CGLIBåŠ¨æ€ä»£ç†ï¼ŒCGLIBåŠ¨æ€ä»£ç†æŒ‰ç…§å‰é¢çš„åˆ†æåŸºæœ¬ä¸JDKåŠ¨æ€ä»£ç†ä¸€æ ·ï¼Œç”±äºåœ¨Spring AOPä¸­å¯¹åº”çš„åŒ…è£…ç±»ä¸ºCglibAopProxyï¼ŒCglibAopProxyçš„interceptå›è°ƒæ–¹æ³•çš„å®ç°å’ŒJdkDynamicAopProxyçš„å›è°ƒå®ç°æ˜¯éå¸¸ç±»ä¼¼çš„ï¼Œåªæ˜¯åœ¨CglibAopProxyä¸­æ„é€ çš„æ˜¯CglibMethodInvocationå¯¹è±¡æ¥å®Œæˆæ‹¦æˆªå™¨é“¾çš„è°ƒç”¨ï¼Œè¿™é‡Œçœ‹ä¸€ä¸‹ä¸invokeç±»ä¼¼çš„getCallbacksæºç ï¼š1234567891011121314151617181920212223242526272829303132333435363738private Callback[] getCallbacks(Class&lt;?&gt; rootClass) throws Exception &#123; boolean exposeProxy = this.advised.isExposeProxy(); boolean isFrozen = this.advised.isFrozen(); boolean isStatic = this.advised.getTargetSource().isStatic(); Callback aopInterceptor = new CglibAopProxy.DynamicAdvisedInterceptor(this.advised); Object targetInterceptor; if(exposeProxy) &#123; targetInterceptor = isStatic?new CglibAopProxy.StaticUnadvisedExposedInterceptor(this.advised.getTargetSource().getTarget()):new CglibAopProxy.DynamicUnadvisedExposedInterceptor(this.advised.getTargetSource()); &#125; else &#123; targetInterceptor = isStatic?new CglibAopProxy.StaticUnadvisedInterceptor(this.advised.getTargetSource().getTarget()):new CglibAopProxy.DynamicUnadvisedInterceptor(this.advised.getTargetSource()); &#125; Callback targetDispatcher = (Callback)(isStatic?new CglibAopProxy.StaticDispatcher(this.advised.getTargetSource().getTarget()):new CglibAopProxy.SerializableNoOp()); Callback[] mainCallbacks = new Callback[]&#123;aopInterceptor, (Callback)targetInterceptor, new CglibAopProxy.SerializableNoOp(), targetDispatcher, this.advisedDispatcher, new CglibAopProxy.EqualsInterceptor(this.advised), new CglibAopProxy.HashCodeInterceptor(this.advised)&#125;; Callback[] callbacks; if(isStatic &amp;&amp; isFrozen) &#123; Method[] methods = rootClass.getMethods(); Callback[] fixedCallbacks = new Callback[methods.length]; this.fixedInterceptorMap = new HashMap(methods.length); for(int x = 0; x &lt; methods.length; ++x) &#123; // è·å¾—æ‹¦æˆªé“¾ List&lt;Object&gt; chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(methods[x], rootClass); // å‡†å¤‡å¤„ç†é€šçŸ¥ fixedCallbacks[x] = new CglibAopProxy.FixedChainStaticTargetInterceptor(chain, this.advised.getTargetSource().getTarget(), this.advised.getTargetClass()); this.fixedInterceptorMap.put(methods[x].toString(), Integer.valueOf(x)); &#125; callbacks = new Callback[mainCallbacks.length + fixedCallbacks.length]; System.arraycopy(mainCallbacks, 0, callbacks, 0, mainCallbacks.length); System.arraycopy(fixedCallbacks, 0, callbacks, mainCallbacks.length, fixedCallbacks.length); this.fixedInterceptorOffset = mainCallbacks.length; &#125; else &#123; callbacks = mainCallbacks; &#125; return callbacks;&#125; å‚è€ƒ æ·±å…¥å‰–æSpring(å››)â€”â€”AOP Spring AOPæºç åˆ†æï¼ˆç”Ÿæˆä»£ç†å¯¹è±¡ï¼‰ Spring AOPå››ç§å®ç°æ–¹å¼Demoè¯¦è§£ä¸ç›¸å…³çŸ¥è¯†æ¢ç©¶]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜Spring(äºŒ)_Springä¹‹IOC]]></title>
    <url>%2F2018%2F04%2F11%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98Spring(%E4%BA%8C)_Spring%E4%B9%8BIOC%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå‰ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†Springçš„æ•´ä½“æ¶æ„ä»¥åŠæ ¸å¿ƒç»„ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è®²è§£Springçš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€IOCï¼Œæˆ‘ä»¬å°†å…ˆç®€å•ä»‹ç»IOCä¸DIï¼Œç„¶åå†æ·±å…¥SpringIOCå®¹å™¨çš„å·¥ä½œæµç¨‹ã€‚ IOCä¸DIIoCå’ŒDIæ˜¯Springçš„ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå¾ˆå¤šäººéƒ½æŠŠå®ƒä»¬è§†ä¸ºç›¸åŒçš„ä¸œè¥¿ï¼ˆä¹‹å‰è‡ªå·±ä¹Ÿä¸€ç›´è¿™æ ·è®¤ä¸ºï¼‰ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚ IoC(Inversion of Control)ï¼šæ§åˆ¶åè½¬ã€‚ DI(Dependency Injection)ï¼šä¾èµ–æ³¨å…¥ å¼€å§‹ç”»é‡ç‚¹äº†ï¼š æ§åˆ¶åè½¬æ˜¯ç›®çš„ï¼Œä¾èµ–æ³¨å…¥æ˜¯å®ç°æ§åˆ¶åè½¬çš„æ‰‹æ®µã€‚ æ§åˆ¶åè½¬æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼æ€æƒ³ï¼Œå®ƒæ˜¯ä¸€ç§å®½æ³›çš„æ¦‚å¿µï¼Œåªè¦ä¸€ä¸ªç±»å°†å¯¹å®ƒå†…éƒ¨çŠ¶æ€çš„æ§åˆ¶æƒäº¤ç”±å…¶ä»–æœºåˆ¶å»å®Œæˆå³ä¸ºæ§åˆ¶åè½¬ã€‚æ§åˆ¶åè½¬æ˜¯ä¸ºäº†é™ä½ç±»ä¸ç±»ä¹‹é—´çš„è€¦åˆåº¦ã€‚è€ŒSpringé‡‡ç”¨ä¾èµ–æ³¨å…¥è¿™ä¸€å…·ä½“çš„æ‰‹æ®µæ¥è¾¾åˆ°æ§åˆ¶åè½¬çš„ç›®çš„ã€‚ å…³äºä¾èµ–æ³¨å…¥å¯ä»¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« å…ˆå¹å“å£å·_6å¤§è®¾è®¡åŸåˆ™ä¸­çš„ä¾èµ–å€’ç½®åŸåˆ™ DIPä¸€èŠ‚ï¼Œè¿™é‡Œå°±ä¸åšè¿‡å¤šçš„ä»‹ç»äº†ã€‚ IOCå®¹å™¨å·¥ä½œæµç¨‹IOCå®¹å™¨å®é™…ä¸Šå°±æ˜¯ Context ç»„ä»¶ç»“åˆå…¶ä»–Beanå’ŒCoreç»„ä»¶å…±åŒæ„å»ºäº†ä¸€ä¸ª Bean å…³ç³»ç½‘ï¼Œå¦‚ä½•æ„å»ºè¿™ä¸ªå…³ç³»ç½‘ï¼Ÿæ„å»ºçš„å…¥å£å°±åœ¨ AbstractApplicationContext ç±»çš„ refresh æ–¹æ³•ä¸­ã€‚è¿™ä¸ªæ–¹æ³•çš„ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243public void refresh() throws BeansException, IllegalStateException &#123; Object var1 = this.startupShutdownMonitor; synchronized(this.startupShutdownMonitor) &#123; // ä¸ºåˆ·æ–°å‡†å¤‡æ–°çš„context this.prepareRefresh(); // **åˆ›å»ºBeanFactory** ConfigurableListableBeanFactory beanFactory = this.obtainFreshBeanFactory(); // åˆ·æ–°æ‰€æœ‰BeanFactoryå­å®¹å™¨ this.prepareBeanFactory(beanFactory); try &#123; // æ³¨å†Œå®ç°äº†BeanPostProcessoræ¥å£çš„beanï¼ˆAOPä½¿ç”¨ï¼‰ this.postProcessBeanFactory(beanFactory); // åˆå§‹åŒ–å’Œæ‰§è¡ŒBeanFactoryPostProcessor beans this.invokeBeanFactoryPostProcessors(beanFactory); // åˆå§‹åŒ–å’Œæ‰§è¡ŒBeanPostProcessors beans this.registerBeanPostProcessors(beanFactory); // åˆå§‹åŒ–MessageSource this.initMessageSource(); // åˆå§‹åŒ– event multicaster ï¼ˆå¤šè·¯å¹¿æ’­ï¼‰ this.initApplicationEventMulticaster(); // åˆ·æ–°ç”±å­ç±»å®ç°çš„æ–¹æ³• this.onRefresh(); // æ³¨å†Œäº‹ä»¶ this.registerListeners(); // åˆå§‹åŒ–å•ä¾‹Bean this.finishBeanFactoryInitialization(beanFactory); // å‘å¸ƒç›¸åº”çš„äº‹ä»¶ this.finishRefresh(); &#125; catch (BeansException var9) &#123; if(this.logger.isWarnEnabled()) &#123; this.logger.warn("Exception encountered during context initialization - cancelling refresh attempt: " + var9); &#125; // é”€æ¯beans this.destroyBeans(); this.cancelRefresh(var9); throw var9; &#125; finally &#123; this.resetCommonCaches(); &#125; &#125; &#125; è¿™ä¸ªæ–¹æ³•å°±æ˜¯æ„å»ºæ•´ä¸ªIOCå®¹å™¨è¿‡ç¨‹çš„å®Œæ•´çš„ä»£ç ï¼Œäº†è§£äº†é‡Œé¢çš„æ¯ä¸€è¡Œä»£ç åŸºæœ¬ä¸Šå°±äº†è§£å¤§éƒ¨åˆ† Spring çš„åŸç†å’ŒåŠŸèƒ½äº†ã€‚ è¿™æ®µä»£ç ä¸»è¦åŒ…å«è¿™æ ·å‡ ä¸ªæ­¥éª¤ï¼š æ„å»º BeanFactory æ³¨å†Œå¯èƒ½æ„Ÿå…´è¶£çš„äº‹ä»¶ åˆ›å»º Bean å®ä¾‹å¯¹è±¡ è§¦å‘è¢«ç›‘å¬çš„äº‹ä»¶ å…¶ä¸­æˆ‘ä»¬æˆ‘ä»¬æœ€å…³å¿ƒçš„å°±æ˜¯BeanFactoryå’Œåˆ›å»ºBeanå®ä¾‹å¯¹è±¡äº†ï¼Œæˆ‘ä»¬ä¸‹é¢å¯ä»¥å¥½å¥½çœ‹çœ‹ï¼š åˆ›å»ºBeanFactoryå·¥å‚æˆ‘ä»¬åˆ©ç”¨debugå¯ä»¥è¿›å…¥åˆ°refresh()æ–¹æ³•é‡Œé¢çš„obtainFreshBeanFactory()æ–¹æ³•é‡Œé¢çš„refreshBeanFactory() ï¼ˆæœ‰ç‚¹ç»•ï¼Œä½†æ˜¯è‡ªå·±å°±ä¸ç”»æ—¶åºå›¾äº†ï¼‰ å»çœ‹çœ‹ä»–çš„åˆ›å»ºä»£ç ï¼š123456789101112131415161718192021protected final void refreshBeanFactory() throws BeansException &#123; if(this.hasBeanFactory()) &#123; this.destroyBeans(); this.closeBeanFactory(); &#125; try &#123; // åˆ›å»ºä¸€ä¸ªDefaultListableBeanFactoryï¼ˆä¸Šä¸€èŠ‚è¯´è¿‡çš„å¾ˆé‡è¦çš„ç±»ï¼‰ DefaultListableBeanFactory beanFactory = this.createBeanFactory(); beanFactory.setSerializationId(this.getId()); this.customizeBeanFactory(beanFactory); // **è¿™ä¸ªæ–¹æ³•ä¼šåŠ è½½ã€è§£æBeançš„å®šä¹‰** this.loadBeanDefinitions(beanFactory); Object var2 = this.beanFactoryMonitor; synchronized(this.beanFactoryMonitor) &#123; this.beanFactory = beanFactory; &#125; &#125; catch (IOException var5) &#123; throw new ApplicationContextException("I/O error parsing bean definition source for " + this.getDisplayName(), var5); &#125; &#125; åˆ›å»ºBeanå®ä¾‹å¹¶æ„å»ºBeançš„å…³ç³»ç½‘æˆ‘ä»¬åˆ©ç”¨debugå¯ä»¥è¿›å…¥åˆ°refresh()æ–¹æ³•é‡Œé¢çš„finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory)æ–¹æ³•é‡Œé¢çš„preInstantiateSingletons() ï¼ˆæœ‰ç‚¹ç»•ï¼Œä½†æ˜¯è‡ªå·±å°±ä¸ç”»æ—¶åºå›¾äº†ï¼‰ å»çœ‹çœ‹å®ƒçš„åˆ›å»ºBeançš„ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172public void preInstantiateSingletons() throws BeansException &#123; if(this.logger.isDebugEnabled()) &#123; this.logger.debug("Pre-instantiating singletons in " + this); &#125; List&lt;String&gt; beanNames = new ArrayList(this.beanDefinitionNames); Iterator var2 = beanNames.iterator(); while(true) &#123; while(true) &#123; String beanName; RootBeanDefinition bd; do &#123; do &#123; do &#123; if(!var2.hasNext()) &#123; var2 = beanNames.iterator(); while(var2.hasNext()) &#123; beanName = (String)var2.next(); Object singletonInstance = this.getSingleton(beanName); if(singletonInstance instanceof SmartInitializingSingleton) &#123; final SmartInitializingSingleton smartSingleton = (SmartInitializingSingleton)singletonInstance; if(System.getSecurityManager() != null) &#123; AccessController.doPrivileged(new PrivilegedAction&lt;Object&gt;() &#123; public Object run() &#123; smartSingleton.afterSingletonsInstantiated(); return null; &#125; &#125;, this.getAccessControlContext()); &#125; else &#123; smartSingleton.afterSingletonsInstantiated(); &#125; &#125; &#125; return; &#125; beanName = (String)var2.next(); bd = this.getMergedLocalBeanDefinition(beanName); &#125; while(bd.isAbstract()); &#125; while(!bd.isSingleton()); &#125; while(bd.isLazyInit()); if(this.isFactoryBean(beanName)) &#123; // è¿™ä¸ªBeanå¾ˆé‡è¦ï¼ŒSpringæœ‰ä¸€å¤§åŠæ‰©å±•åŠŸèƒ½éƒ½ä¸è¿™ä¸ªBeanæœ‰å…³ç³»ï¼Œ // å®ƒæ˜¯ä¸ªå·¥å‚Beanï¼Œå¯ä»¥äº§ç”ŸBeanå®ä¾‹çš„Beanï¼Œ // Springè·å–FactoryBeanæœ¬èº«çš„å¯¹è±¡æ˜¯é€šè¿‡åœ¨å‰é¢åŠ ä¸Š&amp;æ¥å®Œæˆçš„ final FactoryBean&lt;?&gt; factory = (FactoryBean)this.getBean("&amp;" + beanName); boolean isEagerInit; if(System.getSecurityManager() != null &amp;&amp; factory instanceof SmartFactoryBean) &#123; isEagerInit = ((Boolean)AccessController.doPrivileged(new PrivilegedAction&lt;Boolean&gt;() &#123; public Boolean run() &#123; return Boolean.valueOf(((SmartFactoryBean)factory).isEagerInit()); &#125; &#125;, this.getAccessControlContext())).booleanValue(); &#125; else &#123; isEagerInit = factory instanceof SmartFactoryBean &amp;&amp; ((SmartFactoryBean)factory).isEagerInit(); &#125; if(isEagerInit) &#123; // æ™®é€šçš„Beanåªè¦é€šè¿‡getBeanæ–¹æ³•ç›´æ¥åˆ›å»ºå®ƒçš„å®ä¾‹ // getBeanæ–¹æ³•é‡Œé¢åŒ…å«äº†ä»–ä»¬å…³ç³»çš„åˆ›å»º this.getBean(beanName); &#125; &#125; else &#123; this.getBean(beanName); &#125; &#125; &#125; &#125; IOCå®¹å™¨çš„æ‰©å±•ç‚¹å¦‚ä½•è®©è¿™äº› Bean å¯¹è±¡æœ‰ä¸€å®šçš„æ‰©å±•æ€§ï¼ˆå°±æ˜¯å¯ä»¥åŠ å…¥ç”¨æˆ·çš„ä¸€äº›æ“ä½œï¼‰ä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦æ€è€ƒçš„ï¼é‚£ä¹ˆæœ‰å“ªäº›æ‰©å±•ç‚¹å‘¢ï¼Ÿ Spring åˆæ˜¯å¦‚ä½•è°ƒç”¨åˆ°è¿™äº›æ‰©å±•ç‚¹çš„ï¼Ÿ å¯¹ Spring çš„ IOC å®¹å™¨æ¥è¯´ï¼Œä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªæ‰©å±•ç‚¹ï¼š BeanFactoryPostProcessorï¼Œ BeanPostProcessorï¼šä»–ä»¬åˆ†åˆ«æ˜¯åœ¨æ„å»º BeanFactory å’Œæ„å»º Bean å¯¹è±¡æ—¶è°ƒç”¨ã€‚ InitializingBean å’Œ DisposableBean ï¼šä»–ä»¬åˆ†åˆ«æ˜¯åœ¨ Bean å®ä¾‹åˆ›å»ºå’Œé”€æ¯æ—¶è¢«è°ƒç”¨ã€‚ç”¨æˆ·å¯ä»¥å®ç°è¿™äº›æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼ŒSpring å°±ä¼šåœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨ä»–ä»¬ã€‚ FactoryBean ï¼šä»–æ˜¯ä¸ªç‰¹æ®Šçš„ Beanï¼Œè¿™ä¸ª Bean å¯ä»¥è¢«ç”¨æˆ·æ›´å¤šçš„æ§åˆ¶ã€‚ è¿™äº›æ‰©å±•ç‚¹é€šå¸¸ä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨ Spring æ¥å®Œæˆæˆ‘ä»¬ç‰¹å®šä»»åŠ¡çš„åœ°æ–¹ï¼Œæ˜¯å¦ç²¾é€š Spring å°±çœ‹ä½ æœ‰æ²¡æœ‰æŒæ¡å¥½Springæœ‰å“ªäº›æ‰©å±•ç‚¹ï¼Œå¹¶ä¸”å¦‚ä½•ä½¿ç”¨ä»–ä»¬ã€‚ è¦çŸ¥é“å¦‚ä½•ä½¿ç”¨ä»–ä»¬å°±å¿…é¡»äº†è§£ä»–ä»¬å†…åœ¨çš„æœºç†ã€‚å¯ä»¥ç”¨ä¸‹é¢ä¸€ä¸ªæ¯”å–»ï¼ˆä¼˜ç§€ï¼‰æ¥è§£é‡Šï¼š æˆ‘ä»¬æŠŠ IOC å®¹å™¨æ¯”ä½œä¸€ä¸ªç®±å­ï¼Œè¿™ä¸ªç®±å­é‡Œæœ‰è‹¥å¹²ä¸ªçƒçš„æ¨¡å­ï¼Œå¯ä»¥ç”¨è¿™äº›æ¨¡å­æ¥é€ å¾ˆå¤šç§ä¸åŒçš„çƒï¼Œè¿˜æœ‰ä¸€ä¸ªé€ è¿™äº›çƒæ¨¡çš„æœºå™¨ï¼Œè¿™ä¸ªæœºå™¨å¯ä»¥äº§ç”Ÿçƒæ¨¡ã€‚é‚£ä¹ˆä»–ä»¬çš„å¯¹åº”å…³ç³»å°±æ˜¯ BeanFactory å°±æ˜¯é‚£ä¸ªé€ çƒæ¨¡çš„æœºå™¨ï¼Œçƒæ¨¡å°±æ˜¯ Beanï¼Œè€Œçƒæ¨¡é€ å‡ºæ¥çš„çƒå°±æ˜¯ Bean çš„å®ä¾‹ã€‚ é‚£å‰é¢æ‰€è¯´çš„å‡ ä¸ªæ‰©å±•ç‚¹åˆåœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ BeanFactoryPostProcessor å¯¹åº”åˆ°å½“é€ çƒæ¨¡è¢«é€ å‡ºæ¥æ—¶ï¼Œä½ å°†æœ‰æœºä¼šå¯ä»¥å¯¹å…¶åšå‡ºè®¾å½“çš„ä¿®æ­£ï¼Œä¹Ÿå°±æ˜¯ä»–å¯ä»¥å¸®ä½ ä¿®æ”¹çƒæ¨¡ã€‚è€Œ InitializingBean å’Œ DisposableBean æ˜¯åœ¨çƒæ¨¡é€ çƒçš„å¼€å§‹å’Œç»“æŸé˜¶æ®µï¼Œä½ å¯ä»¥å®Œæˆä¸€äº›é¢„å¤‡å’Œæ‰«å°¾å·¥ä½œã€‚BeanPostProcessor å°±å¯ä»¥è®©ä½ å¯¹çƒæ¨¡é€ å‡ºæ¥çš„çƒåšå‡ºé€‚å½“çš„ä¿®æ­£ã€‚æœ€åè¿˜æœ‰ä¸€ä¸ª FactoryBeanï¼Œå®ƒå¯æ˜¯ä¸€ä¸ªç¥å¥‡çš„çƒæ¨¡ã€‚è¿™ä¸ªçƒæ¨¡ä¸æ˜¯é¢„å…ˆå°±å®šå‹äº†ï¼Œè€Œæ˜¯ç”±ä½ æ¥ç»™ä»–ç¡®å®šå®ƒçš„å½¢çŠ¶ï¼Œæ—¢ç„¶ä½ å¯ä»¥ç¡®å®šè¿™ä¸ªçƒæ¨¡å‹çš„å½¢çŠ¶ï¼Œå½“ç„¶ä»–é€ å‡ºæ¥çš„çƒè‚¯å®šå°±æ˜¯ä½ æƒ³è¦çš„çƒäº†ï¼Œè¿™æ ·åœ¨è¿™ä¸ªç®±å­é‡Œä½ å¯ä»¥å‘ç°æ‰€æœ‰ä½ æƒ³è¦çš„çƒã€‚ IOCå®¹å™¨çš„ä½¿ç”¨æˆ‘ä»¬ä½¿ç”¨ Spring å¿…é¡»è¦é¦–å…ˆæ„å»º IOC å®¹å™¨ï¼Œæ²¡æœ‰å®ƒ Spring æ— æ³•å·¥ä½œï¼ŒApplicatonContext.xml å°±æ˜¯ IOC å®¹å™¨çš„é»˜è®¤é…ç½®æ–‡ä»¶ï¼ŒSpring çš„æ‰€æœ‰ç‰¹æ€§åŠŸèƒ½éƒ½æ˜¯åŸºäºè¿™ä¸ª IOC å®¹å™¨å·¥ä½œçš„ï¼Œæ¯”å¦‚åé¢è¦ä»‹ç»çš„ AOPã€‚ å‚è€ƒ ã€Šæ·±å…¥åˆ†æJava WebæŠ€æœ¯å†…å¹•ã€‹ æ·±å…¥å‰–æSpring(ä¸€)â€”â€”IoCçš„åŸºæœ¬æ¦‚å¿µ(ä»é¢å‘å¯¹è±¡è§’åº¦ä»‹ç»)]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­ç§˜Spring(ä¸€)_Springæ¶æ„]]></title>
    <url>%2F2018%2F04%2F10%2F%E6%B7%B1%E5%85%A5SSM%2F%E6%8F%AD%E7%A7%98Spring-%E4%B8%80-Spring%E6%9E%B6%E6%9E%84%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šSpringä½œä¸ºç°åœ¨æœ€ä¼˜ç§€çš„æ¡†æ¶ä¹‹ä¸€ï¼Œè¢«å¹¿æ³›å¾—ä½¿ç”¨åœ¨Webåœºæ™¯ä¸­ã€‚å¾ˆå¤šäººåªä¼šä½¿ç”¨ï¼Œä½†æ˜¯å´ä¸çŸ¥é“Springæ•´ä¸ªä½“ç³»æ¶æ„ã€‚ Springçš„éª¨éª¼æ¶æ„Springæ€»å…±æœ‰åå‡ ä¸ªç»„ä»¶ï¼Œä½†æ˜¯çœŸæ­£æ ¸å¿ƒçš„ç»„ä»¶åªæœ‰å‡ ä¸ªï¼Œå¦‚ä¸‹å›¾ä¸ºSpringæ¡†æ¶å¼€å§‹ä»¥æ¥æ‹¥æœ‰çš„æ€»ä½“æ¶æ„å›¾ï¼š ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨Springæ¡†æ¶ä¸­çš„ æ ¸å¿ƒç»„ä»¶ åªæœ‰ä¸‰ä¸ªï¼šcoreã€contextã€beanã€‚ä»–ä»¬æ„å»ºèµ·æ•´ä¸ªSpringçš„éª¨éª¼æ¶æ„ï¼Œæ²¡æœ‰ä»–ä»¬å°±ä¸å¯èƒ½æœ‰AOPã€Webç­‰ä¸Šå±‚çš„ ç‰¹æ€§åŠŸèƒ½ ã€‚ Springçš„è®¾è®¡ç†å¿µä¸Šé¢è¯´äº†ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œä½†æ˜¯æœ€é‡è¦å°±æ˜¯Beanç»„ä»¶äº†ï¼Œç”¨è¿‡Springçš„äººéƒ½çŸ¥é“ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„ç±»åŸºæœ¬ä¸Šéƒ½ä¼šäº¤ç»™Springæ‰˜ç®¡ï¼Œä¹Ÿå°±æ˜¯è¯´Springå°±æ˜¯é¢å‘Beançš„ç¼–ç¨‹ã€‚Beanåœ¨Springä¸­çš„ä½œç”¨å°±åƒObjectå¯¹OOPçš„æ„ä¹‰ä¸€æ ·ï¼Œæ²¡æœ‰å¯¹è±¡çš„æ¦‚å¿µå°±æ²¡æœ‰é¢å‘å¯¹è±¡çš„æ¦‚å¿µï¼Œåœ¨Springä¸­æ²¡æœ‰Beanä¹Ÿå°±æ²¡æœ‰Springå­˜åœ¨çš„æ„ä¹‰ã€‚ ä½¿ç”¨Springæœ€å¤§çš„åŸå› ï¼š æ˜¯ä»–è§£å†³äº†ä¸€ä¸ªéå¸¸å…³é”®çš„é—®é¢˜ï¼Œå®ƒå¯ä»¥è®©ä½ æŠŠå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»è§£è€¦ï¼Œå…¶ä¸­çš„å…³ç³»äº¤ç”±IOCå®¹å™¨ï¼ˆBeanå…³ç³»çš„é›†åˆï¼‰æ¥ç®¡ç†ï¼Œæ ¸å¿ƒå°±æ˜¯ä¾èµ–æ³¨å…¥æœºåˆ¶ã€‚Springä¹Ÿæ­£æ˜¯é€šè¿‡æŠŠå¯¹è±¡åŒ…è£…åœ¨Beanä¸­è¾¾åˆ°ç®¡ç†è¿™äº›å¯¹è±¡åŠåšä¸€äº›åˆ—é¢å¤–æ“ä½œçš„ç›®çš„ã€‚ ä¸€èˆ¬æ¡†æ¶è®¾è®¡ç†å¿µï¼š å…ˆæ„å»ºä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç„¶åæ ¹æ®è¿™ä¸ªæ•°æ®ç»“æ„è®¾è®¡å®ƒçš„ç”Ÿå­˜ç¯å¢ƒï¼Œå¹¶è®©å®ƒåœ¨è¿™ä¸ªç¯å¢ƒä¸­æŒ‰ç…§ä¸€å®šçš„è§„å¾‹ä¸åœçš„è¿åŠ¨ï¼Œåœ¨ä»–ä¸åœè¿åŠ¨çš„è¿‡ç¨‹ä¸­è®¾è®¡å®ƒä»¬ä¸ç¯å¢ƒæˆ–è€…ä¸å…¶ä»–ä¸ªä½“å®Œæˆä¿¡æ¯äº¤æ¢ã€‚ æ ¸å¿ƒç»„ä»¶å¦‚ä½•ååŒå·¥ä½œå‚è€ƒã€Šæ·±å…¥åˆ†æJava WebæŠ€æœ¯å†…å¹•ã€‹ä¸€ä¹¦ä¸­æœ‰ä¸ªå½¢è±¡çš„æ¯”å–»ï¼šSpringæ¡†æ¶å°±åƒä¸€åœºæ¼”å‡ºï¼ŒBeanç›¸å½“äºæ¼”å‘˜ï¼ŒContextç›¸å½“äºæ¼”å‡ºçš„èˆå°èƒŒæ™¯ã€Coreç›¸å½“äºæ¼”å‡ºçš„é“å…·ï¼ˆæŠŠæ¼”å‘˜è”ç³»èµ·æ¥ï¼‰ã€‚å¦‚æœæƒ³æ¼”å‡ºè¶³å¤Ÿæ–°é¢–ï¼Œå°±éœ€è¦Springæä¾›çš„å…¶ä»–ç‰¹è‰²åŠŸèƒ½äº†ã€‚ å›åˆ°Springï¼šBeanåŒ…è£…çš„æ˜¯Objectï¼Œè€ŒObjectå¿…ç„¶æœ‰æ•°æ®ï¼Œå¦‚ä½•ç»™è¿™äº›æ•°æ®æä¾›ç”Ÿæˆç¯å¢ƒå°±æ˜¯Contextè¦è§£å†³çš„äº‹æƒ…ï¼Œå¯¹äºContextæ¥è¯´å°±æ˜¯è¦å‘ç°æ¯ä¸ªBeanä¹‹é—´çš„å…³ç³»ï¼Œä¸ºä»–ä»¬å»ºç«‹è¿™ç§å…³ç³»å¹¶ä¸”ç»´æŠ¤å¥½è¿™ç§å…³ç³»ï¼Œè€Œå‘ç°ã€å»ºç«‹å’Œç»´æŠ¤æ¯ä¸ªBeanä¹‹é—´çš„å…³ç³»ç»´æŠ¤è¿™ç§å…³ç³»å°±éœ€è¦Coreç»„ä»¶äº†ï¼ŒCoreç»„ä»¶å…¶å®å°±æ˜¯å‘ç°ã€å»ºç«‹å’Œç»´æŠ¤æ¯ä¸ªBeanä¹‹é—´çš„å…³ç³»æ‰€éœ€è¦çš„ä¸€äº›åˆ—å·¥å…·ã€‚æœ€åæˆ‘ä»¬å‘ç°Contextå°±æ˜¯ä¸€ä¸ªBeanå…³ç³»çš„é›†åˆï¼Œè¿™ä¸ªå…³ç³»é›†åˆå°±å«IOCå®¹å™¨ï¼Œå½“å»ºç«‹èµ·IOCå®¹å™¨ï¼ŒSpringå°±å¯ä»¥å·¥ä½œäº†ã€‚ä»–ä»¬çš„å…³ç³»å¯ä»¥ç”¨ä¸‹å›¾æ¥æè¿°ï¼š æ ¸å¿ƒç»„ä»¶è§£æBeanç»„ä»¶Bean ç»„ä»¶åœ¨ Spring çš„ org.springframework.beans åŒ…ä¸‹ã€‚è¿™ä¸ªåŒ…ä¸‹çš„æ‰€æœ‰ç±»ä¸»è¦è§£å†³äº†ä¸‰ä»¶äº‹ï¼šBean çš„å®šä¹‰ã€ Bean çš„è§£æä»¥åŠå¯¹Bean çš„åˆ›å»ºã€‚å¯¹ Spring çš„ä½¿ç”¨è€…æ¥è¯´å”¯ä¸€éœ€è¦å…³å¿ƒçš„å°±æ˜¯ Bean çš„åˆ›å»ºï¼Œå…¶ä»–ä¸¤ä¸ªç”± Spring åœ¨å†…éƒ¨å¸®ä½ å®Œæˆäº†ï¼Œå¯¹ä½ æ¥è¯´æ˜¯é€æ˜çš„ã€‚ Beançš„å®šä¹‰Bean çš„å®šä¹‰ä¸»è¦æœ‰ BeanDefinition æè¿°ï¼Œå¦‚ä¸‹å›¾ï¼ˆRootBeanDefinitionç±»å›¾ï¼‰è¯´æ˜äº†è¿™äº›ç±»çš„å±‚æ¬¡å…³ç³»ï¼š Bean çš„å®šä¹‰å°±æ˜¯å®Œæ•´çš„æè¿°äº†åœ¨ Spring çš„é…ç½®çš„Beanä¸­æ‰€æœ‰çš„ä¿¡æ¯ã€‚å½“ Spring æˆåŠŸè§£æä½ å®šä¹‰çš„ä¸€ä¸ªBeanåï¼Œåœ¨ Spring çš„å†…éƒ¨ä»–å°±è¢«è½¬åŒ–æˆ BeanDefinition å¯¹è±¡ï¼Œå®ƒå¯ä»¥å®šä¹‰ä¸ºSINGLETONè¿˜æ˜¯PROTOTYPEã€‚ä»¥åæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯å¯¹è¿™ä¸ªå¯¹è±¡å®Œæˆçš„ã€‚ Beançš„è§£æBean çš„è§£æè¿‡ç¨‹éå¸¸å¤æ‚ï¼ŒåŠŸèƒ½è¢«åˆ†çš„å¾ˆç»†ï¼Œå› ä¸ºè¿™é‡Œéœ€è¦è¢«æ‰©å±•çš„åœ°æ–¹å¾ˆå¤šï¼Œå¿…é¡»ä¿è¯æœ‰è¶³å¤Ÿçš„çµæ´»æ€§ï¼Œä»¥åº”å¯¹å¯èƒ½çš„å˜åŒ–ã€‚Bean çš„è§£ææ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´é…ç½®æ–¹å¼æœ‰å¾ˆå¤šç§ï¼ˆä¹‹åä¼šä»‹ç»å„ç§Beançš„é…ç½®æ–¹æ³•ï¼Œå¦‚xmlï¼Œæ‰«æï¼Œæ³¨è§£ã€javaé…ç½®ï¼‰ã€‚è¿™é‡Œå°±ä»‹ç»ä¸€ä¸‹æœ€æ—©çš„è§£æXMLé…ç½®ï¼Œå®ƒçš„è¿‡ç¨‹ä¸»è¦é€šè¿‡ä¸‹å›¾ä¸­çš„ç±»(XmlBeanDefinitionReader)å®Œæˆï¼š Beançš„åˆ›å»ºSpring Bean çš„åˆ›å»ºæ˜¯å…¸å‹çš„å·¥å‚æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡DefaultListableBeanFactoryè¿™ä¸ªç±»æ¥äº†è§£Springçš„å·¥å‚æ¨¡å¼ï¼Œå·¥å‚æ¨¡å¼çš„é¡¶çº§æ¥å£æ˜¯ BeanFactoryï¼Œä¸‹å›¾æ˜¯è¿™ä¸ªå·¥å‚çš„ç»§æ‰¿å±‚æ¬¡å…³ç³»ï¼š BeanFactory æœ‰ä¸‰ä¸ªå­ç±»ï¼šListableBeanFactoryã€HierarchicalBeanFactory å’Œ AutowireCapableBeanFactoryã€‚ä½†æ˜¯ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°æœ€ç»ˆçš„é»˜è®¤å®ç°ç±»æ˜¯ DefaultListableBeanFactoryï¼Œä»–å®ç°äº†æ‰€æœ‰çš„æ¥å£ã€‚ æ¡†æ¶æ ¸å¿ƒï¼šé‚£ä¸ºä½•è¦å®šä¹‰è¿™ä¹ˆå¤šå±‚æ¬¡çš„æ¥å£å‘¢ï¼Ÿ æŸ¥é˜…è¿™äº›æ¥å£çš„æºç å’Œè¯´æ˜å‘ç°ï¼Œæ¯ä¸ªæ¥å£éƒ½æœ‰ä»–ä½¿ç”¨çš„åœºåˆï¼Œå®ƒä¸»è¦æ˜¯ä¸ºäº†åŒºåˆ†åœ¨ Spring å†…éƒ¨åœ¨æ“ä½œè¿‡ç¨‹ä¸­å¯¹è±¡çš„ä¼ é€’å’Œè½¬åŒ–è¿‡ç¨‹ä¸­ï¼Œå¯¹å¯¹è±¡çš„æ•°æ®è®¿é—®æ‰€åšçš„é™åˆ¶ï¼Œå…·ä½“å¦‚ä¸‹ï¼š ListableBeanFactory æ¥å£è¡¨ç¤ºè¿™äº› Bean æ˜¯å¯åˆ—è¡¨çš„ HierarchicalBeanFactory è¡¨ç¤ºçš„æ˜¯è¿™äº› Beanæ˜¯æœ‰ç»§æ‰¿å…³ç³»çš„ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ª Beanæœ‰å¯èƒ½æœ‰çˆ¶ Beanã€‚ AutowireCapableBeanFactory æ¥å£å®šä¹‰Beançš„è‡ªåŠ¨è£…é…è§„åˆ™ã€‚ è¿™å››ä¸ªæ¥å£å…±åŒå®šä¹‰äº† Bean çš„é›†åˆã€Bean ä¹‹é—´çš„å…³ç³»ã€ä»¥åŠ Bean è¡Œä¸ºã€‚ Contextç»„ä»¶Context åœ¨ Spring çš„ org.springframework.context åŒ…ä¸‹ï¼ŒContext ç»„ä»¶åœ¨ Spring ä¸­çš„ä½œç”¨å®é™…ä¸Šå°±æ˜¯ç»™Springæä¾›ä¸€ä¸ªè¿è¡Œæ—¶çš„ç¯å¢ƒï¼Œç”¨ä»¥ä¿å­˜å„ä¸ªå¯¹è±¡çš„çŠ¶æ€ ã€‚ä¸‹é¢çœ‹ä¸€ä¸‹è¿™ä¸ªç¯å¢ƒæ˜¯å¦‚ä½•æ„å»ºçš„ã€‚ ApplicationContext æ˜¯ Context çš„é¡¶çº§çˆ¶ç±»ï¼Œä»–é™¤äº†èƒ½æ ‡è¯†ä¸€ä¸ªåº”ç”¨ç¯å¢ƒçš„åŸºæœ¬ä¿¡æ¯å¤–ï¼Œä»–è¿˜ç»§æ‰¿äº†å…­ä¸ªæ¥å£ï¼Œè¿™å…­ä¸ªæ¥å£ä¸»è¦æ˜¯æ‰©å±•äº† Context çš„åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯ Context ç›¸å…³çš„ç±»ç»“æ„å›¾ï¼š ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡º ApplicationContext ç»§æ‰¿äº†BeanFactoryï¼Œè¿™ä¹Ÿè¯´æ˜äº† Spring å®¹å™¨ä¸­è¿è¡Œçš„ä¸»ä½“å¯¹è±¡æ˜¯ Beanï¼Œå¦å¤– ApplicationContext ç»§æ‰¿äº† ResourceLoader æ¥å£ï¼Œä½¿å¾— ApplicationContext å¯ä»¥è®¿é—®åˆ°ä»»ä½•å¤–éƒ¨èµ„æºï¼ˆå°±æ˜¯Coreé‡Œé¢çš„å·¥å…·äº†ï¼Œè¿™å°†åœ¨ Core ä¸­è¯¦ç»†è¯´æ˜ï¼‰ã€‚ ApplicationContext çš„å­ç±»ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–¹é¢ï¼š ConfigurableApplicationContextï¼šè¡¨ç¤ºè¯¥Contextæ˜¯å¯ä¿®æ”¹çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨æ„å»º Context ä¸­ç”¨æˆ·å¯ä»¥åŠ¨æ€æ·»åŠ æˆ–ä¿®æ”¹å·²æœ‰çš„é…ç½®ä¿¡æ¯ï¼Œå®ƒä¸‹é¢åˆæœ‰å¤šä¸ªå­ç±»ï¼Œå…¶ä¸­æœ€ç»å¸¸ä½¿ç”¨çš„æ˜¯å¯æ›´æ–°çš„ Contextï¼Œå³ AbstractRefreshableApplicationContext ç±»ã€‚ WebApplicationContext ï¼šçœ‹åˆ°webå°±çŸ¥é“è¿™ä¸º web å‡†å¤‡çš„ Context ä»–å¯ä»¥ç›´æ¥è®¿é—®åˆ° ServletContextï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ¥å£ä½¿ç”¨çš„å°‘ã€‚å†å¾€ä¸‹åˆ†å°±æ˜¯æŒ‰ç…§æ„å»º Context çš„æ–‡ä»¶ç±»å‹ï¼ˆæ²¡åˆ—å‡ºï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»çœ‹ï¼‰ï¼Œæ¥ç€å°±æ˜¯è®¿é—® Context çš„æ–¹å¼ã€‚è¿™æ ·ä¸€çº§ä¸€çº§æ„æˆäº†å®Œæ•´çš„ Context ç­‰çº§å±‚æ¬¡ã€‚ æ€»ä½“æ¥è¯´ ApplicationContext å¿…é¡»è¦å®Œæˆä»¥ä¸‹å‡ ä»¶äº‹ï¼š æ ‡è¯†ä¸€ä¸ªåº”ç”¨ç¯å¢ƒ åˆ©ç”¨ BeanFactory åˆ›å»º Bean å¯¹è±¡ ä¿å­˜å¯¹è±¡å…³ç³»è¡¨ èƒ½å¤Ÿæ•è·å„ç§äº‹ä»¶ Context ä½œä¸º Spring çš„ IOC å®¹å™¨ï¼ŒåŸºæœ¬ä¸Šæ•´åˆäº† Spring çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œæˆ–è€…è¯´æ˜¯å¤§éƒ¨åˆ†åŠŸèƒ½çš„åŸºç¡€ã€‚ Coreç»„ä»¶Core ç»„ä»¶åœ¨Spring çš„org.springframework.coreåŒ…ä¸‹ï¼Œå®ƒä½œä¸º Springçš„æ ¸å¿ƒç»„ä»¶ï¼Œä»–å…¶ä¸­åŒ…å«äº†å¾ˆå¤šçš„å…³é”®ç±»ï¼Œå…¶ä¸­ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†å°±æ˜¯å®šä¹‰äº†èµ„æºï¼ˆResourceï¼‰çš„è®¿é—®æ–¹å¼ã€‚è¿™ç§æŠŠæ‰€æœ‰èµ„æºéƒ½æŠ½è±¡æˆä¸€ä¸ªæ¥å£çš„æ–¹å¼å¾ˆå€¼å¾—åœ¨ä»¥åçš„è®¾è®¡ä¸­æ‹¿æ¥å­¦ä¹ ã€‚ä¸‹é¢å°±é‡è¦çœ‹ä¸€ä¸‹è¿™ä¸ªéƒ¨åˆ†åœ¨ Spring çš„ä½œç”¨ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹å›¾ï¼ˆ Resource ç›¸å…³çš„ç±»ç»“æ„å›¾ï¼‰æ¥ç†è§£ï¼š ä»ä¸Šå›¾å¯ä»¥çœ‹å‡º Resource æ¥å£å°è£…äº†å„ç§å¯èƒ½çš„èµ„æºç±»å‹ï¼Œä¹Ÿå°±æ˜¯å¯¹ä½¿ç”¨è€…æ¥è¯´å±è”½äº†æ–‡ä»¶ç±»å‹çš„ä¸åŒã€‚å¯¹èµ„æºçš„æä¾›è€…æ¥è¯´ï¼Œå¦‚ä½•æŠŠèµ„æºåŒ…è£…èµ·æ¥äº¤ç»™å…¶ä»–äººç”¨è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜(æ‰€ä»¥äº§ç”Ÿäº†å¾ˆå¤šæ–¹å¼)ï¼Œæˆ‘ä»¬çœ‹åˆ° Resource æ¥å£ç»§æ‰¿äº† InputStreamSource æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä¸­æœ‰ä¸ª getInputStream æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ InputStream ç±»ã€‚è¿™æ ·æ‰€æœ‰çš„èµ„æºéƒ½è¢«å¯ä»¥é€šè¿‡ InputStream è¿™ä¸ªç±»æ¥è·å–ï¼Œæ‰€ä»¥ä¹Ÿå±è”½äº†èµ„æºçš„æä¾›è€…ã€‚å¦å¤–è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯åŠ è½½èµ„æºçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯èµ„æºçš„åŠ è½½è€…è¦ç»Ÿä¸€ï¼Œä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºè¿™ä¸ªä»»åŠ¡æ˜¯ç”± ResourceLoader æ¥å£å®Œæˆï¼Œä»–å±è”½äº†æ‰€æœ‰çš„èµ„æºåŠ è½½è€…çš„å·®å¼‚ï¼Œåªéœ€è¦å®ç°è¿™ä¸ªæ¥å£å°±å¯ä»¥åŠ è½½æ‰€æœ‰çš„èµ„æºï¼Œä»–çš„é»˜è®¤å®ç°æ˜¯ DefaultResourceLoaderã€‚ é‚£Context å’Œ Resource æ˜¯å¦‚ä½•å»ºç«‹å…³ç³»çš„ï¼Ÿä¸‹é¢æ˜¯ä»–ä»¬çš„ç±»å…³ç³»å›¾ï¼š ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒContext æ˜¯æŠŠèµ„æºçš„åŠ è½½ã€è§£æå’Œæè¿°å·¥ä½œå§”æ‰˜ç»™äº† ResourcePatternResolver ç±»æ¥å®Œæˆï¼Œä»–ç›¸å½“äºä¸€ä¸ªæ¥å¤´äººï¼Œä»–æŠŠèµ„æºçš„åŠ è½½ã€è§£æå’Œèµ„æºçš„å®šä¹‰æ•´åˆåœ¨ä¸€èµ·ä¾¿äºå…¶ä»–ç»„ä»¶ä½¿ç”¨ã€‚Core ç»„ä»¶ä¸­è¿˜æœ‰å¾ˆå¤šç±»ä¼¼çš„æ–¹å¼ã€‚ å‚è€ƒ ã€Šæ·±å…¥åˆ†æJava WebæŠ€æœ¯å†…å¹•ã€‹ Springå¤šç§åŠ è½½Beanæ–¹å¼è§£æ]]></content>
      <categories>
        <category>æ·±å…¥SSM</category>
      </categories>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_é˜²ç«å¢™é…ç½®]]></title>
    <url>%2F2018%2F04%2F09%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux-%E9%98%B2%E7%81%AB%E5%A2%99%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¿éšœæ•°æ®çš„å®‰å…¨æ€§æ˜¯ç»§ä¿éšœæ•°æ®çš„å¯ç”¨æ€§ä¹‹åæœ€ä¸ºé‡è¦çš„ä¸€é¡¹å·¥ä½œã€‚é˜²ç«å¢™ä½œä¸ºå…¬ç½‘ä¸å†…ç½‘ä¹‹é—´çš„ä¿æŠ¤å±éšœï¼Œåœ¨ä¿éšœæ•°æ®çš„å®‰å…¨æ€§æ–¹é¢èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ é˜²ç«å¢™ç®¡ç†å·¥å…·åœ¨å…¬ç½‘ä¸ä¼ä¸šå†…ç½‘ä¹‹é—´å……å½“ä¿æŠ¤å±éšœçš„é˜²ç«å¢™è™½ç„¶æœ‰è½¯ä»¶æˆ–ç¡¬ä»¶ä¹‹åˆ†ï¼Œä½†ä¸»è¦åŠŸèƒ½éƒ½æ˜¯ ä¾æ®ç­–ç•¥å¯¹ç©¿è¶Šé˜²ç«å¢™è‡ªèº«çš„æµé‡è¿›è¡Œè¿‡æ»¤ã€‚ é˜²ç«å¢™ç­–ç•¥å¯ä»¥åŸºäºæµé‡çš„æºç›®åœ°å€ã€ç«¯å£å·ã€åè®®ã€åº”ç”¨ç­‰ä¿¡æ¯æ¥å®šåˆ¶ï¼Œç„¶åé˜²ç«å¢™ä½¿ç”¨é¢„å…ˆå®šåˆ¶çš„ç­–ç•¥è§„åˆ™ç›‘æ§å‡ºå…¥çš„æµé‡ï¼Œè‹¥æµé‡ä¸æŸä¸€æ¡ç­–ç•¥è§„åˆ™ç›¸åŒ¹é…ï¼Œåˆ™æ‰§è¡Œç›¸åº”çš„å¤„ç†ï¼Œåä¹‹åˆ™ä¸¢å¼ƒã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±å¯ä»¥ä¿è¯ä»…æœ‰åˆæ³•çš„æµé‡åœ¨ä¼ä¸šå†…ç½‘å’Œå¤–éƒ¨å…¬ç½‘ä¹‹é—´æµåŠ¨äº†ã€‚ åœ¨Centos 7ç³»ç»Ÿä¸­ï¼Œfirewalldé˜²ç«å¢™å–ä»£äº†iptablesé˜²ç«å¢™ã€‚ä½†æ˜¯ iptablesä¸firewalldéƒ½ä¸æ˜¯çœŸæ­£çš„é˜²ç«å¢™ ï¼Œå®ƒä»¬éƒ½åªæ˜¯ç”¨æ¥å®šä¹‰é˜²ç«å¢™ç­–ç•¥çš„ é˜²ç«å¢™ç®¡ç†å·¥å…· è€Œå·²ï¼Œæˆ–è€…è¯´ï¼Œå®ƒä»¬åªæ˜¯ä¸€ç§ æœåŠ¡ ã€‚iptablesæœåŠ¡ä¼šæŠŠé…ç½®å¥½çš„é˜²ç«å¢™ç­–ç•¥äº¤ç”±å†…æ ¸å±‚é¢çš„netfilterç½‘ç»œè¿‡æ»¤å™¨æ¥å¤„ç†ï¼Œè€ŒfirewalldæœåŠ¡åˆ™æ˜¯æŠŠé…ç½®å¥½çš„é˜²ç«å¢™ç­–ç•¥äº¤ç”±å†…æ ¸å±‚é¢çš„nftablesåŒ…è¿‡æ»¤æ¡†æ¶æ¥å¤„ç†ã€‚æ¢å¥è¯è¯´ï¼Œå½“å‰åœ¨Linuxç³»ç»Ÿä¸­å…¶å®å­˜åœ¨å¤šä¸ªé˜²ç«å¢™ç®¡ç†å·¥å…·ï¼Œæ—¨åœ¨æ–¹ä¾¿è¿ç»´äººå‘˜ç®¡ç†Linuxç³»ç»Ÿä¸­çš„é˜²ç«å¢™ç­–ç•¥ï¼Œæˆ‘ä»¬åªéœ€è¦é…ç½®å¦¥å½“å…¶ä¸­çš„ä¸€ä¸ªå°±è¶³å¤Ÿäº†ã€‚è™½ç„¶è¿™äº›å·¥å…·å„æœ‰ä¼˜åŠ£ï¼Œä½†å®ƒä»¬åœ¨é˜²ç«å¢™ç­–ç•¥çš„é…ç½®æ€è·¯ä¸Šæ˜¯ä¿æŒä¸€è‡´çš„ã€‚ Iptablesåœ¨æ—©æœŸçš„Linuxç³»ç»Ÿä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯iptablesé˜²ç«å¢™ç®¡ç†æœåŠ¡æ¥é…ç½®é˜²ç«å¢™ã€‚å°½ç®¡æ–°å‹çš„firewalldé˜²ç«å¢™ç®¡ç†æœåŠ¡å·²ç»è¢«æŠ•å…¥ä½¿ç”¨å¤šå¹´ï¼Œä½†æ˜¯å¤§é‡çš„ä¼ä¸šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¾ç„¶å‡ºäºå„ç§åŸå› è€Œç»§ç»­ä½¿ç”¨iptablesã€‚ ç­–ç•¥ä¸è§„åˆ™é“¾é˜²ç«å¢™ä¼šä»ä¸Šè‡³ä¸‹çš„é¡ºåºæ¥è¯»å–é…ç½®çš„ç­–ç•¥è§„åˆ™ï¼Œåœ¨æ‰¾åˆ°åŒ¹é…é¡¹åå°±ç«‹å³ç»“æŸåŒ¹é…å·¥ä½œå¹¶å»æ‰§è¡ŒåŒ¹é…é¡¹ä¸­å®šä¹‰çš„è¡Œä¸ºï¼ˆå³æ”¾è¡Œæˆ–é˜»æ­¢ï¼‰ã€‚å¦‚æœåœ¨è¯»å–å®Œæ‰€æœ‰çš„ç­–ç•¥è§„åˆ™ä¹‹åæ²¡æœ‰åŒ¹é…é¡¹ï¼Œå°±å»æ‰§è¡Œé»˜è®¤çš„ç­–ç•¥ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œé˜²ç«å¢™ç­–ç•¥è§„åˆ™çš„è®¾ç½®æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯â€œé€šâ€ï¼ˆå³æ”¾è¡Œï¼‰ï¼Œä¸€ç§æ˜¯â€œå µâ€ï¼ˆå³é˜»æ­¢ï¼‰ã€‚å½“é˜²ç«å¢™çš„é»˜è®¤ç­–ç•¥ä¸ºæ‹’ç»æ—¶ï¼ˆå µï¼‰ï¼Œå°±è¦è®¾ç½®å…è®¸è§„åˆ™ï¼ˆé€šï¼‰ï¼Œå¦åˆ™è°éƒ½è¿›ä¸æ¥ï¼›å¦‚æœé˜²ç«å¢™çš„é»˜è®¤ç­–ç•¥ä¸ºå…è®¸æ—¶ï¼Œå°±è¦è®¾ç½®æ‹’ç»è§„åˆ™ï¼Œå¦åˆ™è°éƒ½èƒ½è¿›æ¥ï¼Œ é˜²ç«å¢™ä¹Ÿå°±å¤±å»äº†é˜²èŒƒçš„ä½œç”¨ã€‚ iptablesæœåŠ¡æŠŠç”¨äºå¤„ç†æˆ–è¿‡æ»¤æµé‡çš„ç­–ç•¥æ¡ç›®ç§°ä¹‹ä¸ºè§„åˆ™ï¼Œå¤šæ¡è§„åˆ™å¯ä»¥ç»„æˆä¸€ä¸ªè§„åˆ™é“¾ï¼Œè€Œè§„åˆ™é“¾åˆ™ä¾æ®æ•°æ®åŒ…å¤„ç†ä½ç½®çš„ä¸åŒè¿›è¡Œåˆ†ç±»ï¼Œå…·ä½“å¦‚ä¸‹ï¼š åœ¨è¿›è¡Œè·¯ç”±é€‰æ‹©å‰å¤„ç†æ•°æ®åŒ…ï¼ˆPREROUTINGï¼‰ å¤„ç†æµå…¥çš„æ•°æ®åŒ…ï¼ˆINPUTï¼‰ å¤„ç†æµå‡ºçš„æ•°æ®åŒ…ï¼ˆOUTPUTï¼‰ å¤„ç†è½¬å‘çš„æ•°æ®åŒ…ï¼ˆFORWARDï¼‰ åœ¨è¿›è¡Œè·¯ç”±é€‰æ‹©åå¤„ç†æ•°æ®åŒ…ï¼ˆPOSTROUTINGï¼‰ ä¸€èˆ¬æ¥è¯´ï¼Œä»å†…ç½‘å‘å¤–ç½‘å‘é€çš„æµé‡ä¸€èˆ¬éƒ½æ˜¯å¯æ§ä¸”è‰¯æ€§çš„ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨æœ€å¤šçš„å°±æ˜¯INPUTè§„åˆ™é“¾ï¼Œ è¯¥è§„åˆ™é“¾å¯ä»¥å¢å¤§é»‘å®¢äººå‘˜ä»å¤–ç½‘å…¥ä¾µå†…ç½‘çš„éš¾åº¦ã€‚ iptablesè¿˜å¯ä»¥é€‰æ‹©é‡‡ç”¨ä»€ä¹ˆæ ·çš„åŠ¨ä½œæ¥å¤„ç†è¿™äº›åŒ¹é…çš„æµé‡ï¼Œæ¯”å¦‚â€œå…è®¸â€ã€â€œæ‹’ç»â€ã€â€œç™»è®°â€ã€â€œä¸ç†å®ƒâ€ã€‚è¿™äº›åŠ¨ä½œå¯¹åº”åˆ°iptablesæœåŠ¡çš„æœ¯è¯­ä¸­åˆ†åˆ«æ˜¯ ACCEPTï¼ˆå…è®¸æµé‡é€šè¿‡ï¼‰ REJECTï¼ˆæ‹’ç»æµé‡é€šè¿‡ï¼‰ï¼š LOGï¼ˆè®°å½•æ—¥å¿—ä¿¡æ¯ï¼‰ DROPï¼ˆæ‹’ç»æµé‡é€šè¿‡ï¼‰ã€‚ â€œå…è®¸æµé‡é€šè¿‡â€å’Œâ€œè®°å½•æ—¥å¿—ä¿¡æ¯â€éƒ½æ¯”è¾ƒå¥½ç†è§£ï¼Œè¿™é‡Œéœ€è¦ç€é‡è®²è§£çš„æ˜¯REJECTå’ŒDROPçš„ä¸åŒç‚¹ã€‚å°±DROPæ¥è¯´ï¼Œå®ƒæ˜¯ç›´æ¥å°†æµé‡ä¸¢å¼ƒè€Œä¸”ä¸å“åº”ï¼›REJECTåˆ™ä¼šåœ¨æ‹’ç»æµé‡åå†å›å¤ä¸€æ¡â€œæ‚¨çš„ä¿¡æ¯å·²ç»æ”¶åˆ°ï¼Œä½†æ˜¯è¢«æ‰”æ‰äº†â€ä¿¡æ¯ï¼Œä»è€Œè®©æµé‡å‘é€æ–¹æ¸…æ™°åœ°çœ‹åˆ°æ•°æ®è¢«æ‹’ç»çš„å“åº”ä¿¡æ¯ã€‚ åŸºæœ¬ä½¿ç”¨iptablesæ˜¯ä¸€æ¬¾åŸºäºå‘½ä»¤è¡Œçš„é˜²ç«å¢™ç­–ç•¥ç®¡ç†å·¥å…·ï¼Œå¯¹äºæ—¥å¸¸çš„é˜²ç«å¢™ç­–ç•¥é…ç½®æ¥è®²ï¼Œåªéœ€è¦æŒæ¡å¸¸ç”¨çš„å‚æ•°å¹¶åšåˆ°çµæ´»æ­é…å³å¯ï¼Œè¿™å°±è¶³ä»¥åº”å¯¹æ—¥å¸¸å·¥ä½œäº†ã€‚ iptableså‘½ä»¤å¯ä»¥æ ¹æ®æµé‡çš„æºåœ°å€ã€ç›®çš„åœ°å€ã€ä¼ è¾“åè®®ã€æœåŠ¡ç±»å‹ç­‰ä¿¡æ¯è¿›è¡ŒåŒ¹é…ï¼Œä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œiptableså°±ä¼šæ ¹æ®ç­–ç•¥è§„åˆ™æ‰€é¢„è®¾çš„åŠ¨ä½œæ¥å¤„ç†è¿™äº›æµé‡ã€‚å¦å¤–ï¼Œå†æ¬¡æé†’ä¸€ä¸‹ï¼Œé˜²ç«å¢™ç­–ç•¥è§„åˆ™çš„åŒ¹é…é¡ºåºæ˜¯ä»ä¸Šè‡³ä¸‹çš„ï¼Œå› æ­¤è¦æŠŠè¾ƒä¸ºä¸¥æ ¼ã€ä¼˜å…ˆçº§è¾ƒé«˜çš„ç­–ç•¥è§„åˆ™æ”¾åˆ°å‰é¢ï¼Œä»¥å…å‘ç”Ÿé”™è¯¯ã€‚ä¸‹è¡¨æ€»ç»“å½’çº³äº†å¸¸ç”¨çš„iptableså‘½ä»¤å‚æ•°ï¼š å‚æ•° ä½œç”¨ -P è®¾ç½®é»˜è®¤ç­–ç•¥ -F æ¸…ç©ºè§„åˆ™é“¾ -L æŸ¥çœ‹è§„åˆ™é“¾ -A åœ¨è§„åˆ™é“¾çš„æœ«å°¾åŠ å…¥æ–°è§„åˆ™ -I num åœ¨è§„åˆ™é“¾çš„å¤´éƒ¨åŠ å…¥æ–°è§„åˆ™ -D num åˆ é™¤æŸä¸€æ¡è§„åˆ™ -s åŒ¹é…æ¥æºåœ°å€IP/MASKï¼ŒåŠ å¹å·â€œ!â€è¡¨ç¤ºé™¤è¿™ä¸ªIPå¤– -d åŒ¹é…ç›®æ ‡åœ°å€ -i ç½‘å¡åç§° åŒ¹é…ä»è¿™å—ç½‘å¡æµå…¥çš„æ•°æ® -o ç½‘å¡åç§° åŒ¹é…ä»è¿™å—ç½‘å¡æµå‡ºçš„æ•°æ® -p åŒ¹é…åè®®ï¼Œå¦‚TCPã€UDPã€ICMP â€“dport num åŒ¹é…ç›®æ ‡ç«¯å£å· â€“sport num åŒ¹é…æ¥æºç«¯å£å· èŒƒä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738// 1. æŸ¥çœ‹å·²æœ‰çš„é˜²ç«å¢™è§„åˆ™é“¾iptables -L// 2. æ¸…ç©ºå·²æœ‰çš„é˜²ç«å¢™è§„åˆ™é“¾iptables -F// 3. æŠŠINPUTè§„åˆ™é“¾çš„é»˜è®¤ç­–ç•¥è®¾ç½®ä¸ºæ‹’ç»(è§„åˆ™é“¾çš„é»˜è®¤ç­–ç•¥æ‹’ç»åŠ¨ä½œåªèƒ½æ˜¯DROPï¼Œè€Œä¸èƒ½æ˜¯REJECT)// ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœä½ æ˜¯åœ¨äº‘æœåŠ¡ä¸Šåšå®éªŒï¼Œåƒä¸‡ä¸è¦è¿™æ ·åšï¼Œå› ä¸ºå®ƒä¼šç”±äºé˜²ç«å¢™æ–­å¼€ä½ çš„sshè¿æ¥ï¼Œåªèƒ½åˆ°æ§åˆ¶å°ç™»å½•ä¿®æ”¹ã€‚iptables -P INPUT DROP// 4. å‘INPUTé“¾ä¸­æ·»åŠ æ‹’ç»ICMPæµé‡è¿›å…¥çš„ç­–ç•¥è§„åˆ™iptables -I INPUT -p icmp -j DROP// 5. åˆ é™¤INPUTè§„åˆ™é“¾ä¸­åˆšåˆšåŠ å…¥çš„é‚£æ¡ç­–ç•¥ï¼ˆå…è®¸ICMPæµé‡ï¼‰iptables -D INPUT 1// 6. å°†INPUTè§„åˆ™é“¾è®¾ç½®ä¸ºåªå…è®¸æŒ‡å®šç½‘æ®µçš„ä¸»æœºè®¿é—®æœ¬æœºçš„22ç«¯å£ï¼Œæ‹’ç»æ¥è‡ªå…¶ä»–æ‰€æœ‰ä¸»æœºçš„æµé‡iptables -I INPUT -s 192.168.10.0/24 -p tcp --dport 22 -j ACCEPT// 7. å‘INPUTè§„åˆ™é“¾ä¸­æ·»åŠ æ‹’ç»æ‰€æœ‰äººè®¿é—®æœ¬æœº12345ç«¯å£çš„ç­–ç•¥è§„åˆ™iptables -I INPUT -p tcp --dport 12345 -j REJECT// 8. å‘INPUTè§„åˆ™é“¾ä¸­æ·»åŠ æ‹’ç»192.168.10.5ä¸»æœºè®¿é—®æœ¬æœº80ç«¯å£ï¼ˆWebæœåŠ¡ï¼‰çš„ç­–ç•¥è§„åˆ™iptables -I INPUT -p tcp -s 192.168.10.5 --dport 80 -j REJECT// 9. å‘INPUTè§„åˆ™é“¾ä¸­æ·»åŠ æ‹’ç»æ‰€æœ‰ä¸»æœºè®¿é—®æœ¬æœº1000ï½1024ç«¯å£çš„ç­–ç•¥è§„åˆ™iptables -A INPUT -p tcp --dport 1000:1024 -j REJECT// 10. ä½¿ç”¨iptableså‘½ä»¤é…ç½®çš„é˜²ç«å¢™è§„åˆ™é»˜è®¤ä¼šåœ¨ç³»ç»Ÿä¸‹ä¸€æ¬¡é‡å¯æ—¶å¤±æ•ˆï¼Œå¦‚æœæƒ³è®©é…ç½®çš„é˜²ç«å¢™ç­–ç•¥æ°¸ä¹…ç”Ÿæ•ˆï¼Œè¿˜è¦æ‰§è¡Œ// ä¿å­˜å‘½ä»¤ï¼šservice iptables save// å¦‚æœå‡ºç°The service command supports only basic LSB actions (start, stop, restart, try-restart, reload, force-reload, status). For other actions, please try to use systemctl.éœ€è¦å¦‚ä¸‹æ“ä½œï¼šyum install iptables-services // å®‰è£…æœåŠ¡systemctl enable iptables // è®¾ç½®å¼€æœºå¯åŠ¨iptablessystemctl start iptables //æ‰“å¼€iptablesç„¶åæ‰§è¡Œå°±å¯ä»¥äº† FirewalldCentos7ç³»ç»Ÿä¸­é›†æˆäº†å¤šæ¬¾é˜²ç«å¢™ç®¡ç†å·¥å…·ï¼Œå…¶ä¸­firewalldï¼ˆDynamic Firewall Manager of Linux systemsï¼ŒLinuxç³»ç»Ÿçš„åŠ¨æ€é˜²ç«å¢™ç®¡ç†å™¨ï¼‰æœåŠ¡æ˜¯é»˜è®¤çš„é˜²ç«å¢™é…ç½®ç®¡ç†å·¥å…·ï¼Œå®ƒæ‹¥æœ‰åŸºäºCLIï¼ˆå‘½ä»¤è¡Œç•Œé¢ï¼‰å’ŒåŸºäºGUIï¼ˆå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰çš„ä¸¤ç§ç®¡ç†æ–¹å¼ã€‚ä½†æ˜¯æˆ‘ä»¬åªä»‹ç»å‘½ä»¤è¡Œç•Œé¢ã€‚ åŒºåŸŸZoneç›¸è¾ƒäºä¼ ç»Ÿçš„é˜²ç«å¢™ç®¡ç†é…ç½®å·¥å…·ï¼Œfirewalldæ”¯æŒåŠ¨æ€æ›´æ–°æŠ€æœ¯å¹¶åŠ å…¥äº†åŒºåŸŸï¼ˆzoneï¼‰çš„æ¦‚å¿µã€‚ç®€å•æ¥è¯´ï¼ŒåŒºåŸŸå°±æ˜¯firewalldé¢„å…ˆå‡†å¤‡äº†å‡ å¥—é˜²ç«å¢™ç­–ç•¥é›†åˆï¼ˆç­–ç•¥æ¨¡æ¿ï¼‰ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ç”Ÿäº§åœºæ™¯çš„ä¸åŒè€Œé€‰æ‹©åˆé€‚çš„ç­–ç•¥é›†åˆï¼Œä»è€Œå®ç°é˜²ç«å¢™ç­–ç•¥ä¹‹é—´çš„å¿«é€Ÿåˆ‡æ¢ã€‚ä»è€Œæå¤§åœ°æå‡äº†é˜²ç«å¢™ç­–ç•¥çš„åº”ç”¨æ•ˆç‡ã€‚firewalldä¸­å¸¸è§çš„åŒºåŸŸåç§°ï¼ˆé»˜è®¤ä¸ºpublicï¼‰ä»¥åŠç›¸åº”çš„ç­–ç•¥è§„åˆ™å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š åŒºåŸŸ é»˜è®¤è§„åˆ™ç­–ç•¥ trusted å…è®¸æ‰€æœ‰çš„æ•°æ®åŒ… home æ‹’ç»æµå…¥çš„æµé‡ï¼Œé™¤éä¸æµå‡ºçš„æµé‡ç›¸å…³ï¼›è€Œå¦‚æœæµé‡ä¸sshã€mdnsã€ipp-clientã€amba-clientä¸dhcpv6-clientæœåŠ¡ç›¸å…³ï¼Œåˆ™å…è®¸æµé‡ internal ç­‰åŒäºhomeåŒºåŸŸ work æ‹’ç»æµå…¥çš„æµé‡ï¼Œé™¤éä¸æµå‡ºçš„æµé‡æ•°ç›¸å…³ï¼›è€Œå¦‚æœæµé‡ä¸sshã€ipp-clientä¸dhcpv6-clientæœåŠ¡ç›¸å…³ï¼Œåˆ™å…è®¸æµé‡ public æ‹’ç»æµå…¥çš„æµé‡ï¼Œé™¤éä¸æµå‡ºçš„æµé‡ç›¸å…³ï¼›è€Œå¦‚æœæµé‡ä¸sshã€dhcpv6-clientæœåŠ¡ç›¸å…³ï¼Œåˆ™å…è®¸æµé‡ external æ‹’ç»æµå…¥çš„æµé‡ï¼Œé™¤éä¸æµå‡ºçš„æµé‡ç›¸å…³ï¼›è€Œå¦‚æœæµé‡ä¸sshæœåŠ¡ç›¸å…³ï¼Œåˆ™å…è®¸æµé‡ dmz æ‹’ç»æµå…¥çš„æµé‡ï¼Œé™¤éä¸æµå‡ºçš„æµé‡ç›¸å…³ï¼›è€Œå¦‚æœæµé‡ä¸sshæœåŠ¡ç›¸å…³ï¼Œåˆ™å…è®¸æµé‡ block æ‹’ç»æµå…¥çš„æµé‡ï¼Œé™¤éä¸æµå‡ºçš„æµé‡ç›¸å…³ drop æ‹’ç»æµå…¥çš„æµé‡ï¼Œé™¤éä¸æµå‡ºçš„æµé‡ç›¸å…³ åŸºæœ¬ä½¿ç”¨ï¼šfirewall-cmdfirewall-cmdæ˜¯firewalldé˜²ç«å¢™é…ç½®ç®¡ç†å·¥å…·çš„CLIï¼ˆå‘½ä»¤è¡Œç•Œé¢ï¼‰ç‰ˆæœ¬ã€‚å®ƒçš„å‚æ•°ä¸€èˆ¬éƒ½æ˜¯ä»¥â€œé•¿æ ¼å¼â€æ¥æä¾›çš„ï¼Œä½†æ˜¯Centos7æ”¯æŒéƒ¨åˆ†å‘½ä»¤çš„å‚æ•°è¡¥é½ï¼Œå…¶ä¸­å°±åŒ…å«è¿™æ¡å‘½ä»¤ï¼Œç¾æ»‹æ»‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç°åœ¨é™¤äº†èƒ½ç”¨Tabé”®è‡ªåŠ¨è¡¥é½å‘½ä»¤æˆ–æ–‡ä»¶åç­‰å†…å®¹ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨Tabé”®æ¥è¡¥é½ä¸‹è¡¨ä¸­æ‰€ç¤ºçš„é•¿æ ¼å¼å‚æ•°äº†ï¼š å‚æ•° ä½œç”¨ â€“get-default-zone æŸ¥è¯¢é»˜è®¤çš„åŒºåŸŸåç§° â€“set-default-zone=&lt;åŒºåŸŸåç§°&gt; è®¾ç½®é»˜è®¤çš„åŒºåŸŸï¼Œä½¿å…¶æ°¸ä¹…ç”Ÿæ•ˆ â€“get-zones æ˜¾ç¤ºå¯ç”¨çš„åŒºåŸŸ â€“get-services æ˜¾ç¤ºé¢„å…ˆå®šä¹‰çš„æœåŠ¡ â€“get-active-zones æ˜¾ç¤ºå½“å‰æ­£åœ¨ä½¿ç”¨çš„åŒºåŸŸä¸ç½‘å¡åç§° â€“remove-source= å°†æºè‡ªæ­¤IPæˆ–å­ç½‘çš„æµé‡å¯¼å‘æŒ‡å®šçš„åŒºåŸŸ â€“remove-source= ä¸å†å°†æºè‡ªæ­¤IPæˆ–å­ç½‘çš„æµé‡å¯¼å‘æŸä¸ªæŒ‡å®šåŒºåŸŸ â€“add-interface=&lt;ç½‘å¡åç§°&gt; å°†æºè‡ªè¯¥ç½‘å¡çš„æ‰€æœ‰æµé‡éƒ½å¯¼å‘æŸä¸ªæŒ‡å®šåŒºåŸŸ â€“change-interface=&lt;ç½‘å¡åç§°&gt; å°†æŸä¸ªç½‘å¡ä¸åŒºåŸŸè¿›è¡Œå…³è” â€“list-all æ˜¾ç¤ºå½“å‰åŒºåŸŸçš„ç½‘å¡é…ç½®å‚æ•°ã€èµ„æºã€ç«¯å£ä»¥åŠæœåŠ¡ç­‰ä¿¡æ¯ â€“list-all-zones æ˜¾ç¤ºæ‰€æœ‰åŒºåŸŸçš„ç½‘å¡é…ç½®å‚æ•°ã€èµ„æºã€ç«¯å£ä»¥åŠæœåŠ¡ç­‰ä¿¡æ¯ â€“add-service=&lt;æœåŠ¡å&gt; è®¾ç½®é»˜è®¤åŒºåŸŸå…è®¸è¯¥æœåŠ¡çš„æµé‡ â€“add-port=&lt;ç«¯å£å·/åè®®&gt; è®¾ç½®é»˜è®¤åŒºåŸŸå…è®¸è¯¥ç«¯å£çš„æµé‡ â€“remove-service=&lt;æœåŠ¡å&gt; è®¾ç½®é»˜è®¤åŒºåŸŸä¸å†å…è®¸è¯¥æœåŠ¡çš„æµé‡ â€“remove-port=&lt;ç«¯å£å·/åè®®&gt; è®¾ç½®é»˜è®¤åŒºåŸŸä¸å†å…è®¸è¯¥ç«¯å£çš„æµé‡ â€“reload è®©â€œæ°¸ä¹…ç”Ÿæ•ˆâ€çš„é…ç½®è§„åˆ™ç«‹å³ç”Ÿæ•ˆï¼Œå¹¶è¦†ç›–å½“å‰çš„é…ç½®è§„åˆ™ â€“panic-on å¼€å¯åº”æ€¥çŠ¶å†µæ¨¡å¼ â€“panic-off å…³é—­åº”æ€¥çŠ¶å†µæ¨¡å¼ ä¸Linuxç³»ç»Ÿä¸­å…¶ä»–çš„é˜²ç«å¢™ç­–ç•¥é…ç½®å·¥å…·ä¸€æ ·ï¼Œä½¿ç”¨firewalldé…ç½®çš„é˜²ç«å¢™ç­–ç•¥é»˜è®¤ä¸ºè¿è¡Œæ—¶ï¼ˆRuntimeï¼‰æ¨¡å¼ï¼Œåˆç§°ä¸ºå½“å‰ç”Ÿæ•ˆæ¨¡å¼ï¼Œè€Œä¸”éšç€ç³»ç»Ÿçš„é‡å¯ä¼šå¤±æ•ˆã€‚å¦‚æœæƒ³è®©é…ç½®ç­–ç•¥ä¸€ç›´å­˜åœ¨ï¼Œå°±éœ€è¦ä½¿ç”¨æ°¸ä¹…ï¼ˆPermanentï¼‰æ¨¡å¼äº†ï¼Œæ–¹æ³•å°±æ˜¯åœ¨ç”¨firewall-cmdå‘½ä»¤æ­£å¸¸è®¾ç½®é˜²ç«å¢™ç­–ç•¥æ—¶æ·»åŠ â€“permanentå‚æ•°ï¼Œè¿™æ ·é…ç½®çš„é˜²ç«å¢™ç­–ç•¥å°±å¯ä»¥æ°¸ä¹…ç”Ÿæ•ˆäº†ã€‚ä½†æ˜¯ä½¿ç”¨æ°¸ä¹…ç”Ÿæ•ˆæ¨¡å¼è®¾ç½®çš„ç­–ç•¥åªæœ‰åœ¨ç³»ç»Ÿé‡å¯ä¹‹åæ‰èƒ½è‡ªåŠ¨ç”Ÿæ•ˆã€‚å¦‚æœæƒ³è®©é…ç½®çš„ç­–ç•¥ç«‹å³ç”Ÿæ•ˆï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œfirewall-cmd â€“reloadå‘½ä»¤ã€‚ ä½¿ç”¨èŒƒä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344// 1. æŸ¥çœ‹firewalldæœåŠ¡å½“å‰æ‰€ä½¿ç”¨çš„åŒºåŸŸfirewall-cmd --get-default-zone// 2. æŸ¥è¯¢eth0ç½‘å¡åœ¨firewalldæœåŠ¡ä¸­çš„åŒºåŸŸfirewall-cmd --get-zone-of-interface=eth0// 3. æŠŠfirewalldæœåŠ¡ä¸­eth0ç½‘å¡çš„é»˜è®¤åŒºåŸŸä¿®æ”¹ä¸ºexternalï¼Œå¹¶åœ¨ç³»ç»Ÿé‡å¯åç”Ÿæ•ˆã€‚// åˆ†åˆ«æŸ¥çœ‹å½“å‰ä¸æ°¸ä¹…æ¨¡å¼ä¸‹çš„åŒºåŸŸåç§°ï¼šfirewall-cmd --permanent --zone=external --change-interface=eth0firewall-cmd --get-zone-of-interface=eth0firewall-cmd --permanent --get-zone-of-interface=eth0// 4. æŠŠfirewalldæœåŠ¡çš„å½“å‰é»˜è®¤åŒºåŸŸè®¾ç½®ä¸ºpublicfirewall-cmd --set-default-zone=public// 5. å¯åŠ¨/å…³é—­firewalldé˜²ç«å¢™æœåŠ¡çš„åº”æ€¥çŠ¶å†µæ¨¡å¼ï¼Œé˜»æ–­ä¸€åˆ‡ç½‘ç»œè¿æ¥ï¼ˆå½“è¿œç¨‹æ§åˆ¶æœåŠ¡å™¨æ—¶è¯·æ…ç”¨ï¼‰firewall-cmd --panic-onfirewall-cmd --panic-off// 6. æŸ¥è¯¢publicåŒºåŸŸæ˜¯å¦å…è®¸è¯·æ±‚SSHå’ŒHTTPSåè®®çš„æµé‡firewall-cmd --zone=public --query-service=sshfirewall-cmd --zone=public --query-service=https// 7. æŠŠfirewalldæœåŠ¡ä¸­è¯·æ±‚HTTPSåè®®çš„æµé‡è®¾ç½®ä¸ºæ°¸ä¹…å…è®¸ï¼Œå¹¶ç«‹å³ç”Ÿæ•ˆfirewall-cmd --zone=public --add-service=httpsfirewall-cmd --permanent --zone=public --add-service=httpsfirewall-cmd --reload// 8. æŠŠfirewalldæœåŠ¡ä¸­è¯·æ±‚HTTPåè®®çš„æµé‡è®¾ç½®ä¸ºæ°¸ä¹…æ‹’ç»ï¼Œå¹¶ç«‹å³ç”Ÿæ•ˆfirewall-cmd --permanent --zone=public --remove-service=httpfirewall-cmd --reload// 9. æŠŠåœ¨firewalldæœåŠ¡ä¸­è®¿é—®8080å’Œ8081ç«¯å£çš„æµé‡ç­–ç•¥è®¾ç½®ä¸ºå…è®¸ï¼Œä½†ä»…é™å½“å‰ç”Ÿæ•ˆfirewall-cmd --zone=public --add-port=8080-8081/tcp// 10. æŠŠåŸæœ¬è®¿é—®æœ¬æœº888ç«¯å£çš„æµé‡è½¬å‘åˆ°22ç«¯å£ï¼Œè¦ä¸”æ±‚å½“å‰å’Œé•¿æœŸå‡æœ‰æ•ˆfirewall-cmd --permanent --zone=public --add-forward-port=port=888:proto=tcp:toport=22:toaddr=192.168.10.10(ç›®æ ‡åœ°å€)firewall-cmd --reload// 11. firewalldä¸­çš„å¯Œè§„åˆ™è¡¨ç¤ºæ›´ç»†è‡´ã€æ›´è¯¦ç»†çš„é˜²ç«å¢™ç­–ç•¥é…ç½®ï¼Œ// å®ƒå¯ä»¥é’ˆå¯¹ç³»ç»ŸæœåŠ¡ã€ç«¯å£å·ã€æºåœ°å€å’Œç›®æ ‡åœ°å€ç­‰è¯¸å¤šä¿¡æ¯è¿›è¡Œæ›´æœ‰é’ˆå¯¹æ€§çš„ç­–ç•¥é…ç½®ã€‚// å®ƒçš„ä¼˜å…ˆçº§åœ¨æ‰€æœ‰çš„é˜²ç«å¢™ç­–ç•¥ä¸­ä¹Ÿæ˜¯æœ€é«˜çš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨firewalldæœåŠ¡ä¸­é…ç½®ä¸€æ¡å¯Œè§„åˆ™ï¼Œä½¿å…¶æ‹’ç»192.168.10.0/24ç½‘æ®µçš„æ‰€æœ‰ç”¨æˆ·è®¿é—®æœ¬æœºçš„sshæœåŠ¡ï¼ˆ22ç«¯å£ï¼‰ï¼šfirewall-cmd --permanent --zone=public --add-rich-rule=&quot;rule family=&quot;ipv4&quot; \source address=&quot;192.168.10.0/24&quot; service name=&quot;ssh&quot; reject&quot; å‚è€ƒ iptablesä¸firewalldé˜²ç«å¢™]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_Linuxä¸­å¸¸ç”¨çš„ç½‘ç»œå‘½ä»¤]]></title>
    <url>%2F2018%2F04%2F08%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_Linux%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E7%BD%91%E7%BB%9C%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šLinuxçš„ç½‘ç»œåŠŸèƒ½æ˜¯ç›¸å½“å¼ºå¤§çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»è¦å¥½å¥½äº†è§£å®ƒï¼Œè¿™é‡Œæˆ‘ä»¬åªæ˜¯ä»‹ç»ä¸€ä¸‹å¸¸ç”¨çš„å‘½ä»¤ã€‚ è®¾ç½®ç½‘ç»œå‚æ•°çš„å‘½ä»¤ipconfigifconfigä¸»è¦æ˜¯å¯ä»¥éƒ½æ‰‹åŠ¨å¯åŠ¨ã€æŸ¥çœ‹ä¸ä¿®æ”¹ç½‘ç»œæ¥å£çš„ç›¸å…³å‚æ•°ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425// 1. æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£ifconfig// 2. æŸ¥çœ‹eth0ç½‘å¡ifconfig eth0è¾“å‡ºï¼šeth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500 inet 172.16.0.9 netmask 255.255.240.0 broadcast 172.16.15.255 ether 52:54:00:1c:91:2a txqueuelen 1000 (Ethernet) RX packets 15979545 bytes 1741444280 (1.6 GiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 15811187 bytes 2149680103 (2.0 GiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0* eth0ï¼šå°±æ˜¯ç½‘ç»œå¡çš„ä»£å·ï¼Œä¹Ÿæœ‰ lo è¿™ä¸ª loopback* mtuï¼šç½‘ç»œæ¥å£çš„æœ€å¤§ä¼ è¾“å•å…ƒ* inetï¼šIPv4 çš„ IP åœ°å€ï¼Œåç»­æ˜¯å­ç½‘æ©ç å’Œå¹¿æ’­åœ°å€* RXï¼šé‚£ä¸€è¡Œä»£è¡¨çš„æ˜¯ç½‘ç»œç”±å¯åŠ¨åˆ°ç›®å‰ä¸ºæ­¢çš„å°åŒ…æ¥æ”¶æƒ…å†µï¼Œ packets ä»£è¡¨å°åŒ…æ•°ã€errors ä»£è¡¨å°åŒ…å‘ç”Ÿé”™è¯¯çš„æ•°é‡ã€ dropped ä»£è¡¨å°åŒ…ç”±äºæœ‰é—®é¢˜è€Œé­ä¸¢å¼ƒçš„æ•°é‡ç­‰ç­‰* TXï¼šä¸ RX ç›¸åï¼Œä¸ºç½‘ç»œç”±å¯åŠ¨åˆ°ç›®å‰ä¸ºæ­¢çš„ä¼ é€æƒ…å†µï¼›collisionsï¼šä»£è¡¨å°åŒ…ç¢°æ’çš„æƒ…å†µï¼Œå¦‚æœå‘ç”Ÿå¤ªå¤šæ¬¡ï¼Œ è¡¨ç¤ºæ‚¨çš„ç½‘ç»œçŠ¶å†µä¸å¤ªå¥½// 3. æš‚æ—¶ä¿®æ”¹ç½‘ç»œæ¥å£ï¼Œç»™äºˆeth0ä¸€ä¸ª192.168.100.100/24çš„å‚æ•°ifconfig eth0 192.168.100.100// 4. å°†æ‰‹åŠ¨çš„å¤„ç†å…¨éƒ¨å–æ¶ˆï¼Œä½¿ç”¨åŸæœ‰çš„è®¾ç½®å€¼é‡ç½®ç½‘ç»œå‚æ•°/etc/init.d/network restart ç½‘ç»œæ’é”™ä¸æŸ¥çœ‹å‘½ä»¤pingè¿™ä¸ª ping æ˜¯å¾ˆé‡è¦çš„æŒ‡ä»¤ï¼Œping ä¸»è¦é€è¿‡ ICMPï¼ˆInternetæ§åˆ¶æŠ¥æ–‡åè®®ï¼‰ å°åŒ…æ¥è¿›è¡Œæ•´ä¸ªç½‘ç»œçš„çŠ¶å†µæŠ¥å‘Šã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š12345678910111213141516// 1. æ£€æµ‹ä¸€ä¸‹168.95.1.1è¿™éƒ¨DNSä¸»æœºæ˜¯å¦å­˜åœ¨(å­˜åœ¨äºç½‘ç»œç¯å¢ƒä¸­)ping -c 3 168.95.1.1è¾“å‡ºï¼šPING 168.95.1.1 (168.95.1.1) 56(84) bytes of data.64 bytes from 168.95.1.1: icmp_seq=1 ttl=239 time=69.9 ms64 bytes from 168.95.1.1: icmp_seq=2 ttl=239 time=70.4 ms64 bytes from 168.95.1.1: icmp_seq=3 ttl=239 time=69.9 ms--- 168.95.1.1 ping statistics ---3 packets transmitted, 3 received, 0% packet loss, time 2002msrtt min/avg/max/mdev = 69.920/70.119/70.467/0.328 ms// 2. æ‰¾å‡ºæœ€å¤§çš„MTUæ•°å€¼(å¦‚æœæœ‰å“åº”ï¼Œé‚£å°±æ˜¯å¯ä»¥æ¥å—è¿™ä¸ªæ•°æ®åŒ…ï¼Œå¦‚æœæ— å“åº”ï¼Œå°±è¡¨ç¤ºè¿™ä¸ªMTUå¤ªå¤§äº†)ping -c 2 -s 1000 -M do 192.168.1.254 netstatå¦‚æœä½ è§‰å¾—ä½ çš„æŸä¸ªç½‘ç»œæœåŠ¡æ˜æ˜å°±å¯åŠ¨äº†ï¼Œä½†æ˜¯å°±æ˜¯æ— æ³•é€ æˆè”æœºçš„è¯ï¼Œè¦æŸ¥è¯¢ä¸€ä¸‹è‡ªå·±çš„ç½‘ç»œæ¥å£æ‰€ç›‘å¬çš„ç«¯å£ (port) æ¥çœ‹çœ‹æ˜¯å¦çœŸçš„æœ‰å¯åŠ¨ã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š1234567891011// 1. åˆ—å‡ºå½“å‰è·¯ç”±è¡¨çŠ¶æ€ï¼Œä¸”ä»¥IPåŠport numberè¿›è¡Œç³»é‚£æ˜¯netstat -rn// 2. åˆ—å‡ºå½“å‰çš„æ‰€æœ‰ç½‘ç»œè¿æ¥çŠ¶æ€ï¼Œä½¿ç”¨IPä¸port numbernetstat -an// 3. æ˜¾ç¤ºç›®å‰å·²ç»å¯åŠ¨çš„ç½‘ç»œæœåŠ¡netstat -tulnp// 4. æŸ¥çœ‹æœ¬æœºä¸Šæ‰€æœ‰çš„ç½‘ç»œè¿æ¥çŠ¶æ€netstat -atunp hostè¿™ä¸ªå‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥å‡ºæŸä¸ªä¸»æœºåçš„IPï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š12// 1. åˆ—å‡ºwww.yahoo.comçš„IP(å‘/etc/resolv.confé‡Œé¢è®°å½•çš„DNSæœåŠ¡å™¨æŸ¥è¯¢IP)host www.yohoo.com nslookupåŠŸèƒ½å’Œhostä¸€æ ·ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 12345// 1. æŸ¥è¯¢www.google.comçš„IPnslookup www.google.com// 2. æ‰¾å‡º168.95.1.1çš„ä¸»æœºå (å»ºè®®ä½¿ç”¨dig)nslookup 168.95.1.1 è¿œç¨‹è¿æ¥å‘½ä»¤ä¸å³æ—¶é€šä¿¡è½¯ä»¶telnettelnetæœ¬èº«æ•°æ®çš„åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä½¿ç”¨çš„æ˜¯æ˜æ–‡ï¼Œæ‰€ä»¥æ•°æ®åœ¨Internetä¸Šé¢ä¼ è¾“çš„æ—¶å€™ï¼Œä¼šæ¯”è¾ƒå±é™©ã€‚ä½¿ç”¨èŒƒä¾‹å¦‚ä¸‹ï¼š123456// 1. è¿æ¥åˆ°å½“å‰çƒ­é—¨çš„PTT BBSç«™ç‚¹ptt.ccyum install telnet // é»˜è®¤æ²¡æœ‰å®‰è£…ï¼ˆè‡ªå·±æœªæˆåŠŸï¼‰// 2. æ£€æµ‹æœ¬åœ°ä¸»æœºçš„110è¿™ä¸ªportæ˜¯å¦æ­£ç¡®å¯åŠ¨,// å¦‚æœå‡ºç°telnet: connect to address 127.0.0.1: Connection refusedï¼Œä»£è¡¨è¿™ä¸ªportæ²¡æœ‰å¯åŠ¨æˆ–è€…è¿™ä¸ªè¿æ¥æœ‰é—®é¢˜telnet localhost 22 ftpç”¨äºå¤„ç†ftpæœåŠ¡å™¨çš„ä¸‹è½½æ•°æ®ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š12// 1. è¿æ¥åˆ°ä¸€ä¸ªftpæœåŠ¡å™¨ftp ip //ä¹‹åå¯ä»¥åˆ©ç”¨helpæ¥å¸®åŠ©æ“ä½œ æ–‡å­—æ¥å£ç½‘é¡µæµè§ˆlinksæœ€å¤§çš„åŠŸèƒ½å°±æ˜¯æŸ¥é˜…Linuxæœ¬æœºä¸Šé¢ä»¥htmlè¯­æ³•å†™æˆçš„æ–‡ä»¶æ•°æ®ã€‚å…·ä½“æ•ˆæœè‡ªå·±çœ‹å§ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š12// 1. æµè§ˆLinux kernelç½‘ç«™links http://www.kernel.org wgetä¸»è¦çš„åŠŸèƒ½æ˜¯å–å¾—ç½‘é¡µæ•°æ®ã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š123// 1. ä¸‹è½½ 2.6.17 ç‰ˆçš„linuxå†…æ ¸wget \http://www.kernel.org/pub/linux/kernel/v2.6/linux-2.6.17.tar.gz å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_è½¯ä»¶å®‰è£…]]></title>
    <url>%2F2018%2F04%2F08%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85-%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå½“ä½ æ‹¿åˆ°ä¸€å°æ–°ç”µè„‘çš„ç¬¬ä¸€ååº”æ˜¯ä»€ä¹ˆï¼Œå½“ç„¶æ˜¯è£…è½¯ä»¶ï¼Œç„¶åå¥½å¥½ç©å‘€ï¼æœåŠ¡å™¨ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥ä½ å¿…é¡»æŒæ¡è½¯ä»¶çš„å®‰è£…ã€‚ æºç å®‰è£…å¼€æ”¾æºç çš„è½¯ä»¶å®‰è£…ç›¸å…³æ¦‚å¿µLinuxä¸Šå‡ ä¹æ‰€æœ‰çš„è½¯ä»¶éƒ½ç»è¿‡äº†GPLæˆæƒï¼Œå› æ­¤å‡ ä¹æ‰€æœ‰çš„è½¯ä»¶éƒ½ä¼šæä¾›æºç ã€‚è€Œä¸€ä¸ªè½¯ä»¶è¦åœ¨Linuxä¸Šæ‰§è¡Œï¼Œå¿…é¡»æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤å½“æˆ‘ä»¬æ‹¿åˆ°è½¯ä»¶æºç åï¼Œéœ€è¦å°†å®ƒç¼–è¯‘æˆäºŒè¿›åˆ¶æ–‡ä»¶æ‰èƒ½åœ¨Linuxä¸Šè¿è¡Œã€‚ å¼€æ”¾æºç ã€ç¼–è¯‘ç¨‹åºã€å¯æ‰§è¡Œæ–‡ä»¶ å¼€æ”¾æºç ï¼šå°±æ˜¯ç¨‹åºä»£ç ï¼Œå†™ç»™äººç±»çœ‹çš„è¯­è¨€ï¼Œä½†æœºå™¨å¹¶ä¸è®¤è¯†ï¼Œæ‰€ä»¥æ— æ³•æ‰§è¡Œã€‚ ç¼–è¯‘ç¨‹åºï¼šå°†ç¨‹åºä»£ç è½¬è¯‘ç§°ä¸ºæœºå™¨çœ‹å¾—æ‡‚çš„è¯­è¨€ã€‚ å¯æ‰§è¡Œæ–‡ä»¶ï¼šç»è¿‡ç¼–è¯‘ç¨‹åºå˜æˆäºŒè¿›åˆ¶ç¨‹åºåï¼Œæœºå™¨çœ‹å¾—æ‡‚æ‰€ä»¥å¯æ‰§è¡Œçš„æ–‡ä»¶ã€‚ å‡½å¼åº“ç±»ä¼¼å­ç¨‹åºçš„è§’è‰²ï¼Œå¯ä»¥è¢«å‘¼å«æ¥æ‰§è¡Œçš„ä¸€æ®µåŠŸèƒ½å‡½æ•°ã€‚ makeä¸configure configure:ä¾¦æµ‹ç”¨æˆ·æ“ä½œç¯å¢ƒï¼Œæ˜¯å¦æ”¯æŒè½¯ä»¶çš„è¿è¡Œï¼Œä¾¦æµ‹å®Œæ¯•ç”Ÿæˆmakefileæ–‡ä»¶ æ˜¯å¦æœ‰é€‚åˆçš„ç¼–è¯‘ç¨‹åºå¯ä»¥ç¼–è¯‘æœ¬è½¯ä»¶çš„ç¨‹åºä»£ç  æ˜¯å¦å·²ç»å­˜åœ¨æœ¬è½¯ä»¶æ‰€éœ€è¦çš„å‡½æ•°åº“ï¼Œæˆ–å…¶ä»–éœ€è¦çš„ç›¸ä¾è½¯ä»¶ æ“ä½œç³»ç»Ÿå¹³å°æ˜¯å¦é€‚åˆæœ¬è½¯ä»¶ï¼ŒåŒ…æ‹¬ Linux çš„æ ¸å¿ƒç‰ˆæœ¬ æ ¸å¿ƒçš„å¤´æ–‡ä»¶å®šä¹‰æ¡£ (header include) æ˜¯å¦å­˜åœ¨ (é©±åŠ¨ç¨‹åºå¿…é¡»è¦çš„ä¾¦æµ‹)ã€‚ make:makeæ˜¯ä¸€ä¸ªç¨‹åºï¼Œä¼šå»æ‰¾makefileæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œç¼–è¯‘ã€‚ tarballè½¯ä»¶tarballæ–‡ä»¶å…¶å®å°±æ˜¯å°†è½¯ä»¶çš„æºç å…ˆä»¥taræ‰“åŒ…ï¼Œç„¶åå†å‹ç¼©ã€‚å…¶å®å°±æ˜¯ä¸€ä¸ªè½¯ä»¶åŒ…ã€‚é€šå¸¸è§£å‹ç¼©ä¹‹åä¼šå­˜åœ¨æºä»£ç æ–‡ä»¶ã€ä¾¦æµ‹ç¨‹åºæ–‡ä»¶ï¼ˆconfigureï¼‰ã€æœ¬è½¯ä»¶çš„ç®€æ˜“è¯´æ˜ä¸å®‰è£…è¯´æ˜ï¼ˆREADMEï¼‰ã€‚ Tarballçš„å®‰è£…çš„åŸºæœ¬æ­¥éª¤ å–å¾—æºæ–‡ä»¶ï¼šå°†tarballæ–‡ä»¶åœ¨/usr/local/srcç›®å½•è§£å‹ç¼© å–å¾—æ­¥éª¤æµç¨‹ï¼šè¿›å…¥æ–°å»ºç«‹çš„ç›®å½•ä¸‹é¢ï¼Œå»æŸ¥é˜…INSTALLä¸READMEç­‰ç›¸å…³æ–‡ä»¶å†…å®¹ï¼ˆå¾ˆé‡è¦ï¼‰ ç›¸å…³å±æ€§è½¯ä»¶å®‰è£…ï¼šæ ¹æ®INSTALL/READMEçš„å†…å®¹æŸ¥çœ‹å¹¶å®‰è£…å¥½ä¸€äº›ç›¸å…³çš„è½¯ä»¶ å»ºç«‹makefileæ–‡ä»¶ï¼šä»¥è‡ªåŠ¨æ£€æµ‹ç¨‹åºï¼ˆconfigureï¼‰æ£€æµ‹æ“ä½œç¯å¢ƒï¼Œå¹¶å»ºç«‹Makefileæ–‡ä»¶ ç¼–è¯‘ï¼šä»¥makeè¿™ä¸ªç¨‹åºå¹¶ä½¿ç”¨è¯¥ç›®å½•ä¸‹å¾—Makefileä½œä¸ºå®ƒçš„å‚æ•°é…ç½®æ–‡ä»¶ï¼Œæ¥è¿›è¡Œmakeçš„æ“ä½œ å®‰è£…ï¼šä»¥makeè¿™ä¸ªç¨‹åºï¼Œå¹¶ä»¥Makefileè¿™ä¸ªå‚æ•°é…ç½®æ–‡ä»¶ï¼Œä¾æ®installè¿™ä¸ªç›®æ ‡ï¼ˆåœ¨Makefileæ–‡ä»¶ä¸­ä¼šæœ‰å¤šä¸ªæ“ä½œç›®æ ‡ï¼Œå¦‚cleanï¼‰çš„æŒ‡å®šæ¥å®‰è£…åˆ°æ­£ç¡®åœ°è·¯å¾„ã€‚ Tarballè½¯ä»¶å®‰è£…çš„å»ºè®®äº‹é¡¹åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸæœ¬çš„Linux distributionå‘å¸ƒå®‰è£…çš„è½¯ä»¶å¤§å¤šæ˜¯åœ¨/usré‡Œé¢çš„ï¼Œè€Œè‡ªè¡Œå®‰è£…çš„è½¯ä»¶åˆ™å»ºè®®æ”¾ç½®åœ¨/usr/localé‡Œé¢ã€‚ linux distributioné»˜è®¤çš„å®‰è£…è½¯ä»¶çš„è·¯å¾„å¦‚ä¸‹ï¼Œä»¥httpdä¸ºä¾‹ï¼š /etc/httpdï¼ˆé…ç½®æ–‡ä»¶ï¼‰ /usr/libï¼ˆå‡½æ•°åº“ï¼‰ /usr/binï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ /usr/share/manï¼ˆåœ¨çº¿å¸®åŠ©æ–‡æ¡£ï¼‰ tarballå®‰è£…ï¼Œé»˜è®¤æ”¾åœ¨/usr/localï¼Œå¦‚ä¸‹ç›®å½•ï¼šï¼ˆå‡çº§ï¼Œåˆ é™¤ä¸æ–¹ä¾¿ï¼‰ /usr/local/etc /usr/local/bin /usr/local/lib /usr/local/man tarballå®‰è£…ï¼Œä½†æ˜¯å•ä¸€è½¯ä»¶éƒ½åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œä»¥apacheä¸ºä¾‹ï¼šï¼ˆåˆ©äºåˆ é™¤ï¼Œå‡çº§ï¼‰ /usr/local/apache/etc /usr/local/apache/bin /usr/local/apache/lib /usr/local/apache/man å½“ç„¶ï¼Œå®é™…å®‰è£…çš„æ—¶å€™è¿˜æ˜¯å¾—è§†è¯¥è½¯ä»¶çš„Makefileé‡Œå¤´çš„installç›®æ ‡ä¿¡æ¯æ‰èƒ½çŸ¥é“å®‰è£…è·¯å¾„æƒ…å†µã€‚ ä¸ºäº†æ–¹ä¾¿Tarballçš„ç®¡ç†ï¼Œè¿™æ ·å»ºè®®ï¼š æœ€å¥½å°†tarballçš„åŸå§‹æ•°æ®è§£å‹ç¼©åˆ°/usr/local/srcå½“ä¸­ å®‰è£…æ—¶ï¼Œæœ€å¥½å®‰è£…åˆ°/usr/localè¿™ä¸ªé»˜è®¤è·¯å¾„ä¸‹ è€ƒè™‘å°†æ¥çš„åˆ é™¤ï¼Œæœ€å¥½å¯ä»¥å°†æ¯ä¸ªè½¯ä»¶å•ç‹¬å®‰è£…åœ¨/usr/localä¸‹é¢ ä¸ºå®‰è£…åˆ°å•ç‹¬ç›®å½•çš„è½¯ä»¶çš„man pageåŠ å…¥åˆ°man pathæœç´¢ï¼Œå³åœ¨/etc/man.configå¢åŠ ä¸€è¡Œã€‚ ç®€å•å®‰è£…èŒƒä¾‹ï¼ˆntpæ—¶é—´æœåŠ¡å™¨ï¼‰å‡è®¾è¿™ä¸ªè½¯ä»¶åœ¨/optä¸‹ï¼Œè§£å‹åˆ°/usr/local/srcï¼Œå¹¶å®‰è£…åˆ°/usr/local/ntpç›®å½•ä¸‹ã€‚12345678910111213141516171819cd /usr/local/src //åˆ‡æ¢ç›®å½•tar -zxvf /opt/ntp-4.2.4p7.tar.gz //è§£å‹ç¼©åˆ°æ­¤ç›®å½•cd ntp-4.2.4p7/vi INSTALL // æŸ¥é˜…å®‰è£…ä¿¡æ¯// æ£€æŸ¥configureæ”¯æŒå‚æ•°ï¼Œå¹¶å®é™…ç”Ÿæˆmakefileè§„åˆ™æ–‡ä»¶(å¾ˆé‡è¦)./configure --help | more./configure --prefix=/usr/local/ntp \--enable-all-clocks --enable-parse-clocks //å¼€å§‹å»ºç«‹makefileï¼ˆè®¾ç½®äº†å®‰è£…ç›®å½•ç­‰ï¼‰// å¼€å§‹ç¼–è¯‘å¹¶å®‰è£…make clean; makemake checkmake install åˆ©ç”¨patchæ›´æ–°æºç 12345678910// åŸºæœ¬è¯­æ³•1. patch -p æ•°å­— &lt; patch_file æ›´æ–°2. patch -R &lt; patch_file è¿˜åŸæ›´æ–°å‡å¦‚patch_fileç¬¬ä¸€è¡Œæ˜¯***/home/guest/example/expatch.oldï¼Œå¦‚æœæ‰§è¡Œpatch -p0 &lt; patch_fileï¼Œåˆ™æ›´æ–°çš„æ–‡ä»¶æ˜¯/home/guest/example/expatch.oldï¼Œå¦‚æœæ‰§è¡Œpatch -p4 &lt; patch_fileï¼Œåˆ™æ›´æ–°çš„æ–‡ä»¶æ˜¯expatch.oldï¼ŒåŸºæœ¬è¯­æ³•ä¸­æ•°å­—æ˜¯æŒ‡æ‹¿æ‰ç¬¬å‡ ä¸ªä¸‹åˆ’çº¿ä¹‹å‰çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬ä¸‹åˆ’çº¿ï¼‰ã€‚åœ¨æ›´æ–°ä¹‹åï¼Œè¿˜æ˜¯éœ€è¦é‡æ–°ç¼–è¾‘ï¼Œè¿™æ‰æ˜¯æœ€ç»ˆçš„æ­£ç¡®çš„è½¯ä»¶ã€‚ RPMå®‰è£…RPMå’ŒDPKGå½“å‰Linuxä¸Šæœ‰ä¸¤æ¬¾ä¸»æµçš„è½¯ä»¶ç®¡ç†ç¨‹åºï¼Œåˆ†åˆ«æ˜¯ï¼šRPMå’ŒDPKGã€‚è¿™ä¸¤æ¬¾è½¯ä»¶å‡æä¾›åœ¨çº¿å‡çº§æœºåˆ¶ã€‚ RPM RPMå…¨ç§°ä¸ºRed Hat Package Managerï¼Œæ˜¯Red Hatå…¬å¸ç ”å‘çš„Linuxè½¯ä»¶ç®¡ç†ç¨‹åºã€‚ç›®å‰CentOSã€SuSEã€Fedoraç­‰æ“ä½œç³»ç»Ÿä½¿ç”¨å®ƒã€‚ RPMä½¿ç”¨YUMè¿›è¡Œåœ¨çº¿å‡çº§ã€‚ DPKG dpkgç”±Debian Linuxå¼€å‘ï¼Œç›®å‰ä½¿ç”¨è¯¥è½¯ä»¶çš„æ“ä½œç³»ç»Ÿæœ‰Ubuntuã€B2Dç­‰ã€‚ dpkgä½¿ç”¨apt-getè¿›è¡Œåœ¨çº¿å‡çº§ã€‚ PSï¼šä»€ä¹ˆæ˜¯â€œåœ¨çº¿å‡çº§æœºåˆ¶â€ï¼Ÿä¸€ä¸ªè½¯ä»¶å¾€å¾€ä¼šä¾èµ–å…¶ä»–è½¯ä»¶çš„ä¸€äº›åŠŸèƒ½ï¼Œé‚£ä¹ˆåœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œåªæœ‰ç¡®ä¿ä¸€ä¸ªè½¯ä»¶æ‰€ä¾èµ–çš„æ‰€æœ‰è½¯ä»¶éƒ½è¢«å®‰è£…åï¼Œè¯¥è½¯ä»¶æ‰èƒ½è¢«æ­£ç¡®å®‰è£…ã€‚è€Œåœ¨çº¿å‡çº§æœºåˆ¶èƒ½å¤Ÿåœ¨è½¯ä»¶å®‰è£…è¿‡ç¨‹ä¸­ï¼Œè‹¥å‘ç°è¯¥è½¯ä»¶çš„ä¾èµ–è½¯ä»¶å°šæœªå®‰è£…ï¼Œåˆ™ä¼šè‡ªåŠ¨ä»äº’è”ç½‘ä¸­ä¸‹è½½æ‰€ä¾èµ–çš„è½¯ä»¶ã€‚è¿™å°±æ˜¯åœ¨çº¿å‡çº§æœºåˆ¶ RPMé»˜è®¤å®‰è£…çš„è·¯å¾„ /etc ä¸€äº›è®¾ç½®æ–‡ä»¶æ”¾ç½®çš„ç›®å½•ï¼Œä¾‹å¦‚/etc/crontab /usr/bin ä¸€äº›å¯æ‰§è¡Œæ–‡ä»¶ /usr/lib ä¸€äº›ç¨‹åºä½¿ç”¨çš„åŠ¨æ€å‡½æ•°åº“ /usr/share/doc ä¸€äº›åŸºæœ¬çš„è½¯ä»¶ä½¿ç”¨æ‰‹å†Œä¸å¸®åŠ©æ–‡æ¡£ /usr/share/man ä¸€äº›man pageæ–‡ä»¶ RPMå®‰è£…å› ä¸ºå®‰è£…è½¯ä»¶æ˜¯rootçš„å·¥ä½œï¼Œæ‰€ä»¥ä½ å¿…é¡»æ˜¯rootç”¨æˆ·æ‰èƒ½ä½¿ç”¨rpmå‘½ä»¤ï¼Œä½¿ç”¨èŒƒä¾‹å¦‚ä¸‹(ä¾‹å­ä¸ºå®‰è£…rp-pppoe-3.5-32.1.i386.rpm)ï¼š12// å®‰è£…è½¯ä»¶æ˜¯ï¼Œæ˜¾ç¤ºå®‰è£…ä¿¡æ¯ä¸è¿›åº¦rpm -ivh rp-pppoe-3.5-32.1.i386.rpm RPMçš„å‡çº§ä¸æ›´æ–°èŒƒä¾‹å¦‚ä¸‹ï¼š1234567rpm -Uvh éœ€è¦å‡çº§çš„è½¯ä»¶å-Uvh:è‹¥å¾…å‡çº§çš„è½¯ä»¶å°šæœªå®‰è£…ï¼Œåˆ™ç›´æ¥å®‰è£…rpm -Fvh éœ€è¦å‡çº§çš„è½¯ä»¶å-Fvh:è‹¥å¾…å‡çº§çš„è½¯ä»¶å°šæœªå®‰è£…ï¼Œåˆ™è¯¥è½¯ä»¶ä¸ä¼šè¢«å®‰è£… RPMæŸ¥è¯¢æŸ¥è¯¢çš„ä¿¡æ¯åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯æŸ¥è¯¢å·²è¢«å®‰è£…çš„è½¯ä»¶çš„ä¿¡æ¯(ç”±/var/lib/rpmæä¾›)ï¼Œå¦ä¸€ç±»æ˜¯æŸ¥è¯¢å°šæœªè¢«å®‰è£…çš„è½¯ä»¶å®‰è£…åŒ…çš„ä¿¡æ¯ã€‚ ç¬¬ä¸€ç±»ä¿¡æ¯é€šè¿‡rpm -qæŸ¥è¯¢ï¼Œç¬¬äºŒç±»ä¿¡æ¯é€šè¿‡rpm -qpæŸ¥è¯¢ã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š123456789101112131415161718// 1. æ‰¾å‡ºä½ çš„Linuxæ˜¯å¦å®‰è£…logrotateè¿™ä¸ªè½¯ä»¶rpm -q logrorate// 2. åˆ—å‡ºlogrotateè¿™ä¸ªè½¯ä»¶æ‰€æä¾›çš„æ‰€æœ‰ç›®å½•ä¸æ–‡ä»¶rpm -ql logrorate// 3. åˆ—å‡ºlogrotateè¿™ä¸ªè½¯ä»¶çš„ç›¸å…³æ–‡ä»¶è¯´æ˜rpm -qi logrorate// 4. åˆ—å‡ºlogrotateè¿™ä¸ªè½¯ä»¶çš„è®¾ç½®æ–‡ä»¶ä¸å¸®åŠ©æ–‡ä»¶rpm -qc logroraterpm -qd logrorate// 5. åˆ—å‡ºlogrotateè¿™ä¸ªè½¯ä»¶æ‰€ä¾èµ–è½¯ä»¶çš„æ–‡ä»¶rpm -qR logrorate// 6. åˆ—å‡ºè¯¥æ–‡ä»¶å±äºå“ªä¸€ä¸ªè½¯ä»¶rpm -qf /bin/sh å¸è½½RPMä¸é‡å»ºæ•°æ®åº“å¸è½½ä¸€ä¸ªè½¯ä»¶éå¸¸æ–¹ä¾¿ï¼Œé€šè¿‡-eå³å¯åˆ é™¤ã€‚ä½†ä¸€ä¸ªè½¯ä»¶æ‰€æä¾›çš„åŠ¨æ€å‡½æ•°åº“è¢«å…¶ä»–è½¯ä»¶å¼•ç”¨ï¼Œé‚£ä¹ˆè¯¥è½¯ä»¶å°†æ— æ³•å¸è½½ï¼Œé™¤éå°†å¼•ç”¨è¯¥å‡½æ•°åº“çš„æ‰€æœ‰è½¯ä»¶éƒ½å¸è½½åæ‰èƒ½å¸è½½ã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š1234561. æ‰¾å‡ºä¸pamæœ‰å…³çš„è½¯ä»¶åç§°ï¼Œå¹¶å°è¯•åˆ é™¤pamè¿™ä¸ªè½¯ä»¶rpm -qa | grep pamrpm -e pamï¼ˆå‡ºé”™ï¼Œå› ä¸ºä½ éœ€è¦å…ˆåˆ é™¤ä¾èµ–å®ƒçš„è½¯ä»¶ï¼‰2. åˆ é™¤pam-develè½¯ä»¶rpm -e pam-devel (æˆåŠŸ) å½“/var/lib/rpmå†…çš„æ–‡ä»¶å‘ç”ŸæŸåæ—¶ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤é‡å»ºæ•°æ®åº“ä¿®å¤ï¼š1rpm --rebuilddb YUMå®‰è£…RPMè™½ç„¶çœå»äº†ç¼–è¯‘è¿‡ç¨‹ï¼Œå¹¶ä¸”æä¾›æ•°æ®åº“å­˜å‚¨è½¯ä»¶çš„ä¿¡æ¯ï¼Œä½†ä»ç„¶éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ä¸‹è½½RPMå®‰è£…åŒ…ï¼Œè€ŒYUMçš„å‡ºç°è§£å†³äº†è¿™ä¸€é—®é¢˜ã€‚è¾ƒå¤šè½¯ä»¶çš„RPMå®‰è£…åŒ…éƒ½å­˜æ”¾åœ¨äº†YUM Serverä¸Šï¼Œåªè¦æˆ‘ä»¬çš„è®¡ç®—æœºèƒ½è¿äº’è”ç½‘ï¼Œå°±èƒ½ä½¿ç”¨yumè‡ªåŠ¨ä¸‹è½½RPMå®‰è£…åŒ…å¹¶å®‰è£…è½¯ä»¶ã€‚ yumåŠŸèƒ½yumçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œå°±æ˜¯é€šè¿‡yumè¿™ä¸ªå‘½ä»¤ï¼Œç”¨æ³•èŒƒä¾‹å¦‚ä¸‹ï¼š æŸ¥è¯¢åŠŸèƒ½ 1234567891011121314// 1. æœç´¢ç£ç›˜é˜µåˆ—ç›¸å…³çš„è½¯ä»¶yum search raid// 2. æ‰¾å‡ºmdadmè¿™ä¸ªè½¯ä»¶çš„åŠŸèƒ½å¦‚ä½•yum info mdadm// 3. åˆ—å‡ºyumæœåŠ¡å™¨ä¸Šé¢æä¾›çš„æ‰€æœ‰è½¯ä»¶åç§°yum list// 4. åˆ—å‡ºç›®å‰æœåŠ¡å™¨ä¸Šå¯ä¾›æœ¬æœºå‡çº§çš„è½¯ä»¶æœ‰å“ªäº›yum list updates// 5. åˆ—å‡ºæä¾›passwdè¿™ä¸ªæ–‡ä»¶çš„è½¯ä»¶æœ‰å“ªäº›yum provides passwd å®‰è£…/å‡çº§åŠŸèƒ½ 12// 1. å®‰è£…/å‡çº§pam-develyum install/update pam-devel åˆ é™¤åŠŸèƒ½ 12// 1. åˆ é™¤pam-develyum remove pam-devel ç®¡ç†çš„é€‰æ‹©ï¼šRPM or Tarballå»ºè®®å¦‚ä¸‹ï¼š ä¼˜å…ˆé€‰æ‹©åŸå‚çš„RPMåŠŸèƒ½ é€‰æ‹©è½¯ä»¶å®˜æ–¹ç½‘ç«™å‘å¸ƒçš„RPMæˆ–è€…æ˜¯æä¾›çš„å®¹å™¨ç½‘å€ï¼ˆyum serverï¼‰ åˆ©ç”¨Tabballå®‰è£…ç‰¹æ®Šè½¯ä»¶ï¼ˆæ²¡æœ‰RPMï¼‰ ç”¨Tarballæµ‹è¯•æ–°ç‰ˆè½¯ä»¶ RPMä¸Tarballå„æœ‰ä¼˜ç‚¹ï¼Œä½†æ˜¯å¦‚æœæœ‰RPMçš„è¯ï¼Œä¼˜å…ˆé€‰æ‹©RPMã€‚å¦‚æœæ— æ³•è§£å†³ä¾èµ–æ€§é—®é¢˜ï¼Œé‚£å°±é€‰tarballã€‚ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_daemonä¸ºæœåŠ¡(service)ä¿é©¾æŠ¤èˆª]]></title>
    <url>%2F2018%2F04%2F03%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_daemon%E4%B8%BA%E6%9C%8D%E5%8A%A1(service)%E4%BF%9D%E9%A9%BE%E6%8A%A4%E8%88%AA%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæˆ‘ä»¬è¿›ç¨‹ä¼šå¬åˆ°daemonï¼Œä½†æ˜¯å´ä¸çŸ¥é“å…¶ä¹‰ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œä½œç”¨æ˜¯æ”¯æŒå…¶ä»–æœåŠ¡(service)çš„è¿è¡Œã€‚æˆ‘ä»¬ä¸‹é¢å¯ä»¥å¥½å¥½çœ‹çœ‹linuxä¸­çš„daemonä¸serviceï¼ ä»€ä¹ˆæ˜¯daemonä¸æœåŠ¡ç³»ç»Ÿä¸ºäº†æŸäº›åŠŸèƒ½å¿…é¡»è¦æä¾›ä¸€äº›æœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡å°±ç§°ä¸ºserviceã€‚ä½†æ˜¯serviceçš„æä¾›æ€»æ˜¯éœ€è¦è¿›ç¨‹çš„è¿è¡Œï¼Œæ‰€ä»¥å®ç°è¿™ä¸ªserviceçš„ç¨‹åºæˆ‘ä»¬å°±ç§°å®ƒä¸ºdaemonã€‚ daemonçš„åˆ†ç±»åˆ†ç±»æ–¹å¼ä¸€ï¼šæŒ‰ç…§â€œæ˜¯å¦å¯ä»¥ç‹¬ç«‹å¯åŠ¨â€åˆ†ç±» stand aloneç±»å‹çš„daemonï¼šè¿™ç§ç±»å‹çš„daemonå¯ä»¥è‡ªè¡Œå¯åŠ¨ï¼Œå¯åŠ¨ä¹‹åå¯ä»¥å¸¸é©»å†…å­˜ï¼Œç›´åˆ°æ‰‹åŠ¨å…³é—­è¯¥daemonæ‰é‡Šæ”¾èµ„æºã€‚å¦‚wwwã€‚ ç”±super daemonç®¡ç†çš„daemonï¼šè¿™ç§ç±»å‹çš„daemonç”±super daemonç»Ÿä¸€ç®¡ç†ï¼Œå½“è¯·æ±‚åˆ°æ¥æ—¶ï¼Œç”±super daemonå¯åŠ¨è¯·æ±‚çš„æœåŠ¡ï¼Œè¯·æ±‚å®Œæˆåä¾¿é‡Šæ”¾å†…å­˜èµ„æºã€‚å¦‚telnetã€‚ åˆ†ç±»æ–¹å¼äºŒï¼šæŒ‰ç…§â€œè¯·æ±‚åˆ°æ¥æ—¶æ˜¯å¦èƒ½å¤Ÿç«‹å³è¿è¡Œâ€åˆ†ç±» signal-controlç±»å‹çš„daemonè¿™ç§ç±»å‹çš„daemonå½“æœ‰è¯·æ±‚åˆ°æ¥æ—¶ä¾¿èƒ½ç«‹å³æ‰§è¡Œã€‚å¦‚æ‰“å°æœºæœåŠ¡ã€‚ interval-controlç±»å‹çš„daemonè¿™ç§ç±»å‹çš„daemonä¼šå‘¨æœŸæ€§åœ°æ‰§è¡ŒæŸé¡¹å·¥ä½œï¼Œå› æ­¤å®ƒæ²¡æœ‰è¯·æ±‚ä¸€è¯´ï¼Œå®ƒä¼šå‘¨æœŸæ€§åœ°è¯»å–é…ç½®æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œé…ç½®æ–‡ä»¶ä¸­è¦æ±‚çš„åŠŸèƒ½ã€‚å¦‚crondã€atdéƒ½å±äºinterval-controlç±»å‹çš„daemonã€‚ é€šå¸¸åœ¨æœåŠ¡çš„åç§°çš„ä¹‹åéƒ½ä¼šåŠ ä¸€ä¸ªdã€‚ ç½‘ç»œæœåŠ¡ä¸ç«¯å£çš„å¯¹åº”å½“ç³»ç»Ÿæä¾›äº†ç½‘ç»œæœåŠ¡ï¼Œå°±ä¼šæ¶‰åŠåˆ°ç«¯å£çš„é—®é¢˜ï¼Œè¿™äº›æœåŠ¡ä¸ç«¯å£çš„å®šä¹‰æ–‡ä»¶åœ¨/etc/servicesã€‚å¤§å®¶å¯ä»¥è‡ªå·±æŸ¥çœ‹ä¸€ä¸‹ã€‚å¦‚ä¸‹ï¼š12tcpmux 1/tcp # TCP port service multiplexertcpmux 1/udp # TCP port service multiplexer ç¬¬ä¸€åˆ—ä¸ºdaemonçš„åç§°ï¼Œç¬¬äºŒåˆ—ä¸ºè¯¥daemonæ‰€ä½¿ç”¨çš„ç«¯å£å·ä¸ç½‘ç»œæ•°æ®åŒ…åè®®ã€‚ daemonçš„å¯åŠ¨è„šæœ¬ä¸å¯åŠ¨æ–¹å¼stand-aloneç±»å‹çš„daemonå’Œsuper daemonç±»å‹çš„daemonæœ‰å„è‡ªçš„å¯åŠ¨æ–¹å¼ stand aloneå‹Daemonçš„å¯åŠ¨æ–¹å¼ é€šè¿‡/etc/init.d/xxxå¯åŠ¨ã€‚å¯åŠ¨ä¸€ä¸ªæœåŠ¡æ˜¯ä¸€ä¸ªç¹ççš„è¿‡ç¨‹ï¼Œä½ éœ€è¦è¿›è¡Œä¸€ç³»åˆ—å¯åŠ¨å‰çš„æ“ä½œï¼Œä¸ºäº†é¿å…è¿™äº›éº»çƒ¦ï¼ŒæœåŠ¡æä¾›å•†æŠŠè¿™äº›ç¹ççš„è¿‡ç¨‹å°è£…åœ¨ä¸€ä¸ªshell srciptä¸­ï¼Œæˆ‘ä»¬åªéœ€æ‰§è¡Œä¸€ä¸ªshell scriptå³å¯å¯åŠ¨ä¸€ä¸ªdaemonã€‚å‡ ä¹æ‰€æœ‰çš„stand aloneå‹daemonçš„å¯åŠ¨è„šæœ¬éƒ½æ”¾åœ¨/etc/init.d/ä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€æ‰§è¡Œ /etc/init.d/xxx start å³å¯å¯åŠ¨xxxæœåŠ¡ã€‚ é€šè¿‡serviceå‘½ä»¤å¯åŠ¨ã€‚è‹¥æ¯æ¬¡å¯åŠ¨ä¸€ä¸ªå‘½ä»¤éƒ½è¦å†™/etc/init.d/ç•¥å¾®æœ‰äº›éº»çƒ¦ï¼Œserviceå‘½ä»¤å°†å…¶è¿›è¡Œäº†å°è£…ï¼Œæˆ‘ä»¬åªè¦æ‰§è¡Œ â€œservice xxx start/status/restart/stopâ€ å³å¯å¼€å¯/æŸ¥çœ‹/é‡å¯/å…³é—­xxxæœåŠ¡ã€‚ super daemonå‹Daemonçš„å¯åŠ¨æ–¹å¼ è®¾ç½®daemonçš„é…ç½®æ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªè¢«super daemonç®¡ç†çš„daemonéƒ½æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåœ¨/etc/xinetd.d/ç›®å½•ä¸‹ã€‚æ¯ä¸ªdaemonçš„å¼€å¯æˆ–å…³é—­å‡åœ¨è¯¥daemonå¯¹åº”çš„é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ã€‚ å¯åŠ¨super daemonï¼Œsuper daemonæ˜¯ä¸€ä¸ªstand aloneå‹daemonï¼Œå› æ­¤åœ¨daemonçš„é…ç½®æ–‡ä»¶è®¾ç½®å¥½åå¯é€šè¿‡service xinetd startå¯åŠ¨æ‰€æœ‰ç”±super daemonç®¡ç†çš„daemonã€‚ è§£æsuper daemonçš„é…ç½®æ–‡ä»¶é»˜è®¤å€¼é…ç½®æ–‡ä»¶ï¼šxinetd.confé«˜ç‰ˆæœ¬çš„contoså¯èƒ½æ²¡æœ‰è¯¥æ–‡ä»¶ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰å®‰è£…ï¼Œæ‰€ä»¥è¦å…ˆç”¨â€œyum install xinetdâ€å®‰è£…ä¹‹åï¼Œå°±å¯ä»¥çœ‹è§äº†ã€‚ super daemonçš„é»˜è®¤é…ç½®æ–‡ä»¶ä¸º:/etc/xinetd.confï¼Œå®ƒä¸ºå®ƒæ‰€ç®¡ç†çš„æ‰€æœ‰daemonåšäº†ä¸€äº›é»˜è®¤çš„é…ç½®ã€‚ä»æœ€åä¸€è¡Œçš„includedir /etc/xinetd.då¯ä»¥çœ‹å‡ºï¼Œå®ƒåŠ è½½äº†å®ƒæ‰€ç®¡ç†çš„æ‰€æœ‰daemonçš„é…ç½®ã€‚ ä¸‹é¢æ¥çœ‹ä¸€ä¸‹å…·ä½“çš„æŸä¸ªdaemonçš„é…ç½®ï¼š12345678910service rsync #serviceåä¸ºdaemonçš„åå­—&#123; disable = yes # yesè¡¨ç¤ºå…³é—­æ­¤daemonï¼Œnoè¡¨ç¤ºå¼€å¯æ­¤daemon socket_type = stream #streamè¡¨ç¤ºä½¿ç”¨TCPã€dgramè¡¨ç¤ºä½¿ç”¨UDPã€rawè¡¨ç¤ºç›´æ¥ä¸IPäº¤äº’ wait = no user = root #ä»¥ä»€ä¹ˆç”¨æˆ·çš„èº«ä»½å¯åŠ¨è¿™ä¸ªdaemon server = /usr/bin/rsync #è¿™ä¸ªdaemonçš„å¯åŠ¨ç¨‹åº server_args = --daemon #å¯åŠ¨æ—¶æ‰€éœ€çš„å‚æ•° log_on_failure += USERID # ç™»å½•å¤±è´¥æ—¶éœ€è¦è®°å½•ç”¨æˆ·&#125; =ï¼šè¡¨ç¤ºå°†æŸä¸ªå‚æ•°è®¾ä¸ºç­‰å·å³ä¾§çš„å€¼ï¼Œè‹¥å…ˆå‰è®¾ç½®ä¸­å·²è®¾ç½®è¿‡è¯¥å‚æ•°ï¼Œåˆ™ç›´æ¥è¦†ç›– +=ï¼šè¡¨ç¤ºä¿ç•™å…ˆå‰è®¾ç½®çš„è¿™ä¸ªå‚æ•°ï¼Œå†ç»™è¿™ä¸ªå‚æ•°å¢åŠ ä¸ªå€¼ã€‚ -å’Œ-=çš„å«ä¹‰åŒä¸Šã€‚ super deamonçš„é˜²ç«å¢™ç®¡ç†ç”±äºå—super daemonç®¡ç†çš„daemonçš„è¯·æ±‚éƒ½é¦–å…ˆéœ€è¦ç»è¿‡super daemonï¼Œå› æ­¤super daemonå¯ä»¥å……å½“é˜²ç«å¢™çš„è§’è‰²ï¼Œæ‹’ç»ä¸€äº›ä¸å®‰å…¨çš„è¯·æ±‚ã€‚super daemonæä¾›äº†ä¸¤ç§é˜²ç«å¢™æœºåˆ¶ï¼Œç¬¬ä¸€ç§æ–¹å¼æä¾›è¾ƒå¤šè¯¦ç»†çš„å®‰å…¨è®¾ç½®ï¼Œè€Œç¬¬äºŒç§æ–¹å¼åªèƒ½é˜»æŒ¡æˆ–å…è®¸æŒ‡å®šçš„IPï¼Œå…·ä½“è§ä¸‹ï¼š ä½¿ç”¨å—super daemonç®¡ç†çš„daemonçš„é…ç½®æ–‡ä»¶å®ç°é˜²ç«å¢™æœºåˆ¶ åœ¨æŸä¸ªå…·ä½“çš„daemoné…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å‚æ•°ï¼Œå³å¯ä¸ºdaemoné…ç½®é˜²ç«å¢™ï¼š instance=æ•°å­—/UNLIMITEDï¼šè®¾ç½®è¯¥daemonèƒ½å¤Ÿæ‰¿å—çš„æœ€å¤§è¿æ¥æ•°ã€‚` per_source=æ•°å­—/UNLIMITEDï¼šæ¯ä¸ªIPçš„æœ€å¤§è¿æ¥æ•°ã€‚ Cps=æ•°å­—1 æ•°å­—2ï¼šè¯¥daemonåœ¨ä¸€ç§’å†…çš„è¿æ¥æ•°è¶…è¿‡æ•°å­—1ï¼Œåˆ™æš‚æ—¶å…³é—­è¯¥da* emonæ•°å­—2çš„ç§’æ•°ã€‚ log_on_success/failure=PID/HOST/USERID/EXIT/DURATIONï¼šå½“ç™»å½•æˆåŠŸ/* å¤±è´¥æ—¶è®°å½•çš„ä¿¡æ¯ã€‚HOSTï¼šè¿æ¥è€…çš„IPã€EXITï¼šç¦»å¼€æ—¶é—´ã€DURATIONï¼šä¸ºè¯¥ç”¨æˆ·æœåŠ¡çš„æ—¶é—´ã€‚ redirect=IPï¼šå°†ç”¨æˆ·çš„è¯·æ±‚è½¬è‡³æŒ‡å®šæœåŠ¡å™¨ã€‚ bind=IPï¼šå…è®¸ç”¨æˆ·ç”¨å“ªä¸ªIPè®¿é—®æœ¬æœåŠ¡ã€‚only_from=[0.0.0.0,192.168.1.0:24]ï¼šåªå…è®¸æŒ‡å®šIPçš„ç”¨æˆ·è®¿é—®ã€‚0.0.0.0è¡¨ç¤ºå…è®¸æ‰€æœ‰ç”¨æˆ·ï¼Œ192.168.1.0:24è¡¨ç¤ºåªå…è®¸192.168.1.1ï¼192.168.1.255ä¹‹é—´çš„ç”¨æˆ·è®¿é—®ã€‚access_time=00:00-12:00ï¼šåªå…è®¸è¯¥æ—¶é—´æ®µå†…è®¿é—®ã€‚ ä½¿ç”¨xinetdæä¾›çš„/etc/hosts.allowå’Œ/etc/hosts.denyå®ç°é˜²ç«å¢™æœºåˆ¶ /etc/hosts.allow ï¼šæˆ‘ä»¬å¯ä»¥åœ¨è¯¥æ–‡ä»¶ä¸­è®¾ç½®å…è®¸è®¿é—®çš„IP /etc/hosts.deny ï¼šæˆ‘ä»¬å¯ä»¥åœ¨è¯¥æ–‡ä»¶ä¸­è®¾ç½®ä¸å…è®¸è®¿é—®çš„IP ç³»ç»Ÿå¼€å¯çš„æœåŠ¡æŸ¥çœ‹ç³»ç»Ÿå¯åŠ¨çš„æœåŠ¡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šæ¯”è¾ƒå…³å¿ƒç½‘ç»œç›‘å¬çš„æœåŠ¡ï¼Œæ‰€ä»¥éƒ½ä¼šä½¿ç”¨netstatå‘½ä»¤(ä¹‹å‰ä¹Ÿæåˆ°è¿‡)ï¼Œè¿™é‡Œå†æ¬¡è¯´æ˜å‡ ä¸ªèŒƒä¾‹ï¼š12345678// 1. æ‰¾å‡ºç›®å‰ç³»ç»Ÿå¼€å¯çš„ç½‘ç»œæœåŠ¡netstat -tulp// 2. æ‰¾å‡ºæ‰€æœ‰æœ‰ç›‘å¬ç½‘ç»œçš„æœåŠ¡netstat -lnp// 3. æŸ¥çœ‹æ‰€æœ‰çš„æœåŠ¡çŠ¶æ€ service --status-all è®¾ç½®Daemonå¼€å¯å¯åŠ¨åœ¨è®¾ç½®Daemonå¼€æœºå¯åŠ¨ä¹‹å‰ï¼Œæœ€å¥½å…ˆäº†è§£ä¸€ä¸‹Linuxä¸»æœºæ˜¯æ€ä¹ˆå¼€æœºçš„ï¼Ÿ æ‰“å¼€è®¡ç®—æœºç”µæºï¼Œå¼€å§‹è¯»å–BIOSå¹¶è¿›è¡Œä¸»æœºçš„è‡ªæˆ‘æµ‹è¯• é€šè¿‡BIOSå–å¾—ç¬¬ä¸€ä¸ªå¯å¼€æœºè®¾å¤‡ï¼Œè¯»å–ä¸»è¦å¼€æœºåŒº(MBR)å–å¾—å¯åŠ¨è£…è½½ç¨‹åº é€šè¿‡å¯åŠ¨è£…è½½ç¨‹åºçš„è®¾ç½®ï¼Œå–å¾—kernelå¹¶åŠ è½½å†…å­˜ä¸”æ£€æµ‹ç³»ç»Ÿç¡¬ä»¶ å†…æ ¸ä¸»åŠ¨è°ƒç”¨initè¿›ç¨‹ initè¿›ç¨‹å¼€å§‹æ‰§è¡Œç³»ç»Ÿåˆå§‹åŒ–(/etc/rc.d/rec.sysinit) ä¾æ®initçš„è®¾ç½®è¿›è¡Œdaemonstart(/etc/rc.d/rc[0-6].d/*) åŠ è½½æœ¬æœºè®¾ç½® åœ¨å¯åŠ¨Linuxç³»ç»Ÿæ—¶ï¼Œå¯ä»¥è¿›å…¥ä¸åŒçš„æ¨¡å¼ï¼Œè¿™æ¨¡å¼æˆ‘ä»¬ç§°ä¸ºæ‰§è¡Œç­‰çº§(run level)ï¼Œä¸åŒæ‰§è¡Œç­‰çº§æœ‰ä¸åŒçš„åŠŸèƒ½ä¸æœåŠ¡ã€‚å›¾å‹ç•Œé¢ä¸ºrun level5ï¼Œçº¯æ–‡æœ¬ç•Œé¢ä¸ºrun level3ã€‚å½“æˆ‘ä»¬æƒ³è¦çŸ¥é“å“ªäº›æœåŠ¡é»˜è®¤å¯ä»¥å¯åŠ¨ï¼Œè¿™å°±éœ€è¦ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥è¯¢: chkconfigï¼šç®¡ç†ç³»ç»ŸæœåŠ¡é»˜è®¤å¼€æœºå¯åŠ¨ä¸å¦ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 12345678910111213// 1. åˆ—å‡ºç›®å‰ç³»ç»Ÿä¸Šé¢æ‰€æœ‰è¢«chkconfigç®¡ç†çš„æœåŠ¡chkconfig --list | more // åˆ†ä¸ºä¸¤ä¸ªå—ï¼Œåˆ†åˆ«ä¸ºä¸¤ç§å¯åŠ¨æ–¹å¼çš„daemon// 2. æ˜¾ç¤ºç›®å‰åœ¨run level 3 å¯åŠ¨çš„æœåŠ¡chkconfig --list | grep &apos;2:on&apos;// 3. è®©atdè¿™ä¸ªæœåŠ¡åœ¨run level 3ï¼Œ4ï¼Œ5æ—¶å¯åŠ¨chkconfig --level 345 atd on// 4. æŸ¥çœ‹httpdï¼Œå†æŸ¥çœ‹é»˜è®¤æœ‰æ— å¯åŠ¨ï¼Œä¹‹åä»¥chkconfigè®¾ç½®ä¸ºé»˜è®¤å¯åŠ¨/etc/init.d/httpd status // æŸ¥çœ‹æœ¬èº«chkconfig --list httpd // æŸ¥çœ‹æ˜¯å¦é»˜è®¤å¯åŠ¨chconfig httpd on; //è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ chkconfigï¼šè®¾ç½®è‡ªå·±çš„ç³»ç»ŸæœåŠ¡1chkconfig [--add|--del] [æœåŠ¡åç§°] // è¯¥æœåŠ¡å¿…é¡»åœ¨/etc/init.d/å†… RHEL7çš„sytemctlï¼ˆä»£æ›¿serviceå’Œchkconfigï¼‰centos7ç‰ˆæœ¬ä¸­ä½¿ç”¨äº†systemdï¼ŒsystemdåŒæ—¶å…¼å®¹service,å¯¹åº”çš„å‘½ä»¤å°±æ˜¯systemctl ã€‚systemctlæ˜¯RHEL 7 çš„æœåŠ¡ç®¡ç†å·¥å…·ä¸­ä¸»è¦çš„å·¥å…·ï¼Œå®ƒèåˆä¹‹å‰serviceå’Œchkconfigçš„åŠŸèƒ½äºä¸€ä½“ã€‚å¯ä»¥ä½¿ç”¨å®ƒæ°¸ä¹…æ€§æˆ–åªåœ¨å½“å‰ä¼šè¯ä¸­å¯ç”¨/ç¦ç”¨æœåŠ¡ã€‚ systemdæŠŠä¸åŒçš„èµ„æºç§°ä¸ºUnitæ¯ä¸€ä¸ª Unit éƒ½æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘Šè¯‰ Systemd æ€ä¹ˆå¯åŠ¨è¿™ä¸ª Unitå­˜æ”¾ç›®å½•ï¼š/etc/systemd/systemå’Œ/usr/lib/systemd/systemã€‚ ä½¿ç”¨èŒƒä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435// 1. ä»¥æ ‘å½¢åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå®ƒå¯ä»¥é€’å½’æ˜¾ç¤ºæ§åˆ¶ç»„å†…å®¹systemd-cgls// 2. å¯åŠ¨ä¸€ä¸ªæœåŠ¡systemctl start firewalld.service// 3. å…³é—­ä¸€ä¸ªæœåŠ¡systemctl stop firewalld.service// 4. é‡å¯ä¸€ä¸ªæœåŠ¡systemctl restart firewalld.service// 5. æ˜¾ç¤ºä¸€ä¸ªæœåŠ¡çš„çŠ¶æ€systemctl status firewalld.service// 6. åœ¨å¼€æœºæ—¶å¯åŠ¨ä¸€ä¸ªæœåŠ¡systemctl enable firewalld.service// 7. åœ¨å¼€æœºæ—¶ç¦ç”¨ä¸€ä¸ªæœåŠ¡systemctl disable firewalld.service// 8. æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨systemctl is-enabled firewalld.service// 9. æŸ¥çœ‹å·²å¯åŠ¨çš„æœåŠ¡åˆ—è¡¨systemctl list-unit-files | grep enabled// 10. æŸ¥çœ‹å¯åŠ¨å¤±è´¥çš„æœåŠ¡åˆ—è¡¨systemctl --failedPSï¼š1. ä½¿ç”¨å‘½ä»¤ systemctl is-enabled firewalld.service å¾—åˆ°çš„å€¼å¯ä»¥æ˜¯enableã€disableæˆ–staticï¼Œ è¿™é‡Œçš„ static å®ƒæ˜¯æŒ‡å¯¹åº”çš„ Unit æ–‡ä»¶ä¸­æ²¡æœ‰å®šä¹‰[Install]åŒºåŸŸï¼Œå› æ­¤æ— æ³•é…ç½®ä¸ºå¼€æœºå¯åŠ¨æœåŠ¡ã€‚2. å¯ç”¨æœåŠ¡å°±æ˜¯åœ¨å½“å‰â€œrunlevelâ€çš„é…ç½®æ–‡ä»¶ç›®å½•/etc/systemd/system/multi-user.target.wants/é‡Œï¼Œå»ºç«‹/usr/lib/systemd/systemé‡Œé¢å¯¹åº”æœåŠ¡é…ç½®æ–‡ä»¶çš„è½¯é“¾æ¥ï¼› ç¦ç”¨æœåŠ¡å°±æ˜¯åˆ é™¤æ­¤è½¯é“¾æ¥ï¼Œæ·»åŠ æœåŠ¡å°±æ˜¯æ·»åŠ è½¯è¿æ¥ã€‚ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹ RHEL7çš„sytemctlï¼ˆä»£æ›¿serviceå’Œchkconfigï¼‰]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_è®¤è¯†ä½ çš„è¿›ç¨‹]]></title>
    <url>%2F2018%2F04%2F02%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E8%AE%A4%E8%AF%86%E4%BD%A0%E7%9A%84%E8%BF%9B%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šlinuxæœåŠ¡å™¨ä¸Šå¯ä»¥è·‘å¾ˆå¤šå¾ˆå¤šçš„ç¨‹åºï¼Œå½“ç„¶ä¹Ÿä¼šé‡åˆ°å¾ˆå¤šçš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å­¦ä¼šå»ç®¡ç†å¥½å®ƒã€‚å°¤å…¶åƒpsï¼Œtopè¿™äº›å‘½ä»¤ï¼Œä½ ä¸€å®šä¼šå¾ˆæƒ³å»äº†è§£å®ƒå§ï¼ ç†è§£è¿›ç¨‹ä»€ä¹ˆæ˜¯è¿›ç¨‹è¿›ç¨‹ï¼š ä¸€ä¸ªç¨‹åºè¢«åŠ è½½åˆ°å†…å­˜å½“ä¸­è¿è¡Œï¼Œé‚£ä¹ˆåœ¨å†…å­˜ä¸­çš„é‚£ä¸ªæ•°æ®å°±è¢«ç§°ä¸ºè¿›ç¨‹ã€‚ ç³»ç»Ÿä¹Ÿä¼šç»™äºˆè¿™ä¸ªè¿›ç¨‹ä¸€ä¸ªIDï¼Œç§°ä¸ºPIDã€‚åŒæ—¶è§¦å‘è¿™ä¸ªè¿›ç¨‹çš„ç”¨æˆ·ä¸ç›¸å…³å±æ€§å…³ç³»ï¼Œç»™äºˆè¿™ä¸ªPIDä¸€ç»„æœ‰æ•ˆçš„æƒé™è®¾ç½®ã€‚ è¿›ç¨‹ä¸ç¨‹åºç¨‹åºå’Œè¿›ç¨‹æ¦‚å¿µ ç¨‹åºï¼šé€šå¸¸ä¸ºäºŒè¿›åˆ¶ç¨‹åºï¼Œæ”¾ç½®åœ¨å­˜å‚¨åª’ä»‹ä¸­ï¼Œä»¥ç‰©ç†æ–‡ä»¶çš„å½¢å¼å­˜åœ¨ã€‚ è¿›ç¨‹ï¼šç¨‹åºåœ¨è§¦å‘åï¼Œæ‰§è¡Œè€…çš„æƒé™ä¸å±æ€§ã€ç¨‹åºçš„ç¨‹åºä»£ç ä¸æ‰€éœ€æ•°æ®ç­‰éƒ½ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ“ä½œç³»ç»Ÿç»™äºˆè¿™ä¸ªå†…å­˜ä¸­çš„å•å…ƒä¸€ä¸ªæ ‡è¯†ç¬¦ï¼ˆPIDï¼‰ï¼Œå¯ä»¥è¯´ï¼Œè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºã€‚ å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹ä¸¾ä¸ªæ —å­ï¼šå½“æˆ‘ä»¬ç™»å½•ç³»ç»Ÿåï¼Œä¼šå–å¾—ä¸€ä¸ªbashçš„shellï¼Œç„¶åï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªbashæä¾›çš„æ¥å£å»æ‰§è¡Œå¦ä¸€ä¸ªå‘½ä»¤ï¼Œé‚£äº›å¦å¤–æ‰§è¡Œçš„å‘½ä»¤ä¹Ÿä¼šè¢«è§¦å‘ç§°ä¸ºPIDï¼Œé‚£ä¸ªåæ¥æ‰§è¡Œå‘½ä»¤æ‰äº§ç”Ÿçš„PIDå°±æ˜¯â€œå­è¿›ç¨‹â€ï¼Œè€Œåœ¨æˆ‘ä»¬åŸæœ¬åœ¨bashç¯å¢ƒä¸‹ï¼Œå°±ç§°ä¸ºâ€œçˆ¶è¿›ç¨‹â€ã€‚å­è¿›ç¨‹ä¼šå…·æœ‰PPID(çˆ¶PID)ã€‚ fork and execï¼šè¿‡ç¨‹è°ƒç”¨çš„æµç¨‹åœ¨Linuxçš„è¿‡ç¨‹è°ƒç”¨ä¸­é€šå¸¸è¢«ç§°ä¸ºfork and execçš„æµç¨‹ï¼Œè¿›ç¨‹éƒ½ä¼šçˆ¶è¿›ç¨‹ä»¥å¤åˆ¶(fork)çš„æ–¹å¼äº§ç”Ÿä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å­è¿›ç¨‹ï¼ˆPIDä¸ä¸€æ ·ï¼‰ï¼Œç„¶åè¢«å¤åˆ¶å‡ºæ¥çš„å­è¿›ç¨‹å†ä»¥execçš„æ–¹å¼æ¥æ‰§è¡Œå®é™…è¦è¿›è¡Œçš„è¿›ç¨‹ï¼Œæœ€ç»ˆç§°ä¸ºä¸€ä¸ªå­è¿›ç¨‹çš„å­˜åœ¨ã€‚ å·¥ä½œç®¡ç†ä»€ä¹ˆæ˜¯å·¥ä½œç®¡ç†å·¥ä½œç®¡ç†ï¼š å½“æˆ‘ä»¬ç™»å½•ç³»ç»Ÿå–å¾—bash shellä¹‹åï¼Œåœ¨å•ä¸€ç»ˆç«¯æœºä¸‹åŒæ—¶è¿›è¡Œå¤šä¸ªå·¥ä½œçš„è¡Œä¸ºç®¡ç†ã€‚ ä¸‹é¢æ˜¯å‰å°å’Œåå°å®šä¹‰: å‰å°: ä½ å¯ä»¥æ§åˆ¶ä¸æ‰§è¡Œå‘½ä»¤çš„ç¯å¢ƒ åå°ï¼š å¯ä»¥è‡ªè¡Œè¿è¡Œçš„å·¥ä½œï¼Œä½ æ— æ³•ç”¨ctrl + cç»ˆæ­¢å®ƒï¼Œä½†æ˜¯å¯ä»¥ç”¨bg/fgè°ƒç”¨è¯¥å·¥ä½œçš„ç¯å¢ƒ è¦è¿›è¡Œbashçš„å·¥ä½œç®¡ç†å¿…é¡»è¦æ³¨æ„çš„é™åˆ¶æ˜¯ï¼š è¿™äº›å·¥ä½œæ‰€è§¦å‘çš„è¿›ç¨‹å¿…é¡»è¦æ¥è‡ªä½ çš„shellå­è¿›ç¨‹ï¼ˆåªç®¡ç†è‡ªå·±çš„bashï¼‰ åå°ä¸­â€œæ‰§è¡Œâ€çš„è¿›ç¨‹ä¸èƒ½ç­‰å¾…terminal/shellçš„è¾“å…¥ã€‚ jobç®¡ç†å®é™…ä¸­ä½¿ç”¨çš„jobæ§åˆ¶ä¸»è¦æœ‰ä¸‹é¢çš„å‘½ä»¤ï¼š1234567891011121314151617181920212223242526272829// 1. ç›´æ¥å°†å‘½ä»¤ä¸¢åˆ°åå°ä¸­â€œæ‰§è¡Œâ€çš„ &amp;tar -zpcf /tmp/tec/tar.gz /etc &amp;/*ä¼šå‡ºç°[1]ï¼ˆå·¥ä½œå¥½ï¼‰ 13456ï¼ˆè¿›ç¨‹å·ï¼‰å®Œæˆåä¼šè¾“å‡ºï¼š [1] å®Œæˆ tar -zpcf /tmp/etc.tar.gz /etc *//*ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿è¡Œçš„ä¿¡æ¯è¿˜æ˜¯ä¼šå‡ºç°åœ¨å±å¹•ä¸Šï¼Œä¼šå½±å“æˆ‘ä»¬æ­£å¸¸ç»§ç»­ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨æ•°æ®æµé‡å®šå‘è¾“å…¥åˆ°æ–‡ä»¶ä¸­ã€‚*/// 2. å°†ç›®å‰çš„å·¥ä½œä¸¢åˆ°åå°ä¸­â€œæš‚åœâ€ï¼šctrl + zvim ~/.bashrc æŒ‰ctrl+z/*ä¼šè¾“å‡º [2]+ å·²åœæ­¢ vim ~/.bashrc */// 3. æŸ¥çœ‹ç›®å‰çš„åå°å·¥ä½œçŠ¶æ€ï¼šjobs// 4. å°†åå°å·¥ä½œæ‹¿åˆ°å‰å°æ¥å¤„ç†ï¼šfgfg %2 //æ‹¿å‡ºåˆšåˆšvimçš„å·¥ä½œ// 5. è®©å·¥ä½œåœ¨åå°ä¸‹å¾—çŠ¶æ€å˜æˆè¿è¡Œä¸­ï¼šbgbg %2// 6. ç®¡ç†åå°å½“ä¸­çš„å·¥ä½œï¼škillkill -signal %jobnumber/PID/å‘½ä»¤/* signal-1ï¼šé‡æ–°è¯»å–ä¸€æ¬¡å‚æ•°çš„é…ç½®æ–‡ä»¶-2ï¼šä¸ctrl + cä¸€æ ·-9ï¼šç«‹åˆ»å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªå·¥ä½œï¼Œä¸ä¼šåˆ é™¤è¿‡ç¨‹æ–‡ä»¶-15(é»˜è®¤å€¼)ï¼šä»¥æ­£å¸¸çš„ç¨‹åºæ–¹å¼ç»ˆæ­¢ä¸€é¡¹å·¥ä½œï¼Œä¼šåˆ é™¤è¿‡ç¨‹æ–‡ä»¶ */ è„±æœºç®¡ç†å¦‚æœä½ æ˜¯ä½¿ç”¨&amp;æ¥æ”¾ç½®åå°å·¥ä½œï¼Œå½“ä½ æ–­å¼€ä¸ç»ˆç«¯æœºçš„è¿æ¥ï¼ˆè„±æœºï¼‰ï¼Œé‚£ä¹ˆåå°å·¥ä½œå°±ä¼šè¢«ä¸­æ–­æ‰ã€‚å¦‚æœæˆ‘ä»¬ä¸æƒ³è¿™æ ·å°±å¯ä»¥ä½¿ç”¨atæˆ–è€…nohupå‘½ä»¤ï¼Œæˆ‘ä»¬ä¸»è¦è®²ä¸€ä¸‹nohupçš„è¿™ä¸ªå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥è®©ä½ åœ¨è„±æœºæˆ–æ³¨é”€ç³»ç»Ÿåï¼Œè¿˜èƒ½å¤Ÿè®©å·¥ä½œç»§ç»­è¿›è¡Œã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š12345// 1. åœ¨ç»ˆç«¯æœºå‰å°ä¸­å·¥ä½œnohup å‘½ä»¤// 1. åœ¨ç»ˆç«¯æœºåå°å·¥ä½œnohup å‘½ä»¤ &amp; å½“ä½ ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ä¹‹åï¼Œä½ ä¼šå‘ç°ä¼šå‡ºç°ä¸€ä¸ªnohup.outæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å…¶å®å°±æ˜¯å°†åŸæœ¬å‰å°æ˜¾ç¤ºçš„ä¸œè¥¿é‡å®šå‘åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚ è¿›ç¨‹ç®¡ç†è¿›ç¨‹çš„æŸ¥çœ‹é™æ€çš„psPSï¼šå¦‚æœman pageä¸å¥½æŸ¥é˜…ï¼Œæœ€å¥½æ˜¯ç›´æ¥è¢«å‡ ä¸ªå¸¸ç”¨çš„å‚æ•°ã€‚ è¿™ä¸ªå‘½ä»¤æ˜¯å°†æŸä¸ªæ—¶é—´ç‚¹çš„è¿›ç¨‹è¿è¡Œæƒ…å†µé€‰å–ä¸‹æ¥ï¼Œä¸»è¦çš„èŒƒä¾‹å¦‚ä¸‹ï¼š ä»…æŸ¥çœ‹è‡ªå·±çš„bashçš„ç›¸å…³è¿›ç¨‹ 123456789101112131415161718192021222324ps -l/* è¾“å‡ºåˆ—å­å¦‚ä¸‹ï¼šF S UID PID PPID C PRI NI ADDR SZ WCHAN TTY TIME CMD4 S 0 10573 10567 0 80 0 - 29064 wait pts/0 00:00:00 bashå«ä¹‰å¦‚ä¸‹ï¼šFï¼šç¨‹åºæ ‡è¯†ï¼ˆprocess flagsï¼‰ï¼Œè¯´æ˜ç¨‹åºçš„æƒé™ï¼Œ4ä»£è¡¨rootï¼Œ1ä»£è¡¨å­ç¨‹åºä»…èƒ½forkä¸èƒ½execSï¼šç¨‹åºçŠ¶æ€ï¼ˆstateï¼‰ï¼Œä¸»è¦æœ‰R(running)ã€S(sleep)ã€D(ä¸å¯å”¤é†’)ã€T(stop)ã€Zï¼ˆåƒµå°¸ï¼Œå‘½ä»¤ä½ä¼šè·Ÿ&lt;defunct&gt;ï¼‰UID/PID/PPID ï¼šPPIDæŒ‡çˆ¶ç¨‹åºçš„PIDCï¼šä»£è¡¨CPUä½¿ç”¨ç‡ï¼Œå•ä½ä¸ºç™¾åˆ†æ¯”PRI/NIï¼šæ­¤ç¨‹åºè¢«CPUæ‰§è¡Œä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå°ç¨‹åºä¼˜å…ˆçº§è¶Šé«˜ADDR/SZ/WCHANï¼šADDRä»£è¡¨åœ¨å†…å­˜å“ªä¸ªéƒ¨åˆ†ï¼ŒSZä»£è¡¨ç”¨æ‰å¤šå°‘å†…å­˜ï¼ŒWCHANè¡¨ç¤ºç¨‹åºæ˜¯å¦æ­£åœ¨è¿ä½œTTYï¼šç™»é™†è€…çš„ç»ˆç«¯æœºä½ç½®ï¼Œè¿œç¨‹ç™»å½•æ—¶ä¸º pts/nTIMEï¼šä½¿ç”¨æ‰çš„CPUæ—¶é—´ï¼Œç¨‹åºå®é™…èŠ±è´¹CPUè¿ä½œæ—¶é—´CMDï¼šè§¦å‘ç¨‹åºçš„æŒ‡ä»¤ */ æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹ï¼šps aux 12345678910111213141516171819202122232425262728ps aux/* è¾“å‡ºåˆ—å­å¦‚ä¸‹ï¼šUSER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMANDroot 1 0.0 0.1 43156 3136 ? Ss 3æœˆ10 1:27 /usr/lib/systemd/systemd --swiå«ä¹‰å¦‚ä¸‹ï¼šUSERï¼šè¯¥è¿›ç¨‹å±äºå“ªä¸ªç”¨æˆ·è´¦å·PID ï¼šè¿›ç¨‹ID%CPUï¼šè¯¥è¿›ç¨‹ä½¿ç”¨æ‰çš„CPUèµ„æºå†…å­˜ç™¾åˆ†æ¯”%MEMï¼šè¯¥è¿›ç¨‹æ‰€å ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”VSZï¼šè¯¥è¿›ç¨‹ä½¿ç”¨æ‰çš„è™šæ‹Ÿå†…å­˜é‡ï¼ˆKBï¼‰RSSï¼šè¯¥è¿›ç¨‹å ç”¨çš„å›ºå®šçš„å†…å­˜é‡ï¼ˆKBï¼‰TTYï¼šç™»é™†è€…çš„ç»ˆç«¯æœºä½ç½®ï¼Œè¿œç¨‹ç™»å½•æ—¶ä¸º pts/nSTATï¼šä¸ps -lçš„Sè¡¨ç¤ºç›¸åŒSTARTï¼šè¯¥è¿›ç¨‹è¢«è§¦å‘å¯åŠ¨çš„æ—¶é—´TIMEï¼šç¨‹åºå®é™…èŠ±è´¹CPUè¿ä½œæ—¶é—´CMDï¼šè¯¥è¿›ç¨‹çš„å®é™…å‘½ä»¤ */ åŠ¨æ€çš„topè¿™ä¸ªå‘½ä»¤å¯ä»¥æŒç»­çš„æ£€æµ‹è¿›ç¨‹è¿è¡Œçš„çŠ¶æ€ï¼Œä¸»è¦èŒƒä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425// 1. æ¯ä¸¤ç§’æ›´æ–°ä¸€æ¬¡topï¼ŒæŸ¥çœ‹æ•´ä½“ä¿¡æ¯ï¼Œé»˜è®¤5ç§’top -d 2/* è¾“å‡ºä¾‹å­ï¼štop - 10:54:10 up 22 days, 19:25, 1 user, load average: 0.13, 0.07, 0.06Tasks: 69 total, 2 running, 66 sleeping, 1 stopped, 0 zombie%Cpu(s): 0.5 us, 0.0 sy, 0.0 ni, 99.5 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 stKiB Mem : 1883844 total, 77012 free, 356884 used, 1449948 buff/cacheKiB Swap: 0 total, 0 free, 0 used. 1328820 avail Mem PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND 1861 root 20 0 608356 12236 1788 S 0.5 0.6 60:48.59 barad_agent topè§ç•Œé¢ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªç•Œé¢ï¼š ä¸Šé¢ä¸ºæ•´ä¸ªç³»ç»Ÿçš„èµ„æºä½¿ç”¨çŠ¶æ€ï¼ŒåŸºæœ¬ä¸Šæ€»å…±æœ‰å…­è¡Œï¼Œæ˜¾ç¤ºçš„å†…å®¹ä¾æ¬¡æ˜¯ï¼š 1. ç›®å‰çš„æ—¶é—´ï¼Œå¼€æœºåˆ°ç›®å‰ä¸ºæ­¢æ‰€ç»è¿‡çš„æ—¶é—´ï¼Œå·²ç»ç™»å½•ç³»ç»Ÿçš„çš„ç”¨æˆ·æ•°,ç³»ç»Ÿåœ¨1ï¼Œ5ï¼Œ15åˆ†é’Ÿçš„å¹³å‡å·¥ä½œè´Ÿè½½ 2. ç›®å‰è¿›ç¨‹çš„æ€»é‡ä¸å„ä¸ªç´¯å‘—è¿›ç¨‹çš„æ€»é‡ï¼Œæ³¨æ„zombieåƒµå°¸è¿›ç¨‹çš„æ•°é‡ 3. CPUçš„æ•´ä½“è´Ÿè½½ï¼Œæ³¨æ„waï¼ˆI/Owaitï¼‰ 4. ç‰©ç†å†…å­˜çš„ä½¿ç”¨æƒ…å†µ 5. è™šæ‹Ÿå†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼Œswapçš„æ˜¯ç”¨æ¥ä¸€å®šè¦å° 6. è¿™ä¸ªæ˜¯å½“åœ¨topè¿›ç¨‹ä¸­è¾“å…¥å‘½ä»¤æ—¶æ˜¾ç¤ºçŠ¶æ€çš„åœ°æ–¹ï¼Œè¾“å…¥rå¯ä¿®æ”¹niceå€¼ ä¸‹é¢ä¸ºæ¯ä¸ªè¿›ç¨‹ä½¿ç”¨èµ„æºæƒ…å†µï¼Œå„ä¸ªå‚æ•°å«ä¹‰å¯å‚ç…§psã€‚ */ è¿›ç¨‹æ ‘pstreeå¦‚æœæƒ³æ‰¾åˆ°è¿›ç¨‹ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œè¿™ä¸ªpstreeå°±èƒ½å¤Ÿå¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬ï¼Œå®ƒä¼šä½¿ç”¨çº¿æ®µå°†ç›¸å…³æ€§è¿›ç¨‹è¿æ¥èµ·æ¥ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š1234567891011// 1.åˆ—å‡ºç›®å‰ç³»ç»Ÿä¸Šé¢æ‰€æœ‰çš„è¿›ç¨‹æ•°çš„ç›¸å…³æ€§pstree -Aè¾“å…¥å¦‚ä¸‹ï¼šsystemd-+-acpid |-2*[agetty] |-atd |-auditd---&#123;auditd&#125; ...// 2. åœ¨1çš„åŸºç¡€ä¸Šï¼ŒåŒæ—¶æ˜¾ç¤ºå‡ºPIDä¸userspstree -Aup è¿›ç¨‹çš„æ‰§è¡Œé¡ºåºCPUä¼˜å…ˆå¤„ç†å“ªä¸ªè¿›ç¨‹ï¼Œè¿™å°±éœ€è¦è€ƒè™‘åˆ°ç¨‹åºçš„ä¼˜å…ˆæ‰§è¡Œåº(priority)ä¸CPUçš„è°ƒåº¦ã€‚å…·ä½“åˆ°å€¼æ¥è¯´å°±æ˜¯è¦è€ƒè™‘åˆ°PRIå’Œniceå€¼ï¼ˆä¹‹å‰ç”¨topå’Œpsæ˜¾ç¤ºè¿‡ï¼‰ã€‚PRIå€¼è¶Šä½ä»£è¡¨è¶Šä¼˜å…ˆï¼Œä¸è¿‡è¿™ä¸ªPRIå€¼æ˜¯ç”±å†…æ ¸åŠ¨æ€è°ƒæ•´çš„ï¼Œå…·æœ‰æ— æ³•è°ƒæ•´ï¼Œä½†æ˜¯Niceå€¼æˆ‘ä»¬å¯ä»¥æ”¹å˜ã€‚ä¸‹é¢çš„PRIå€¼æ”¹å˜çš„å…¬å¼ï¼š PRI(new) = PRI(old) + nice ä¸‹é¢æ˜¯å…³äºniceå€¼çš„ä½¿ç”¨èŒƒä¾‹ï¼š12345// 1. åœ¨ä½¿ç”¨å‘½ä»¤çš„æ—¶å€™è®¾ç½®niceå€¼ï¼Œç»™niceå€¼ä¸º-5å»æ‰§è¡Œvinice -n vi &amp;// 2. å·²å­˜åœ¨è¿›ç¨‹çš„niceé‡æ–°åˆ†é…ï¼Œå°†PIDä¸º18625çš„è¿›ç¨‹niceå€¼è°ƒæ•´åˆ°10renice 10 18625 ç³»ç»Ÿèµ„æºçš„æŸ¥çœ‹ æŸ¥çœ‹å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 12// 1. æŸ¥çœ‹ç›®å‰ç³»ç»Ÿçš„å†…å­˜å®¹é‡free -m æŸ¥çœ‹ç³»ç»Ÿä¸å†…æ ¸ç›¸å…³ä¿¡æ¯ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 12// 1. è¾“å‡ºç³»ç»Ÿçš„åŸºæœ¬ä¿¡æ¯uname -a æŸ¥çœ‹ç³»ç»Ÿå¯åŠ¨æ—¶é—´ä¸å†…å­˜è´Ÿè½½ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 1uptime è·Ÿè¸ªç½‘ç»œ(å¾ˆé‡è¦)ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 12345// 1. åˆ—å‡ºç›®å‰ç³»ç»Ÿä»¥åŠæ–°å»ºçš„ç½‘ç»œè¿æ¥ä¸unix socketçŠ¶æ€netstat// 2. æ‰¾å‡ºç›®å‰ç³»ç»Ÿä¸Šå·²åœ¨ç›‘å¬çš„ç½‘ç»œè¿æ¥æœºåŠå…¶PID(å¾ˆé‡è¦)netstat -tlnp åˆ†æå†…æ ¸äº§ç”Ÿçš„ä¿¡æ¯ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 12345// 1. è¾“å‡ºæ‰€æœ‰çš„å†…æ ¸å¼€æœºæ—¶çš„ä¿¡æ¯dmesg | more// 2. æŸ¥æ‰¾å¼€æœºçš„æ—¶å€™ç¡¬ç›˜çš„ç›¸å…³ä¿¡æ¯dmesg | grep i hd æ£€æµ‹ç³»ç»Ÿèµ„æºå˜åŒ–ï¼ŒèŒƒä¾‹å¦‚ä¸‹ï¼š 1234567// 1. ç»Ÿè®¡ç›®å‰ä¸»æœºCPUçŠ¶æ€ï¼Œæ¯ç§’ä¸€æ¬¡ï¼Œå…±è®¡ä¸‰æ¬¡vmstat 1 3// 2. ç³»ç»Ÿä¸Šé¢æ‰€æœ‰ç£ç›˜çš„è¯»å†™çŠ¶æ€vmstat -dPSï¼šè¯¦ç»†çš„å„ä¸ªå­—æ®µçš„å«ä¹‰ï¼Œå¤§å®¶å°±è‡ªå·±æŸ¥è¯¢man vmstatå¥½äº†ï¼Œä¹ æƒ¯å°±å¥½ã€‚ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_ä¾‹è¡Œæ€§å·¥ä½œ(crontab)]]></title>
    <url>%2F2018%2F03%2F31%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E4%BE%8B%E8%A1%8C%E6%80%A7%E5%B7%A5%E4%BD%9C(crontab)%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç³»ç»Ÿå¸¸å¸¸ä¼šä¸»åŠ¨è¿›è¡Œä¸€äº›ä»»åŠ¡ï¼Œè¿™ä¾é çš„å°±æ˜¯è®¾ç½®äº†ä¾‹è¡Œæ€§å·¥ä½œã€‚ ä»€ä¹ˆæ˜¯ä¾‹è¡Œæ€§å·¥ä½œï¼ˆå®šæ—¶ä»»åŠ¡crontabï¼‰æ ¹æ®å•è¯crontabï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰å°±å¯ä»¥çŸ¥é“ ä¾‹è¡Œæ€§å·¥ä½œ å…¶å®å°±æ˜¯æ¯å¤©éƒ½ä¼šå¹²çš„äº‹ã€‚ Linuxå·¥ä½œè°ƒåº¦çš„ç§ç±» ä¾‹è¡Œæ€§çš„ï¼Œå°±æ˜¯æ¯éš”ä¸€å®šçš„å‘¨æœŸè¦æ¥åŠçš„äº‹ï¼Œåˆ©ç”¨crontabå®ç°ï¼Œè¿™ä¸ªå‘½ä»¤æ‰€è®¾ç½®çš„å·¥ä½œå°†ä¼šå¾ªç¯ä¸€ç›´è¿›è¡Œä¸‹å»ï¼Œå¯å¾ªç¯çš„æ—¶é—´ä¸ºåˆ†é’Ÿï¼Œå°æ—¶ï¼Œæ¯å‘¨ï¼Œæ¯æœˆæˆ–æ¯å¹´ç­‰ï¼Œcrontabé™¤äº†å¯ä»¥ä½¿ç”¨å‘½ä»¤æ‰§è¡Œå¤–ï¼Œä¹Ÿå¯ç¼–è¾‘/etc/crontabæ¥æ”¯æŒã€‚è‡³äºè®©crontabå¯ä»¥ç”Ÿæ•ˆçš„åå°æœåŠ¡æ˜¯crondè¿™ä¸ªæœåŠ¡ã€‚ çªå‘æ€§çš„ï¼Œå°±æ˜¯è¿™æ¬¡åšå®Œä»¥åå°±æ²¡æœ‰çš„äº‹ï¼Œåˆ©ç”¨atå®ç°ï¼Œä½†æ˜¯è¿™ä¸ªå¿…é¡»è¦æœ‰atdåå°æœåŠ¡æ”¯æŒæ‰è¡Œã€‚ Linuxä¸Šå¸¸è§çš„ä¾‹è¡Œæ€§å·¥ä½œ è¿›è¡Œæ—¥å¿—æ–‡ä»¶çš„è½®æ›¿ï¼Œè®©æ—§çš„æ•°æ®å’Œæ–°çš„æ•°æ®åˆ†å¼€å­˜æ”¾ æ—¥å¿—æ–‡ä»¶åˆ†ælogwatchçš„ä»»åŠ¡ æ–°å»ºlocateçš„æ•°æ®åº“ï¼Œç³»ç»Ÿä¼šä¸»åŠ¨è¿›è¡Œupdatedb whatisæ•°æ®åº“çš„å»ºç«‹ åˆ é™¤ä¸´æ—¶æ–‡ä»¶ ä»…æ‰§è¡Œä¸€æ¬¡çš„å·¥ä½œè°ƒåº¦ï¼šatatçš„è¿è¡Œæ–¹å¼æˆ‘ä»¬ä½¿ç”¨atè¿™ä¸ªå‘½ä»¤æ¥ç”Ÿæˆæ‰€è¦è¿›è¡Œçš„å·¥ä½œï¼Œå¹¶å°†è¿™ä¸ªå·¥ä½œä»¥æ–‡æœ¬æ–‡ä»¶çš„æ–¹å¼å†™å…¥/var/spool/atç›®å½•ä¸­ï¼Œè¯¥å·¥ä½œä¾¿èƒ½ç­‰å¾…atdè¿™ä¸ªæœåŠ¡çš„å–ç”¨ä¸æ‰§è¡Œäº†ã€‚ä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„äººéƒ½å¯ä»¥è¿›è¡Œatå·¥ä½œè°ƒåº¦å·¥ä½œçš„ï¼Œå› ä¸ºå®‰å…¨ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨/etc/at.allowä¸/etc/at.denyè¿™ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œatçš„ä½¿ç”¨é™åˆ¶ï¼ŒåŠ ä¸Šè¿™ä¸¤ä¸ªæ–‡ä»¶åï¼Œatçš„å·¥ä½œæƒ…å†µå…¶å®æ˜¯è¿™æ ·çš„ï¼š å…ˆå¯»æ‰¾/etc/at.allowè¿™ä¸ªæ–‡ä»¶ï¼Œå†™åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­çš„ç”¨æˆ·æ‰èƒ½ä½¿ç”¨atï¼Œæ²¡æœ‰åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­çš„ç”¨æˆ·åˆ™ä¸èƒ½ä½¿ç”¨at(å³æ—¶æ²¡æœ‰å†™åœ¨at.denyå½“ä¸­) å¦‚æœ/etc/at.allowä¸å­˜åœ¨ï¼Œå°±å¯»æ‰¾/etc/at.denyè¿™ä¸ªæ–‡ä»¶ï¼Œè‹¥å¸è½½è¿™ä¸ªat.denyçš„ç”¨æˆ·åˆ™ä¸èƒ½ä½¿ç”¨atï¼Œè€Œæ²¡æœ‰åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­çš„ç”¨æˆ·å°±å¯ä»¥ä½¿ç”¨atäº† å¦‚æœè¿™ä¸¤ä¸ªæ–‡ä»¶éƒ½ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±åªæœ‰rootå¯ä»¥ä½¿ç”¨atè¿™ä¸ªå‘½ä»¤ å®é™…è¿è¡Œå•ä¸€å·¥ä½œè°ƒåº¦å•ä¸€å·¥ä½œè°ƒåº¦çš„è¿›è¡Œå°±ä½¿ç”¨atè¿™ä¸ªå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤çš„è¿è¡Œååˆ†ç®€å•ï¼å°†atåŠ ä¸Šä¸€ä¸ªæ—¶é—´å³å¯ï¼èŒƒä¾‹å…¥ä¸‹ï¼š12345// 1. at [-mldv] TIMEat noe + 5 minutes // å†è¿‡äº”åˆ†é’Ÿæ‰§è¡Œï¼Œæ¥ä¸‹æ¥è¾“å…¥æ‰§è¡Œçš„å‘½ä»¤ï¼Œä½¿ç”¨ctrl + d ç»“æŸã€‚// 2. at -c å·¥ä½œå·ç  // å°†ç¬¬å‡ å·å·¥ä½œè°ƒå‡ºæ¥æŸ¥çœ‹at -c 1 // å°†ç¬¬ä¸€å·å·¥ä½œè°ƒå‡ºæ¥ äº‹å®ä¸Šï¼Œå½“æˆ‘ä»¬ä½¿ç”¨atæ—¶ä¼šè¿›å…¥ä¸€ä¸ªat shellçš„ç¯å¢ƒæ¥è®©ç”¨æˆ·æ‰§è¡Œå·¥ä½œå‘½ä»¤ï¼Œæ­¤æ—¶ï¼Œå»ºè®®ä½ æœ€å¥½ä½¿ç”¨ç»å¯¹è·¯å¾„æ¥æ‰§è¡Œä½ çš„å‘½ä»¤ï¼Œæ¯”è¾ƒä¸ä¼šæœ‰é—®é¢˜ã€‚ atè¿˜æœ‰ä¸€ä¸ªå¾ˆæ£’çš„ä¼˜ç‚¹å°±æ˜¯åå°æ‰§è¡Œçš„åŠŸèƒ½ï¼Œå’Œnohupç±»ä¼¼ã€‚ atçš„å·¥ä½œç®¡ç† ä¸»è¦æ˜¯åˆ©ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š12345# æŸ¥è¯¢ç›®å‰ä¸»æœºä¸Šé¢æœ‰å¤šå°‘çš„atå·¥ä½œè°ƒåº¦atq# å°†ç¬¬3ä¸ªå·¥ä½œåˆ é™¤atrm 3 å¾ªç¯æ‰§è¡Œçš„ä¾‹è¡Œæ€§å·¥ä½œè°ƒåº¦ç›¸å¯¹äºatæ˜¯ä»…æ‰§è¡Œä¸€æ¬¡çš„å·¥ä½œï¼Œå¾ªç¯æ‰§è¡Œçš„ä¾‹è¡Œæ€§å·¥ä½œè°ƒåº¦å®¤å‹crondè¿™ä¸ªç³»ç»ŸæœåŠ¡æ¥æ§åˆ¶çš„ï¼Œç”±äºLinuxç³»ç»Ÿä¸ŠåŸæœ¬å°±æœ‰å¾ˆå¤šçš„ä¾‹è¡Œæ€§å·¥ä½œï¼Œæ‰€ä»¥è¿™ä¸ªç³»ç»ŸæœåŠ¡æ˜¯é»˜è®¤å¼€å¯çš„ã€‚å¦å¤–ï¼Œç”±äºç”¨æˆ·è‡ªå·±ä¹Ÿå¯ä»¥è¿›è¡Œä¾‹è¡Œæ€§å·¥ä½œè°ƒåº¦ï¼Œæ‰€ä»¥ï¼ŒLinuxå¯æä¾›ç”¨æˆ·æ§åˆ¶ä¾‹è¡Œæ€§å·¥ä½œè°ƒåº¦çš„å‘½ä»¤ï¼ˆcrontabï¼‰ã€‚ ç”¨æˆ·çš„è®¾ç½®ä¸ä½¿ç”¨ä¸ºäº†å®‰å…¨æ€§çš„é—®é¢˜ï¼Œä¸atç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥é™åˆ¶ä½¿ç”¨crontabçš„ç”¨æˆ·è´¦å·ã€‚ä½¿ç”¨çš„é™åˆ¶æ•°æ®æœ‰ï¼š /etc/cron.allowï¼šå°†å¯ä»¥ä½¿ç”¨crontabçš„è´¦å·å†™å…¥å…¶ä¸­ï¼Œè‹¥ä¸åœ¨è¿™ä¸ªæ–‡ä»¶å†…çš„ç”¨æˆ·åˆ™ä¸å¯ä½¿ç”¨crontabã€‚ /etc/cron.denyï¼šå°†ä¸å¯ä»¥ä½¿ç”¨crontabçš„è´¦å·å†™å…¥å…¶ä¸­ï¼Œè‹¥ä¸ºè®°å½•åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­çš„ç”¨æˆ·ï¼Œå°±å¯ä»¥ä½¿ç”¨crontabã€‚ ä»¥ä¼˜å…ˆçº§æ¥è¯´ï¼Œ/etc/cron.allowæ¯”/etc/cron.denyè¦ä¼˜å…ˆï¼Œè€Œåˆ¤æ–­ä¸Šé¢ï¼Œä¸¤ä¸ªæ–‡ä»¶åªé€‰æ‹©ä¸€ä¸ªæ¥é™åˆ¶è€Œå·²ï¼Œå› æ­¤ï¼Œå»ºè®®ä½ åªè¦ä¿ç•™ä¸€ä¸ªå³å¯ã€‚ å½“ç”¨æˆ·ä½¿ç”¨crontabè¿™ä¸ªå‘½ä»¤æ¥æ–°å»ºå·¥ä½œè°ƒåº¦ä¹‹åï¼Œè¯¥é¡¹å·¥ä½œå°±ä¼šè¢«è®°å½•/var/spool/cron/é‡Œé¢ï¼Œè€Œä¸”æ˜¯ä»¥è´¦å·æ¥åŒºåˆ†çš„ã€‚å¦å¤–ï¼Œcronæ‰§è¡Œçš„æ¯ä¸€é¡¹å·¥ä½œéƒ½ä¼šè¢«è®°å½•åˆ°/var/log/cronè¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä½ çš„Linuxä¸çŸ¥é“æ˜¯å¦è¢«æ¤å…¥å¯†ç ï¼Œä¹Ÿå¯ä»¥æŸ¥è¯¢ä¸€ä¸‹è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚ ä¸‹é¢æ˜¯å®ƒçš„ä½¿ç”¨èŒƒä¾‹ï¼š12345678910111213// 1. ç”¨rootçš„èº«ä»½åœ¨æ¯å¤©çš„12:00å’Œ14:00æŸ¥çœ‹ä¸»æ–‡ä»¶å¤¹ç›®å½•ÃŸ# ç¼–è¾‘crontabçš„å·¥ä½œå†…å®¹crontab -e# è¿›å…¥viç•Œé¢ï¼Œæ¯é¡¹å·¥ä½œéƒ½æ˜¯ä¸€è¡Œ0 12,14 * * * ls / // è§£é‡Šå„åˆ—å«ä¹‰ï¼š// 1. åˆ†ï¼›2. å°æ—¶ï¼›3. æ—¥æœŸï¼›4. æœˆä»½; 5. å‘¨ï¼› 6. å‘½ä»¤// å…¶ä¸­â€œ,â€è¡¨ç¤ºåˆ†å‰²æ—¶æ®µï¼Œâ€œ-â€è¡¨ç¤ºä¸€æ®µæ—¶é—´èŒƒå›´ï¼Œ/n è¡¨ç¤ºæ¯éš”nå•ä½é—´éš”// 2. æŸ¥è¯¢crontabä»»åŠ¡crontab -l// 3. è‹¥è¦åˆ é™¤ä¸€é¡¹å·¥ä½œï¼Œå¿…é¡»è¦ç”¨crontab -eå»ç¼–è¾‘ï¼Œå¦‚æœæƒ³è¦åˆ é™¤å…¨éƒ¨å·¥ä½œï¼Œå¦‚ä¸‹ï¼šcrontab -r ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶ï¼š/etc/crontabcrontab -eæ˜¯é’ˆå¯¹ç”¨æˆ·çš„ä¾‹è¡Œæ€§å·¥ä½œæ¥è®¾è®¡çš„ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¿®æ”¹ç³»ç»Ÿçš„ä¾‹è¡Œæ€§ä»»åŠ¡ï¼Œå°±éœ€è¦ç¼–è¾‘/etc/crontabäº†ã€‚ åŸºæœ¬ä¸Šï¼Œcronè¿™ä¸ªæœåŠ¡çš„æœ€ä½æ£€æµ‹é™åˆ¶æ˜¯â€œåˆ†é’Ÿâ€ï¼Œæ‰€ä»¥cronä¼šæ¯åˆ†é’Ÿå»è¯»å–ä¸€æ¬¡/etc/crontabä¸/var/spool/croné‡Œé¢çš„æ•°æ®å†…å®¹ã€‚ å¯å”¤é†’åœæœºæœŸé—´çš„å·¥ä½œä»»åŠ¡å¦‚æœä¾‹è¡Œæ€§å·¥ä½œæ˜¯åœ¨å‡Œæ™¨4ç‚¹è¿è¡Œçš„ï¼Œä½†æ˜¯åˆšå¥½å…³æœºäº†ï¼Œ ä½ 7ç‚¹å¼€æœºäº†ï¼Œä½ æ€»ä¸èƒ½ä¸ç®¡å®ƒå§ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°anacronã€‚ ä»€ä¹ˆæ˜¯anacronanacronå­˜åœ¨çš„ç›®çš„ æ˜¯å¤„ç†é24å°æ—¶ä¸€ç›´å¯åŠ¨çš„linuxç³»ç»Ÿçš„crontabçš„æ‰§è¡Œã€‚ anacronä¹Ÿæ˜¯é€šè¿‡crontabæ¥è¿è¡Œçš„ï¼Œå› æ­¤anacronçš„è¿è¡Œçš„æ—¶é—´é€šå¸¸æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯ç³»ç»Ÿå¼€æœºæœŸé—´è¿è¡Œï¼Œä¸€ä¸ªæ˜¯å†™å…¥crontabçš„è°ƒåº¦ä¸­ã€‚ anacronä½¿ç”¨anacronçš„è¯­æ³•å¦‚ä¸‹ï¼š1anacron [-sfn] [job] å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_è´¦å·ç®¡ç†]]></title>
    <url>%2F2018%2F03%2F31%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç®¡ç†å‘˜çš„å·¥ä½œä¸­ï¼Œç›¸å¯¹é‡è¦çš„ä¸€ç¯å°±æ˜¯â€œè´¦å·ç®¡ç†â€ã€‚å› ä¸ºæ•´ä¸ªç³»ç»Ÿéƒ½æ˜¯ä½ åœ¨ç®¡ç†ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ä¸€èˆ¬ç”¨æˆ·çš„è´¦å·ç”³è¯·å¿…é¡»è¦é€šè¿‡ä½ çš„ååŠ©æ‰è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»è¦çŸ¥é“å¦‚æœç®¡ç†å¥½ä¸€ä¸ªæœåŠ¡å™¨ä¸»æœºçš„è´¦å·ï¼ è´¦å·ä¸ç”¨æˆ·ç»„åœ¨ç®¡ç†Linuxè´¦å·æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è¦å…ˆäº†è§£ä¸€ä¸‹Linuxåˆ°åº•æ˜¯å¦‚ä½•è¾¨åˆ«æ¯ä¸€ä¸ªç”¨æˆ·çš„ã€‚ ç”¨æˆ·è¡¨ç¤ºç¬¦ï¼šUIDä¸GIDè™½ç„¶æˆ‘ä»¬ç™»å½•Linuxä¸»æœºçš„æ—¶å€™ï¼Œè¾“å…¥çš„æ˜¯æˆ‘ä»¬çš„è´¦å·ï¼Œä½†æ˜¯å…¶å®Linuxä¸»æœºå¹¶ä¸ä¼šç›´æ¥è®¤è¯†ä½ çš„è´¦å·ï¼Œå®ƒä»…è®¤è¯†IDï¼Œè€Œä½ çš„IDåŸŸè´¦å·çš„å¯¹åº”å…³ç³»å°±åœ¨/etc/passwdå½“ä¸­ã€‚ æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½å…·æœ‰æ‰€æœ‰è€…ä¸æ‰€å±ç”¨æˆ·ç»„çš„å±æ€§ï¼Œæ‰€ä»¥æ¯ä¸ªç™»å½•çš„ç”¨æˆ·è‡³å°‘ä¼šå–å¾—ä¸¤ä¸ªIDï¼Œä¸€ä¸ªæ˜¯ç”¨æˆ·ID(UID)ï¼Œä¸€ä¸ªæ˜¯ç”¨æˆ·ç»„ID(GID)ã€‚ ç”¨æˆ·è´¦å·Linyxç³»ç»Ÿä¸Šé¢çš„ç”¨æˆ·å¦‚æœéœ€è¦ç™»å½•ä¸»æœºä»¥å–å¾—shellçš„å·¥ä½œç¯å¢ƒï¼Œå®ƒå¿…é¡»è¦åœ¨è®¡ç®—æœºå‰é¢åˆ©ç”¨tty1~tty7çš„ç»ˆç«¯æœºæä¾›çš„loginæ¥å£ï¼Œå¹¶è¾“å…¥è´¦å·ä¸å¯†ç åæ‰èƒ½ç™»å½•ã€‚å½“æˆ‘ä»¬è¾“å…¥è´¦å·å¯†ç åï¼Œç³»ç»Ÿä¸»è¦åšäº†å¦‚ä¸‹å·¥ä½œï¼š å…ˆå¯»æ‰¾/etc/passwdé‡Œé¢æ˜¯å¦æœ‰ä½ è¾“å…¥çš„å¸å·ï¼Ÿå¦‚æœæ²¡æœ‰åˆ™è·³å‡ºï¼Œå¦‚æœæœ‰çš„è¯åˆ™å°†è¯¥å¸å·å¯¹åº”çš„UIDä¸GIDï¼ˆåœ¨/etc/groupä¸­ï¼‰è¯»å‡ºæ¥ï¼Œå¦å¤–ï¼Œè¯¥å¸å·çš„ä¸»æ–‡ä»¶å¤¹ä¸shellè®¾å®šä¹Ÿä¸€å¹¶è¯»å‡ºã€‚ å†æ¥åˆ™æ˜¯æ ¸å¯¹å¯†ç è¡¨å•¦ï¼è¿™æ˜¯Linuxä¼šè¿›å…¥/etc/shadowé‡Œé¢æ‰¾å‡ºå¯¹åº”çš„å¸å·ä¸UIDï¼Œç„¶åæ ¸å¯¹ä¸€ä¸‹ä½ åˆšåˆšè¾“å…¥çš„å¯†ç ä¸é‡Œé¢çš„å¯†ç æ˜¯å¦ç›¸ç¬¦ã€‚ å¦‚æœä¸€åˆ‡éƒ½OKçš„è¯ï¼Œå°±è¿›å…¥Shellæ§ç®¡çš„é˜¶æ®µå’¯ï¼ /etc/passwdæ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š è¿™ä¸ªæ–‡ä»¶çš„æ„é€ æ˜¯è¿™æ ·çš„ï¼šæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå¸å·ï¼Œæœ‰å‡ è¡Œå°±ä»£è¡¨æœ‰å‡ ä¸ªå¸å·åœ¨ä½ çš„ç³»ç»Ÿä¸­ï¼ä¸è¿‡éœ€è¦ç‰¹åˆ«ç•™æ„çš„æ˜¯ï¼Œé‡Œå¤´å¾ˆå¤šå¸å·æœ¬èº«å°±æ˜¯ç³»ç»Ÿæ­£å¸¸è¿ä½œæ‰€å¿…é¡»è¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç®€ç§°ä¸ºç³»ç»Ÿå¸å·ï¼Œå¦‚binï¼Œdaemonï¼Œadmï¼Œnobodyç­‰ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æ¯ä¸ªLinuxç³»ç»Ÿéƒ½ä¼šæœ‰çš„ç¬¬ä¸€è¡Œï¼Œå°±æ˜¯rootè¿™ä¸ªç³»ç»Ÿç®¡ç†å‘˜é‚£ä¸€è¡Œå¥½äº†ï¼Œä½ å¯ä»¥æ˜æ˜¾çš„çœ‹å‡ºæ¥ï¼Œæ¯ä¸€è¡Œä½¿ç”¨ï¼šåˆ†éš”ï¼Œå…±æœ‰ä¸ƒä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯ å­—æ®µå· å­—æ®µå«ä¹‰ 1 è´¦å·åç§° 2 å¯†ç ï¼Œè¢«è¯¥æ”¾åˆ°/etc/shadowæ–‡ä»¶ä¸­ï¼Œä»¥xä»£æ›¿ 3 UIDï¼Œ0ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œå¯ä»¥å¤šä¸ªè´¦å·çš„UIDä¸º0ï¼Œä½†ä¸å»ºè®®ã€‚1~99ä¸ºå‘ç°ç‰ˆè‡ªå»ºç³»ç»Ÿè´¦å·ï¼Œ100~499ä¸ºç”¨æˆ·ä½¿ç”¨çš„ç³»ç»Ÿè´¦å·ï¼Œ500~*ä¸ºä¸€èˆ¬ç”¨æˆ·å¯ç™»å½•è´¦å· 4 å¯†ç ï¼ŒGIDï¼Œä¸/etc/groupæœ‰å…³ 5 ç”¨æˆ·ä¿¡æ¯è¯´æ˜ 6 ä¸»æ–‡ä»¶å¤¹ 7 shell /etc/shadowæ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š æ–‡ä»¶æ„é€ åŸºæœ¬ä¸/etc/passwdä¸€æ ·ï¼Œä½†æ˜¯å®ƒæœ‰9ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯ï¼š å­—æ®µå· å­—æ®µå«ä¹‰ 1 è´¦å·åç§°ï¼Œéœ€è¦ä¸/etc/passwdå¯¹åº” 2 å¯†ç ï¼Œä½†æ˜¯è¢«åŠ å¯†è¿‡çš„ 3 æœ€è¿‘æ›´æ”¹å¯†ç çš„æ—¥æœŸï¼Œä»¥1970å¹´1æœˆ1å·ä½œä¸º1è€Œç´¯åŠ çš„æ—¥æœŸ 4 å¯†ç ä¸å¯è¢«æ›´åŠ¨çš„æ—¥æœŸ 5 å¯†ç éœ€è¦é‡æ–°æ›´æ”¹çš„å¤©æ•° 6 å¯†ç éœ€è¦æ›´æ”¹æœŸé™å‰çš„è­¦å‘Šå¤©æ•° 7 å¯†ç è¿‡æœŸåçš„è´¦å·å®½é™æ—¶é—´ï¼ˆå¯†ç å¤±æ•ˆæ—¥ï¼‰ 8 è´¦å·å¤±æ•ˆæ—¥æœŸ 9 ä¿ç•™ï¼Œç”¨äºä»¥åæ‰©å±• æœ‰æ•ˆä¸åˆå§‹ç”¨æˆ·ç»„ï¼šgroupsï¼Œnewgrp /etc/groupæ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š æ–‡ä»¶æ„é€ åŸºæœ¬ä¸/etc/passwdä¸€æ ·ï¼Œä½†æ˜¯å®ƒæœ‰4ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯ï¼š å­—æ®µå· å­—æ®µå«ä¹‰ 1 ç”¨æˆ·ç»„åç§° 2 ç”¨æˆ·ç»„å¯†ç ï¼Œä»¥xä»£æ›¿ 3 GIDï¼Œ/etc/passwdç¬¬å››ä¸ªå­—æ®µä½¿ç”¨çš„GIDå¯¹åº”çš„ç”¨æˆ·ç»„åå°±æ˜¯ç”±è¿™é‡Œæ¥çš„ 4 ç”¨æˆ·ç»„æ”¯æŒçš„è´¦å·åç§°ï¼Œå¤šç”¨æˆ·ä»¥â€,â€åˆ†å‰² æˆ‘ä»¬çŸ¥é“ç”¨æˆ·å¯ä»¥åŒæ—¶åŠ å…¥å¤šä¸ªç”¨æˆ·ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æ‰§è¡Œå·¥ä½œæ—¶ï¼Œåˆ°åº•æ˜¯ä»¥å“ªä¸ªç”¨æˆ·ç»„ä¸ºå‡†å‘¢ï¼Ÿï¼Œè¿™å°±éœ€è¦å¼•å…¥æœ‰æ•ˆç”¨æˆ·ç»„çš„æ¦‚å¿µã€‚ /etc/gshadowæ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š æ–‡ä»¶æ„é€ åŸºæœ¬ä¸/etc/groupä¸€æ ·ï¼Œå®ƒæœ‰4ä¸ªå­—æ®µï¼Œåˆ†åˆ«æ˜¯ï¼š å­—æ®µå· å­—æ®µå«ä¹‰ 1 ç”¨æˆ·ç»„åç§° 2 ç”¨æˆ·ç»„å¯†ç ,å¼€å¤´ä¸º!è¡¨ç¤ºæ— åˆæ³•å¯†ç ï¼Œæ‰€ä»¥æ— ç”¨æˆ·ç»„ç®¡ç†å‘˜ 3 ç”¨æˆ·ç»„ç®¡ç†å‘˜çš„è´¦å·ï¼Œç”¨æˆ·ç»„ç®¡ç†å‘˜èƒ½å¤Ÿå°†è´¦å·æ·»åŠ åˆ°è‡ªå·±ç®¡ç†çš„ç”¨æˆ·ç»„ä¸­ 4 è¯¥ç”¨æˆ·ç»„çš„æ‰€å±è´¦å·ï¼ˆä¸/etc/groupå†…å®¹ç›¸åŒï¼‰ æœ‰æ•ˆç”¨æˆ·ç»„ä¸åˆå§‹ç”¨æˆ·ç»„ åˆå§‹ç”¨æˆ·ç»„ï¼šå°±æ˜¯/etc/passwdé‡Œé¢çš„ç¬¬å››åˆ—çš„GIDï¼Œå½“ç”¨æˆ·ç™»å½•ç³»ç»Ÿï¼Œç«‹åˆ»å°±æ‹¥æœ‰è¿™ä¸ªç”¨æˆ·ç»„çš„ç›¸å…³æƒé™ã€‚ æœ‰æ•ˆç”¨æˆ·ç»„ï¼šå°±æ˜¯åˆ©ç”¨groupså‘½ä»¤çœ‹åˆ°çš„ç¬¬ä¸€ä¸ªç”¨æˆ·ç»„ï¼Œå¯ä»¥åˆ©ç”¨newgrpå‘½ä»¤æ›´æ”¹æœ‰æ•ˆç”¨æˆ·ç»„ï¼Œnewgrpå‘½ä»¤æ›´æ”¹ç›®å‰ç”¨æˆ·çš„æœ‰æ•ˆç”¨æˆ·ç»„æ˜¯ä»¥å¦ä¸€ä¸ªshellæ¥æä¾›è¿™ä¸ªåŠŸèƒ½çš„ï¼Œå¦‚æœè¦å›åˆ°åŸæ¥çš„ç”¨æˆ·ç»„åªè¦è¾“å…¥exitå³å¯ã€‚ è´¦å·ç®¡ç†ç®¡ç†è´¦å·ä¸»è¦æ˜¯æ–°å¢ã€åˆ é™¤ä¸æ›´æ”¹ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ã€‚ æ–°å¢ä¸åˆ é™¤ç”¨æˆ·è´¦å·å¯ä»¥ä½¿ç”¨useraddå‘½ä»¤æ¥æ–°å»ºç”¨æˆ·ï¼Œå¯†ç çš„ç»™äºˆåˆ™æ˜¯ä½¿ç”¨passwdå‘½ä»¤ã€‚ä¸‹é¢æ˜¯èŒƒä¾‹ï¼šï¼ˆé‡Œé¢æœ‰å¾ˆå¤šå‚æ•°ï¼Œè‡ªå·±å¯ä»¥å»äº†è§£ï¼‰12345678910111213141516171819202122# æ–°å¢useradd leonardll -d /home/leonard/# é»˜è®¤ä¼šåˆ›å»ºç”¨æˆ·ä¸»æ–‡ä»¶å¤¹ï¼Œä¸”æƒé™ä¸º700ï¼Œè¿™æ˜¯é‡ç‚¹# drwx------ 2 leonard leonard 4096 3æœˆ 31 09:36 /home/leonard/grep leonard /etc/passwd /etc/shadow /etc/group# /etc/passwd:leonard:x:1001:1001::/home/leonard:/bin/bash# /etc/shadow:leonard:!!:17621:0:99999:7:::# /etc/group:leonard:x:1001:# ä¸åŠ è´¦å·ï¼Œé»˜è®¤ä¿®æ”¹è‡ªå·±çš„å¯†ç passwd leonard# æ˜¾ç¤ºè´¦å·çš„ç›¸å…³ä¿¡æ¯chage leonard# ä¿®æ”¹è´¦å·çš„ç›¸å…³ä¿¡æ¯usermod leonard# åˆ é™¤è´¦å·ï¼Œ-rï¼šè¿ä¸»æ–‡ä»¶å¤¹ä¸€èµ·åˆ é™¤userdel leonard å…¶å®ç³»ç»Ÿå·²ç»å¸®æˆ‘ä»¬è®¾ç½®å¥½äº†éå¸¸å¤šçš„é»˜è®¤å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç®€å•çš„ä½¿ç”¨â€œuseradd è´¦å·â€æ¥åˆ›å»ºç”¨æˆ·ï¼ŒCentosè¿™äº›é»˜è®¤å€¼ä¸»è¦ä¼šå¸®æˆ‘ä»¬å¤„ç†ä¸‹é¢å‡ ä¸ªé¡¹ç›®ï¼š åœ¨/etc/passwd é‡Œé¢åˆ›å»ºä¸€è¡Œä¸è´¦å·ç›¸å…³çš„æ•°æ®ï¼ŒåŒ…æ‹¬åˆ›å»ºUID/GID/ä¸»æ–‡ä»¶å¤¹ç­‰ï¼› åœ¨/etc/shadowé‡Œé¢å°†æ­¤è´¦å·çš„å¯†ç ç›¸å…³å‚æ•°å¡«å…¥ï¼Œä½†æ˜¯å°šæœªæœ‰å¯†ç ï¼› åœ¨/etc/groupé‡Œé¢åŠ å…¥ä¸€ä¸ªä¸è´¦å·åç§°ä¸€æ¨¡ä¸€æ ·çš„ç»„åï¼› åœ¨/homeä¸‹é¢åˆ›å»ºä¸€ä¸ªä¸è´¦å·åŒåçš„ç›®å½•ä½œä¸ºç”¨æˆ·çš„ä¸»æ–‡ä»¶å¤¹ï¼Œä¸”æƒé™ä¸º700 ç”¨æˆ·åŠŸèƒ½ä¸è®ºæ˜¯useraddã€usermodè¿˜æ˜¯userdelï¼Œé‚£éƒ½æ˜¯ç³»ç»Ÿç®¡ç†å‘˜èƒ½å¤Ÿä½¿ç”¨çš„å‘½ä»¤ï¼Œä¸‹é¢æˆ‘ä»¬å°±ä»‹ç»ä¸€äº›ä¸€èˆ¬èº«ä»½ç”¨æˆ·å¸¸ç”¨çš„è´¦å·æ•°æ®æ›´æ”¹ä¸æŸ¥è¯¢å‘½ä»¤ fingerï¼Œå¯ä»¥æŸ¥é˜…å¾ˆå¤šç”¨æˆ·ç›¸å…³çš„ä¿¡æ¯ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯/etc/passwdè¿™ä¸ªæ–‡ä»¶çš„ä¿¡æ¯ã€‚èŒƒä¾‹å¦‚ä¸‹ï¼š 12345// æˆ‘çš„linuxé»˜è®¤æ²¡æœ‰è£…fingerï¼Œå¯ä»¥åˆ©ç”¨ä¸‹é¢çš„å‘½ä»¤å®‰è£…yum install finger// æŸ¥é˜…ç”¨æˆ·ä¿¡æ¯ï¼Œè‹¥ä¸è·Ÿæ²¡æœ‰ç”¨æˆ·ï¼Œåˆ™æŸ¥è¯¢å½“å‰ç”¨æˆ·finger rex chfn(change finger)ï¼Œç”¨äºä¿®æ”¹ä¸€äº›ç›¸å…³ä¿¡æ¯,èŒƒä¾‹å¦‚ä¸‹ï¼š 123456chfn rexChanging finger information for rex.åç§° []: rexåŠå…¬ []: 123456åŠå…¬ç”µè¯ []: 123456ä½å®…ç”µè¯ []: 123456 chsh(change shell)ï¼Œç”¨äºä¿®æ”¹shellã€‚ idï¼Œç”¨äºæŸ¥è¯¢è‡ªå·±æˆ–æŸäººçš„ç›¸å…³UID/GIDç­‰ä¿¡æ¯ã€‚ æ–°å¢ä¸åˆ é™¤ç”¨æˆ·ç»„åŸºæœ¬ä¸Šï¼Œç”¨æˆ·ç»„çš„å†…å®¹éƒ½ä¸è¿™ä¸¤ä¸ªæ–‡ä»¶æœ‰å…³ï¼š/etc/group,/etc/gshadowã€‚ä¸‹é¢æ˜¯ä¸€äº›ç›¸å…³å‘½ä»¤ä½¿ç”¨çš„èŒƒä¾‹ï¼š12345678910111213141516# æ–°å»ºä¸€ä¸ªç”¨æˆ·ç»„ï¼Œåç§°ä¸ºhdgroupadd hd# ä¿®æ”¹ç”¨æˆ·ç»„çš„ç›¸å…³å‚æ•° -gï¼šä¿®æ”¹æ—¢æœ‰GIDï¼Œ-nï¼šä¿®æ”¹æ—¢æœ‰ç»„ågroupmod -g 201 -n myhd hd# åˆ é™¤ç”¨æˆ·ç»„ågroupdel myhd# ç”¨æˆ·ç»„ç®¡ç†å‘˜ç›¸å…³å‘½ä»¤# ç»™ç”¨æˆ·ç»„è®¾ç½®ä¸€ä¸ªå¯†ç gpasswd hd# åŠ å…¥ç”¨æˆ·ç»„ç®¡ç†å‘˜ä¸ºrexgpasswd -A rex hd# è®©rexç™»å½•ç³»ç»Ÿï¼Œå¢åŠ leonardä¸ºhdæˆå‘˜gpasswd -a leonard hd ä¸»æœºçš„å…·ä½“æƒé™è§„åˆ’ï¼šACLçš„ä½¿ç”¨ä»€ä¹ˆæ˜¯ACLACLæ˜¯Access Control Listçš„ç¼©å†™ï¼Œä¸»è¦çš„ç›®çš„æ˜¯æä¾›ä¼ ç»Ÿçš„ownerã€groupã€othersçš„readã€writeã€executeæƒé™ä¹‹å¤–çš„å…·ä½“æƒé™è®¾ç½®ã€‚ACLå¯ä»¥é’ˆå¯¹å•ä¸€ç”¨æˆ·ã€å•ä¸€æ–‡ä»¶æˆ–ç›®å½•è¿›è¡Œrã€wã€xçš„æƒé™è®¾ç½®ï¼Œå¯¹äºéœ€è¦ç‰¹æ®Šæƒé™çš„ä½¿ç”¨çŠ¶å†µéå¸¸æœ‰å¸®åŠ©ã€‚ ACLä¸»è¦å¯ä»¥é’ˆå¯¹ä¸‹é¢å‡ æ–¹é¢æ¥è®¾ç½®æ§åˆ¶æƒé™ï¼š ç”¨æˆ·ï¼šå¯ä»¥é’ˆå¯¹ç”¨æˆ·æ¥è®¾ç½®æƒé™ ç”¨æˆ·ç»„ï¼šå¯ä»¥é’ˆå¯¹ç”¨æˆ·ç»„æ¥è®¾ç½®æƒé™ é»˜è®¤å±æ€§ï¼ˆmaskï¼‰ï¼šè¿˜å¯ä»¥åœ¨è¯¥ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶ç›®å½•è®¾ç½®æ–°æ•°æ®çš„æƒé™ã€ ACLçš„è®¾ç½®æŠ€å·§ getfaclï¼šå–å¾—æŸä¸ªæ–‡ä»¶/ç›®å½•çš„ACLè®¾ç½®é¡¹ç›® setfaclï¼šè®¾ç½®æŸä¸ªæ–‡ä»¶/ç›®å½•çš„ACLè§„å®š ä¸‹é¢æ˜¯èŒƒä¾‹ï¼š12345678910111213// å–å¾—æŸä¸ªæ–‡ä»¶/ç›®å½•çš„ACLè®¾ç½®é¡¹ç›®getfacl rootfile// è¾“å‡º# file: rootfile# owner: root# group: rootuser::rw-group::r--other::r--// è®¾ç½®æŸä¸ªæ–‡ä»¶/ç›®å½•çš„ACLè§„å®šsetfacl -m u:rex:rwx rootfile ç”¨æˆ·èº«ä»½åˆ‡æ¢åœ¨Linuxç³»ç»Ÿä¸­æ˜¯éœ€è¦åšèº«ä»½çš„å˜æ¢çš„ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š ä½¿ç”¨ä¸€èˆ¬è´¦å·ï¼šç³»ç»Ÿå¹³æ—¥æ“ä½œçš„å¥½ä¹ æƒ¯ï¼ˆä¸ç„¶ä½ å°±æœ‰æœºä¼šä»åˆ åº“åˆ°è·‘è·¯äº†ï¼‰ ç”¨è¾ƒä½çš„æƒé™å¯åŠ¨ç³»ç»ŸæœåŠ¡ è½¯ä»¶æœ¬èº«çš„é™åˆ¶ æ ¹æ®ä¸Šé¢çš„è€ƒè™‘ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨ä¸€èˆ¬è´¦å·ç™»å½•ç³»ç»Ÿçš„ï¼Œç­‰æœ‰éœ€è¦è¿›è¡Œç³»ç»Ÿç»´æŠ¤æˆ–è½¯ä»¶æ›´æ–°æ—¶æ‰è½¬ä¸ºrootèº«ä»½æ¥æ“ä½œã€‚ä»ä¸€èˆ¬ç”¨æˆ·è½¬å˜ä¸ºrootä¸»è¦æœ‰ä¸‹é¢ä¸¤ç§æ–¹å¼ï¼š â€œsu -â€ï¼šéœ€è¦rootç”¨æˆ·å¯†ç  â€œsudoå‘½ä»¤â€ï¼šsudoéœ€è¦è¾“å…¥ç”¨æˆ·è‡ªå·±çš„å¯†ç  susuæ˜¯æœ€ç®€å•çš„èº«ä»½åˆ‡æ¢å‘½ä»¤äº†ï¼Œå®ƒå¯ä»¥è¿›è¡Œä»»ä½•èº«ä»½çš„åˆ‡æ¢ã€‚ä½†æ˜¯ä¸‹é¢æœ‰å‡ ç‚¹æ¯”è¾ƒé‡è¦ï¼š è‹¥è¦å®Œæ•´åˆ‡æ¢åˆ°æ–°ç”¨æˆ·çš„ç¯å¢ƒï¼Œå¿…é¡»è¦ä½¿ç”¨â€œsu -usernameâ€ æˆ– â€œsu -|usernameâ€ï¼Œæ‰ä¼šè¿åŒPATH/USER/MAILç­‰å˜é‡éƒ½è½¬æˆæ–°ç”¨æˆ·çš„ç¯å¢ƒã€‚å¦‚æœåªæ˜¯ä½¿ç”¨â€œsuâ€åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼ŒPATH/USER/MAILç­‰å˜é‡éƒ½æ²¡æœ‰å˜ï¼Œä¼šå¯¼è‡´å¾ˆå¤šå‘½ä»¤æ‰§è¡Œä¸äº†ã€‚ å¦‚æœä»…æƒ³æ‰§è¡Œä¸€æ¬¡rootå‘½ä»¤ï¼Œå¯ä»¥åˆ©ç”¨â€œsu - -c â€œå‘½ä»¤ä¸²â€â€dçš„æ–¹å¼æ¥å¤„ç†ã€‚ ä½¿ç”¨rootåˆ‡æ¢æˆä¸ºä»»ä½•ç”¨æˆ·æ—¶ï¼Œå¹¶ä¸éœ€è¦è¾“å…¥æ–°ç”¨æˆ·çš„å¯†ç ã€‚ è™½ç„¶ä½¿ç”¨suå¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯ä¼šå¯¼è‡´rootå¯†ç å¤–æµã€‚æ‰€ä»¥å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬é€šè¿‡sudoæ¥å¤„ç†ã€‚ sudosudoçš„æ‰§è¡Œä»…éœ€è¦è‡ªå·±çš„å¯†ç å³å¯ï¼ç”šè‡³å¯ä»¥è®¾ç½®ä¸éœ€è¦å¯†ç å³å¯æ‰§è¡Œsudoï¼Œç”±äºsudoå¯ä»¥è®©ä½ ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼ˆé€šå¸¸æ˜¯ä½¿ç”¨rootçš„èº«ä»½æ¥æ‰§è¡Œå‘½ä»¤ï¼‰ï¼Œå› æ­¤ä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½å¤Ÿæ‰§è¡Œsudoï¼Œè€Œæ˜¯ä»…æœ‰/etc/sudoerså†…çš„ç”¨æˆ·æ‰èƒ½å¤Ÿæ‰§è¡Œsudoè¿™ä¸ªå‘½ä»¤ã€‚ sudoçš„å‘½ä»¤ç”¨æ³• 1234sudo [-u æ–°ç”¨æˆ·è´¦å·]// èŒƒä¾‹ï¼Œä»¥sshdçš„èº«ä»½åœ¨/tmpä¸‹é¢æ–°å»ºä¸€ä¸ªåä¸ºmysshdçš„æ–‡ä»¶sudo -u sshd touch /tmp/mysshd sudoçš„æ‰§è¡Œæµç¨‹ å½“ç”¨æˆ·æ‰§è¡Œsudoæ—¶ï¼Œç³»ç»Ÿåœ¨/etc/sudoersæ–‡ä»¶ä¸­æŸ¥æ‰¾è¯¥ç”¨æˆ·æ˜¯å¦æœ‰æ‰§è¡Œsudoçš„æƒé™ï¼› è‹¥ç”¨æˆ·å…·æœ‰å¯æ‰§è¡Œsudoçš„æƒé™åï¼Œä¾¿è®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·è‡ªå·±çš„å¯†ç æ¥ç¡®è®¤ï¼› è‹¥å¯†ç è¾“å…¥æˆåŠŸï¼Œä¾¿å¼€å§‹è¿›è¡Œsudoåé¢æ¥çš„å‘½ä»¤ï¼ˆrootæ‰§è¡Œsudoä¸éœ€è¦è¾“å…¥å¯†ç ï¼‰ è‹¥æ¬²åˆ‡æ¢çš„èº«ä»½ä¸æ‰§è¡Œè€…çš„èº«ä»½ç›¸åŒï¼Œä¹Ÿä¸éœ€è¦è¾“å…¥å¯†ç  visudoä¸/etc/sudoers æˆ‘ä»¬ä¸€èˆ¬ä¸ç›´æ¥å»ä¿®æ”¹/etc/sudoersæ–‡ä»¶ï¼Œè€Œæ˜¯åˆ©ç”¨visudoå‘½ä»¤å»ä¿®æ”¹ï¼Œå› ä¸ºè¿™ä¸ªå‘½ä»¤ä¼šåœ¨ç»“æŸç¦»å¼€çš„æ—¶å€™å»æ£€éªŒ/etc/sudoersçš„è¯­æ³•ï¼Œä¸‹é¢æ˜¯ä»–çš„ç”¨æ³•æ¡ˆä¾‹ï¼š 1234567891011121314151617181920// 1. å•ä¸€ç”¨æˆ·å¯ä»¥æ‰§è¡Œrootçš„æ‰€æœ‰å‘½ä»¤ä¸sudoersæ–‡ä»¶è¯­æ³•// å››ä¸ªå‚æ•°å«ä¹‰ä¸º(1).ç”¨æˆ·è´¦å·ï¼Œ(2).ç™»é™†è€…çš„æ¥æºä¸»æœºï¼Œ(3).(å¯åˆ‡æ¢çš„èº«ä»½)ï¼Œ(4).å¯æ‰§è¡Œçš„å‘½ä»¤root ALL=(ALL) ALL //æ–‡ä»¶ä¸­åŸæœ‰rex ALL=(ALL) ALL //æ–°å¢// 2. åˆ©ç”¨ç”¨æˆ·ç»„ä»¥åŠå…å¯†ç çš„åŠŸèƒ½å¤„ç†visudo# %wheel ALL=(ALL) NOPASSWD: ALL //æ–‡ä»¶ä¸­åŸæœ‰ï¼Œéœ€è¦å°†#å»æ‰ï¼Œæ–‡ä»¶ä¸­çš„%è¡¨ç¤ºåé¢æ¥ä¸€ä¸ªç”¨æˆ·ç»„usermod -a -G wheel rex //å°†rexåŠ å…¥wheelç»„ä¸­// 3. æœ‰é™åˆ¶çš„å‘½ä»¤æ“ä½œï¼Œé€šè¿‡æ›´æ”¹å¯æ‰§è¡Œçš„å‘½ä»¤ä¸€æ çš„æ•°æ®ï¼Œå°±å¯ä»¥æ§åˆ¶å…·ä½“æ“ä½œçš„å®‰å…¨æ€§rex ALL=(ALL) !/usr/bin/passed //ä¸è®©rexå¯ä»¥ä¿®æ”¹å¯†ç // 4. é€šè¿‡åˆ«åè®¾ç½®visudoUser_Alias ADMPW(å¤§å†™) = rex1,rex2Cmnd_Alias ADMPWCOM(å¤§å†™) = !/usr/bin/passwd, /usr/bin/passed [A-Za-z]ADMPW ALL=(root) ADMPWCOM// 5. sudoæ­é…suçš„ä½¿ç”¨æ–¹å¼,è®©ç”¨æˆ·ç”¨è‡ªå·±çš„å¯†ç å˜æˆrootUser_Alias ADMPW(å¤§å†™) = rex1,rex2ADMPW ALL=(root) /bin/su - å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_shell script å…¥é—¨]]></title>
    <url>%2F2018%2F03%2F30%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_shell%20script%20%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè¦æƒ³ç®¡ç†å¥½è‡ªå·±çš„ä¸»æœºï¼Œè‡ªåŠ¨åŒ–ç®¡ç†ç³»ç»Ÿçš„å¥½å·¥å…·â€”â€”shell scriptï¼Œè¿™ä¸ªå®¶ä¼™æ˜¯çœŸçš„éœ€è¦å¥½å¥½å­¦ä¹ å­¦ä¹ çš„ï¼ ä»€ä¹ˆæ˜¯shell scriptshell script æ˜¯åˆ©ç”¨shellçš„åŠŸèƒ½æ‰€å†™çš„ä¸€ä¸ªâ€œç¨‹åºâ€ï¼Œè¿™ä¸ªç¨‹åºæ˜¯ä½¿ç”¨çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå°†ä¸€äº›shellçš„è¯­æ³•ä¸å‘½ä»¤ï¼ˆå«å¤–éƒ¨å‘½ä»¤ï¼‰å†™åœ¨é‡Œé¢ï¼Œæ­é…æ­£åˆ™è¡¨è¾¾å¼ï¼Œç®¡é“å‘½ä»¤ä¸æ•°æ®é‡å®šå‘ç­‰åŠŸèƒ½ï¼Œä»¥è¾¾åˆ°æˆ‘ä»¬æ‰€æƒ³è¦çš„å¤„ç†ç›®çš„ã€‚ ä¸ºä»€ä¹ˆè¦å­¦ä¹ shell script è‡ªåŠ¨åŒ–ç®¡ç†çš„é‡è¦ä¾æ® è¿½è¸ªä¸ç®¡ç†ç³»ç»Ÿçš„é‡è¦å·¥ä½œ ç®€å•å…¥ä¾µæ£€æµ‹åŠŸèƒ½ è¿ç»­å‘½ä»¤å•ä¸€åŒ– ç®€æ˜“çš„æ•°æ®å¤„ç† è·¨å¹³å°ä¸å­¦ä¹ å†ç¨‹è¾ƒçŸ­ shell scriptç¼–å†™çš„æ³¨æ„äº‹é¡¹ å‘½ä»¤çš„æ‰§è¡Œæ˜¯ä»ä¸Šè€Œä¸‹ï¼Œä»å·¦å¾€å³åœ°åˆ†æä¸æ‰§è¡Œï¼› å‘½ä»¤ã€å‚æ•°é—´çš„å¤šä¸ªç©ºç™½éƒ½ä¼šè¢«å¿½è§†æ‰ï¼› ç©ºç™½è¡Œä¹Ÿå°†è¢«å¿½ç•¥æ‰ï¼Œå¹¶ä¸”tabæŒ‰é”®æ‰€å¾—çš„ç©ºç™½åŒæ ·è§†ä¸ºç©ºæ ¼é”®ï¼› å¦‚æœè¯»åˆ°ä¸€ä¸ªenterç¬¦å·ï¼ˆCRï¼‰ï¼Œå°±å°è¯•å¼€å§‹ç»“æŸè¯¥è¡Œï¼ˆæˆ–è¯¥ä¸²ï¼‰å‘½ä»¤ è‡³äºå¦‚æœä¸€è¡Œçš„å†…å®¹å¤ªå¤šï¼Œåˆ™å¯ä»¥ä½¿ç”¨â€œ\enterâ€æ¥æ‰©å±•è‡³ä¸‹ä¸€è¡Œï¼› â€œ#â€å¯ä½œä¸ºæ‰¹æ³¨ï¼Œä»»ä½•åŠ åœ¨#åé¢çš„æ•°æ®å°†å…¨éƒ¨è¢«è§†ä¸ºæ‰¹æ³¨æ–‡ä»¶è€Œè¢«å¿½ç•¥ã€‚ shell scriptçš„æ‰§è¡Œå‡è®¾ä½ çš„ç¨‹åºæ–‡ä»¶åæ˜¯/home/rex/shell.sh ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼šshell.shæ–‡ä»¶å¿…é¡»å…·å¤‡å¯è¯»å¯æ‰§è¡Œ(rx)çš„æƒé™ï¼Œç„¶åï¼š ç»å¯¹è·¯å¾„ï¼šä½¿ç”¨/home/rex/shell.sh ç›¸å¯¹è·¯å¾„ï¼šå‡è®¾å·¥ä½œç›®å½•åœ¨/home/rex/,åˆ™ä½¿ç”¨./shell.shæ¥æ‰§è¡Œ å˜é‡â€œPATHâ€åŠŸèƒ½ï¼šå°†shell.shæ”¾åœ¨PATHæŒ‡å®šçš„ç›®å½•å†…ï¼Œä¾‹å¦‚ï¼š~/bin/ã€‚ ä»¥bashè¿›ç¨‹æ¥æ‰§è¡Œï¼šé€šè¿‡â€œbash shell.shâ€æˆ–â€œsh shell.shâ€æ¥æ‰§è¡Œ åˆ©ç”¨sourceæ¥æ‰§è¡Œï¼šè¿™æ ·è¿™ä¸ªè„šæœ¬å°†åœ¨çˆ¶è¿›ç¨‹ä¸­æ‰§è¡Œï¼Œå„é¡¹æ“ä½œéƒ½ä¼šåœ¨åŸæœ¬çš„bashå†…ç”Ÿæ•ˆã€‚å¦‚æœç›´æ¥æ‰§è¡Œï¼Œscriptæ˜¯åœ¨å­è¿›ç¨‹ä¸­çš„bashå†…æ‰§è¡Œçš„ï¼Œå½“å­è¿›ç¨‹å®Œæˆåï¼Œå­è¿›ç¨‹çš„å„é¡¹å˜é‡æˆ–æ“ä½œå°†ä¼šç»“æŸè€Œä¸ä¼šä¼ å›åˆ°çˆ¶è¿›ç¨‹ä¸­ã€‚ è‰¯å¥½çš„ script æ’°å†™ä¹ æƒ¯åœ¨æ¯ä¸ª script çš„æ¡£å¤´å¤„è®°å½•å¥½ï¼š script çš„åŠŸèƒ½ï¼› script çš„ç‰ˆæœ¬èµ„è®¯ï¼› script çš„ä½œè€…ä¸è”ç»œæ–¹å¼ï¼› script çš„ç‰ˆæƒå®£å‘Šæ–¹å¼ï¼› script çš„ History (å†å²çºªå½•)ï¼›6ã€‚script å†…è¾ƒç‰¹æ®Šçš„å‘½ä»¤ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„çš„æ–¹å¼æ¥ä¸‹è¾¾ï¼› script è¿è¡Œæ—¶éœ€è¦çš„ç¯å¢ƒå˜é‡é¢„å…ˆå®£å‘Šä¸é…ç½®ã€‚ Hello Wordç¨‹åº123456789#!/bin/bash // å£°æ˜è¿™ä¸ªscriptä½¿ç”¨çš„shellåç§°# Program:# This program shows &quot;Hello World!&quot; in your screen.# History:# 2015/11/03 Jiange First releasePATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/binexport PATHecho -e &quot;Hello World! \a \n&quot;exit 0 å–„ç”¨åˆ¤æ–­å¼åˆ©ç”¨testå‘½ä»¤çš„æµ‹è¯•åŠŸèƒ½å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œç”¨äºæ£€æµ‹æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼š1test -e /dmtsai &amp;&amp; echo &quot;exist&quot; || echo &quot;Not exist&quot; åˆ©ç”¨åˆ¤æ–­ç¬¦å·[]å¦‚æœæˆ‘æƒ³è¦çŸ¥é“ $HOME è¿™ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºçš„ï¼Œå¯ä»¥è¿™æ ·åšï¼š1[ -z &quot;$HOME&quot; ] ; echo $? å¯¹äºåˆ¤æ–­ç¬¦å·æˆ‘ä»¬ä¸€å®šè¦æ³¨æ„ï¼š åœ¨ä¸­æ‹¬å· [] å†…çš„æ¯ä¸ªç»„ä»¶éƒ½éœ€è¦æœ‰ç©ºç™½é”®æ¥åˆ†éš”ï¼› åœ¨ä¸­æ‹¬å·å†…çš„å˜é‡ï¼Œæœ€å¥½éƒ½ä»¥åŒå¼•å·æ‹¬å·èµ·æ¥ï¼› åœ¨ä¸­æ‹¬å·å†…çš„å¸¸æ•°ï¼Œæœ€å¥½éƒ½ä»¥å•æˆ–åŒå¼•å·æ‹¬å·èµ·æ¥ã€‚ shell script çš„é»˜è®¤å˜é‡($0, $1â€¦)è¿è¡Œçš„è„šæœ¬æ¡£åä¸º $0 å˜é‡ï¼Œç¬¬ä¸€ä¸ªæ¥çš„å‚æ•°å°±æ˜¯ $1ï¼Œä¾æ¬¡ç±»æ¨ã€‚å…¶ä»–ç‰¹æ®Šå˜é‡ï¼š $# ï¼šä»£è¡¨åæ¥çš„å‚æ•°ä¸ªæ•°ï¼› $@ ï¼šä»£è¡¨â€$1â€ â€œ$2â€ â€œ$3â€ â€œ$4â€ â€¦ä¹‹æ„ï¼Œæ¯ä¸ªå˜é‡æ˜¯ç‹¬ç«‹çš„(ç”¨åŒå¼•å·æ‹¬èµ·æ¥)ï¼› $* ï¼šä»£è¡¨ã€â€$1c$2c$3c$4â€¦â€ ï¼Œå…¶ä¸­ c ä¸ºåˆ†éš”å­—èŠ‚ï¼Œé»˜è®¤ä¸ºç©ºç™½é”®ã€‚ æ¡ä»¶åˆ¤æ–­å¼åˆ©ç”¨ if â€¦. thenå¦‚ä¸‹é¢çš„ä»£ç ï¼š1234567if [ &quot;$1&quot; == &quot;hello&quot; ]; then echo &quot;Hello, how are you ?&quot;elif [ &quot;$1&quot; == &quot;&quot; ]; then echo &quot;You MUST input parameters, ex&gt; &#123;$0 someword&#125;&quot;else echo &quot;The only parameter is &apos;hello&apos;, ex&gt; &#123;$0 hello&#125;&quot;fi åˆ©ç”¨ case â€¦.. esac åˆ¤æ–­å¦‚ä¸‹é¢çš„ä»£ç ï¼š1234567891011121314case $1 in &quot;one&quot;) echo &quot;Your choice is ONE&quot; ;;&quot;two&quot;) echo &quot;Your choice is TWO&quot; ;;&quot;three&quot;) echo &quot;Your choice is THREE&quot; ;;*) echo &quot;Usage $0 &#123;one|two|three&#125;&quot; ;;esac åˆ©ç”¨ function åŠŸèƒ½å¦‚ä¸‹é¢çš„ä»£ç ï¼š12345678910111213141516171819function printit()&#123; echo &quot;Your choice is $1&quot; # è¿™ä¸ª $1 å¿…é¡»è¦å‚è€ƒåº•ä¸‹å‘½ä»¤çš„ä¸‹è¾¾&#125;echo &quot;This program will print your selection !&quot;case $1 in &quot;one&quot;) printit 1 # è¯·æ³¨æ„ï¼Œ printit å‘½ä»¤åé¢è¿˜æœ‰æ¥å‚æ•°ï¼ ;;&quot;two&quot;) printit 2 ;;&quot;three&quot;) printit 3 ;; *) echo &quot;Usage $0 &#123;one|two|three&#125;&quot; ;;esac å¾ªç¯ï¼ˆloopï¼‰while do done, until do done (ä¸å®šæ¬¡æ•°å¾ªç¯)å¦‚ä¸‹é¢çš„ä»£ç ï¼š123456789while [ condition ] &lt;==ä¸­æ‹¬å·å†…çš„çŠ¶æ€å°±æ˜¯åˆ¤æ–­å¼do &lt;==do æ˜¯å¾ªç¯çš„å¼€å§‹ï¼ ç¨‹åºæ®µè½done &lt;==done æ˜¯å¾ªç¯çš„ç»“æŸuntil [ condition ]do ç¨‹åºæ®µè½done forâ€¦doâ€¦done (å›ºå®šæ¬¡æ•°å¾ªç¯)å¦‚ä¸‹é¢çš„ä»£ç ï¼š1234for var in con1 con2 con3 ...do ç¨‹åºæ®µdone forâ€¦doâ€¦done çš„æ•°å€¼å¤„ç†å¦‚ä¸‹é¢çš„ä»£ç ï¼š12345678read -p &quot;Please input a number, I will count for 1+2+...+your_input: &quot; nus=0for (( i=1; i&lt;=$nu; i=i+1 ))do s=$(($s+$i))doneecho &quot;The result of &apos;1+2+3+...+$nu&apos; is ==&gt; $s&quot; shell script çš„è¿½è¸ªä¸è°ƒè¯•å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š123456sh [-nvx] scripts.shé€‰é¡¹ä¸å‚æ•°ï¼š-n ï¼šä¸è¦è¿è¡Œ scriptï¼Œä»…æŸ¥è¯¢è¯­æ³•çš„é—®é¢˜ï¼›-v ï¼šåœ¨è¿è¡Œ sccript å‰ï¼Œå…ˆå°† scripts çš„å†…å®¹è¾“å‡ºåˆ°å±å¹•ä¸Šï¼›-x ï¼šå°†ä½¿ç”¨åˆ°çš„ script å†…å®¹æ˜¾ç¤ºåˆ°è¤å¹•ä¸Šï¼Œè¿™æ˜¯å¾ˆæœ‰ç”¨çš„å‚æ•°ï¼ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_æ·±å…¥bashæ•°æ®æ“ä½œ]]></title>
    <url>%2F2018%2F03%2F30%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E6%B7%B1%E5%85%A5bash%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨è¿™é‡Œæœ‰ä¸€åˆ‡ä½ æƒ³è¦çš„bashæ•°æ®æ“ä½œçŸ¥è¯†ï¼Œæ¯”å¦‚æ•°æ®æµé‡å®šå‘ï¼Œç®¡é“å‘½ä»¤ï¼Œæ­£åˆ™è¡¨è¾¾å¼çš„ä½¿ç”¨ï¼Œå¤§å®¶å¯ä»¥å¿«å¿«è¿›æ¥ï¼ æ•°æ®æµçš„é‡å®šå‘ä»€ä¹ˆæ˜¯æ•°æ®æµé‡å®šå‘ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ è¦æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œé€šå¸¸å®ƒä¼šæ˜¯è¿™æ ·çš„ï¼š æ–‡ä»¶ -&gt; æ ‡å‡†è¾“å…¥ -&gt;å‘½ä»¤ å¦‚æœæ‰§è¡Œæ­£ç¡®ï¼Œå‘½ä»¤ -&gt; æ ‡å‡†è¾“å‡º -&gt; æ–‡ä»¶/è®¾å¤‡ï¼›å¦‚æœæ‰§è¡Œé”™è¯¯ï¼Œå‘½ä»¤ -&gt; æ ‡å‡†é”™è¯¯è¾“å‡º -&gt; æ–‡ä»¶æˆ–è®¾å¤‡ æ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œæ ‡å‡†è¾“å…¥ æ ‡å‡†è¾“å‡ºï¼šæŒ‡çš„æ˜¯å‘½ä»¤æ‰§è¡Œæ‰€å›ä¼ çš„æ­£ç¡®ä¿¡æ¯ï¼Œä»£ç ä¸º1ï¼Œä½¿ç”¨&gt; æˆ– &gt;&gt;; æ ‡å‡†é”™è¯¯è¾“å‡ºï¼šæŒ‡çš„æ˜¯å‘½ä»¤æ‰§è¡Œé”™è¯¯å¤±è´¥åï¼Œæ‰€å›ä¼ çš„é”™è¯¯ä¿¡æ¯ï¼Œä»£ç ä¸º12ï¼Œä½¿ç”¨2&gt; æˆ– 2&gt;&gt;; æ ‡å‡†è¾“å…¥ï¼šå°†åŸæœ¬éœ€è¦é”®ç›˜è¾“å…¥çš„æ•°æ®æ”¹ç”±æ–‡ä»¶å†…å®¹æ¥æ›¿ä»£ï¼Œä»£ç ä¸º0ï¼Œä½¿ç”¨&lt; æˆ– &lt;&lt;; å¦‚ä¸‹é¢çš„å‘½ä»¤ï¼š1ll / &gt; ~/rootfile // æ˜¾ç¤ºæ–‡ä»¶åä¿¡æ¯åˆ°rootfileæ–‡ä»¶ä¸­ å…³äºé‡å®šå‘è¾“å‡ºæ–‡ä»¶çš„åˆ›å»ºæ–¹å¼å¦‚ä¸‹ï¼š è¯¥æ–‡ä»¶å¦‚æœä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†å®ƒåˆ›å»ºèµ·æ¥ å½“è¿™ä¸ªæ–‡ä»¶å­˜åœ¨ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±ä¼šå°†è¿™ä¸ªæ–‡ä»¶å†…å®¹æ¸…ç©ºï¼Œç„¶åå†å°†æ•°æ®å†™å…¥ è‹¥ä»¥&gt;è¾“å…¥åˆ°ä¸€ä¸ªä»¥å­˜åœ¨çš„æ–‡ä»¶ä¸­ï¼Œé‚£ä¸ªæ–‡ä»¶å°±ä¼šè¢«è¦†ç›–ï¼Œå¦‚æœä¸æƒ³è¢«è¦†ç›–ï¼Œå¯ä»¥ä½¿ç”¨ &gt;&gt; /dev/null åƒåœ¾æ¡¶é»‘æ´è®¾å¤‡ä¸ç‰¹æ®Šå†™æ³• /dev/null åƒåœ¾æ¡¶é»‘æ´è®¾å¤‡ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“é”™è¯¯ä¿¡æ¯ä¼šå‘ç”Ÿï¼Œæ‰€ä»¥è¦è®²é”™è¯¯ä¿¡æ¯å¿½ç•¥æ‰è€Œä¸æ˜¾ç¤ºæˆ–å­˜å‚¨ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨/dev/nullè¿™ä¸ªé»‘æ´è®¾å¤‡äº†ã€‚å†™æ³•å¦‚ä¸‹ï¼š 1ll / 2&gt; /dev/null å¦‚æœæˆ‘ä»¬è¦å°†æ­£ç¡®åœ°ä¸é”™è¯¯æ•°æ®éƒ½å†™å…¥åŒä¸€ä¸ªæ–‡ä»¶ä¸­å»ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨ç‰¹æ®Šå†™æ³•äº†ï¼Œå¦‚ä¸‹ï¼š 12ll / &gt; ~/rootfile 2&gt;&amp;1 ll / &amp;&gt; ~/rootfile ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å‘½ä»¤è¾“å‡ºé‡å®šå‘ å±å¹•è¾“å‡ºçš„ä¿¡æ¯å¾ˆé‡è¦ï¼Œè€Œä¸”æˆ‘ä»¬éœ€è¦å°†å®ƒå­˜ä¸‹æ¥çš„æ—¶å€™ åå°æ‰§è¡Œä¸­çš„ç¨‹åºï¼Œä¸å¸Œæœ›å®ƒå¹²æ‰°å±å¹•æ­£å¸¸çš„è¾“å‡ºç»“æœæ—¶ ä¸€äº›ç³»ç»Ÿçš„ä¾‹è¡Œå‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œå¸Œæœ›å®ƒå¯ä»¥å­˜ä¸‹æ¥æ—¶ ä¸€äº›æ‰§è¡Œå‘½ä»¤çš„å¯èƒ½å·²çŸ¥ä¿¡æ¯æ—¶ï¼Œæƒ³ä»¥â€œ2&gt;/dev/nullâ€å°†å®ƒä¸¢æ‰æ—¶ é”™è¯¯ä¿¡æ¯ä¸æ­£ç¡®ä¿¡æ¯éœ€è¦åˆ†åˆ«è¾“å‡ºæ—¶ å‘½ä»¤æ‰§è¡Œçš„åˆ¤æ–­ä¾æ®ï¼šï¼›ï¼Œ &amp;&amp;ï¼Œ||åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¾ˆå¤šå‘½ä»¤æˆ‘ä»¬éœ€è¦ä¸€æ¬¡è¾“å…¥å»æ‰§è¡Œï¼Œè€Œä¸åƒåˆ†å¼€æ‰§è¡Œï¼ŒåŸºæœ¬æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡shell scriptç¼–å†™è„šæœ¬å»æ‰§è¡Œï¼Œä¸€ç§æ˜¯å¬è¿‡ä¸‹é¢çš„ä»‹ç»æ¥ä¸€ç›´è¾“å…¥å¤šé‡å‘½ä»¤ã€‚ cmd ; cmd (ä¸è€ƒè™‘å‘½ä»¤ç›¸å…³æ€§çš„è¿ç»­å‘½ä»¤æ‰§è¡Œï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œç»“æŸåä¾¿ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤) cmd &amp;&amp; cmd (è‹¥ç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸæ‰ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ï¼›è‹¥ç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ã€‚) cmd || cmd (è‹¥ç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œåˆ™ä¸æ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ï¼›è‹¥ç¬¬ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œæ‰ä¼šæ‰§è¡Œç¬¬äºŒä¸ªå‘½ä»¤ã€‚) ç®¡é“å‘½ä»¤(pipe)ä»€ä¹ˆæ˜¯ç®¡é“å‘½ä»¤ç®¡é“å‘½ä»¤ èƒ½å¤Ÿå°†ä¸€ä¸ªå‘½ä»¤çš„æ‰§è¡Œç»“æœç»è¿‡ç­›é€‰ï¼Œåªä¿ç•™æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚ å®ƒçš„ç¬¦å·æ˜¯ â€œ | â€ã€‚ ç®¡é“å‘½ä»¤æœ‰ä¸‹é¢ä¸¤ä¸ªæ¯”è¾ƒéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š ç®¡é“å‘½ä»¤ä»…ä¼šå¤„ç†æ ‡å‡†è¾“å‡ºï¼Œå¯¹äºæ ‡å‡†é”™è¯¯è¾“å‡ºä¼šäºˆä»¥å¿½ç•¥ ç®¡é“å‘½ä»¤å¿…é¡»è¦èƒ½å¤Ÿæ¥æ”¶æ¥è‡ªå‰ä¸€ä¸ªå‘½ä»¤çš„æ•°æ®æˆä¸ºæ ‡å‡†è¾“äººç»§ç»­å¤„ç†æ‰è¡Œã€‚ ç®¡é“å‘½ä»¤é€‰å–æŒ‡å®šåˆ—ï¼šcutcutä¸ºå‰ªåˆ‡çš„æ„æ€ï¼Œå®ƒèƒ½å°†ä¸€è¡Œè¡Œçš„æ•°æ®æŒ‰ç…§æŒ‡å®šçš„åˆ†éš”ç¬¦åˆ‡æˆä¸€åˆ—åˆ—ï¼Œç„¶ååªæ˜¾ç¤ºç‰¹å®šåˆ—çš„æ•°æ®ã€‚ cutæœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼š æŒ‰ç…§æŒ‡å®šå­—ç¬¦åˆ†éš”ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šæŒ‰ç…§ç‰¹å®šçš„åˆ†éš”ç¬¦å°†æ•°æ®åˆ‡åˆ†ï¼Œå¹¶åªæ˜¾ç¤ºç¬¬nåˆ—çš„æ•°æ®ã€‚å¦‚ä¸‹ï¼š 1cut -d &apos;åˆ†éš”ç¬¦&apos; -f n(ç¬¬å‡ åˆ—) é€‰æ‹©ç‰¹å®šèŒƒå›´å†…çš„æ•°æ®ï¼Œå¦‚ä¸‹ï¼š 1cut -c èµ·å§‹å­—ç¬¦çš„ä¸‹æ ‡-ç»“æŸå­—ç¬¦çš„ä¸‹æ ‡ å…³é”®è¯æœç´¢æŒ‡å®šè¡Œï¼šgrepgrepç”¨äºè¿›è¡Œå…³é”®è¯æŸ¥æ‰¾ï¼Œå®ƒä¼šå°†æ–‡ä»¶ä¸­å«æœ‰å…³é”®è¯çš„é‚£ä¸€æ•´è¡Œè¾“å‡ºæ¥ã€‚grepçš„ä¸¤ç§ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š ä»æŒ‡å®šæ–‡ä»¶ä¸­å°†ç¬¦åˆå…³é”®è¯çš„è¡Œæœç´¢å‡ºæ¥ï¼Œå¦‚ä¸‹ï¼š 1grep [-å‚æ•°] â€˜å…³é”®è¯â€™ æ–‡ä»¶ é‡‡ç”¨ç®¡é“ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤çš„æ‰§è¡Œç»“æœè¾“å‡ºç»™grepï¼Œå¹¶é€šè¿‡grepçš„å…³é”®è¯æœç´¢å°†ç¬¦åˆæ¡ä»¶çš„è¡Œæœç´¢å‡ºæ¥ï¼Œå¦‚ä¸‹ï¼š 1å‘½ä»¤ | grep [-å‚æ•°] â€˜å…³é”®è¯â€™ æ’åºï¼šsortsortå‘½ä»¤èƒ½å¤Ÿå°†æŒ‡å®šæ–‡ä»¶ æˆ– å‰ä¸€ä¸ªå‘½ä»¤çš„ç»“æœæ•°æ® æŒ‰ç…§æŒ‡å®šå­—æ®µè¿›è¡Œæ’åºã€‚sortä¸¤ç§ä½¿ç”¨æ–¹å¼ä¸grepåŸºæœ¬ä¸€æ ·ï¼Œä¸€ç§æ˜¯å°†æ–‡ä»¶ä¸­çš„æ•°æ®æŒ‰ç…§æŒ‡å®šå­—æ®µæ’åºã€‚å¦ä¸€ç§æ˜¯ä½¿ç”¨ç®¡é“ï¼Œå°†å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„ç»“æœæŒ‰ç…§æŒ‡å®šå­—æ®µè¿›è¡Œæ’åºã€‚ã€‚ å»é™¤é‡å¤è¡Œï¼šuniqè¯¥å‘½ä»¤åªèƒ½ç”¨äºç®¡é“ï¼Œå¦‚ç»Ÿè®¡å½“å‰ç³»ç»Ÿæ‰€æœ‰ç”¨æˆ·çš„ç™»å½•æ¬¡æ•°ï¼šå¦‚ä¸‹ï¼š1last | cut -d &apos; &apos; -f 1 | uniq -c ç»Ÿè®¡å­—æ•°ã€è¡Œæ•°ã€å­—ç¬¦æ•°ï¼šwcwcåªèƒ½é€šè¿‡ç®¡é“ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼š1å‘½ä»¤ | wc [-å‚æ•°] åŒå‘é‡å®šå‘ï¼šteeteeåªèƒ½å’Œç®¡é“ç»“åˆä½¿ç”¨ï¼Œå¦‚å°†lastä¸­çš„ä¿¡æ¯è¾“å‡ºæŒ‡æ–‡ä»¶å¹¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Š,æŒ‡ä»¤å¦‚ä¸‹ï¼š1last | tee -a lastfile | cut -d &apos; &apos; f 1 åˆ‡å‰²æ–‡ä»¶ï¼šsplitè¯¥å‘½ä»¤èƒ½å°†ä¸€ä¸ªå¤§æ–‡ä»¶åˆ‡åˆ†æˆè‹¥å¹²ä¸ªå°æ–‡ä»¶ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š1split [-bl] å¤§æ–‡ä»¶ å°æ–‡ä»¶åå­—å‰ç¼€ æ­£åˆ™è¡¨è¾¾å¼ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼ å°±æ˜¯å¤„ç†å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå®ƒæ˜¯è¡Œä¸ºå•ä½æ¥è¿›è¡Œå­—ç¬¦ä¸²çš„å¤„ç†è¡Œä¸ºæ­£åˆ™è¡¨è¾¾å¼é€šè¿‡ä¸€äº›ç‰¹æ®Šç¬¦å·çš„è¾…åŠ©ï¼Œå¯ä»¥è®©ç”¨æˆ·è½»æ˜“è¾¾åˆ°æŸ¥æ‰¾ã€åˆ é™¤ã€æ›¿æ¢æŸç‰¹å®šå­—ç¬¦ä¸²çš„å¤„ç†ç¨‹åºã€‚ æ­£åˆ™è¡¨è¾¾å¼åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ç§â€œè¡¨ç¤ºæ³•â€ï¼Œåªè¦å·¥å…·æ”¯æŒè¿™ç§è¡¨ç¤ºæ³•ï¼Œé‚£ä¹ˆå·¥å…·ç¨‹åºå°±å¯ä»¥ç”¨æ¥ä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²å¤„ç†ä¹‹ç”¨ã€‚æ¯”å¦‚viã€grepã€awkã€sedç­‰å·¥å…·ã€‚ æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²è¡¨è¾¾æ–¹å¼ä¾ç…§ä¸åŒçš„ä¸¥è°¨åº¦å¯ä»¥åˆ†ä¸ºåŸºæœ¬æ­£åˆ™è¡¨è¾¾å¼ä¸æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ã€‚ åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ REå­—ç¬¦ æ„ä¹‰ ^word å¾…æŸ¥æ‰¾çš„å­—ç¬¦ä¸²(word)åœ¨è¡Œé¦– word$ å¾…æŸ¥æ‰¾çš„å­—ç¬¦ä¸²(word)åœ¨è¡Œå°¾ . ä»£è¡¨ä¸€å®šæœ‰ä¸€ä¸ªä»»æ„å­—ç¬¦çš„å­—ç¬¦ \/ è½¬ä¹‰å­—ç¬¦,å°†ç‰¹æ®Šç¬¦å·çš„ç‰¹æ®Šæ„ä¹‰å»é™¤ * é‡å¤0ä¸ªæˆ–å¤šä¸ªçš„å‰ä¸€ä¸ªå­—ç¬¦ [list] ä»å­—ç¬¦é›†åˆçš„REå­—ç¬¦é‡Œé¢æ‰¾å‡ºæƒ³è¦é€‰å–çš„å­—ç¬¦ [n1-n2] ä»å­—ç¬¦é›†åˆçš„REå­—ç¬¦é‡Œé¢æ‰¾å‡ºæƒ³è¦é€‰å–çš„å­—ç¬¦èŒƒå›´ [^list] ä»å­—ç¬¦é›†åˆçš„REå­—ç¬¦é‡Œé¢æ‰¾å‡ºä¸è¦çš„å­—ç¬¦ä¸²æˆ–èŒƒå›´ /{n,m/} è¿ç»­nåˆ°mä¸ªçš„å‰ä¸€ä¸ªREå­—ç¬¦,/{n/}è¡¨ç¤ºè¿ç»­nä¸ª,/{n,/}è¡¨ç¤ºè¿ç»­nä¸ªåŠä»¥ä¸Š PSï¼šæ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šå­—ç¬¦ä¸ä¸€èˆ¬åœ¨å‘½ä»¤è¡Œè¾“å…¥çš„â€œé€šé…ç¬¦â€å¹¶ä¸ç›¸åŒï¼Œé€šé…ç¬¦çš„*ä»£è¡¨çš„æ˜¯é›¶åˆ°æ— é™å¤šä¸ªå­—ç¬¦çš„æ„æ€ï¼Œä½†æ˜¯åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­*æ˜¯è¡¨ç¤ºé‡å¤0åˆ°æ— ç©·å¤šä¸ªå‰ä¸€ä¸ªREå­—ç¬¦çš„æ„æ€ã€‚ åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼ç»ƒä¹ (ä»¥grepå·¥å…·ä¸ºä¾‹) æŸ¥æ‰¾ç‰¹å®šå­—ç¬¦ä¸² 123grep -n â€˜theâ€™ regular_express.txtgrep -vn &apos;the&apos; regular_express.txt (-våå‘é€‰æ‹©) åˆ©ç”¨ä¸­æ‹¬å·[]æ¥æŸ¥æ‰¾é›†åˆå­—ç¬¦ 12345grep -n &apos;t[ae]st&apos; regular_express.txt (å¯åŒ¹é…testæˆ–tast)grep -n &apos;[^g]oo&apos; regular_express.txt (ooå‰ä¸èƒ½æœ‰gçš„å­—ç¬¦)grep -n &apos;[^[:lower:]]oo&apos; regular_express.txt ([:lower:]ä»£è¡¨a-zçš„æ„æ€) è¡Œé¦–å’Œè¡Œå°¾å­—ç¬¦ 123grep -n &apos;^test&apos; regular_express.txt (æ³¨:^åœ¨[]å†…è¡¨ç¤ºâ€œåå‘é€‰æ‹©â€,åœ¨[]å¤–è¡¨ç¤ºå®šä½åœ¨è¡Œé¦–)grep -n &apos;/.$&apos; regular_express.txt (æ‰¾å‡ºè¡Œå°¾ç»“æŸä¸ºå°æ•°ç‚¹çš„é‚£ä¸€è¡Œ) ä»»æ„ä¸€ä¸ªå­—ç¬¦.ä¸é‡å¤å­—ç¬¦* 12345grep -n â€˜g..dâ€™ regular_express.txt (å¯åŒ¹é…good,gladç­‰å­—ç¬¦)grep -n &apos;ooo*&apos; regular_express.txt (åŒ¹é…è‡³å°‘ä¸¤ä¸ªoä»¥ä¸Šçš„å­—ç¬¦)grep -n &apos;g.*g&apos; regular_express.txt (æ‰¾å‡ºgå¼€å¤´ä¸gç»“å°¾çš„å­—ç¬¦ä¸²,.*è¡¨ç¤ºoä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦çš„æ„æ€) é™å®šè¿ç»­RE(Regular Expression)å­—ç¬¦èŒƒå›´{} 12345grep -n &apos;o/&#123;2/&#125;&apos; regular_express.txt (æ‰¾å‡ºä¸¤ä¸ªoçš„å­—ç¬¦ä¸²)grep -n â€˜go/&#123;2,5/&#125;gâ€™ regular_express.txt (gåæœ‰ä¸¤ä¸ªåˆ°5ä¸ªo,ç„¶åæ¥ä¸€ä¸ªgçš„å­—ç¬¦ä¸²)grep -n â€˜go/&#123;2,/&#125;gâ€™ regular_express.txt (gåæœ‰ä¸¤ä¸ªåŠä»¥ä¸Šçš„o,ç„¶åæ¥ä¸€ä¸ªgçš„å­—ç¬¦ä¸²) sedå·¥å…·sedæœ¬èº«æ˜¯ä¸€ä¸ªç®¡é“å‘½ä»¤ï¼Œå®ƒå¯ä»¥å°†æ•°æ®è¿›è¡Œæ›¿æ¢ã€åˆ é™¤ã€æ–°å¢ã€é€‰å–ç‰¹å®šè¡Œç­‰åŠŸèƒ½ã€‚ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š1sed [-nefr] [åŠ¨ä½œ] æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ä¸€èˆ¬æƒ…å†µä¸‹åªéœ€è¦åŸºç¡€æ­£åˆ™è¡¨è¾¾å¼å³å¯ï¼Œä½†æ˜¯æœ‰æ—¶å€™è¿˜éœ€è¦ä¸€äº›æ‰©å±•åŠŸèƒ½ï¼Œæ¯”å¦‚æ•´åˆä¸¤æ¡ç®¡é“å‘½ä»¤ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¦‚æœæ˜¯grepï¼Œå®ƒåŸºæœ¬ä½¿ç”¨å‘½ä»¤æ˜¯egrepï¼ŒåŸºæœ¬çš„ç¬¦å·å¦‚ä¸‹ï¼š å­—ç¬¦ æ„ä¹‰ä¸èŒƒä¾‹ + é‡å¤ä¸€ä¸ªæˆ–å¤šä¸ªçš„å‰ä¸€ä¸ªREå­—ç¬¦ï¼Œå¦‚ï¼šegrep -n â€˜go+dâ€™ regular_express.txt ? 0ä¸ªæˆ–ä¸€ä¸ªçš„å‰ä¸€ä¸ªREå­—ç¬¦ï¼Œå¦‚ï¼šegrep -n â€˜go?dâ€™ regular_express.txt \ ç”¨æˆ–çš„æ–¹å¼æ‰¾å‡ºå­—ç¬¦ä¸²ï¼Œå¦‚ï¼šegrep -n â€˜gd\ goodâ€™ regular_express.txt () æ‰¾å‡ºâ€œç»„â€çš„å­—ç¬¦ä¸² (å¦‚:egrep -n â€˜g(la \ oo)dâ€™ regular_express.txt è¡¨ç¤ºæ‰¾å‡ºgladæˆ–goodå­—ç¬¦ä¸²) ()+ å¤šä¸ªé‡å¤ç»„çš„åˆ¤åˆ« (å¦‚echo â€˜AxyzxyzxyzxyzCâ€™ \ egrep â€˜A(xyz)+Câ€™ æ‰¾å‡ºå¼€å¤´æ˜¯Aç»“å°¾æ˜¯C,ä¸­é—´æœ‰ä¸€ä¸ªä»¥ä¸Šçš„â€œxyzâ€å­—ç¬¦ä¸²) æ–‡ä»¶çš„æ ¼å¼åŒ–å¤„ç†æ–‡ä»¶æ ¼å¼åŒ–ï¼šprintfå¦‚æœæˆ‘ä»¬éœ€è¦å°†è‡ªå·±çš„æ•°æ®ç»™å®ƒæ ¼å¼åŒ–è¾“å‡ºï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå¥½çš„æ ·å¼ï¼Œè¾“å‡ºçš„æ–¹å¼å…¶å®å’ŒCè¯­è¨€çš„æ ¼å¼åŒ–è¾“å‡ºå·®ä¸å¤šï¼Œå¦‚ä¸‹ï¼š1printf &apos;æ‰“å°æ ¼å¼&apos; å®é™…å†…å®¹ å¥½ç”¨çš„æ•°æ®å¤„ç†å·¥å…·ï¼šawkawkç›¸å½“é€‚åˆå¤„ç†å°å‹çš„æ•°æ®ï¼Œå®ƒçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š1234awk â€˜æ¡ä»¶ç±»å‹1&#123;åŠ¨ä½œ1&#125; æ¡ä»¶ç±»å‹2&#123;åŠ¨ä½œ2&#125; ...â€™ filename// ä¾‹å­last -n 5 | awk &apos;&#123;print $1 &quot;\t&quot; $3&#125;&apos; // å–å‡ºç™»å½•è€…è´¦å·å’Œip è¿™ä¸ªawkçš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š è¯»å…¥ç¬¬ä¸€è¡Œï¼Œå¹¶å°†ç¬¬ä¸€è¡Œçš„å¡«å…¥$0,$1ç­‰å˜é‡ä¸­ ä¾æ®æ¡ä»¶ç±»å‹çš„é™åˆ¶ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦è¿›è¡Œåé¢çš„åŠ¨ä½œ åšå®Œæ‰€æœ‰çš„åŠ¨ä½œä¸æ¡ä»¶ç±»å‹ è‹¥è¿˜æœ‰åç»­è¡Œï¼Œå°±é‡å¤ä¸Šé¢1~3çš„æ­¥éª¤ï¼Œç›´åˆ°æ‰€æœ‰æ•°æ®éƒ½è¯»å®Œä¸ºæ­¢ã€‚ æ–‡ä»¶æ¯”è¾ƒå·¥å…·ï¼šdiffdiffç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„åŒºåˆ«,å¹¶ä¸”æ˜¯ä»¥è¡Œä¸ºå•ä½çš„,diffä¹Ÿå¯ä»¥æ¯”è¾ƒä¸¤ä¸ªç›®å½•ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š1diff [-bBi] from-file to-file patchè¿™ä¸ªå‘½ä»¤ä¸diffæœ‰å¯†ä¸å¯åˆ†çš„è”ç³»ï¼Œå°†æ—§çš„æ–‡ä»¶å‡çº§æˆä¸ºæ–°çš„æ–‡ä»¶çš„æ–¹æ³•æ˜¯å…ˆæ¯”è¾ƒæ–°æ—§ç‰ˆæœ¬çš„åŒºåˆ«ï¼Œå°†å°†åŒºåˆ«æ–‡ä»¶åˆ¶ä½œæˆä¸ºè¡¥ä¸æ–‡ä»¶ï¼Œå†æœ‰è¡¥ä¸é—®ä»·æ›´æ–°æ—§æ–‡ä»¶å³å¯ã€‚ä¾‹å­å¦‚ä¸‹ï¼š1234567891011// èŒƒä¾‹:ä»¥/tmp/testå†…çš„passwd.old ä¸passwd.new åˆ¶ä½œè¡¥ä¸æ–‡ä»¶,å¹¶æ›´æ–°æ—§ç‰ˆæ•°æ®diff -Naur passwd.old passwd.new &gt;passwd.patch// æ›´æ–°æ—§æ–‡ä»¶,å˜æˆå’Œæ–°æ–‡ä»¶ä¸€æ ·patch -p0 &lt; passwd.patch// æ¢å¤æ—§æ–‡ä»¶çš„å†…å®¹patch -R -p0 &lt; passwd.patch å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_åˆæ¢shellæ­¥å…¥bash]]></title>
    <url>%2F2018%2F03%2F28%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E5%88%9D%E6%8E%A2shell%E6%AD%A5%E5%85%A5bash%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨Linuxçš„ç¯å¢ƒä¸‹ï¼Œå¦‚æœä½ ä¸æ‡‚bashæ˜¯ä»€ä¹ˆï¼Œé‚£ä¹ˆå…¶ä»–çš„ä¸œè¥¿å°±ä¸ç”¨å­¦äº†ï¼ è®¤è¯†bashè¿™ä¸ªshellç®¡ç†æ•´ä¸ªè®¡ç®—æœºç¡¬ä»¶çš„å…¶å®æ˜¯æ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼Œè¿™ä¸ªå†…æ ¸æ˜¯éœ€è¦ä¿æŠ¤çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ç”¨æˆ·å°±åªèƒ½é€šè¿‡shellæ¥è·Ÿå†…æ ¸é€šä¿¡ï¼Œä»¥è®©å†…æ ¸è¾¾åˆ°æˆ‘ä»¬æ‰€æƒ³è¦è¾¾åˆ°çš„å·¥ä½œï¼Œé‚£ä¹ˆç³»ç»Ÿã€‚ ç¡¬ä»¶ã€å†…æ ¸ä¸shellä¸‹é¢æ˜¯ç¡¬ä»¶ã€å†…æ ¸ä¸shellçš„å…³ç³»ï¼š æˆ‘ä»¬å¿…é¡»è¦é€šè¿‡â€œshellâ€å°†æˆ‘ä»¬è¾“å…¥çš„å‘½ä»¤ä¸å†…æ ¸é€šä¿¡ï¼Œå¥½è®©å†…æ ¸å¯ä»¥æ§åˆ¶ç¡¬ä»¶æ¥æ­£ç¡®æ— è¯¯åœ°å·¥ä½œã€‚ å…¶å®shellçš„åŠŸèƒ½åªæ˜¯æä¾›ç”¨æˆ·æ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªæ¥å£ï¼Œå› æ­¤è¿™ä¸ªshelléœ€è¦å¯ä»¥è°ƒç”¨å…¶ä»–è½¯ä»¶æ‰å¥½ã€‚åªè¦èƒ½å¤Ÿæ“ä½œåº”ç”¨ç¨‹åºçš„æ¥å£éƒ½èƒ½å¤Ÿç§°ä¸ºshellã€‚ ç‹­ä¹‰çš„shellæŒ‡çš„æ˜¯å‘½ä»¤è¡Œæ–¹é¢çš„è½¯ä»¶ï¼ŒåŒ…æ‹¬bashç­‰ã€‚å¹¿ä¹‰çš„shellåŒ…æ‹¬å›¾å½¢ç•Œé¢çš„è½¯ä»¶ï¼Œå› ä¸ºå›¾å½¢ç•Œé¢ä¹Ÿèƒ½å¤Ÿæ“ä½œå„ç§åº”ç”¨ç¨‹åºæ¥è°ƒç”¨å†…æ ¸å·¥ä½œã€‚ ä¸ºä»€ä¹ˆè¦å­¦å‘½ä»¤è¡Œç•Œé¢çš„shell å‘½ä»¤è¡Œç•Œé¢çš„shellï¼šå¤§å®¶ï¼ˆå‡ ä¹æ‰€æœ‰å‘è¡Œç‰ˆï¼‰éƒ½ä¸€æ · è¿œç¨‹ç®¡ç†ï¼šå‘½ä»¤è¡Œç•Œé¢å°±æ˜¯æ¯”è¾ƒå¿«ï¼Œè€Œä¸”è¾ƒä¸å®¹æ˜“å‡ºç°æ–­çº¿æˆ–è€…ä¿¡æ¯å¤–æµçš„é—®é¢˜ã€‚ Linuxçš„ä»»ç£äºŒè„‰ï¼šshellæ˜¯ä¹Ÿã€‚å› ä¸ºè¦æƒ³å°†è‡ªå·±çš„ä¸»æœºç®¡ç†å¥½ï¼Œè‰¯å¥½çš„shellç¨‹åºç¼–å†™æ˜¯å¿…é¡»çš„ã€‚ ç³»ç»Ÿåˆæ³•ä¸/etc/shellsåŠŸèƒ½ç›®å‰æˆ‘ä»¬çš„Linuxæœ‰ä¸‹é¢å‡ ä¸ªå¯ä»¥ç”¨çš„shellï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹/etc/shellsè¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼š12345678/bin/sh (å·²ç»è¢«/bin/bashæ‰€æ›¿ä»£)/bin/bash (Linuxé»˜è®¤çš„shell)/sbin/nologin/usr/bin/sh/usr/bin/bash/usr/sbin/nologin/bin/tcsh (æ•´åˆC shellï¼Œæä¾›äº†æ›´å¤šçš„åŠŸèƒ½)/bin/csh (å·²ç»è¢«/bin/tcshæ‰€æ›¿ä»£) Linuxé»˜è®¤çš„å°±æ˜¯bashã€‚ç³»ç»Ÿä¸Šåˆæ³•çš„shelléƒ½è¦å†™å…¥/etc/shellsè¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå› ä¸ºç³»ç»ŸæŸäº›æœåŠ¡åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šå»æ£€æŸ¥ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨çš„shellsï¼Œè€Œè¿™äº›shellçš„æŸ¥è¯¢å°±æ˜¯å€ŸåŠ©/etc/shellsè¿™ä¸ªæ–‡ä»¶ã€‚ ç”¨æˆ·é»˜è®¤å–å¾—çš„shellå¯ä»¥é€šè¿‡æŸ¥çœ‹/etc/passwdæ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š123root:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologin bash shellçš„åŠŸèƒ½bashçš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š å‘½ä»¤è®°å¿†èƒ½åŠ›ï¼Œ~/.bash_historyé‡Œé¢ä¼šè®°å½•å‰ä¸€æ¬¡ç™»å½•æ‰€æ‰§è¡Œè¿‡çš„å‘½ä»¤ï¼Œè€Œè¿™ä¸€æ¬¡ç™»å½•éƒ½è¢«æš‚å­˜åœ¨ä¸´æ—¶å†…å­˜ä¸­ï¼ŒæˆåŠŸæ³¨é”€åï¼Œæœ¬æ¬¡æ‰§è¡Œçš„å‘½ä»¤ä¼šè®°å½•åˆ°æ–‡ä»¶ä¸­ã€‚æœ€å¤§çš„å¥½å¤„å°±æ˜¯å¯ä»¥æŸ¥è¯¢æ›¾ç»åšè¿‡çš„æ“ä½œï¼Œåˆ©äºæ’é”™ã€‚ å‘½ä»¤ä¸æ–‡ä»¶è¡¥å…¨åŠŸèƒ½ï¼ˆTabé”®çš„å¥½å¤„ï¼‰ å‘½ä»¤åˆ«åè®¾ç½®åŠŸèƒ½ï¼ˆaliasï¼‰æ‰§è¡Œå¦‚ä¸‹å¾—å‘½ä»¤ï¼š alias ç®€åŒ–å‘½ä»¤=â€™å®é™…å‘½ä»¤â€™ ï¼ˆè®¾ç½®åˆ«åï¼‰; unalias ç®€åŒ–å‘½ä»¤ï¼ˆè§£é™¤åˆ«åï¼‰ ä½œä¸šæ§åˆ¶ã€å‰å°ã€åå°æ§åˆ¶ ç¨‹åºè„šæœ¬ é€šé…ç¬¦ï¼ˆ*ï¼‰ shellçš„å˜é‡åŠŸèƒ½å˜é‡æ˜¯bashç¯å¢ƒä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªç©æ„å„¿ã€‚ ä»€ä¹ˆæ˜¯å˜é‡å˜é‡ï¼š å°±æ˜¯ä»¥ä¸€ç»„æ–‡å­—æˆ–ç¬¦å·ç­‰ï¼Œæ¥æ›¿ä»£ä¸€äº›è®¾ç½®æˆ–è€…ä¸€ä¸²ä¿ç•™çš„æ•°æ®ã€‚ å˜é‡çš„æ–¹ä¾¿æ€§åœ¨äºï¼š å˜é‡çš„å¯å˜æ€§ä¸æ–¹ä¾¿æ€§ ç®€åŒ–bashç¯å¢ƒæ“ä½œ è„šæœ¬ç¨‹åºè®¾è®¡çš„å¥½å¸®æ‰‹ å˜é‡çš„åˆ†ç±»åœ¨Linuxä¸­ï¼Œå˜é‡åˆ†ä¸ºç¯å¢ƒå˜é‡(å…¨å±€å˜é‡) å’Œ å±€éƒ¨å˜é‡ã€‚ç¯å¢ƒå˜é‡èƒ½è¢«å­è¿›ç¨‹ç»§æ‰¿ï¼Œè€Œå±€éƒ¨å˜é‡åªèƒ½åœ¨å½“å‰è¿›ç¨‹ä¸­ä½¿ç”¨ã€‚ ä¸è®ºæ˜¯ç¯å¢ƒå˜é‡è¿˜æ˜¯å±€éƒ¨å˜é‡ã€‚ä»–ä»¬åˆéƒ½å¯ä»¥åˆ†ä¸ºç³»ç»Ÿå˜é‡ å’Œ è‡ªå®šä¹‰å˜é‡ã€‚ç³»ç»Ÿå˜é‡æ˜¯ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºçš„å˜é‡ï¼Œå¾€å¾€ä¸ºç³»ç»Ÿè¿è¡Œæä¾›æ”¯æŒï¼›è€Œè‡ªå®šä¹‰å˜é‡æ˜¯ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œç³»ç»Ÿå˜é‡å…¨ä¸ºå¤§å†™ï¼Œè‡ªå®šä¹‰å˜é‡å…¨ä¸ºå°å†™ã€‚ å˜é‡çš„æ˜¾ç¤ºä¸è®¾ç½®ï¼šechoï¼Œunset å˜é‡çš„æ˜¾ç¤ºï¼šecho è¯»å˜é‡ï¼Œåªéœ€è¦åœ¨å˜é‡åç§°å‰é¢åŠ ä¸Š$ï¼Œæˆ–è€…æ˜¯ä»¥${å˜é‡}çš„æ–¹å¼æ¥æ˜¾ç¤ºå°±å¯ä»¥ã€‚ å˜é‡çš„ä¿®æ”¹ï¼šâ€œ=â€ åªéœ€è¦ç”¨ç­‰å·è¿æ¥å˜é‡ä¸å®ƒçš„å†…å®¹å°±å¥½äº†ã€‚å®ƒå…·æœ‰å¦‚ä¸‹è®¾ç½®è§„åˆ™ï¼š ç­‰å·ä¸¤è¾¹ä¸èƒ½ç›´æ¥æ¥ç©ºæ ¼ç¬¦ å˜é‡åç§°åªèƒ½æ˜¯è‹±æ–‡å­—æ¯ä¸æ•°å­—ï¼Œä½†æ˜¯å¼€å¤´å­—ç¬¦ä¸èƒ½æ˜¯æ•°å­— å˜é‡å†…å®¹è‹¥æœ‰ç©ºæ ¼å¯ä½¿ç”¨åŒå¼•å·æˆ–å•å¼•å·å°†å˜é‡çš„å†…å®¹ç»“åˆèµ·æ¥ å¯ä»¥ç”¨è½¬ä¹‰å­—ç¬¦â€\â€å°†ç‰¹æ®Šç¬¦å·ï¼ˆå¦‚enterã€$ã€\ã€ç©ºæ ¼ç¬¦ã€ï¼ç­‰ï¼‰å˜æˆä¸€èˆ¬å­—ç¬¦ã€‚ åœ¨ä¸€ä¸²å‘½ä»¤ä¸­ï¼Œè¿˜éœ€è¦å…¶ä»–çš„å‘½ä»¤æä¾›çš„ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨åå•å¼•å·â€œ`å‘½ä»¤`â€æˆ–â€œ$(å‘½ä»¤)â€ è‹¥è¯¥å˜é‡ä¸ºäº†å¢åŠ å˜é‡å†…å®¹æ—¶ï¼Œåˆ™å¯ç”¨â€œ$å˜é‡åç§°â€æˆ–${å˜é‡}ç´¯åŠ å†…å®¹ï¼Œåç”¨å†’å·è¿æ¥ã€‚ è‹¥è¯¥å˜é‡éœ€è¦åœ¨å…¶ä»–è‡ªè¿›ç¨‹æ‰§è¡Œï¼Œåˆ™éœ€è¦ä»¥exportæ¥ä½¿å˜é‡å˜æˆç¯å¢ƒå˜é‡ã€‚ é€šå¸¸å¤§å†™å­—ç¬¦ä¸ºç³»ç»Ÿé»˜è®¤å˜é‡ï¼Œè‡ªè¡Œè®¾ç½®å˜é‡å¯ä»¥ä½¿ç”¨å°å†™å­—ç¬¦ï¼Œæ–¹ä¾¿åˆ¤æ–­ã€‚ å–æ¶ˆå˜é‡çš„æ–¹æ³•ä¸ºä½¿ç”¨â€œunset å˜é‡åç§°â€ ä»€ä¹ˆæ˜¯å­è¿›ç¨‹ï¼š åœ¨ä¸€ä¸ªbashä¸­å¼€å¯ä¸€ä¸ªæ–°çš„bashï¼Œé‚£ä¹ˆåŸæœ¬çš„bashç§°ä¸ºçˆ¶è¿›ç¨‹ï¼Œæ–°çš„bashç§°ä¸ºå­è¿›ç¨‹ã€‚ å­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼Œè€Œçˆ¶è¿›ç¨‹çš„å±€éƒ¨å˜é‡åªèƒ½åœ¨çˆ¶è¿›ç¨‹ä¸­ä½¿ç”¨ã€‚ ç¯å¢ƒå˜é‡çš„åŠŸèƒ½ç¯å¢ƒå˜é‡å¯ä»¥å¸®æˆ‘ä»¬è¾¾åˆ°å¾ˆå¤šåŠŸèƒ½ï¼ŒåŒ…æ‹¬ä¸»æ–‡ä»¶å¤¹çš„å˜æ¢ã€æç¤ºç¬¦çš„æ˜¾ç¤ºã€æ‰§è¡Œæ–‡ä»¶æŸ¥æ‰¾çš„è·¯å¾„ç­‰ã€‚åœ¨shellç¯å¢ƒä¸‹ï¼Œå¯ä»¥é€šè¿‡envä¸exportæŸ¥çœ‹ç¯å¢ƒå˜é‡ã€‚ä¸‹é¢ä¸»è¦ä»‹ç»ä¸€ä¸‹ä¸»è¦çš„ç¯å¢ƒå˜é‡ï¼š HOMEï¼šç”¨æˆ·ä¸»ç›®å½•ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨cd æˆ–cd ~æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªç¯å¢ƒå˜é‡æ‰¾åˆ°ç”¨æˆ·ä¸»ç›®å½• SHELLï¼šå½“å‰ä½¿ç”¨çš„SHELLï¼Œé»˜è®¤ä½¿ç”¨/bin/bash HISTSIZEï¼šå†å²å‘½ä»¤çš„æœ€å¤§æ¡æ•° PATHï¼šå¯æ‰§è¡Œæ–‡ä»¶çš„æŸ¥æ‰¾è·¯å¾„ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç¯å¢ƒå˜é‡ï¼Œå½“æˆ‘ä»¬ç›´æ¥å†™ä¸€ä¸ªå‘½ä»¤æ—¶ï¼Œç³»ç»Ÿå°±ä¼šåœ¨PATHè·¯å¾„ä¸­å¯»æ‰¾è¿™ä¸ªå‘½ä»¤ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™å°±ä¸ç”¨è¾“å‘½ä»¤å®Œæ•´çš„è·¯å¾„äº†ã€‚å¤šä¸ªè·¯å¾„ä¹‹é—´ç”¨:åˆ†éš” LANGï¼šå½“å‰ç³»ç»Ÿçš„è¯­è¨€ RANDOMï¼šéšæœºæ•°ç”Ÿæˆå™¨çš„è·¯å¾„ã€‚è¯¥è·¯å¾„é»˜è®¤æŒ‡å‘/dev/randomè¿™ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨$RANDOMæ—¶å°±èƒ½è·å¾—ä¸€ä¸ª0-32767ä¹‹é—´çš„éšæœºæ•´æ•° å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡setæ¥æŸ¥çœ‹æ‰€æœ‰å˜é‡ï¼ˆå«ç¯å¢ƒå˜é‡å’Œè‡ªå®šä¹‰å˜é‡ï¼‰ï¼šè¿™é‡Œä¹Ÿè§£é‡Šå‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å˜é‡ï¼š PS1ï¼šå‘½ä»¤æç¤ºç¬¦ï¼Œåœ¨å‘½ä»¤è¾“å…¥å…‰æ ‡å‰æœ‰ä¸€ä¸²ç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥çš„ä¿¡æ¯ï¼Œè¿™å°±æ˜¯å‘½ä»¤æç¤ºç¬¦ã€‚å‘½ä»¤æç¤ºç¬¦ç©¶ç«Ÿéœ€è¦æ˜¾ç¤ºå“ªäº›ä¿¡æ¯ï¼Œè¿™å°±æ˜¯ç”±PS1è¿™ä¸ªå±€éƒ¨å˜é‡å†³å®šçš„ã€‚ç”±äºå®ƒæ˜¯å±€éƒ¨å˜é‡ï¼Œå› æ­¤å­è¿›ç¨‹ä¸­æ— æ³•ç»§æ‰¿è¿™ä¸ªå˜é‡ï¼Œå­è¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„PS1ã€‚ $ï¼šå½“å‰shellçš„PIDï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰shellçš„PIDï¼š echo $$ ?ï¼šä¸Šä¸ªå‘½ä»¤çš„æ‰§è¡Œç»“æœ,ä¸Šä¸ªå‘½ä»¤è‹¥æ‰§è¡ŒæˆåŠŸï¼Œåˆ™echo $?å°±ä¼šè¿”å›0ï¼›è‹¥ä¸Šä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåˆ™è¯¥å€¼ä¸ºä¸€ä¸ªé0æ•´æ•°ã€‚ å˜é‡å†…å®¹çš„åˆ é™¤ä¸æ›¿æ¢ æ“ä½œæ–¹å¼ è¯´æ˜ ${å˜é‡å#å…³é”®è¯} ä»å˜é‡å€¼çš„å¤´éƒ¨å¼€å§‹ï¼Œä¾æ¬¡å‘ååˆ é™¤åˆ°å…³é”®è¯ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¸ºæ­¢ ${å˜é‡å##å…³é”®è¯} ä»å˜é‡å€¼çš„å¤´éƒ¨å¼€å§‹ï¼Œä¾æ¬¡å‘ååˆ é™¤åˆ°å…³é”®è¯æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¸ºæ­¢ ${å˜é‡å%å…³é”®è¯} ä»å˜é‡å€¼çš„å°¾éƒ¨å¼€å§‹ï¼Œä¾æ¬¡å‘å‰åˆ é™¤åˆ°å…³é”®è¯ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¸ºæ­¢ ${å˜é‡å%%å…³é”®è¯} ä»å˜é‡å€¼çš„å°¾éƒ¨å¼€å§‹ï¼Œä¾æ¬¡å‘å‰åˆ é™¤åˆ°å…³é”®è¯æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ä¸ºæ­¢ ${å˜é‡å/æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²} ä»å˜é‡å€¼çš„å¤´éƒ¨å¼€å§‹ï¼Œä¾æ¬¡å‘åæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ—§å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶æ›¿æ¢ ${å˜é‡å//æ—§å­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²} å°†å˜é‡å€¼ä¸­æ‰€æœ‰çš„æ—§å­—ç¬¦ä¸²æ›¿æ¢æˆæ–°å­—ç¬¦ä¸² Bash Shellçš„æ“ä½œç¯å¢ƒè·¯å¾„ä¸å‘½ä»¤çš„æŸ¥æ‰¾é¡ºåºåŸºæœ¬ä¸Šï¼Œå‘½ä»¤è¿è¡Œçš„é¡ºåºå¯ä»¥è¿™æ ·çœ‹ï¼š ä»¥ç›¸å¯¹/ç»å¯¹è·¯å¾„æ‰§è¡Œå‘½ä»¤ï¼Œä¾‹å¦‚ï¼šâ€œ/bin/lsâ€æˆ–â€œ./lsâ€ ç”±aliasæ‰¾åˆ°è¯¥å‘½ä»¤æ¥æ‰§è¡Œ æœ‰bashå†…ç½®çš„(builtin)å‘½ä»¤æ¥æ‰§è¡Œ é€šè¿‡$PATHè¿™ä¸ªå˜é‡çš„é¡ºåºæ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œ bashçš„ç™»å½•ä¸æ¬¢è¿ç¯å¢ƒï¼š/etc/issue,/etc/motd /etc/issueï¼šæ”¾ç½®ç»ˆç«¯æœºæ¥å£ç™»å½•æˆåŠŸçš„ç•Œé¢æç¤ºçš„å­—ç¬¦ã€‚ /etc/issue.netï¼šæ”¾ç½®telnetè¿œç¨‹ç™»å½•æˆåŠŸçš„ç•Œé¢æç¤ºçš„å­—ç¬¦ã€‚ /etc/motdï¼šå¦‚æœä½ æƒ³è®©ç”¨æˆ·ç™»å½•åå–å¾—ä¸€äº›ä¿¡æ¯ï¼Œå¯ä»¥å°†ä¿¡æ¯åŠ å…¥å…¶ä¸­ã€‚æ¯”å¦‚å‘ŠçŸ¥ç™»å½•è€…ç³»ç»Ÿå°†åœ¨ä»€ä¹ˆæ—¶å€™ç»´æŠ¤ã€‚ bashçš„ç¯å¢ƒé…ç½®æ–‡ä»¶ç”±äºç³»ç»Ÿæœ‰ä¸€äº›ç¯å¢ƒé…ç½®æ–‡ä»¶çš„å­˜åœ¨ï¼Œè®©bashåœ¨å¯åŠ¨æ—¶ç›´æ¥è¯»å–è¿™äº›é…ç½®æ–‡ä»¶ï¼Œæ‰€æœ‰å·²è¿›å…¥bashå°±èƒ½å¤Ÿå–å¾—ä¸€å †æœ‰ç”¨çš„å˜é‡ã€‚è€Œè¿™äº›é…ç½®æ–‡ä»¶åˆå¯ä»¥åˆ†ä¸ºå…¨ä½“ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶ä»¥åŠç”¨æˆ·ä¸ªäººåå¥½é…ç½®æ–‡ä»¶ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œä¹‹å‰æˆ‘ä»¬è¯´çš„å‘½ä»¤åˆ«åã€è‡ªå®šä¹‰çš„å˜é‡åœ¨ä½ æ³¨é”€bashåå°±ä¼šå¤±æ•ˆã€‚æ‰€ä»¥ä½ æƒ³è¦ä¿ç•™ä½ çš„è®¾ç½®ï¼Œå°±å¾—è¦è®²è¿™äº›è®¾ç½®å†™å…¥é…ç½®æ–‡ä»¶æ‰è¡Œã€‚ï¼Œä¸‹é¢å°±çœ‹çœ‹è¿™äº›ä¸œè¥¿ï¼š login shellä¸non-login shell login shellå’Œnon-login shellæ˜¯ä¸¤ç§shellç™»å½•çš„æ–¹å¼ï¼Œå®ƒä»¬ç™»å½•ååŠ è½½çš„ç¯å¢ƒé…ç½®æ–‡ä»¶æœ‰æ‰€ä¸åŒã€‚ login shellåœ¨è·å–bashå‰éœ€è¦è¿›è¡Œä¸€å¥—å®Œæ•´çš„ç™»å½•è¿‡ç¨‹ï¼Œè¿™ä¸ªç™»å½•è¿‡ç¨‹å°±ç§°ä¸ºlogin shellã€‚æ‰€è°“â€œå®Œæ•´çš„ç™»å½•è¿‡ç¨‹â€æŒ‡éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚login shellå…¶å®åªä¼šè¯»å–è¿™ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼š/etc/profileå’Œ(~/.bash_profileæˆ– ~/.bash\_loginæˆ–~/.profile) non-login shellè·å–bashä¸éœ€è¦è¾“å…¥å¯†ç çš„ç™»å½•è¿‡ç¨‹ç§°ä¸ºnon-login shellã€‚å¦‚åœ¨bashä¸­ç›´æ¥è¾“å…¥bashï¼Œä»è€Œæ‰“å¼€ä¸€ä¸ªå­bashï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸éœ€è¦è¾“å…¥å¯†ç ï¼Œå› æ­¤ç§°ä¸ºnon-login shellã€‚æ¯”å¦‚åœ¨å›¾å½¢ç•Œé¢ä¸­ã€‚ /etc/profileï¼šç³»ç»Ÿçº§çš„ç¯å¢ƒå˜é‡(login shellæ‰ä¼šè¯») ã€‚è¯¥æ–‡ä»¶å­˜æ”¾ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡ï¼Œæ‰€æœ‰çš„ç”¨æˆ·éƒ½ä¼šæ‹¥æœ‰ï¼Œä¸€èˆ¬ä¸å»ºè®®ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶ã€‚ ~/.bash_profileï¼šç”¨æˆ·ä¸ªäººçš„ç¯å¢ƒå˜é‡(login shellæ‰ä¼šè¯»)å½“/etc/profileä¸­çš„ç¯å¢ƒå˜é‡åŠ è½½å®Œæ¯•åå°±ä¼šåŠ è½½æœ¬æ–‡ä»¶ï¼Œæœ¬æ–‡ä»¶ä¸­å®šä¹‰äº†å½“å‰ç”¨æˆ·çš„ç¯å¢ƒå˜é‡ã€‚ ~/.bashrcï¼šnon-login shellä¼šè¯»å–çš„ç¯å¢ƒé…ç½®æ–‡ä»¶å½“ç”¨æˆ·ä»¥non-loginæ–¹å¼ç™»å½•åï¼Œåªä¼šåŠ è½½è¿™ä¸ªæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¼šå¯¹ä¸€äº›æ“ä½œåŠ ä¸Šå®‰å…¨è¯¢é—®ã€‚è¿™ä¸ªæ–‡ä»¶ä¸ç®¡å“ªç§ç™»å½•æ–¹å¼éƒ½ä¼šè¢«åŠ è½½ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥å­˜æ”¾åˆ«åã€‚ /etc/man.confï¼šè®¾ç½®mançš„å­˜æ”¾è·¯å¾„å¦‚æœä½¿ç”¨æºç å®‰è£…è½¯ä»¶çš„è¯(érpmã€yum)ï¼Œä¸€èˆ¬è½¯ä»¶ä¼šå®‰è£…åœ¨è‡ªå®šä¹‰çš„ç›®å½•ä¸­(ä¸€èˆ¬ä¸º/usr/local/è½¯ä»¶å)ã€‚é‚£ä¹ˆè½¯ä»¶ä¸­çš„manæ–‡ä»¶å°±æ— æ³•è¢«ç³»ç»Ÿæ‰¾åˆ°ï¼Œä»è€Œæ— æ³•é€šè¿‡â€œman+å‘½ä»¤â€æ‰¾åˆ°è¿™ä¸ªè½¯ä»¶çš„å‘½ä»¤å¸®åŠ©æ–‡æ¡£ã€‚æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†è¯¥è½¯ä»¶çš„manç›®å½•æ·»åŠ åˆ°/etc/man.confä¸­å»ï¼Œä»è€Œæ‰§è¡Œâ€œman+å‘½ä»¤â€å°±èƒ½æ‰¾åˆ°è¿™ä¸ªç›®å½•çš„å¸®åŠ©æ–‡æ¡£ã€‚ ~/.bash_historyï¼šå­˜å‚¨ç”¨æˆ·å†å²å‘½ä»¤ ~/.bash_logoutï¼šè®°å½•æ³¨é”€åç³»ç»Ÿæ‰§è¡Œçš„æ“ä½œ é€šé…ç¬¦å’Œç‰¹æ®Šå­—ç¬¦é€šé…ç¬¦åœ¨bashçš„æ“ä½œç¯å¢ƒä¸­è¿˜æœ‰ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œé‚£å°±æ˜¯é€šé…ç¬¦ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„é€šé…ç¬¦ï¼š ç¬¦å· æ„ä¹‰ * ä»£è¡¨ä»»æ„å¤šä¸ªå­—ç¬¦ ? ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ [] [abcd]ï¼šä»£è¡¨è¯¥èŒƒå›´å†…çš„ä¸€ä¸ªå­—ç¬¦ [-] [a-z]ï¼šä»£è¡¨a-zä¹‹é—´çš„ä¸€ä¸ªå­—ç¬¦ [^] [^a-z]ï¼šä»£è¡¨é™¤äº†a-zä»¥å¤–çš„æ‰€æœ‰å­—ç¬¦ ç‰¹æ®Šå­—ç¬¦ä¸‹é¢æ˜¯bashç¯å¢ƒä¸­çš„ç‰¹æ®Šç¬¦å·ï¼š ç¬¦å· å†…å®¹ # æ³¨é‡Š \ è½¬ç§»å­—ç¬¦ï¼Œå°†ç‰¹æ®Šå­—ç¬¦è½¬ä¸ºæ™®é€šå­—ç¬¦ ; åˆ†éš”å¤šä¸ªç›®å½•ï¼Œä½¿å¾—ä¾æ¬¡æ‰§è¡Œ ~ ç”¨æˆ·ä¸»ç›®å½• $ å˜é‡çš„èµ·å§‹ç¬¦ &amp; å°†ç›®å½•ç½®äºåå°æ‰§è¡Œ ! é / ç›®å½•åˆ†éš”ç¬¦ &gt;,&gt;&gt; æ•°æ®æµé‡å®šå‘ï¼Œè¾“å‡ºå¯¼å‘ &lt;,&lt;&lt; æ•°æ®æµé‡å®šå‘ï¼Œè¾“å…¥å¯¼å‘ â€˜â€™ ä¸å«å˜é‡ç½®æ¢åŠŸèƒ½ â€œâ€ å«æœ‰å˜é‡ç½®æ¢åŠŸèƒ½ `` ä¸­é—´ä¸ºå¾…æ‰§è¡Œçš„å‘½ä»¤ï¼Œå’Œ$()ä¸€è‡´ () ä¸­é—´ä¸ºå­shellçš„èµ·å§‹å’Œç»“æŸ {} ä¸­é—´ä¸ºå‘½ä»¤å— å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_å­¦ä¼šä½¿ç”¨vimç¨‹åºç¼–è¾‘å™¨]]></title>
    <url>%2F2018%2F03%2F26%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E5%AD%A6%E4%BC%9A%E4%BD%BF%E7%94%A8vim%E7%A8%8B%E5%BA%8F%E7%BC%96%E8%BE%91%E5%99%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç³»ç»Ÿç®¡ç†å‘˜çš„é‡è¦å·¥ä½œå°±æ˜¯ä¿®æ”¹ä¸è®¾ç½®æŸäº›é‡è¦è½¯ä»¶çš„é…ç½®æ–‡ä»¶ï¼Œå› æ­¤è‡³å°‘å¾—åˆ°å­¦ä¼šä¸€ç§ä»¥ä¸Šçš„å‘½ä»¤è¡Œç•Œé¢çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚åœ¨æ‰€æœ‰çš„Linuxå‘è¡Œç‰ˆä¸­éƒ½å…·æœ‰viè¿™æ¬¾ç¼–è¾‘å™¨ï¼Œæˆ‘ä»¬è¿™æ¬¡å­¦çš„å®ƒçš„é«˜çº§ç‰ˆvimã€‚ viä¸vimè™½ç„¶åœ¨Linuxåœ¨å‘½ä»¤è¡Œç•Œé¢ä¸‹çš„æ–‡æœ¬ç¼–è¾‘å™¨æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚Emacsï¼Œpicoï¼Œnanoï¼Œjoeä¸vimç­‰ã€‚ä½†æ˜¯æˆ‘ä»¬å´ä¸€å®šè¦å­¦ä¼šviæˆ–è€…è¯´vimï¼Œvimç›¸å½“äºviçš„é«˜çº§ç‰ˆã€‚ ä¸ºä»€ä¹ˆè¦å­¦vim æ‰€æœ‰çš„UNIX Likeç³»ç»Ÿéƒ½ä¼šå†…ç½®viæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œå…¶ä»–æ–‡æœ¬ç¼–è¾‘å™¨ä¸ä¸€å®šå­˜åœ¨ã€‚ æ‰€æœ‰è½¯ä»¶çš„ç¼–è¾‘ç»“æ„éƒ½ä¼šä¸»åŠ¨è°ƒç”¨viï¼ˆä¾‹å¦‚crontabï¼Œvisudo,edquotaç­‰ï¼‰å¾ˆé‡è¦ vimå…·æœ‰ç¨‹åºç¼–è¾‘èƒ½åŠ›ï¼Œå¯ä»¥ä¸»åŠ¨ä»¥å­—ä½“é¢œè‰²è¾¨åˆ«è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œæ–¹ä¾¿ç¨‹åºè®¾è®¡ã€‚ ç¨‹åºç®€å•ï¼Œç¼–è¾‘é€Ÿåº¦ç›¸å½“å¿«é€Ÿã€‚ viçš„ä½¿ç”¨viåˆ†ä¸º3ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ä¸€èˆ¬æ¨¡å¼ã€ç¼–è¾‘æ¨¡å¼ä¸å‘½ä»¤è¡Œæ¨¡å¼ã€‚å®ƒä»¬çš„ä½œç”¨å¦‚ä¸‹ï¼š ä¸€èˆ¬æ¨¡å¼ï¼šä»¥viæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å°±ç›´æ¥è¿›å…¥ä¸€èˆ¬æ¨¡å¼äº†ã€‚åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨å·¦å³æŒ‰é”®æ¥ç§»åŠ¨å…‰æ ‡ï¼Œä½ å¯ä»¥åˆ é™¤å­—ç¬¦æˆ–åˆ é™¤æ•´è¡Œï¼Œä¹Ÿå¯ä»¥å¤åˆ¶ï¼Œç²˜è´´ä½ çš„æ–‡ä»¶æ•°æ®ã€‚ ç¼–è¾‘æ¨¡å¼ï¼šåœ¨ä¸€èˆ¬æ¨¡å¼ä¸­æ˜¯æ— æ³•ç¼–è¾‘æ–‡ä»¶å†…å®¹çš„ã€‚è¦ç­‰åˆ°ä½ æŒ‰ä¸‹â€œi,l,o,O,a,A,r,Râ€ç­‰ä»»ä½•ä¸€ä¸ªå­—æ¯ä¹‹åæ‰ä¼šè¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚é€šå¸¸åœ¨Linuxä¸­ï¼ŒæŒ‰ä¸‹è¿™äº›æŒ‰é”®æ—¶ï¼Œåœ¨ç•Œé¢çš„å·¦ä¸‹æ–¹ä¼šå‡ºç°INSERTæˆ–REPLACEçš„å­—æ ·ï¼Œæ­¤æ—¶æ‰å¯ä»¥ç¼–è¾‘ï¼Œå¦‚æœè¦å›åˆ°ä¸€èˆ¬æ¨¡å¼ï¼Œå¿…é¡»è¦æŒ‰ä¸‹ESCæ‰å¯ä»¥é€€å‡ºç¼–è¾‘æ¨¡å¼ã€‚ å‘½ä»¤è¡Œæ¨¡å¼ï¼šåœ¨ä¸€èˆ¬æ¨¡å¼ä¸­ï¼Œè¾“å…¥â€œ:ã€/ã€?â€3ä¸ªä¸­çš„ä»»ä½•ä¸€ä¸ªæŒ‰é’®ï¼Œå°±å¯ä»¥å°†å…‰æ ‡ç§»åŠ¨åˆ°æœ€ä¸‹é¢çš„é‚£ä¸€è¡Œã€‚åœ¨è¿™ä¸ªæ¨¡å¼å½“ä¸­ï¼Œå¯ä»¥æä¾›ä½ æŸ¥æ‰¾æ•°æ®çš„æ“ä½œï¼Œè€Œè¯»å–ã€ä¿å­˜ã€å¤§é‡æ›¿æ¢å­—ç¬¦ã€ç¦»å¼€viã€æ˜¾ç¤ºè¡Œå·ç­‰æ“ä½œå°±æ˜¯åœ¨æ­¤æ¨¡å¼ä¸­å®Œæˆçš„ã€‚ viæŒ‰é”®è¯´æ˜è¿™ä¸ªæŒ‰é”®è¯´æ˜å¤§éƒ¨åˆ†äººéƒ½ä¼šæœ‰æ€»ç»“ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±ä¸å†åšæ— ç”¨åŠŸäº†ï¼Œæ‰€ä»¥è´´å‡ºä¸‹é¢çš„é“¾æ¥ï¼Œé‡åˆ°é—®é¢˜å»æŸ¥å°±å¥½äº†ï¼Œä½†æ˜¯éœ€è¦ä¿è¯æ‰€æœ‰æŒ‰é”®éƒ½äº²è‡ªå»è¯•ä¸€éï¼ Linux - vimæŒ‰é”®è¯´æ˜ ä½†æ˜¯è¿™é‡Œæˆ‘è¿˜æ˜¯æƒ³æŠŠå¸¸ç”¨çš„å‘½ä»¤åœ¨è¿™é‡Œå†è´´å‡ºæ¥ï¼Œå¸Œæœ›èƒ½å¤Ÿè®°ä½ï¼š ä¸€èˆ¬æ¨¡å¼å¯ç”¨çš„æŒ‰é’®è¯´æ˜ï¼Œå…‰æ ‡ç§»åŠ¨ã€å¤åˆ¶ç²˜è´´ã€æŸ¥æ‰¾æ›¿æ¢ç­‰ æŒ‰é”® æŒ‰é”®è¯´æ˜ Ctrl + f å±å¹•ã€å‘ä¸‹ã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Down]æŒ‰é”® Ctrl + b å±å¹•ã€å‘ä¸Šã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Up] æŒ‰é”® 0 æˆ–åŠŸèƒ½é”®Home è¿™æ˜¯æ•°å­—ã€ 0 ã€ï¼šç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€å‰é¢å­—ç¬¦å¤„ (å¸¸ç”¨) $ æˆ–åŠŸèƒ½é”®End ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€åé¢å­—ç¬¦å¤„(å¸¸ç”¨) G ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„æœ€åä¸€è¡Œ(å¸¸ç”¨) gg ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ä¸€è¡Œï¼Œç›¸å½“äº 1G å•Šï¼ (å¸¸ç”¨) nEnter nä¸ºæ•°å­—ã€‚å…‰æ ‡å‘ä¸‹ç§»åŠ¨ n è¡Œ(å¸¸ç”¨) /word å‘å…‰æ ‡ä¹‹ä¸‹å¯»æ‰¾ä¸€ä¸ªåç§°ä¸º word çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚è¦åœ¨æ¡£æ¡ˆå†…æœå¯» serverè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå°±è¾“å…¥ /vbird å³å¯ï¼ (å¸¸ç”¨) :n1,n2s/word1/word2/g n1 ä¸ n2 ä¸ºæ•°å­—ã€‚åœ¨ç¬¬ n1 ä¸ n2 è¡Œä¹‹é—´å¯»æ‰¾ word1 è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2 :1,$s/word1/word2/g ä»ç¬¬ä¸€è¡Œåˆ°æœ€åä¸€è¡Œå¯»æ‰¾ word1 å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2 :1,$s/word1/word2/gc ä»ç¬¬ä¸€è¡Œåˆ°æœ€åä¸€è¡Œå¯»æ‰¾ word1 å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2 ï¼ä¸”åœ¨å–ä»£å‰æ˜¾ç¤ºæç¤ºå­—ç¬¦ç»™ç”¨æˆ·ç¡®è®¤ (confirm) æ˜¯å¦éœ€è¦å–ä»£ x, X åœ¨ä¸€è¡Œå­—å½“ä¸­ï¼Œx ä¸ºå‘ååˆ é™¤ä¸€ä¸ªå­—ç¬¦ (ç›¸å½“äº [del] æŒ‰é”®)ï¼Œ X ä¸ºå‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦(ç›¸å½“äº [backspace] äº¦å³æ˜¯é€€æ ¼é”®) dd åˆ é™¤æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€æ•´åˆ— ndd n ä¸ºæ•°å­—ã€‚åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n åˆ—ï¼Œä¾‹å¦‚ 20dd åˆ™æ˜¯åˆ é™¤ 20 åˆ— yy å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€è¡Œ nyy n ä¸ºæ•°å­—ã€‚å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n åˆ—ï¼Œä¾‹å¦‚ 20yy åˆ™æ˜¯å¤åˆ¶ 20 åˆ— p, P p ä¸ºå°†å·²å¤åˆ¶çš„æ•°æ®åœ¨å…‰æ ‡ä¸‹ä¸€è¡Œè´´ä¸Šï¼ŒP åˆ™ä¸ºè´´åœ¨æ¸¸æ ‡ä¸Šä¸€è¡Œï¼ ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ç›®å‰å…‰æ ‡åœ¨ç¬¬ 20 è¡Œï¼Œä¸”å·²ç»å¤åˆ¶äº† 10 è¡Œæ•°æ®ã€‚åˆ™æŒ‰ä¸‹ p åï¼Œ é‚£ 10 è¡Œæ•°æ®ä¼šè´´åœ¨åŸæœ¬çš„ 20 è¡Œä¹‹åï¼Œäº¦å³ç”± 21 è¡Œå¼€å§‹è´´ã€‚ä½†å¦‚æœæ˜¯æŒ‰ä¸‹ P å‘¢ï¼Ÿ é‚£ä¹ˆåŸæœ¬çš„ç¬¬ 20 è¡Œä¼šè¢«æ¨åˆ°å˜æˆ 30 è¡Œã€‚ u å¤åŸå‰ä¸€ä¸ªåŠ¨ä½œ Ctrl+r é‡åšä¸Šä¸€ä¸ªåŠ¨ä½œ . ä¸è¦æ€€ç–‘ï¼è¿™å°±æ˜¯å°æ•°ç‚¹ï¼æ„æ€æ˜¯é‡å¤å‰ä¸€ä¸ªåŠ¨ä½œçš„æ„æ€ã€‚ å¦‚æœä½ æƒ³è¦é‡å¤åˆ é™¤ã€é‡å¤è´´ä¸Šç­‰ç­‰åŠ¨ä½œï¼ŒæŒ‰ä¸‹å°æ•°ç‚¹â€œ.â€å°±å¥½äº†ï¼ ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜ æŒ‰é”® æŒ‰é”®è¯´æ˜ i, I è¿›å…¥æ’å…¥æ¨¡å¼(Insert mode)ï¼ši ä¸ºä»ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„æ’å…¥ï¼Œ I ä¸ºåœ¨ç›®å‰æ‰€åœ¨è¡Œçš„ç¬¬ä¸€ä¸ªéç©ºæ ¼ç¬¦å¤„å¼€å§‹æ’å…¥ã€‚ a, A è¿›å…¥æ’å…¥æ¨¡å¼(Insert mode)ï¼šaä¸ºä»ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹æ’å…¥ï¼Œ A ä¸ºä»å…‰æ ‡æ‰€åœ¨è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹æ’å…¥ã€‚ o, O è¿›å…¥æ’å…¥æ¨¡å¼(Insert mode)ï¼šè¿™æ˜¯è‹±æ–‡å­—æ¯ o çš„å¤§å°å†™ã€‚o ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€è¡Œå¤„æ’å…¥æ–°çš„ä¸€ã€ï¼› O ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„çš„ä¸Šä¸€è¡Œæ’å…¥æ–°çš„ä¸€è¡Œï¼ r, R è¿›å…¥å–ä»£æ¨¡å¼(Replace mode)ï¼šr åªä¼šå–ä»£å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€ä¸ªå­—ç¬¦ä¸€æ¬¡ï¼›Rä¼šä¸€ç›´å–ä»£å…‰æ ‡æ‰€åœ¨çš„æ–‡å­—ï¼Œç›´åˆ°æŒ‰ä¸‹ ESC ä¸ºæ­¢ã€‚ Esc é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œå›åˆ°ä¸€èˆ¬æ¨¡å¼ä¸­ ä¸€èˆ¬æ¨¡å¼åˆ‡æ¢åˆ°æŒ‡ä»¤åˆ—æ¨¡å¼çš„å¯ç”¨çš„æŒ‰é’®è¯´æ˜ æŒ‰é”® æŒ‰é”®è¯´æ˜ :w å°†ç¼–è¾‘çš„æ•°æ®å†™å…¥ç¡¬ç›˜æ¡£æ¡ˆä¸­ :q ç¦»å¼€ vi :wq å‚¨å­˜åç¦»å¼€ï¼Œè‹¥ä¸º :wq! åˆ™ä¸ºå¼ºåˆ¶å‚¨å­˜åç¦»å¼€ vimçš„åŠŸèƒ½ç›®å‰å¤§éƒ¨åˆ†çš„å‘è¡Œç‰ˆéƒ½ä»¥vimæ›¿ä»£viçš„åŠŸèƒ½äº†ï¼Œå¦‚æœä½ ä½¿ç”¨viåï¼Œå´çœ‹åˆ°ç•Œé¢çš„å³ä¸‹è§’æœ‰æ˜¾ç¤ºç›®å‰å…‰æ ‡çš„è¡Œåˆ—å·ç ï¼Œé‚£ä¹ˆä½ çš„viå·²ç»è¢«vimæ›¿ä»£äº†ï¼Œvimç›¸æ¯”äºviæœ‰è®¸å¤šæ–°çš„åŠŸèƒ½ã€‚ å—æ“ä½œviçš„æ“ä½œåŸºæœ¬ä¸Šéƒ½æ˜¯ä»¥è¡Œä¸ºå•ä½çš„æ“ä½œï¼Œä½†æ˜¯vimå…·æœ‰å—æ“ä½œçš„åŠŸèƒ½ï¼Œå…·ä½“çš„æŒ‰é”®è¯´æ˜å¦‚ä¸‹ï¼š æŒ‰é”® æŒ‰é”®è¯´æ˜ v å­—ç¬¦é€‰æ‹©ï¼Œå°†å…‰æ ‡ç»è¿‡çš„åœ°æ–¹åç™½é€‰æ‹© V è¡Œé€‰æ‹©ï¼Œå°†å…‰æ ‡ç»è¿‡çš„è¡Œåç™½é€‰æ‹© Ctrl + v å—é€‰æ‹©ï¼Œå¯ä»¥ç”¨é•¿æ–¹å½¢é€‰æ‹©æ•°æ® y å°†åç™½çš„åœ°æ–¹å¤åˆ¶ d åˆ é™¤åç™½çš„åœ°æ–¹ å¤šæ–‡ä»¶ç¼–è¾‘æœ‰äº‹æˆ‘ä»¬éœ€è¦åœ¨ä¸€ä¸ªvimå†…ç¼–è¾‘å¤šä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦å¤šæ–‡ä»¶ç¼–è¾‘åŠŸèƒ½ï¼Œå…·ä½“æŒ‰é”®å¦‚ä¸‹ï¼š æŒ‰é”® æŒ‰é”®è¯´æ˜ :n ç¼–è¾‘ä¸‹ä¸€ä¸ªæ–‡ä»¶ :N ç¼–è¾‘ä¸Šä¸€ä¸ªæ–‡ä»¶ :files åˆ—å‡ºç›®å‰è¿™ä¸ªvimæ‰“å¼€çš„æ‰€æœ‰æ–‡ä»¶ å¤šçª—å£åŠŸèƒ½å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹æ¯”æ–‡ä»¶ï¼Œä½†æ˜¯æƒ…å†µæ˜¯åœ¨åŒä¸€ä¸ªvimçª—å£ï¼Œè¿™æ—¶å€™ä¹Ÿå°±éœ€è¦ç”¨åˆ°å¤šçª—å£åŠŸèƒ½ï¼Œå…·ä½“æŒ‰é”®å¦‚ä¸‹ï¼š æŒ‰é”® æŒ‰é”®è¯´æ˜ ï¼šsp filename æ‰“å¼€æ–°çª—å£ï¼Œå¦‚æœæœ‰åŠ filename,æ–°çª—å£æ‰“å¼€æ–°æ–‡ä»¶ï¼Œå¦åˆ™æ‰“å¼€ç›¸åŒæ–‡ä»¶ Ctrl + w + j/â†“ æŒ‰é”®çš„æŒ‰æ³•æ˜¯ï¼šå…ˆæŒ‰ä¸‹Ctrlä¸æ”¾ï¼Œå†æŒ‰ä¸‹wåæ”¾å¼€æ‰€æœ‰çš„æŒ‰é”®ï¼Œç„¶åå†æŒ‰ä¸‹jæˆ–ç®­å¤´ï¼Œåˆ™å…‰æ ‡å¯ç§»åŠ¨åˆ°ä¸‹æ–¹çš„çª—å£ Ctrl + w + k/â†‘ åŒä¸Šï¼Œä½†æ˜¯å…‰æ ‡ç§»åŠ¨åˆ°ä¸Šé¢çš„çª—å£ vimå¸¸ç”¨å‘½ä»¤ç¤ºæ„å›¾ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹ Linux - vimæŒ‰é”®è¯´æ˜]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_Linuxç£ç›˜ä¸æ–‡ä»¶ç³»ç»Ÿç®¡ç†]]></title>
    <url>%2F2018%2F03%2F25%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_Linux%E7%A3%81%E7%9B%98%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç³»ç»Ÿç®¡ç†å‘˜æœ€é‡è¦çš„ä»»åŠ¡ä¹‹ä¸€å°±æ˜¯ç®¡ç†å¥½è‡ªå·±çš„ç£ç›˜æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥æœ¬æ–‡çš„çŸ¥è¯†å¯¹äºé‚£äº›éœ€è¦è§„åˆ’è‡ªå·±ç£ç›˜æ–‡ä»¶ç³»ç»Ÿçš„äººç¾¤ç‰¹åˆ«é‡è¦ï¼Œæœ‰äº›å†…å®¹å¯èƒ½ä¸å¤ªè¯¦ç»†ï¼Œæ‰€ä»¥æ—¥åè‡ªå·±äº²èº«å®è·µè¿‡åï¼Œå¸Œæœ›èƒ½å†å¼€ä¸€ç¯‡è¯¦ç»†çš„æ–‡ç« ã€‚ è®¤è¯†æ–‡ä»¶ç³»ç»ŸLinuxæœ€ä¼ ç»Ÿçš„ç£ç›˜æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨çš„æ˜¯EXT2ï¼ˆç´¢å¼•å¼æ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚æ‰€ä»¥è¦äº†è§£æ–‡ä»¶ç³»ç»Ÿå°±å¾—è¦åˆè®¤è¯†EXT2å¼€å§‹ã€‚ åœ¨Linuxä¸­ï¼Œéœ€è¦è®°å½•æ–‡ä»¶æƒé™ä¸æ–‡ä»¶å±æ€§ï¼Œæ‰€ä»¥æ–‡ä»¶ç³»ç»Ÿé€šå¸¸ä¼šå°†è¿™ä¸¤éƒ¨åˆ†çš„æ•°æ®åˆ†åˆ«å­˜æ”¾åœ¨ä¸åŒçš„å—ï¼Œæƒé™å’Œå±æ€§æ”¾ç½®åˆ°inodeä¸­ï¼Œè‡³äºå®é™…æ•°æ®åˆ™æ”¾ç½®åˆ°data blockå—ä¸­ï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªè¶…çº§å—ï¼ˆsuperblockï¼‰ä¼šè®°å½•æ•´ä½“æ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ä¿¡æ¯ã€‚æ¯ä¸ªinodeï¼Œblockéƒ½æœ‰ç¼–å·ï¼Œä¸‹é¢ç®€ç•¥è¯´æ˜ä¸Šé¢ä¸‰ä¸ªæ•°æ®çš„æ„ä¹‰ï¼š super blockï¼šè®°å½•æ­¤æ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ä¿¡æ¯ï¼ŒåŒ…æ‹¬inode/blockçš„æ€»é‡ã€ä½¿ç”¨é‡ã€ä»¥åŠæ–‡ä»¶ç³»ç»Ÿçš„æ ¼å¼ä¸ç›¸å…³ä¿¡æ¯ã€‚ inodeï¼šè®°å½•æ–‡ä»¶çš„å±æ€§ï¼Œä¸€ä¸ªæ–‡ä»¶å ç”¨ä¸€ä¸ªinodeï¼ŒåŒæ—¶è®°å½•æ­¤æ–‡ä»¶çš„æ•°æ®æ‰€åœ¨çš„blockå·ç ã€‚ blockï¼šå®é™…è®°å½•æ–‡ä»¶çš„å†…å®¹ï¼Œè‹¥æ–‡ä»¶å¤ªå¤§æ—¶ï¼Œä¼šå ç”¨å¤šä¸ªblockã€‚ Linuxçš„Ext2æ–‡ä»¶ç³»ç»Ÿ Ext2æ–‡ä»¶ç³»ç»Ÿä¸»è¦æœ‰boot sectorï¼Œsuperblockï¼Œinode bitmapï¼Œblock bitmapï¼Œinode tableï¼Œdata blockå…­å¤§éƒ¨åˆ†ã€‚ data blockæ˜¯ç”¨æ¥æ”¾ç½®æ–‡ä»¶å†…å®¹æ•°æ®çš„åœ°æ–¹ï¼Œåœ¨Ext2æ–‡ä»¶ç³»ç»Ÿä¸­æ‰€æ”¯æŒçš„blockå¤§å°æœ‰1KBã€2KBåŠ4KBä¸‰ç§ã€‚ inodeè®°å½•æ–‡ä»¶çš„å±æ€§/æƒé™ç­‰æ•°æ®ï¼Œæ¯ä¸ªinodeå¤§å°å‡å›ºå®šä¸º128bytesï¼›æ¯ä¸ªæ–‡ä»¶éƒ½ä»…å æœ‰ä¸€ä¸ªinodeè€Œå·²ï¼›å› æ­¤æ–‡ä»¶ç³»ç»Ÿèƒ½å¤Ÿæ–°å»ºçš„æ–‡ä»¶æ•°é‡ï¼Œä¸inodeæ•°é‡æœ‰å…³ã€‚ æ–‡ä»¶çš„blockè®°å½•æ–‡ä»¶çš„å®é™…æ•°æ®ï¼Œç›®å½•çš„blockåˆ™è®°å½•è¯¥ç›®å½•ä¸‹é¢æ–‡ä»¶åä¸å…¶inodeå·ç çš„å¯¹ç…§è¡¨ã€‚ æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿä¼šå¤šå‡ºä¸€å—è®°å½•åŒºï¼Œéšæ—¶è®°è½½æ–‡ä»¶ç³»ç»Ÿçš„ä¸»è¦æ´»åŠ¨ï¼Œå¯åŠ å¿«æ¢å¤æ—¶é—´ã€‚ Linuxæ–‡ä»¶ç³»ç»Ÿä¸ºå¢åŠ å…¶æ€§èƒ½ï¼Œä¼šè®©ä¸»å­˜å‚¨å™¨ä½œä¸ºå¤§é‡çš„ç£ç›˜é«˜é€Ÿç¼“å­˜ã€‚ æ–‡ä»¶ç³»ç»Ÿçš„ç®€å•æ“ä½œç£ç›˜ä¸ç›®å½•çš„å®¹é‡ï¼šdfï¼Œdu dfï¼šåˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ç£ç›˜ä½¿ç”¨é‡ åœ¨æ‰§è¡Œdfå‘½ä»¤ä¹‹åï¼Œä¼šå‡ºç°å¦‚ä¸‹ä¿¡æ¯ï¼š 1234567æ–‡ä»¶ç³»ç»Ÿ 1K-å— å·²ç”¨ å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹/dev/vda1 51474044 6759800 42092876 14% /devtmpfs 932632 0 932632 0% /devtmpfs 941920 24 941896 1% /dev/shmtmpfs 941920 316 941604 1% /runtmpfs 941920 0 941920 0% /sys/fs/cgrouptmpfs 188388 0 188388 0% /run/user/0 duï¼šè¯„ä¼°æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨é‡ï¼ˆå¸¸ç”¨äºè¯„ä¼°ç›®å½•æ‰€å å®¹é‡ï¼‰ å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„æ¡ˆä¾‹ï¼š 123456// 1. åˆ—å‡ºç›®å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å®¹é‡du// 2. åŒèŒƒä¾‹ä¸€ï¼Œä½†æ˜¯å°†æ–‡ä»¶çš„å®¹é‡ä¹Ÿåˆ—å‡ºæ¥du -a// 3. æ£€æŸ¥æ ¹ç›®å½•ä¸‹é¢æ¯ä¸ªç›®å½•æ‰€å ç”¨çš„å®¹é‡du -sm /* è¿æ¥æ–‡ä»¶ hard link (ç¡¬è¿æ¥æˆ–å®é™…è¿æ¥) hard linkåªæ˜¯åœ¨æŸä¸ªç›®å½•ä¸‹æ–°å»ºä¸€æ¡æ–‡ä»¶åè¿æ¥åˆ°æŸinodeå·ç çš„ç®¡ç†è®°å½•ã€‚å®ƒçš„å‘½ä»¤å¦‚ä¸‹ï¼š ln hard linkæ˜¯æœ‰å¦‚ä¸‹é™åˆ¶çš„ï¼š ä¸èƒ½è·¨æ–‡ä»¶ç³»ç»Ÿ ä¸èƒ½è¿æ¥åˆ°ç›®å½• symbolic link (ç¬¦å·è¿æ¥ï¼Œä¹Ÿå³æ˜¯å¿«æ·æ–¹å¼) symbolic linkå°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶ä¼šè®©æ•°æ®çš„è¯»å–æŒ‡å‘å®ƒè¿æ¥çš„æŒ‰ä¸ªæ–‡ä»¶çš„æ–‡ä»¶åã€‚å®ƒçš„å‘½ä»¤å¦‚ä¸‹ï¼š ls -s symbolic linkä¸Windowsçš„å¿«æ·æ–¹å¼å¯ä»¥ç”»ä¸Šç­‰å·ï¼Œå¦‚æœåŸæ–‡ä»¶è¢«åˆ é™¤äº†ï¼Œé‚£symbolic linkä¹Ÿå°±ä¸èƒ½ç”¨äº†ã€‚ ç£ç›˜çš„åˆ†åŒºã€æ ¼å¼åŒ–ã€æ ¡éªŒä¸æŒ‚è½½å¯¹äºä¸€ä¸ªç³»ç»Ÿç®¡ç†è€…(root)è€Œè¨€ï¼Œç£ç›˜çš„ç®¡ç†æ˜¯ç›¸å¯¹é‡è¦çš„ä¸€ç¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ç³»ç»Ÿé‡Œé¢æ–°å¢ä¸€å—ç¡¬ç›˜ï¼Œåº”è¯¥æœ‰å“ªäº›åŠ¨ä½œéœ€è¦åšï¼Ÿ å¯¹ç£ç›˜è¿›è¡Œåˆ†åŒºï¼Œä»¥æ–°å»ºå¯ç”¨çš„åˆ†åŒº å¯¹è¯¥åˆ†åŒºè¿›è¡Œæ ¼å¼åŒ–ï¼Œä»¥åˆ›å»ºç³»ç»Ÿå¯ç”¨çš„æ–‡ä»¶ç³»ç»Ÿ è‹¥æƒ³è¦ä»”ç»†ä¸€ç‚¹ï¼Œåˆ™å¯å¯¹åˆšæ‰æ–°å»ºå¥½çš„æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œæ ¡éªŒ åœ¨Linuxç³»ç»Ÿä¸Šï¼Œéœ€è¦åˆ›å»ºæŒ‚è½½ç‚¹ï¼ˆä¹Ÿå³æ˜¯ç›®å½•ï¼‰ï¼Œå¹¶å°†å®ƒæŒ‚è½½ä¸Šæ¥ ç£ç›˜åˆ†åŒºï¼šfdiskè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œè¿›å…¥ç£ç›˜åˆ†åŒºæ“ä½œï¼š fdisk /dev/hdc(ç£ç›˜å) æ¥ä¸‹æ¥å°±æ˜¯æŒ‰ç…§æç¤ºæ–°å¢æˆ–è€…åˆ é™¤åˆ†åŒºäº†ã€‚ ç£ç›˜æ ¼å¼åŒ–ï¼šmkfsåˆ†åŒºå®Œæ¯•ä¹‹åå°±è¦è¿›è¡Œæ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–éå¸¸ç®€å•ï¼Œä½¿ç”¨mkfsï¼ˆmake file systemï¼‰å³å¯ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š mkfs [-t æ–‡ä»¶ç³»ç»Ÿæ ¼å¼] ç£ç›˜è®¾å¤‡çš„æ–‡ä»¶å -tåçš„æ–‡ä»¶ç³»ç»Ÿæ ¼å¼å°±æ˜¯è®©ä½ æŒ‡å®šå°†æ–‡ä»¶ç³»ç»Ÿæ ¼å¼åŒ–æˆå“ªç§æ–‡ä»¶ç³»ç»Ÿã€‚å¦‚ext2ã€ext3ã€vfatç­‰ã€‚ ç£ç›˜æ£€éªŒï¼šfsckå½“ç³»ç»Ÿè¿è¡Œå‡ºç°é—®é¢˜å¯¼è‡´æ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿé”™ä¹±ï¼Œæ­¤æ—¶å°±éœ€è¦ç£ç›˜çš„æ£€éªŒã€‚å‘½ä»¤å¦‚ä¸‹ï¼š fsck [-t æ–‡ä»¶ç³»ç»Ÿ] [-ACay] è®¾å¤‡åç§° é€šå¸¸åªæœ‰rootç”¨æˆ·ï¼Œè€Œä¸”åœ¨æ–‡ä»¶ç³»ç»Ÿæœ‰é—®é¢˜çš„æ—¶å€™æ‰èƒ½è¿›è¡Œè¿™ä¸ªæ“ä½œï¼Œå› ä¸ºåœ¨æ­£å¸¸æƒ…å†µä¸‹ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ä¼šå¯¹ç³»ç»Ÿä¼¤å®³å¾ˆå¤§ã€‚ æ­¤å¤–ï¼Œfsckåœ¨æ‰«æçš„æ—¶å€™ï¼Œæœ‰é—®é¢˜çš„æ•°æ®ä¼šè¢«æ”¾åœ¨lostï¼‹foundè¿™ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚æ‰€ä»¥æ­£å¸¸æƒ…å†µä¸‹è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æ˜¯ä¸åº”è¯¥æœ‰æ•°æ®çš„ã€‚ ç£ç›˜æŒ‚è½½ä¸å¸è½½ï¼šmountï¼Œumountåœ¨æŒ‚è½½å‰éœ€è¦ç¡®å®šä¸‹é¢å‡ ä»¶äº‹ï¼š å•ä¸€æ–‡ä»¶ç³»ç»Ÿä¸åº”è¯¥è¢«é‡å¤æŒ‚è½½åœ¨ä¸åŒçš„æŒ‚è½½ç‚¹ï¼ˆç›®å½•ï¼‰ä¸­ å•ä¸€ç›®å½•ä¸åº”è¯¥é‡å¤æŒ‚è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿ ä½œä¸ºæŒ‚è½½å¸¦ä½ çš„ç›®å½•ç†è®ºä¸Šåº”è¯¥éƒ½æ˜¯ç©ºç›®å½• å…·ä½“å‘½ä»¤å¦‚ä¸‹ æŒ‚è½½ï¼š mount [-t æ–‡ä»¶ç³»ç»Ÿ] [-L æ–‡ä»¶ç³»ç»Ÿçš„å·æ ‡åç§°] [-o é¢å¤–é€‰é¡¹] [-n] è®¾å¤‡æ–‡ä»¶å æŒ‚è½½ç‚¹ å¸è½½ umount [-fn] è®¾å¤‡æ–‡ä»¶åæˆ–æŒ‚è½½ç‚¹ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_Linuxæ–‡ä»¶ä¸ç›®å½•ç®¡ç†å¤§å…¨è§£]]></title>
    <url>%2F2018%2F03%2F25%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_Linux%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E7%AE%A1%E7%90%86%E5%A4%A7%E5%85%A8%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨ä½¿ç”¨Linuxçš„è¿‡ç¨‹ä¸­ï¼Œæœ€å¤šçš„å‘½ä»¤è«è¿‡äºåœ¨æ“ä½œæ–‡ä»¶ä¸ç›®å½•ï¼Œæ‰€ä»¥é€šè¿‡æœ¬æ–‡ï¼Œèƒ½è®©ä½ å¤§æ¦‚ç‡ç†Ÿæ‚‰æ‰€æœ‰å…³äºæ–‡ä»¶ä¸ç›®å½•çš„å‘½ä»¤ä¸çŸ¥è¯†ï¼Œä½†æ˜¯å‚æ•°æ–¹é¢å°±éœ€è¦è‡ªå·±å»æŸ¥è¯¢äº†ã€‚ ç›®å½•ä¸è·¯å¾„ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„ ç»å¯¹è·¯å¾„ï¼šè·¯å¾„çš„å†™æ³•ä¸€å®šç”±æ ¹ç›®å½•/å†™èµ·ã€‚ ç›¸å¯¹è·¯å¾„ï¼šè·¯å¾„çš„å†™æ³•æ˜¯ç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•å†™çš„ã€‚ ç›®å½•çš„ç›¸å…³æ“ä½œ ç‰¹æ®Šç›®å½•åˆ—è¡¨ . ï¼šå½“å‰ç›®å½• .. ï¼šä¸Šå±‚ç›®å½• - ï¼šå‰ä¸€ä¸ªå·¥ä½œç›®å½• ~ ï¼šç™»é™†ç”¨æˆ·çš„ä¸»æ–‡ä»¶å¤¹ ~account ï¼šè¿™ä¸ªç”¨æˆ·çš„ä¸»æ–‡ä»¶å¤¹ ï¼ˆaccountæ˜¯ä¸ªè´¦å·åç§°ï¼‰ å¸¸è§ç›®å½•å¤„ç†çš„å‘½ä»¤ cdï¼šåˆ‡æ¢ç›®å½• pwdï¼šæ˜¾ç¤ºå½“å‰ç›®å½• mkdirï¼šæ–°å»ºä¸€ä¸ªæ–°çš„ç›®å½• rmdirï¼šåˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•ï¼Œåˆ é™¤éç©ºç›®å½•éœ€è¦ä½¿ç”¨rm -r å¥½ä¹ æƒ¯ï¼šç»å¸¸åˆ©ç”¨Tabé”®å¿«é€Ÿå®Œæ•´åœ°è¾“å…¥ç›®å½•æˆ–å‘½ä»¤ ç¯å¢ƒå˜é‡PATH å½“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼šls ï¼alçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šæŒ‰ç…§PATHè®¾ç½®çš„è·¯å¾„ï¼Œå»è¿™äº›è·¯å¾„ä¸­å¯»æ‰¾lsè¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œã€‚å¦‚æœPATHè·¯å¾„ä¸­æœ‰å¤šä¸ªlsæ–‡ä»¶ï¼Œé‚£ä¹ˆå…ˆæ‰¾åˆ°çš„é‚£ä¸ªlsæ–‡ä»¶è¢«æ‰§è¡Œã€‚ 1234// æŸ¥çœ‹PATHecho $PATH// åœ¨PATHä¸­æ·»åŠ è·¯å¾„/demoPATH="$PATH":/demo å¯¹äºPATHæˆ‘ä»¬æœ‰å‡ ç‚¹éœ€è¦æ¸…æ¥šï¼š ä¸åŒèº«ä»½ç”¨æˆ·é»˜è®¤çš„PATHä¸åŒï¼Œé»˜è®¤èƒ½å¤Ÿéšæ„æ‰§è¡Œçš„å‘½ä»¤ä¹Ÿä¸åŒï¼Œå·®å¼‚è¾ƒå¤§çš„åœ°æ–¹åœ¨äº/sbinå’Œ/usr/sbinã€‚ PATHæ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬ç”¨æˆ·è¿˜æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹PATHæ¥æ‰§è¡ŒæŸäº›ä½äº/sbinæˆ–/usr/sbinä¸‹çš„å‘½ä»¤æ¥æŸ¥è¯¢ã€‚ ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ç›´æ¥æŒ‡å®šæŸä¸ªå‘½ä»¤çš„æ–‡ä»¶åæ¥æ‰§è¡Œã€‚ å‘½ä»¤åº”è¯¥è¦æ”¾åœ¨æ­£ç¡®çš„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œæ‰ä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚ æœ¬ç›®å½•ï¼ˆ.ï¼‰æœ€å¥½ä¸è¦æ”¾åˆ°PATHå½“ä¸­ï¼Œå› ä¸ºæœ¬ç›®å½•ä¼šå˜åŒ–ã€‚ æ–‡ä»¶å’Œç›®å½•ç®¡ç†åœ¨æ–‡ä»¶ä¸ç›®å½•çš„ç®¡ç†ä¸Šï¼Œä¸å¤–ä¹â€œæ˜¾ç¤ºå±æ€§â€ã€â€œå¤åˆ¶â€ã€â€œåˆ é™¤æ–‡ä»¶â€ã€â€œç§»åŠ¨ç›®å½•æˆ–æ–‡ä»¶â€ç­‰ã€‚ä¸‹é¢è¿™è¿™ç§ç®¡ç†åŠ¨ä½œçš„å…·ä½“æŒ‡ä»¤ï¼š æ˜¾ç¤ºå±æ€§ ls å¤åˆ¶ cp åˆ é™¤ rm ç§»åŠ¨(é‡å‘½å) mv è¿™äº›æŒ‡ä»¤çš„å…·ä½“å‚æ•°ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤Ÿé€šè¿‡man infoå»ç†Ÿæ‚‰ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å»å–å¾—è·¯å¾„çš„æ–‡ä»¶åä¸ç›®å½•åç§°ï¼š1234// å–å¾—æ–‡ä»¶åç§°basename /etc/sysconfig/network// å–å¾—æ–‡ä»¶ç›®å½•dirname /etc/sysconfig/network æ–‡ä»¶å†…å®¹æŸ¥é˜…ä¸»è¦æœ‰ä¸‹é¢ä¸€äº›å‘½ä»¤ï¼š å‘½ä»¤ ä½œç”¨ cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ tac ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡ºtacæ˜¯catçš„åˆ°å†™å½¢å¼ nl æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºç¬¦å· more ä¸€é¡µä¸€é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ less ä¸moreç±»ä¼¼ï¼Œä½†æ˜¯æ¯”moreæ›´å¥½çš„æ˜¯ï¼Œå®ƒå¯ä»¥å¾€å‰ç¿»é¡µ head åªçœ‹å¤´å‡ è¡Œ tail åªçœ‹å°¾å‡ è¡Œ od ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ–‡ä»¶å†…å®¹ æ–‡ä»¶ä¸ç›®å½•çš„é»˜è®¤æƒé™å’Œéšè—æƒé™é™¤äº†åŸºæœ¬çš„rwxæƒé™ä¹‹å¤–ï¼ŒLinuxçš„ext2/ext3æ–‡ä»¶ç³»ç»Ÿä¸‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®ç³»ç»Ÿéšè—å±æ€§ï¼Œå®ƒå¯ä»¥ç”¨chattræ¥è®¾ç½®ï¼Œç”¨lsattræ¥æŸ¥çœ‹ã€‚æœ€é‡è¦çš„å±æ€§å°±æ˜¯å¯ä»¥è®¾ç½®æ–‡ä»¶/ç›®å½•ä¸ºä¸å¯ä¿®æ”¹ï¼Œè¿™å¯ä»¥è®©æ–‡ä»¶æ‰€æœ‰è€…éƒ½ä¸èƒ½è¿›è¡Œä¿®æ”¹ï¼Œè¿™å¯¹äºå®‰å…¨æ€§æ–¹é¢æ˜¯éå¸¸é‡è¦çš„ã€‚ æ–‡ä»¶çš„é»˜è®¤æƒé™ï¼šumaskumaskæŒ‡å®šäº†ç›®å‰ç”¨æˆ·åœ¨æ–°å»ºæ–‡ä»¶æˆ–ç›®å½•æ—¶å€™çš„æƒé™é»˜è®¤å€¼ã€‚ æŒ‡å®šäº†ä»¥ä¸‹é¢çš„æ–¹å¼æ¥æŒ‡å®šï¼š1234567[root@VM_0_9_centos ~]# umask0022 // ä¸ä¸€èˆ¬æƒé™æœ‰å…³çš„æ˜¯åé¢æ˜¯ä¸‰ä¸ªæ•°å­—(è¡¨ç¤ºä¸æ‹¥æœ‰è¯¥æ•°å€¼çš„æƒé™ï¼Œæ­¤ä¾‹å°±è¡¨ç¤ºgroupä¸æ‹¥æœ‰wï¼Œothersä¸æ‹¥æœ‰w)[root@VM_0_9_centos ~]# umask -Su=rwx,g=rx,o=rx// è®¾ç½®é»˜è®¤æƒé™umask 002 åœ¨é»˜è®¤æƒé™çš„å±æ€§ä¸Šï¼Œç›®å½•ä¸æ–‡ä»¶æ˜¯ä¸ä¸€æ ·çš„ï¼Œxæƒé™å¯¹äºç›®å½•æ˜¯éå¸¸é‡è¦çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æ–‡ä»¶çš„åˆ›å»ºåˆ™ä¸åº”è¯¥æ‹¥æœ‰æ‰§è¡Œæƒé™ã€‚æ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹ï¼š è‹¥ç”¨æˆ·åˆ›å»ºâ€œæ–‡ä»¶â€åˆ™é»˜è®¤æ²¡æœ‰å¯æ‰§è¡Œæƒé™ï¼Œé»˜è®¤æƒé™ä¸º666ï¼Œå³-rw-rw-rw- è‹¥ç”¨æˆ·åˆ›å»ºâ€œç›®å½•â€åˆ™é»˜è®¤æ‹¥æœ‰å¯æ‰§è¡Œæƒé™ï¼Œé»˜è®¤æƒé™ä¸º777ï¼Œå³drwxrwxrwx æ–‡ä»¶éšè—å±æ€§chattrï¼Œlsattr chattr è®¾ç½®æ–‡ä»¶çš„éšè—å±æ€§ æ³¨æ„å‚æ•°aï¼ˆæ–‡ä»¶åªèƒ½å¢åŠ æ•°æ®ï¼Œä¸èƒ½åˆ é™¤ä¹Ÿä¸èƒ½ä¿®æ”¹æ•°æ®ï¼‰å’Œi(ä¸èƒ½ åˆ é™¤ï¼Œä¿®æ”¹) lsattr æ˜¾ç¤ºæ–‡ä»¶éšè—å±æ€§ æ–‡ä»¶çš„ç‰¹æ®Šæƒé™SUID,SGID,SBIT SUID(u+s,å¦‚xä¸ºç©ºï¼Œåˆ™å‡ºç°å¤§S)ï¼Œé™åˆ¶ä¸åŠŸèƒ½å¦‚ä¸‹ï¼š SUIDæƒé™ä»…å¯¹äºŒè¿›åˆ¶ç¨‹åºæœ‰æ•ˆ æ‰§è¡Œè€…å¯¹äºè¯¥ç¨‹åºéœ€è¦xçš„å¯æ‰§è¡Œæƒé™ æœ¬æƒé™ä»…åœ¨æ‰§è¡Œè¯¥ç¨‹åºçš„è¿‡ç¨‹ä¸­æœ‰æ•ˆ æ‰§è¡Œè€…å°†å…·æœ‰è¯¥ç¨‹åºæ‰€æœ‰è€…çš„æƒé™ SGIDï¼ˆg+s,å¦‚xä¸ºç©ºï¼Œåˆ™å‡ºç°å¤§Sï¼‰ï¼Œå¯¹äºæ–‡ä»¶åŠŸèƒ½ä¸SUIDç±»ä¼¼ï¼Œä½†æ˜¯å¯¹äºç›®å½•æœ‰å¦‚ä¸‹åŠŸèƒ½ï¼š ç”¨æˆ·è‹¥å¯¹äºæ­¤ç›®å½•å…·æœ‰rä¸xçš„æƒé™æ—¶ï¼Œè¯¥ç”¨æˆ·èƒ½å¤Ÿè¿›å…¥æ­¤ç›®å½• ç”¨æˆ·åœ¨æ­¤ç›®å½•ä¸‹å¾—æœ‰æ•ˆç”¨æˆ·ç»„å°†å˜æˆè¯¥ç›®å½•çš„ç”¨æˆ·ç»„ è‹¥ç”¨æˆ·åœ¨æ­¤ç›®å½•ä¸‹å…·æœ‰wçš„æƒé™ï¼ˆå¯ä»¥æ–°å»ºæ–‡ä»¶ï¼‰ï¼Œåˆ™ç”¨æˆ·æ‰€åˆ›å»ºçš„æ–°æ–‡ä»¶çš„ç”¨æˆ·ç»„ä¸æ­¤ç›®å½•çš„ç”¨æˆ·ç»„ç›¸åŒ SBITï¼ˆo+t,å¦‚xä¸ºç©ºï¼Œåˆ™å‡ºç°å¤§Tï¼‰ï¼Œç›®å‰åªé’ˆå¯¹ç›®å½•æœ‰æ•ˆï¼Œå®ƒçš„ä½œç”¨å¦‚ä¸‹ï¼š å½“ç”¨æˆ·å¯¹äºæ­¤ç›®å½•å…·æœ‰wï¼Œxæƒé™ï¼Œå³å…·æœ‰å†™å…¥çš„æƒé™æ—¶ï¼Œå½“ç”¨æˆ·åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œä»…æœ‰è‡ªå·±ä¸rootæ‰æœ‰æƒåˆ©åˆ é™¤è¯¥æ–‡ä»¶ã€‚ æŸ¥çœ‹æ–‡ä»¶ç±»å‹ï¼šfileå¦‚æœæƒ³çŸ¥é“æŸä¸ªæ–‡ä»¶çš„åŸºæœ¬æ•°æ®ï¼Œå°±å¯ä»¥ä½¿ç”¨fileè¿™ä¸ªå‘½ä»¤æŸ¥çœ‹ã€‚ æ–‡ä»¶ä¸å‘½ä»¤çš„æŸ¥è¯¢è„šæœ¬æ–‡ä»¶åçš„æŸ¥è¯¢å¦‚æœä½ æƒ³çŸ¥é“ç±»ä¼¼lsè¿™ç§å‘½ä»¤çš„è„šæœ¬æ”¾åœ¨å“ªé‡Œï¼Œå°±é€šè¿‡whichæˆ–typeæ¥æ‰¾å¯»ã€‚ whichå‘½ä»¤æ˜¯æ ¹æ®PATHè¿™ä¸ªç¯å¢ƒå˜é‡æ‰€è§„èŒƒçš„è·¯å¾„å»æŸ¥è¯¢â€œæ‰§è¡Œæ–‡ä»¶â€çš„æ–‡ä»¶åã€‚ æ–‡ä»¶åçš„æŸ¥æ‰¾é€šå¸¸findä¸å¾ˆå¸¸ç”¨ï¼Œå› ä¸ºé€Ÿåº¦æ…¢ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯å…ˆä½¿ç”¨whereisæˆ–è€…æ˜¯locateæ¥æ£€æŸ¥ï¼Œå¦‚æœçœŸçš„æ‰¾ä¸åˆ°äº†ï¼Œæ‰ä»¥findæ¥æŸ¥æ‰¾ï¼Œå› ä¸ºwhereisä¸loacateæ˜¯åˆ©ç”¨æ•°æ®åº“æ¥æŸ¥è¯¢æ•°æ®çš„ï¼Œè€Œfindæ˜¯ç›´æ¥æŸ¥æ‰¾ç¡¬ç›˜çš„ã€‚ whereisï¼šå¯»æ‰¾ç‰¹å®šæ–‡ä»¶ locateï¼šæ ¹æ®æ–‡ä»¶çš„éƒ¨åˆ†åç§°æŸ¥æ‰¾ï¼Œç”±äºæ˜¯æŸ¥è¯¢æ•°æ®åº“çš„ï¼Œè€Œæ•°æ®åº“æ˜¯å½“æ™šæ›´æ–°ï¼Œæ‰€ä»¥ä½ æ–°å»ºæ–‡ä»¶æ˜¯æŸ¥æ‰¾ä¸åˆ°çš„ï¼Œå¯ä»¥åˆ©ç”¨updatedbæ‰‹åŠ¨æ›´æ–°ï¼Œä½†æ˜¯è¾ƒæ…¢ã€‚ findï¼šå‚æ•°å¾ˆå¤šï¼Œè‡ªå·±ç”¨çš„æ—¶å€™éœ€è¦ä½¿ç”¨man pageè‡ªè¡Œäº†è§£ã€‚ æ–‡ä»¶ä¸æ–‡ä»¶ç³»ç»Ÿçš„å‹ç¼©ä¸æ‰“åŒ…å¸¸è§çš„å‹ç¼©å‘½ä»¤ä¸åŒçš„å‹ç¼©æ‰“åŒ…æŠ€æœ¯ï¼Œå¯¹åº”ç€ä¸åŒçš„è§£å‹ç¼©æ‹†åŒ…æŠ€æœ¯ï¼Œæ‰€ä»¥åœ¨Linuxä¸­ç”¨åç¼€åæ¥åˆ†è¾¨å‹ç¼©æ‰“åŒ…æŠ€æœ¯ï¼Œå¦‚ä¸‹è¡¨ï¼š åç¼€ å‹ç¼©æ‰“åŒ…æŠ€æœ¯ *.Z compressç¨‹åºå‹ç¼© *.gz gzipç¨‹åºå‹ç¼© *.bz2 bzip2ç¨‹åºå‹ç¼© *.tar tarç¨‹åºæ‰“åŒ…ï¼Œæœªå‹ç¼© *.tar.gz tarç¨‹åºæ‰“åŒ…,gzipç¨‹åºå‹ç¼© *.tar.bz2 tarç¨‹åºæ‰“åŒ…,bzip2ç¨‹åºå‹ç¼© ç”±äºcompresså·²ç»ä¸å†æµè¡Œï¼Œæ‰€æœ‰æˆ‘ä»¬ä¸»è¦è®²è§£gzipå’Œgzip2: gzip,zcatï¼ˆç”¨æ¥æ›¿ä»£compressï¼‰ ç›®å‰gzipå¯ä»¥è§£å¼€compressã€zipä¸gzipç­‰è½¯ä»¶å‹ç¼©çš„æ–‡ä»¶ã€‚å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„æ¡ˆä¾‹ï¼š 123456// 1. å‹ç¼©æ–‡ä»¶gzip -v æ–‡ä»¶å // å‚æ•°væ˜¾ç¤ºå‹ç¼©æ¯”// 2. æŸ¥çœ‹å‹ç¼©æ–‡ä»¶å†…å®¹zcat å‹ç¼©æ–‡ä»¶// 3. è§£å‹ç¼©gzip -d å‹ç¼©æ–‡ä»¶å // å‚æ•°dè¡¨ç¤ºè§£å‹ç¼© bzip2,bzcatï¼ˆç”¨æ¥æ›¿ä»£gzipï¼‰ ä½¿ç”¨æ–¹æ³•ä¸gzipåŸºæœ¬ç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚ æ‰“åŒ…å‘½ä»¤åœ¨å‹ç¼©æ–‡ä»¶å¤¹ä¹‹å‰éœ€è¦æ‰“åŒ…ï¼Œç„¶åæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°å¤§åé¼é¼çš„tarï¼Œä¸‹é¢é€šè¿‡å‘½ä»¤æ¥å…·ä½“ä»‹ç»ä»–çš„ä½¿ç”¨ï¼š123456// 1. å‹ç¼©ï¼Œå‚æ•°çš„å«ä¹‰è‡ªå·±å»ç”¨man pageæŸ¥çœ‹tar -jcv -f filename.tar.bz2 // è¦è¢«å‹ç¼©çš„æ–‡ä»¶æˆ–ç›®å½•åç§°ï¼Œtarå¹¶ä¸ä¼šä¸»åŠ¨äº§ç”Ÿåˆ›å»ºçš„æ–‡ä»¶å// 2. æŸ¥è¯¢tar -jtv -f filename.tar.bz2// 3. è§£å‹ç¼©tar -jxv -f filename.tar.bz2 -C æ¬²è§£å‹ç¼©çš„ç›®å½•ï¼ˆå¦‚ï¼š/tmpï¼‰ å¯¹äºåªæ˜¯æ‰“åŒ…æ²¡æœ‰å‹ç¼©çš„æ–‡ä»¶å«åštarfile å¯¹äºæ‰“åŒ…äº†å¹¶ä¸”å‹ç¼©çš„æ–‡ä»¶å«åštarball å®Œæ•´å¤‡ä»½å·¥å…· dump å¤‡ä»½ restore æ¢å¤ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_Linuxçš„æ–‡ä»¶æƒé™ä¸ç›®å½•é…ç½®]]></title>
    <url>%2F2018%2F03%2F22%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_Linux%E7%9A%84%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E4%B8%8E%E7%9B%AE%E5%BD%95%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šäº†è§£å¥½æ–‡ä»¶æƒé™å’Œç›®å½•çš„å…·ä½“å«ä¹‰æ‰èƒ½æ›´å¥½çš„æ“ä½œLinuxï¼Œæ‰€ä»¥ç†è§£å¥½æ–‡ä»¶æƒé™ä¸ç›®å½•é…ç½®æ‰è‡³å…³é‡è¦ã€‚ ç”¨æˆ·ä¸ç”¨æˆ·ç»„ç”¨æˆ·ï¼ˆUserï¼‰ ç”¨æˆ·å¯ä»¥éšæ„æ”¹å˜è‡ªå·±æ‰€æ‹¥æœ‰çš„æ–‡ä»¶ rootç”¨æˆ·å°±æ˜¯æœ€å¤§çš„å¤§ä½¬ï¼Œå¯ä»¥å¹²ä»»ä½•äº‹ã€‚ ç”¨æˆ·ç»„ï¼ˆGroupï¼‰ åŒä¸€ä¸ªç”¨æˆ·ç»„çš„ç”¨æˆ·å¯ä»¥è®¿é—®è¯¥ç”¨æˆ·ç»„çš„æ–‡ä»¶ æ¯ä¸ªè´¦å·å¯ä»¥åŠ å…¥å¤šä¸ªç”¨æˆ·ç»„ åœ¨åŒä¸€ä¸ªç”¨æˆ·ç»„çš„æ–‡ä»¶ä¹Ÿå¯ä»¥è®¾ç½®ä¸åŒçš„æƒé™ï¼Œå¯ä»¥ä¸è®©æœ¬ç»„ç”¨æˆ·æŸ¥çœ‹ å…¶ä»–äººï¼ˆOthersï¼‰é™¤äº†æ–‡ä»¶ç”¨æˆ·ã€åŒç»„ç”¨æˆ·ä»¥å¤–çš„äººå°±æ˜¯å…¶ä»–äººã€‚ Linuxç”¨æˆ·èº«ä»½ä¸ç”¨æˆ·ç»„è®°å½•çš„æ–‡ä»¶ ç³»ç»Ÿä¸Šçš„è´¦å·ä¸ä¸€èˆ¬èº«ä»½ç”¨æˆ·ä»¥åŠrootçš„ç›¸å…³ä¿¡æ¯éƒ½è®°å½•åœ¨/etc/passwdæ–‡ä»¶ä¸­ ä¸ªäººçš„å¯†ç éƒ½è®°å½•åœ¨/etc/shadowæ–‡ä»¶ä¸­ Linuxæ‰€æœ‰çš„ç»„åéƒ½è®°å½•åœ¨/etc/groupæ–‡ä»¶ä¸­ æ–‡ä»¶æƒé™æ¦‚å¿µLinuxæ–‡ä»¶å±æ€§æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹æ–‡ä»¶å±æ€§ï¼š ls -al // åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶è¯¦ç»†çš„æƒé™å’Œå±æ€§ï¼ˆåŒ…å«éšè—æ–‡ä»¶ï¼‰ å¦‚ä¸‹ï¼š123456æ€»ç”¨é‡ 92drwxr-xr-x. 22 root root 4096 3æœˆ 17 12:33 .dr-xr-xr-x. 20 root root 4096 3æœˆ 22 09:14 ..drwxr-xr-x. 2 root root 4096 11æœˆ 5 2016 admdrwxr-xr-x 2 root root 4096 3æœˆ 12 10:27 alldata... çœç•¥ è§£é‡Šä¸€ä¸‹ä¸Šé¢7åˆ—çš„æ„æ€ï¼š ç¬¬ä¸€åˆ—ï¼šæ–‡ä»¶çš„ç±»å‹ä¸æƒé™ ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨è¿™ä¸ªæ–‡ä»¶æ˜¯â€œç›®å½•ã€æ–‡ä»¶æˆ–é“¾æ¥æ–‡ä»¶ç­‰â€ã€‚ dï¼šç›®å½•æ–‡ä»¶ -ï¼šæ™®é€šæ–‡ä»¶ lï¼šé“¾æ¥æ–‡ä»¶ bï¼šç”¨äºå­˜å‚¨æ•°æ®çš„è®¾å¤‡æ–‡ä»¶ cï¼šç”¨äºä¼ è¾“æ•°æ®çš„è®¾å¤‡æ–‡ä»¶ï¼šé¼ æ ‡ã€é”®ç›˜ æ¥ä¸‹æ¥éƒ½æ˜¯ä¸‰ä¸ªå­—ç¬¦ä¸ºä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºæ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ã€åŒç»„ç”¨æˆ·çš„æƒé™ã€å…¶ä»–ç”¨æˆ·çš„æƒé™ï¼Œè€Œä¸”rï¼ˆè¯»ï¼‰ã€wï¼ˆå†™ï¼‰ã€xï¼ˆæ‰§è¡Œï¼‰çš„é¡ºåºæ˜¯å›ºå®šä¸å˜çš„ã€‚ ç¬¬äºŒåˆ—ï¼šæœ‰å¤šå°‘æ–‡ä»¶åè¿æ¥åˆ°æ­¤èŠ‚ç‚¹ ç¬¬ä¸‰åˆ—ï¼šè¿™ä¸ªæ–‡ä»¶ï¼ˆæˆ–ç›®å½•ï¼‰çš„æ‰€æœ‰è€…è´¦å· ç¬¬å››åˆ—ï¼šè¿™ä¸ªæ–‡ä»¶æ‰€å±çš„ç”¨æˆ·ç»„ ç¬¬äº”åˆ—ï¼šè¿™ä¸ªæ–‡ä»¶çš„å¤§å°ï¼Œå•ä½æ˜¯B ç¬¬å…­åˆ—ï¼šè¿™ä¸ªæ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸæˆ–ä¿®æ”¹æ—¥æœŸ ç¬¬ä¸ƒåˆ—ï¼šæ–‡ä»¶å æ”¹å˜æ–‡ä»¶å±æ€§ä¸æƒé™çš„å‘½ä»¤ chgrpï¼šæ”¹å˜æ–‡ä»¶æ‰€å±çš„ç”¨æˆ·ç»„ ï¼ˆæ³¨æ„-R å‚æ•°ï¼Œé€’å½’æ›´æ”¹ï¼‰ chownï¼šæ”¹å˜æ–‡ä»¶æ‰€æœ‰è€… ï¼ˆæ³¨æ„-R å‚æ•°ï¼Œé€’å½’æ›´æ”¹ï¼‰ chmodï¼šæ”¹å˜æ–‡ä»¶çš„æƒé™ ï¼ˆæ³¨æ„-R å‚æ•°ï¼Œé€’å½’æ›´æ”¹ï¼‰ æ”¹å˜æ–‡ä»¶çš„æƒé™æœ‰ä¸¤ç§åŠæ³•ï¼Œåˆ†åˆ«æ˜¯ï¼šç”¨æ•°å­—è¿›è¡Œæƒé™çš„ä¿®æ”¹ã€ç”¨ç¬¦å·è¿›è¡Œæƒé™çš„ä¿®æ”¹ã€‚ ç”¨æ•°å­—è¿›è¡Œæƒé™çš„ä¿®æ”¹ï¼šæƒé™æœ‰9ä¸ªå­—æ¯ç»„æˆï¼Œå¹¶ä¸”æ¯ä¸‰ä¸ªä¸ºä¸€ç»„ï¼Œåˆ†åˆ«è¡¨ç¤ºï¼šæ–‡ä»¶ä¸»çš„æƒé™ã€åŒç»„ç”¨æˆ·çš„æƒé™ã€å…¶ä»–äººçš„æƒé™ã€‚åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œrï¼4ã€wï¼2ã€xï¼1ï¼Œå°†æ¯ä¸€ç»„çš„ä¸‰ä¸ªå€¼åŠ èµ·æ¥ï¼Œç»„æˆä¸€ä¸ªä¸‰ä½æ•°å³å¯ã€‚å®ä¾‹å¦‚ä¸‹ï¼š 1chmod -R 754 æ–‡ä»¶æˆ–ç›®å½• ç”¨ç¬¦å·è¿›è¡Œæƒé™çš„ä¿®æ”¹ï¼šæˆ‘ä»¬é€šè¿‡u(user)ï¼Œg(group)ï¼Œo(others)ï¼Œa(all)æ¥è¡¨ç¤ºèº«ä»½æƒé™ï¼Œé€šè¿‡rï¼ˆè¯»ï¼‰,wï¼ˆå†™ï¼‰,xï¼ˆæ‰§è¡Œï¼‰æ¥è¡¨ç¤ºè¯»å†™çš„æƒé™ï¼Œé€šè¿‡+ï¼ˆåŠ å…¥ï¼‰ï¼Œ-ï¼ˆé™¤å»ï¼‰ï¼Œ=ï¼ˆè®¾ç½®ï¼‰æ¥è¡¨ç¤ºä¿®æ”¹æ“ä½œï¼Œå®ä¾‹å¦‚ä¸‹ï¼š 1chmod u/g/o/a +/-/= r/w/x æ–‡ä»¶/ç›®å½• ç›®å½•ä¸æ–‡ä»¶çš„æƒé™æ„ä¹‰ æƒé™å¯¹æ–‡ä»¶çš„é‡è¦æ€§ï¼š rï¼šå¯è¯»å–æ­¤æ–‡ä»¶çš„å®é™…å†…å®¹ã€‚ wï¼šå¯ä»¥ç¼–è¾‘ã€æ–°å¢æˆ–è€…ä¿®æ”¹è¯¥æ–‡ä»¶çš„å†…å®¹ï¼ˆå•ä¸å«åˆ é™¤è¯¥æ–‡ä»¶ï¼‰ xï¼šè¯¥æ–‡ä»¶å…·æœ‰å¯ä»¥è¢«ç³»ç»Ÿæ‰§è¡Œçš„æƒé™ã€‚ æƒé™å¯¹ç›®å½•çš„é‡è¦æ€§ rï¼šè¡¨ç¤ºå…·æœ‰è¯»å–ç›®å½•ç»“æ„çš„æƒé™ï¼Œå³å¯ä»¥æ‰§è¡Œlså‘½ä»¤ wï¼šè¡¨ç¤ºå…·æœ‰æ›´æ”¹è¯¥ç›®å½•ç»“æ„åˆ—è¡¨çš„æƒé™ï¼Œæ¯”å¦‚æ–°å»ºæ–°çš„æ–‡ä»¶ä¸ç›®å½•ã€åˆ é™¤å·²ç»å­˜åœ¨çš„æ–‡ä»¶ä¸ç›®å½•ã€å°†å·²å­˜åœ¨æˆ–ç›®å½•è¿›è¡Œé‡å‘½åã€è½¬ç§»è¯¥ç›®å½•å†…çš„æ–‡ä»¶å’Œç›®å½•ä½ç½® xï¼šè¡¨ç¤ºç”¨æˆ·èƒ½å¦è¿›å…¥è¯¥ç›®å½•ï¼Œå³å¯ä»¥ä½¿ç”¨cdè¿›å…¥è¯¥ç›®å½• æ–‡ä»¶ç§ç±»ä¸æ‰©å±•å æ–‡ä»¶ç§ç±» æ™®é€šæ–‡ä»¶ çº¯æ–‡æœ¬æ–‡ä»¶ï¼ˆASCIIï¼‰ï¼Œå¯ä»¥ç”¨catå‘½ä»¤è¯»å– äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆbinaryï¼‰ï¼ŒLinuxä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ æ•°æ®æ ¼å¼æ–‡ä»¶ï¼ˆdataï¼‰ï¼Œå°±æ˜¯ç¨‹åºè¿è¡Œæ—¶ä¼šè¢«è¯»å–çš„å…·æœ‰ç‰¹å®šæ ¼å¼çš„æ–‡ä»¶ï¼Œå¦‚é…ç½®æ–‡ä»¶ï¼Œéœ€è¦ç”¨lastå‘½ä»¤å»è¯»å–ï¼Œç”¨catè¯»å–ä¼šä¹±ç  ç›®å½• è¿æ¥æ–‡ä»¶ï¼Œç±»ä¼¼Windowsä¸‹çš„å¿«æ·æ–¹å¼ è®¾å¤‡ä¸è®¾å¤‡æ–‡ä»¶ å—è®¾å¤‡æ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨æ•°æ®çš„è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚ï¼šç¡¬ç›˜ã€è½¯ç›˜ å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œç”¨äºæ•°æ®ä¼ è¾“çš„è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚ï¼šé”®ç›˜ã€é¼ æ ‡ å¥—æ¥å­—ï¼Œè¿™ä¸ªè®¾å¤‡æ–‡ä»¶åœ¨/var/runä¸­ ç®¡é“ï¼Œç”¨äºè§£å†³å¤šä¸ªç¨‹åºåŒæ—¶è®¿é—®ä¸€ä¸ªæ–‡ä»¶æ‰€é€ æˆçš„é”™è¯¯é—®é¢˜ æ–‡ä»¶æ‰©å±•å Linuxå¹¶æ²¡æœ‰æ‰©å±•åï¼Œä¸€ä¸ªLinuxçš„æ–‡ä»¶æ˜¯å¦å¯ä»¥æ‰§è¡Œï¼Œå–å†³äºè¿™ä¸ªæ–‡ä»¶çš„å±æ€§ä¸­æ˜¯å¦æœ‰xè¿™ä¸ªæƒé™ï¼ˆä¹Ÿè¦çœŸçš„å¯ä»¥æ‰§è¡Œï¼‰ã€‚ ä½†æ˜¯ä¸ºäº†å¢å¼ºæ–‡ä»¶çš„å¯è¯»æ€§ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç»™æ–‡ä»¶å¢åŠ äº†â€œæ‰©å±•åâ€œã€‚å¦‚ä¸‹é¢å‡ ç§ï¼ˆç­‰ï¼‰ï¼š ï¼Š.shè¡¨ç¤ºè„šæœ¬æˆ–æ‰¹å¤„ç†æ–‡ä»¶ ï¼ŠZã€ï¼Š.tarã€ï¼Š.tar.gzã€ï¼Š.zipã€ï¼Š.tgzä»–ä»¬éƒ½æ˜¯å‹ç¼©æ–‡ä»¶ æ³¨æ„ï¼šä»ç½‘ä¸Šä¸‹è½½çš„æ–‡ä»¶çš„æƒé™æ˜¯æœ‰å¯èƒ½å‘ç”Ÿæ”¹å˜çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä¸‹è½½çš„æ–‡ä»¶æ— æ³•è¿è¡Œæ—¶æŸ¥çœ‹ä¸€ä¸‹å®ƒçš„æƒé™æ˜¯å¦æœ‰xã€‚ Linuxå¯¹æ–‡ä»¶çš„é™åˆ¶ï¼šLinxué»˜è®¤é‡‡ç”¨Ext2/Ext3æ–‡ä»¶ç³»ç»Ÿï¼Œå¯¹æ–‡ä»¶åçš„é•¿åº¦é™åˆ¶ä¸ºï¼Œå•ä¸ªæ–‡ä»¶åæˆ–ç›®å½•åæœ€å¤§é•¿åº¦255ä¸ªå­—ç¬¦ï¼›å®Œæ•´çš„æ–‡ä»¶æˆ–ç›®å½•åæœ€å¤§é•¿åº¦ä¸º4096ä¸ªå­—ç¬¦ã€‚ Linuxç›®å½•é…ç½®Linuxç›®å½•é…ç½®æ ‡å‡†FHSä¸€å¥æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨çš„é¢‘ç¹ä¸å¦ä¸æ˜¯å¦å…è®¸ç”¨æˆ·éšæ„æ”¹åŠ¨ï¼Œè€Œå°†ç›®å½•å®šä¹‰ä¸ºå››ä¸­äº¤äº’çš„å½¢æ€ï¼Œå¦‚ä¸‹ï¼š / å¯åˆ†äº«çš„(shareable) ä¸å¯åˆ†äº«çš„(unshareable) ä¸å˜çš„(static) /usr (è½¯ä»¶æ”¾ç½®å¤„) /etc (é…ç½®æ–‡ä»¶) ä¸å˜çš„(static) /opt (ç¬¬ä¸‰æ–¹è½¯ä»¶) /boot(å¼€æœºä¸å†…æ ¸æ–‡ä»¶) å¯å˜åŠ¨çš„(variable) /var/mail (ç”¨æˆ·é‚®ç®±ä¿¡ä»¶) /var/run (ç¨‹åºç›¸å…³) å¯å˜åŠ¨çš„(variable) /var/spool/news (æ–°é—»ç»„) /var/lock (ç¨‹åºç›¸å…³) è§£é‡Šä¸€ä¸‹å››ä¸ªç±»å‹çš„æ„æ€ï¼š å¯åˆ†äº«çš„ï¼šå¯ä»¥åˆ†äº«ç»™ç½‘ç»œä¸Šçš„å…¶ä»–ä¸»æœºæŒ‚è½½ä½¿ç”¨ ä¸å¯åˆ†äº«çš„ï¼šåªä¸è‡ªå·±çš„æœºå™¨æœ‰å…³ï¼Œæ‰€ä»¥è‡ªç„¶å°±ä¸èƒ½åˆ†äº«ç»™å…¶ä»–ä¸»æœº ä¸å˜çš„ï¼šä¸ç®¡ä»€ä¹ˆæ ·çš„distributionsï¼Œè¿™äº›æ•°æ®åŸºæœ¬ä¸å‘ç”Ÿå˜åŒ–ã€‚ä¸€èˆ¬è¿™äº›ç›®å½•ä¸­å­˜æ”¾å‡½æ•°åº“ã€ç³»ç»Ÿé…ç½®æ–‡ä»¶ç­‰ å¯å˜çš„ï¼šç»å¸¸æ”¹å˜çš„æ•°æ®ï¼Œå¦‚ç™»å½•æ–‡ä»¶ã€æ–°é—»ç»„ç­‰ æ ¹ç›®å½•æ˜¯æ•´ä¸ªç³»ç»Ÿæœ€é‡è¦çš„ç›®å½•ï¼Œå…¶ä»–æ‰€æœ‰çš„å­ç›®å½•éƒ½æ˜¯ç”±æ ¹ç›®å½•è¡ç”Ÿè€Œæ¥çš„ï¼ŒåŒæ—¶æ ¹ç›®å½•ä¹Ÿä¸å¼€æœºã€è¿˜åŸã€ç³»ç»Ÿä¿®å¤ç­‰æ“ä½œæœ‰å…³ã€‚ FHSå»ºè®®ï¼šæ ¹ç›®å½•è¦è¶³å¤Ÿçš„å°ï¼Œè€Œä¸”åº”ç”¨ç¨‹åºä¸è¦å’Œæ ¹ç›®å½•æ”¾åœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­ã€‚åŒæ—¶ï¼ŒFHSå»ºè®®æ ¹ç›®å½•ä¸‹åº”è¯¥è¦æœ‰è¿™äº›ç›®å½•ï¼š ç›®å½• åº”æ”¾ç½®æ–‡ä»¶å†…å®¹ /bin åœ¨binç›®å½•ä¸‹çš„å‘½ä»¤å¯ä»¥è¢«æ‰€æœ‰è´¦å·ä½¿ç”¨ï¼Œä¸€èˆ¬çš„å‘½ä»¤æ˜¯ï¼šcatã€chmodã€chownã€dateã€mvã€mkdirã€cpã€bash /boot ä¸»è¦æ”¾ç½®å¼€æœºä¼šä½¿ç”¨åˆ°çš„æ–‡ä»¶ /dev ä»»ä½•è®¾å¤‡éƒ½æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨è¿™ä¸ªç›®å½•å½“ä¸­ /etc ç»Ÿä¸»è¦çš„é…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸­ã€‚è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶å±æ€§æ˜¯å¯ä»¥ç»™ä¸€èˆ¬ç”¨æˆ·æŸ¥é˜…çš„ï¼Œä½†åªæœ‰rootæ‰å¯ä»¥ä¿®æ”¹ï¼ŒFHSå»ºè®®ï¼šè¿™ä¸ªç›®å½•ä¸‹ä¸è¦æ”¾ç½®å¯æ‰§è¡Œæ–‡ä»¶ /home ç³»ç»Ÿé»˜è®¤çš„ç”¨æˆ·ä¸»æ–‡ä»¶å¤¹,ï½è¡¨ç¤ºå½“å‰ç™»é™†ç”¨æˆ·çš„ä¸»æ–‡ä»¶å¤¹ ï¼Œï½rexè¡¨ç¤ºæŒ‡å®šç”¨æˆ·çš„ä¸»æ–‡ä»¶å¤¹ /lib å­˜æ”¾å¼€æœºæ—¶ç”¨åˆ°çš„åº“å‡½æ•°åŠ/binã€/sbinç›®å½•ä¸‹çš„å‘½ä»¤ä¼šä½¿ç”¨åˆ°çš„åº“å‡½æ•° /media æ”¾ç½®å¯åˆ é™¤çš„è®¾å¤‡æ–‡ä»¶ã€‚å¦‚ï¼šè½¯ç›˜ã€å…‰ç›˜ /mnt å¦‚æœè¦ä¸´æ—¶æŒ‚è½½ä¸€äº›é¢å¤–çš„è®¾å¤‡å°±æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ /opt æ”¾ç½®ç¬¬ä¸‰æ–¹è½¯ä»¶çš„ç›®å½• /root ç³»ç»Ÿç®¡ç†å‘˜çš„ä¸»æ–‡ä»¶å¤¹ /sbin æ”¾ç½®å¼€æœºè¿‡ç¨‹ä¸­éœ€è¦çš„ï¼ŒåŒ…æ‹¬å¼€æœºã€ä¿®å¤ã€è¿˜åŸç³»ç»Ÿæ‰€éœ€è¦çš„å‘½ä»¤ /srv æ˜¯serviceçš„ç¼©å†™ï¼Œå­˜æ”¾ç½‘ç»œæœåŠ¡æ‰€éœ€çš„ä¸€äº›æ•°æ® /tmp ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç¨‹åºæš‚æ—¶å­˜æ”¾æ•°æ®çš„åœ°æ–¹ã€‚ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼Œæ‰€ä»¥è¦å®šæ—¶æ¸…ç†ä¸€ä¸‹ã€‚FHSå»ºè®®distributionså¼€æœºæ—¶è¦å°†è¿™ä¸ªç›®å½•æ¸…ç©º å…¶ä»–é‡è¦çš„ç›®å½•ï¼š ç›®å½• åº”æ”¾ç½®æ–‡ä»¶å†…å®¹ /lost+found ä½¿ç”¨ext2/ext3æ–‡ä»¶ç³»ç»Ÿæ‰ä¼šäº§ç”Ÿçš„ä¸€ä¸ªç›®å½•ã€‚å½“æ–‡ä»¶ç³»ç»Ÿå‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¸€äº›ä¸¢å¤±çš„ç‰‡æ®µå°±ä¼šæ”¾åœ¨è¿™ä¸ªç›®å½•ä¸­ /proc æ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯å®ƒçš„æ•°æ®éƒ½æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œä¸å ç”¨ç¡¬ç›˜ç©ºé—´ /sys ä¹Ÿæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œè®°å½•å†…æ ¸ç›¸å…³ä¿¡æ¯ å¼€æœºçš„æ—¶å€™åªæœ‰æ ¹ç›®å½•è¢«æŒ‚è½½äº†ï¼Œå…¶ä»–çš„ç›®å½•æ‰€åœ¨çš„åˆ†åŒºéƒ½æ˜¯åœ¨ç³»ç»Ÿå¯åŠ¨å®Œæˆä¹‹åæ‰è¢«æŒ‚è½½çš„ã€‚å› æ­¤ä¸å¼€æœºè¿‡ç¨‹æœ‰å…³çš„ç›®å½•å°±å¿…é¡»è¦å’Œæ ¹ç›®å½•æ”¾åœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­ã€‚å¿…é¡»ä¸æ ¹ç›®å½•æ”¾åœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­çš„ç›®å½•æœ‰ä¸‹é¢è¿™äº›ç›®å½•ï¼š /etcï¼šé…ç½®æ–‡ä»¶ /binï¼šé‡è¦çš„æ‰§è¡Œæ–‡ä»¶ /devï¼šæ‰€éœ€è¦çš„è®¾å¤‡æ–‡ä»¶ /libï¼šæ‰§è¡Œæ–‡ä»¶æ‰€éœ€è¦çš„åº“å‡½æ•°ä¸å†…æ ¸æ‰€éœ€è¦çš„æ¨¡å— /sbinï¼šé‡è¦çš„ç³»ç»Ÿæ‰§è¡Œæ–‡ä»¶ /usrç›®å½•ï¼šï¼UNIX Software Resourceï¼Œæ˜¯æ“ä½œç³»ç»Ÿå…³é”®èµ„æºæ”¾ç½®çš„ç›®å½•ã€‚FHSå»ºè®®ï¼šæ‰€æœ‰è½¯ä»¶å¼€å‘è€…éƒ½åº”å°†æ•°æ®æ”¾ç½®åœ¨è¿™ä¸ªç›®å½•çš„å­ç›®å½•ä¸‹ï¼Œè€Œä¸è¦è‡ªè¡Œåˆ›å»ºç‹¬ç«‹çš„ç›®å½•ã€‚è¿™ä¸ªç›®å½•å°±ç›¸å½“äºWindowsä¸‹çš„c:\program files /varç›®å½•ï¼š/usræ”¾ç½®å®‰è£…ç¨‹åºæ—¶æ‰€éœ€è¦çš„è¾ƒå¤§å®¹é‡çš„æ–‡ä»¶ï¼Œè€Œ/varä¸‹å­˜æ”¾ç³»ç»Ÿè¿è¡Œåæ‰ä¼šæ¸æ¸å ç”¨ç¡¬ç›˜çš„ç›®å½•ã€‚å¦‚ï¼šç¼“å­˜ã€æ—¥å¿—ã€Mysqlæ•°æ®åº“çš„æ–‡ä»¶ç­‰ã€‚ ç›®å½•æ ‘åœ¨Linuxé‡Œé¢ï¼Œæ‰€æœ‰çš„æ–‡ä»¶ä¸ç›®å½•éƒ½æ˜¯ç”±æ ¹ç›®å½•å¼€å§‹çš„ï¼Œé‚£æ˜¯æ‰€æœ‰ç›®å½•ä¸æ–‡ä»¶çš„æºå¤´ï¼Œç„¶ååœ¨ä¸€ä¸ªä¸€ä¸ªåˆ†æ”¯ä¸‹æ¥ï¼Œæˆ‘ä»¬ç§°è¿™ç§ç›®å½•é…ç½®ä¸ºç›®å½•æ ‘ã€‚ ç›®å½•æ ‘ä¸»è¦æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š ç›®å½•æ ‘çš„èµ·å§‹ç‚¹ä¸ºæ ¹ç›®å½•ï¼ˆ/ï¼Œrootï¼‰ æ¯ä¸ªç›®å½•ä¸åªèƒ½ä½¿ç”¨æœ¬åœ°ç«¯çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç½‘ç»œä¸Šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚å¯ä»¥åˆ©ç”¨NFSæœåŠ¡å™¨æŒ‚è½½æŸç‰¹å®šç›®å½•ç­‰ ç±³æ ¼æ–‡ä»¶åœ¨æ­¤ç›®å½•æ ‘çš„æ–‡ä»¶åï¼ˆåŒ…å«å®Œæ•´è·¯å¾„ï¼‰éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_Linuxå‘½ä»¤ä½¿ç”¨ä¸æŸ¥è¯¢]]></title>
    <url>%2F2018%2F03%2F21%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_Linux%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%E4%B8%8E%E6%9F%A5%E8%AF%A2%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä»æµ…å…¥æ·±ï¼Œæˆ‘ä»¬ä¹Ÿä»åŸºç¡€å‘½ä»¤å¼€å§‹ã€‚å­¦ä¼šåŸºæœ¬å‘½ä»¤çš„ä½¿ç”¨ï¼Œå­¦ä¼šæ€ä¹ˆå»æŸ¥å‘½ä»¤çš„ä½¿ç”¨ï¼Œæœ€åå­¦ä¼šä¸€ä¸¢ä¸¢ç»´æŠ¤ï¼ˆå¼€å…³æœºï¼‰ã€‚ åŸºç¡€å‘½ä»¤å¼€å§‹æ‰§è¡Œå‘½ä»¤é¦–å…ˆæˆ‘ä»¬è¦äº†è§£å‘½ä»¤çš„æ ¼å¼ï¼š command(å‘½ä»¤æˆ–å¯æ‰§è¡Œæ–‡ä»¶) -options parameter1(å‚æ•°1) parameter2(å‚æ•°2) å¦‚æœå‘½ä»¤å¤ªé•¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åæ–œæ (\)æ¥è½¬ä¹‰[enterç¬¦å·]ï¼Œæ³¨æ„åæ–œæ å¿…é¡»ç«‹åˆ»æ¥ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰èƒ½è½¬ä¹‰ã€‚ åœ¨linuxä¸‹é¢æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚ åŸºç¡€å‘½ä»¤çš„æ“ä½œ æ˜¾ç¤ºæ—¥æœŸä¸æ—¶é—´çš„å‘½ä»¤ï¼šdate æ˜¾ç¤ºæ—¥å†çš„å‘½ä»¤ï¼šcal ç®€å•å¥½ç”¨çš„è®¡ç®—å™¨ï¼šbcï¼Œä½¿ç”¨quitåœæ­¢ é‡è¦çš„çƒ­é”® TabæŒ‰é”®ï¼šå…·æœ‰å‘½ä»¤è¡¥å…¨ï¼Œæ–‡ä»¶è¡¥é½çš„åŠŸèƒ½ ctrl + cï¼šå¯ä»¥è®©ç¨‹åºç«‹åˆ»åœä¸‹æ¥ ctrl + dï¼šé€šå¸¸ä»£ç é”®ç›˜è¾“å…¥ç»“æŸï¼Œç›¸å½“äºexit åœ¨çº¿æ±‚åŠ©man page ä¸info pageman pagemanå…¶å®æ˜¯manualï¼ˆæ“ä½œè¯´æ˜ï¼‰çš„ç®€å†™ï¼Œåªè¦é€šè¿‡ï¼ˆman + å‘½ä»¤ï¼‰ å°±ä¼šæœ‰è¯¦ç»†çš„è¯´æ˜å‡ºç°ã€‚ å¦‚ man dateå¯ä»¥å¾—åˆ°ä¸‹é¢çš„æ–‡æœ¬ï¼š123456789101112131415161718192021222324252627282930313233DATE(1) User Commands DATE(1)NAME date - print or set the system date and timeSYNOPSIS date [OPTION]... [+FORMAT] date [-u|--utc|--universal] [MMDDhhmm[[CC]YY][.ss]]DESCRIPTION Display the current time in the given FORMAT, or set the system date. Mandatory arguments to long options are mandatory for short options too. -d, --date=STRING display time described by STRING, not &apos;now&apos; ...çœç•¥å…¶ä»–å‚æ•°ENVIRONMENTEXAMPLESDATE STRINGAUTHOR Written by David MacKenzie.COPYRIGHTSEE ALSOGNU coreutils 8.22 November 2016 DATE(1) æˆ‘ä»¬é¦–å…ˆçœ‹åˆ°çš„æ˜¯â€œDATE(1)â€ï¼Œè¿™ä¸ª(1)æ˜¯æœ‰ç‰¹æ®Šå«ä¹‰çš„ï¼Œå¦‚ä¸‹è¡¨ï¼š ä»£å· ä»£è¡¨å†…å®¹ 1 ç”¨æˆ·åœ¨shellç¯å¢ƒä¸­å¯ä»¥æ“ä½œçš„å‘½ä»¤æˆ–å¯æ‰§è¡Œçš„æ–‡ä»¶ 2 ç³»ç»Ÿå†…æ ¸å¯è°ƒç”¨çš„å‡½æ•°ä¸å·¥å…·ç­‰ 3 ä¸€äº›å¸¸ç”¨çš„å‡½æ•°ä¸å‡½æ•°åº“ï¼Œå¤§éƒ¨åˆ†ä¸ºCçš„å‡½æ•°åº“ 4 è®¾å¤‡æ–‡ä»¶çš„è¯´æ˜ï¼Œé€šå¸¸åœ¨/devçš„æ–‡ä»¶ 5 é…ç½®æ–‡ä»¶æˆ–è€…æŸäº›æ–‡ä»¶çš„æ ¼å¼ 6 æ¸¸æˆ 7 æƒ¯ä¾‹ä¸åè®®ç­‰ï¼Œä¾‹å¦‚Linuxæ–‡ä»¶ç³»ç»Ÿï¼Œç½‘ç»œåè®®ã€ASCII codeç­‰è¯´æ˜ 8 ç³»ç»Ÿç®¡ç†å‘˜ä¸å¯ç”¨çš„ç®¡ç†å‘½ä»¤ 9 è·Ÿkernelæœ‰å…³çš„æ–‡ä»¶ æˆ‘ä»¬è¦ç‰¹åˆ«æ³¨æ„1ï¼Œ5ï¼Œ8è¿™ä¸‰ä¸ªå·ç ï¼Œå°½é‡èƒŒä¸‹æ¥ã€‚ åœ¨ä¸Šé¢çš„man pageä¸­ï¼Œä»¥NAMEä½œä¸ºå¼€å§‹ä»‹ç»ï¼Œæœ€åè¿˜æœ‰ä¸ªSEE ALSOæ¥ä½œä¸ºç»“æŸã€‚åŸºæœ¬ä¸Šï¼Œman pageå¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š ä»£å· å†…å®¹è¯´æ˜ NAME ç®€çŸ­çš„å‘½ä»¤ã€æ•°æ®åç§°è¯´æ˜ SYNOPSIS ç®€çŸ­çš„å‘½ä»¤æ‰§è¡Œè¯­æ³•ï¼ˆsyntaxï¼‰ç®€ä»‹ DESCRIPTION è¾ƒä¸ºå®Œæ•´çš„è¯´æ˜ï¼Œæœ€å¥½ä»”ç»†çœ‹çœ‹ OPTIONS é’ˆå¯¹SYNNPSISéƒ¨åˆ†ä¸­ï¼Œæœ‰åˆ—ä¸¾çš„æ‰€æœ‰å¯ç”¨çš„é€‰é¡¹è¯´æ˜ COMMANDS åœ¨è¿™ä¸ªç¨‹åºåœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥åœ¨æ­¤ç¨‹åºä¸­æ‰§è¡Œçš„å‘½ä»¤ FILES è¿™ä¸ªç¨‹åºæˆ–æ•°æ®æ‰€ä½¿ç”¨æˆ–å‚è€ƒæˆ–è¿æ¥åˆ°çš„æŸäº›æ–‡ä»¶ SEE ALSO è¿™ä¸ªå‘½ä»¤æˆ–æ•°æ®æœ‰ç›¸å…³çš„å…¶ä»–è¯´æ˜ EXAMPLES ä¸€äº›å¯ä»¥å‚è€ƒçš„èŒƒä¾‹ BUGS æ˜¯å¦æœ‰ç›¸å…³çš„é”™è¯¯ é€šå¸¸åœ¨æŸ¥è¯¢æŸäº›æ•°æ®æ˜¯è¿™æ ·æ¥æŸ¥é˜…çš„ï¼š å…ˆçœ‹NAMEçš„é¡¹ç›®ï¼Œç•¥å¾®çœ‹ä¸€ä¸‹æ•°æ®çš„æ„æ€ å†ä»”ç»†çœ‹ä¸€ä¸‹DESCRIPTIONï¼Œè¿™ä¸ªéƒ¨åˆ†ä¼šæåˆ°å¾ˆå¤šç›¸å…³çš„èµ„æ–™å’Œç”¨æ³•ã€‚ å¦‚æœè¿™ä¸ªå‘½ä»¤å…¶å®å¾ˆç†Ÿæ‚‰äº†ï¼Œé‚£ä¹ˆä¸»è¦å°±æ˜¯æŸ¥è¯¢OPTIONSçš„éƒ¨åˆ†äº†ã€‚ æœ€åä¼šçœ‹ä¸€ä¸‹å’Œè¿™ä¸ªèµ„æ–™æœ‰å…³çš„è¿˜æœ‰å“ªäº›ä¸œè¥¿å¯ä»¥ä½¿ç”¨ã€‚ æŸäº›è¯´æ˜å†…å®¹è¿˜ä¼šåˆ—ä¸¾æœ‰å…³çš„æ–‡ä»¶ï¼ˆFILESï¼‰æ¥æä¾›æˆ‘ä»¬å‚è€ƒã€‚ man page å¸¸ç”¨çš„æŒ‰é”®ï¼š æŒ‰é”® è¿›è¡Œå·¥ä½œ ç©ºæ ¼é”® å‘ä¸‹ç¿»ä¸€é¡µ Page Down å‘ä¸‹ç¿»ä¸€é¡µ Page Up å‘ä¸Šç¿»ä¸€é¡µ Home å»åˆ°ç¬¬ä¸€é¡µ End åœ¨å»åˆ°æœ€åä¸€é¡µ /string å‘ä¸‹æŸ¥è¯¢stringå­—ç¬¦ä¸² ?string å‘ä¸ŠæŸ¥è¯¢stringå­—ç¬¦ä¸² n,N åˆ©ç”¨/æˆ–ï¼Ÿæ¥æŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå¯ä»¥ç”¨næ¥ç»§ç»­æŸ¥è¯¢ä¸‹ä¸€ä¸ªæŸ¥è¯¢ï¼Œå¯ä»¥åˆ©ç”¨Næ¥è¿›è¡Œåå‘æŸ¥è¯¢ q ç»“æŸè¿™æ¬¡man page ä¸‹é¢è¿˜æœ‰ä¸¤ä¸ªmançš„ç”¨é€”ï¼š man -f command ï¼ˆ= whatisï¼‰ï¼šæŸ¥è¯¢å’Œcommandè¿™ä¸ªå‘½ä»¤æœ‰å…³çš„è¯´æ˜æ–‡ä»¶ man -k dataï¼ˆ= aproposï¼‰ï¼šæŸ¥è¯¢åŒ…å«dataè¿™ä¸ªæ•°æ®æœ‰å…³çš„æ–‡ä»¶ info pageinfoä¸mançš„ç”¨é€”å·®ä¸å¤šï¼Œéƒ½æ˜¯ç”¨æ¥æŸ¥è¯¢å‘½ä»¤çš„ç”¨æ³•æˆ–è€…æ–‡ä»¶çš„æ ¼å¼ï¼Œä½†æ˜¯ä¸man pageä¸€ä¸‹å­è¾“å‡ºä¸€å †ä¿¡æ¯ä¸åŒçš„æ˜¯ï¼Œinfo pageåˆ™æ˜¯å°†æ–‡ä»¶æ•°æ®æ‹†æˆä¸€ä¸ªä¸€ä¸ªæ®µè½ï¼Œæ¯ä¸ªæ®µè½ç”¨è‡ªå·±çš„é¡µé¢æ¥æ’°å†™ï¼Œå¹¶ä¸”åœ¨å„ä¸ªé¡µé¢ä¸­è¿˜æœ‰ç±»ä¼¼ç½‘é¡µçš„â€œè¶…é“¾æ¥â€æ¥è°ƒåˆ°å„ä¸ªé¡µé¢ï¼Œæ¯ä¸ªç‹¬ç«‹çš„é¡µé¢ä¹Ÿè¢«ç§°ä¸ºä¸€ä¸ªèŠ‚ç‚¹ï¼ˆnodeï¼‰ã€‚ è¿™é‡Œè¿™é‡Œä¸å¤šè¯´ï¼Œæœ‰å…´è¶£è€…å¯ä»¥è‡ªå·±å»çœ‹çœ‹ä½¿ç”¨ã€‚ å…¶ä»–æœ‰ç”¨çš„æ–‡ä»¶ä¸€èˆ¬è€Œè¨€ï¼Œå‘½ä»¤æˆ–è€…è½¯ä»¶å¼€å‘è€…éƒ½ä¼šå°†è‡ªå·±çš„å‘½ä»¤æˆ–è€…æ˜¯è½¯ä»¶çš„è¯´æ˜åˆ¶ä½œæˆâ€œåœ¨çº¿å¸®åŠ©æ–‡ä»¶â€ï¼Œä½†æ˜¯æ¯•ç«Ÿä¸æ˜¯ä»€ä¹ˆéƒ½éœ€è¦åšæˆåœ¨çº¿å¸®åŠ©æ–‡ä»¶çš„ï¼Œåœ¨/usr/share/docä¸­æˆ‘ä»¬ä¼šå‘ç°ä¼šæœ‰å¾ˆå¤šè¯´æ˜æ–‡ä»¶æ–‡æ¡£ï¼Œè¿™äº›ä¼šå‘Šè¯‰æˆ‘ä»¬æ€ä¹ˆåšï¼Œä»¥åŠä¸€äº›ç›¸å…³çš„åŸç†ã€‚ å¼€æœºä¸å…³æœºå¼€æœºä¸ç™»å½•ä¸€èˆ¬æœåŠ¡å™¨éƒ½ä¸æ€ä¹ˆé‡å¯ï¼Œæˆ‘ä»¬åœ¨ç™»å½•æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨sshæ¥ç™»å½•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š ssh ip åœ¨è¿™ä¸ªå‘½ä»¤ä¹‹åä¼šè¦æ±‚ä¸ä½ è¾“å…¥å¯†ç å³å¯æˆåŠŸã€‚ å…³æœºåœ¨Linuxä¸­ï¼Œç”±äºæ¯ä¸ªç¨‹åºéƒ½æ˜¯åœ¨åå°è¿è¡Œçš„ï¼Œå› æ­¤ä½ çœ‹ä¸åˆ°å±å¹•åé¢å…¶å®å¯èƒ½æœ‰å¾ˆå¤šäººåŒæ—¶åœ¨ä½ çš„ä¸»æœºä¸Šé¢å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½éšæ„å…³æœºã€‚æ‰€ä»¥åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¦å…³æœºæ—¶è¦æ³¨æ„ä¸‹é¢å‡ ä»¶äº‹ï¼š æŸ¥çœ‹ç³»ç»Ÿçš„ä½¿ç”¨çŠ¶æ€ å¦‚æœè¦çœ‹ç›®å‰æœ‰è°åœ¨çº¿ï¼šæ‰§è¡Œâ€œwhoâ€è¿™ä¸ªå‘½ä»¤ å¦‚æœè¦çœ‹ç½‘ç»œçš„è”æœºçŠ¶æ€ï¼šæ‰§è¡Œâ€œnetstat -aâ€è¿™ä¸ªå‘½ä»¤ å¦‚æœè¦çœ‹åå°æ‰§è¡Œçš„ç¨‹åºï¼šæ‰§è¡Œâ€œps -auxâ€è¿™ä¸ªå‘½ä»¤ é€šçŸ¥åœ¨çº¿ç”¨æˆ·å…³æœºçš„æ—¶åˆ» æ­£ç¡®åœ°å…³æœºå‘½ä»¤ä½¿ç”¨ï¼šshutdownä¸reboot å°†æ•°æ®åŒæ­¥å†™å…¥ç¡¬ç›˜çš„å‘½ä»¤ï¼šsync æƒ¯ç”¨çš„å…³æœºå‘½ä»¤ï¼šshutdown é‡å¯ã€å…³æœºï¼šreboot,halt,poweroff æ€»ç»“è¿™ä¸€ç« æœ€ä¸ºåŸºç¡€ï¼Œç°å¸¸é‡è¦ï¼Œå°±åƒåœ°åŸºï¼Œåªæœ‰æœ‰äº†åœ°åŸºï¼Œæˆ‘ä»¬æ‰èƒ½å¥½å¥½é€ ä¸‹é¢çš„æˆ¿å­ã€‚ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_Linuxç£ç›˜åˆ†åŒº]]></title>
    <url>%2F2018%2F03%2F21%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_Linux%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šLinuxåœ¨æˆ‘å°è±¡ä¸­æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å®ƒæŠŠæ‰€æœ‰çš„ç¡¬ä»¶éƒ½å½“åšä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åè¿˜æ˜¯ä»¥/ä¸ºæ ¹èŠ‚ç‚¹çš„ç›®å½•æ ‘ï¼Œç®€æ´æ˜äº†ï¼Œç›¸ä¿¡å¤§å®¶ä¸€å®šä¼šçˆ±ä¸Šå®ƒçš„ã€‚å› ä¸ºæ¶‰åŠåˆ°æ–‡ä»¶çš„å­˜å‚¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é‡è§†ç£ç›˜åˆ†åŒºã€‚ ç¡¬ä»¶è®¾å¤‡åœ¨linuxä¸­çš„æ–‡ä»¶åLinuxä¸­æ¯ä¸€ä¸ªè®¾å¤‡éƒ½è¢«å½“æˆæ–‡ä»¶ï¼Œæ‰€æœ‰çš„è®¾å¤‡æ–‡ä»¶éƒ½åœ¨/devè¿™ä¸ªç›®å½•ä¸‹ã€‚ä¸‹é¢åˆ—å‡ºå‡ ä¸ªå¸¸è§è®¾å¤‡ä¸å…¶åœ¨Linuxå½“ä¸­çš„æ–‡ä»¶åï¼Œå¦‚ä¸‹è¡¨ï¼š è®¾å¤‡ è®¾å¤‡åœ¨Linuxå†…çš„æ–‡ä»¶å IDEç¡¬ç›˜ /dev/hd[a-d] SATA/USB/SCSIç¡¬ç›˜ /dev/sd[a-p] Uç›˜ /dev/sd[a-p]ï¼ˆä¸SATAç›¸åŒï¼‰ è½¯é©± /dev/fd[0ï¼1] æ‰“å°æœº 25é’ˆï¼š/dev/lp[0ï¼2] usbï¼š/dev/usb/lp[0-15] é¼ æ ‡ usb:/dev/usb/mouse[0ï¼15] ps2:/dev/psaux å½“å‰CD/DVD ROM /dev/cdrom å½“å‰é¼ æ ‡ /dev/mouse ç£å¸¦æœº IDE:/dev/ht0 SCSI:/dev/st0 ç¡¬ç›˜åˆ†åŒºç£ç›˜çš„æ–‡ä»¶å‘½åè§„åˆ™ç£ç›˜çš„æ¥å£æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯IDEæ¥å£ã€SATAæ¥å£ã€‚ç›®å‰ä¸»æµçš„æ¥å£æ˜¯SATAæ¥å£ã€‚ä½¿ç”¨IDEæ¥å£çš„è®¾å¤‡æˆ‘ä»¬ç§°ä¸ºIDEè®¾å¤‡ã€‚ IDEè®¾å¤‡ï¼šä¸€ä¸ªIDEæ¥å£å¯ä»¥è¿æ¥ä¸¤ä¸ªIDEè®¾å¤‡ï¼Œä¸»æœºä¸­ä¸€èˆ¬ç”¨ä¸¤ä¸ªIDEæ¥å£ï¼Œå› æ­¤æœ€å¤šå¯ä»¥è¿æ¥å››ä¸ªIDEè®¾å¤‡ã€‚è¿™ä¸¤ä¸ªIDEæ¥å£é€šå¸¸è¢«ç§°ä¸ºIDE1ã€IDE2ï¼Œè€Œæ¯ä¸ªIDEæ¥å£è¿æ¥çš„ä¸¤ä¸ªIDEè®¾å¤‡åˆè¢«åˆ†ä¸ºä¸»è®¾å¤‡å’Œä»è®¾å¤‡ã€‚è¿™å››ä¸ªIDEè®¾å¤‡çš„æ–‡ä»¶åå¦‚ä¸‹è¡¨ï¼š IDEæ¥å£ ä¸»è®¾å¤‡ ä»è®¾å¤‡ IDE1 /dev/hda /dev/hdb IDE2 /dev/hdc /dev/hdd SATAè®¾å¤‡ï¼šä»¥SATA/USB/SCSIä¸ºæ¥å£çš„ç£ç›˜ä½¿ç”¨çš„éƒ½æ˜¯SCSIæ¨¡å—æ¥é©±åŠ¨çš„ï¼Œå› æ­¤ä»–ä»¬çš„è®¾å¤‡æ–‡ä»¶åéƒ½æ˜¯/dev/sd[a-p]ã€‚ä½†æ˜¯ä¸IDEè®¾å¤‡ä¸åŒçš„æ˜¯ï¼Œä»–ä»¬çš„æ–‡ä»¶åæ²¡æœ‰ä¸€å®šçš„é¡ºåºï¼Œè°å…ˆæ’ä¸Šå»ï¼Œè°å°±æ˜¯aï¼Œä»¥æ­¤ç±»æ¨ã€‚ ç£ç›˜çš„ç»„æˆæ•´ä¸ªç£ç›˜çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºéå¸¸é‡è¦ï¼Œå› ä¸ºä»–è®°å½•äº†ä¸‹é¢çš„é‡è¦çš„ä¿¡æ¯ï¼š ä¸»å¼•å¯¼åˆ†åŒºMaster Boot Record,MBRï¼šå¯ä»¥å®‰è£…â€œå¼•å¯¼åŠ è½½ç¨‹åºâ€çš„åœ°æ–¹ã€‚æœ‰446bytesã€‚ åˆ†åŒºè¡¨ï¼šè®°å½•æ•´å—ç¡¬ç›˜çš„åˆ†åŒºçŠ¶å†µï¼Œæœ‰64bytesã€‚ ç£ç›˜åˆ†åŒºè¡¨å¯¹ç£ç›˜è¿›è¡Œåˆ†åŒºæ—¶ï¼Œé‡‡ç”¨æŸ±é¢ä½œä¸ºåŸºæœ¬å•ä½ã€‚åˆ†åŒºè¡¨æœ‰64bytesï¼Œè¢«åˆ†æˆå››ä¸ªåŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸè®°å½•å½“å‰ç£ç›˜çš„æ‰€æœ‰åˆ†åŒºçš„èµ·å§‹å’Œç»“æŸæŸ±é¢å·ã€‚ä¾‹å¦‚ï¼šä¸€å—IDEç¡¬ç›˜è¢«åˆ†æˆå››ä¸ªåŒºåŸŸï¼š P1ï¼š/dev/hda1 ï¼ŒP2ï¼š/dev/hda2 ï¼ŒP3ï¼š/dev/hda3 ï¼ŒP4ï¼š/dev/hda4ã€‚æ¯ä¸ªç£ç›˜çš„åˆ†åŒºè¡¨åªèƒ½è¢«åˆ†æˆå››ä¸ªåŒºåŸŸï¼Œè¿™å››ä¸ªåŒºåŸŸè¢«ç§°ä¸ºä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒºã€‚å½“ç³»ç»Ÿè¿›è¡Œæ•°æ®çš„è¯»å†™æ—¶ï¼Œä¸€å®šè¦å‚è€ƒåˆ†åŒºè¡¨æ‰èƒ½è¿›è¡Œã€‚ åˆ†åŒºçš„åŸå› ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ï¼ˆåˆ†åŒºä¸ä¼šå½±å“ï¼‰ï¼›æå‡ç³»ç»Ÿçš„æ€§èƒ½ï¼ˆåªåœ¨è‡ªå·±çš„åˆ†åŒºæŸ¥æ‰¾ï¼‰ã€‚ æ‰©å±•åˆ†åŒºä¸»åˆ†åŒºå’Œæ‰©å±•åˆ†åŒºéƒ½æ˜¯åˆ†åŒºè¡¨ä¸­çš„ä¸€æ¡è®°å½•ï¼Œä¸»åˆ†åŒºä¸­å­˜æ”¾é€šè¿‡ç›´æ¥ç´¢å¼•å°±èƒ½åˆ°è¾¾çš„åˆ†åŒºçš„å¼€å§‹å’Œç»“æŸçš„æŸ±é¢å·ï¼›è€Œæ‰©å±•åˆ†åŒºä¸­å­˜æ”¾çš„æ˜¯é€»è¾‘åˆ†åŒºè¡¨çš„å¼€å§‹å’Œç»“æŸæŸ±é¢å·ï¼Œè¿™å¼ é€»è¾‘åˆ†åŒºè¡¨ä¸­æ‰å­˜æ”¾åˆ†åŒºçš„å¼€å§‹å’Œç»“æŸæŸ±é¢å·ã€‚ ç”±äºä¸€å¼ åˆ†åŒºè¡¨åªèƒ½å­˜æ”¾å››æ¡è®°å½•ï¼Œä¹Ÿå°±æ˜¯å››ä¸ªåˆ†åŒºï¼Œå½“æˆ‘ä»¬æƒ³è¦å¤šä¸€äº›åˆ†åŒºçš„æ—¶å€™å°±å¿…é¡»è¦é€šè¿‡æ‰©å±•åˆ†åŒºæ¥å®ç°ã€‚ åˆ†åŒºè¡¨ä¸­çš„å››æ¡è®°å½•å¯¹åº”çš„è®¾å¤‡æ–‡ä»¶åæ˜¯ä¸ä¼šå˜çš„ã€‚å¦‚ä¸Šé¢çš„å››ä¸ªåå­—ï¼Œæ‰€ä»¥é€»è¾‘åˆ†åŒºçš„æ–‡ä»¶åä¸€å®šæ˜¯ä»5å¼€å§‹çš„ã€‚å¦‚ï¼š/dev/hda5ã€‚ æé†’ æ‰©å±•åˆ†åŒºæœ€å¤šåªèƒ½æœ‰1ä¸ªã€‚ Linuxä¸­ï¼ŒIDEç¡¬ç›˜æœ€å¤šæœ‰59ä¸ªé€»è¾‘åˆ†åŒºï¼Œ5å·ï¼63å·ï¼›SATAç¡¬ç›˜æœ€å¤šæœ‰11ä¸ªé€»è¾‘åˆ†åŒºï¼Œ5å·ï¼15å·ã€‚ åœ¨Windowsä¸­è‹¥Dã€Eç›˜éƒ½æ˜¯æ‰©å±•åˆ†åŒºä¸­çš„é€»è¾‘åˆ†åŒºï¼Œé‚£ä¹ˆä»–ä»¬å¯ä»¥æ•´åˆæˆä¸€ä¸ªåˆ†åŒºï¼›è‹¥ä¸¤ä¸ªç›˜ä¸€ä¸ªæ˜¯é€»è¾‘åˆ†åŒºï¼Œä¸€ä¸ªæ˜¯ä¸»åˆ†åŒºï¼Œé‚£ä»–ä»¬æ˜¯ä¸èƒ½åˆå¹¶çš„ã€‚ ä¸€å—ç¡¬ç›˜çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºè®°å½•äº†MBRå’Œåˆ†åŒºè¡¨ï¼Œéå¸¸çš„é‡è¦ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ‰‡åŒºåäº†ï¼Œé‚£ä¹ˆæ•´ä¸ªç¡¬ç›˜å°±æŠ¥åºŸäº†ã€‚ å¼€æœºæµç¨‹æ•´ä¸ªå¼€æœºæµç¨‹åˆ°æ“ä½œç³»ç»Ÿä¹‹å‰çš„åŠ¨ä½œåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š BIOSï¼šå¼€æœºä¸»åŠ¨æ‰§è¡Œçš„éŸ§ä½“ï¼Œä¼šè®¤è¯†ç¬¬ä¸€ä¸ªå¯å¼€æœºçš„å¯¹è±¡ã€‚ MBRï¼šç¬¬ä¸€ä¸ªå¯å¼€æœºè®¾å¤‡çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºçš„ä¸»å¼•å¯¼åˆ†åŒºå—ï¼Œå†…åŒ…å«å¼•å¯¼åŠ è½½ç¨‹åºã€‚ å¼•å¯¼åŠ è½½ç¨‹åºï¼šä¸€æ”¯å¯è¯»å–å†…æ ¸æ–‡ä»¶æ¥æ‰§è¡Œçš„è½¯ä»¶ã€‚ï¼ˆå¯å¤šä¸ªä¸åŒç³»ç»Ÿçš„åŠ è½½ç¨‹åºå¯¹åº”äº†ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼‰ å†…æ ¸æ–‡ä»¶ï¼šå¼€å§‹æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ã€‚ PSï¼šä¸ºä»€ä¹ˆå¦‚æœå®‰è£…å¤šé‡å¼•å¯¼ï¼Œæœ€å¥½å…ˆå®‰è£…Windowsåœ¨å®‰è£…Linuxï¼Ÿâ€”â€”å› ä¸ºLinuxåœ¨å®‰è£…çš„æ—¶å€™å¯ä»¥é€‰æ‹©å°†å¼•å¯¼åŠ è½½ç¨‹åºå®‰è£…åœ¨MBRæˆ–ä¸ªåˆ«åˆ†åŒºçš„å¯åŠ¨æ‰‡åŒºï¼Œè€Œä¸”åœ¨linnuxçš„loaderå¯ä»¥æ‰‹åŠ¨è®¾ç½®èœå•ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨Linuxçš„boot loaderé‡Œé¢åŠ å…¥Windowså¼€æœºçš„é€‰é¡¹ã€‚Windowsåœ¨å®‰è£…çš„æ—¶å€™ï¼Œå®ƒçš„å®‰è£…ç¨‹åºä¼šä¸»åŠ¨è¦†ç›–æ‰MBRä»¥åŠè‡ªå·±æ‰€åœ¨åˆ†åŒºçš„å¯åŠ¨æ‰‡åŒºï¼Œä½ æ²¡æœ‰é€‰æ‹©çš„æœºä¼šï¼Œè€Œä¸”æ²¡æœ‰è®©æˆ‘ä»¬é€‰æ‹©èœå•çš„åŠŸèƒ½ã€‚ æŒ‚è½½ç›®å½•æ ‘åœ¨Linuxä¸­ï¼Œæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿå‘ˆä¸€æ£µä»¥/ä¸ºæ ¹ç›®å½•çš„æ ‘ã€‚ æ–‡ä»¶ç³»ç»Ÿä¸ç›®å½•æ ‘çš„å…³ç³»ï¼ˆæŒ‚è½½ï¼‰æŒ‚è½½å°±æ˜¯æŠŠä¸€ä¸ªç›®å½•å½“ä½œç£ç›˜ä¸­æŸä¸€ä¸ªåˆ†åŒºçš„è¿›å…¥ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿›å…¥äº†è¿™ä¸ªç›®å½•ï¼Œå°±è¿›å…¥äº†è¿™ä¸ªç£ç›˜çš„è¿™ä¸ªåˆ†åŒºã€‚è¿™ä¸ªè¿›å…¥çš„ç›®å½•æˆ‘ä»¬å°±ç§°ä¸ºæŒ‚è½½ç‚¹ã€‚æ ¹ç›®å½•ä¸€å®šè¦æŒ‚è½½åˆ°æŸä¸ªåˆ†åŒºã€‚ å¦‚ä½•å¯»æ‰¾æŒ‚è½½ç‚¹ï¼ˆåˆ¤æ–­æŸä¸ªåœ¨æ–‡ä»¶åœ¨å“ªä¸ªåˆ†åŒºä¸‹ï¼‰ï¼Ÿç­”ï¼šé€šè¿‡åå‘è¿½è¸ªå³å¯ï¼Œå½“æˆ‘ä»¬æƒ³è¦çŸ¥é“/home/rex/testæ–‡ä»¶åœ¨é‚£ä¸ªåˆ†åŒºæ—¶ï¼Œåªè¦é€†å‘å¯»æ‰¾ç¬¬ä¸€ä¸ªæŒ‚è½½ç‚¹å°±æ˜¯è¿™ä¸ªæ–‡ä»¶çš„æŒ‚è½½ç‚¹ã€‚ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š df /home/rex/test æ€»ç»“äº†è§£åˆ†åŒºï¼Œäº†è§£å¼€æœºæµç¨‹ï¼Œäº†è§£æŒ‚è½½ï¼Œokï¼Œå°±è¿™äº›ï¼ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_åˆè¯†Linux]]></title>
    <url>%2F2018%2F03%2F20%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E5%88%9D%E8%AF%86Linux%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šäº†è§£Linuxï¼Œå­¦ä¹ Linuxï¼Œæ·±å…¥Linuxã€‚ Linuxæ˜¯ä»€ä¹ˆLinuxå°±æ˜¯ä¸€å¥—æ“ä½œç³»ç»Ÿï¼Œå®ƒçš„å†…æ ¸æ˜¯Linux Torvaldsåœ¨1991å¹´å¼€å‘å‡ºæ¥çš„ã€‚ Linuxçš„å†…æ ¸ç‰ˆæœ¬çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š122.6.18-92.e15ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.é‡Šå‡ºç‰ˆæœ¬-ä¿®æ”¹ç‰ˆæœ¬ ä¸»ã€æ¬¡ç‰ˆæœ¬ä¸ºå¥‡æ•°ï¼šå¼€å‘ä¸­ç‰ˆæœ¬ï¼Œå¦‚2.5.xxï¼Œè¿™ç§ç‰ˆæœ¬ä»…å†…æ ¸å¼€å‘å·¥ç¨‹å¸ˆä½¿ç”¨ã€‚ ä¸»ã€æ¬¡ç‰ˆæœ¬ä¸ºå¶æ•°ï¼šç¨³å®šç‰ˆæœ¬ï¼Œå¦‚2.6.xx ï¼Œå®¶åº­ã€ä¼ä¸šä½¿ç”¨ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹è‡ªå·±çš„linuxçš„ç‰ˆæœ¬å·ï¼š uname -r Linuxå‘è¡Œç‰ˆLinuxå…¶å®å°±æ˜¯Linux Kernelï¼ˆå†…æ ¸ï¼‰ï¼‹å†…æ ¸å·¥å…·ã€‚ä»–æ˜¯GNU GPLæˆæƒæ¨¡å¼ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å–æºä»£ç å¹¶è¿›è¡Œä¿®æ”¹ã€‚å› æ­¤Linuxçš„å…¨åæ˜¯ï¼šGNU/Linuxã€‚Linux ditributionæ˜¯ç”±å„ä¸ªå•†ä¸šå…¬å¸å¼€å‘ï¼Œæœ¬è´¨ä¸Šæ˜¯LinuxKernelï¼‹å†…æ ¸å·¥å…·ï¼‹è½¯ä»¶ï¼Œè®©æ™®é€šç”¨æˆ·éƒ½èƒ½ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿã€‚ åŸºæœ¬ä¸ŠLinux distributionså¹¶æ— å¤ªå¤§åŒºåˆ«ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½é€‰æ‹©ã€‚ä»–ä»¬çš„å†…æ ¸éƒ½æ˜¯ä»www.kernel.orgä¸Šä¸‹è½½çš„ã€‚ Linuxçš„ç‰¹è‰² è‡ªç”±ä¸å¼€æ”¾çš„ä½¿ç”¨ä¸å­¦ä¹ ç¯å¢ƒ é…ç½®éœ€æ±‚ä½å»‰ å†…æ ¸åŠŸèƒ½å¼ºå¤§è€Œç¨³å®š ç‹¬ç«‹ä½œä¸š Linuxä¼˜ç‚¹ ç¨³å®šçš„ç³»ç»Ÿ å…è´¹æˆ–å°‘è®¸è´¹ç”¨ å®‰å…¨æ€§ã€æ¼æ´çš„å¿«é€Ÿä¿®è¡¥ å¤šä»»åŠ¡ã€å¤šç”¨æˆ· ç”¨æˆ·ä¸ç”¨æˆ·ç»„çš„è§„åˆ’ ç›¸å¯¹æ¯”è¾ƒä¸è€—èµ„æºçš„ç³»ç»Ÿ æ•´åˆåº¦ä½³ä¸”å¤šæ ·çš„å›¾å½¢ç”¨æˆ·ç•Œé¢ Linuxç¼ºç‚¹ æ²¡æœ‰ç‰¹å®šçš„æ”¯æŒäº§å•† æ¸¸æˆçš„æ”¯æŒåº¦ä¸è¶³ ä¸“ä¸šè½¯ä»¶çš„æ”¯æŒåº¦ä¸è¶³ Linuxå½“å‰çš„è§’è‰²ä¼ä¸šç¯å¢ƒçš„åº”ç”¨ ç½‘ç»œæœåŠ¡å™¨ï¼ˆå½“ä»Šæœ€çƒ­é—¨çš„è¿ç”¨ï¼‰ å…³é”®ä»»åŠ¡çš„åº”ç”¨ï¼ˆé‡‘èæ•°æ®åº“ã€å¤§å‹ä¼ä¸šï¼‰ å­¦æœ¯æœºæ„çš„é«˜æ€§èƒ½è¿ç®—ä»»åŠ¡ ä¸ªäººç¯å¢ƒçš„ä½¿ç”¨ æ¡Œé¢è®¡ç®—æœº(åœ¨Linuxç³»ç»Ÿä¸Šè£…ä¸€ä¸ªX Window Systemè½¯ä»¶ä¹‹åï¼Œå°±èƒ½æœ‰æ¡Œé¢äº†) æ‰‹æŒè®¾å¤‡ï¼ˆPADã€æ‰‹æœºï¼‰ åµŒå…¥å¼ç³»ç»Ÿ Linuxçš„å­¦ä¹ è·¯çº¿ å­¦ä¹ è®¡ç®—æœºæ¦‚è®ºåŠç¡¬ä»¶ç›¸å…³çŸ¥è¯† ä»Linuxçš„å®‰è£…å¼€å§‹å­¦èµ· å­¦ä¼šä½¿ç”¨Linuxçš„åŸºæœ¬æŠ€èƒ½ å­¦ä¼šviç¼–è¾‘å™¨ shellä¸shellè„šæœ¬çš„å­¦ä¹  ä¸€å®šè¦ä¼šè½¯ä»¶ç®¡ç†å‘˜ äº†è§£ç½‘ç»œåŸºç¡€ ä½¿ç”¨Linuxæ¶è®¾ç½‘ç«™ æ€»ç»“åœ¨ä½¿ç”¨Linuxä¹‹å‰è¯·å­¦ä¼šLinuxï¼ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èµ°è¿›Linux_è®¡ç®—æœºåŸºç¡€]]></title>
    <url>%2F2018%2F03%2F20%2F%E8%B5%B0%E8%BF%9BLinux%2F%E8%B5%B0%E8%BF%9BLinux_%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæˆ‘ä¹Ÿç®—æ˜¯ä»é€šä¿¡ä¸“ä¸šè½¬åˆ°è®¡ç®—æœºçš„ï¼Œæ‰€ä»¥å½“ç„¶å¯¹è®¡ç®—æœºä¸“ä¸šè¯¾çŸ¥è¯†ä¸å¤ªäº†è§£ï¼Œæ‰€ä»¥ä¹Ÿæƒ³ç®€å•æŒæ¡ä»¥ä¸‹è®¡ç®—æœºåŸºç¡€çŸ¥è¯†ã€‚ è®¡ç®—æœºå…¶å®æ˜¯ï¼šæ¥æ”¶ç”¨æˆ·è¾“å…¥æŒ‡ä»¤å’Œæ•°æ®ï¼Œç»è¿‡ä¸­å¤®å¤„ç†å™¨çš„æ•°æ®æ¬²é€»è¾‘å•å…ƒè¿ç®—å¤„ç†åï¼Œä»¥äº§ç”Ÿæˆ–å­˜å‚¨æˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚ è®¡ç®—æœºç»„æˆè®¡ç®—æœºç¡¬ä»¶çš„äº”å¤§å•å…ƒ è¾“å…¥å•å…ƒ è¾“å‡ºå•å…ƒ CPUå†…éƒ¨çš„æ§åˆ¶å•å…ƒ CPUå†…éƒ¨çš„ç®—æœ¯é€»è¾‘å•å…ƒ å†…å­˜ CPUçš„ç§ç±»CPUå†…éƒ¨å·²ç»å«æœ‰ä¸€äº›å°æŒ‡ä»¤é›†ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„è½¯ä»¶éƒ½è¦ç»è¿‡CPUå†…éƒ¨çš„å¾®æŒ‡ä»¤é›†æ¥å®Œæˆæ‰è¡Œã€‚è¿™äº›æŒ‡ä»¤é›†çš„è®¾è®¡ä¸»è¦è¢«åˆ†ä¸ºä¸¤ç§è®¾è®¡ç†å¿µï¼Œå¦‚ä¸‹ï¼š ç²¾ç®€æŒ‡ä»¤é›†ï¼ˆRISCï¼‰ é‡‡ç”¨ç²¾ç®€æŒ‡ä»¤é›†çš„cpuçš„æŒ‡ä»¤è¾ƒä¸ºç²¾ç®€ï¼Œæ¯æ¡æŒ‡ä»¤çš„æ‰§è¡Œæ—¶é—´å¾ˆçŸ­ï¼Œå®Œæˆçš„æ“ä½œä¹Ÿå¾ˆå•çº¯ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œæ€§èƒ½è¾ƒå¥½ï¼›ä½†æ˜¯å¦‚æœè¦åšä¸€äº›å¤æ‚çš„æ“ä½œï¼Œåˆ™éœ€è¦å¤šä¸ªæŒ‡ä»¤æ¥ååŒå®Œæˆã€‚ å¸¸è§çš„ç²¾ç®€æŒ‡ä»¤é›†CPUæœ‰ï¼š sunå…¬å¸çš„SPARCç³»åˆ—ï¼Œå¸¸åº”ç”¨äºå­¦æœ¯é¢†åŸŸçš„å¤§å‹å·¥ä½œç«™ IBMå…¬å¸çš„Power Architectureï¼ˆåŒ…æ‹¬Power PCï¼‰ï¼Œå¦‚ç´¢å°¼çš„PS3 IBMå…¬å¸çš„ARMç³»åˆ—ï¼Œå¸¸ç”¨äºæ‰‹æœºã€pdaã€å¯¼èˆªç³»ç»Ÿã€ç½‘ç»œè®¾å¤‡ç­‰ ï¼ˆä½¿ç”¨æœ€å¹¿æ³›ï¼‰ å¤æ‚æŒ‡ä»¤é›†ï¼ˆCISCï¼‰ æ¯ä¸€æ¡æŒ‡ä»¤è¾ƒä¸ºå¤æ‚ï¼Œå› ä¸ºæ‰§è¡Œçš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œä½†æ˜¯æ¯æ¡æŒ‡ä»¤å¤„ç†çš„å·¥ä½œè¾ƒä¸ºä¸°å¯Œã€‚ å¸¸è§çš„å¤æ‚æŒ‡ä»¤é›†çš„CPUï¼šAMDã€Intelã€VIAç­‰x86æ¶æ„çš„cpuã€‚ç”±äºè¿™äº›é‡‡ç”¨äº†å¤æ‚æŒ‡ä»¤é›†çš„x86æ¶æ„çš„cpuå¸¸å¸¸è¢«ç”¨åœ¨ä¸ªäººè®¡ç®—æœºä¸Šï¼Œæ‰€ä»¥ä¸ªäººè®¡ç®—æœºå¸¸å¸¸å°±è¢«ç§°ä¸ºx86è®¡ç®—æœºã€‚x86æ¶æ„çš„CPUæœ€æ—©ç”±å› ç‰¹å°”å¼€å‘ï¼Œå¹¶ä¸”å®ƒå°†CPUä»8ä½æå‡ä¸º16ä½ã€32ä½ã€‚åæ¥ï¼ŒAMDå…¬å¸åŸºäºx86æ¶æ„å¼€å‘å‡ºäº†64ä½çš„CPUã€‚æ‰€ä»¥64ä½CPUuçš„æ¶æ„å«åšx86_64ï¼Œé64ä½cpuçš„æ¶æ„ä»ç„¶å«åšx86ã€‚ æ¥å£è®¾å¤‡ å­˜å‚¨è®¾å¤‡ï¼šåŒ…æ‹¬ç¡¬ç›˜ï¼Œè½¯ç›˜ç­‰ æ˜¾ç¤ºè®¾å¤‡ï¼šæ˜¾å¡ç­‰ ç½‘ç»œè®¾å¤‡ï¼šç½‘å¡ç­‰ è®¡ç®—æœºåˆ†ç±» è¶…çº§è®¡ç®—æœºï¼šè¿ç®—é€Ÿåº¦æœ€å¿«çš„è®¡ç®—æœºï¼Œä¸»è¦æ˜¯ç”¨äºéœ€è¦æœ‰é«˜é€Ÿè®¡ç®—çš„é¡¹ç›®ä¸­ã€‚ å¤§å‹è®¡ç®—æœºï¼šåŠŸèƒ½ä¸Šä¸åŠè¶…çº§è®¡ç®—æœºï¼Œä½†ä¹Ÿå¯ä»¥ç”¨æ¥å¤„ç†å¤§é‡æ•°æ®ä¸å¤æ‚è®¡ç®—ã€‚ è¿·ä½ è®¡ç®—æœºï¼šä¸»æœºå¯ä»¥æ”¾åœ¨ä¸€èˆ¬åœºæ‰€ï¼Œæ— éœ€åƒå¤§å‹è®¡ç®—æœºä¸€æ ·éœ€è¦ç‰¹æ®Šçš„ç©ºè°ƒåœºæ‰€ã€‚ å·¥ä½œç«™ï¼šå·¥ä½œç«™çš„ä»·æ ¼æ¯”è¿·ä½ è®¡ç®—æœºä¾¿å®œè®¸å¤šï¼Œã€‚æ˜¯é’ˆå¯¹ç‰¹æ®Šç”¨é€”è€Œè®¾è®¡çš„è®¡ç®—æœºã€‚ å¾®ç”µè„‘ï¼šä¸ªäººè®¡ç®—æœºï¼ˆPCï¼‰ã€‚ è®¡ç®—æœºä¸Šé¢çš„å¸¸ç”¨çš„è®¡ç®—å•ä½ï¼ˆå¤§å°ã€é€Ÿåº¦ç­‰ï¼‰ æ–‡ä»¶å¤§å°ï¼š1GB=1024*1024*1024Byteï¼›1Byte=8bit CPUè¿ç®—é€Ÿåº¦ï¼šMHzæˆ–è€…GHzï¼ŒHzä¸ºç§’åˆ†ä¹‹ä¸€ ç½‘ç»œä¼ è¾“ï¼šMbit/sæˆ–è€…MB/sï¼Œæ³¨æ„bitè¿˜æ˜¯Byte ä¸ªäººè®¡ç®—æœºæ¶æ„ä¸æ¥å£è®¾å¤‡åœ¨è®¡ç®—æœºä¸»æ¿ä¸Šçš„èŠ¯ç‰‡ç»„é€šå¸¸åˆåˆ†ä¸ºä¸¤ä¸ªæ¡¥æ¥å™¨æ¥æ§åˆ¶å„ç»„ä»¶çš„é€šä¿¡ï¼š åŒ—æ¡¥è´Ÿè´£è¿æ¥é€Ÿåº¦è¾ƒå¿«çš„CPUã€å†…å­˜ä¸æ˜¾å¡ç­‰ç»„ä»¶ã€‚åŒ—æ¡¥çš„æ€»çº¿ç§°ä¸ºç³»ç»Ÿæ€»çº¿ã€‚å› ä¸ºæ˜¯å†…å­˜ä¼ è¾“çš„ä¸»è¦é€šé“ï¼Œæ‰€ä»¥é€Ÿåº¦å¿«ã€‚ å—æ¡¥è´Ÿè´£é“¾æ¥é€Ÿåº¦è¾ƒæ…¢çš„å‘¨è¾¹æ¥å£ï¼ŒåŒ…æ‹¬ç¡¬ç›˜ã€USBã€ç½‘å¡ç­‰ã€‚å—æ¡¥çš„æ€»çº¿ç§°ä¸ºè¾“å…¥è¾“å‡º(I/O)æ€»çº¿ã€‚ AMDå’ŒIntelçš„èŠ¯ç‰‡ç»„æ¶æ„æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯AMDçš„å†…å­˜æ˜¯ç›´æ¥ä¸CPUé€šä¿¡è€Œä¸é€šè¿‡åŒ—æ¡¥ã€‚ CPUå¤–é¢‘ä¸å†…å± å¤–é¢‘ï¼šCPUä¸å¤–éƒ¨ç»„ä»¶è¿›è¡Œæ•°æ®ä¼ è¾“/è¿ç®—æ—¶çš„é€Ÿåº¦ã€‚ å€é¢‘ï¼šCPUå†…éƒ¨ç”¨æ¥åŠ é€Ÿå·¥ä½œæ€§èƒ½çš„ä¸€ä¸ªå€é€Ÿï¼Œä¸¤è€…ç›¸ä¹˜æ‰æ˜¯cpu çš„é¢‘ç‡ã€‚ 32ä½ä¸64ä½ åŒ—æ¡¥æ‰€æ”¯æŒçš„é¢‘ç‡ç§°ä¸ºå‰ç«¯æ€»çº¿é€Ÿï¼ˆFSBï¼‰åº¦ï¼Œè€Œæ¯æ¬¡ä¼ é€çš„ä½æ•°åˆ™æ˜¯æ€»çº¿å®½åº¦ï¼Œæ‰€è°“æ€»çº¿é¢‘å®½åˆ™æ˜¯â€œFSB*æ€»çº¿å®½åº¦â€ï¼Œä¸šæŠ€æœ¯æ¯ç§’é’Ÿå¯ä»¥ä¼ é€çš„æœ€å¤§æ•°æ®é‡ã€‚ CPUæ¯æ¬¡èƒ½å¤„ç†çš„æ•°æ®é‡ç§°ä¸ºå­—ç»„å¤§å°(word size)ï¼Œå­—ç»„å¤§å°ä¾æ®cpuçš„è®¾è®¡æœ‰32ï¼64ä½ã€‚æˆ‘ä»¬ç°åœ¨ç§°è®¡ç®—æœºæ˜¯32ï¼64ä½æ˜¯æ ¹æ®CPUè§£æçš„å­—ç»„å¤§å°æ¥çš„ã€‚ å†…å­˜æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„å†…å­˜çš„å…¨åå«åšåŠ¨æ€éšæœºè®¿é—®å­˜å‚¨å™¨ï¼ˆDRAMï¼‰ã€‚DRAMæ˜¯ä¸€ç§æŒ¥å‘æ€§å†…å­˜ï¼Œåªæœ‰å®ƒé€šç”µçš„æ—¶å€™æ‰èƒ½è¢«ä½¿ç”¨ï¼Œæ–­ç”µæ•°æ®å°±æ¶ˆå¤±ã€‚DRAMåˆ†ä¸ºï¼š SDRAM DDR SDRAMï¼ŒDDR=Double Data Rate æ‰€ä»¥ä»–çš„ä¼ è¾“é€Ÿåº¦æ¯”SDRAMè¦å¿«ã€‚ å¯¹æœåŠ¡å™¨è€Œè¨€ï¼Œå†…å­˜çš„å®¹é‡æ¯”CPUçš„é€Ÿåº¦æ›´åŠ é‡è¦ã€‚CPUä¸å†…å­˜çš„å¤–é¢‘åº”è¯¥ç›¸åŒæ‰å¥½ã€‚ åŒé€šé“è®¾è®¡æ€»çº¿å®½åº¦ä¸€èˆ¬æ˜¯64ä½ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡æ€»çº¿ä»å†…å­˜ä¸­è¯»å†™64ä½æ•°æ®ï¼Œè‹¥åœ¨ä¸»æ¿ä¸Šæ’ä¸¤æ ¹å†…å­˜æ¡ï¼Œé‚£ä¹ˆæ€»çº¿å®½åº¦å°±è¾¾åˆ°128ä½ï¼Œä»è€Œæå‡äº†å†…å­˜çš„è¯»å†™é€Ÿåº¦ã€‚åœ¨ä¸»æ¿ä¸Šæ’ä¸¤æ ¹å†…å­˜æ¡çš„è®¾è®¡å°±å«åšåŒé€šé“è®¾è®¡ã€‚ä½†æ˜¯è¦å¯åŠ¨åŒé€šé“åŠŸèƒ½ï¼Œå®‰æ’çš„ä¸¤æ ¹å†…å­˜æ¡å¿…é¡»å‹å·ä¸€æ ·ï¼Œå¤§å°ä¸€æ ·ï¼Œè¿™æ ·æ‰èƒ½æ•´ä½“ä¸Šæå‡å†…å­˜çš„è¯»å†™é€Ÿåº¦ã€‚ DRAMä¸SRAMDRAMå°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„å†…å­˜ï¼Œå®ƒçš„å…¨ç§°å«åšåŠ¨æ€éšæœºè®¿é—®å­˜å‚¨å™¨ã€‚è€ŒSRAMçš„å…¨ç¨‹å«åšé™æ€éšæœºè®¿é—®å­˜å‚¨å™¨ã€‚SRAMå¯ä»¥ç”¨åœ¨å¾ˆå¤šä¸åŒçš„åœ°æ–¹ï¼Œè€ŒCPUä¸­çš„ç¬¬äºŒå±‚é«˜é€Ÿç¼“å­˜å°±æ˜¯é€‰æ‹©SRAMä½œä¸ºå­˜å‚¨å™¨ã€‚ç”±äºL2 Cacheé›†æˆåœ¨CPUå†…éƒ¨ï¼ŒCPUè¯»å–æ•°æ®æ— éœ€å†ç»è¿‡åŒ—æ¡¥ä»å†…å­˜ä¸­è·å–ï¼Œç›´æ¥ä»L2 Cacheä¸­è·å–ï¼Œä»è€Œèƒ½æå‡æ€§èƒ½ã€‚ æ˜¾å¡æ˜¾å¡åˆå«åšVGAï¼ˆVideo Graphics Arrayï¼‰ã€‚å›¾å½¢å½±å“çš„æ˜¾ç¤ºè´¨é‡çš„å¥½åé‡ç‚¹åœ¨äºåˆ†è¾¨ç‡å’Œè‰²å½©æ·±åº¦ã€‚ç”±äºæ˜¾ç¤ºçš„æ¯ä¸€ä¸ªåƒç´ éƒ½ä¼šå ç”¨å†…å­˜ï¼Œå› æ­¤æ˜¾å¡ä¸Šé¢ä¹Ÿæœ‰ä¸ªå­˜å‚¨å™¨ï¼Œè€Œè¿™ä¸ªå­˜å‚¨å™¨çš„å¤§å°ç›´æ¥å½±å“æ˜¾ç¤ºçš„æ•ˆæœã€‚æ—©æœŸæ—¶å€™3Dçš„è¿ç®—æ˜¯äº¤ç»™CPUå»å¤„ç†çš„ï¼Œä¸ºäº†å‡å°‘CPUçš„è´Ÿæ‹…ï¼Œæ‰€ä»¥åœ¨æ˜¾å¡ä¸Šè®¾ç½®ä¸€ä¸ªå¤„ç†å™¨ï¼Œè¿™ä¸ªå¤„ç†å™¨å°±æ˜¯GPUã€‚ PS: å¦‚æœä½ çš„ä¸»æœºæ˜¯ç”¨æ¥æ‰“3Dæ¸¸æˆï¼Œé‚£ä¹ˆæ˜¾å¡çš„é€‰è´­éå¸¸é‡è¦ï¼Œå¦‚æœä½ çš„ä¸»æœºæ˜¯ç”¨æ¥ä½œä¸ºç½‘ç»œæœåŠ¡å™¨ï¼Œé‚£ä¹ˆç®€å•çš„å…¥é—¨çº§æ˜¾å¡å¯¹ä½ çš„ä¸»æœºæ¥è¯´å°±éå¸¸å¤Ÿç”¨äº†ã€‚ ç¡¬ç›˜ä¸å­˜å‚¨è®¾å¤‡è®¡ç®—æœºç³»ç»Ÿä¸Šçš„å­˜å‚¨è®¾å¤‡åŒ…æ‹¬ç¡¬ç›˜ã€è½¯ç›˜ã€Uç›˜ç­‰ï¼Œæˆ‘ä»¬ä¸»è¦ä»‹ç»ç¡¬ç›˜ï¼š ç¡¬ç›˜ä¸»è¦æ˜¯ç”±è®¸å¤šçš„ç›˜ç‰‡ã€æœºæ¢°æ‰‹è‡‚ã€ç£å¤´ä¸ä¸»è½´é©¬è¾¾æ‰€ç»„æˆã€‚å®é™…çš„æ•°æ®éƒ½æ˜¯å†™åœ¨å…·æœ‰ç£æ€§ç‰©è´¨çš„ç›˜ç‰‡ä¸Šï¼Œç¡¬ç›˜è¿è¡Œæ—¶ï¼Œä¸»è½´é©¬è¾¾è®©ç›˜ç‰‡è½¬åŠ¨ï¼Œæœºæ¢°æ‰‹è‡‚å¯ä»¥ä¼¸ç¼©ï¼Œè®©è¯»å–å¤´åœ¨ç›˜ç‰‡ä¸Šé¢è¿›è¡Œè¯»å†™æ“ä½œã€‚ ç¡¬ç›˜çš„æœ€å°å­˜å‚¨å•ä½æ˜¯æ‰‡åŒºï¼Œæ¯ä¸ªæ‰‡åŒºçš„å¤§å°æ˜¯512bytesï¼Œè¿™ä¸ªå€¼æ˜¯ä¸å¯æ”¹å˜çš„ã€‚æ‰‡åŒºç»„æˆçš„ç¯å«åšç£é“ã€‚ä¸Šä¸‹çš„æ‰€æœ‰ç£é“æ„æˆæŸ±é¢ã€‚æŸ±é¢æ˜¯åˆ†å‰²ç¡¬ç›˜çš„æœ€å°å•ä½ã€‚ä¸€èˆ¬ç¡¬ç›˜åˆ¶é€ å•†æ‚æ˜¾ç¤ºç¡¬ç›˜å®¹é‡æ—¶ï¼Œå¤§å¤šæ˜¯ä»¥åè¿›åˆ¶æ¥ç¼–å·ï¼Œæ‰€æœ‰500GBçš„ç¡¬ç›˜ï¼Œç†è®ºä¸Šä»…ä¼šæœ‰460GBå·¦å³çš„å®¹é‡ã€‚ ä¼ è¾“æ¥å£ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š IDEæ¥å£ï¼šæ¯ç§’ä¼ è¾“å¯è¾¾133MBã€‚ SATAæ¥å£ï¼šSATAï¼1æ¯ç§’ä¼ è¾“150MBï¼ŒSATAï¼2æ¯ç§’ä¼ è¾“300MBï¼Œç›®å‰ä¸ªäººè®¡ç®—æœºéƒ½å·²ä½¿ç”¨SATAã€‚ SCSIæ¥å£ï¼šè¿™ä¸ªæ¥å£å«æœ‰ä¸€ä¸ªå¤„ç†å™¨ï¼Œç¡¬ç›˜çš„è¯»å†™æ“ä½œç”±è¿™ä¸ªå¤„ç†å™¨å®Œæˆï¼Œä»è€Œæå‡è®¡ç®—æœºæ•´ä½“æ€§èƒ½ã€‚ PSï¼šç¡¬ç›˜å¾ˆè„†å¼±ï¼Œåƒä¸‡åˆ«è®©å®ƒæ‘”äº†è¿˜æ˜¯æ€æ ·ï¼Œè¡€çš„æ•™è®­ã€‚ ä¸»æ¿ä¸»æ¿å¯ä»¥è¯´æ˜¯æ•´å°ä¸»æœºç›¸å½“é‡è¦çš„åœ°æ–¹ï¼Œå› ä¸ºé‡è¦çš„ç»„ä»¶éƒ½æ˜¯å®‰æ’åœ¨ä¸»æ¿ä¸Šé¢çš„ï¼Œè€Œä¸»æ¿ä¸Šé¢è´Ÿè´£é€šä¿¡å„ä¸ªç»„ä»¶çš„å°±æ˜¯èŠ¯ç‰‡ç»„ã€‚ä¸‹é¢è¯´è¯´ä¸»æ¿æˆ‘ä»¬å¸¸ç”¨çš„ä¸œè¥¿ï¼š CMOSä¸BIOSï¼šCMOSä¸»è¦çš„åŠŸèƒ½æ˜¯è®°å½•ä¸»æ¿ä¸Šé¢çš„é‡è¦å‚æ•°ï¼Œå¦‚ç³»ç»Ÿæ—¶é—´ç­‰ã€‚BIOSä¸ºå†™å…¥åˆ°ä¸»æ¿ä¸ŠæŸä¸€å—é—ªå­˜æˆ–EEPROMçš„ç¨‹åºï¼Œå®ƒå¯ä»¥åœ¨å¼€æœºçš„æ—¶å€™æ‰§è¡Œï¼Œå·²åŠ è½½CMOSå½“ä¸­çš„å‚æ•°ï¼Œå¹¶å°è¯•è°ƒç”¨å­˜å‚¨è®¾å¤‡ä¸­çš„å¼€æœºç¨‹åºï¼Œè¿›ä¸€æ­¥è¿›å…¥æ“ä½œç³»ç»Ÿå½“ä¸­ã€‚ è¿æ¥æ¥å£è®¾å¤‡ï¼šä¸»æ¿ä¸å„é¡¹è¾“å‡º/è¾“å…¥è®¾å¤‡çš„é“¾æ¥ä¸»è¦éƒ½æ˜¯åœ¨ä¸»æœºç®±çš„åæ–¹ï¼Œå¦‚USBæ¥å£RJ-45æ¥å£ç­‰ã€‚ è®¡ç®—æœºç¼–ç  å¸¸ç”¨çš„è‹±æ–‡ç¼–ç è¡¨æ˜¯ASKIIï¼Œæ¯ä¸ªå­—ç¬¦å 1Bï¼Œå› æ­¤æ€»å…±æœ‰2çš„8æ¬¡æ–¹ç§å˜åŒ–ã€‚ ä¸­æ–‡ç¼–ç è¡¨å¸¸ç”¨gb2312ï¼Œæ¯ä¸ªå­—ç¬¦å 2Bï¼Œå®šä¹‰äº†ä¸€ä¸‡ä¸‰åƒå¤šä¸ªå­—ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªç¼–ç è¡¨å¯¹äºæ•°æ®åº“å­˜å‚¨æœ‰é—®é¢˜ï¼Œä»æ•°æ®åº“è¯»å‡ºæ•°æ®çš„æ—¶å€™æœ‰äº›å­—ä¼šè¢«è¯»é”™ã€‚ ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå‡ºç°äº†Unicodeç¼–ç è¡¨ï¼Œå°±æ˜¯UTF-8ã€‚ è½¯ä»¶ç¨‹åºè¿è¡Œä¸€èˆ¬æ¥è¯´ç›®å‰çš„è®¡ç®—æœºç³»ç»Ÿå°†è½¯ä»¶åˆ†ä¸ºä¸¤å¤§ç±»ï¼šä¸€æ˜¯ç³»ç»Ÿè½¯ä»¶ï¼ˆå†…æ ¸ï¼‰ï¼Œä¸€ä¸ªæ˜¯åº”ç”¨ç¨‹åºï¼ˆæ—¥å¸¸æ‰€è¯´çš„è½¯ä»¶ï¼‰ã€‚ æœºå™¨ç¨‹åºä¸ç¼–è¯‘ç¨‹åº æœºå™¨ç¨‹åºï¼šéƒ½æ˜¯æœºå™¨ç ï¼Œå¯ä»¥ç›´æ¥ç»™æœºå™¨è¯†åˆ«ã€‚ ç¼–è¯‘ç¨‹åºï¼šèƒ½å¤Ÿå°†é«˜çº§è¯­è¨€ç¼–è¯‘æˆæœºå™¨ç¨‹åºã€‚ æ“ä½œç³»ç»Ÿå…ˆçœ‹çœ‹æ“ä½œç³»ç»Ÿçš„è§’è‰²ï¼Œä»åº•å±‚åˆ°é«˜å±‚ï¼šç¡¬ä»¶-&gt;å†…æ ¸-&gt;ç³»ç»Ÿè°ƒç”¨-&gt;åº”ç”¨ç¨‹åºã€‚å…¶ä¸­å†…æ ¸ä»¥åŠç³»ç»Ÿè°ƒç”¨è¢«ç§°ä¸ºæ“ä½œç³»ç»Ÿã€‚ æ“ä½œç³»ç»Ÿå†…æ ¸ï¼šæ“ä½œç³»ç»Ÿå…¶å®ä¹Ÿæ˜¯ä¸€ç»„ç¨‹åºï¼Œè¿™ç»„ç¨‹åºçš„é‡ç‚¹åœ¨äºç®¡ç†è®¡ç®—æœºçš„æ‰€æœ‰æ´»åŠ¨ä»¥åŠé©±åŠ¨ç³»ç»Ÿçš„æ‰€æœ‰ç¡¬ä»¶ã€‚ ç³»ç»Ÿè°ƒç”¨ï¼šæ“ä½œç³»ç»Ÿæä¾›çš„ä¸€ç»„å¼€å‘æ¥å£ã€‚ å†…æ ¸åŠŸèƒ½ï¼š ç³»ç»Ÿè°ƒç”¨æ¥å£ ç¨‹åºç®¡ç† å†…å­˜ç®¡ç† æ–‡ä»¶ç³»ç»Ÿç®¡ç† è®¾å¤‡é©±åŠ¨ æ“ä½œç³»ç»Ÿä¸é©±åŠ¨ç¨‹åºï¼šæ“ä½œç³»ç»Ÿé€šå¸¸ä¼šæä¾›ä¸€ä¸ªå¼€å‘æ¥å£ç»™ç¡¬ä»¶å•†ï¼Œè®©ä»–ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥å£è‰²åˆè®¡å¯ä»¥é©±åŠ¨ä»–ä»¬ç¡¬ä»¶çš„é©±åŠ¨ç¨‹åºã€‚ åº”ç”¨ç¨‹åºåº”ç”¨ç¨‹åºæ˜¯å‚è€ƒæ“ä½œç³»ç»Ÿæä¾›çš„å¼€å‘æ¥å£æ‰€å¼€å‘å‡ºæ¥çš„è½¯ä»¶ï¼Œè¿™äº›è½¯ä»¶å¯ä»¥è®©ç”¨æˆ·æ“ä½œï¼Œä»¥è¾¾åˆ°æŸäº›è®¡ç®—æœºçš„åŠŸèƒ½åˆ©ç”¨ã€‚ æ€»ç»“äº†è§£å¥½è®¡ç®—æœºçš„åŸºç¡€çŸ¥é“ï¼Œæˆ‘ä»¬å¯¹è®¡ç®—æœºé‡Œé¢çš„ç¡¬ä»¶ä»¥åŠç¨‹åºçš„å®ç°æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£ï¼Œæœ‰åˆ©äºæˆ‘ä»¬å­¦ä¹ ä¸‹é¢çš„çŸ¥è¯†ã€‚ å‚è€ƒ ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹]]></content>
      <categories>
        <category>èµ°è¿›Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”æ¡¥æ¢æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F19%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E6%A1%A5%E6%A2%81%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸å˜çš„éƒ¨åˆ†ç”¨ç»§æ‰¿æ¥å®ç°ï¼Œå˜å¾—éƒ¨åˆ†æ”¾åœ¨å¤–éƒ¨ï¼Œå¹¶é€šè¿‡æ¡¥æ¢æ¨¡å¼æŠ½è±¡è€¦åˆè¿›æ¥ï¼Œè¿™æ ·å°±è§£å†³äº†ç»§æ‰¿çš„å¼Šç«¯ã€‚ å®šä¹‰æ¡¥æ¢æ¨¡å¼ä¹Ÿå«åšæ¡¥æ¥æ¨¡å¼ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š å°†æŠ½è±¡å’Œå®ç°è§£è€¦ï¼Œä½¿å¾—ä¸¤è€…å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚â€”â€”ç»“æ„ç±» ä¸‹é¢æ˜¯æ¡¥æ¢æ¨¡å¼çš„é€šç”¨ç±»å›¾ï¼š æˆ‘ä»¬çœ‹çœ‹æ¡¥æ¢æ¨¡å¼ç±»å›¾ä¸­çš„4ä¸ªè§’è‰²ï¼š AbstractionæŠ½è±¡åŒ–è§’è‰²ï¼šä¸»è¦èŒè´£æ˜¯å®šä¹‰å‡ºè¯¥è§’è‰²çš„è¡Œä¸ºï¼ŒåŒæ—¶ä¿å­˜ä¸€ä¸ªå¯¹å®ç°åŒ–è§’è‰²çš„å¼•ç”¨ï¼Œè¯¥è§’è‰²ä¸€èˆ¬æ˜¯æŠ½è±¡ç±»ã€‚ Implementorå®ç°åŒ–è§’è‰²ï¼šå®šä¹‰è§’è‰²å¿…é¡»çš„è¡Œä¸ºå’Œå±æ€§ã€‚ RefinedAbstractionä¿®æ­£æŠ½è±¡åŒ–è§’è‰²ï¼šå®ƒå¼•ç”¨å®ç°åŒ–è§’è‰²å¯¹æŠ½è±¡åŒ–è§’è‰²è¿›è¡Œä¿®æ­£ã€‚ ConcreteImplementorå…·ä½“å®ç°åŒ–è§’è‰²ï¼šå®ç°æ¥å£æˆ–æŠ½è±¡ç±»å®šä¹‰çš„æ–¹æ³•å’Œå±æ€§ã€‚ å®ƒçš„é€šç”¨æºç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667public interface Implementor &#123; // åŸºæœ¬æ–¹æ³• public void doSomething(); public void doAnything();&#125;// å…·ä½“å®ç°åŒ–è§’è‰²public class ConcreteImplementor1 implements Implementor &#123; public void doSomething() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125; public void doAnything() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125;&#125;public class ConcreteImplementor2 implements Implementor &#123; public void doSomething() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125; public void doAnything() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125;&#125;// æŠ½è±¡åŒ–è§’è‰²public abstract class Abstraction &#123; // å®šä¹‰å¯¹å®ç°åŒ–è§’è‰²çš„å¼•ç”¨ private Implementor imp; // çº¦æŸå­ç±»å¿…é¡»å®ç°è¯¥æ„é€ å‡½æ•° public Abstraction(Implementor _imp) &#123; this.imp = _imp; &#125; // è‡ªèº«çš„è¡Œä¸ºå’Œå±æ€§ public void request() &#123; this.imp.doSomething(); &#125; // è·å¾—å®ç°åŒ–è§’è‰² public Implementor getImp() &#123; return imp; &#125;&#125;// å…·ä½“æŠ½è±¡åŒ–è§’è‰²public class RefinedAbstraction extends Abstraction &#123; // è¦†å†™æ„é€ å‡½æ•° public RefinedAbstraction(Implementor _imp) &#123; super(_imp); &#125; // ä¿®æ­£çˆ¶ç±»çš„è¡Œä¸º @Override public void request() &#123; super.request(); super.getImp().doAnything(); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å®šä¹‰ä¸€ä¸ªå®ç°åŒ–è§’è‰² Implementor imp = new ConcreteImplementor1(); // å®šä¹‰ä¸€ä¸ªæŠ½è±¡åŒ–è§’è‰² Abstraction abs = new RefinedAbstraction(imp); // æ‰§è¡Œ abs.request(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ æŠ½è±¡å’Œå®ç°åˆ†ç¦»ã€‚ ä¼˜ç§€çš„æ‰©å……èƒ½åŠ›ã€‚ å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜ã€‚ ä½¿ç”¨åœºæ™¯ ä¸å¸Œæœ›æˆ–ä¸åˆé€‚ä½¿ç”¨ç»§æ‰¿çš„åœºæ™¯ã€‚ æ¥å£æˆ–æŠ½è±¡ç±»ä¸ç¨³å®šçš„åœºæ™¯ã€‚ é‡ç”¨æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ã€‚ æ³¨æ„äº‹é¡¹ä½¿ç”¨æ¡¥æ¢æ¨¡å¼ä¸»è¦è€ƒè™‘å¦‚ä½•æ‹†åˆ†æŠ½è±¡å’Œå®ç°ã€‚æ¡¥æ¢æ¨¡å¼çš„æ„å›¾è¿˜æ˜¯å¯¹å˜åŒ–çš„å°è£…ï¼Œå°½é‡æŠŠå¯èƒ½å˜åŒ–çš„å› ç´ å°è£…åˆ°æœ€ç»†ã€æœ€å°çš„é€»è¾‘å•å…ƒï¼Œé¿å…é£é™©æ‰©æ•£ã€‚ æœ€ä½³å®è·µç»§æ‰¿éå¸¸å¥½ï¼Œä½†æ˜¯æœ‰ç¼ºç‚¹ã€‚æˆ‘ä»¬å¯ä»¥æ‰¬é•¿é¿çŸ­ï¼Œå¯¹äºæ¯”è¾ƒæ˜ç¡®ä¸å‘ç”Ÿå˜åŒ–çš„ï¼Œåˆ™é€šè¿‡ç»§æ‰¿æ¥å®Œæˆï¼›è‹¥ä¸èƒ½ç¡®å®šæ˜¯å¦ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼Œé‚£å°±è®¤ä¸ºä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆ™é€šè¿‡æ¡¥æ¢æ¨¡å¼æ¥æ­å»ºä¸€ä¸ªæ¡¥æ¢å°†å˜åŒ–çš„çš„ä¸œè¥¿æ”¾åœ¨å¤–éƒ¨å’Œæœ¬ä½“è¿›è¡Œè¿æ¥ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”äº«å…ƒæ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F18%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¯¹è±¡å¤šäº†ï¼Œè€Œä¸”è¿˜éƒ½æ˜¯å¤„äºæœ‰ç”¨çŠ¶æ€ï¼Œé‚£ä¸€å®šä¼šå‡ºç°å†…å­˜æº¢å‡ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äº«å…ƒæ¨¡å¼æ¥å®ç°å¯¹è±¡çš„å¤ç”¨ï¼Œä»¥è¾¾åˆ°å‡å°‘çš„ç›®çš„ï¼Œä»è€Œè§£å†³å†…å­˜æº¢å‡ºçš„é—®é¢˜ã€‚ å®šä¹‰äº«å…ƒæ¨¡å¼æ˜¯æ± æŠ€æœ¯çš„é‡è¦å®ç°æ–¹å¼ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š ä½¿ç”¨â€å…±äº«å¯¹è±¡â€å¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡çš„â€ç»†ç²’åº¦çš„å¯¹è±¡â€ã€‚â€”â€”ç»“æ„ç±» äº«å…ƒæ¨¡å¼çš„å®šä¹‰ä¸ºæˆ‘ä»¬æå‡ºäº†ä¸¤ä¸ªè¦æ±‚ï¼šç»†ç²’åº¦å¯¹è±¡å’Œå…±äº«å¯¹è±¡ã€‚æˆ‘ä»¬çŸ¥é“åˆ†é…å¤ªå¤šçš„å¯¹è±¡åˆ°åº”ç”¨ç¨‹åºä¸­å°†æœ‰æŸç¨‹åºçš„æ€§èƒ½ï¼ŒåŒæ—¶è¿˜å®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºï¼Œé‚£æ€ä¹ˆé¿å…å‘¢ï¼Ÿå°±æ˜¯äº«å…ƒæ¨¡å¼æåˆ°çš„å…±äº«æŠ€æœ¯ã€‚æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼š å†…éƒ¨çŠ¶æ€ï¼šå†…éƒ¨çŠ¶æ€æ˜¯å¯¹è±¡å¯å…±äº«å‡ºæ¥çš„ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨äº«å…ƒå¯¹è±¡å¹¶ä¸”ä¸ä¼šéšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜ï¼Œä¸å¿…å­˜å‚¨åœ¨å…·ä½“æŸä¸ªå¯¹è±¡ä¸­ï¼Œå±äºå¯ä»¥å…±äº«çš„éƒ¨åˆ†ã€‚ å¤–éƒ¨çŠ¶æ€ï¼šå¤–éƒ¨çŠ¶æ€æ˜¯å¯¹è±¡å¾—ä»¥ä¾èµ–çš„ä¸€ä¸ªæ ‡è®°ï¼Œæ˜¯éšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çš„ï¼Œä¸å¯ä»¥å…±äº«çš„çŠ¶æ€ï¼Œä»–æ˜¯ä¸€æ‰¹å¯¹è±¡çš„ç»Ÿä¸€æ ‡è¯†ï¼Œæ˜¯å”¯ä¸€çš„ç´¢å¼•å€¼ã€‚ ä¸‹é¢æ˜¯äº«å…ƒæ¨¡å¼çš„é€šç”¨ç±»å›¾ï¼š ç®€å•ä»‹ç»ç±»å›¾ä¸­çš„è§’è‰²ï¼š FlyweightæŠ½è±¡äº«å…ƒè§’è‰²ï¼šäº§å“çš„æŠ½è±¡ç±»ï¼ŒåŒæ—¶å®šä¹‰å‡ºå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€å’Œå†…éƒ¨çŠ¶æ€çš„æ¥å£æˆ–å®ç°ã€‚ ConcreteFlyWeightå…·ä½“äº«å…ƒè§’è‰²ï¼šå…·ä½“çš„ä¸€ä¸ªäº§å“ç±»ï¼Œå®ç°æŠ½è±¡è§’è‰²å®šä¹‰çš„ä¸šåŠ¡ã€‚è¯¥è§’è‰²ä¸­éœ€è¦æ³¨æ„çš„æ˜¯å†…éƒ¨çŠ¶æ€å¤„ç†åº”è¯¥ä¸ç¯å¢ƒæ— å…³ï¼Œä¸åº”è¯¥å‡ºç°ä¸€ä¸ªæ“ä½œæ”¹å˜äº†å†…éƒ¨çŠ¶æ€ï¼ŒåŒæ—¶ä¿®æ”¹äº†å¤–éƒ¨çŠ¶æ€ï¼Œè¿™æ˜¯ç»å¯¹ä¸å…è®¸çš„ã€‚ UnsharedConcreteFlyWeightä¸å¯å…±äº«çš„äº«å…ƒè§’è‰²ï¼šä¸å­˜åœ¨å¤–éƒ¨çŠ¶æ€æˆ–è€…å®‰å…¨è¦æ±‚ï¼ˆå¦‚çº¿ç¨‹å®‰å…¨ï¼‰ä¸èƒ½å¤Ÿä½¿ç”¨å…±äº«æŠ€æœ¯çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸€èˆ¬ä¸ä¼šå‡ºç°äº«å…ƒå·¥å‚ä¸­ã€‚ï¼ˆæœ‰ç‚¹ä¸å¤ªç†è§£ï¼‰ FlyWeightFactoryäº«å…ƒå·¥å‚ï¼šèŒè´£éå¸¸ç®€å•ï¼Œå°±æ˜¯æ„é€ ä¸€ä¸ªæ± å®¹å™¨ï¼ŒåŒæ—¶æä¾›ä»æ± ä¸­è·å–å¯¹è±¡çš„æ–¹æ³•ã€‚ äº«å…ƒæ¨¡å¼çš„ç›®çš„åœ¨äºè¿ç”¨å…±äº«æŠ€æœ¯ï¼Œä½¿å¾—ä¸€äº›ç»†ç²’åº¦çš„å¯¹è±¡å¯ä»¥å…±äº«ï¼Œå¤šä½¿ç”¨ç»†ç²’åº¦çš„å¯¹è±¡ï¼Œä¾¿äºé‡æ„æˆ–é‡ç”¨ï¼Œä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263// æŠ½è±¡äº«å…ƒè§’è‰²public abstract class Flyweight &#123; // å†…éƒ¨çŠ¶æ€ private String intrinsic; // å¤–éƒ¨çŠ¶æ€ æ³¨æ„final protected final String extrinsic; // è¦æ±‚äº«å…ƒè§’è‰²å¿…é¡»æ¥å—å¤–éƒ¨çŠ¶æ€ public Flyweight(String _extrinsic) &#123; this.extrinsic = _extrinsic; &#125; // å®šä¹‰ä¸šåŠ¡æ“ä½œ public abstract vid operate(); // å†…éƒ¨çŠ¶æ€çš„getter/setter public String getIntrinsic() &#123; return intrinsic; &#125; public void setIntrinsic(String intrinsic) &#123; this.intrinsic = intrinsic; &#125;&#125;// å…·ä½“äº«å…ƒè§’è‰²public class ConcreteFlyweight1 extends Flyweight &#123; // æ¥å—å¤–éƒ¨çŠ¶æ€ public ConcreteFlyweight1(String _extrinsic) &#123; super(_extrinsic) &#125; // æ ¹æ®å¤–éƒ¨çŠ¶æ€è¿›è¡Œé€»è¾‘å¤„ç† public void operate() &#123; // ä¸šåŠ¡é€»è¾‘ &#125;&#125;public class ConcreteFlyweight2 extends Flyweight &#123; // æ¥å—å¤–éƒ¨çŠ¶æ€ public ConcreteFlyweight2(String _extrinsic) &#123; super(_extrinsic) &#125; // æ ¹æ®å¤–éƒ¨çŠ¶æ€è¿›è¡Œé€»è¾‘å¤„ç† public void operate() &#123; // ä¸šåŠ¡é€»è¾‘ &#125;&#125;// äº«å…ƒå·¥å‚public class FlyweightFactory &#123; // å®šä¹‰ä¸€ä¸ªæ± å®¹å™¨ private static HashMap&lt;String,Flyweight&gt; pool = new HashMap&lt;String,Flyweight&gt;(); // äº«å…ƒå·¥å‚ public static Flyweight getFlyweight(String extrinsic) &#123; // éœ€è¦è¿”å›çš„å¯¹è±¡ Flyweight flyweight = null; // åœ¨æ± ä¸­æ²¡æœ‰è¯¥å¯¹è±¡ if(pool.containKey(extrinsic)) &#123; flyweight = pool.get(extrinsic); &#125; else &#123; // æ ¹æ®å¤–éƒ¨çŠ¶æ€åˆ›å»ºäº«å…ƒå¯¹è±¡ flyweight = new ConcreteFlyweight1(extrinsic); // æ”¾ç½®åˆ°æ± ä¸­ pool.put(extrinsic,flyweight); &#125; return flyweight; &#125;&#125; åº”ç”¨ä¼˜ç‚¹å¯ä»¥å¤§å¤§å‡å°‘åº”ç”¨ç¨‹åºåˆ›å»ºçš„å¯¹è±¡ï¼Œé™ä½ç¨‹åºå†…å­˜çš„å ç”¨ï¼Œå¢å¼ºç¨‹åºå¯¹çš„æ€§èƒ½ã€‚ ç¼ºç‚¹æé«˜äº†ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œéœ€è¦åˆ†ç¦»å‡ºå¤–éƒ¨çŠ¶æ€å’Œå†…éƒ¨çŠ¶æ€ï¼Œè€Œä¸”å¤–éƒ¨çŠ¶æ€å…·æœ‰å›ºåŒ–ç‰¹æ€§ï¼ˆåŠ fianlå…³é”®å­—ï¼‰ï¼Œä¸åº”è¯¥éšå†…éƒ¨æ”¹å˜è€Œæ”¹å˜ï¼Œå¦åˆ™å¯¼è‡´ç³»ç»Ÿçš„é€»è¾‘æ··ä¹±ã€‚ ä½¿ç”¨åœºæ™¯ ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡çš„ç›¸ä¼¼å¯¹è±¡ã€‚ ç»†ç²’åº¦çš„å¯¹è±¡éƒ½å…·æœ‰è¾ƒæ¥è¿‘çš„å¤–éƒ¨çŠ¶æ€ï¼Œè€Œä¸”å†…éƒ¨çŠ¶æ€ä¸ç¯å¢ƒæ— å…³ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹è±¡æ²¡æœ‰ç‰¹å®šèº«ä»½ã€‚ éœ€è¦ç¼“å†²æ± çš„åœºæ™¯ã€‚ æ³¨æ„äº‹é¡¹å½“å¯¹è±¡æ± çš„å¯¹è±¡å¤ªå°‘æ—¶ï¼Œä¼šå‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„ç°è±¡ã€‚ æœ€ä½³å®è·µäº«å…ƒæ¨¡å¼åœ¨Java APIä¸­ä¹Ÿæ˜¯éšå¤„å¯è§çš„ï¼Œæ¯”å¦‚Stringç±»çš„internæ–¹æ³•å°±æ˜¯åˆ©ç”¨äº†Stringçš„å¯¹è±¡æ± ã€‚å½“ç„¶å¯¹è±¡æ± ä¸»è¦è§£å†³å¤ç”¨ï¼Œè€Œäº«å…ƒæ¨¡å¼ä¸»è¦è§£å†³å¯¹è±¡çš„å…±äº«é—®é¢˜ï¼Œå¦‚æœå»ºç«‹å¤šä¸ªå¯å…±äº«çš„ç»†ç²’åº¦å¯¹è±¡æ˜¯å…¶å…³æ³¨çš„é‡ç‚¹ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è§£é‡Šå™¨æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F18%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ— è®ºæ˜¯ç¼–è¯‘åŸç†ï¼Œè¿˜æ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œéƒ½ä¼šæ¶‰åŠåˆ°è§£é‡Šï¼Œå…¶æ€æƒ³ä¹Ÿéƒ½å’Œè§£é‡Šå™¨æ¨¡å¼ç±»ä¼¼ã€‚ å®šä¹‰ç»™å®šä¸€é—¨è¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç»„è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¯¥è§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚â€”â€”è¡Œä¸ºç±» è§£é‡Šå™¨æ¨¡å¼çš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š è¿™é‡Œè§£é‡Šä¸€ä¸‹ç±»å›¾ä¸­çš„è§’è‰²: AbstractExpressionæŠ½è±¡è§£é‡Šå™¨ï¼šå…·ä½“çš„å³æ—¶ä»»åŠ¡åˆå„ä¸ªå®ç°ç±»å®Œæˆï¼Œå…·ä½“çš„è§£é‡Šå™¨åˆ†åˆ«ç”±TerminalExpressionï¼ˆå€¼ï¼‰å’ŒNotermianlExpressionï¼ˆç¬¦å·ï¼‰å®Œæˆã€‚ TerminalExpressionç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼šå®ç°ä¸æ–‡æ³•ä¸­çš„å…ƒç´ ç›¸å…³è”çš„è§£é‡Šæ“ä½œï¼Œé€šå¸¸ä¸€ä¸ªè§£é‡Šå™¨æ¨¡å¼ä¸­åªæœ‰ä¸€ä¸ªç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼Œä½†æ˜¯æœ‰å¤šä¸ªå®ä¾‹ï¼Œå¯¹åº”ä¸åŒçš„ç»ˆç»“ç¬¦ã€‚ NotermianlExpressionéç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼šæ–‡æ³•ä¸­çš„æ¯æ¡è§„åˆ™å¯¹åº”äºä¸€ä¸ªéç»ˆç»“è¡¨è¾¾å¼ã€‚ Contextç¯å¢ƒè§’è‰²ï¼šå­˜æ”¾æ•°æ® è§£é‡Šå™¨æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°‘ç”¨çš„æ¨¡å¼ï¼Œä»¥ä¸‹ä¸ºå…¶é€šç”¨æºç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041// æŠ½è±¡è¡¨è¾¾å¼public abstract class Expression &#123; // æ¯ä¸ªè¡¨è¾¾å¼å¿…é¡»æœ‰ä¸€ä¸ªè§£é‡Šä»»åŠ¡ public abstract Object interpreter(Context ctx);&#125;// ç»ˆç»“ç¬¦è¡¨è¾¾å¼public class TerminalExpression extends Expression &#123; // é€šå¸¸ç»ˆç»“ç¬¦è¡¨è¾¾å¼åªæœ‰ä¸€ä¸ªï¼Œä½†æ˜¯æœ‰å¤šä¸ªå¯¹è±¡ public Object interpreter(Context ctx) &#123; // ä¸»è¦å¤„ç†åœºæ™¯å…ƒç´ å’Œæ•°æ®çš„è½¬æ¢ return null; &#125;&#125;// éç»ˆç»“ç¬¦è¡¨è¾¾å¼public class NotermianlExpression extends Expression &#123; // æ¯ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼éƒ½ä¼šå¯¹å…¶ä»–è¡¨è¾¾å¼äº§ç”Ÿä¾èµ– public NotermianlExpression(Expression... expression) &#123;&#125; public Object interpreter(Context ctx) &#123; // è¿›è¡Œæ–‡æ³•å¤„ç† return null; &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; Context ctx = new Context(); // é€šå¸¸å®šä¸€ä¸ªè¯­æ³•å®¹å™¨ï¼Œå®¹çº³ä¸€ä¸ªå…·ä½“çš„è¡¨è¾¾å¼ï¼Œé€šå¸¸ä¸ºListArrayã€LinkedListã€Stackç­‰å®¹å™¨ Stack&lt;Expression&gt; stack = null; for(;;) &#123; // è¿›è¡Œè¯­æ³•åˆ¤æ–­ï¼Œå¹¶äº§ç”Ÿé€’å½’è°ƒç”¨ &#125; // äº§ç”Ÿä¸€ä¸ªå®Œæ•´çš„è¯­æ³•æ ‘ï¼Œç”±å„ä¸ªå…·ä½“çš„è¯­æ³•åˆ†æè¿›è¡Œè§£æ Expression exp = stack.pop(); // å…·ä½“å…ƒç´ è¿›å…¥åœºæ™¯ exp.interpreter(ctx); &#125;&#125; é€šå¸¸Clientæ˜¯ä¸€ä¸ªå°è£…ç±»ï¼Œå°è£…çš„ç»“æœå°±æ˜¯ä¼ é€’è¿›æ¥çš„è§„èŒƒè¯­æ³•æ–‡ä»¶ï¼Œè§£é‡Šå™¨åˆ†æåäº§ç”Ÿç»“æœå¹¶è¿”å›ï¼Œé¿å…äº†è°ƒç”¨è€…ä¸è¯­æ³•è§£æå™¨çš„è€¦åˆå…³ç³»ã€‚ åº”ç”¨ä¼˜ç‚¹è§£é‡Šå™¨æ˜¯ä¸€ä¸ªç®€å•è¯­æ³•åˆ†æå·¥å…·ï¼Œå®ƒæœ€æ˜¾è‘—çš„æœ‰ç‚¹å°±æ˜¯æ‰©å±•æ€§ï¼Œä¿®æ”¹è¯­æ³•è§„åˆ™åªè¦ä¿®æ”¹ç›¸åº”çš„éç»ˆç»“ç¬¦è¡¨è¾¾å¼å°±å¯ä»¥äº†ï¼Œè‹¥æ‰©å±•è¯­æ³•ï¼Œåˆ™åªè¦å¢åŠ éç»ˆç»“ç¬¦ç±»å°±å¯ä»¥äº†ã€‚ ç¼ºç‚¹ è§£é‡Šå™¨æ¨¡å¼ä¼šå¼•èµ·ç±»è†¨èƒ€ï¼ˆæ˜¾è€Œæ˜“è§ï¼‰ è§£é‡Šå™¨é‡‡ç”¨é€’å½’è°ƒç”¨æ–¹æ³•ï¼Œè°ƒè¯•å¤æ‚ï¼Œä¸”å½±å“æ•ˆç‡ã€‚ ä½¿ç”¨åœºæ™¯ é‡å¤å‘ç”Ÿçš„é—®é¢˜å¯ä»¥ä½¿ç”¨è§£é‡Šå™¨æ¨¡å¼ï¼Œå¦‚å¯¹ä¸åŒçš„æ—¥å¿—æ–‡ä»¶è¿›è¡Œä¸åŒçš„åˆ†æã€‚ ä¸€ä¸ªç®€å•è¯­æ³•éœ€è¦è§£é‡Šçš„åœºæ™¯ã€‚ æ³¨æ„äº‹é¡¹å°½é‡ä¸è¦åœ¨é‡è¦çš„æ¨¡å—ä¸­ä½¿ç”¨è§£é‡Šå™¨æ¨¡å¼ï¼Œå¦åˆ™ç»´æŠ¤å›äº‹ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ã€‚ æœ€ä½³å®è·µè§£é‡Šå™¨æ¨¡å¼åœ¨å®é™…çš„ç³»ç»Ÿå¼€å‘ä¸­ä½¿ç”¨å¾—éå¸¸å°‘ï¼Œå› ä¸ºå®ƒä¼šå¼•èµ·æ•ˆç‡é—®é¢˜ã€æ€§èƒ½ä»¥åŠç»´æŠ¤ç­‰é—®é¢˜ï¼Œä¸€èˆ¬åœ¨å¤§ä¸­å‹çš„æ¡†æ¶å‹é¡¹ç›®èƒ½å¤Ÿæ‰¾åˆ°å®ƒçš„èº«å½±ï¼Œå¦‚ä¸€äº›æ•°æ®åˆ†æå·¥å…·ã€æŠ¥è¡¨è®¾è®¡å·¥å…·ã€ç§‘å­¦è®¡ç®—å·¥å…·ç­‰ï¼Œè‹¥ä½ ç¡®å®é‡åˆ°â€œä¸€ç§ç‰¹å®šç±»å‹çš„é—®é¢˜å‘ç”Ÿçš„é¢‘ç‡è¶³å¤Ÿé«˜â€çš„æƒ…å†µä¸‹ï¼Œå‡†å¤‡ä½¿ç”¨è§£é‡Šå™¨æ¨¡å¼æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä¸€ä¸‹Expression4Jã€MESPã€Jepç­‰å¼€å…ƒçš„è§£æå·¥å…·åŒ…ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”çŠ¶æ€æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F18%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šçŠ¶æ€ï¼ˆä¸€ä¸ªå˜é‡ï¼‰å˜åŒ–äº†ï¼Œç„¶åå°±ä¼šå‡ºç°ä¸åŒçš„è¡Œä¸ºï¼Œè¿™å°±æ˜¯å¯¹çŠ¶æ€æ¨¡å¼æœ€ç®€å•çš„ç†è§£ï¼Œå½“ç„¶å®ƒè¿˜æœ‰å¾ˆå¤šçº¦æŸã€‚ å®šä¹‰å½“ä¸€ä¸ªå¯¹è±¡å†…åœ¨çŠ¶æ€æ”¹å˜æ—¶å…è®¸å…¶ä»–æ”¹å˜è¡Œä¸ºï¼Œè¿™ä¸ªå¯¹è±¡çœ‹èµ·æ¥åƒæ”¹å˜å…¶ç±»ã€‚â€”â€”è¡Œä¸ºç±» çŠ¶æ€æ¨¡å¼çš„æ ¸å¿ƒæ˜¯å°è£…ï¼ŒçŠ¶æ€çš„å˜æ›´å¼•èµ·äº†è¡Œä¸ºçš„å˜æ›´ï¼Œä»å¤–éƒ¨å¼€èµ·æ¥å°±å¥½åƒè¿™ä¸ªå¯¹è±¡å¯¹åº”çš„ç±»å‘ç”Ÿäº†æ”¹å˜ä¸€æ ·ï¼ŒçŠ¶æ€æ¨¡å¼çš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š ç®€å•ä»‹ç»ç±»å›¾ä¸­çš„3ä¸ªè§’è‰² StateæŠ½è±¡çŠ¶æ€è§’è‰²ï¼šè´Ÿè´£å¯¹è±¡çš„çŠ¶æ€çš„å®šä¹‰ï¼Œå¹¶ä¸”å°è£…ç¯å¢ƒè§’è‰²ä»¥å®ç°çŠ¶æ€çš„åˆ‡æ¢ã€‚ ConcreteStateå…·ä½“å¯¹è±¡çŠ¶æ€å®šä¹‰ï¼šæ¯ä¸ªå…·ä½“çŠ¶æ€å¿…é¡»å®Œæˆä¸¤ä¸ªèŒè´£ï¼šæœ¬çŠ¶æ€çš„è¡Œä¸ºç®¡ç†ä»¥åŠè¶‹å‘çŠ¶æ€å¤„ç†ã€‚ Contextç¯å¢ƒè§’è‰²ï¼šå®šä¹‰å®¢æˆ·ç«¯éœ€è¦çš„æ¥å£ï¼Œå¹¶ä¸”è´Ÿè´£å…·ä½“çŠ¶æ€çš„åˆ‡æ¢ã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨æºç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182// æŠ½è±¡çŠ¶æ€è§’è‰²public abstract class State &#123; // å®šä¹‰ä¸€ä¸ªç¯å¢ƒè§’è‰²ï¼Œæä¾›å­ç±»è®¿é—® protected Context context; // è®¾ç½®ç¯å¢ƒè§’è‰² public void setContext(Context _context) &#123; this.context = _context; &#125; // è¡Œä¸º1 public abstract void handle1(); // è¡Œä¸º2 public abstract void handle2();&#125;// å…·ä½“çŠ¶æ€è§’è‰²public alass concreteState1 extends State &#123; @Override public void handle1() &#123; // æœ¬çŠ¶æ€ä¸‹å¿…é¡»å¤„ç†çš„é€»è¾‘ &#125; @Override public void handle2() &#123; // è®¾ç½®å½“å‰çŠ¶æ€ä¸ºstate2 super.context.setCurrentState(Context.STATE2); // è¿‡åº¦åˆ°state2çŠ¶æ€ï¼Œç”±Contextå®ç° super.context.handle2(); &#125;&#125;public alass concreteState2 extends State &#123; @Override public void handle2() &#123; // æœ¬çŠ¶æ€ä¸‹å¿…é¡»å¤„ç†çš„é€»è¾‘ &#125; @Override public void handle1() &#123; // è®¾ç½®å½“å‰çŠ¶æ€ä¸ºstate1 super.context.setCurrentState(Context.STATE1); // è¿‡åº¦åˆ°state1çŠ¶æ€ï¼Œç”±Contextå®ç° super.context.handle1(); &#125;&#125;// ç¯å¢ƒè§’è‰²ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ä¸¤ä¸ªä¸æˆæ–‡çš„çº¦æŸï¼š// 1. æŠŠçŠ¶æ€å¯¹è±¡å£°æ˜ä¸ºé™æ€å˜é‡ï¼Œæœ‰å‡ ä¸ªçŠ¶æ€å¯¹è±¡å°±å£°æ˜å‡ ä¸ªé™æ€å˜é‡// 2. ç¯å¢ƒè§’è‰²å…·æœ‰çŠ¶æ€æŠ½è±¡è§’è‰²å®šä¹‰çš„æ‰€æœ‰è¡Œä¸ºï¼Œå…·ä½“æ‰§è¡Œä½¿ç”¨å§”æ‰˜æ–¹å¼public class Context &#123; // å®šä¹‰çŠ¶æ€ public final static State STATE1 = new ConcreteState1(); public final static State STATE2 = new ConcreteState2(); // å½“å‰çŠ¶æ€ private State currentState; // è·å¾—å½“å‰çŠ¶æ€ public State getCurrentState() &#123; returncurrentState; &#125; // è®¾ç½®å½“å‰çŠ¶æ€ public void setCurrentState(State currentState) &#123; this.currentState = currentState; // åˆ‡æ¢çŠ¶æ€, é‡è¦ this.currentState.setContext(this); // è¡Œä¸ºå§”æ‰˜, é‡è¦ public void handle1() &#123; this.currentState.handle1(); &#125; public void handle2() &#123; this.currentState.handle2(); &#125; &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å®šä¹‰ç¯å¢ƒè§’è‰² Context context = new Context(); // åˆå§‹åŒ–çŠ¶æ€ context.setCurrentState(new ConcreteState1()); // è¡Œä¸ºæ‰§è¡Œ context.handle1(); context.handle2(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ ç»“æ„æ¸…æ™°ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ éµå¾ªè®¾è®¡åŸåˆ™ï¼Œå¾ˆå¥½ä½“ç°äº†å¼€é—­åŸåˆ™å’Œå•ä¸€èŒè´£åŸåˆ™ã€‚ å°è£…æ€§éå¸¸å¥½ï¼Œå°†çŠ¶æ€å˜åŒ–æ”¾ç½®åˆ°ç±»çš„å†…éƒ¨æ¥å®ç°ï¼Œå¤–éƒ¨çš„è°ƒç”¨ä¸ç”¨çŸ¥é“ç±»å†…éƒ¨å¦‚ä½•å®ç°çŠ¶æ€å’Œè¡Œä¸ºçš„å˜æ¢ã€‚ ç¼ºç‚¹åªæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ä¼šéšç€çŠ¶æ€çš„å¢å¤šä¼šå‡ºç°ç±»è†¨èƒ€ã€‚ ä½¿ç”¨åœºæ™¯ è¡Œä¸ºéšçŠ¶æ€æ”¹å˜è€Œæ”¹å˜çš„åœºæ™¯ï¼Œå¦‚æƒé™è®¾è®¡ã€‚ æ¡ä»¶ã€åˆ†æ”¯åˆ¤æ–­è¯­å¥çš„æ›¿ä»£è€…ã€‚ æ³¨æ„äº‹é¡¹çŠ¶æ€æ¨¡å¼é€‚ç”¨äºå½“æŸä¸ªå¯¹è±¡åœ¨å®ƒçš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå®ƒçš„è¡Œä¸ºä¹Ÿéšç€å‘ç”Ÿæ¯”è¾ƒå¤§çš„å˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¡Œä¸ºå—çŠ¶æ€çº¦æŸçš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨çŠ¶æ€æ¨¡å¼ï¼Œè€Œä¸”ä½¿ç”¨æ—¶å¯¹è±¡çš„çŠ¶æ€æœ€å¥½ä¸è¦è¶…è¿‡5ä¸ªã€‚ æœ€ä½³å®è·µçŠ¶æ€æ¨¡å¼å…¶å®ç»å¸¸ä¼šé‡åˆ°ï¼Œå› ä¸ºåŸºæœ¬ä¸Šéƒ½ä¼šé‡åˆ°çŠ¶æ€çš„åˆ‡æ¢ã€‚å¯¹äºçŠ¶æ€é¡ºåºçš„ä¸åŒç»„æˆä¸åŒçš„çŠ¶æ€å˜åŒ–çº¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è®¿é—®è€…æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F15%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸€ä¸ªå¯¹è±¡ç»“æ„åŒ…å«å¾ˆå¤šç±»å¯¹è±¡ï¼Œä»–ä»¬åˆæœ‰ä¸åŒçš„æ¥å£ï¼Œè€Œä½ æƒ³å¯¹è¿™äº›å¯¹è±¡å®æ–½ä¸€äº›ä¾èµ–äºå…¶å…·ä½“ç±»çš„æ“ä½œï¼Œæ¥å¯ä»¥ä½¿ç”¨è®¿é—®è€…æ¨¡å¼ã€‚ å®šä¹‰å°è£…ä¸€äº›ä½œç”¨äºæŸç§æ•°æ®ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œï¼Œå®ƒå¯ä»¥åœ¨ä¸æ”¹å˜æ•°æ®ç»“æ„çš„å‰æä¸‹å®šä¹‰ä½œç”¨ä¸è¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚â€”â€”è¡Œä¸ºç±» å®ƒçš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š æˆ‘ä»¬çœ‹çœ‹ç±»å›¾ä¸­å‡ ä¸ªè§’è‰²çš„èŒè´£ï¼š VisitoræŠ½è±¡è®¿é—®è€…ï¼šå£°æ˜è®¿é—®è€…å¯ä»¥è®¿é—®å“ªäº›å…ƒç´ ï¼Œå…·ä½“åˆ°ç¨‹åºæ‰¾é‚£ä¸ªå°±æ˜¯visitæ–¹æ³•çš„å‚æ•°å®šä¹‰å“ªäº›å¯¹è±¡æ˜¯å¯ä»¥è¢«è®¿é—®çš„ã€‚ ConcreteVisitorå…·ä½“è®¿é—®è€…ï¼šå®ƒå½±å“è®¿é—®è€…è®¿é—®åˆ°ä¸€ä¸ªç±»åè¯¥æ€ä¹ˆå¹²ï¼Œè¦åšä»€ä¹ˆäº‹æƒ…ã€‚ ElementæŠ½è±¡å…ƒç´ ï¼šå£°æ˜æ¥å—å“ªä¸€ç±»è®¿é—®è€…è®¿é—®ï¼Œç¨‹åºä¸Šæ˜¯é€šè¿‡acceptæ–¹æ³•ä¸­çš„å‚æ•°æ¥å®šä¹‰çš„ã€‚ ConcreteElementå…·ä½“å…ƒç´ ï¼šå®ç°acceptæ–¹æ³•ï¼Œé€šå¸¸æ˜¯visitor.visit(this)ï¼ŒåŸºæœ¬éƒ½å½¢æˆäº†ä¸€ç§æ¨¡å¼äº†ã€‚ ObjectStrutureç»“æ„å¯¹è±¡ï¼šå…ƒç´ äº§ç”Ÿè€…ï¼Œä¸€èˆ¬å®¹çº³åœ¨å¤šä¸ªä¸åŒç±»ï¼Œä¸åŒæ¥å£çš„å®¹å™¨ï¼Œå¦‚Listï¼ŒSetï¼ŒMapç­‰ï¼Œåœ¨é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬å¾ˆå¥½æŠ½è±¡å‡ºè¿™ä¸ªè§’è‰²ã€‚ æ¥ç€çœ‹çœ‹å…·ä½“çš„é€šç”¨æºç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273// æŠ½è±¡å…ƒç´ public abstract class Element &#123; // å®šä¹‰ä¸šåŠ¡é€»è¾‘ public abstract void doSomething(); // å…è®¸è°æ¥è®¿é—® public abstract void accept(Ivisitor visitor);&#125;// å…·ä½“å…ƒç´ public class ConcreteElement1 extends Element &#123; // å®Œå–„ä¸šåŠ¡é€»è¾‘ public void doSomething() &#123; // ä¸šåŠ¡å¤„ç† &#125; // å…è®¸å“ªä¸ªè®¿é—®è€…è®¿é—® public void accept(Ivisitor visitor) &#123; visitor.visit(this); &#125;&#125;public class ConcreteElement2 extends Element &#123; // å®Œå–„ä¸šåŠ¡é€»è¾‘ public void doSomething() &#123; // ä¸šåŠ¡å¤„ç† &#125; // å…è®¸å“ªä¸ªè®¿é—®è€…è®¿é—® public void accept(Ivisitor visitor) &#123; visitor.visit(this); &#125;&#125;// æŠ½è±¡è®¿é—®è€…public interface Ivisitor &#123; // å¯ä»¥è®¿é—®å“ªäº›å¯¹è±¡ public void visitor (ConcreteElement1 el1); public void visitor (ConcreteElement2 el2);&#125;// å…·ä½“è®¿é—®è€…public class Visitor implements Ivisitor &#123; // è®¿é—®el1å…ƒç´  public void visit(ConcreteElement1 el1) &#123; el1.doSomething; &#125; // è®¿é—®el2å…ƒç´  public void visit(ConcreteElement2 el2) &#123; el2.doSomething(); &#125;&#125;// ç»“æ„å¯¹è±¡ äº§ç”Ÿä¸åŒçš„å…ƒç´ å¯¹è±¡ï¼Œå¯ä»¥ç”¨å·¥å‚æ–¹å¼æ¨¡å¼æ¨¡æ‹Ÿpublic class ObjectStruture &#123; // å¯¹è±¡ç”Ÿæˆå™¨ï¼Œé€šè¿‡å·¥å‚æ–¹æ³•æ¨¡å¼æ¨¡æ‹Ÿ public static Element createElement() &#123; Random random = new Random(); if(random.nextInt(100) &gt;50) &#123; return new ConcreteElement1(); &#125; else &#123; return new ConcreteElement2(); &#125; &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; for(int i = 0; i&lt;10; i++) &#123; // è·å–å…ƒç´ å¯¹è±¡ Element el = ObjectStruture.createElement(); // æ¥å—è®¿é—®è€…è®¿é—® el.accept(new Visitor()); &#125; &#125;&#125; åº”ç”¨ä¼˜ç‚¹ ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚å…·ä½“å…ƒç´ è§’è‰²è´Ÿè´£æ•°æ®çš„åŠ è½½ï¼Œè®¿é—®è€…ç±»è´Ÿè´£æŠ¥è¡¨çš„å±•ç°ï¼ŒèŒè´£æ˜ç¡®ã€‚ ä¼˜ç§€çš„æ‰©å±•æ€§ã€‚æŠ¥è¡¨ä¸åŒåªéœ€è¦ä¿®æ”¹visitæ–¹æ³•ã€‚ çµæ´»æ€§éå¸¸é«˜ã€‚ ç¼ºç‚¹ å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œä¸ç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™ã€‚ å…·ä½“å…ƒç´ å˜æ›´æ¯”è¾ƒå›°éš¾ã€‚ è¿èƒŒäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œè®¿é—®è€…ä¾èµ–çš„æ˜¯å…·ä½“å…ƒç´ ï¼Œè€Œä¸æ˜¯æŠ½è±¡å…ƒç´ ã€‚ ä½¿ç”¨åœºæ™¯ ä¸€ä¸ªå¯¹è±¡ç»“æ„åŒ…å«å¾ˆå¤šç±»å¯¹è±¡ï¼Œä»–ä»¬åˆæœ‰ä¸åŒçš„æ¥å£ï¼Œè€Œä½ æƒ³å¯¹è¿™äº›å¯¹è±¡å®æ–½ä¸€äº›ä¾èµ–äºå…¶å…·ä½“ç±»çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨è¿­ä»£å™¨æ¨¡å¼å·²ç»ä¸èƒ½èƒœä»»çš„æƒ…æ™¯ã€‚ éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œä¸åŒå¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œä½ æƒ³é¿å…è®©è¿™äº›æ“ä½œâ€œæ±¡æŸ“â€è¿™äº›å¯¹è±¡çš„ç±»ã€‚ æ€»ç»“ï¼šåœ¨è¿™ç§åœ°æ–¹ä¸€å®šè¦è€ƒè™‘ä½¿ç”¨è®¿é—®è€…æ¨¡å¼ï¼šä¸šåŠ¡è§„åˆ™è¦æ±‚éå†å¤šä¸ªä¸åŒçš„å¯¹è±¡ï¼Œè¿­ä»£å™¨åªèƒ½è®¿é—®åŒç±»æˆ–åŒæ¥å£çš„æ•°æ®ï¼Œè€Œè®¿é—®è€…æ¨¡å¼æ˜¯å¯¹è¿­ä»£å™¨æ¨¡å¼çš„æ‰©å……ï¼Œå¯ä»¥éå†ä¸åŒçš„å¯¹è±¡ï¼Œç„¶åæ‰§è¡Œä¸åŒçš„æ“ä½œã€‚è®¿é—®è€…æ¨¡å¼è¿˜å¯ä»¥å……å½“æ‹¦æˆªå™¨çš„è§’è‰²ã€‚ æœ€ä½³å®è·µè®¿é—®è€…æ¨¡å¼ä¸€ç§é›†ä¸­è§„æ•´æ¨¡å¼ï¼Œç‰¹åˆ«é€‚ç”¨äºå¤§è§„æ¨¡é‡æ„çš„é¡¹ç›®ã€‚é€šè¿‡è®¿é—®è¿™ä¹ˆæ¬§å¼å¯ä»¥å¾ˆå®¹æ˜“å§ä¸€äº›è¿›è¡Œæ¢³ç†ï¼Œè¾¾åˆ°æœ€ç»ˆç›®çš„â€”â€”åŠŸèƒ½é›†ä¸­åŒ–ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å¤‡å¿˜å½•æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F14%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼š å¤‡å¿˜å½•æ¨¡å¼æ˜¯æˆ‘ä»¬è®¾è®¡ä¸Šçš„â€œæœˆå…‰å®ç›’â€ï¼Œå¯ä»¥è®©æˆ‘ä»¬å›åˆ°éœ€è¦çš„å¹´ä»£ï¼›æ˜¯ç¨‹åºæ•°æ®çš„â€œåæ‚”è¯â€ï¼Œåƒäº†å®ƒå°±å¯ä»¥è¿”å›ä¸Šä¸€ä¸ªçŠ¶æ€ï¼›æ˜¯è®¾è®¡äººå‘˜çš„å®šå¿ƒä¸¸ï¼Œç¡®ä¿å³ä½¿åœ¨æœ€åçš„æƒ…å†µä¸‹ä¹Ÿèƒ½è·å¾—æœ€è¿‘çš„å¯¹è±¡çŠ¶æ€ã€‚ å®šä¹‰å¤‡å¿˜å½•æ¨¡å¼æä¾›äº†ä¸€ç§å¼¥è¡¥çœŸå®ä¸–ç•Œç¼ºé™·çš„æ–¹æ³•ï¼Œè®©â€œåæ‚”è¯â€åœ¨ç¨‹åºçš„ä¸–ç•Œä¸­çœŸå®å¯è¡Œï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨æ”¹å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œè¿™æ ·ä»¥åå°±å¯å°†è¯¥å¯¹è±¡çš„æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚â€”â€”è¡Œä¸ºç±» å¤‡å¿˜å½•æ¨¡å¼å°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¤‡ä»½æ¨¡å¼ï¼Œæä¾›äº†ä¸€ç§ç¨‹åºæ•°æ®çš„å¤‡ä»½æ–¹æ³•ï¼Œå…¶é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š ä¸‹é¢ç®€å•ä»‹ç»ç±»å›¾ä¸­çš„å‡ ä¸ªè§’è‰²ï¼š Originatorå‘èµ·äººè§’è‰²ï¼šè®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ï¼Œè´Ÿè´£å®šä¹‰å“ªäº›å±äºå¤‡ä»½èŒƒå›´çš„çŠ¶æ€ï¼Œè´Ÿè´£åˆ›å»ºå’Œæ¢å¤å¤‡å¿˜å½•æ•°æ®ã€‚ Mementoå¤‡å¿˜å½•è§’è‰²ï¼šè´Ÿè´£å­˜å‚¨Originatorå‘èµ·äººå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æä¾›å‘èµ·äººéœ€è¦çš„å†…éƒ¨çŠ¶æ€ã€‚ Caretakerå¤‡å¿˜å½•ç®¡ç†å‘˜è§’è‰²ï¼šå¯¹å¤‡å¿˜å½•è¿›è¡Œç®¡ç†ï¼Œä¿å­˜å’Œæä¾›å¤‡å¿˜å½•ã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨æºä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162// å‘èµ·äººè§’è‰²public class Originate &#123; // å†…éƒ¨çŠ¶æ€ private String state = ""; public String getState() &#123; return state; &#125; public void setState(String state) &#123; this.state = state; &#125; // åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½• public Memento createMemento() &#123; return new Memento(this.state); &#125; // æ¢å¤ä¸€ä¸ªå¤‡å¿˜å½• public void restoreMemento(Memento _memento) &#123; this.setState(_memento.getState()); &#125;&#125;// å¤‡å¿˜å½•è§’è‰²public class Memento &#123; // å‘èµ·äººå†…éƒ¨çŠ¶æ€ private String state = ""; // æ„é€ å‡½æ•°ä¼ é€’ public Memento(String _state) &#123; this.state = _state; &#125; public String getState() &#123; return state; &#125; public void setState(String state) &#123; this.state = state; &#125;&#125;// å¤‡å¿˜å½•ç®¡ç†è€…public class CareTaker &#123; // å¤‡å¿˜å½•å¯¹è±¡ private Memento memento; public Memento getMemento() &#123; return memento; &#125; public void setMemento(Memento memento) &#123; this.memento = memento; &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å®šä¹‰å‘èµ·äºº Originator originator = new Originator(); // å®šä¹‰å‡ºå¤‡å¿˜å½•ç®¡ç†å‘˜ Caretaker caretaker = new Caretaker(); // åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½• caretaker.setMemento(originator.createMemento()); // æ¢å¤ä¸€ä¸ªå¤‡å¿˜å½• originator.restoreMemento(caretaker.getMemento()); &#125;&#125; åº”ç”¨ä½¿ç”¨åœºæ™¯ éœ€è¦ä¿å­˜å’Œæ¢å¤æ•°æ®çš„ç›¸å…³çŠ¶æ€åœºæ™¯ã€‚ æä¾›ä¸€ä¸ªå¯å›æ»šçš„æ“ä½œã€‚ éœ€è¦ç›‘æ§çš„å‰¯æœ¬åœºæ™¯ã€‚ æ•°æ®åº“è¿æ¥çš„äº‹åŠ¡ç®¡ç†å°±æ˜¯ç”¨çš„å¤‡å¿˜å½•æ¨¡å¼ã€‚ æ³¨æ„äº‹é¡¹ å¤‡å¿˜å½•çš„ç”Ÿå‘½å‘¨æœŸ å¤‡å¿˜å½•åˆ›å»ºå‡ºæ¥å°±è¦åœ¨â€œæœ€è¿‘â€çš„ä»£ç ä¸­ä½¿ç”¨ï¼Œè¦ä¸»åŠ¨ç®¡ç†å®ƒçš„ç”Ÿå‘½å‘¨æœŸï¼Œå»ºç«‹å°±è¦ä½¿ç”¨ï¼Œä¸ä½¿ç”¨å°±è¦ç«‹åˆ»åˆ é™¤å…¶å¼•ç”¨ï¼Œç­‰å¾…åƒåœ¾å›æ”¶å™¨å¯¹å®ƒçš„å›æ”¶å¤„ç†ã€‚ å¤‡å¿˜å½•æ€§èƒ½ ä¸è¦åœ¨é¢‘ç¹å»ºç«‹å¤‡ä»½çš„åœºæ™¯ä¸­ä½¿ç”¨å¤‡å¿˜å½•æ¨¡å¼ï¼ŒåŸå› æœ‰è€Œï¼šä¸€æ˜¯æ§åˆ¶ä¸äº†å¤‡å¿˜å½•å»ºç«‹çš„å¯¹è±¡æ•°é‡ï¼›äºŒæ˜¯å¤§å¯¹è±¡çš„å»ºç«‹æ˜¯è¦æ¶ˆè€—èµ„æºçš„ï¼Œç³»ç»Ÿçš„æ€§èƒ½éœ€è¦è€ƒè™‘ã€‚ æ‰©å±•cloneæ–¹å¼çš„å¤‡å¿˜å½•å‘èµ·äººè§’è‰²èå…¥äº†å‘èµ·äººè§’è‰²å’Œå¤‡ä»½è·¯è§’è‰²ï¼Œåˆ©ç”¨clone()æ–¹æ³•å…‹éš†å‡ºæ¥çš„å¯¹è±¡å……å½“å¤‡å¿˜å½•å¯¹è±¡ã€‚ä½†æ˜¯ç”±äºå­˜åœ¨æ·±æ‹·è´å’Œæµ…æ‹·è´çš„é—®é¢˜ï¼Œåœ¨å¤æ‚çš„åœºæ™¯ä¸‹å®ƒä¼šè®©ä½ çš„ç¨‹åºé€»è¾‘å¼‚å¸¸æ··ä¹±ï¼Œå› æ­¤Cloneæ–¹å¼çš„å¤‡å¿˜å½•æ¨¡å¼é€‚ç”¨äºæ¯”è¾ƒç®€å•çš„åœºæ™¯ã€‚ å¤šçŠ¶æ€çš„å¤‡å¿˜å½•æ¨¡å¼å°†å¤šä¸ªçŠ¶æ€è½¬æ¢åˆ°HashMapä¸­ï¼Œæ–¹ä¾¿å¤‡å¿˜å½•è§’è‰²å­˜å‚¨ã€‚ å¤šå¤‡ä»½çš„å¤‡å¿˜å½•å°†å¤‡ä»½çš„æ•°æ®å­˜å…¥åˆ°HashMapä¸­ï¼Œå¹¶ç»™æ¯ä¸ªä¸åŒçš„å¤‡ä»½ä¸€ä¸ªä¸åŒçš„keyã€‚ æœ€ä½³å®è·µå¤§å®¶ä¸»è¦çš„è¿˜æ˜¯è®°ä½æ•°æ®åº“çš„äº‹åŠ¡ç”¨çš„æ˜¯å¤‡å¿˜å½•æ¨¡å¼å°±å¥½äº†ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”é—¨é¢æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F13%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ€æ ·ä¿è¯â€œé‡‘ç‰å…¶å¤–ï¼Œè´¥çµ®å…¶ä¸­â€ï¼Œé—¨é¢æ¨¡å¼å¯ä»¥è¾¾åˆ°ä½ çš„è¦æ±‚ï¼ å®šä¹‰è¦æ±‚ä¸€ä¸ªå­ç³»ç»Ÿçš„å¤–éƒ¨ä¸å…¶å†…éƒ¨çš„é€šä¿¡å¿…é¡»é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å¯¹è±¡è¿›è¡Œã€‚é—¨é¢æ¨¡å¼æä¾›ä¸€ä¸ªé«˜å±‚æ¬¡çš„æ¥å£ï¼Œä½¿å¾—å­ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨ã€‚â€”â€”ç»“æ„ç±» é—¨é¢æ¨¡å¼æ³¨é‡ç»Ÿä¸€çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æä¾›ä¸€ä¸ªè®¿é—®å­ç³»ç»Ÿçš„æ¥å£ï¼Œé™¤äº†è¿™ä¸ªæ¥å£ä¸å…è®¸æœ‰ä»»ä½•è®¿é—®å­ç³»ç»Ÿçš„è¡Œä¸ºå‘ç”Ÿï¼Œå…¶é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š ä¸‹é¢ç®€å•ä»‹ç»ç±»å›¾ä¸­çš„ä¸¤ä¸ªè§’è‰²ï¼š Facadeé—¨é¢è§’è‰²ï¼šå®¢æˆ·ç«¯è°ƒç”¨è¿™ä¸ªè§’è‰²çš„æ–¹æ³•ï¼Œæ­¤è§’è‰²çŸ¥æ™“å­ç³»ç»Ÿçš„æ‰€æœ‰åŠŸèƒ½å’Œè´£ä»»ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ¬è§’è‰²ä¼šå°†æ‰€æœ‰ä»å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚å§”æ´¾åˆ°ç›¸åº”çš„å­ç³»ç»Ÿå»ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥è§’è‰²æ²¡æœ‰å®é™…çš„ä¸šåŠ¡é€»è¾‘ï¼Œåªæ˜¯ä¸€ä¸ªå§”æ‰˜ç±»ã€‚ Subsystem Classeså­ç³»ç»Ÿæ‰€æœ‰ç±»è§’è‰²ï¼šå¯ä»¥åŒæ—¶æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­ç³»ç»Ÿã€‚æ¯ä¸ªå­ç³»ç»Ÿéƒ½ä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç±»ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»çš„é›†åˆï¼Œå­ç³»ç»Ÿä¸çŸ¥é“é—¨é¢çš„å­˜åœ¨ã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨æºç ï¼š123456789101112131415161718192021222324252627282930313233343536// å­ç³»ç»Ÿpublic class Class A &#123; public void doSomethingA() &#123; // ä¸šåŠ¡é€»è¾‘ &#125;&#125;public class ClassB &#123; public void doSomethingB() &#123; // ä¸šåŠ¡é€»è¾‘ &#125;&#125;public class ClassC &#123; public void doSomethingC() &#123; // ä¸šåŠ¡é€»è¾‘ &#125;&#125;// é—¨é¢å¯¹è±¡public class Facade &#123; // è¢«å§”æ‰˜çš„å¯¹è±¡ private ClassA a = new ClassA(); private ClassB b = new ClassB(); private ClassC c = new ClassC(); // æä¾›ç»™å¤–éƒ¨è®¿é—®çš„æ–¹æ³• public void methodA() &#123; this.a.doSomethingA(); &#125; public void methodB() &#123; this.b.doSomethingB(); &#125; public void methodC() &#123; this.c.doSomethingC(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ å‡å°‘ç³»ç»Ÿçš„ç›¸äº’ä¾èµ–ã€‚æ‰€æœ‰çš„ä¾èµ–éƒ½æ˜¯å¯¹é—¨é¢å¯¹è±¡çš„ä¾èµ–ï¼Œä¸å­ç³»ç»Ÿæ— å…³ã€‚ æä¾›äº†çµæ´»æ€§ã€‚ä¸ç®¡å­ç³»ç»Ÿå†…éƒ¨å¦‚ä½•å˜åŒ–ï¼Œåªè¦ä¸å½±å“åˆ°é—¨é¢å¯¹è±¡ï¼Œä»»ä½ è‡ªç”±æ´»åŠ¨ã€‚ æä¾›å®‰å…¨æ€§ã€‚æƒ³è®©ä½ è®¿é—®å­ç³»ç»Ÿçš„é‚£äº›ä¸šåŠ¡å°±å¼€é€šé‚£äº›é€»è¾‘ï¼Œä¸åœ¨é—¨é¢ä¸Šå¼€é€šçš„æ–¹æ³•ï¼Œä½ ä¼‘æƒ³è®¿é—®åˆ°ã€‚ ç¼ºç‚¹é—¨é¢æ¨¡å¼æœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œæ²¡æœ‰å¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾ã€‚ ä½¿ç”¨åœºæ™¯ ä¸ºä¸€ä¸ªå¤æ‚çš„æ¨¡å—æˆ–å­ç³»ç»Ÿæä¾›ä¸€ä¸ªä¾›å¤–ç•Œè®¿é—®çš„æ¥å£ã€‚ å­ç³»ç»Ÿç›¸å¯¹ç‹¬ç«‹â€”â€”å¤–ç•Œå¯¹å­ç³»ç»Ÿçš„è®¿é—®åªè¦é»‘ç®±æ“ä½œå³å¯ã€‚ é¢„é˜²ä½æ°´å¹³äººå‘˜å¸¦æ¥çš„é£é™©æ‰©æ•£ã€‚ æ³¨æ„äº‹é¡¹ ä¸€ä¸ªç³»ç»Ÿå¯ä»¥æœ‰å¤šä¸ªé—¨é¢ã€‚æ¯”å¦‚ä¸‹é¢çš„æƒ…å†µï¼š é—¨é¢å·²ç»åºå¤§åˆ°ä¸èƒ½å¿å—çš„ç¨‹åº¦ å­ç³»ç»Ÿå¯ä»¥æä¾›ä¸åŒè®¿é—®è·¯å¾„ é—¨é¢ä¸å‚ä¸å­ç³»ç»Ÿå†…çš„ä¸šåŠ¡é€»è¾‘ã€‚ æœ€ä½³å®è·µé—¨é¢æ¨¡å¼æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å°è£…æ–¹æ³•ï¼Œå¾ˆå¤šæƒ…å†µéƒ½å¯ä»¥ä½¿ç”¨åˆ°ï¼Œå¦‚ä¸‹é¢çš„æƒ…å†µï¼š ä¸€ä¸ªå­ç³»ç»Ÿæ¯”è¾ƒå¤æ‚ï¼Œå°±å¯ä»¥å°è£…å‡ºä¸€ä¸ªæˆ–å¤šä¸ªé—¨é¢ï¼Œé¡¹ç›®ç»“æ„ç®€å•ï¼Œæ‰©å±•æ€§éå¸¸å¥½ã€‚ å¯¹äºä¸€ä¸ªæ¯”è¾ƒå¤§çš„é¡¹ç›®ï¼Œä¸ºäº†é¿å…äººå‘˜å¸¦æ¥çš„é£é™©ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é—¨é¢æ¨¡å¼ï¼ŒæŠ€æœ¯æ°´å¹³å·®çš„æˆå‘˜ï¼Œå°½é‡å®‰æ’ç‹¬ç«‹çš„æ¨¡å—ï¼Œç„¶åæŠŠä»–å†™çš„ç¨‹åºå°è£…åˆ°ä¸€ä¸ªé—¨é¢æï¼Œå°½é‡è®©å…¶ä»–é¡¹ç›®æˆå‘˜ä¸ç”¨çœ‹åˆ°è¿™äº›äººçš„ä»£ç ã€‚çœ‹ä¹Ÿçœ‹ä¸æ‡‚ï¼Œå“ˆå“ˆã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è§‚å¯Ÿè€…æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F12%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè¢«è§‚å¯Ÿè€…åšå‡ºåŠ¨ä½œäº†ï¼Œç„¶åé€šçŸ¥è§‚å¯Ÿè€…åšå‡ºååº”ã€‚è§‚å¯Ÿè€…æ¨¡å¼å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ å®šä¹‰è§‚å¯Ÿè€…æ¨¡å¼åˆç§°å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‚ å®šä¹‰å¯¹è±¡é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€ï¼Œåˆ™æ‰€æœ‰å®ƒä¾èµ–çš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚è¡Œä¸ºç±» ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ç±»å›¾ï¼š ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹ç±»å›¾ä¸­çš„å‡ ä¸ªè§’è‰²ï¼š Subjectè¢«è§‚å¯Ÿè€…ï¼šå®šä¹‰è§‚å¯Ÿè€…å¿…é¡»å®ç°çš„èŒè´£ï¼Œå®ƒå¿…é¡»èƒ½å¤ŸåŠ¨æ€åœ°å¢åŠ ã€å–æ¶ˆè§‚å¯Ÿè€…ã€‚ç®¡ç†è§‚å¯Ÿè€…å¹¶é€šçŸ¥è§‚å¯Ÿè€…ã€‚ Observerè§‚å¯Ÿè€…ï¼šè§‚å¯Ÿè€…æ¥å—åˆ°æ¶ˆæ¯åï¼Œå³è¿›è¡Œupdateæ“ä½œï¼Œå¯¹æ¥æ”¶çš„ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨æºä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// è¢«è§‚å¯Ÿè€…public abstract class Subject &#123; // å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€…æ•°ç»„ private Vector&lt;Observer&gt; observerVector = new Vector&lt;Observer&gt;(); // å¢åŠ ä¸€ä¸ªè§‚å¯Ÿè€… public void addObserver(Observer o) &#123; this.observerVector.add(o); &#125; // åˆ é™¤ä¸€ä¸ªè§‚å¯Ÿè€… public void deleteObserver(Observer 0) &#123; this.observerVector.remove(o); &#125; // é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€… public void notifyObservers() &#123; for (Observer o : this.observerVector) &#123; o.update(); &#125; &#125;&#125;// å…·ä½“è¢«è§‚å¯Ÿè€…public class ConcreteSubject extends Subject &#123; // å…·ä½“çš„ä¸šåŠ¡ public void doSomething() &#123; // do somthing super.notifyObservers(); &#125;&#125;// è§‚å¯Ÿè€…public interface Observer &#123; // æ›´æ–°æ–¹æ³• public void update();&#125;// å…·ä½“è§‚å¯Ÿè€…public class ConcreteObserver implements Observer &#123; // å®ç°æ›´æ–°æ–¹æ³• public void updatea()&#123; System.out.println("æ¥åˆ°æ¶ˆæ¯ï¼Œå¹¶è¿›è¡Œå¤„ç†"); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // åœºæ™¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€… ConcreteSubject subject = new ConcreteSubject(); // å®šä¹‰ä¸€ä¸ªè§‚å¯Ÿè€… Observer obs = new ConcreteObserver(); // è§‚å¯Ÿè€…è§‚å¯Ÿè¢«è§‚å¯Ÿè€… subject.addObserver(obs); // è§‚å¯Ÿè€…å¼€å§‹æ´»åŠ¨äº† subject.doSomething(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆçš„ï¼Œä¸ç®¡æ˜¯å¢åŠ è§‚å¯Ÿè€…éƒ½éå¸¸å®¹æ˜“æ‰©å±•ã€‚ å»ºç«‹ä¸€å¥—è§¦å‘æœºåˆ¶ã€‚å®¹æ˜“åœ¨å•ä¸€èŒè´£ä¸‹æ„å»ºä¸€æ¡è§¦å‘é“¾ã€‚ ç¼ºç‚¹è§‚å¯Ÿè€…æ¨¡å¼éœ€è¦è€ƒè™‘ä¸€ä¸‹å¼€å‘æ•ˆç‡å’Œè¿è¡Œæ•ˆç‡é—®é¢˜ï¼Œä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œå¤šä¸ªè§‚å¯Ÿè€…ï¼Œå¼€å‘å’Œè°ƒè¯•å°±ä¼šæ¯”è¾ƒå¤æ‚ï¼Œè€Œä¸”åœ¨Javaä¸­æ¶ˆæ¯çš„é€šçŸ¥é»˜è®¤æ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œä¸€ä¸ªè§‚å¯Ÿè€…å¡å£³ï¼Œä¼šå½±å“æ•´ä½“çš„æ‰§è¡Œæ•ˆç‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€èˆ¬è€ƒè™‘é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼ã€‚ ä½¿ç”¨åœºæ™¯ å…³è”è¡Œä¸ºåœºæ™¯ã€‚è¿™ç§å…³è”è¡Œä¸ºæ—¶å¯ä»¥æ‹†åˆ†çš„ã€‚ äº‹ä»¶å¤šçº§è§¦å‘åœºæ™¯ã€‚ è·¨ç³»ç»Ÿçš„æ¶ˆæ¯äº¤æ¢åœºæ™¯ï¼Œå¦‚æ¶ˆæ¯é˜Ÿåˆ—çš„å¤„ç†æœºåˆ¶ã€‚ æ³¨æ„äº‹é¡¹ å¹¿æ’­é“¾ã€‚åœ¨ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ä¸­æœ€å¤šå‡ºç°ä¸€ä¸ªå¯¹è±¡æ—¢æ˜¯è§‚å¯Ÿè€…åˆæ˜¯è¢«è§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯è¯´æ¶ˆæ¯æœ€å¤šè¢«è½¬å‘ä¸€æ¬¡ã€‚ï¼ˆå’Œè´£ä»»é“¾çš„åŒºåˆ«åœ¨äºå¹¿æ’­é“¾åœ¨æ¶ˆæ¯ä¼ æ’­è¿‡ç¨‹ä¸­æ¶ˆæ¯æ˜¯å¯å˜çš„ï¼‰ å¼‚æ­¥å¤„ç†é—®é¢˜ã€‚å¦‚æœè§‚å¯Ÿè€…æ¯”è¾ƒå¤šï¼Œå¤„ç†æ—¶é—´é•¿ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨å¼‚æ­¥ã€‚å¼‚æ­¥å¤„ç†éœ€è¦è€ƒè™‘åˆ°çº¿ç¨‹å®‰å…¨å’Œé˜Ÿåˆ—é—®é¢˜ã€‚ æ‰©å±•Javaä¸–ç•Œä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼åœ¨JDKä¸­å·²ç»æä¾›äº†java.util.Observableå®ç°ç±»ï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰ä»¥åŠjava.util.Observeræ¥å£ï¼ˆè§‚å¯Ÿè€…ï¼‰ã€‚å¤§å®¶è¦è®°ä½åœ¨javaçš„ä¸–ç•Œé‡Œæ¨ªè¡Œæ—¶ï¼Œå¤šçœ‹çœ‹APIï¼Œæœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œå¾ˆå¤šä¸œè¥¿Javaå·²ç»å¸®æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªè‰¯å¥½çš„æ¡†æ¶ã€‚ é¡¹ç›®ä¸­çœŸå®çš„è§‚å¯Ÿè€…æ¨¡å¼åœ¨ç³»ç»Ÿè®¾è®¡ä¸­ä¼šå¯¹è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œæ”¹é€ æˆ–æ”¹è£…ï¼Œä¸»è¦åœ¨ä»¥ä¸‹3ä¸ªæ–¹é¢ï¼š è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´çš„æ¶ˆæ¯æ²Ÿé€š è¢«è§‚å¯Ÿè€…çŠ¶æ€æ”¹å˜ä¼šè§¦å‘è§‚å¯Ÿè€…çš„ä¸€ä¸ªè¡Œä¸ºï¼ŒåŒæ—¶ä¼šä¼ é€’ä¸€ä¸ªæ¶ˆæ¯ç»™è§‚å¯Ÿè€…ï¼Œè¿™æ˜¯æ­£ç¡®åœ°ï¼Œä½†æ˜¯åœ¨å®é™…ä¸­ä¸€èˆ¬çš„åšæ³•æ˜¯ï¼šè§‚å¯Ÿè€…ä¸­updateæ–¹æ³•ä¼šæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯è¢«è§‚å¯Ÿè€…ï¼Œä¸€ä¸ªæ˜¯DTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰ï¼ŒDTOä¸€èˆ¬æ˜¯ä¸€ä¸ªçº¯æ´çš„JavaBeanï¼Œç”±è¢«è§‚å¯Ÿè€…ç”Ÿæˆï¼Œç”±è§‚å¯Ÿè€…æ¶ˆè´¹ã€‚ è§‚å¯Ÿè€…å“åº”æ–¹å¼ ä¸ºäº†è§£å†³è§‚å¯Ÿè€…çš„å¿«é€Ÿå“åº”æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŠæ³•ï¼š é‡‡ç”¨å¤šçº¿ç¨‹æŠ€æœ¯ ç¼“å­˜æŠ€æœ¯ï¼ˆåŒæ­¥æ¶æ„ï¼‰ è¢«è§‚å¯Ÿè€…å°½é‡è‡ªå·±åšä¸» è¢«è§‚å¯Ÿè€…çš„çŠ¶æ€æ”¹å˜ä¸ä¸€å®šè¦é€šçŸ¥è§‚å¯Ÿè€…ï¼Œæ‰€ä»¥doSomethingæ–¹æ³•å¯ä»¥è¢«é‡è½½ï¼Œå¢åŠ ä¸€ä¸ªdoSomething(boolean isNotifyObs)æ–¹æ³•ï¼Œå†³å®šæ˜¯å¦é€šçŸ¥è§‚å¯Ÿè€…ï¼Œè€Œä¸æ˜¯åœ¨æ¶ˆæ¯åˆ°è¾¾è§‚å¯Ÿå’Œæ‰åˆ¤æ–­æ˜¯å¦è¦æ¶ˆè´¹ã€‚ è®¢é˜…å‘å¸ƒæ¨¡å‹é¡¾åæ€ä¹‰å°±æ˜¯æ¶ˆæ¯çš„å‘å¸ƒè€…å‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶ååˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—é€šçŸ¥è®¢é˜…è€…åšå‡ºååº”ã€‚è¿™ç›¸å½“äºè§‚å¯Ÿè€…æ¨¡å¼çš„å‡çº§ç‰ˆã€‚ æœ€ä½³å®è·µè§‚å¯Ÿè€…æ¨¡å¼åœ¨å®é™…é¡¹ç›®ä¸­å’Œç”Ÿæ´»ä¸­éå¸¸å¸¸è§ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼š æ–‡ä»¶ç³»ç»Ÿï¼šåœ¨ä¸€ä¸ªç›®å½•ä¸‹æ–°å»ºç«‹ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªåŠ¨ä½œä¼šåŒæ—¶é€šçŸ¥ç›®å½•ç®¡ç†å™¨å¢åŠ è¯¥ç›®å½•ã€‚æ–‡ä»¶æ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œç›®å½•ç®¡ç†å™¨æ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ã€‚ å¹¿æ’­æ”¶éŸ³æœºï¼šç”µå°åœ¨å¹¿æ’­ï¼Œæ”¶éŸ³æœºåœ¨æ”¶å¬ã€‚ç”µå°æ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œæ”¶éŸ³æœºæ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ã€‚å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”ç»„åˆæ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F10%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šéƒ¨åˆ†ç±»å¯ä»¥ç»„æˆæ•´ä½“ç±»ï¼Œç„¶åæ‹¥æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œè¿™å°±æ˜¯ç»„åˆæ¨¡å¼ã€‚ å®šä¹‰å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚â€”â€”ç»“æ„ç±» ç»„åˆæ¨¡å¼ä¹Ÿå«åˆæˆæ¨¡å¼ï¼Œæœ‰æ—¶åˆå«åšéƒ¨åˆ†â€”â€”æ•´ä½“æ¨¡å¼ï¼Œä¸»è¦ç”¨æ¥æè¿°éƒ¨åˆ†å’Œæ•´ä½“çš„å…³ç³»ã€‚ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ç±»å›¾ï¼š æ¥ä¸‹æ¥ç®€å•ä»‹ç»ç±»å›¾çš„å‡ ä¸ªç±»ï¼š ComponentæŠ½è±¡æ„å»ºè§’è‰²ï¼šå®šä¹‰å‚åŠ ç»„åˆå¯¹è±¡çš„å…±æœ‰æ–¹æ³•å’Œå±æ€§ï¼Œå¯ä»¥å®šä¹‰ä¸€äº›é»˜è®¤çš„è¡Œä¸ºæˆ–å±æ€§ã€‚ Leafå¶å­æ„ä»¶ï¼šå¶å­å¯¹è±¡ï¼Œå…¶ä¸‹å†ä¹Ÿæ²¡æœ‰å…¶ä»–çš„åˆ†æ”¯ï¼Œéå†çš„æœ€å°å•ä½ã€‚ Compositeæ ‘ææ„ä»¶ï¼šæ ‘æå¯¹è±¡ï¼Œå®ƒçš„ä½œç”¨æ˜¯ç»„åˆæ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹å½¢æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨æºä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// æŠ½è±¡æ„å»ºpublic abstract class Component &#123; // ä¸ªä½“å’Œæ•´ä½“éƒ½å…·æœ‰çš„å…±äº« public void doSomething()&#123; // ç¼–å†™é€»è¾‘ä¸šåŠ¡ &#125;&#125;// æ ‘ææ„ä»¶public class Composite extends Component &#123; // æ„ä»¶å®¹å™¨ private ArrayList&lt;Component&gt; componentArrayList = new ArrayList&lt;Component&gt;(); // å¢åŠ ä¸€ä¸ªå¶å­æ„ä»¶æˆ–æ ‘ææ„ä»¶ public void add(Component component) &#123; this.componentArrayList.add(component); &#125; // åˆ é™¤ä¸€ä¸ªå¶å­æ„ä»¶æˆ–æ ‘ææ„ä»¶ public void remove(Component component) &#123; this.componentArrayList.remove(component); &#125; // è·å¾—åˆ†æ”¯ä¸‹çš„æ‰€æœ‰å¶å­æ„ä»¶å’Œæ ‘ææ„ä»¶ public ArrayList&lt;Component&gt; getChildren() &#123; return this.componentArrayList; &#125;&#125;// æ ‘å¶èŠ‚ç‚¹public class Leaf extends Component &#123; public void doSomething() &#123; // è¦†å†™çˆ¶ç±»æ–¹æ³• &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // åˆ›å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹ Composite root = new Composite(); root.doSomething(); // åˆ›å»ºä¸€ä¸ªæ ‘æèŠ‚ç‚¹ Composite branch = new Composite(); // åˆ›å»ºä¸€ä¸ªå¶å­èŠ‚ç‚¹ Leaf leaf = new Leaf(); // å»ºç«‹æ•´ä½“ root.add(branch); branch.add(leaf); &#125; // é€šè¿‡é€’å½’éå†æ ‘ public static void display(Composite root) &#123; for(Component c : root.getChildren()) &#123; if (c instanceof Leaf) &#123; c.doSomething(); &#125; else &#123; display((Composite) c); &#125; &#125; &#125;&#125; æˆ‘ä»¬å¯ä»¥ä»åœºæ™¯ç±»çœ‹å‡ºç»„åˆæ¨¡å¼ç ´åäº†ä¾èµ–å€’è½¬åŸåˆ™ï¼Œæ ‘æå’Œæ ‘å¶ç›´æ¥ä½¿ç”¨äº†å®ç°ç±»ã€‚ åº”ç”¨ä¼˜ç‚¹ é«˜å±‚æ¨¡å—è°ƒç”¨èŠ‚ç‚¹ï¼Œä¸€æ£µæ ‘æœºæ„ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯Componentã€‚ èŠ‚ç‚¹è‡ªç”±å¢åŠ ï¼Œå®¹æ˜“æ‰©å±•ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚ ç¼ºç‚¹ä¸ä¾èµ–å€’ç½®åŸåˆ™å†²çªï¼Œé™åˆ¶äº†æ¥å£çš„å½±å“èŒƒå›´ã€‚ ä½¿ç”¨åœºæ™¯ ç»´æŠ¤å’Œå±•ç¤ºéƒ¨åˆ†-æ•´ä½“å…³ç³»çš„åœºæ™¯ï¼Œå¦‚æ ‘å½¢èœå•ï¼Œæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ç®¡ç†ã€‚ ä»ä¸€ä¸ªæ•´ä½“èƒ½å¤Ÿç‹¬ç«‹å‡ºéƒ¨åˆ†æ¨¡å—æˆ–åŠŸèƒ½çš„åœºæ™¯ã€‚ æ³¨æ„äº‹é¡¹åªè¦æ˜¯æ ‘å½¢ç»“æ„æˆ–è€…ä½“ç°å±€éƒ¨å’Œæ•´ä½“çš„å…³ç³»çš„æ—¶å€™ï¼Œè¦è€ƒè™‘ç»„åˆæ¨¡å¼ã€‚ æœ€ä½³å®è·µç»„åˆæ¨¡å¼åœ¨é¡¹ç›®ä¸­åˆ°å¤„éƒ½æœ‰ï¼Œæ¯”å¦‚é¡µé¢ç»“æ„ï¼ŒXMLç»“æ„ç­‰ç­‰ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è¿­ä»£å™¨æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F08%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæèµ·è¿­ä»£å™¨ï¼Œå¤§å®¶ä¸€å®šèƒ½æƒ³åˆ°Javaçš„Iteratorï¼Œä¸é”™ï¼Œæˆ‘ä»¬è¿™æ¬¡è®²çš„è¿­ä»£å™¨æ¨¡å¼å°±æ˜¯ç›®å‰å¤§éƒ¨åˆ†è¯­è¨€éƒ½å·²ç»å®ç°çš„è¿­ä»£å™¨ã€‚ å®šä¹‰å®ƒæä¾›ä¸€ç§æ–¹æ³•è®¿é—®ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ã€‚â€”â€”åˆ›é€ ç±» è¿­ä»£å™¨æ˜¯ä¸ºå®¹å™¨æœåŠ¡çš„ï¼Œèƒ½å®¹çº³å¯¹è±¡çš„æ‰€æœ‰ç±»å‹éƒ½å¯ä»¥ç§°ä¸ºå®¹å™¨ã€‚è¿­ä»£å™¨æ¨¡å¼æä¾›äº†éå† å®¹å™¨çš„æ–¹ä¾¿æ€§ï¼Œå®¹å™¨ä¸»è¦ç®¡ç†å¢å‡å…ƒç´ å°±å¯ä»¥äº†ï¼Œéœ€è¦éå†æ—¶äº¤ç”±è¿­ä»£å™¨è¿›è¡Œã€‚ç›®å‰åŸºæœ¬ä¸Šä¸ä¼šå•ç‹¬å†™ä¸€ä¸ªè¿­ä»£å™¨ã€‚ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ç±»å›¾ï¼š ä¸‹é¢ç®€å•ä»‹ç»ç±»å›¾ä¸­çš„å‡ ä¸ªè§’è‰²ï¼š IteratoræŠ½è±¡è¿­ä»£å™¨ï¼šæŠ½è±¡è¿­ä»£å™¨è´Ÿè´£å®šä¹‰è®¿é—®å’Œéå†å…ƒç´ çš„æ¥å£ã€‚ ConcreteIteratorå…·ä½“è¿­ä»£å™¨ï¼šå®ç°è¿­ä»£å™¨æ¥å£ï¼Œå®Œæˆå®¹å™¨å…ƒç´ çš„éå†ã€‚ AggregateæŠ½è±¡å®¹å™¨ï¼šå®¹å™¨è§’è‰²è´Ÿè´£æä¾›åˆ›å»ºå…·ä½“è¿­ä»£å™¨è§’è‰²çš„çš„æ¥å£ï¼Œå¿…ç„¶æä¾›ä¸€ä¸ªç±»ä¼¼createIterator()è¿™æ ·çš„æ–¹æ³•ï¼Œåœ¨Javaä¸­ä¸€èˆ¬æ˜¯iterator()æ–¹æ³•ã€‚ ConcreteAggregateå…·ä½“å®¹å™¨ï¼šå®ç°å®¹å™¨æ¥å£å®šä¹‰çš„æ–¹æ³•ï¼Œåˆ›å»ºå‡ºå®¹çº³è¿­ä»£å™¨çš„å¯¹è±¡ã€‚ ä¸‹é¢æ˜¯è¿­ä»£å™¨æ¨¡å¼çš„é€šç”¨æºä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788// æŠ½è±¡è¿­ä»£å™¨public interface Iterator &#123; // éå†åˆ°ä¸‹ä¸€ä¸ªå…ƒç´  public Object next(); // æ˜¯å¦å·²ç»éå†åˆ°å°¾éƒ¨ public boolean hasNext(); // åˆ é™¤å½“å‰æŒ‡å‘çš„å…ƒç´  public boolean remove();&#125;// å…·ä½“è¿­ä»£å™¨public class ConcreteIterator implements Iterator &#123; private Vector vector = new Vector(); // å®šä¹‰å½“å‰æ¸¸æ ‡ public int cursor = 0; @SuppressWarnings("checked") public ConcreteIterator(Vector _vector) &#123; this.vector = _vector; &#125; // åˆ¤æ–­æ˜¯å¦åˆ°è¾¾å°¾éƒ¨ public boolean hasNext() &#123; if (this.cursor == this.vector.size()) &#123; return false; &#125; else &#123; return true; &#125; &#125; // è¿”å›ä¸‹ä¸€ä¸ªå…ƒç´  public Object next() &#123; Object result = null; if (this.hasNext()) &#123; result = this.vector.get(this.cursor++); &#125; else &#123; result = null; &#125; return result; &#125; // åˆ é™¤å½“å‰å…ƒç´  public boolean remove() &#123; this.vector.remove(this.cursor); return true; &#125;&#125;// æŠ½è±¡å®¹å™¨public interface Aggregate &#123; // æ˜¯å®¹å™¨å¿…ç„¶æœ‰å…ƒç´ çš„å¢åŠ  public void add(Object object); // å‡å°‘å…ƒç´  public void remove(Object object); // ç”±è¿­ä»£å™¨æ¥éå†æ‰€æœ‰çš„å…ƒç´  public Iterator iterator();&#125;// å…·ä½“å®¹å™¨public class ConcreteAggregate implements Aggregate &#123; // å®¹çº³å¯¹è±¡çš„å®¹å™¨ private Vector vector = new Vector(); // å¢åŠ ä¸€ä¸ªå…ƒç´  public void add(Object object) &#123; this.vector.add(object); &#125; // è¿”å›è¿­ä»£å™¨å¯¹è±¡ public Iterator iterator() &#123; return new ConcreteIterator(this.vector); &#125; // åˆ é™¤ä¸€ä¸ªå…ƒç´  public void remove(Object object) &#123; this.remove(object); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å£°æ˜å®¹å™¨ Aggregate agg = new ConcreteAggregate(); // äº§ç”Ÿå¯¹è±¡æ•°æ®æ”¾è¿›å» agg.add("abc"); agg.add("aaa"); agg.add("1234"); // éå†ä¸€ä¸‹ Iterator iterator = agg.iterator(); while(Iterator.hasNext()) &#123; System.out.println(iterator.next()); &#125; &#125;&#125; åº”ç”¨åªè¦ä¸æ˜¯åœ¨ä½¿ç”¨é‚£äº›å¤è‘£çº§çš„ç¼–ç¨‹è¯­è¨€ï¼Œéƒ½ä¸ç”¨è‡ªå·±åŠ¨æ‰‹å†™è¿­ä»£å™¨ã€‚ æœ€ä½³å®è·µå¦‚æœä½ æ˜¯åšJavaå¼€å‘ï¼Œå°½é‡ä¸è¦è‡ªå·±å†™è¿­ä»£å™¨æ¨¡å¼ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”é€‚é…å™¨æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F08%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šé€‚é…å™¨æ¨¡å¼åœ¨ç”Ÿæ´»ä¸­éå¸¸å¸¸è§ï¼Œæ¯”å¦‚ä½ çš„ç¬”è®°æœ¬ä¸Šçš„ç”µæºé€‚é…å™¨ï¼Œé€šè¿‡å®ƒç¬”è®°æœ¬å¯ä»¥ä½¿ç”¨åœ¨110~220Vä¹‹é—´å˜åŒ–çš„ç”µæºï¼Œè€Œç¬”è®°æœ¬è¿˜å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ å®šä¹‰å°†ä¸€ä¸ªç±»çš„æ¥å£å˜æ¢æˆå®¢æˆ·ç«¯æœŸå¾…çš„å¦ä¸€ç§æ¥å£ï¼Œä»è€Œä½¿åŸæœ¬å› æ¥å£ä¸åŒ¹é…è€Œæ— æ³•å†ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»èƒ½å¤Ÿåœ¨ä¸€èµ·å·¥ä½œã€‚â€”â€”ç»“æ„ç±» ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ç±»å›¾ï¼š ä¸‹é¢ç®€å•ä»‹ç»ç±»å›¾ä¸­çš„å‡ ä¸ªç±»ï¼š Targetç›®æ ‡è§’è‰²ï¼šè¯¥è§’è‰²å®šä¹‰å§å…¶ä»–ç±»è½¬åŒ–ä¸ºä½•ç§æ¥å£ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æœŸæœ›çš„æ¥å£ã€‚ Adapteeæºè§’è‰²ï¼šéœ€è¦è½¬åŒ–çš„è§’è‰²ï¼Œé€šè¿‡é€‚é…å™¨è§’è‰²çš„åŒ…è£…å¯ä»¥æˆä¸ºä¸€ä¸ªæ–°è§’è‰²ã€‚ Adapteré€‚é…å™¨è§’è‰²ï¼šå®ƒçš„èŒè´£å°±æ˜¯é€šè¿‡ç»§æ‰¿æˆ–è€…ç±»å…³è”çš„æ–¹å¼æŠŠæºè§’è‰²è½¬åŒ–ä¸ºç›®æ ‡è§’è‰²ã€‚ ä¸‹é¢æ˜¯ä»–çš„é€šè¿‡æºç ï¼š123456789101112131415161718192021222324252627282930313233343536373839// ç›®æ ‡è§’è‰²public interface Target &#123; // ç›®æ ‡è§’è‰²æœ‰è‡ªå·±çš„æ–¹æ³• public void request();&#125;// ç›®æ ‡è§’è‰²çš„å®ç°ç±»public class ConcreteTarget implements Target &#123; public void request() &#123; System.out.println("if you need any help,please call me!"); &#125;&#125;// æºè§’è‰²public class Adaptee &#123; // åŸæœ‰çš„ä¸šåŠ¡é€»è¾‘ public void doSomething() &#123; System.out.println("I`m kind of busy,leave me alone,please!"); &#125;&#125;// é€‚é…å™¨æ©˜è‰²public class Adapter extends Adaptee implements Target &#123; public void request() &#123; super.doSomething(); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // åŸæœ‰çš„ä¸šåŠ¡é€»è¾‘ Target target = new ConcreteTarget(); target.request(); // ç°åœ¨å¢åŠ äº†é€‚é…å™¨è§’è‰²çš„ä¸šåŠ¡é€»è¾‘ Target target2 = new Adapter(); target2.request(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ é€‚é…å™¨æ¨¡å¼å¯ä»¥è®©ä¸¤ä¸ªæ²¡æœ‰ä»»ä½•å…³ç³»çš„ç±»ä¸€èµ·è¿è¡Œ æé«˜äº†ç±»çš„é€æ˜æ€§ï¼Œæºè§’è‰²å¯¹äºé«˜å±‚æ¨¡å—æ˜¯é€æ˜çš„ æé«˜äº†ç±»çš„å¤ç”¨åº¦ï¼Œæºè§’è‰²åœ¨åŸç³»ç»Ÿä¸­è¿˜æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ çµæ´»æ€§éå¸¸å¥½ï¼Œä¸éœ€è¦é€‚é…å™¨çš„æ—¶å€™åˆ é™¤æ‰è¿™ä¸ªé€‚é…å™¨å³å¯ ä½¿ç”¨åœºæ™¯å½“ä½ æœ‰åŠ¨æœºä¿®æ”¹ä¸€ä¸ªå·²ç»æŠ•äº§ä¸­çš„æ¥å£æ—¶ï¼Œé€‚é…å™¨å¯èƒ½æ˜¯æœ€é€‚åˆçš„ä½ æ¨¡å¼ã€‚æ¯”å¦‚ç³»ç»Ÿæ‰©å±•äº†ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªå·²æœ‰æˆ–æ–°å»ºç«‹çš„ç±»ï¼Œå½“è¿™ä¸ªç±»åˆä¸ç¬¦åˆç³»ç»Ÿçš„æ¥å£ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ã€‚ æ³¨æ„äº‹é¡¹é€‚é…å™¨æ¨¡å¼æœ€å¥½åœ¨è¯¦ç»†è®¾è®¡é˜¶æ®µä¸è¦è€ƒè™‘å®ƒï¼Œå®ƒä¸æ˜¯ä¸ºè§£å†³è¿˜å¤„åœ¨å¼€å‘é˜¶æ®µçš„é—®é¢˜ï¼Œè€Œæ˜¯è§£å†³æ­£åœ¨æœå½¹çš„é¡¹ç›®é—®é¢˜ã€‚ æœ€ä½³å®è·µé€‚é…å™¨æ¨¡å¼æ˜¯ä¸€ä¸ªè¡¥æ•‘æ¨¡å¼ï¼Œé€šå¸¸ç”¨æ¥è§£å†³æ¥å£ä¸ç›¸å®¹çš„é—®é¢˜ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”ç­–ç•¥æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F07%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå°†æ‰€æœ‰æ–¹æ³•å°è£…èµ·æ¥ï¼Œè¦ç”¨ä»€ä¹ˆæ–¹æ³•å°±æ‰“å¼€ä»€ä¹ˆæ–¹æ³•ï¼Œè¿™å°±æ˜¯ç­–ç•¥æ¨¡å¼ã€‚ å®šä¹‰å®šä¹‰ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸ªç®—æ³•éƒ½å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ä»–ä»¬ä¹‹é—´å¯ä»¥äº’æ¢ã€‚â€”â€”è¡Œä¸ºç±» æˆ‘ä»¬å…ˆçœ‹å®ƒçš„ç±»å›¾ï¼š ç®€å•ä»‹ç»ç±»å›¾ä¸­çš„å‡ ä¸ªç±»ï¼š Contextå°è£…è§’è‰²ï¼Œä¹Ÿå«ä¸Šä¸‹æ–‡è§’è‰²ï¼Œèµ·æ‰¿ä¸Šå¯ä¸‹å°è£…ä½œç”¨ï¼Œå±è”½é«˜å±‚æ¨¡å—å¯¹ç­–ç•¥ã€ç®—æ³•çš„ç›´æ¥è®¿é—®ã€‚ StrategyæŠ½è±¡ç­–ç•¥è§’è‰²ï¼Œå®šä¹‰æ¯ä¸ªç­–ç•¥æˆ–ç®—æ³•å¿…é¡»å…·æœ‰çš„æ–¹æ³•å’Œå±æ€§ã€‚ ConcreteStrategyå…·ä½“ç­–ç•¥è§’è‰²ï¼Œå®ç°æŠ½è±¡ç­–ç•¥çš„æ“ä½œï¼Œè¯¥ç±»å«æœ‰å…·ä½“çš„ç®—æ³•ã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨æºç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243// æŠ½è±¡çš„ç­–ç•¥è§’è‰²public interface Strategy &#123; // ç­–ç•¥æ¨¡å¼çš„è¿ç®—æ³•åˆ™ public void doSomething();&#125;// å…·ä½“è§’è‰²ç±»public class ConcreteStrategy1 implements Strategy &#123; public void doSomething() &#123; System.out.println("å…·ä½“ç­–ç•¥1çš„è¿ç®—æ³•åˆ™"); &#125;&#125;public class ConcreteStrategy2 implements Strategy &#123; public void doSomething() &#123; System.out.println("å…·ä½“ç­–ç•¥2çš„è¿ç®—æ³•åˆ™"); &#125;&#125;// å°è£…è§’è‰²public class Context &#123; // æŠ½è±¡ç­–ç•¥ private Strategy strategy = null; // æ„é€ å‡½æ•°è®¾ç½®å…·ä½“ç­–ç•¥ public Context(Strategy _strategy) &#123; this.strategy = _strategy; &#125; // å°è£…åçš„ç­–ç•¥æ–¹æ³• public void doAngthing() &#123; this.strategy.doSomething(); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å£°æ˜ä¸€ä¸ªå…·ä½“çš„ç­–ç•¥ Strategy strategy = new ConcreteStrategy1(); // å£°æ˜ä¸Šä¸‹æ–‡å¯¹è±¡ Context context = new Context(strategy); // æ‰§è¡Œå°è£…åçš„æ–¹æ³• context.doAngthing(); &#125;&#125; ç­–ç•¥æ¨¡å¼å®è´¨æ˜¯é‡‡ç”¨äº†é¢å‘å¯¹è±¡çš„ç»§æ‰¿å’Œå¤šæ€æœºåˆ¶ã€‚ä½†æ˜¯ä¸€ä¸ªç±»å®ç°å¤šä¸ªæ¥å£å¾ˆæ­£å¸¸ï¼Œæ‰€ä»¥è¯†åˆ«å‡ºæŠ½è±¡ç­–ç•¥æ¥å£æ˜¯ç³»ç»Ÿåˆ†æå¸ˆçš„ä»·å€¼æ‰€åœ¨ã€‚ç­–ç•¥æ¨¡å¼å’Œä»£ç†æ¨¡å¼çš„åŒºåˆ«æ˜¯ç­–ç•¥æ¨¡å¼çš„å°è£…è§’è‰²å’Œè¢«å°è£…çš„ç­–ç•¥ç±»ä¸ç”¨æ˜¯åŒä¸€ä¸ªæ¥å£ã€‚ åº”ç”¨ä¼˜ç‚¹ ç®—æ³•å¯ä»¥è‡ªç”±åˆ‡æ¢ é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶åˆ¤æ–­ æ‰©å±•æ€§è‰¯å¥½ ç¼ºç‚¹ ç­–ç•¥ç±»æ•°é‡å¢å¤šï¼Œå¤ç”¨å¯èƒ½æ€§å° æ‰€æœ‰ç­–ç•¥ç±»éƒ½éœ€è¦å¯¹å¤–æš´éœ²ï¼Œä¸Šå±‚æ¨¡å—éœ€è¦çŸ¥é“æœ‰å“ªäº›ç­–ç•¥ï¼Œè¿èƒŒäº†è¿ªç±³ç‰¹æ³•åˆ™ ä½¿ç”¨åœºæ™¯ å¤šä¸ªç±»åªæœ‰åœ¨ç®—æ³•æˆ–è¡Œä¸ºä¸Šç¨æœ‰ä¸åŒçš„åœºæ™¯ ç®—æ³•éœ€è¦è‡ªç”±åˆ‡æ¢çš„åœºæ™¯ éœ€è¦å±è”½ç®—æ³•è§„åˆ™çš„åœºæ™¯ æ³¨æ„äº‹é¡¹å¦‚æœç³»ç»Ÿä¸­çš„ä¸€ä¸ªç­–ç•¥å®¶æ—çš„å…·ä½“ç­–ç•¥æ•°é‡è¶…è¿‡4ä¸ªï¼Œåˆ™éœ€è¦è€ƒè™‘ä½¿ç”¨æ··åˆæ¨¡å¼ï¼Œè§£å†³ç­–ç•¥ç±»è†¨èƒ€å’Œå¯¹å¤–æš´éœ²é—®é¢˜ã€‚ æœ€ä½³å®è·µç­–ç•¥æ¨¡å¼åœ¨é¡¹ç›®ä¸­ä¼šç»å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯å®ƒå…·æœ‰ä¸€ä¸ªè‡´å‘½ç¼ºé™·ï¼šæ‰€æœ‰çš„ç­–ç•¥éƒ½éœ€è¦æš´éœ²å‡ºå»ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€šè¿‡å·¥å‚æ–¹æ³•æ¨¡å¼æ¥å®ç°ç­–ç•¥ç±»çš„å£°æ˜ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è£…é¥°æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F07%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæƒ³ç»™æŸäº›ç±»å¢åŠ ä¸€äº›åŠŸèƒ½ï¼Œæœ‰äº›äººå¯èƒ½ä¼šæƒ³åˆ°ç›´æ¥ä¿®æ”¹ç±»ï¼Œä½†æ˜¯è¦æ±‚ä¸å½±å“å­ç±»ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°è£…é¥°æ¨¡å¼äº†ã€‚ å®šä¹‰åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°æ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚â€”â€”ç»“æ„ç±» è£…é¥°æ¨¡å¼å’Œä»£ç†æ¨¡å¼å¾ˆåƒï¼Œå®ƒçš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š ä¸‹é¢ç®€å•è¯´è¯´ç±»å›¾ä¸­çš„4ä¸ªå¯¹è±¡ï¼š Componentæ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œå°±æ˜¯å®šä¹‰æˆ‘ä»¬æœ€æ ¸å¿ƒçš„å¯¹è±¡ï¼Œä¹Ÿæ˜¯æœ€åŸå§‹çš„å¯¹è±¡ã€‚ ConcreteComponentæ˜¯æœ€æ ¸å¿ƒçš„å¯¹è±¡çš„å®ç°ï¼Œæˆ‘ä»¬è¦è£…é¥°çš„å°±æ˜¯å®ƒã€‚ Decoratorè£…é¥°å¯¹è±¡ï¼Œå®ƒé‡Œé¢ä¸ä¸€å®šæœ‰æŠ½è±¡çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒçš„å±æ€§é‡Œå¿…ç„¶æœ‰ä¸€ä¸ªprivateå˜é‡æŒ‡å‘Componentã€‚ ConcreteDecoratoræ˜¯è£…é¥°å¯¹è±¡çš„å®ç°ç±»ã€‚ è£…é¥°æ¨¡å¼çš„å…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172public abstract class Component &#123; // æŠ½è±¡çš„æ–¹æ³• public abstract void operate();&#125;public class ConcreteComponent exgtends Component &#123; // å…·ä½“å®ç° @Override public void operate() &#123; System.out.println("do something"); &#125;&#125;// æŠ½è±¡è£…é¥°ç±»ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªè£…é¥°ç±»ï¼Œåˆ™å¯ä»¥æ²¡æœ‰æŠ½è±¡è£…é¥°è€…public abstract class Decorator extends Component &#123; private Component component = null; // é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’è¢«ä¿®é¥°è€… public Decorator(Component _component) &#123; this.component = _component; &#125; // å§”æ‰˜ç»™è¢«ä¿®é¥°è€…æ‰§è¡Œ @Override public void operate() &#123; this.component.operate(); &#125;&#125;// å…·ä½“è£…é¥°ç±»public class ConcreteDecorator1 extends Decorator &#123; // å®šä¹‰è¢«ä¿®é¥°è€… public ConcreteDecorator1(Component _component) &#123; super(_component); &#125; // å®šä¹‰è‡ªå·±çš„ä¿®é¥°æ–¹æ³• private void method1() &#123; System.out.println("method1 ä¿®é¥°"); &#125; // é‡å†™çˆ¶ç±»çš„operateæ–¹æ³• public void operate() &#123; this.method1(); super.operate(); &#125;&#125;public class ConcreteDecorator2 extends Decorator &#123; // å®šä¹‰è¢«ä¿®é¥°è€… public ConcreteDecorator2(Component _component) &#123; super(_component); &#125; // å®šä¹‰è‡ªå·±çš„ä¿®é¥°æ–¹æ³• private void method2() &#123; System.out.println("method2 ä¿®é¥°"); &#125; // é‡å†™çˆ¶ç±»çš„operateæ–¹æ³• public void operate() &#123; this.method2(); super.operate(); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; Component component = new ConcreteComponent(); // ç¬¬ä¸€æ¬¡ä¿®é¥° component = new ConcreteDecorator1(component); // ç¬¬äºŒæ¬¡ä¿®é¥° component = new ConcreteDecorator2(component); // ä¿®é¥°åè¿è¡Œ component.operate(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ è£…é¥°ç±»å’Œè¢«ä¿®é¥°ç±»å¯ä»¥ç‹¬ç«‹å‘å±•ï¼Œè€Œä¸ä¼šç›¸äº’è€¦åˆã€‚ è£…é¥°æ¨¡å¼æ˜¯ç»§æ‰¿å…³ç³»çš„ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆã€‚ è£…é¥°æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°æ‰©å±•ä¸€ä¸ªå®ç°ç±»çš„åŠŸèƒ½ã€‚ ç¼ºç‚¹å¤šå±‚çš„è£…é¥°æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚ ä½¿ç”¨åœºæ™¯ éœ€è¦æ‰©å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼Œæˆ–ç»™ä¸€ä¸ªç±»å¢åŠ é™„åŠ åŠŸèƒ½ã€‚ éœ€è¦åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡å¢åŠ åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½å¯ä»¥å†åŠ¨æ€åœ°æ’¤é”€çš„ã€‚ éœ€è¦ä¸ºä¸€æ‰¹å…„å¼Ÿç±»è¿›è¡Œæ”¹è£…æˆ–åŠ è£…åŠŸèƒ½ã€‚ æœ€ä½³å®è·µ è£…é¥°æ¨¡å¼æ˜¯å¯¹ç»§æ‰¿çš„æœ‰åŠ›è¡¥å……ã€‚ åœ¨ä¸šåŠ¡å˜æ›´çš„æ—¶å€™ï¼Œå¢å¼ºç±»çš„åŠŸèƒ½ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”è´£ä»»é“¾æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F07%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸€ä¸ªé—®é¢˜å¯¹åº”ä¸€ä¸ªè§£å†³æ–¹æ³•ï¼Œä½ ä¸€èˆ¬éœ€è¦å»æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ï¼Œç°åœ¨æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯ä½ ä¸ç®¡é‡åˆ°ä»€ä¹ˆé—®é¢˜åªè¦äº¤ç»™ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ³•å°±å¯ä»¥äº†ï¼Œç¾æ»‹æ»‹ï¼Œè¿™å°±æ˜¯è´£ä»»é“¾æ¨¡å¼ã€‚ å®šä¹‰ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…äº†è¯·æ±‚çš„å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚â€”â€”è¡Œä¸ºç±» è´£ä»»é“¾æ¨¡å¼çš„é‡ç‚¹åœ¨â€œé“¾â€ä¸Šï¼Œç”±ä¸€æ¡é“¾å»å¤„ç†ç›¸ä¼¼çš„è¯·æ±‚åœ¨é“¾ä¸­å†³å®šè°æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶è¿”å›ç›¸åº”çš„ç»“æœã€‚å…¶é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š è´£ä»»é“¾æ¨¡å¼çš„æ ¸å¿ƒåœ¨é“¾ä¸Šï¼Œâ€œé“¾â€æ˜¯ç”±å¤šä¸ªå¤„ç†è€…ConcreteHandleç»„æˆçš„ï¼Œå®ƒçš„é€šç”¨æºç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394// æŠ½è±¡å¤„ç†è€…public abstract class Handler &#123; private Handler nextHandler; // æ¯ä¸ªå¤„ç†è€…éƒ½å¿…é¡»å¯¹è¯·æ±‚åšå‡ºå¤„ç† public final Response handleMessage(Request request) &#123; // finalå…³é”®å­—å‚è€ƒæ¨¡æ¿æ¨¡å¼çš„æ¨¡æ¿æ–¹æ³• // åˆ¤æ–­æ˜¯å¦æ˜¯è‡ªå·±çš„å¤„ç†çº§åˆ« if (this.getHandlerLevel().equals(request.getRequestLevel())) &#123; response = this.echo(request); &#125; else &#123; // ä¸å±äºè‡ªå·±çš„å¤„ç†çº§åˆ« // åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ªå¤„ç†è€… if (this.nextHandler != null) &#123; response = this.nextHandler.handleMessage(request); &#125; else &#123; // æ²¡æœ‰é€‚å½“å¤„ç†è€…ï¼Œä¸šåŠ¡è‡ªè¡Œå¤„ç† &#125; &#125; return response; &#125; // è®¾ç½®ä¸‹ä¸€ä¸ªå¤„ç†è€… public void setNext(Handler _handler) &#123; this.nextHandler = _handler; &#125; // æ¯ä¸ªå¤„ç†è€…éƒ½æœ‰ä¸€ä¸ªå¤„ç†çº§åˆ« protect abstract Level getHandlerLevel(); //æ¯ä¸ªå¤„ç†è€…éƒ½å¿…é¡»å®ç°å¤„ç†ä»»åŠ¡ protect abstract Response echo(Request request);&#125;// å…·ä½“å¤„ç†è€…public class Concretehandler1 extends Handler &#123; // å®šä¹‰è‡ªå·±çš„å¤„ç†é€»è¾‘ protected Response echo(Request request) &#123; // å®Œæˆå¤„ç†é€»è¾‘ return null; &#125; // è®¾ç½®è‡ªå·±çš„å¤„ç†çº§åˆ« protected Level getHandlerLevel() &#123; // è®¾ç½®è‡ªå·±çš„å¤„ç†çº§åˆ« return null; &#125;&#125;public class Concretehandler2 extends Handler &#123; // å®šä¹‰è‡ªå·±çš„å¤„ç†é€»è¾‘ protected Response echo(Request request) &#123; // å®Œæˆå¤„ç†é€»è¾‘ return null; &#125; // è®¾ç½®è‡ªå·±çš„å¤„ç†çº§åˆ« protected Level getHandlerLevel() &#123; // è®¾ç½®è‡ªå·±çš„å¤„ç†çº§åˆ« return null; &#125;&#125;public class Concretehandler3 extends Handler &#123; // å®šä¹‰è‡ªå·±çš„å¤„ç†é€»è¾‘ protected Response echo(Request request) &#123; // å®Œæˆå¤„ç†é€»è¾‘ return null; &#125; // è®¾ç½®è‡ªå·±çš„å¤„ç†çº§åˆ« protected Level getHandlerLevel() &#123; // è®¾ç½®è‡ªå·±çš„å¤„ç†çº§åˆ« return null; &#125;&#125;// æ¨¡å¼ä¸­æœ‰å…³æ¡†æ¶ä»£ç public class Level &#123; // å®šä¹‰ä¸€ä¸ªè¯·æ±‚å’Œå¤„ç†ç­‰çº§&#125;public class Request &#123; // è¯·æ±‚çš„ç­‰çº§ public Level getRequestLevel() &#123; return null; &#125;&#125;publci class Request &#123; // å¤„ç†è€…è¿”å›çš„æ•°æ®&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å£°æ˜æ‰€æœ‰çš„å¤„ç†èŠ‚ç‚¹ Handler handler1 = new ConcreteHandler1(); Handler handler2 = new ConcreteHandler2(); Handler handler3 = new ConcreteHandler3(); // è®¾ç½®é“¾ä¸­çš„é˜¶æ®µé¡ºåº1--&gt;2--&gt;3 handler1.setNext(handler2); handler2.setNext(handler3); // æäº¤è¯·æ±‚ï¼Œè¿”å›ç»“æœ Response response = handler1.handlerMessage(new Request()); &#125;&#125; åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªå°è£…ç±»å¯¹è´£ä»»æ¨¡å¼è¿›è¡Œå°è£…ï¼Œç›´æ¥è¿”å›é“¾ä¸­çš„ç¬¬ä¸€ä¸ªå¤„ç†è€…ï¼Œå…·ä½“é“¾çš„è®¾ç½®ä¸éœ€è¦é«˜å±‚æ¨¡å—å…³ç³»ï¼Œè¿™æ ·ï¼Œç®€åŒ–äº†é«˜å±‚æ¬¡æ¨¡å¼çš„è°ƒç”¨ï¼Œå‡å°‘æ¨¡å—é—´çš„è€¦åˆï¼Œæé«˜ç³»ç»Ÿçš„çµæ´»æ€§ã€‚ åº”ç”¨ä¼˜ç‚¹å°†è¯·æ±‚å’Œå¤„ç†åˆ†å¼€ï¼Œè¯·æ±‚è€…å¯ä»¥ä¸ç”¨çŸ¥é“è°å¤„ç†çš„ï¼Œå¤„ç†è€…å¯ä»¥ä¸ç”¨çŸ¥é“è¯·æ±‚çš„å…¨è²Œï¼Œä¸¤è€…è§£è€¦ã€‚ ç¼ºç‚¹ æ€§èƒ½é—®é¢˜ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ä»é“¾å¤´éå†åˆ°é“¾å°¾ï¼Œåœ¨é“¾æ¯”è¾ƒé•¿çš„æ—¶å€™ï¼Œæ€§èƒ½å°±ä¼šå‡ºç°é—®é¢˜ã€‚ è°ƒè¯•ä¸æ–¹ä¾¿ï¼Œè°ƒè¯•é€»è¾‘å¤åˆ¶ã€‚ æ³¨æ„äº‹é¡¹é“¾ä¸­èŠ‚ç‚¹æ•°é‡éœ€è¦æ§åˆ¶ï¼Œé¿å…å‡ºç°è¶…é•¿é“¾çš„æƒ…å†µï¼Œä¸€èˆ¬åšæ³•æ˜¯åœ¨Handlerä¸­è®¾ç½®ä¸€ä¸ªæœ€å¤§èŠ‚ç‚¹æ•°é‡ï¼Œåœ¨setNextæ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦å·²ç»è¶…è¿‡å…¶é˜ˆå€¼ï¼Œè¶…è¿‡åˆ™ä¸å…è®¸è¯¥é“¾å»ºç«‹ã€‚ æœ€ä½³å®è·µ èåˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œæ¯ä¸ªå®ç°ç±»åªè¦å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šechoæ–¹æ³•å¤„ç†è¯·æ±‚å’ŒgetHandlerLevelè·å¾—å¤„ç†çº§åˆ«ï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™å’Œè¿ªç±³ç‰¹æ³•åˆ™ã€‚ è´£ä»»é“¾æ¨¡å¼çš„æ ¸å¿ƒå®ƒå±è”½äº†è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹ï¼Œåªè¦ä½ æŠŠè¯·æ±‚æŠ›ç»™è´£ä»»é“¾çš„ç¬¬ä¸€ä¸ªå¤„ç†è€…ï¼Œæœ€ç»ˆä¼šè¿”å›ä¸€ä¸ªå¤„ç†ç»“æœï¼Œä½œä¸ºè¯·æ±‚è€…ä¸ç”¨çŸ¥é“éœ€è¦è°æ¥å¤„ç†ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å‘½ä»¤æ¨¡å¼]]></title>
    <url>%2F2018%2F03%2F06%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä½œä¸ºé¢†å¯¼äººåªè¦å‘å¸ƒå‘½ä»¤å³å¯ï¼Œè€Œä¸ç”¨åœ¨å‘å¸ƒå‘½ä»¤çš„æ—¶å€™è¿˜è¦å»æ‰¾åˆ°å®æ–½çš„äººï¼Œæˆ‘ç›¸ä¿¡é¢†å¯¼äººä¸€å®šè¶…çº§é«˜å…´ï¼Œå› ä¸ºå®æ–½çš„äººå·²ç»åŒ…å«åœ¨å‘½ä»¤é‡Œäº†ã€‚è¿™å°±æ˜¯å‘½ä»¤æ¨¡å¼ã€‚ å®šä¹‰å°†ä¸€ä¸ªè¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œè®©ä½ ä½¿ç”¨ä¸åŒçš„è¯·æ±‚æŠŠå®¢æˆ·ç«¯å‚æ•°åŒ–ï¼Œå¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œå¯ä»¥æä¾›å‘½ä»¤çš„æ’¤é”€å’Œæ¢å¤åŠŸèƒ½ã€‚â€”â€”è¡Œä¸ºç±» å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ä¸ªé«˜å†…èšæ¨¡å¼ã€‚å®ƒçš„å°è£…æ€§éå¸¸å¥½ï¼ŒæŠŠè¯·æ±‚æ–¹ï¼ˆInvokerï¼‰å’Œæ‰§è¡Œæ–¹ï¼ˆReceiverï¼‰å°å¼€äº†ã€‚ å®ƒçš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š é€šç”¨ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677// é€šç”¨Receiverç±»public abstract class Receiver &#123; // æŠ½è±¡æ¥æ”¶è€…ï¼Œå®šä¹‰æ¯ä¸ªæ¥æ”¶è€…éƒ½å¿…é¡»å®Œæˆçš„ä¸šåŠ¡ public abstract void doSomething();&#125;// å…·ä½“çš„Receiverç±»ï¼Œå¯ä»¥æ˜¯Nä¸ªï¼Œå’Œä¸šåŠ¡æœ‰å…³public class ConcereteReceiver1 extends Receiver &#123; // æ¯ä¸ªæ¥æ”¶è€…éƒ½å¿…é¡»å¤„ç†ä¸€å®šçš„ä¸šåŠ¡é€»è¾‘ public void doSomething()&#123;&#125;&#125;public class ConcereteReceiver2 extends Receiver &#123; // æ¯ä¸ªæ¥æ”¶è€…éƒ½å¿…é¡»å¤„ç†ä¸€å®šçš„ä¸šåŠ¡é€»è¾‘ public void doSomething()&#123;&#125;&#125;// æŠ½è±¡çš„Commandç±»public abstract class Command &#123; // æ¯ä¸ªå‘½ä»¤ç±»éƒ½å¿…é¡»æœ‰ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤çš„æ–¹æ³• public abstract void execute();&#125;// å…·ä½“çš„Commandç±»public class ConcreteCommand1 extends Command &#123; //å…³è”ï¼Œå¯¹å“ªä¸ªReceiverç±»è¿›è¡Œå‘½ä»¤å¤„ç† private Receiver receiver; // æ„é€ å‡½æ•°ä¼ é€’æ¥æ”¶è€… public ConcreteCommand1(Receiver _receiver) &#123; this.receiver = _receiver; &#125;; // å¿…é¡»å®ç°ä¸€ä¸ªå‘½ä»¤ public void execute() &#123; // ä¸šåŠ¡å¤„ç† this.receiver.doSomething(); &#125;&#125;public class ConcreteCommand2 extends Command &#123; //å…³è”ï¼Œå¯¹å“ªä¸ªReceiverç±»è¿›è¡Œå‘½ä»¤å¤„ç† private Receiver receiver; // æ„é€ å‡½æ•°ä¼ é€’æ¥æ”¶è€… public ConcreteCommand2(Receiver _receiver) &#123; this.receiver = _receiver; &#125;; // å¿…é¡»å®ç°ä¸€ä¸ªå‘½ä»¤ public void execute() &#123; // ä¸šåŠ¡å¤„ç† this.receiver.doSomething(); &#125;&#125;// è°ƒç”¨è€…Invokerç±»public class Invoker &#123; private Command command; // æ¥å—å‘½ä»¤ public void setCommand(Command _command) &#123; this.command = _command; &#125; // æ‰§è¡Œå‘½ä»¤ public void action()&#123; this.command.execute(); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // é¦–å…ˆå£°æ˜è°ƒç”¨è€…Invoker Invoker invoker = new Invoker(); // å®šä¹‰æ¥æ”¶è€… Receiver receiver = new ConcreteReceiver1(); // å®šä¹‰ä¸€ä¸ªå‘é€ç»™æ¥å—è€…çš„å‘½ä»¤ Command command = new ConcreteCommand1(receiver); // æŠŠå‘½ä»¤äº¤ç»™è°ƒç”¨è€…å»æ‰§è¡Œ invoker.setCommand(command); invoker.action(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ ç±»é—´è§£è€¦ï¼šè°ƒç”¨è€…ä¸æ¥æ”¶è€…ä¹‹é—´æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ï¼Œè°ƒç”¨è€…å®ç°åŠŸèƒ½æ—¶åªéœ€è¦è°ƒç”¨CommandæŠ½è±¡ç±»çš„executeæ–¹æ³•å³å¯ï¼Œä¸éœ€è¦äº†è§£æ˜¯å“ªä¸ªæ¥æ”¶è€…æ‰§è¡Œã€‚ å¯æ‰©å±•æ€§ï¼šCommandçš„å­ç±»éå¸¸å®¹æ˜“æ‰©å±•ã€‚ å‘½ä»¤æ¨¡å¼ç»“åˆå…¶ä»–æ¨¡å¼ä¼šæ›´ä¼˜ç§€ï¼Œä¾‹å¦‚è´£ä»»é“¾æ¨¡å¼ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚ ç¼ºç‚¹æœ‰Nä¸ªå‘½ä»¤å°±ä¼šæœ‰Nä¸ªCommandçš„å­ç±»ï¼Œè¿™æ ·è¿™ä¸ªç±»å°±ä¼šè†¨èƒ€äº†ã€‚ ä½¿ç”¨åœºæ™¯åªè¦æ˜¯ä½ è®¤ä¸ºæ˜¯å‘½ä»¤çš„åœ°æ–¹å°±å¯ä»¥é‡‡ç”¨å‘½ä»¤æ¨¡å¼ã€‚ æœ€ä½³å®è·µæ ¹æ®å¼€å‘åœºæ™¯è¦æ±‚å¯ä»¥æœ‰å¤šä¸ªæ¥æ”¶è€…ï¼Œé‚£å°±éœ€è¦ç”¨é›†åˆç±»å‹æ¥å°è£…Commandç±»äº†ã€‚è¯¥è®¾è®¡æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯é«˜å±‚æ¨¡å¼ä¸éœ€è¦çŸ¥é“æ¥æ”¶è€…ï¼ŒPerfectï¼ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”ä¸­ä»‹è€…æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F10%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¤šä¸ªå¯¹è±¡ç›¸äº’ä¾èµ–ï¼Œå…³ç³»é”™ç»¼å¤æ‚ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæ„Ÿåˆ°æ— ä»ä¸‹æ‰‹ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™å‡ºç°ä¸€ä¸ªå¯¹è±¡ï¼Œèƒ½å¤Ÿåè°ƒå„ä¸ªå¯¹è±¡çš„å…³ç³»ï¼Œå¹¶ä¸”å…¶ä»–å¯¹è±¡åªè¦ä¸è¿™ä¸ªå¯¹è±¡äº¤æµï¼Œé‚£è¿˜ä¸æ˜¯ç¾æ»‹æ»‹ï¼Œè¿™å°±æ˜¯ä¸­ä»‹è€…æ¨¡å¼ã€‚ å®šä¹‰ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾ç¤ºåœ°ç›¸äº’ä½œç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹å¾—æ”¹å˜ä»–ä»¬ä¹‹é—´çš„äº¤äº’ã€‚â€”â€”è¡Œä¸ºç±» å®ƒçš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š ä»ç±»å›¾ä¸­çœ‹ï¼Œä¸­ä»‹è€…æ¨¡å¼ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š MediatoræŠ½è±¡ä¸­ä»‹è€…è§’è‰²ï¼šå®šä¹‰ç»Ÿä¸€çš„æ¥å£ï¼Œç”¨äºå„åŒäº‹è§’è‰²ä¹‹é—´çš„é€šä¿¡ã€‚ ConcreteMediatorå…·ä½“ä¸­ä»‹è€…è§’è‰²ï¼šä¾èµ–äºå„ä¸ªåŒäº‹è§’è‰²ï¼Œåè°ƒå„åŒäº‹è§’è‰²å®ç°åä½œè¡Œä¸ºã€‚ ColleagueåŒäº‹è§’è‰²ï¼šæ¯ä¸€ä¸ªåŒäº‹è§’è‰²éƒ½çŸ¥é“ä¸­ä»‹è€…è§’è‰²ï¼Œè€Œä¸”ä¸å…¶ä»–çš„åŒæ—¶è§’è‰²é€šä¿¡çš„æ—¶å€™ï¼Œä¸€å®šè¦é€šè¿‡ä¸­ä»‹è€…è§’è‰²åä½œã€‚åŒäº‹ç±»çš„è¡Œä¸ºåˆ†ä¸¤ç§ï¼šä¸€æ˜¯åŒäº‹æœ¬èº«çš„è¡Œä¸ºï¼ˆæœ¬èº«è¡Œä¸ºï¼‰ï¼ŒäºŒæ˜¯å¿…é¡»ä¾èµ–ä¸­ä»‹è€…æ‰èƒ½å®Œæˆçš„è¡Œä¸ºï¼ˆä¾èµ–æ–¹æ³•ï¼‰ã€‚ å®ƒçš„é€šç”¨æºç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// é€šç”¨æŠ½è±¡ä¸­ä»‹è€…// åœ¨è¯¥æŠ½è±¡ç±»ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†åŒäº‹å®ç°ç±»æ³¨å…¥ï¼Œæ˜¯å› ä¸ºåŒäº‹ç±»è™½ç„¶æœ‰æŠ½è±¡ï¼Œä½†æ˜¯æ²¡æœ‰æ¯ä¸ªåŒäº‹å¿…é¡»è¦å®ç°çš„æ–¹æ³•ã€‚public abstract class Mediator &#123; // å®šä¹‰åŒäº‹ç±» protect ConcreteColleague1 c1; protect ConcreteColleague2 c2; // é€šè¿‡getter/setteræ–¹æ³•å§åŒäº‹ç±»æ³¨å…¥è¿›æ¥ ... çœç•¥getã€setæ–¹æ³• // ä¸­ä»‹è€…æ¨¡å¼çš„ä¸šåŠ¡é€»è¾‘ public abstract void doSomething1(); public abstract void doSomething2();&#125;// é€šç”¨ä¸­ä»‹è€…public class ConcreteMediator extend Mediator &#123; @Override public void doSomething1() &#123; // è°ƒç”¨åŒäº‹ç±»çš„æ–¹æ³• super.c1.selfMethod1(); super.c2.selfMethod2(); &#125; @Override public void doSomething2() &#123; // è°ƒç”¨åŒäº‹ç±»çš„æ–¹æ³• super.c1.selfMethod1(); super.c2.selfMethod2(); &#125;&#125;// æŠ½è±¡åŒäº‹ç±»public abstract class Colleague &#123; protected Mediator mediator; public Colleague(Mediator _mediator) &#123; this.mediator = _mediator; &#125;&#125;// å…·ä½“åŒäº‹ç±» 1,2 ç±»ä¼¼public class ConcreteColleague1 extends Colleague &#123; // é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’ä¸­ä»‹è€…ï¼Œå› ä¸ºåŒäº‹ç±»å¿…é¡»è¦æœ‰ä¸­ä»‹è€… public ConcreteColleague1(Mediator _mediator) &#123; super(_mediator); &#125; // è‡ªæœ‰æ–¹æ³• public void selfMethod1()&#123; // å¤„ç†è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ &#125; // ä¾èµ–æ–¹æ³• public void depMethod1()&#123; // è‡ªå·±ä¸èƒ½å¤„ç†çš„ä¸šåŠ¡é€»è¾‘ï¼Œå§”æ‰˜ç»™ä¸­ä»‹è€…å¤„ç† super.mediator.doSomething1(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹å‡å°‘ç±»é—´çš„ä¾èµ–ï¼ŒæŠŠåŸæœ‰çš„ä¸€å¯¹å¤šçš„ä¾èµ–å˜æˆäº†ä¸€å¯¹ä¸€çš„ä¾èµ–ã€‚ ç¼ºç‚¹åŒäº‹ç±»è¶Šå¤šï¼Œä¸­ä»‹è€…çš„é€»è¾‘å°±è¶Šå¤æ‚ã€‚ ä½¿ç”¨åœºæ™¯ä¸­ä»‹è€…æ¨¡å¼é€‚ç”¨äºå¤šä¸ªå¯¹è±¡ä¹‹é—´ç´§å¯†è€¦åˆçš„æƒ…å†µï¼Œç´§å¯†è€¦åˆçš„æ ‡å‡†æ˜¯ï¼šåœ¨ç±»å›¾ä¸­å‡ºç°äº†èœ˜è››ç½‘çŠ¶ç»“æ„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä¸€å®šè¦è€ƒè™‘ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼ï¼Œè¿™æœ‰åˆ©äºæŠŠèœ˜è››ç½‘æ¢³ç†ä¸ºæ˜Ÿå‹ç»“æ„ï¼Œä½¿åŸæœ¬å¤æ‚æ··ä¹±çš„å…³ç³»å˜å¾—æ¸…æ™°ç®€å•ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦é‡åŠ›è€Œè¡Œï¼Œé¿å…ä¸­ä»‹è€…è¿‡äºå¤æ‚åŒ–ã€‚ å®é™…åº”ç”¨ æœºåœºè°ƒåº¦ä¸­å¿ƒ MVCæ¡†æ¶çš„Cåè°ƒMå’ŒV åª’ä½“ç½‘å…³â€”â€”ä¸­è½¬ç«™ ä¸­ä»‹æœåŠ¡ æœ€ä½³å®è·µå¯ä»¥åœ¨å¦‚ä¸‹çš„æƒ…å†µä¸‹å°è¯•ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼: Nä¸ªå¯¹è±¡ä¹‹é—´äº§ç”Ÿç›¸äº’çš„ä¾èµ–å…³ç³»ï¼ˆN &gt; 2ï¼‰ å¤šä¸ªå¯¹è±¡æœ‰ä¾èµ–å…³ç³»ï¼Œä½†æ˜¯ä¾èµ–çš„è¡Œä¸ºå°šä¸ç¡®å®šæˆ–è€…æœ‰å‘ç”Ÿæ”¹å˜çš„å¯èƒ½ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”åŸå‹æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F10%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç”±ä¸€ä¸ªæ­£æœ¬åˆ›å»ºå¤šä¸ªå‰¯æœ¬ï¼Œå¹¶å¯ä»¥è¿›è¡Œé€‚å½“çš„ä¿®æ”¹ï¼Œè¿™å°±æ˜¯åŸå‹æ¨¡å¼ã€‚ å®šä¹‰ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚â€”â€”åˆ›é€ ç±» ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ç±»å›¾ï¼š åŸå‹æ¨¡å¼çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªcloneæ–¹æ³•ï¼Œé€šè¿‡è¯¥æ–¹æ³•è¿›è¡Œå¯¹è±¡çš„æ‹·è´ï¼ŒJavaæä¾›äº†ä¸€ä¸ªCloneableæ¥å£æ ‡è¯†è¿™ä¸ªå¯¹è±¡æ˜¯å¯æ‹·è´çš„ï¼Œåœ¨JVMä¸­å…·æœ‰è¿™ä¸ªæ ‡è¯†çš„å¯¹è±¡æ‰æœ‰å¯èƒ½è¢«æ‹·è´ï¼Œä½†æ˜¯åªæœ‰åœ¨è¦†ç›–cloneæ–¹æ³•ä¹‹åæ‰å¯ä»¥è¢«æ‹·è´ã€‚ å®ƒçš„é€šç”¨ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526// æŠ½è±¡åŸå‹ç±»public abstract class Prototype implements Cloneable &#123; // è¦†å†™çˆ¶ç±»Objectæ–¹æ³• @Override public Prototype clone() &#123; Prototype prototype = null; try &#123; prototype = (Prototype) super.clone(); &#125; catch (CloneNotSupportedException e) &#123; // å¼‚å¸¸å¤„ç† &#125; return prototype; &#125;&#125;// å…·ä½“åŸå‹ç±»public class ConcretePrototype extends Prototype &#123;&#125;// åœºæ™¯ç±»public class Client &#123; Prototype prototype = new ConcretePrototype(); // å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ Prototype prototype1 = prototype.clone();&#125; åº”ç”¨ä¼˜ç‚¹ æ€§èƒ½ä¼˜è‰¯ã€‚åŸå‹æ¨¡å¼æ˜¯åœ¨å†…å­˜äºŒè¿›åˆ¶æµçš„æ‹·è´ï¼Œè¦æ¯”ç›´æ¥newä¸€ä¸ªå¯¹è±¡æ€§èƒ½å¥½çš„å¤šï¼Œç‰¹åˆ«æ˜¯è¦åœ¨ä¸€ä¸ªå¾ªç¯ä½“å†…äº§ç”Ÿå¤§é‡çš„å¯¹è±¡æ—¶ï¼Œ é€ƒé¿æ„é€ å‡½æ•°çš„çº¦æŸã€‚æ˜¯ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ã€‚ ä½¿ç”¨åœºæ™¯ èµ„æºä¼˜åŒ–åœºæ™¯ã€‚å› ä¸ºç±»çš„åˆå§‹åŒ–éœ€è¦æ¶ˆè€—éå¸¸å¤šçš„èµ„æºã€‚ æ€§èƒ½å’Œå®‰å…¨è¦æ±‚çš„åœºæ™¯ã€‚å› ä¸ºé€šè¿‡newäº§ç”Ÿä¸€ä¸ªå¯¹è±¡éœ€è¦éå¸¸ç¹ççš„æ•°æ®å‡†å¤‡å’Œè®¿é—®æƒé™ã€‚ ä¸€ä¸ªå¯¹è±¡å¤šä¸ªä¿®æ”¹è€…ã€‚è¿™æ ·æ¬¡å°±èƒ½é¿å…å¹¶å‘å¸¦æ¥æ•°æ®æ··ä¹±çš„é—®é¢˜ã€‚ åŸå‹æ¨¡å¼å¾ˆå°‘å•ç‹¬å‡ºç°ï¼Œä¸€èˆ¬æ˜¯ä¸å·¥å‚æ–¹æ³•æ¨¡å¼ä¸€èµ·å‡ºç°ï¼Œé€šè¿‡cloneçš„æ–¹æ³•åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åç”±å·¥å‚æ–¹æ³•æä¾›ç»™è°ƒç”¨è€…ã€‚ æ³¨æ„äº‹é¡¹ æ„é€ å‡½æ•°ä¸ä¼šæ‰§è¡Œã€‚å› ä¸ºObjectç±»çš„cloneæ–¹æ³•çš„åŸç†æ˜¯ä»å†…å­˜ä¸­ä»¥äºŒè¿›åˆ¶æµçš„æ–¹å¼è¿›è¡Œæ‹·è´ï¼Œé‡æ–°åˆ†é…ä¸€ä¸ªå†…å­˜å—ã€‚ æµ…æ‹·è´å’Œæ·±æ‹·è´ æµ…æ‹·è´ï¼šåªæ‹·è´æœ¬å¯¹è±¡ï¼Œå…¶å¯¹è±¡å†…éƒ¨çš„æ•°ç»„ã€å¼•ç”¨å¯¹è±¡ç­‰éƒ½ä¸æ‹·è´ï¼Œè¿˜æ˜¯æŒ‡å‘åŸç”Ÿå¯¹è±¡çš„å†…éƒ¨å…ƒç´ åœ°å€ã€‚ æ·±æ‹·è´ï¼šåœ¨æµ…æ‹·è´çš„åŸºç¡€ä¸Šï¼Œå¯¹ç§æœ‰çš„ç±»å˜é‡è¿›è¡Œç‹¬ç«‹çš„æ‹·è´ã€‚ ä½¿ç”¨åŸå‹æ¨¡å¼æ—¶ï¼Œå¼•ç”¨çš„æˆå‘˜å˜é‡å¿…é¡»æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶æ‰ä¸ä¼šè¢«æ‹·è´ï¼šä¸€æ˜¯ç±»çš„æˆå‘˜å˜é‡ï¼ŒäºŒæ˜¯å¿…é¡»æ˜¯ä¸€ä¸ªå¯å˜çš„å¼•ç”¨å¯¹è±¡ã€‚ å¯¹è±¡çš„cloneå’Œå¯¹è±¡å†…çš„finalå…³é”®å­—æ˜¯æœ‰å†²çªçš„ã€‚è¦ä½¿ç”¨cloneæ–¹æ³•ï¼Œç±»çš„æˆå‘˜å˜é‡ä¸Šä¸è¦å¢åŠ finalå…³é”®å­—ã€‚ æœ€ä½³å®è·µåŸå‹æ¨¡å¼å…ˆäº§ç”Ÿä¸€ä¸ªåŒ…å«å¤§é‡ä¿¡æ¯çš„ç±»ï¼Œç„¶åå¯ä»¥æ‹·è´å‡ºå‰¯æœ¬ï¼Œä¿®æ­£ç»†èŠ‚ä¿¡æ¯ï¼Œå»ºç«‹äº†ä¸€ä¸ªå®Œæ•´çš„ä¸ªæ€§å¯¹è±¡ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”ä»£ç†æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F09%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¦‚æœä½ ä¸æƒ³å¹²å°±æ‰¾ä¸ªä»£ç†å¸®ä½ å¹²å¥½äº†ï¼Œå°±åƒæ¸¸æˆä¸æƒ³è‡ªå·±å‡çº§å°±æ‰¾ä¸ªä»£ç†å¸®ä½ å‡çº§å¥½äº†ï¼Œè¿™å°±æ˜¯ä»£ç†æ¨¡å¼ã€‚ å®šä¹‰ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚â€”â€”ç»“æ„ç±»ã€‚ å®ƒçš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç±»å›¾ä¸­çš„ä¸‰ä¸ªè§’è‰²ï¼š SubjectæŠ½è±¡ä¸»é¢˜è§’è‰²ï¼šå®ƒå¯ä»¥æ˜¯æŠ½è±¡ç±»ä¹Ÿå¯ä»¥æ˜¯æ¥å£ï¼Œæ˜¯ä¸€ä¸ªæœ€æ™®é€šçš„ä¸šåŠ¡ç±»å‹å®šä¹‰ã€‚ RealSubjectå…·ä½“ä¸»é¢˜è§’è‰²ï¼šä¹Ÿå«åšè¢«å§”æ‰˜è§’è‰²ã€è¢«ä»£ç†è§’è‰²ã€‚ Proxyä»£ç†ä¸»é¢˜è§’è‰²ï¼šä¹Ÿå«åšå§”æ‰˜ç±»ã€ä»£ç†ç±»ã€‚å®ƒè´Ÿè´£å¯¹çœŸå®è§’è‰²çš„åº”ç”¨ï¼ŒæŠŠæ‰€æœ‰æŠ½è±¡ä¸»é¢˜ç±»å®šä¹‰çš„æ–¹æ³•é™åˆ¶å§”æ‰˜ç»™çœŸå®ä¸»é¢˜è§’è‰²å®ç°ï¼Œå¹¶ä¸”åœ¨çœŸå®ä¸»é¢˜è§’è‰²å¤„ç†å®Œæ¯•å‰ååšé¢„å¤„ç†å’Œå–„åå¤„ç†å·¥ä½œã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨å®ç°ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243// æŠ½è±¡ä¸»é¢˜ç±»public interface Subject &#123; // å®šä¹‰ä¸€ä¸ªæ–¹æ³• public void request();&#125;// çœŸå®ä¸»é¢˜ç±»public class RealSubject implements Subject &#123; // å®ç°æ–¹æ³• @Override public void request() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125;&#125;// ä»£ç†ç±»public class Proxy implements Subject &#123; // è¦ä»£ç†å“ªä¸ªå®ç°ç±» private Subject subject = null; // é»˜è®¤è¢«ä»£ç†è€… public Proxy() &#123; this.subject = new Proxy(); &#125; // é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’è¢«ä»£ç†è€… public Proxy(Subject _subject) &#123; this.subject = _subject; &#125; // å®ç°æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³• @Override public void request() &#123; this.before(); this.subject.request(); this.after(); &#125; // é¢„å¤„ç† private void before() &#123; // do something &#125; // å–„åå¤„ç† private void after() &#123; // do something(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ èŒè´£æ¸…æ™°ï¼ŒçœŸå®çš„è§’è‰²å°±æ˜¯å®ç°å®é™…çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç”¨å…³å¿ƒå…¶ä»–éæœ¬èŒè´£çš„äº‹åŠ¡ï¼Œé€šè¿‡åæœŸçš„ä»£ç†å®Œæˆä¸€ä»¶äº‹åŠ¡ã€‚ é«˜æ‰©å±•æ€§ï¼Œæ— è®ºå…·ä½“è§’è‰²æ€ä¹ˆå˜åŒ–ã€‚ ä½¿ç”¨åœºæ™¯å…¸å‹çš„Spring AOP æ‰©å±•æ™®é€šä»£ç†è¦æ±‚åªèƒ½è®¿é—®ä»£ç†è§’è‰²ï¼Œè€Œä¸èƒ½è®¿é—®çœŸå®è§’è‰²ï¼ŒçœŸå®è§’è‰²çš„åˆ›å»ºæ˜¯åœ¨ä»£ç†çš„å†…éƒ¨åˆ›å»ºçš„ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œè°ƒç”¨è€…åªçŸ¥ä»£ç†è€Œä¸ç”¨çŸ¥é“çœŸå®çš„è§’è‰²æ˜¯è°ï¼Œå±è”½äº†çœŸå®è§’è‰²çš„å˜æ›´å¯¹é«˜å±‚æ¨¡å—çš„å½±å“ã€‚ psï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡çº¦å®šæ¥ç¦æ­¢newä¸€ä¸ªçœŸå®çš„è§’è‰²ã€‚ å¼ºåˆ¶ä»£ç†è¦æ±‚å¿…é¡»é€šè¿‡çœŸå®è§’è‰²æ‰¾åˆ°ä¸€ä¸ªä»£ç†è§’è‰²ï¼Œå¦åˆ™ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œå³è¦æ±‚çœŸå®è§’è‰²æœ‰ä¸€ä¸ªèµ‹äºˆè‡ªå·±ä¸€ä¸ªä»£ç†çš„æ–¹æ³•ã€‚ ä»£ç†å¢å¼ºä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä»£ç†ç±»ä¹Ÿå¯ä»¥å®ç°å¤šä¸ªä¸»é¢˜æ¥å£ï¼Œå®ç°ä¸åŒçš„ä»»åŠ¡ã€‚è€Œä¸”ä»£ç†çš„ç›®çš„æ˜¯åœ¨ç›®æ ‡å¯¹è±¡æ–¹æ³•çš„åŸºç¡€ä¸Šåšå¢å¼ºï¼Œè¿™ç§å¢å¼ºçš„æœ¬è´¨é€šå¸¸æ˜¯å¯¹ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ç²¾å¿ƒæ‹¦æˆªå’Œè¿‡æ»¤ã€‚ä»£ç†ç±»å¯ä»¥ä¸ºçœŸæ˜¯è§’è‰²é¢„å¤„ç†æ¶ˆæ¯ã€è¿‡æ»¤æ¶ˆæ¯ã€æ¶ˆæ¯è½¬å‘ã€äº‹åå¤„ç†æ¶ˆæ¯ç­‰åŠŸèƒ½ã€ åŠ¨æ€ä»£ç†åŠ¨æ€ä»£ç†æ˜¯åœ¨å®ç°é˜¶æ®µä¸ç”¨å…³å¿ƒä»£ç†è°ï¼Œè€Œæ˜¯åœ¨è¿è¡Œé˜¶æ®µæ‰æŒ‡å®šä»£ç†å“ªä¸€ä¸ªå¯¹è±¡ï¼Œå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¹Ÿå«AOPã€‚ ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ç±»å›¾ï¼š ä¸¤æ¡ç‹¬ç«‹å‘å±•çš„çº¿è·¯ã€‚åŠ¨æ€ä»£ç†å®ç°ä»£ç†çš„èŒè´£ï¼Œä¸šåŠ¡é€»è¾‘Subjectå®ç°ç›¸å…³çš„é€»è¾‘åŠŸèƒ½ï¼Œä¸¤è€…æ²¡æœ‰å¿…ç„¶çš„ç›¸äº’è€¦åˆçš„å…³ç³»ã€‚é€šçŸ¥Adviceä»å¦ä¸€ä¸ªåˆ‡é¢åˆ‡å…¥ï¼Œæœ€ç»ˆåœ¨é«˜å±‚æ¨¡å—Clientè¿›è¡Œè€¦åˆï¼Œå®Œæˆé€»è¾‘çš„å°è£…ä»»åŠ¡ã€‚ä¸‹é¢æ˜¯ä»–çš„é€šç”¨å®ç°ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768// æŠ½è±¡ä¸»é¢˜public interface Subject &#123; // ä¸šåŠ¡æ“ä½œ public void doSomething(String str);&#125;// çœŸå®ä¸»é¢˜public class RealSubject implements Subject &#123; // ä¸šåŠ¡æ“ä½œ public void doSomething(String str) &#123; System.out.println("do Something!----&gt;" + str); &#125;&#125;// åŠ¨æ€ä»£ç†çš„Handlerpublic class MyInvocationHandler implements InvocationHandler &#123; // è¢«ä»£ç†çš„å¯¹è±¡ private Object target = null; // é€šè¿‡ä¸€ä¸ªæ„é€ å‡½æ•°ä¼ é€’ä¸€ä¸ªå¯¹è±¡ public MyInvocationHandler(Object _obj) &#123; this.target = _obj; &#125; public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; return method.invoke(this.target,args); &#125;&#125;// åŠ¨æ€ä»£ç†ç±»public class DynamicProxy&lt;T&gt; &#123; public static &lt;T&gt; T newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h) &#123; // Spring AOPçŸ¥è¯†ã€‚ if (true) &#123; // æ‰§è¡Œä¸€ä¸ªå‰ç½®é€šçŸ¥ (new BeforeAdvice()).exec(); &#125; // æ‰§è¡Œç›®æ ‡ï¼Œå¹¶è¿”å›ç»“æœ return (T) Proxy.newProxyInstance(loader,interfaces,h); &#125;&#125;// é€šçŸ¥æ¥å£åŠå®ç°public interface IAdvice &#123; // é€šçŸ¥åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæ‰§è¡Œå³å¯ public void exec();&#125;public class BeforeAdvice implements IAdvice &#123; public void exec() &#123; System.out.println("æˆ‘æ˜¯å‰ç½®é€šçŸ¥ï¼Œæˆ‘è¢«æ‰§è¡Œäº†ï¼"); &#125;&#125;// åŠ¨æ€ä»£ç†çš„åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å®šä¹‰ä¸€ä¸ªä¸»é¢˜ Subject subject = new RealSubject(); // å®šä¹‰ä¸€ä¸ªHandler InvocationHandler invocationHandler = new MyInvocationHandler(subject); // å®šä¹‰ä¸»é¢˜çš„ä»£ç† Subject proxy = DynamicProxy.newProxyInstance(subject.getClass().getClassLoader(),subject.getClass().getInterfaces(),invocationHandler); // ä»£ç†çš„è¡Œä¸º proxy.doSomething("Finish"); &#125;&#125;// è¾“å‡ºæˆ‘æ˜¯å‰ç½®é€šçŸ¥ï¼Œæˆ‘è¢«æ‰§è¡Œäº†ï¼do Something!----&gt;Finish subject.getInterfaces()æ˜¯æŸ¥æ‰¾è¯¥ç±»çš„æ‰€æœ‰æ¥å£ï¼Œç„¶åå®ç°æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œç„¶ååˆInvocationHandlerå®ç°è¯¥ç±»çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œç”±å…¶invokeæ–¹æ³•æ¥ç®¡æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚å…¶åŠ¨æ€è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼š Client -&gt; dynamicProxy -&gt; MyInvocationHandler -&gt; RealSubject ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºè¦å®ç°åŠ¨æ€ä»£ç†çš„é¦–è¦æ¡ä»¶æ—¶ï¼šè¢«ä»£ç†ç±»è¦å®ç°ä¸€ä¸ªæ¥å£ã€‚ æœ€ä½³å®è·µä»£ç†æ¨¡å¼åº”ç”¨å¾—éå¸¸å¹¿æ³›ï¼Œå¤§åˆ°ä¸€ä¸ªç³»ç»Ÿæ¡†æ¶ã€ä¼ä¸šå¹³å°ï¼Œå°åˆ°ä»£ç ç‰‡æ®µã€äº‹åŠ¡å¤„ç†ï¼Œéƒ½ä¼šç”¨åˆ°ä»£ç†æ¨¡å¼ã€‚ç‰¹åˆ«æ˜¯åœ¨Sping AOPé‡Œé¢ï¼Œå¦‚æœè°ƒè¯•çœ‹åˆ°$Proxy()è¿™ä¸ªä¸œè¥¿ï¼Œå®ƒåº”è¯¥å°±æ˜¯ä¸€ä¸ªåŠ¨æ€ä»£ç†äº†ã€‚ åœ¨å­¦ä¹ AOPæ¡†æ¶æ—¶ï¼Œå¼„æ¸…æ¥šå‡ ä¸ªåè¯å°±æˆï¼šåˆ‡é¢ï¼ˆAspectï¼‰ã€åˆ‡å…¥ç‚¹ï¼ˆJoinPointï¼‰ã€é€šçŸ¥ï¼ˆAdviceï¼‰ã€ç»‡å…¥ï¼ˆweaveï¼‰å°±è¶³å¤Ÿäº†ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å»ºé€ è€…æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F08%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç”Ÿäº§ä¸€ä¸ªäº§å“ï¼Œå®ƒå¿…ç„¶æœ‰å¾ˆå¤šé›¶éƒ¨ä»¶ï¼Œä¸åŒçš„ç»„è£…é¡ºåºå’Œé›¶éƒ¨ä»¶ä¸ªæ•°å¯èƒ½ä¼šå¯¼è‡´ä¸åŒçš„äº§å“ï¼Œé€šè¿‡æ§åˆ¶è¿™äº›é¡ºåºä¸ä¸ªæ•°å¯ä»¥è¾¾åˆ°å¿«é€Ÿç”Ÿæˆä¸åŒäº§å“çš„ç›®çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ã€‚ å®šä¹‰å»ºé€ è€…æ¨¡å¼ä¹Ÿå«åšç”Ÿæˆå™¨æ¨¡å¼ã€‚ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚â€”â€”åˆ›é€ ç±» é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š åœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œæœ‰å¦‚ä¸‹4ä¸ªè§’è‰²ï¼š Productäº§å“ç±»ï¼šé€šå¸¸æ˜¯å®ç°äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æœ‰æ¨¡æ¿æ–¹æ³•å’ŒåŸºæœ¬æ–¹æ³•ã€‚è¿™ä¸ªå¯ä»¥çœ‹ä¹‹å‰å†™çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚ BuilderæŠ½è±¡å»ºé€ è€…ï¼šè§„èŒƒäº§å“çš„ç»„ä»¶ï¼Œä¸€èˆ¬æ˜¯ç”±å­ç±»å®ç°ã€‚ ContreteBuilderå…·ä½“å»ºé€ è€…ï¼šå®ç°æŠ½è±¡ç±»å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªç»„å»ºå¥½çš„å¯¹è±¡ã€‚ Directorå¯¼æ¼”ç±»ï¼šè´Ÿè´£å®‰æ’å·²æœ‰æ¨¡å—çš„é¡ºåºï¼Œç„¶åå‘Šè¯‰Builderå¼€å§‹å»ºé€ ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„æºç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940// äº§å“ç±» é€šå¸¸ç”±æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®ç°public class Product &#123; // ä¸€ä¸ªæ–¹æ³•ç›¸å½“äºäº§å“çš„ä¸€ä¸ªé›¶ä»¶ public void doSomething() &#123; // ç‹¬ç«‹ä¸šåŠ¡å¤„ç† &#125;&#125;// æŠ½è±¡å»ºé€ è€…public abstract class Builder &#123; // è®¾ç½®äº§å“çš„ä¸åŒéƒ¨åˆ†(åŒ…æ‹¬é›¶ä»¶ç§ç±»å’Œé¡ºåº)ï¼Œä»¥è·å¾—ä¸åŒçš„äº§å“ public abstract void setPart(); // å»ºé€ äº§å“ public abstract Product bulidProduct();&#125;// å…·ä½“å»ºé€ è€…public class ContreteBuilder extends Builder &#123; private Product product = new Product(); @Override public void setPart() &#123; // äº§å“ç±»å†…éƒ¨é€»è¾‘ &#125; @Override public Product buildProduct() &#123; return product; &#125;&#125;// å¯¼æ¼”ç±»ï¼Œèµ·åˆ°å°è£…çš„ä½œç”¨ï¼Œé¿å…é«˜å±‚æ¨¡å—æ·±å…¥åˆ°å»ºé€ è€…å†…éƒ¨çš„å®ç°ç±»ã€‚public class Director &#123; private Builder builder = new ContreteBuilder(); public Product getProduct() &#123; builder.setPart(); return builder.buildProduct(); &#125;&#125; åº”ç”¨ä¼˜ç‚¹ å°è£…æ€§ï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯ä»¥ä½¿å®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ã€‚ å»ºé€ è€…ç‹¬ç«‹ï¼Œå®¹æ˜“æ‰©å±•ã€‚ ä½¿ç”¨åœºæ™¯ ç›¸åŒæ–¹æ³•ï¼Œä¸åŒæ‰§è¡Œé¡ºåºï¼Œäº§ç”Ÿä¸åŒäº‹ä»¶ç»“æœæ—¶ï¼Œå¯ä»¥é‡‡ç”¨å»ºé€ è€…æ¨¡å¼ã€‚ å¤šä¸ªéƒ¨ä»¶æˆ–é›¶ä»¶ï¼Œéƒ½å¯ä»¥è£…é…åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯äº§ç”Ÿä¸åŒçš„æ•ˆèƒ½ï¼Œå¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ã€‚ äº§å“ç±»ä¸­çš„è°ƒç”¨é¡ºåºä¸åŒäº§ç”Ÿä¸åŒçš„æ•ˆèƒ½ï¼Œå¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ã€‚ æ³¨æ„äº‹é¡¹å»ºé€ è€…æ¨¡å¼å…³æ³¨çš„æ˜¯é›¶ä»¶ç±»å‹å’Œè£…é…å·¥è‰ºï¼ˆé¡ºåºï¼‰ï¼Œè¿™æ˜¯å®ƒä¸å·¥å‚æ–¹æ³•æ¨¡å¼æœ€å¤§ä¸åŒçš„åœ°æ–¹ã€‚ æœ€ä½³å®è·µåœ¨ä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„æ—¶å€™è€ƒè™‘ä¸€ä¸‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œåˆ«å­¤ç«‹åœ°æ€è€ƒä¸€ä¸ªæ¨¡å¼ï¼ŒåƒµåŒ–å¾—å¥—ç”¨ä¸€ä¸ªæ¨¡å¼ä¼šè®©ä½ å—å®³æ— ç©·ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”æ¨¡æ¿æ–¹æ³•æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F08%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå°‘å†™ä»£ç ï¼Œå¤§å®¶ä¸€å®šè§‰å¾—å¾ˆæœ‰å¸å¼•åŠ›ã€‚è€Œä¸”è¿˜æ˜¯å…ˆç¡®å®šä¸€ä¸ªæ¡†æ¶ï¼Œå†å†™å…¶ä¸­çš„éƒ¨åˆ†ï¼Œè¿™ä¹ˆç»“æ„æ¸…æ™°åœ°å†™ä»£ç ï¼Œå¤§å®¶ä¸€å®šä¼šè§‰å¾—æ›´æœ‰å¸å¼•åŠ›ï¼Œé‚£ä¹ˆæˆ‘æƒ³æ¨¡æ¿æ–¹æ³•æ¨¡å¼å¯ä»¥è¾¾åˆ°ä½ çš„éœ€æ±‚ã€‚ å®šä¹‰å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„æ¡†æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚â€”â€”è¡Œä¸ºç±» ä¸‹é¢æ˜¯ä»–çš„é€šç”¨ç±»å›¾ï¼š å…¶ä¸­AbstractClasså«åšæŠ½è±¡æ¨¡æ¿ï¼Œå®ƒçš„æ–¹æ³•åˆ†ä¸ºä¸¤ç±»ï¼š åŸºæœ¬æ–¹æ³•ï¼šç”±å­ç±»å®ç°çš„æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ¨¡æ¿æ–¹æ³•è¢«è°ƒç”¨ã€‚ æ¨¡æ¿æ–¹æ³•ï¼šä¸€èˆ¬æ˜¯ä¸€ä¸ªå…·ä½“æ–¹æ³•ï¼Œå®ç°å¯¹åŸºæœ¬æ–¹æ³•çš„è°ƒåº¦ï¼Œå®Œæˆå›ºå®šçš„é€»è¾‘ã€‚ ä¸ºäº†é˜²æ­¢æ¶æ„çš„æ“ä½œï¼Œä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Šfinalå…³é”®å­—ï¼Œä¸å…è®¸è¢«è¦†å†™ã€‚ è€ŒConcreteClasså±äºå…·ä½“æ¨¡æ¿ï¼Œå®ç°çˆ¶ç±»æ‰€å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ã€‚ ä¸‹é¢å†çœ‹çœ‹ä»–çš„é€šç”¨ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// æŠ½è±¡æ¨¡æ¿ç±»public abstract class AbstrctClass &#123; // åŸºæœ¬æ–¹æ³• protected abstract void doSomething(); // åŸºæœ¬æ–¹æ³• protected abstract void doAngthing(); // æ¨¡æ¿æ–¹æ³• final public void templateMethod() &#123; // è°ƒç”¨åŸºæœ¬æ–¹æ³•ï¼Œå®Œæˆç›¸å…³é€»è¾‘ this.doAnything(); this.doSomething(); &#125;&#125;// å…·ä½“æ¨¡æ¿ç±»public class ContreteClass1 extends AbstractClass &#123; // å®ç°åŸºæœ¬æ–¹æ³• @Override protected void doAngthing() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125; @Override protected void doSomething() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125;&#125;public class ContreteClass2 extends AbstractClass &#123; // å®ç°åŸºæœ¬æ–¹æ³• @Override protected void doAngthing() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125; @Override protected void doSomething() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main (String[] args) &#123; AbstractClass class1 = new ConcreteClass1(); AbstractClass class2 = new ConcreteClass2(); // è°ƒç”¨æ¨¡æ¿æ–¹æ³• class1.templateMethod(); class2.templateMethod(); &#125;&#125; æŠ½è±¡æ¨¡æ¿ä¸­çš„åŸºæœ¬æ–¹æ³•å°½é‡è®¾è®¡ä¸ºprotectedç±»å‹ï¼Œç¬¦åˆè¿ªç±³ç‰¹åŸåˆ™ã€‚å®ç°ç±»è‹¥éå¿…è¦ï¼Œå°½é‡ä¸è¦æ‰©å¤§çˆ¶ç±»ä¸­çš„è®¿é—®æƒé™ã€‚ åº”ç”¨ä¼˜ç‚¹ å°è£…ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ã€‚ æå–å…¬å…±éƒ¨åˆ†ä»£ç ï¼Œä¾¿äºç»´æŠ¤ã€‚ è¡Œä¸ºç”±çˆ¶ç±»æ§åˆ¶ï¼Œå­ç±»å®ç°ã€‚ç¬¦åˆå¼€é—­åŸåˆ™ã€‚ ç¼ºç‚¹æ˜¯ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ï¼šå­ç±»å¯¹çˆ¶ç±»äº§ç”Ÿäº†å½±å“ã€‚ ä½¿ç”¨åœºæ™¯ å¤šä¸ªå­ç±»æœ‰å…¬æœ‰çš„æ–¹æ³•ï¼Œå¹¶ä¸”é€»è¾‘åŸºæœ¬ç›¸åŒã€‚ é‡è¦ã€å¤æ‚çš„ç®—æ³•ï¼Œå¯ä»¥æŠŠæ ¸å¿ƒç®—æ³•è®¾è®¡ä¸ºæ¨¡æ¿æ–¹æ³•ï¼Œå‘¨è¾¹çš„ç›¸å…³ç»†èŠ‚åŠŸèƒ½åˆ™ç”±å„ä¸ªå­ç±»å®ç°ã€‚ é‡æ„æ—¶ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸€ä¸ªå¸¸ç”¨çš„æ¨¡å¼ï¼ŒæŠŠç›¸åŒçš„ä»£ç æŠ½å–åˆ°çˆ¶ç±»ä¸­ï¼Œç„¶åé€šè¿‡é’©å­å‡½æ•°çº¦æŸå…¶è¡Œä¸ºã€‚æœ‰äº†é’©å­æ–¹æ³•çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ‰æ˜¯å®Œç¾çš„ã€‚ psï¼šé’©å­æ–¹æ³•å°±æ˜¯å­ç±»å®ç°çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨å…¶è¿”å›å€¼å†³å®šå…¬å…±éƒ¨åˆ†çš„æ‰§è¡Œç»“æœã€‚ æœ€ä½³å®è·µ çˆ¶ç±»å¦‚ä½•è°ƒç”¨å­ç±»çš„æ–¹æ³•ï¼ˆæåº¦ä¸å»ºè®®è¿™ä¹ˆåšï¼‰ æŠŠå­ç±»ä¼ é€’åˆ°çˆ¶ç±»çš„æœ‰å‚æ„é€ å‡½æ•°ä¸­ï¼Œç„¶åè°ƒç”¨ã€‚ ä½¿ç”¨åå°„çš„æ–¹å¼è°ƒç”¨ã€‚ çˆ¶ç±»è°ƒç”¨å­ç±»çš„é™æ€æ–¹æ³•ã€‚ ä½†æ˜¯é€šè¿‡æ¨¡æ¿æ–¹æ³•æ¨¡å¼å°±å¯ä»¥å˜ç›¸åœ°å®ç°çˆ¶ç±»è°ƒç”¨å­ç±»çš„æ–¹æ³•ã€‚ åœ¨å¼€æºæ¡†æ¶ä¸­ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç„¶åå¼€æºæ¡†æ¶å†™äº†ä¸€å †å­ç±»ã€‚å¦‚æœä½ éœ€è¦æ‰©å±•ï¼Œå¯ä»¥ç»§æ‰¿è¿™ä¸ªæŠ½è±¡ç±»ï¼Œç„¶åè¦†å†™protectedæ–¹æ³•ï¼Œå†è°ƒç”¨ä¸€ä¸ªç±»ä¼¼executeæ–¹æ³•ï¼Œå°±å®Œæˆäº†æ‰©å±•å¼€å‘ã€‚ç›¸ä¿¡å¤§å®¶ä¸€å®šæ·±æœ‰æ„Ÿè§¦ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”æŠ½è±¡å·¥å‚æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F07%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨å¼€å‘åº”ç”¨çš„æ—¶å€™ä¸ºäº†é€‚åº”ä¸åŒçš„æ“ä½œç³»ç»Ÿä»¥åŠä¸åŒæ•°æ®åº“æ—¶ï¼Œæˆ‘ä»¬æ€»ä¼šæ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚è€ŒæŠ½è±¡å·¥å‚æ¨¡å¼ä¸ºäº†æˆ‘ä»¬æä¾›äº†ä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆã€‚ å®šä¹‰ä¸ºåˆ›å»ºä¸€ç»„ç›¸å…³æˆ–ç›¸äº’ä¾èµ–çš„å¯¹è±¡æä¾›ä¸€ä¸ªæ¥å£ï¼Œè€Œä¸”æ— é¡»æŒ‡å®šä»–ä»¬çš„å…·ä½“ç±»ã€‚â€”â€”åˆ›é€ ç±» å®ƒçš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š ä¸ºäº†å±•ç¤ºé€šç”¨çš„æºä»£ç ï¼Œå°†åŸæ¥çš„é€šç”¨ç±»å›¾æ‰©å±•ä¸ºå¦‚ä¸‹ç±»å›¾ï¼š ä¸‹é¢æ˜¯åŸºäºç±»å›¾çš„ä»£ç :12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273// æŠ½è±¡äº§å“ç±» ProductAä¸ProductBç±»ä¼¼;1,2ä»£è¡¨äº§å“ç­‰çº§public abstract class AbstractProductA &#123; // æ¯ä¸ªäº§å“å…±æœ‰æ–¹æ³• public void shareMethod() &#123; ... &#125; // æ¯ä¸ªäº§å“ç›¸åŒæ–¹æ³•ï¼Œä¸åŒå®ç° public abstract void doSomething();&#125;// äº§å“A1çš„å®ç°ç±»public class ProductA1 extends AbstractProductA &#123; @Override public void doSomething() &#123; System.out.println("äº§å“A1çš„å®ç°æ–¹æ³•"); &#125;&#125;// äº§å“A2çš„å®ç°ç±»public class ProductA2 extends AbstractProductA &#123; @Override public void doSomething() &#123; System.out.println("äº§å“A2çš„å®ç°æ–¹æ³•"); &#125;&#125;// æŠ½è±¡å·¥å‚ç±» æœ‰Nä¸ªäº§å“æ—ï¼Œåœ¨æŠ½è±¡å·¥å‚ç±»å°±æœ‰Nä¸ªåˆ›å»ºæ–¹æ³•public abstract class AbstractCreator &#123; // åˆ›å»ºAäº§å“å®¶æ— public abstract AbstractProductA createProductA(); // åˆ›å»ºBäº§å“å®¶æ— public abstract AbstractProductB createProductB();&#125;// æœ‰Mä¸ªäº§å“ç­‰çº§å°±åº”è¯¥æœ‰Mä¸ªå®ç°å·¥å‚ç±»ï¼Œåœ¨æ¯ä¸ªå®ç°å·¥å‚ä¸­ï¼Œå®ç°ä¸åŒäº§å“æ—çš„ç”Ÿäº§ä»»åŠ¡// äº§å“ç­‰çº§1çš„å®ç°ç±»public class Creator1 extends AbstractCreator &#123; // åªç”Ÿäº§äº§å“ç­‰çº§ä¸º1çš„Aäº§å“ public AbstractProductA createProductA() &#123; retrurn new ProductA1(); &#125; // åªç”Ÿäº§äº§å“ç­‰çº§ä¸º1çš„Bäº§å“ public AbstractProductB createProductB() &#123; retrurn new ProductB1(); &#125;&#125;// äº§å“ç­‰çº§2çš„å®ç°ç±»public class Creator2 extends AbstractCreator &#123; // åªç”Ÿäº§äº§å“ç­‰çº§ä¸º2çš„Aäº§å“ public AbstractProductA createProductA() &#123; retrurn new ProductA2(); &#125; // åªç”Ÿäº§äº§å“ç­‰çº§ä¸º2çš„Bäº§å“ public AbstractProductB createProductB() &#123; retrurn new ProductB2(); &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; // å®šä¹‰ä¸¤ä¸ªå·¥å‚ AbstractCreator creator1 = new Creator1(); AbstractCreator creator2 = new Creator2(); // äº§ç”ŸA1å¯¹è±¡ AbstractProductA a1 = creator1.createProductA(); // äº§ç”ŸA2å¯¹è±¡ AbstractProductA a2 = creator2.createProductA(); // äº§ç”ŸB1å¯¹è±¡ AbstractProductB b1 = creator1.createProductB(); // äº§ç”ŸB2å¯¹è±¡ AbstractProductB b2 = creator2.createProductB(); &#125;&#125; ä¸»è¦æ˜¯è¦ç†è§£äº§å“æ—ä»¥åŠäº§å“ç­‰çº§çš„å…³ç³»ã€‚ åº”ç”¨ä¼˜ç‚¹ å°è£…æ€§ï¼Œå®ƒåªéœ€è¦äº†è§£æ¥å£ã€‚ äº§å“æ—çš„çº¦æŸä¸ºéå…¬å¼€çŠ¶æ€ã€‚ ç¼ºç‚¹æ‰©å±•éå¸¸å›°éš¾ã€‚å¦‚æœè¦æ–°å¢ä¸€ä¸ªäº§å“ï¼Œéœ€è¦ä¿®æ”¹AbstractCreatorç±»ä»¥åŠå®ƒçš„å®ç°ç±»ã€‚è¿™ä¸¥é‡è¿åäº†å¼€é—­åŸåˆ™ã€‚ ä½¿ç”¨åœºæ™¯å¦‚æœä¸€ä¸ªå¯¹è±¡æ—éƒ½æœ‰ç›¸åŒçš„çº¦æŸï¼Œå°±å¯ä»¥ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚ä¾‹å¦‚linuxå’Œwindowsä¸‹å¾—ç¼–è¾‘å™¨å’Œä¸åŒæ•°æ®åº“çš„è§„èŒƒæ“ä½œã€‚ æ³¨æ„äº‹é¡¹ä¸Šé¢çš„æ‰©å±•å›°éš¾æ˜¯æŒ‡äº§å“æ—æ‰©å±•å›°éš¾ï¼Œä½†æ˜¯äº§å“ç­‰çº§æ‰©å±•è¿˜æ˜¯å®¹æ˜“çš„ã€‚ æœ€ä½³å®è·µåœ¨æ¶‰åŠä¸åŒæ“ä½œç³»ç»Ÿï¼Œä¸åŒæ•°æ®åº“çš„æ—¶å€™éå¸¸é€‚åˆæŠ½è±¡å·¥å‚æ¨¡å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥å±è”½æ‰æ“ä½œç³»ç»Ÿæˆ–æ•°æ®åº“å¯¹åº”ç”¨çš„å½±å“ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å·¥å‚æ–¹æ³•æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F06%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨é¢å‘å¯¹è±¡çš„æ€ç»´ä¸­ï¼Œä¸‡ç‰©çš†å¯¹è±¡ï¼Œå°±åƒæœ‰å¥³èœ—é€ äººï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼é€ å¯¹è±¡ã€‚ å®šä¹‰å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚å·¥å‚æ–¹æ³•ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å­ç±»ã€‚â€”â€”åˆ›é€ ç±» å·¥å‚æ–¹æ³•æ¨¡å¼çš„é€šç”¨ç±»å›¾å¦‚ä¸‹ï¼š ä¸‹é¢æ˜¯ä¸€ä¸ªæ¯”è¾ƒå®ç”¨çš„é€šç”¨æºç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657// æŠ½è±¡äº§å“ç±»public abstract class Product &#123; // äº§å“ç±»çš„å…¬å…±æ–¹æ³• public void method1() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125; //æŠ½è±¡æ–¹æ³• public abstract void method2();&#125;// å…·ä½“äº§å“ç±»public class ContreteProduct1 extends Product &#123; @Override public void method2() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125;&#125;public class ContreteProduct2 extends Product &#123; @Override public void method2() &#123; // ä¸šåŠ¡é€»è¾‘å¤„ç† &#125;&#125;// æŠ½è±¡å·¥å‚ç±»public abstract class Creator &#123; /* * åˆ›å»ºä¸€ä¸ªäº§å“å¯¹è±¡ï¼Œå…¶è¾“å…¥å‚æ•°ç±»å‹å¯ä»¥è‡ªè¡Œè®¾ç½® * é€šå¸¸ä¸ºString, Enum, Classç­‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸ºç©º */ public abstract &lt;T extends Product&gt; T createProduct(Class&lt;T&gt; c);&#125;// å…·ä½“å·¥å‚ç±»public class ContreteCreator extends Creator &#123; public abstract &lt;T extends Product&gt; T createProduct(Class&lt;T&gt; c) &#123; Product product = null; try &#123; product = (Product) Class.forName(c.getName()).newInstance(); &#125; catch (Exception e) &#123; // å¼‚å¸¸å¤„ç† &#125; return ï¼ˆTï¼‰product; &#125;&#125;// åœºæ™¯ç±»public class Client &#123; public static void main(String[] args) &#123; Creator creator = new ContreteCreate(); Product product = creator.createProduct(ContreteProduct1.class); /* * ç»§ç»­ä¸šåŠ¡å¤„ç† */ &#125;&#125; åº”ç”¨ä¼˜ç‚¹ è‰¯å¥½çš„å°è£…æ€§ï¼Œä»£ç ç»“æ„æ¸…æ™°ã€‚ æ‰©å±•æ€§éå¸¸ä¼˜ç§€ï¼Œè¦å¢åŠ ä¸€ä¸ªæ–°çš„äº§å“ï¼Œåªè¦å®ç°Productæ¥å£ã€‚ å±é—­äº§å“ç±»ã€‚åªè¦å…³å¿ƒäº§å“çš„æ¥å£å³å¯ï¼Œä¾‹å¦‚æ¢æ•°æ®åº“åªè¦æ¢é©±åŠ¨å³å¯ã€‚ ç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™ï¼ˆåªè¦çŸ¥é“äº§å“çš„æ¥å£å³å¯ï¼‰ï¼›ç¬¦åˆä¾èµ–å€’ç½®åŸåˆ™ï¼ˆå€¼ä¾èµ–äº§å“çš„æŠ½è±¡ç±»å³å¯ï¼‰ï¼›ç¬¦åˆé‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆä½¿ç”¨äº§å“å­ç±»å¯ä»¥æ›¿æ¢äº§å“çˆ¶ç±»ï¼‰ã€‚ ä½¿ç”¨åœºæ™¯ åªè¦ä½¿ç”¨newçš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œä½†æ˜¯è¦è€ƒè™‘ä»£ç çš„å¤æ‚åº¦ã€‚ éœ€è¦çµæ´»çš„ï¼Œå¯æ‰©å±•çš„æ¡†æ¶æ—¶ï¼ˆæœ‰å¤šä¸ªäº§å“å¯é€‰ä¸”å¯ä»¥éšæ—¶å¢åŠ æ—¶ï¼‰ï¼Œå¯ä»¥è€ƒè™‘å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼å¯ä»¥ç”¨åœ¨å¼‚æ„é¡¹ç›®ä¸­ã€‚ å¯ä»¥ä½¿ç”¨åœ¨æµ‹è¯•é©±åŠ¨å¼€å‘çš„æ¡†æ¶ä¸‹ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ‰©å±• ç¼©å°ä¸ºç®€å•å·¥å‚æ¨¡å¼ å®è´¨æ˜¯å»æ‰äº†åˆ›é€ è€…æ¥å£ï¼Œä½¿å…·ä½“åˆ›é€ è€…ç›´æ¥ä¾èµ–äº§å“æ¥å£ã€‚ç¼ºç‚¹æ˜¯æ‰©å±•æ¯”è¾ƒå›°éš¾ï¼Œä¸ç¬¦åˆå¼€é—­åŸåˆ™ã€‚ å‡çº§ä¸ºå¤šä¸ªå·¥å‚ç±» å®è´¨æ˜¯ä¸ºäº†ç»“æ„æ¸…æ™°ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªäº§å“å®šä¹‰ä¸€ä¸ªåˆ›é€ è€…ï¼Œç„¶åç”±è°ƒç”¨è€…è‡ªå·±å»é€‰æ‹©ä¸é‚£ä¸ªå·¥å‚æ–¹æ³•å…³è”ã€‚ æ›¿ä»£å•ä¾‹æ¨¡å¼ ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021public class SingletonFactory &#123;private static Singleton singleton;static &#123; try &#123; Class c1 = Class.forName(Singleton.class.getName()); // è·å¾—æ— å‚æ„é€  Constructor constructor = c1.getDeclaredConstructor(); //è®¾ç½®æ— å‚æ„é€ æ˜¯å¯è®¿é—®çš„ constructor.setAccessible(true); // äº§ç”Ÿä¸€ä¸ªå®ä¾‹å¯¹è±¡ singleton = (Singleton) constructor.newInstance(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125;&#125;public static Singleton getSingleton() &#123; return singleton;&#125;&#125; å»¶è¿Ÿåˆå§‹åŒ– æ‰€è°“å»¶è¿Ÿåˆå§‹åŒ–å³ä¸€ä¸ªå¯¹è±¡è¢«æ¶ˆè´¹å®Œæ¯•åï¼Œå¹¶ä¸ç«‹åˆ»é‡Šæ”¾ï¼Œå·¥å‚ç±»ä¿æŒå…¶åˆå§‹çŠ¶æ€ï¼Œç­‰å¾…å†æ¬¡è¢«ä½¿ç”¨ã€‚å…¶å®è´¨ï¼Œæ˜¯åˆ©ç”¨ä¸€ä¸ªMapä¿å­˜åˆ›é€ è¿‡çš„å¯¹è±¡ï¼Œå¦‚æœåœ¨Mapå®¹å™¨å·²ç»æœ‰çš„å¯¹è±¡ï¼Œåˆ™ç›´æ¥å–å‡ºè¿”å›ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™æ ¹æ®éœ€è¦çš„ç±»å‹äº§ç”Ÿä¸€ä¸ªå¯¹è±¡å¹¶æ”¾å…¥åˆ°Mapå®¹å™¨ä¸­ï¼Œä»¥æ–¹ä¾¿ä¸‹æ¬¡è°ƒç”¨ã€‚ æœ€ä½³å®è·µå­°èƒ½ç”Ÿå·§ï¼Œç†Ÿç»ƒæŒæ¡è¯¥è®¾è®¡æ¨¡å¼ï¼Œå¤šæ€è€ƒå·¥å‚æ–¹æ³•å¦‚å’Œåº”ç”¨ï¼Œè€Œä¸”å·¥å‚æ–¹æ³•æ¨¡å¼å¯ä»¥ä¸å…¶ä»–æ¨¡å¼æ··åˆä½¿ç”¨ï¼Œå˜åŒ–å‡ºæ— ç©·çš„ä¼˜ç§€è®¾è®¡ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç¦…â€”â€”å•ä¾‹æ¨¡å¼]]></title>
    <url>%2F2018%2F02%2F06%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%A6%85%E2%80%94%E2%80%94%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¦‚æœæ¯ä¸ªäººå¯ä»¥èµ°çš„è·¯åªæœ‰ä¸€æ¡ï¼Œå¦‚æœæ¯ä¸ªäººæƒ³è¦çš„ä¸œè¥¿éƒ½æ˜¯ä¸€ä¸ª(å•ä¾‹æ¨¡å¼)ï¼Œé‚£ä¹ˆäººåº”è¯¥éƒ½ä¸ä¼šè¿·èŒ«äº†å§ã€‚è™½ç„¶è§£å†³äº†è¿·èŒ«ï¼Œä½†æ˜¯ä¹ŸæŠ¹æ€äº†å¤šæ ·æ€§ï¼Œæœ‰å¥½æœ‰åï¼Œå„æœ‰æ‰€è§ã€‚ å®šä¹‰ç¡®ä¿æŸä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸”è‡ªè¡Œå®ä¾‹åŒ–å¹¶å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ã€‚â€”â€”åˆ›é€ ç±» ä¸‹é¢æ˜¯å®ƒçš„é€šç”¨ç±»å›¾ï¼š ä»£ç å®ç°æœ‰ä¸¤ç§ï¼Œå¦‚ä¸‹ï¼š12345678910111213// é¥¿æ±‰å¼å•ä¾‹ çº¿ç¨‹å®‰å…¨public class Singleton &#123; private static final Singleton = new Singleton(); // é™åˆ¶äº§ç”Ÿå¤šä¸ªå¯¹è±¡ private Singleton() &#123; ... &#125; // é€šè¿‡è¯¥æ–¹æ³•è·å¾—å®ä¾‹å¯¹è±¡ public static Singleton getSingleton() &#123; return singleton; &#125; // ç±»ä¸­å…¶ä»–æ–¹æ³•å°½é‡æ˜¯static public static void doSomething &#123; ... &#125;&#125; 12345678910111213141516// æ‡’æ±‰å¼å•ä¾‹ çº¿ç¨‹ä¸å®‰å…¨public class Singleton &#123; private static final Singleton = null; // é™åˆ¶äº§ç”Ÿå¤šä¸ªå¯¹è±¡ private Singleton() &#123; ... &#125; // é€šè¿‡è¯¥æ–¹æ³•è·å¾—å®ä¾‹å¯¹è±¡ public static Singleton getSingleton() &#123; if (singleton = null) &#123; singleton = new Singleton(); &#125; return singleton; &#125; // ç±»ä¸­å…¶ä»–æ–¹æ³•å°½é‡æ˜¯static public static void doSomething &#123; ... &#125;&#125; åº”ç”¨ä¼˜ç‚¹ å‡å°‘å†…å­˜å¼€æ”¯ å‡å°‘ç³»ç»Ÿçš„æ€§èƒ½å¼€é”€ é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ ç¼ºç‚¹ æ‰©å±•å›°éš¾ï¼Œç”±äºå®ƒéœ€è¦è‡ªè¡Œå®ä¾‹åŒ– ä¸åˆ©äºæµ‹è¯•ï¼Œç”±äºå•ä¾‹æ²¡å®Œæˆï¼Œä¸èƒ½æµ‹è¯• ä¸å•ä¸€èŒè´£æœ‰å†²çª ä½¿ç”¨åœºæ™¯ è¦æ±‚ç”Ÿæˆå”¯ä¸€åºåˆ—å·çš„ç¯å¢ƒ åœ¨æ•´ä¸ªé¡¹ç›®ä¸­éœ€è¦ä¸€ä¸ªå…±äº«è®¿é—®å¸¦ä½ æˆ–å…±äº«æ•°æ® åˆ›å»ºä¸€ä¸ªå¯¹è±¡éœ€è¦æ¶ˆè€—çš„èµ„æºè¿‡å¤šï¼Œå¦‚è®¿é—®IOå’Œæ•°æ®åº“ éœ€è¦å®šä¹‰å¤§é‡çš„é™æ€å¸¸é‡å’Œé™æ€æ–¹æ³•ï¼ˆå¦‚å·¥å…·ç±»ï¼‰çš„ç¯å¢ƒ æ³¨æ„äº‹é¡¹ åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œè¯·æ³¨æ„å•ä¾‹æ¨¡å¼çš„çº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œé€‰æ‹©åˆé€‚çš„å®ç°æ¨¡å¼ã€‚ ä¸å¯ä»¥å¤åˆ¶ï¼Œå³ä¸å®ç°Cloneableæ¥å£ã€‚ æœ€ä½³å®è·µåœ¨Springä¸­ï¼Œæ¯ä¸ªBeané»˜è®¤å°±æ˜¯å•ä¾‹çš„ï¼Œè¿™æ ·çš„ä¼˜ç‚¹æ˜¯Springå®¹å™¨å¯ä»¥ç®¡ç†è¿™äº›Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œå†³å®šä»€ä¹ˆæ—¶å€™é”€é­‚ï¼Œé”€æ¯çš„æ—¶å€™è¦å¦‚ä½•å¤„ç†ï¼Œç­‰ç­‰ã€‚å¦‚æœé‡‡ç”¨éå•ä¾‹æ¨¡å¼ï¼Œåˆ™Beanåˆå§‹åŒ–åçš„ç®¡ç†äº¤ç”±J2EEå®¹å™¨ï¼ŒSpringå®¹å™¨ä¸åœ¨è·Ÿè¸ªç®¡ç†Beançš„ç”Ÿå‘½å‘¨æœŸã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…ˆå¹å“å£å·_6å¤§è®¾è®¡åŸåˆ™]]></title>
    <url>%2F2018%2F02%2F01%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%2F%E5%85%88%E5%90%B9%E5%93%8D%E5%8F%A3%E5%8F%B7-6%E5%A4%A7%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå…ˆæœ‰6å¤§è®¾è®¡åŸåˆ™ï¼Œåæœ‰23ç§è®¾è®¡æ¨¡å¼ã€‚è®©æˆ‘ä»¬å…ˆå¹å“è¿™å…ˆè¡Œçš„å£å·ã€‚ å•ä¸€èŒè´£åŸåˆ™ SRPå®šä¹‰å°±ä¸€ä¸ªç±»æˆ–æ¥å£è€Œè¨€ï¼Œåº”è¯¥æœ‰ä¸”åªæœ‰ä¸€ä¸ªåŸå› å¼•èµ·ç±»çš„å˜æ›´ã€‚ ä¾‹å­å…³äºç”µè¯é€šè¯çš„æ¥å£ï¼Œæœ‰ä¸‰ä¸ªè¿‡ç¨‹ï¼šæ‹¨å·ã€é€šè¯ã€æŒ‚æœºã€‚ä»£ç å¦‚ä¸‹ï¼š12345678public interface IPhone &#123; //æ‹¨é€šç”µè¯ public void dial(String phoneNumber); //é€šè¯ public void chat(Onbject o); //æŒ‚æœº public void hangup();&#125; ä½†æ˜¯IPhoneè¿™ä¸ªæ¥å£ä¸æ˜¯åªæœ‰ä¸€ä¸ªèŒè´£ï¼Œå®ƒåŒ…å«äº†ä¸¤ä¸ªèŒè´£ï¼šä¸€ä¸ªæ˜¯åè®®ç®¡ç†ï¼Œä¸€ä¸ªæ˜¯æ•°æ®ä¼ é€ã€‚æ‰€ä»¥æˆ‘ä»¬æ”¹ä¸ºä¸‹é¢è®¾è®¡çš„ç±»å›¾ï¼š å¥½å¤„ ç±»çš„å¤æ‚æ€§é™ä½ï¼Œå®ç°ä»€ä¹ˆèŒè´£éƒ½æœ‰æ¸…æ™°æ˜ç¡®çš„å®šä¹‰ å¯è¯»æ€§æé«˜ï¼Œå¤æ‚åº¦é™ä½ï¼Œé‚£å½“ç„¶å¯è¯»æ€§æé«˜äº† å¯ç»´æŠ¤æ€§æé«˜ï¼Œå¯è¯»æ€§æé«˜äº†ï¼Œé‚£å½“ç„¶æ›´å®¹æ˜“ç»´æŠ¤äº† å˜æ›´å¼•èµ·çš„é£é™©é™ä½ æœ€ä½³å®è·µæ¥å£ä¸€å®šè¦åšåˆ°å•ä¸€èŒè´£ï¼Œç±»çš„è®¾è®¡å°½é‡åšåˆ°åªæœ‰ä¸€ä¸ªåŸå› å¼•èµ·å˜åŒ–ã€‚ é‡Œæ°æ›¿æ¢åŸåˆ™ LSPå®šä¹‰ æ­£å®—å®šä¹‰ï¼šå¦‚æœå¯¹æ¯ä¸€ä¸ªç±»å‹ä¸ºSçš„å¯¹è±¡o1ï¼Œéƒ½æœ‰ç±»å‹ä¸ºTçš„å¯¹è±¡o2ï¼Œä½¿å¾—ä»¥Tå®šä¹‰çš„æ‰€æœ‰ç¨‹åºPåœ¨æ‰€æœ‰çš„å¯¹è±¡o2éƒ½ä»£æ¢æˆo1æ—¶ï¼Œç¨‹åºPçš„è¡Œä¸ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç±»å‹Sæ˜¯ç±»å‹Tçš„å­ç±»å‹ã€‚ï¼ˆæ„Ÿè§‰ã€ŠJavaè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹çš„ç¿»è¯‘é”™è¯¯ï¼‰ é€šä¿—å®šä¹‰ï¼šæ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ï¼ˆåªè¦çˆ¶ç±»èƒ½å‡ºç°å¾—åœ°æ–¹å­ç±»å°±å¯ä»¥å‡ºç°ï¼›æœ‰å­ç±»å‡ºç°çš„åœ°æ–¹ï¼Œçˆ¶ç±»æœªå¿…èƒ½é€‚åº”ï¼‰ã€‚ è§„åˆ™ å­ç±»å¿…é¡»å®Œå…¨å®ç°çˆ¶ç±»çš„æ–¹æ³•ã€‚ï¼ˆå¦‚æœå­ç±»ä¸èƒ½å®Œæ•´åœ°å®ç°å­ç±»çš„æ–¹æ³•ï¼Œæˆ–è€…çˆ¶ç±»çš„æŸäº›æ–¹æ³•åœ¨å­ç±»ä¸­å·²ç»å‘ç”Ÿâ€œç•¸å˜â€ï¼Œåˆ™å»ºè®®æ–­å¼€çˆ¶å­ç»§æ‰¿å…³ç³»ï¼Œé‡‡ç”¨ä¾èµ–ã€èšåˆã€ç»„åˆç¯å…³ç³»æ¥ä»£æ›¿ç»§æ‰¿ã€‚ï¼‰ å­ç±»å¯ä»¥æœ‰è‡ªå·±çš„ä¸ªæ€§ã€‚ è¦†ç›–æˆ–å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶è¾“å…¥å‚æ•°å¯ä»¥è¢«æ”¾å¤§ã€‚ï¼ˆå­ç±»ä¸­æ–¹æ³•çš„å‰ç½®æ¡ä»¶ï¼ˆæ–¹æ³•ä¸­è¾“å…¥å‚æ•°ï¼‰å¿…é¡»ä¸è¶…ç±»ä¸­è¢«è¦†å†™çš„æ–¹æ³•çš„å‰ç½®æ¡ä»¶ç›¸åŒæˆ–è€…æ›´å®½æ¾ã€‚ï¼‰ è¦†å†™æˆ–å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶è¾“å‡ºç»“æœå¯ä»¥è¢«ç¼©å°ã€‚ ç–‘é—®ï¼ˆå¤šæ€æ˜¯å¦è¿èƒŒLSPï¼Ÿï¼‰å¦‚æœç»§æ‰¿çš„ç›®çš„æ˜¯ä¸ºäº†å¤šæ€ï¼Œè€Œå¤šæ€çš„å‰æå°±æ˜¯å­ç±»è¦†ç›–å¹¶é‡æ–°å®šä¹‰çˆ¶ç±»çš„æ–¹æ³•ï¼Œä¸ºäº†ç¬¦åˆLSPï¼Œæˆ‘ä»¬åº”è¯¥å°†çˆ¶ç±»å®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œå¹¶å®šä¹‰æŠ½è±¡æ–¹æ³•ï¼Œè®©å­ç±»é‡æ–°å®šä¹‰è¿™äº›æ–¹æ³•ï¼Œå½“çˆ¶ç±»æ˜¯æŠ½è±¡ç±»æ—¶ï¼Œçˆ¶ç±»å°±æ˜¯ä¸èƒ½å®ä¾‹åŒ–ï¼Œæ‰€ä»¥ä¹Ÿä¸å­˜åœ¨å¯å®ä¾‹åŒ–çš„çˆ¶ç±»å¯¹è±¡åœ¨ç¨‹åºé‡Œã€‚ä¹Ÿå°±ä¸å­˜åœ¨å­ç±»æ›¿æ¢çˆ¶ç±»å®ä¾‹æ—¶é€»è¾‘ä¸ä¸€è‡´çš„å¯èƒ½ã€‚ æœ€ä½³å®è·µåœ¨é¡¹ç›®ä¸­ï¼Œé‡‡ç”¨é‡Œæ°æ›¿æ¢åŸåˆ™æ—¶ï¼Œå°½é‡é¿å…å­ç±»çš„â€œä¸ªæ€§â€ï¼Œä¸€æ—¦å­ç±»æœ‰äº†â€œä¸ªæ€§â€ï¼Œè¿™ä¸ªå­ç±»å’Œçˆ¶ç±»ä¹‹é—´çš„å…³ç³»å°±éš¾è°ƒå’Œï¼ŒæŠŠå­ç±»å½“åšçˆ¶ç±»ä½¿ç”¨ï¼Œå­ç±»çš„â€œä¸ªæ€§â€è¢«æŠºæ€äº†ï¼ŒæŠŠå­ç±»å•ç‹¬ä½œä¸ºä¸€ä¸ªä¸šåŠ¡æ¥ä½¿ç”¨ï¼Œåˆ™ä¼šè®©ä»£ç é—´çš„è€¦åˆå…³ç³»å˜å¾—æ‰‘æœ”è¿·ç¦»â€“ç¼ºä¹ç±»æ›¿æ¢çš„æ ‡å‡†ã€‚ ä¾èµ–å€’ç½®åŸåˆ™ DIPå®šä¹‰é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ã€‚æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ã€‚ç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚ï¼ˆä¸å¯ä»¥åˆ†å‰²çš„åŸå­é€»è¾‘å°±æ˜¯åº•å±‚æ¨¡å—ï¼ŒåŸå­é€»è¾‘çš„å†ç»„è£…å°±æ˜¯é«˜å±‚æ¨¡å—ã€‚æŠ½è±¡å°±æ˜¯æŒ‡æ¥å£æˆ–æŠ½è±¡ç±»ã€‚ç»†èŠ‚å°±æ˜¯å®ç°ç±»ã€‚ï¼‰ Javaè¯­è¨€è¡¨ç°ï¼šæ¨¡å—é—´çš„ä¾èµ–é€šè¿‡æŠ½è±¡äº§ç”Ÿï¼Œå®ç°ç±»ä¹‹é—´ä¸å‘ç”Ÿç›´æ¥çš„ä¾èµ–å…³ç³»ï¼Œå…¶ä¾èµ–å…³ç³»æ˜¯é€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»äº§ç”Ÿçš„ã€‚æ¥å£æˆ–æŠ½è±¡ç±»ä¸ä¾èµ–å®ç°ç±»ã€‚å®ç°ç±»ä¾èµ–æ¥å£æˆ–æŠ½è±¡ç±»ã€‚â€”â€”é¢å‘æ¥å£ç¼–ç¨‹(OOD)ã€‚ ä¾èµ–çš„ä¸‰ç§å†™æ³• æ„é€ å‡½æ•°ä¼ é€’ä¾èµ–å¯¹è±¡(æ„é€ å‡½æ•°æ³¨å…¥) 123456789101112131415public interface IDriver &#123; public void drive();&#125;public class Driver implements IDriver &#123; private ICar car; //æ„é€ å‡½æ•°æ³¨å…¥ public Drive(ICar _car) &#123; this.car = _car; &#125; public void drive() &#123; this.car.run(); &#125;&#125; Setteræ–¹æ³•ä¼ é€’ä¾èµ–å¯¹è±¡ï¼ˆSetterä¾èµ–æ³¨å…¥ï¼‰ 12345678910111213141516public interface IDriver &#123; public void setCar(ICar car); public void drive();&#125;public class Driver implements IDriver &#123; private ICar car; //setteræ³¨å…¥ public void setCar(ICar car) &#123; this.car = car; &#125; public void drive() &#123; this.car.run(); &#125;&#125; æ¥å£å£°æ˜ä¾èµ–å¯¹è±¡(æ¥å£æ³¨å…¥) 12345678910public interface IDriver &#123; public void drive(ICar car);&#125;public class Driver implements IDriver &#123; //æ¥å£æ³¨å…¥ public void drive(ICar car) &#123; car.run(); &#125;&#125; æœ€ä½³å®è·µ æ¯ä¸ªç±»å°½é‡éƒ½æœ‰æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œæˆ–è€…æŠ½è±¡ç±»å’Œæ¥å£ä¸¤è€…éƒ½å…·å¤‡ã€‚ å˜é‡çš„è¡¨é¢ç±»å‹ï¼ˆå®šä¹‰çš„ç±»å‹ï¼‰å°½é‡æ˜¯æ¥å£æˆ–è€…æ˜¯æŠ½è±¡ç±»ã€‚ ä»»ä½•ç±»éƒ½ä¸åº”è¯¥ä»å…·ä½“ç±»æ´¾ç”Ÿã€‚ å°½é‡ä¸è¦è¦†å†™åŸºç±»çš„æ–¹æ³•ã€‚ ç»“åˆé‡Œæ°æ›¿æ¢åŸåˆ™ä½¿ç”¨ï¼ˆå¤šæ€ï¼‰ æˆ‘ä»¬åœ¨å®é™…çš„é¡¹ç›®ä¸­ä½¿ç”¨ä¾èµ–å€’ç½®åŸåˆ™éœ€è¦å®¡æ—¶åº¦åŠ¿ï¼Œä¸å“Ÿå•ŠæŠ“ä½ä¸€ä¸ªåŸåˆ™ä¸æ”¾ï¼Œæ¯ä¸€ä¸ªåŸåˆ™çš„ä¼˜ç‚¹éƒ½æ˜¯æœ‰é™åº¦çš„ï¼Œå¹¶ä¸æ˜¯æ”¾ä¹‹å››æµ·è€Œçš†å‡†çš„çœŸç†ï¼Œæ‰€ä»¥åˆ«ä¸ºäº†éµå¾ªä¸€ä¸ªåŸåˆ™è€Œæ”¾å¼ƒäº†ä¸€ä¸ªé¡¹ç›®çš„ç»ˆæç›®æ ‡ï¼šæŠ•äº§ä¸Šçº¿å’Œç›ˆåˆ©ã€‚ æ¥å£éš”ç¦»åŸåˆ™ ISPå®šä¹‰å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–ä»–ä¸éœ€è¦çš„æ¥å£ã€‚ç±»é—´çš„ä¾èµ–å…³ç³»åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚ï¼ˆå®ä¾‹æ¥å£ï¼šclassï¼›ç±»æ¥å£ï¼šinterfaceï¼‰ çº¦æŸ æ¥å£è¦å°½é‡å°ã€‚ï¼ˆæ ¹æ®æ¥å£éš”ç¦»åŸåˆ™æ‹†åˆ†æ¥å£æ—¶ï¼Œé¦–å…ˆå¿…é¡»è¦æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™ã€‚ï¼‰ æ¥å£è¦é«˜å†…èšã€‚ï¼ˆåœ¨æ¥å£ä¸­å°½é‡å°‘å…¬å¸ƒpublicæ–¹æ³•ã€‚ï¼‰ å®šåˆ¶æœåŠ¡ã€‚ï¼ˆè®¾è®¡æ—¶éœ€è¦ä¸ºå„ä¸ªè®¿é—®è€…å®šåˆ¶æœåŠ¡ï¼ˆæ¥å£ï¼‰ã€‚ï¼‰ æ¥å£è®¾è®¡æ—¶æœ‰é™åº¦çš„ã€‚ï¼ˆæ¥å£çš„è®¾è®¡ç²’åº¦è¦åè°ƒå¼€å‘éš¾åº¦å’Œå¯ç»´æŠ¤æ€§ã€‚ï¼‰ æœ€ä½³å®è·µ ä¸€ä¸ªæ¥å£åªæœåŠ¡äºä¸€ä¸ªå­æ¨¡å—æˆ–ä¸šåŠ¡é€»è¾‘ã€‚ é€šè¿‡ä¸šåŠ¡é€»è¾‘å‹ç¼©æ¥å£ä¸­çš„publicæ–¹æ³•ï¼Œç»å¸¸å›é¡¾æ¥å£ã€‚ å·²ç»è¢«æ±¡æŸ“çš„æ¥å£ï¼Œå°½é‡å»ä¿®æ”¹ï¼Œå¦‚æœå˜æ›´é£é™©è¾ƒå¤§ï¼Œåˆ™é‡‡ç”¨é€‚é…å™¨æ¨¡å¼è¿›è¡Œè½¬åŒ–å¤„ç†ã€‚ äº†è§£ç¯å¢ƒï¼Œæ‹’ç»ç›²ä»ã€‚ è¿ªç±³ç‰¹æ³•åˆ™ LoD LKPå®šä¹‰ä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡æœ‰æœ€å°‘çš„äº†è§£ã€‚ï¼ˆç±»è§£è€¦ï¼‰ å«ä¹‰ åªä¸æœ‹å‹äº¤æµ æœ‹å‹ç±»çš„å®šä¹‰ï¼šå‡ºç°åœ¨æˆå‘˜å˜é‡ã€æ–¹æ³•çš„è¾“å…¥è¾“å‡ºå‚æ•°çš„ç±»ç§°ä¸ºæˆå‘˜æœ‹å‹ç±»ã€‚ æ‰€ä»¥åœ¨åŸç±»çš„æ–¹æ³•ä¸­ä¸èƒ½å‡ºç°éæœ‹å‹çš„ç±»ï¼ŒJDK APIæä¾›çš„ç±»é™¤å¤–ã€‚ æœ‹å‹é—´ä¹Ÿæ˜¯æœ‰è·ç¦»çš„ å°½é‡ä¸è¦å¯¹å¤–å…¬å¸ƒå¤ªå¤šçš„publicæ–¹æ³•å’Œéé™æ€çš„publicå˜é‡ã€‚ æ˜¯è‡ªå·±çš„å°±æ˜¯è‡ªå·±çš„ å¦‚æœè¿‡ä¸€ä¸ªæ–¹æ³•æ”¾åœ¨æœ¬ç±»ä¸­ï¼Œæ—¢ä¸å¢åŠ ç±»é—´å…³ç³»ï¼Œä¹Ÿå¯¹æœ¬ç±»ä¸äº§ç”Ÿè´Ÿé¢å½±å“ï¼Œé‚£å°±æ”¾ç½®åœ¨æœ¬ç±»ä¸­ã€‚ è°¨æ…ä½¿ç”¨Serializable é˜²æ­¢å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ç±»ä¸åŒæ­¥ã€‚ æœ€ä½³å®è·µè¿ªç±³ç‰¹æ³•åˆ™çš„æ ¸å¿ƒæ˜¯ç±»é—´è§£è€¦ï¼Œå¼±è€¦åˆï¼Œåªæœ‰å¼±è€¦åˆäº†ä»¥åï¼Œç±»çš„å¤ç”¨ç‡æ‰å¯ä»¥æé«˜ã€‚å…¶è¦æ±‚çš„ç»“æœå°±æ˜¯äº§ç”Ÿå¤§é‡çš„ä¸­è½¬æˆ–è·³è½¬ç±»ï¼Œå¯¼è‡´ç³»ç»Ÿçš„å¤æ‚æ€§æé«˜ï¼ŒåŒæ—¶ä¹Ÿä¸ºç»´æŠ¤å¸¦æ¥äº†éš¾åº¦ï¼Œåœ¨é‡‡ç”¨è¿ªç±³ç‰¹æ³•åˆ™æ—¶éœ€è¦åå¤æƒè¡¡ï¼Œæ—¢åšåˆ°è®©ç»“æ„æ¸…æ™°ï¼Œåˆè¦åšåˆ°é«˜å†…èšä½è€¦åˆã€‚å½“ä¸€ä¸ªç±»è·³è½¬ä¸¤æ¬¡ä»¥ä¸Šæ‰èƒ½è®¿é—®åˆ°å¦ä¸€ä¸ªç±»ï¼Œå°±éœ€è¦é‡æ„äº†ã€‚ å¼€é—­åŸåˆ™ OCPå®šä¹‰ä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚ PS: 3WåŸåˆ™ï¼ˆwhatï¼šæ˜¯ä»€ä¹ˆï¼›whyï¼šä¸ºä»€ä¹ˆï¼›Howï¼šæ€ä¹ˆåšï¼‰ æ˜¯ä»€ä¹ˆå¼€é—­åŸåˆ™å‘Šè¯‰æˆ‘ä»¬åº”è¯¥å°½é‡é€šè¿‡æ‰©å±•è½¯ä»¶å®ä½“æ¥å®ç°å˜åŒ–ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¿®æ”¹å·²æœ‰çš„ä»£ç æ¥å®Œæˆå˜åŒ–ï¼Œå®ƒæ˜¯ä¸ºè½¯ä»¶å®ä½“çš„æœªæ¥äº‹ä»¶è€Œåˆ¶å®šçš„å¯¹ç°è¡Œå¼€å‘è®¾è®¡è¿›è¡Œçš„çº¦æŸè§„åˆ™ã€‚ å¼€é—­åŸåˆ™å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Œå¹¶ä¸ä»¥ä¸ºç€ä¸åšä»»ä½•ä¿®æ”¹ï¼Œä½å±‚æ¨¡å—çš„å˜æ›´ï¼Œå¿…ç„¶è¦æœ‰é«˜å±‚æ¨¡å—çš„è¿›è¡Œè€¦åˆï¼Œå¦åˆ™å°±æ˜¯ä¸€ä¸ªå­¤ç«‹æ— æ„ä¹‰çš„ä»£ç ç‰‡æ®µã€‚ ä¸€ä¸ªé¡¹ç›®çš„åŸºæœ¬è·¯å¾„ï¼šé¡¹ç›®å¼€å‘ã€é‡æ„ã€æµ‹è¯•ã€æŠ•äº§ã€è¿ç»´ï¼Œå…¶ä¸­çš„é‡æ„å¯ä»¥å¯¹åŸæœ‰çš„è®¾è®¡å’Œä»£ç è¿›è¡Œä¿®æ”¹ï¼Œè¿ç»´å°½é‡å‡å°‘å¯¹åŸæœ‰ä»£ç çš„ä¿®æ”¹ï¼Œä¿æŒå†å²ä»£ç çš„çº¯æ´æ€§ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚ ä¸ºä»€ä¹ˆ ç®€åŒ–æµ‹è¯•ï¼šå¦‚æœæ”¹å˜è½¯ä»¶å†…å®¹, éœ€è¦å°†æ‰€æœ‰çš„æµ‹è¯•æµç¨‹éƒ½æ‰§è¡Œä¸€é, å¦‚ å•å…ƒæµ‹è¯•, åŠŸèƒ½æµ‹è¯•, é›†æˆæµ‹è¯•ç­‰, å¦‚æœåªæ˜¯æ‰©å±•, åªå•ç‹¬æµ‹è¯•æ‰©å±•éƒ¨åˆ†å³å¯ã€‚ æé«˜å¤ç”¨æ€§ï¼šæ‰€æœ‰é€»è¾‘éƒ½ä»åŸå­é€»è¾‘ç»„åˆ, åŸå­é€»è¾‘ç²’åº¦è¶Šå°, å¤ç”¨æ€§è¶Šå¤§; è¿™æ ·é¿å…ç›¸åŒé€»è¾‘å­˜åœ¨, ä¿®æ”¹æ—¶éœ€è¦ä¿®æ”¹å¤šä¸ªæ­¤ç›¸åŒé€»è¾‘ã€‚ æé«˜å¯ç»´æŠ¤æ€§ï¼šç»´æŠ¤ä¸€ä¸ªç±»æœ€å¥½çš„æ–¹å¼æ˜¯æ‰©å±•ä¸€ä¸ªç±», è€Œä¸æ˜¯ä¿®æ”¹ä¸€ä¸ªç±», å¦‚æœéœ€è¦ä¿®æ”¹éœ€è¦è¯»æ‡‚æºç æ‰èƒ½ä¿®æ”¹, æ‰©å±•çš„è¯åªéœ€è¦äº†è§£å³å¯, ç›´æ¥ç»§æ‰¿æ‰©å±•ã€‚ æ€ä¹ˆåš æŠ½è±¡çº¦æŸ é€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»å¯ä»¥çº¦æŸä¸€ç»„å¯èƒ½å˜åŒ–çš„è¡Œä¸ºï¼Œå¹¶ä¸”å®ç°å¯¹æ‰©å±•å¼€æ”¾ã€‚å…¶ä¸­åŒ…æ‹¬ä¸‰å±‚å«ä¹‰ï¼šç¬¬ä¸€ï¼Œé€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»çº¦æŸæ‰©å±•ï¼Œå¯¹æ‰©å±•è¿›è¡Œè¾¹ç•Œè®¾å®šï¼Œä¸å…è®¸å‡ºç°åœ¨æ¥å£æˆ–æŠ½è±¡ç±»ä¸å­˜åœ¨çš„publicæ–¹æ³•ï¼›ç¬¬äºŒï¼Œå‚æ•°ç±»å‹ï¼Œå¼•ç”¨å¯¹è±¡å°½é‡ä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯å®ç°ç±»ï¼›ç¬¬ä¸‰ï¼ŒæŠ½è±¡å±‚å°½é‡ä¿æŒç¨³å®šã€‚ å…ƒæ•°æ®æ§åˆ¶æ¨¡å—è¡Œä¸º é€šè¿‡é…ç½®å‚æ•°ï¼ˆä»æ–‡ä»¶æˆ–è€…æ•°æ®åº“ä¸­æ¥ï¼‰æ¥æ§åˆ¶è¡Œä¸ºï¼Œä¾‹å¦‚springé…ç½®æ–‡ä»¶çš„æ„é€ å‡½æ•°æ³¨å…¥é…ç½®ã€‚ åˆ¶å®šé¡¹ç›®ç« ç¨‹ çº¦å®šä¼˜äºé…ç½®ã€‚ å°è£…å˜åŒ– å¯¹å˜åŒ–çš„å°è£…åŒ…å«ä¸¤å±‚å«ä¹‰ï¼šç¬¬ä¸€ï¼Œå°†ç›¸åŒçš„å˜åŒ–å°è£…åˆ°ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ä¸­ï¼›ç¬¬äºŒï¼Œå°†ä¸åŒçš„å˜åŒ–å°è£…åˆ°ä¸åŒçš„æ¥å£æˆ–æŠ½è±¡ç±»ä¸­ã€‚23ä¸ªè®¾è®¡æ¨¡å¼éƒ½æ˜¯ä»å„ä¸ªä¸åŒçš„è§’åº¦å¯¹å˜åŒ–è¿›è¡Œå°è£…çš„ã€‚ æœ€ä½³å®è·µ å¼€é—­åŸåˆ™åªæ˜¯ä¸€ä¸ªåŸåˆ™ï¼Œé€‚å½“æ—¶å€™ä¹Ÿå¯ä»¥è¿›è¡Œè¡¥å……ã€‚ é¡¹ç›®è§„ç« éå¸¸é‡è¦ã€‚ é¢„çŸ¥å˜åŒ–ï¼Œé¡¹ç›®éœ€è¦å…·æœ‰å¯æ‰©å±•æ€§ã€‚ æ€»ç»“æŠŠä¸Šé¢6å¤§åŸåˆ™çš„é¦–å­—æ¯ï¼ˆé‡Œæ°æ›¿æ¢åŸåˆ™å’Œè¿ªç±³ç‰¹æ³•åˆ™çš„é¦–å­—æ¯é‡å¤ï¼Œåªå–ä¸€ä¸ªï¼‰è”åˆèµ·æ¥å°±æ˜¯SOLIDï¼ˆç¨³å®šçš„ï¼‰ï¼Œå…¶ä»£ç çš„å«ä¹‰å°±æ˜¯æŠŠè¿™6ä¸ªåŸåˆ™ç»“åˆä½¿ç”¨çš„å¥½å¤„ï¼šå»ºç«‹ç¨³å®šçµæ´»ï¼Œå¥å£®çš„è®¾è®¡ï¼Œè€Œå¼€é—­åŸåˆ™åˆæ˜¯é‡ä¸­ä¹‹ä¸­ï¼Œæ˜¯æœ€åŸºç¡€çš„åŸåˆ™ï¼Œæ˜¯å…¶ä»–5å¤§åŸåˆ™çš„ç²¾ç¥é¢†è¢–ã€‚ å‚è€ƒ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¦…ã€‹]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UML_Javaç±»å›¾]]></title>
    <url>%2F2018%2F01%2F27%2F%E5%B7%A5%E5%85%B7%2FUML-Java%E7%B1%BB%E5%9B%BE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨çœ‹æºç æˆ–è€…å¾ˆå¤šæŠ€æœ¯ä¹¦ç±çš„æ—¶å€™éƒ½é¿å…ä¸äº†çœ‹åˆ°ç±»å›¾ï¼Œæ—¶é—´é•¿äº†æ€»ä¼šå¿˜äº†å«ä¹‰ï¼Œåœ¨è¿™é‡Œå°±æ€»ç»“ä¸€ä¸‹ï¼Œæ–¹ä¾¿ä»¥åå›é¡¾ã€‚è¿™é‡Œä½¿ç”¨çš„å·¥å…·æ˜¯startUMLã€‚ UMLUMLï¼š ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼‰ã€‚åœ¨ UML ç³»ç»Ÿå¼€å‘ä¸­æœ‰ä¸‰ä¸ªä¸»è¦çš„æ¨¡å‹ï¼š åŠŸèƒ½æ¨¡å‹ï¼šä»ç”¨æˆ·çš„è§’åº¦å±•ç¤ºç³»ç»Ÿçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨ä¾‹å›¾ã€‚ å¯¹è±¡æ¨¡å‹ï¼šé‡‡ç”¨å¯¹è±¡ï¼Œå±æ€§ï¼Œæ“ä½œï¼Œå…³è”ç­‰æ¦‚å¿µå±•ç¤ºç³»ç»Ÿçš„ç»“æ„å’ŒåŸºç¡€ï¼ŒåŒ…æ‹¬ç±»å›¾ã€å¯¹è±¡å›¾ã€åŒ…å›¾ã€‚ åŠ¨æ€æ¨¡å‹ï¼šå±•ç°ç³»ç»Ÿçš„å†…éƒ¨è¡Œä¸ºã€‚åŒ…æ‹¬æ—¶åºå›¾ï¼Œæ´»åŠ¨å›¾ï¼ŒçŠ¶æ€å›¾ã€‚ ç±»å›¾ç±»å›¾ä½¿ç”¨ç±»æ¥æè¿°ç³»ç»Ÿçš„é™æ€ç»“æ„ï¼Œç±»å›¾åŒ…å«ç±»å’Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå®ƒæè¿°ç³»ç»Ÿå†…æ‰€å£°æ˜çš„ç±»ï¼Œä½†å®ƒæ²¡æœ‰æè¿°ç³»ç»Ÿè¿è¡Œæ—¶ç±»çš„è¡Œä¸ºã€‚ åœ¨UMLç±»å›¾ä¸­ï¼Œç±»ä¸€èˆ¬ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šç±»åã€å±æ€§ä»¥åŠæ“ä½œã€‚ ç±»åæ¯ä¸ªç±»éƒ½å¿…é¡»æœ‰ä¸€ä¸ªåå­—ï¼Œç±»åæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å±æ€§å±æ€§æ˜¯æŒ‡ç±»çš„æ€§è´¨ï¼Œå³ç±»çš„æˆå‘˜å˜é‡ã€‚ç±»å¯ä»¥æœ‰ä»»æ„å¤šä¸ªå±æ€§ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰å±æ€§ã€‚ æ ¼å¼ä¸ºï¼š ã€å¯è§æ€§ã€‘ å±æ€§å ã€ï¼šç±»å‹ã€‘ ã€=åˆå§‹å€¼ã€‘ ã€{å±æ€§å­—ç¬¦ä¸²}ã€‘ å¯è§æ€§ï¼šåœ¨UMLä¸­publicç±»å‹ç”¨ç¬¦å·â€œ+â€è¡¨ç¤ºï¼Œprivateç±»å‹ç”¨â€œ-â€è¡¨ç¤ºï¼Œprotectedç±»å‹ç”¨â€œ#â€è¡¨ç¤ºã€‚ å±æ€§å­—ç¬¦ä¸²ï¼šç”¨æ¥æŒ‡å®šå…³äºå±æ€§çš„å…¶ä»–ä¿¡æ¯ï¼Œä»»ä½•å¸Œæœ›æ·»åŠ å±æ€§å®šä¹‰å­—ç¬¦ä¸²ä½†åˆæ²¡æœ‰åˆé€‚åœ°æ–¹å¯ä»¥åŠ å…¥çš„è§„åˆ™éƒ½å¯ä»¥æ”¾åœ¨å±æ€§å­—ç¬¦ä¸²é‡Œï¼Œä¾‹å¦‚ç±»å˜é‡ã€‚ æ“ä½œæ“ä½œæ˜¯ç±»çš„ä»»æ„ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨çš„è¡Œä¸ºï¼Œæ“ä½œæ˜¯ç±»çš„æˆå‘˜æ–¹æ³•ã€‚ æ ¼å¼ä¸ºï¼šã€å¯è§æ€§ã€‘ æ“ä½œå ã€{å‚æ•°åˆ—è¡¨}ã€‘ ã€ï¼šè¿”å›ç±»å‹ã€‘ ã€{å±æ€§å­—ç¬¦ä¸²}ã€‘ ç±»ä¹‹é—´çš„å…³ç³»å…³è”å…³ç³»å…³è”å…³ç³»(Association)æ˜¯ç±»ä¸ç±»ä¹‹é—´æœ€å¸¸ç”¨çš„ä¸€ç§å…³ç³»ï¼Œå®ƒæ˜¯ä¸€ç§ç»“æ„åŒ–å…³ç³»ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªç±»ä¸å¦ä¸€ä¸ªç±»ä¹‹é—´æœ‰è”ç³»ã€‚ åœ¨ UML ç±»å›¾ä¸­ï¼Œç”¨å®çº¿è¿æ¥æœ‰å…³è”çš„çš„ç±»ã€‚åœ¨å®ç°å…³è”å…³ç³»æ—¶ï¼Œé€šå¸¸å°†ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªç±»çš„å±æ€§ã€‚ å•å‘å…³è”ç±»çš„å…³è”å…³ç³»å¯ä»¥æ˜¯å•å‘çš„ï¼Œå•å‘å…³è”ç”¨å¸¦ç®­å¤´çš„å®çº¿è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾ï¼š1234567public class Person &#123; private Address address;&#125;public class Address &#123;&#125; åŒå‘å…³è”é»˜è®¤æƒ…å†µä¸‹ï¼Œå…³è”æ˜¯åŒå‘çš„ã€‚å¦‚ä¸‹å›¾ï¼š1234567public class Order &#123; private Product product;&#125;public class Product &#123; private Order order;&#125; è‡ªå…³è”åœ¨ç³»ç»Ÿä¸­å¯èƒ½ä¼šå­˜åœ¨ä¸€äº›ç±»çš„å±æ€§å¯¹è±¡ç±»å‹ä¸ºè¯¥ç±»æœ¬èº«ï¼Œè¿™ç§ç‰¹æ®Šçš„å…³è”å…³ç³»ç§°ä¸ºè‡ªå…³è”ã€‚å¦‚ä¸‹å›¾ï¼š123public class Node &#123; private Node node;&#125; é‡æ•°æ€§å…³è”é‡æ•°æ€§å…³è”å…³ç³»åˆç§°ä¸ºå¤šé‡æ€§å…³è”å…³ç³»ï¼Œè¡¨ç¤ºä¸€ä¸ªç±»çš„å¯¹è±¡ä¸å¦ä¸€ä¸ªç±»çš„å¯¹è±¡è¿æ¥çš„ä¸ªæ•°ã€‚åœ¨ UML ä¸­å¤šé‡æ€§å…³ç³»å¯ä»¥ç›´æ¥åœ¨å…³è”ç›´çº¿ä¸Šå¢åŠ ä¸€ä¸ªæ•°å­—è¡¨ç¤ºä¸ä¹‹å¯¹åº”çš„å¦ä¸€ä¸ªç±»çš„å¯¹è±¡çš„ä¸ªæ•°ã€‚å¦‚ä¸‹å›¾ï¼š å…¶ä¸­æ•°å­—çš„ç§ç±»åŠå«ä¹‰å¦‚ä¸‹è¡¨ï¼š è¡¨ç¤ºæ–¹å¼ è¡¨ç¤ºå«ä¹‰ 1..1 è¡¨ç¤ºå¦ä¸€ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡åªä¸ä¸€ä¸ªè¯¥ç±»å¯¹è±¡æœ‰å…³ç³» 0..* è¡¨ç¤ºå¦ä¸€ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡ä¸é›¶ä¸ªæˆ–å¤šä¸ªè¯¥ç±»å¯¹è±¡æœ‰å…³ç³» 1..* è¡¨ç¤ºå¦ä¸€ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡ä¸ä¸€ä¸ªæˆ–å¤šä¸ªè¯¥ç±»å¯¹è±¡æœ‰å…³ç³» 0..1 è¡¨ç¤ºå¦ä¸€ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰æˆ–åªä¸ä¸€ä¸ªè¯¥ç±»å¯¹è±¡æœ‰å…³ç³» m..n è¡¨ç¤ºå¦ä¸€ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡ä¸æœ€å°‘mã€æœ€å¤šnä¸ªè¯¥ç±»å¯¹è±¡æœ‰å…³ç³» (m&lt;=n) èšåˆå…³ç³»èšåˆå…³ç³»è¡¨ç¤ºä¸€ä¸ªæ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ã€‚é€šå¸¸åœ¨å®šä¹‰ä¸€ä¸ªæ•´ä½“ç±»åï¼Œå†å»æ‰¾å‡ºè¿™ä¸ªæ•´ä½“ç±»çš„ä¸€äº›æˆå‘˜ç±»ï¼Œè¯¥æ•´ä½“ç±»å’Œæˆå‘˜ç±»ä¹‹é—´å°±å½¢æˆäº†èšåˆå…³ç³»ã€‚ åœ¨èšåˆå…³ç³»ä¸­ï¼Œæˆå‘˜ç±»æ˜¯æ•´ä½“ç±»çš„ä¸€éƒ¨åˆ†ï¼Œå³æˆå‘˜å¯¹è±¡æ˜¯æ•´ä½“å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æˆå‘˜å¯¹è±¡å¯ä»¥è„±ç¦»æ•´ä½“å¯¹è±¡ç‹¬ç«‹å­˜åœ¨ã€‚åœ¨UMLä¸­ï¼Œèšåˆå…³ç³»ç”¨å¸¦ç©ºå¿ƒè±å½¢çš„ç›´çº¿è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾ï¼š123456789101112131415public class Car &#123; private Engine engine; public Car(Engine engine) &#123; this.engine = engine; &#125; public setEngine(Engine engine) &#123; this.engine = engine; &#125;&#125;public class Engine &#123;&#125; ç»„åˆå…³ç³»ç»„åˆå…³ç³»ä¹Ÿè¡¨ç¤ºç±»ä¹‹é—´æ•´ä½“å’Œéƒ¨åˆ†çš„å…³ç³»ï¼Œä½†æ˜¯ç»„åˆå…³ç³»ä¸­éƒ¨åˆ†å’Œæ•´ä½“å…·æœ‰ç»Ÿä¸€çš„ç”Ÿå­˜æœŸã€‚ä¸€æ—¦æ•´ä½“å¯¹è±¡ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¹Ÿå°†ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¸æ•´ä½“å¯¹è±¡ä¹‹é—´å…·æœ‰åŒç”Ÿå…±æ­»çš„å…³ç³»ã€‚ åœ¨ç»„åˆå…³ç³»ä¸­ï¼Œæˆå‘˜ç±»æ˜¯æ•´ä½“ç±»çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸”æ•´ä½“ç±»å¯ä»¥æ§åˆ¶æˆå‘˜ç±»çš„ç”Ÿå‘½å‘¨æœŸï¼Œå³æˆå‘˜ç±»çš„å­˜åœ¨ä¾èµ–äºæ•´ä½“ç±»ã€‚åœ¨UMLä¸­ï¼Œç»„åˆå…³ç³»ç”¨å¸¦å®å¿ƒè±å½¢çš„ç›´çº¿è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾ï¼š1234567891011public class Head &#123; private Eye eye; public Head() &#123; this.eye = new Eye(); &#125;&#125;public class Eye &#123;&#125; ä¾èµ–å…³ç³»ä¾èµ–å…³ç³»æ˜¯ä¸€ç§ä½¿ç”¨å…³ç³»ï¼Œç‰¹å®šäº‹ç‰©çš„æ”¹å˜æœ‰å¯èƒ½ä¼šå½±å“åˆ°ä½¿ç”¨è¯¥äº‹ç‰©çš„å…¶ä»–äº‹ç‰©ï¼Œåœ¨éœ€è¦è¡¨ç¤ºä¸€ä¸ªäº‹ç‰©ä½¿ç”¨å¦ä¸€ä¸ªäº‹ç‰©æ—¶ä½¿ç”¨ä¾èµ–å…³ç³»ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¾èµ–å…³ç³»ä½“ç°åœ¨æŸä¸ªç±»çš„æ–¹æ³•ä½¿ç”¨å¦ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚åœ¨UMLä¸­ï¼Œä¾èµ–å…³ç³»ç”¨å¸¦ç®­å¤´çš„è™šçº¿è¡¨ç¤ºï¼Œç”±ä¾èµ–çš„ä¸€æ–¹æŒ‡å‘è¢«ä¾èµ–çš„ä¸€æ–¹ã€‚å¦‚ä¸‹å›¾ï¼š1234567891011public class Driver &#123; public drive(Car car) &#123; car.move(); &#125;&#125;public class Car &#123; public move() &#123; ... &#125;&#125; æ³›åŒ–å…³ç³»æ³›åŒ–å…³ç³»ä¹Ÿå°±æ˜¯ç»§æ‰¿å…³ç³»ï¼Œä¹Ÿç§°ä¸ºâ€œis-a-kind-ofâ€å…³ç³»ï¼Œæ³›åŒ–å…³ç³»ç”¨äºæè¿°çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„å…³ç³»ã€‚åœ¨UMLä¸­ï¼Œæ³›åŒ–å…³ç³»ç”¨å¸¦ç©ºå¿ƒä¸‰è§’å½¢çš„ç›´çº¿æ¥è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾ï¼š å®ç°å…³ç³»å®ç°å…³ç³»æ˜¯ç±»å®ç°äº†æ¥å£ï¼Œç±»ä¸­çš„æ“ä½œå®ç°äº†æ¥å£ä¸­æ‰€å£°æ˜çš„æ“ä½œã€‚åœ¨UMLä¸­ï¼Œç±»ä¸æ¥å£ä¹‹é—´çš„å®ç°å…³ç³»ç”¨å¸¦ç©ºå¿ƒä¸‰è§’å½¢çš„è™šçº¿(macä¸­çš„startUMLç”»ä¸å‡ºæ¥ï¼Œå¤§å®¶å°†å°±ç€çœ‹)æ¥è¡¨ç¤ºã€‚å¦‚ä¸‹å›¾ï¼š æ€»ç»“ç†è§£ç±»å›¾æœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½çš„å»çœ‹æŠ€æœ¯ä¹¦ç±ï¼Œä»¥åŠæºç ï¼Œè¿™æ˜¯å¿…å¤‡æŠ€èƒ½ï¼Œget itï¼ å‚è€ƒ UML åŠ StarUml]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>UML</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_12_åŸå­å˜é‡ä¸éé˜»å¡åŒæ­¥æœºåˆ¶]]></title>
    <url>%2F2018%2F01%2F25%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-12-%E5%8E%9F%E5%AD%90%E5%8F%98%E9%87%8F%E4%B8%8E%E9%9D%9E%E9%98%BB%E5%A1%9E%E5%90%8C%E6%AD%A5%E6%9C%BA%E5%88%B6%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåŸå­å˜é‡ä¸éé˜»å¡åŒæ­¥æœºåˆ¶ç›¸æ¯”äºåŸºäºé”çš„æ–¹æ¡ˆå¯ä»¥æ‹¥æœ‰æ›´é«˜çš„æ€§èƒ½å’Œå¯ä¼¸ç¼©æ€§ã€‚ é”çš„åŠ£åŠ¿ é€šè¿‡ä½¿ç”¨ä¸€è‡´çš„é”å®šåè®®æ¥åè°ƒå¯¹å…±äº«çŠ¶æ€çš„è®¿é—®ï¼Œå¯ä»¥ç¡®ä¿æ— è®ºå“ªä¸ªçº¿ç¨‹æŒæœ‰å®ˆæŠ¤å˜é‡çš„é”ï¼Œéƒ½èƒ½é‡‡ç”¨ç‹¬å æ–¹å¼æ¥è®¿é—®è¿™äº›å˜é‡ï¼Œå¹¶ä¸”å¯¹å˜é‡çš„ä»»ä½•ä¿®æ”¹å¯¹éšåè·å¾—è¿™ä¸ªé”çš„å…¶ä»–çº¿ç¨‹éƒ½æ˜¯å¯è§çš„ã€‚ä½†æ˜¯å½“åœ¨é”ä¸Šå­˜åœ¨æ¿€çƒˆçš„ç«äº‰æ—¶ï¼Œè°ƒåº¦å¼€é”€ä¸å·¥ä½œå¼€é”€çš„æ¯”å€¼ä¼šéå¸¸é«˜ã€‚ volatileå˜é‡æ˜¯ä¸€ç§æ›´è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼Œä½†æ˜¯è™½ç„¶ä»–ä»¬æä¾›äº†ç›¸ä¼¼çš„å¯è§æ€§ä¿è¯ï¼Œä½†ä¸èƒ½ç”¨äºæ„å»ºåŸå­çš„å¤åˆæ“ä½œã€‚å› æ­¤ï¼Œå½“ä¸€ä¸ªå˜é‡ä¾èµ–å…¶ä»–çš„å˜é‡æ—¶ï¼Œæˆ–è€…å½“å˜é‡çš„æ–°å€¼ä¾èµ–æ—§å€¼æ—¶ï¼Œå°±ä¸èƒ½ä½¿ç”¨volatileã€‚ ç¡¬ä»¶å¯¹å¹¶å‘çš„æ”¯æŒ ç‹¬å é”æ˜¯ä¸€ç§æ‚²è§‚æŠ€æœ¯â€”â€”å®ƒå‡è®¾æœ€åçš„æƒ…å†µï¼Œå¹¶ä¸”åªæœ‰åœ¨ç¡®ä¿å…¶ä»–çº¿ç¨‹ä¸ä¼šæ‰¾å‡ºå¹²æ‰°çš„æƒ…å†µä¸‹æ‰èƒ½æ‰§è¡Œä¸‹å»ã€‚ æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCASï¼Œç¡¬ä»¶æŒ‡ä»¤ï¼‰æ˜¯ä¸€ç§ä¹è§‚çš„æŠ€æœ¯â€”â€”é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥åœ¨ä¸å‘ç”Ÿå¹²æ‰°çš„æƒ…å†µä¸‹å®Œæˆæ›´æ–°æ“ä½œï¼Œä¸è¿‡è¿™ç§æ–¹æ³•éœ€è¦å€ŸåŠ©æ£€æŸ¥æœºåˆ¶æ¥åˆ¤æ–­åœ¨æ›´æ–°è¿‡ç¨‹ä¸­æ˜¯å¦å­˜åœ¨å…¶ä»–çº¿ç¨‹çš„å¹²æ‰°ï¼Œå¦‚æœå­˜åœ¨ï¼Œè¿™ä¸ªæ“ä½œå°†å¤±è´¥ï¼Œå¹¶ä¸”å¯ä»¥é‡è¯•ï¼ˆä¹Ÿå¯ä»¥ä¸é‡è¯•ï¼‰ã€‚ ä¸‹é¢æ˜¯æ¨¡æ‹ŸCASæ“ä½œä»£ç ï¼š1234567891011121314151617181920// CASå«ä¹‰ï¼šæˆ‘è®¤ä¸ºVçš„å€¼åº”è¯¥æ˜¯Aï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆæŠŠå€¼æ›´æ–°ä¸ºBï¼Œå¦åˆ™ä¸ä¿®æ”¹å¹¶å‘Šè¯‰Vçš„å€¼å®é™…æ˜¯å¤šå°‘public class SimulatedCAS &#123; private int value; public synchronized int get() &#123; return value; &#125; public synchronized int compareAndSwap(int expectedValue, int newValue) &#123; int oldValue = value; if (oldValue == expectedValue) &#123; value = new Value; &#125; return oldValue; &#125; public synchronized boolean compareAndSet(int expectedValue, int newValue) &#123; return (expectedValue == compareAndSwap(expectedValue, newValue)); &#125;&#125; CASçš„ä¼˜ç‚¹ï¼šå½“ç«äº‰ç¨‹åºä¸é«˜æ—¶ï¼Œæ€§èƒ½è¿œè¿œé«˜äºåŸºäºé”çš„æ–¹æ¡ˆã€‚ CASçš„ç¼ºç‚¹ï¼šå®ƒå°†ä½¿è°ƒç”¨è€…å¤„ç†ç«äº‰é—®é¢˜ï¼ˆé€šè¿‡é‡è¯•ã€å›é€€ã€æ”¾å¼ƒï¼‰ï¼Œè€Œåœ¨é”ä¸­èƒ½è‡ªåŠ¨å¤„ç†ç«äº‰é—®é¢˜ï¼ˆçº¿ç¨‹åœ¨è·å¾—é”ä¹‹å‰å°†ä¸€ç›´é˜»å¡ï¼‰ã€‚ åŸå­å˜é‡ç±»åŸå­å˜é‡ç±»åœ¨å‘ç”Ÿç«äº‰çš„æƒ…å†µä¸‹èƒ½æä¾›æ›´é«˜çš„å¯ä¼¸ç¼©æ€§ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†ç¡¬ä»¶å¯¹å¹¶å‘çš„æ”¯æŒï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢æŒ‡ä»¤ï¼‰ã€‚ å…±æœ‰12ä¸ªåŸå­å˜é‡ç±»ï¼šå¯åˆ†ä¸ºå››ç»„ï¼šæ ‡é‡ç±»ã€æ›´æ–°å™¨ç±»ã€æ•°ç»„ç±»ä»¥åŠå¤åˆå˜é‡ç±»ã€‚æœ€å¸¸ç”¨çš„åŸå­å˜é‡ç±»å°±æ˜¯æ ‡é‡ç±»ï¼šAtomicIntegerã€AtomicLongã€AtomicBooleanä»¥åŠAtomicReferenceã€‚ åŸå­å˜é‡ä¸é”é€‚ç”¨çš„ä¸åŒå¹¶å‘åœºæ™¯ï¼š åœ¨ä¸­ä½ç¨‹åºçš„ç«äº‰ã€é”å ç”¨æ—¶é—´ä¸é•¿çš„æƒ…å†µä¸‹ï¼ŒåŸå­å˜é‡èƒ½æä¾›æ›´é«˜çš„å¯ä¼¸ç¼©æ€§ã€‚ è€Œåœ¨é«˜å¼ºåº¦çš„ç«äº‰ä¸‹ï¼Œé”èƒ½å¤Ÿæ›´æœ‰æ•ˆçš„åœ°é¿å…ç«äº‰ã€‚ éé˜»å¡ç®—æ³•æ— é˜»å¡ç®—æ³•ï¼š å¦‚æœåœ¨æŸç§ç®—æ³•ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹çš„å¤±è´¥æˆ–è€…æŒ‚èµ·ä¸ä¼šå¯¼è‡´å…¶ä»–çº¿ç¨‹ä¹Ÿå¤±è´¥æˆ–æŒ‚èµ·ï¼Œé‚£ä¹ˆè¿™ç§ç®—æ³•å°±è¢«ç§°ä¸ºæ— é˜»å¡ç®—æ³•ã€‚ æ— é”ç®—æ³•ï¼š å¦‚æœåœ¨ç®—æ³•çš„æ¯ä¸ªæ­¥éª¤ä¸­éƒ½å­˜åœ¨æŸä¸ªçº¿ç¨‹èƒ½å¤Ÿæ‰§è¡Œä¸‹å»ï¼Œé‚£ä¹ˆè¿™ç§ç®—æ³•è¢«ç§°ä¸ºæ— é”ç®—æ³•ã€‚ å¦‚æœåœ¨ç®—æ³•ä¸­ä»…å°†CASç”¨äºåè°ƒçº¿ç¨‹ä¹‹é—´çš„æ“ä½œï¼Œå¹¶ä¸”èƒ½æ­£ç¡®åœ°å®ç°ï¼Œé‚£ä¹ˆå®ƒæ—¢æ˜¯æ— é˜»å¡ç®—æ³•ï¼Œåˆæ˜¯æ— é”ç®—æ³•ã€‚ åˆ©ç”¨CASå¹¶å‘æŒ‡ä»¤å¯ä»¥å®ç°éé˜»å¡çš„åŒæ­¥å®¹å™¨ï¼Œä¾‹å¦‚å®ç°éé˜»å¡çš„æ ˆã€éé˜»å¡çš„é“¾è¡¨ä»¥åŠåŸå­çš„åŸŸæ›´æ–°å™¨ç­‰ã€‚ æ€»ç»“ éé˜»å¡ç®—æ³•é€šè¿‡åº•å±‚çš„å¹¶å‘åŸè¯­ï¼ˆä¾‹å¦‚æ¯”è¾ƒå¹¶äº¤æ¢ï¼‰æ¥ç»´æŒçº¿ç¨‹çš„å®‰å…¨æ€§ã€‚è¿™äº›åº•å±‚çš„åŸè¯­é€šè¿‡åŸå­å˜é‡ç±»å‘å¤–å…¬å¼€ï¼Œä»è€Œä¸ºæ•´æ•°å’Œå¯¹è±¡å¼•ç”¨æä¾›åŸå­çš„æ›´æ–°æ“ä½œã€‚ åœ¨JVMä»ä¸€ä¸ªç‰ˆæœ¬å‡çº§åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œå¹¶å‘æ€§èƒ½ä¸»è¦æå‡éƒ½æ¥è‡ªäºå¯¹éé˜»å¡ç®—æ³•çš„ä½¿ç”¨ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_11_æ„å»ºè‡ªå®šä¹‰åŒæ­¥å·¥å…·]]></title>
    <url>%2F2018%2F01%2F24%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-11-%E6%9E%84%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E5%90%8C%E6%AD%A5%E5%B7%A5%E5%85%B7%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåˆ›å»ºçŠ¶æ€ä¾èµ–çš„ç±»çš„æœ€ç®€å•çš„æ–¹æ³•é€šå¸¸æ˜¯åœ¨ç±»åº“ä¸­ç°æœ‰çŠ¶æ€ä¾èµ–ç±»çš„åŸºç¡€ä¸Šè¿›è¡Œæ„é€ ã€‚ä½†å¦‚æœç±»åº“æ²¡æœ‰æä¾›ä½ éœ€è¦çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨Javaè¯­è¨€å’Œç±»åº“æä¾›çš„åº•å±‚æœºåˆ¶æ¥æ„é€ è‡ªå·±çš„åŒæ­¥æœºåˆ¶ï¼ŒåŒ…æ‹¬å†…ç½®çš„æ¡ä»¶é˜Ÿåˆ—ã€æ˜¾å¼çš„Conditionå¯¹è±¡ä»¥åŠAbstractQueuedSynchronizeræ¡†æ¶ã€‚ çŠ¶æ€ä¾èµ–æ€§ç®¡ç†ç¨‹åºåœ¨åšæŸä¸€ä¸ªæ“ä½œä¹‹å‰ï¼Œéœ€è¦ä¾èµ–å¦ä¸€ä¸ªæ“ä½œçš„å®Œæˆæˆ–è€…çŠ¶æ€çš„å°±ç»ªï¼Œè¿™æ ·çš„ä¸€ç§å…³ç³»å°±å«åšâ€œçŠ¶æ€ä¾èµ–â€ã€‚ çŠ¶æ€ä¾èµ–çš„å®ç°ç±»,ä¾‹å¦‚FutureTaskã€Semaphoreå’ŒBlockingQueueç­‰ã€‚åœ¨è¿™äº›ç±»çš„ä¸€äº›æ“ä½œä¸­æœ‰ç€åŸºäºçŠ¶æ€çš„å‰ææ¡ä»¶ï¼Œä¾‹å¦‚ï¼Œä¸èƒ½ä»ä¸€ä¸ªç©ºé˜Ÿåˆ—åˆ é™¤å…ƒç´ ï¼Œæˆ–è€…è·å–ä¸€ä¸ªå°šæœªç»“æŸçš„ä»»åŠ¡çš„è®¡ç®—ç»“æœï¼Œåœ¨è¿™äº›æ“ä½œå¯ä»¥æ‰§è¡Œä¹‹å‰ï¼Œå¿…é¡»ç­‰å¾…é˜Ÿåˆ—è¿›å…¥â€œéç©ºâ€çŠ¶æ€ï¼Œæˆ–è€…ä»»åŠ¡è¿›å…¥â€œå·²å®Œæˆâ€çŠ¶æ€ã€‚ ä¾èµ–çŠ¶æ€çš„æ“ä½œå¯ä»¥ä¸€ç›´é˜»å¡ç›´åˆ°å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œè¿™æ¯”ä½¿ä»–ä»¬å…ˆå¤±è´¥å†å®ç°èµ·æ¥è¦æ›´ä¸ºæ–¹ä¾¿ä¸”æ›´ä¸å®¹æ˜“å‡ºé”™ã€‚è€Œå†…ç½®çš„æ¡ä»¶é˜Ÿåˆ—å°±å¯ä»¥æ˜¯çº¿ç¨‹ä¸€ç›´é˜»å¡ï¼Œç›´åˆ°å¯¹è±¡è¿›å…¥æŸä¸ªçº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œçš„çŠ¶æ€ï¼Œå¹¶ä¸”å½“è¢«é˜»å¡çš„çº¿ç¨‹å¯ä»¥æ‰§è¡Œæ—¶å†å”¤é†’ä»–ä»¬ã€‚ ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—æ¡ä»¶é˜Ÿåˆ—ï¼šå®ƒä½¿å¾—ä¸€ç»„çº¿ç¨‹ï¼ˆç§°ä¹‹ä¸ºç­‰å¾…çº¿ç¨‹é›†åˆï¼‰èƒ½å¤Ÿé€šè¿‡æŸç§æ–¹å¼æ¥ç­‰å¾…ç‰¹å®šçš„æ¡ä»¶å˜ä¸ºçœŸã€‚ä¼ ç»Ÿçš„é˜Ÿåˆ—æ˜¯ä¸€ä¸ªä¸ªæ•°æ®ï¼Œè€Œä¸ä¹‹ä¸åŒçš„æ˜¯ï¼Œæ¡ä»¶é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯ä¸€ä¸ªä¸ªæ­£åœ¨ç­‰å¾…ç›¸å…³æ¡ä»¶çš„çº¿ç¨‹ã€‚ Objectä¸­çš„waitã€notifyå’ŒnotifyAllæ–¹æ³•æ„æˆäº†å†…éƒ¨æ¡ä»¶é˜Ÿåˆ—çš„APIã€‚ å¯¹è±¡çš„å†…ç½®é”ä¸å†…éƒ¨æ¡ä»¶æ˜¯ç›¸äº’å…³è”çš„ï¼Œè¦è°ƒç”¨å¯¹è±¡Xä¸­çš„æ¡ä»¶é˜Ÿåˆ—çš„ä»»ä½•ä¸€ä¸ªæ–¹æ³•ï¼Œå¿…é¡»æŒæœ‰å¯¹è±¡Xä¸Šçš„é”ã€‚ Object.waitä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œå¹¶è¯·æ±‚æ“ä½œç³»ç»ŸæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œä»è€Œä½¿å…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿè·å¾—è¿™ä¸ªé”å¹¶ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€ã€‚å½“è¢«æŒ‚èµ·çš„çº¿è·¯é†’æ¥æ—¶ï¼Œå®ƒå°†åœ¨è¿”å›ä¹‹å‰é‡æ–°è·å–é”ã€‚ï¼ˆéœ€è¦é‡æ–°ç«äº‰ï¼Œå¹¶æ²¡æœ‰ä¼˜å…ˆè·å–æƒï¼‰ ä½¿ç”¨æ¡ä»¶é˜Ÿåˆ—æ„é€ æœ‰ç•Œç¼“å­˜ç¤ºä¾‹å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960//æœªåŠ ä»»ä½•çº¦æŸçš„ç¼“å†²é˜Ÿåˆ—public abstract class BaseBoundedBuffer&lt;V&gt; &#123; private final V[] buf;//ç¼“å­˜ private int tail;//é˜Ÿå°¾ private int head;//é˜Ÿé¦– private int count;//å…ƒç´ ä¸ªæ•° protected BaseBoundedBuffer(int capacity) &#123; this.buf = (V[]) new Object[capacity]; &#125; protected synchronized final void doPut(V v) &#123;//å…¥é˜Ÿ buf[tail] = v;//åœ¨é˜Ÿå°¾æ·»åŠ  if (++tail == buf.length)//å¦‚æœæ»¡äº†ï¼Œä»å¤´å¼€å§‹ tail = 0; ++count; &#125; protected synchronized final V doTake() &#123;//å‡ºé˜Ÿ V v = buf[head];//ä»é˜Ÿé¦–å–å‡º buf[head] = null;//GC if (++head == buf.length)//å¦‚æœåˆ°å°¾äº†ï¼Œåˆ™ä»å¤´å¼€å§‹ head = 0; --count; return v; &#125; public synchronized final boolean isFull() &#123;//é˜Ÿåˆ—æ˜¯å¦æ»¡ return count == buf.length; &#125; public synchronized final boolean isEmpty() &#123;//é˜Ÿåˆ—æ˜¯å¦ç©º return count == 0; &#125;&#125;@ThreadSafepublic class BoundedBuffer&lt;V&gt; extends BaseBoundedBuffer&lt;V&gt; &#123; // æ¡ä»¶è°“è¯ï¼šnot-full(!isFull()) // æ¡ä»¶è°“è¯ï¼šnot-empty(!isEmpty()) public BoundedBuffer(int size) &#123; super(size); &#125; // é˜»å¡å¹¶ç›´åˆ°: not-full public synchronized void put(V v) throws InterruptedException &#123; while (isFull())//å¦‚æœæ»¡ï¼Œåˆ™ç­‰å¾… wait(); doPut(v); notifyAll();//å¹¶åœ¨æ”¾å…¥åé©¬ä¸Šé€šçŸ¥å…¶ä»–çº¿ç¨‹ &#125; // é˜»å¡å¹¶ç›´åˆ°: not-empty public synchronized V take() throws InterruptedException &#123; while (isEmpty())//å¦‚æœä¸ºç©ºï¼Œåˆ™ç­‰å¾… wait(); V v = doTake(); notifyAll(); return v; &#125;&#125; æ¡ä»¶è°“è¯æ¡ä»¶è°“è¯æ˜¯ä½¿æŸä¸ªæ“ä½œæˆä¸ºçŠ¶æ€ä¾èµ–æ“ä½œçš„å‰ææ¡ä»¶ã€‚åœ¨æœ‰ç•Œç¼“å­˜ä¸­ï¼Œåªæœ‰å½“ç¼“å­˜ä¸ä¸ºç©ºæ—¶ï¼Œtakeæ–¹æ³•æ‰èƒ½æ‰§è¡Œï¼Œå¦åˆ™å¿…é¡»ç­‰å¾…ã€‚å¯¹takeæ–¹æ³•æ¥è¯´ï¼Œå®ƒçš„æ¡ä»¶è°“è¯å°±æ˜¯â€œç¼“å­˜ä¸ä¸ºç©ºâ€ï¼Œtakeæ–¹æ³•åœ¨æ‰§è¡Œä¹‹å‰å¿…é¡»é¦–å…ˆæµ‹è¯•è¯¥æ¡ä»¶è°“è¯ã€‚ æ¡ä»¶ç­‰å¾…å­˜åœ¨çš„ä¸‰å…ƒå…³ç³»ï¼š åŒ…æ‹¬åŠ é”ã€waitæ–¹æ³•å’Œä¸€ä¸ªæ¡ä»¶è°“è¯ã€‚åœ¨æ¡ä»¶è°“è¯ä¸­åŒ…å«å¤šä¸ªåŒ…å«å¤šä¸ªçŠ¶æ€å˜é‡ï¼Œè€ŒçŠ¶æ€å˜é‡ç”±ä¸€ä¸ªé”æ¥ä¿æŠ¤ï¼Œå› æ­¤åœ¨æµ‹è¯•æ¡ä»¶è°“è¯ä¹‹å‰å¿…é¡»å…ˆæŒæœ‰è¿™ä¸ªé”ï¼Œé”å¯¹è±¡ä¸æ¡ä»¶é˜Ÿåˆ—å¯¹è±¡ï¼ˆå³è°ƒç”¨waitå’Œnotifyç­‰æ–¹æ³•æ‰€åœ¨çš„å¯¹è±¡ï¼‰å¿…é¡»æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚ æ¯ä¸€æ¬¡waitè°ƒç”¨éƒ½ä¼šéšå¼åœ°ä¸ç‰¹å®šçš„æ¡ä»¶è°“è¯å…³è”èµ·æ¥ã€‚å½“è°ƒç”¨æŸä¸ªç‰¹å®šæ¡ä»¶è°“è¯çš„waitæ—¶ï¼Œè°ƒç”¨è€…å¿…é¡»å·²ç»æŒæœ‰ä¸æ¡ä»¶é˜Ÿåˆ—ç›¸å…³çš„é”ï¼Œå¹¶ä¸”è¿™ä¸ªé”å¿…é¡»ä¿æŠ¤ç€æ„æˆæ¡ä»¶è°“è¯çš„çŠ¶æ€å˜é‡ã€‚ è¿‡æ—©å”¤é†’waitæ–¹æ³•çš„è¿”å›å¹¶ä¸ä¸€å®šæ„å‘³ç€çº¿ç¨‹æ­£åœ¨ç­‰å¾…çš„æ¡ä»¶è°“è¯å·²ç»å˜çœŸäº†ï¼Œå› ä¸ºä¹Ÿè®¸æ˜¯å› ä¸ºä¸åŒä¸€æ¡ä»¶é˜Ÿåˆ—ç›¸å…³çš„å¦ä¸€ä¸ªæ¡ä»¶è°“è¯å˜æˆäº†çœŸã€‚ å½“ä½¿ç”¨æ¡ä»¶ç­‰å¾…æ—¶è¦æ»¡è¶³çš„æ¡ä»¶ï¼ˆObject.waitæˆ–Condition.waitï¼‰ é€šå¸¸éƒ½æœ‰ä¸€ä¸ªæ¡ä»¶è°“è¯â€”â€”åŒ…æ‹¬ä¸€äº›å¯¹è±¡çŠ¶æ€çš„æµ‹è¯•ï¼Œçº¿ç¨‹åœ¨æ‰§è¡Œå‰å¿…é¡»é¦–å…ˆé€šè¿‡è¿™äº›æµ‹è¯•ã€‚ åœ¨è°ƒç”¨waitä¹‹å‰æµ‹è¯•æ¡ä»¶è°“è¯ï¼Œå¹¶ä¸”ä»waitä¸­è¿”å›æ—¶å†æ¬¡è¿›è¡Œæµ‹è¯•ã€‚ åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è°ƒç”¨waitã€‚ ç¡®ä¿ä½¿ç”¨ä¸æ¡ä»¶é˜Ÿåˆ—ç›¸å…³çš„é”æ¥ä¿æŠ¤æ„æˆæ¡ä»¶è°“è¯çš„å„ä¸ªçŠ¶æ€å˜é‡ã€‚ å½“è°ƒç”¨wait/notify/notifyAllç­‰æ–¹æ³•æ—¶ï¼Œä¸€å®šè¦æŒæœ‰ä¸æ¡ä»¶é˜Ÿåˆ—ç›¸å…³çš„é”ã€‚ åœ¨æ£€æŸ¥æ¡ä»¶è°“è¯ä¹‹åä»¥åŠå¼€å§‹æ‰§è¡Œç›¸åº”çš„æ“ä½œä¹‹å‰ï¼Œä¸è¦é‡Šæ”¾é”ã€‚ ä¸¢å¤±çš„ä¿¡å·ä¸¢å¤±çš„ä¿¡å·ï¼š notifyæˆ–è€…notifyAllæ“ä½œå‘ç”Ÿåœ¨waitä¹‹å‰ï¼Œå°±ä¼šé€ æˆé€šçŸ¥ä¿¡å·çš„ä¸¢å¤±ï¼Œæœ€ç»ˆwaitæ°¸è¿œéƒ½å¾—ä¸åˆ°æ¢å¤æˆ–è€…ä¸å¾—ä¸ç­‰å¾…ä¸‹ä¸€æ¬¡é‡æ–°é€šçŸ¥è€Œå»¶è¿Ÿäº†æ¢å¤æ—¶é—´ã€‚ é€šçŸ¥æ¯å½“åœ¨ç­‰å¾…ä¸€ä¸ªæ¡ä»¶æ—¶ï¼Œä¸€å®šè¦ç¡®ä¿åœ¨æ¡ä»¶è°“è¯å˜ä¸ºçœŸæ—¶é€šè¿‡æŸç§æ–¹å¼å‘å‡ºé€šçŸ¥ å‘å‡ºé€šçŸ¥çš„çº¿ç¨‹åº”è¯¥å°½å¿«åœ°é‡Šæ”¾é”ï¼Œä»è€Œç¡®ä¿æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å°½å¯èƒ½å¿«åœ°è§£é™¤é˜»å¡ã€‚å¦‚æœè¿™äº›ç­‰å¾…ä¸­çº¿ç¨‹æ­¤æ—¶ä¸èƒ½é‡æ–°è·å¾—é”ï¼Œé‚£ä¹ˆæ— æ³•ä»waitè¿”å›ã€‚ åªæœ‰åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ—¶ï¼Œæ‰èƒ½ç”¨å•ä¸€çš„notifyè€Œä¸æ˜¯notifyAllï¼š æ‰€æœ‰ç­‰å¾…çº¿ç¨‹çš„ç±»å‹éƒ½ç›¸åŒã€‚åªæœ‰ä¸€ä¸ªæ¡ä»¶è°“è¯ä¸æ¡ä»¶é˜Ÿåˆ—ç›¸å…³ï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹åœ¨waitè¿”å›åå°†æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚ å•è¿›å•å‡ºã€‚åœ¨æ¡ä»¶å˜é‡ä¸Šçš„æ¯æ¬¡é€šçŸ¥ï¼Œæœ€å¤šåªèƒ½å”¤é†’ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œã€‚ æ˜¾å¼çš„Conditionå¯¹è±¡å†…ç½®æ¡ä»¶é˜Ÿåˆ—çš„å±€é™æ€§ï¼šæ¯ä¸ªå†…ç½®é”éƒ½åªèƒ½æœ‰ä¸€ä¸ªç›¸å…³è”çš„æ¡ä»¶é˜Ÿåˆ—ï¼Œå› è€Œåœ¨åƒBoundBufferè¿™ç§ç±»ä¸­ï¼Œå¤šä¸ªçº¿ç¨‹å¯èƒ½åœ¨åŒä¸€ä¸ªæ¡ä»¶é˜Ÿåˆ—ä¸Šç­‰å¾…ä¸åŒçš„æ¡ä»¶è°“è¯ï¼Œå¹¶ä¸”åœ¨æœ€å¸¸è§çš„åŠ é”æ¨¡å¼ä¸‹å…¬å¼€æ¡ä»¶é˜Ÿåˆ—å¯¹è±¡ã€‚ æ˜¾ç¤ºæ¡ä»¶é˜Ÿåˆ—çš„ä¼˜åŠ¿ï¼šå¯ä»¥ç¼–å†™ä¸€ä¸ªå¸¦æœ‰å¤šä¸ªæ¡ä»¶è°“è¯çš„å¹¶å‘å¯¹è±¡ï¼Œæˆ–è€…è·å¾—é™¤äº†æ¡ä»¶é˜Ÿåˆ—å¯è§æ€§ä¹‹å¤–çš„æ›´å¤šæ§åˆ¶æƒï¼Œè¿™æ˜¯ä¸€ç§çµæ´»çš„é€‰æ‹©ï¼›å¯¹äºæ¯ä¸ªLockï¼Œå¯ä»¥æœ‰ä»»æ„æ•°é‡çš„Conditionå¯¹è±¡ã€‚Conditionå¯¹è±¡ç»§æ‰¿äº†ç›¸å…³çš„Lockå¯¹è±¡çš„å…¬å¹³æ€§ï¼Œå¯¹äºå…¬å¹³çš„é”ï¼Œçº¿ç¨‹ä¼šä¾ç…§FIFOé¡ºåºä»Condition awaitä¸­é‡Šæ”¾ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šConditionå¯¹è±¡ä¸­ï¼Œä¸‰ä¸ªä¸æ¡ä»¶é˜Ÿåˆ—ç›¸å…³çš„APIæ˜¯ï¼šawait,signal,signalAllã€‚ ä¸‹é¢æ˜¯ä½¿ç”¨æ˜¾ç¤ºçš„Conditionå¯¹è±¡å®ç°çš„æœ‰ç•Œç¼“å­˜:123456789101112131415161718192021222324252627282930313233343536373839public class ConditionBoundedBuffer&lt;T&gt; &#123; protected final Lock lock = new ReentrantLock(); private final Condition notFull = lock.newCondition();//æ¡ä»¶ï¼šcount &lt; items.length private final Condition notEmpty = lock.newCondition();//æ¡ä»¶ï¼šcount &gt; 0 private final T[] items = (T[]) new Object[100]; private int tail, head, count; public void put(T x) throws InterruptedException &#123; lock.lock(); try &#123; while (count == items.length) notFull.await();//ç­‰åˆ°æ¡ä»¶count &lt; items.lengthæ»¡è¶³ items[tail] = x; if (++tail == items.length) tail = 0; ++count; notEmpty.signal();//é€šçŸ¥è¯»å–ç­‰å¾…çº¿ç¨‹ &#125; finally &#123; lock.unlock(); &#125; &#125; public T take() throws InterruptedException &#123; lock.lock(); try &#123; while (count == 0) notEmpty.await();//ç­‰åˆ°æ¡ä»¶count &gt; 0æ»¡è¶³ T x = items[head]; items[head] = null; if (++head == items.length) head = 0; --count; notFull.signal();//é€šçŸ¥å†™å…¥ç­‰å¾…çº¿ç¨‹ return x; &#125; finally &#123; lock.unlock(); &#125; &#125;&#125; AbstractQueuedSynchronizerAbstractQueuedSynchronizeræ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ¡†æ¶ï¼Œè®¸å¤šåŒæ­¥å™¨éƒ½å¯ä»¥é€šè¿‡AQSå¾ˆå®¹æ˜“å¹¶ä¸”é«˜æ•ˆåœ°æ„é€ å‡ºæ¥ã€‚ä¾‹å¦‚ï¼šReentrantLockã€Semaphoreã€CountDownLatchã€ReentrantReadWriteLockã€SynchronousQueueå’ŒFutureTaskã€‚ ä¸‹é¢æ˜¯AQSä¸­è·å–æ“ä½œå’Œé‡Šæ”¾æ“ä½œçš„æ ‡å‡†å½¢å¼ï¼š1234567891011121314151617181920212223boolean acquire() throws InterruptedException&#123; while (å½“å‰çŠ¶æ€ä¸å…è®¸è·å–æ“ä½œ) &#123; if (éœ€è¦é˜»å¡è·å–è¯·æ±‚) &#123; å¦‚æœå½“å‰çº¿ç¨‹ä¸åœ¨é˜Ÿåˆ—ä¸­ï¼Œåˆ™å°†å…¶æ’å…¥é˜Ÿåˆ— é˜»å¡å½“å‰çº¿ç¨‹ &#125; else è¿”å›å¤±è´¥ &#125; å¯èƒ½æ›´æ–°åŒæ­¥å™¨çš„çŠ¶æ€ å¦‚æœçº¿ç¨‹ä½äºé˜Ÿåˆ—ä¸­ï¼Œåˆ™å°†å…¶ç§»å‡ºé˜Ÿåˆ— è¿”å›æˆåŠŸ&#125;void release()&#123; æ›´æ–°åŒæ­¥å™¨çš„çŠ¶æ€ if (æ–°çš„çŠ¶æ€å…è®¸æŸä¸ªè¢«é˜»å¡çš„çº¿ç¨‹è·å–æˆåŠŸ) è§£é™¤é˜Ÿåˆ—ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹çš„é˜»å¡çŠ¶æ€&#125; æ€»ç»“è¦å®ç°ä¸€ä¸ªä¾èµ–çŠ¶æ€çš„ç±»â€”â€”å¦‚æœæ²¡æœ‰æ»¡è¶³ä¾èµ–çŠ¶æ€çš„å‰ææ¡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»çš„æ–¹æ³•å¿…é¡»é˜»å¡ï¼Œé‚£ä¹ˆæœ€å¥½çš„æ–¹å¼æ˜¯åŸºäºç°æœ‰ç±»åº“æ¥æ„å»ºï¼Œä¾‹å¦‚Semaphore.BlockingQueueæˆ–CountDownLatchã€‚ç„¶è€Œï¼Œæœ‰æ—¶å€™ç°æœ‰çš„ç±»åº“ä¸èƒ½æä¾›è¶³å¤Ÿçš„åŠŸèƒ½ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„æ¡ä»¶é˜Ÿåˆ—ã€æ˜¾å¼çš„Conditionå¯¹è±¡æˆ–è€…AbstractQueuedSynchronizeræ¥æ„å»ºè‡ªå·±çš„åŒæ­¥å™¨ã€‚å†…ç½®æ¡ä»¶é˜Ÿåˆ—ä¸å†…ç½®é”æ˜¯ç´§å¯†ç»‘å®šåœ¨ä¸€èµ·çš„ï¼Œè¿™æ˜¯å› ä¸ºç®¡ç†çŠ¶æ€ä¾èµ–æ€§çš„æœºåˆ¶å¿…é¡»ä¸ç¡®ä¿çŠ¶æ€ä¸€è‡´æ€§çš„æœºåˆ¶å…³è”èµ·æ¥ã€‚åŒæ ·ï¼Œæ˜¾å¼çš„Conditionä¸æ˜¾å¼åœ°Lockä¹Ÿæ˜¯ç´§å¯†åœ°ç»‘å®šåœ¨ä¸€èµ·çš„ï¼Œå¹¶ä¸”ä¸å†…ç½®æ¡ä»¶é˜Ÿåˆ—ç›¸æ¯”ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªæ‰©å±•çš„åŠŸèƒ½é›†ï¼ŒåŒ…æ‹¬æ¯ä¸ªé”å¯¹åº”äºå¤šä¸ªç­‰å¾…çº¿ç¨‹é›†ï¼Œå¯ä¸­æ–­æˆ–ä¸å¯ä¸­æ–­çš„æ¡ä»¶ç­‰å¾…ï¼Œå…¬å¹³æˆ–éå…¬å¹³çš„é˜Ÿåˆ—æ“ä½œï¼Œä»¥åŠåŸºäºæ—¶é™çš„ç­‰å¾…ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_10_æ˜¾ç¤ºé”]]></title>
    <url>%2F2018%2F01%2F24%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-10-%E6%98%BE%E7%A4%BA%E9%94%81%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šJava5.0ä»¥åæä¾›äº†ä¸€ç§æ–°çš„åè°ƒå¯¹å…±äº«å¯¹è±¡çš„è®¿é—®æœºåˆ¶â€”â€”ReentrantLockã€‚å®ƒå¹¶ä¸æ˜¯ç”¨æ¥æ›¿ä»£å†…ç½®é”çš„æ–¹æ³•ï¼Œè€Œæ˜¯å½“å†…ç½®åŠ é”ä¸é€‚ç”¨æ—¶ï¼Œä½œä¸ºä¸€ç§å¯é€‰æ‹©çš„é«˜çº§åŠŸèƒ½ã€‚ ReentrantLockReentrantLockå®ç°äº†Lockæ¥å£ï¼Œå¹¶æä¾›äº†ä¸synchronizedç›¸åŒçš„äº’æ–¥æ€§å’Œå†…å­˜å¯è§æ€§ï¼Œä½†æ˜¯é€šå¸¸èƒ½æä¾›æ›´å¥½çš„æ´»è·ƒæ€§æˆ–æ€§èƒ½ã€‚ä¸‹é¢æ˜¯Lockæ¥å£ä»£ç ï¼š12345678public interface Lock &#123; void lock(); void lockInterruptibly() throws InterruptedException; boolean tryLock(); boolean tryLock(long timeout, TimeUnit unit) throws InterruptedException; void unlock(); Condition newCondition();&#125; ä¸ºä»€ä¹ˆè¦åˆ›å»ºä¸€ç§ä¸å†…ç½®é”å¦‚æ­¤ç›¸ä¼¼çš„æ–°åŠ é”ä»·å€¼ï¼Ÿæ˜¯ç”±äºå†…ç½®é”å…·æœ‰ä»¥ä¸‹çš„å±€é™æ€§ï¼š æ— æ³•ä¸­æ–­ä¸€ä¸ªæ­£åœ¨ç­‰å¾…è·å–é”çš„çº¿ç¨‹ã€‚ å†…ç½®é”å¿…é¡»åœ¨è·å–é”çš„ä»£ç å—ä¸­é‡Šæ”¾ï¼Œè¿™å°±ç®€åŒ–äº†ç¼–ç å·¥ä½œï¼Œå¹¶ä¸”ä¸å¼‚å¸¸å¤„ç†æ“ä½œå®ç°äº†å¾ˆå¥½çš„äº’åŠ¨ï¼Œä½†å´æ— æ³•å®ç°éé˜»å¡ç»“æ„çš„åŠ é”è§„åˆ™ã€‚ ä¸‹é¢æ˜¯Lockæ¥å£çš„æ ‡å‡†ä½¿ç”¨å½¢å¼ï¼š123456789Lock lock = new ReentrantLock();...lock.lock();try &#123; //æ›´æ–°å¯¹è±¡çŠ¶æ€ //æ•è·å¼‚å¸¸ï¼Œå¹¶åœ¨å¿…è¦æ—¶æ¢å¤ä¸å˜æ€§æ¡ä»¶&#125; finally &#123; lock.unlock(); //â€œå®šæ—¶ç‚¸å¼¹â€ï¼Œä¸€å®šè¦è®°å¾—é‡Šæ”¾Lock&#125; è½®è¯¢é”ä¸å®šæ—¶é”å¯å®šæ—¶çš„ä¸å¯è½®è¯¢çš„é”è·å–æ¨¡å¼æ˜¯ç”±tryLockæ–¹æ³•å®ç°çš„ï¼Œä¸æ— æ¡ä»¶çš„é”è·å–æ¨¡å¼ç›¸æ¯”ï¼Œå®ƒå…·æœ‰æ›´å®Œå–„çš„é”™è¯¯æ¢å¤æœºåˆ¶ã€‚åœ¨å†…ç½®é”ä¸­ï¼Œæ­»é”æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œæ¢å¤ç¨‹åºçš„å”¯ä¸€åŠæ³•æ˜¯é‡æ–°å¯åŠ¨ç¨‹åºï¼Œè€Œé˜²æ­¢æ­»é”çš„å”¯ä¸€æ–¹æ³•å°±æ˜¯åœ¨æ„é€ ç¨‹åºæ—¶é¿å…å‡ºç°ä¸ä¸€è‡´çš„é”é¡ºåºã€‚å¯å®šæ—¶çš„ä¸å¯è½®è¯¢çš„çš„é”æä¾›äº†å¦ä¸€ç§é€‰æ‹©ï¼Œé¿å…æ­»é”çš„å‘ç”Ÿã€‚é€šè¿‡é‡æ–°è·å–åŠé‡Šæ”¾é”æ¥é¿å…æ­»é”ã€‚ å¯ä¸­æ–­çš„é”æ“ä½œè·å–æ“ä½œå¯ä¸­æ–­çš„é”æ“ä½œè·å–æ“ä½œæ˜¯æœ‰lockInterruptiblyæˆ–è€…tryLockæ–¹æ³•å®ç°çš„ï¼Œå¦‚æœåœ¨å¯ä¸­æ–­çš„é”è·å–æ“ä½œä¸­æŠ›å‡ºäº†InterruptedExceptionï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ ‡å‡†çš„try-finallyåŠ é”æ¨¡å¼ã€‚ éå—ç»“æ„çš„åŠ é”æˆ‘ä»¬é€šè¿‡Lockçš„ä½¿ç”¨ç»“æ„å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬é€šè¿‡ReentrantLockå¯ä»¥çµæ´»çš„å®ç°é”çš„ç²’åº¦ã€‚ å…¬å¹³æ€§å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéå…¬å¹³é”çš„æ€§èƒ½è¦é«˜äºå…¬å¹³é”çš„æ€§èƒ½ï¼ŒåŸå› æ˜¯åè€…ä¸ºäº†å®ç°å…¬å¹³ï¼Œä¼šæœ‰æ›´å¤šçš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬ã€‚ å½“æŒæœ‰é”çš„æ—¶é—´è¾ƒé•¿ï¼Œæˆ–è€…è¯·æ±‚é”çš„å¹³å‡æ—¶é—´é—´éš”è¾ƒé•¿ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨å…¬å¹³é”ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå…è®¸â€œæ’é˜Ÿâ€å¸¦æ¥çš„ååé‡æå‡ï¼ˆå½“é”å¤„äºå¯ç”¨çš„çŠ¶æ€æ—¶ï¼Œçº¿ç¨‹å´è¿˜å¤„äºè¢«å”¤é†’çš„è¿‡ç¨‹ä¸­ï¼‰åˆ™å¯èƒ½ä¸ä¼šå‡ºç°ã€‚ åœ¨synchronizedå’ŒReentrantLockä¹‹é—´è¿›è¡Œé€‰æ‹©åœ¨ä¸€äº›å†…ç½®é”æ— æ³•æ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹ï¼ŒReentrantLockå¯ä»¥ä½œä¸ºä¸€ç§é«˜çº§å·¥å…·ã€‚å½“éœ€è¦ä¸€äº›é«˜çº§åŠŸèƒ½æ—¶æ‰åº”è¯¥ä½¿ç”¨ReentrantLockï¼Œè¿™äº›åŠŸèƒ½åŒ…æ‹¬ï¼šå¯å®šæ—¶çš„ã€å¯è½®è¯¢çš„ä¸å¯ä¸­æ–­çš„é”è·å–æ“ä½œï¼Œå…¬å¹³é˜Ÿåˆ—ï¼ˆé»˜è®¤éå…¬å¹³ï¼‰ï¼Œä»¥åŠéå—ç»“æ„çš„é”ã€‚å¦åˆ™ï¼Œè¿˜æ˜¯åº”è¯¥ä¼˜å…ˆä½¿ç”¨synchronizedã€‚ è¯»-å†™é”åœ¨è¯»-å†™é”çš„åŠ é”ç­–ç•¥ä¸­ï¼Œå…è®¸å¤šä¸ªè¯»æ“ä½œåŒæ—¶è¿›è¡Œï¼Œä½†æ¯æ¬¡åªå…è®¸ä¸€ä¸ªå†™æ“ä½œã€‚ ReentrantReadWriteLockä¸ºè¯»é”å’Œå†™é”éƒ½æä¾›äº†å¯é‡å…¥çš„åŠ é”è¯­ä¹‰ã€‚ReentrantReadWriteLockåœ¨æ„é€ æ—¶å¯ä»¥é€‰æ‹©æ˜¯ä¸€ä¸ªéå…¬å¹³çš„é”ï¼ˆé»˜è®¤ï¼‰è¿˜æ˜¯ä¸€ä¸ªå…¬å¹³çš„é”ã€‚åœ¨å…¬å¹³çš„é”ä¸­ï¼Œç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹å°†ä¼˜å…ˆè·å¾—é”ã€‚åœ¨éå…¬å¹³çš„é”ä¸­ï¼Œçº¿ç¨‹è·å¾—è®¿é—®è®¸å¯çš„é¡ºåºæ˜¯ä¸ç¡®å®šçš„ã€‚å†™çº¿ç¨‹å¯ä»¥é™çº§ä¸ºè¯»çº¿ç¨‹ï¼Œä½†æ˜¯è¯»çº¿ç¨‹ä¸å¯ä»¥å‡çº§ä¸ºå†™çº¿ç¨‹ï¼ˆå› ä¸ºå¤šä¸ªè¯»çº¿ç¨‹éƒ½ä¸ä¼šæ”¾å¼ƒè‡ªå·±çš„è¯»å–é”è€Œå¯¼è‡´æ­»é”ï¼‰ã€‚ é€‚ç”¨åœºæ™¯ï¼š å½“é”çš„æŒæœ‰æ—¶é—´è¾ƒé•¿å¹¶ä¸”å¤§éƒ¨åˆ†æ“ä½œéƒ½ä¸ä¼šä¿®æ”¹è¢«å®ˆæŠ¤çš„èµ„æºæ—¶ï¼Œé‚£ä¹ˆè¯»-å†™é”èƒ½æé«˜å¹¶å‘æ€§ã€‚å¦‚æœå†™æ“ä½œä¹Ÿå¾ˆé¢‘ç¹ï¼Œé‚£å¯èƒ½ç‹¬å é”æ›´åˆé€‚ä¸€äº›ï¼Œå› ä¸ºå†™æ“ä½œå¤ªå¤šï¼Œç«äº‰ä¼šå¾ˆæ¿€çƒˆï¼Œå†åŠ ä¸Šåè°ƒè¯»å†™é”ï¼Œæ€§èƒ½åè€Œä¸å¦‚ç‹¬å é”äº†ã€‚ ä¸‹é¢å±•ç¤ºç”¨è¯»-å†™é”æ¥åŒ…è£…Mapï¼š123456789101112131415161718192021222324252627282930public class ReadWriteMap&lt;K, V&gt; &#123; private final Map&lt;K, V&gt; map; private final ReadWriteLock lock = new ReentrantReadWriteLock(); private final Lock r = lock.readLock(); private final Lock w = lock.writeLock(); public ReadWriteMap(Map&lt;K, V&gt; map) &#123; this.map = map; &#125; public V put (K key, V value) &#123; w.lock(); try &#123; return map. put(key, value); &#125; finally &#123; w.unlock(); &#125; &#125; // å¯¹remove(),putAll(),clear()ç­‰æ–¹æ³•æ‰§è¡ŒåŒæ ·çš„æ“ä½œ public V get(Object key) &#123; r.lock(); try &#123; return map.get(key); &#125; finally &#123; r.unlock(); &#125; &#125; // å¯¹å…¶ä»–åªè¯»çš„Mapæ–¹æ³•æ‰§è¡Œç›¸åŒçš„æ“ä½œ&#125; æ€»ç»“ ä¸å†…ç½®é”ç›¸æ¯”ï¼Œæ˜¾ç¤ºçš„Lockæä¾›äº†ä¸€äº›æ‰©å±•åŠŸèƒ½ï¼Œåœ¨å¤„ç†é”çš„ä¸å¯ç”¨æ€§æ–¹æ³•æœ‰ç€æ›´é«˜çš„çµæ´»æ€§ã€‚ä½†ReentrantLockä¸èƒ½å®Œå…¨æ›¿ä»£synchronizedï¼Œåªæœ‰åœ¨synchronizedæ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œæ‰åº”è¯¥ä½¿ç”¨å®ƒã€‚ è¯»-å†™é”è¿è¡Œå¤šä¸ªè¯»çº¿ç¨‹å¹¶å‘åœ°è®¿é—®è¢«ä¿æŠ¤çš„å¯¹è±¡ï¼Œå½“è®¿é—®ä»¥è¯»å–æ“ä½œä¸ºä¸»çš„æ•°æ®ç»“æ„æ—¶ï¼Œå®ƒèƒ½æé«˜ç¨‹åºçš„å¯ä¼¸ç¼©æ€§ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_9_æ€§èƒ½å’Œå¯ä¼¸ç¼©æ€§]]></title>
    <url>%2F2018%2F01%2F24%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-9-%E6%80%A7%E8%83%BD%E5%92%8C%E5%8F%AF%E4%BC%B8%E7%BC%A9%E6%80%A7%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šçº¿ç¨‹æœ€ä¸»è¦çš„ç›®çš„æ˜¯æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½ï¼Œè™½ç„¶æˆ‘ä»¬å¸Œæœ›è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œä½†å§‹ç»ˆè¦æŠŠå®‰å…¨æ€§æ”¾åœ¨ç¬¬ä¸€ä½ã€‚é¦–å…ˆè¦ä¿è¯ç¨‹åºçš„æ­£å¸¸è¿è¡Œï¼Œç„¶åä»…å½“ç¨‹åºçš„æ€§èƒ½éœ€æ±‚å’Œæµ‹è¯•ç»“æœè¦æ±‚ç¨‹åºæ‰§è¡Œå¾—æ›´å¿«æ—¶ï¼Œæ‰åº”è¯¥è®¾æ³•æé«˜å®ƒçš„è¿è¡Œé€Ÿåº¦ æ€§èƒ½å’Œå¯ä¼¸ç¼©æ€§æå‡æ€§èƒ½æ„å‘³ç€ç”¨æ›´å°‘çš„èµ„æºåšæ›´å¤šçš„äº‹ã€‚è¿™äº›èµ„æºåŒ…æ‹¬CPUæ—¶é’Ÿå‘¨æœŸã€å†…å­˜ã€ç½‘ç»œå¸¦å®½ã€I/Oå¸¦å®½ã€æ•°æ®åº“è¯·æ±‚ã€ç£ç›˜ç©ºé—´ä»¥åŠå…¶ä»–èµ„æºã€‚ å°½ç®¡å°±æ˜¯ç”¨å¤šä¸ªçº¿ç¨‹çš„ç›®æ ‡æ˜¯æå‡æ•´ä½“æ€§èƒ½ï¼Œä½†ä¸å•çº¿ç¨‹ç›¸æ¯”ï¼Œä½¿ç”¨å¤šä¸ªçº¿ç¨‹ä¼šå¼•å…¥ä¸€äº›é¢å¤–çš„å¼€é”€ã€‚é€ æˆè¿™äº›å¼€é”€çš„æ“ä½œåŒ…æ‹¬ï¼šçº¿ç¨‹ä¹‹é—´çš„åè°ƒï¼ˆä¾‹å¦‚åŠ é”ã€è§¦å‘ä¿¡å·ä»¥åŠå†…å­˜åŒæ­¥ç­‰ï¼‰ï¼Œå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œçº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯ã€ä»¥åŠçº¿ç¨‹çš„è°ƒåº¦ç­‰ã€‚ ä¸ºäº†é€šè¿‡å¹¶å‘è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œéœ€è¦ï¼š æ›´æœ‰æ•ˆåœ°åˆ©ç”¨ç°æœ‰å¤„ç†èµ„æº åœ¨å‡ºç°æ–°çš„å¤„ç†èµ„æºæ—¶ä½¿ç¨‹åºå°½å¯èƒ½åœ°åˆ©ç”¨è¿™äº›æ–°èµ„æº ä»æ€§èƒ½ç›‘è§†è§’åº¦æ¥çœ‹ï¼ŒCPUéœ€è¦å°½å¯èƒ½ä¿æŒå¿™ç»¿çŠ¶æ€ åº”ç”¨ç¨‹åºæ€§èƒ½çš„è¡¡é‡æŒ‡æ ‡ æœåŠ¡æ—¶é—´ã€ç­‰å¾…æ—¶é—´ç”¨äºè¡¡é‡ç¨‹åºçš„â€œè¿è¡Œé€Ÿåº¦â€ï¼Œå³æŸä¸ªæŒ‡å®šçš„ä»»åŠ¡å•å…ƒéœ€è¦â€œå¤šå¿«â€æ‰èƒ½å¤„ç†å®Œæˆã€‚ ç”Ÿäº§é‡ã€ååé‡ç”¨äºè¡¡é‡ç¨‹åºçš„â€œå¤„ç†èƒ½åŠ›â€ï¼Œå³åœ¨ç»™å®šè®¡ç®—æœºèµ„æºçš„æƒ…å†µä¸‹ï¼Œèƒ½å®Œæˆâ€œå¤šå°‘â€å·¥ä½œã€‚ æ€§èƒ½çš„æé«˜å°±æ˜¯ä½¿åº”ç”¨ç¨‹åºï¼Œ1ï¼‰å¯¹ä»»åŠ¡å•å…ƒçš„å¤„ç†é€Ÿåº¦æ›´å¿«ï¼Œ2ï¼‰èµ„æºä¸€å®šçš„æƒ…å†µä¸‹ï¼Œå®Œæˆæ›´å¤šçš„å·¥ä½œ å¯ä¼¸ç¼©æ€§å®šä¹‰å½“å¢åŠ è®¡ç®—èµ„æºæ—¶ï¼ˆä¾‹å¦‚CPUã€å†…å­˜ã€å­˜å‚¨å®¹é‡æˆ–I/Oå¸¦å®½ï¼‰ï¼Œç¨‹åºçš„ååé‡æˆ–è€…å¤„ç†èƒ½åŠ›èƒ½ç›¸åº”åœ°å¢åŠ ã€‚ è¯„ä¼°å„ç§æ€§èƒ½æƒè¡¡å› ç´ æœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„æŒ‡æ ‡æ˜¯å¯ä¼¸ç¼©æ€§ã€ååé‡å’Œç”Ÿæˆé‡ï¼›äº¤äº’å¼åº”ç”¨ç¨‹åºæŒ‡æ ‡æ˜¯å¤šå¿«ã€‚ é¿å…ä¸æˆç†Ÿçš„ä¼˜åŒ–ï¼ˆç”±äºéœ€æ±‚ä¸æ˜ç¡®ï¼‰ï¼Œé¦–å…ˆä½¿ç¨‹åºæ­£ç¡®ï¼Œç„¶åå†æé«˜è¿è¡Œé€Ÿåº¦â€”â€”å¦‚æœå®ƒè¿˜è¿è¡Œå¾—ä¸å¤Ÿå¿«ã€‚ Amdahlå®šå¾‹Amdahlå®šå¾‹ï¼š åœ¨å¢åŠ è®¡ç®—èµ„æºçš„æƒ…å†µä¸‹ï¼Œç¨‹åºåœ¨ç†è®ºä¸Šèƒ½å¤Ÿå®ç°æœ€é«˜åŠ é€Ÿæ¯”ï¼Œè¿™ä¸ªå€¼å–å†³äºå¯å¹¶è¡Œç»„ä»¶ä¸ä¸²è¡Œç»„ä»¶æ‰€å çš„æ¯”é‡ã€‚å‡å®šFæ˜¯å¿…é¡»è¢«ä¸²è¡Œæ‰§è¡Œçš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆæ ¹æ®Amdahlå®šå¾‹ï¼Œåœ¨åŒ…å«Nä¸ªå¤„ç†å™¨çš„æœºå™¨ä¸­ï¼Œæœ€é«˜çš„åŠ é€Ÿæ¯”ä¸ºï¼š1Speedup &lt;= 1 / ( F + (1-F) / N ) å½“Nè¶‹è¿‘äºæ— ç©·å¤§æ—¶ï¼Œæœ€å¤§çš„åŠ é€Ÿæ¯”è¶‹è¿‘äº1/Fã€‚å› æ­¤ï¼Œå¦‚æœç¨‹åºæœ‰50%çš„è®¡ç®—éœ€è¦ä¸²è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆæœ€é«˜çš„åŠ é€Ÿæ¯”åªèƒ½æ˜¯2ï¼ˆè€Œä¸ç®¡æœ‰å¤šå°‘ä¸ªçº¿ç¨‹å¯ç”¨ï¼‰ æ³¨æ„ï¼šåœ¨æ‰€æœ‰å¹¶å‘ç¨‹åºä¸­éƒ½åŒ…å«ä¸€äº›ä¸²è¡Œéƒ¨åˆ†ã€‚ æˆ‘ä»¬è¯„ä¼°ä¸€ä¸ªç®—æ³•æ—¶ï¼Œè¦è€ƒè™‘ç®—æ³•åœ¨æ•°ç™¾ä¸ªæˆ–æ•°åƒä¸ªå¤„ç†å™¨çš„æƒ…å†µä¸‹çš„æ€§èƒ½è¡¨ç°ï¼Œä»è€Œå¯¹å¯èƒ½å‡ºç°çš„å¯ä¼¸ç¼©æ€§å±€é™æœ‰ä¸€å®šç¨‹åº¦çš„è®¤è¯†ã€‚ çº¿ç¨‹å¼•å…¥çš„å¼€é”€åœ¨å¤šä¸ªçº¿ç¨‹çš„è°ƒåº¦å’Œåè°ƒè¿‡ç¨‹ä¸­éƒ½éœ€è¦ä¸€å®šçš„æ€§èƒ½å¼€é”€ï¼šå¯¹äºä¸ºäº†æå‡æ€§èƒ½è€Œå¼•å…¥çš„çº¿ç¨‹æ¥è¯´ï¼Œå¹¶è¡Œå¸¦æ¥çš„æ€§èƒ½æå‡å¿…é¡»è¶…è¿‡å¹¶å‘å¯¼è‡´çš„å¼€é”€ã€‚ ä¸Šä¸‹æ–‡åˆ‡æ¢å¦‚æœå¯è¿è¡Œçš„çº¿ç¨‹æ•°å¤§äºCPUæ•°é‡ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿæœ€ç»ˆä¼šå°†æŸä¸ªè¿è¡Œçš„çº¿ç¨‹è°ƒåº¦å‡ºæ¥ï¼Œä»è€Œä½¿å…¶ä»–çº¿ç¨‹èƒ½å¤Ÿä½¿ç”¨CPUï¼Œè¿™å°†å¯¼è‡´ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å°†ä¿å­˜å½“å‰è¿è¡Œçº¿ç¨‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶å°†æ–°è°ƒåº¦è¿›æ¥çš„çº¿ç¨‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡è®¾ç½®ä¸ºå½“å‰ä¸Šä¸‹æ–‡ã€‚ å½“çº¿ç¨‹ç”±äºç­‰å¾…æŸä¸ªå‘ç”Ÿç«äº‰çš„é”è€Œè¢«é˜»å¡æ—¶ï¼ŒJVMé€šå¸¸ä¼šå°†è¿™ä¸ªçº¿ç¨‹æŒ‚èµ·ï¼Œå¹¶å…è®¸å®ƒè¢«äº¤æ¢å‡ºå»ã€‚å¦‚æœçº¿ç¨‹é¢‘ç¹åœ°å‘ç”Ÿé˜»å¡ï¼Œé‚£ä¹ˆä»–ä»¬å°†æ— æ³•ä½¿ç”¨å®Œæ•´çš„è°ƒåº¦æ—¶é—´ç‰‡ã€‚åœ¨ç¨‹åºä¸­å‘ç”Ÿè¶Šå¤šçš„é˜»å¡ï¼ŒCPUå¯†é›†å‹çš„ç¨‹åºå°±ä¼šå‘ç”Ÿè¶Šå¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»è€Œå¢åŠ è°ƒåº¦å¼€é”€ï¼Œå¹¶å› æ­¤è€Œé™ä½ååé‡ã€‚ å†…å­˜åŒæ­¥åŒæ­¥æ“ä½œçš„æ€§èƒ½å¼€é”€åŒ…æ‹¬å¤šä¸ªæ–¹é¢ã€‚åœ¨synchronizedå’Œvolatileæä¾›çš„å¯è§æ€§ä¿è¯ä¸­å¯èƒ½ä¼šä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„æŒ‡ä»¤ï¼Œå³å†…å­˜æ …æ ã€‚å†…å­˜æ …æ å¯ä»¥åˆ·æ–°ç¼“å­˜ï¼Œä½¿ç¼“å­˜æ— æ•ˆï¼Œåˆ·æ–°ç¡¬ä»¶çš„å†™ç¼“å†²ï¼Œä»¥åŠåœæ­¢æ‰§è¡Œç®¡é“ã€‚å†…å­˜æ …æ å¯èƒ½åŒæ ·ä¼šå¯¹æ€§èƒ½å¸¦æ¥é—´æ¥åœ°å½±å“ï¼Œåº”ä¸ºå®ƒä¼šæŠ‘åˆ¶ä¸€äº›ç¼–è¯‘å™¨çš„ä¼˜åŒ–ã€‚åœ¨å†…å­˜æ …æ ä¸­ï¼Œå¤§å¤šæ•°æ“ä½œæ˜¯ä¸èƒ½è¢«é‡æ’åºçš„ã€‚ ä¸è¦è¿‡åº¦æ‹…å¿ƒéç«äº‰åŒæ­¥å¸¦æ¥çš„å¼€é”€ã€‚è¿™ä¸ªåŸºæœ¬çš„æœºåˆ¶å·²ç»éå¸¸å¿«äº†ï¼Œå¹¶ä¸”JVMè¿˜èƒ½è¿›è¡Œé¢å¤–çš„ä¼˜åŒ–ä»¥è¿›ä¸€æ­¥é™ä½æˆ–å¼€é”€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥å°†ä¼˜åŒ–çš„é‡ç‚¹æ”¾åœ¨é‚£äº›å‘ç”Ÿé”ç«äº‰çš„åœ°æ–¹ã€‚ é˜»å¡å½“åœ¨é”ä¸Šå‘ç”Ÿç«äº‰æ—¶ï¼Œç«äº‰å¤±è´¥çš„çº¿ç¨‹è‚¯å®šä¼šé˜»å¡ï¼ŒJVMåœ¨å®ç°é˜»å¡è¡Œä¸ºæ—¶ï¼Œå¯ä»¥é‡‡ç”¨è‡ªæ—‹ç­‰å¾…ï¼ˆæŒ‡é€šè¿‡å¾ªç¯ä¸æ–­å°è¯•è·å–é”ï¼Œç›´åˆ°æˆåŠŸï¼‰æˆ–è€…é€šè¿‡æ“ä½œç³»ç»ŸæŒ‚èµ·è¢«é˜»å¡çš„çº¿ç¨‹ã€‚è¿™ä¸¤ç§æ–¹å¼çš„æ•ˆç‡é«˜ä½ï¼Œè¦å–å†³äºä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ä»¥åŠåœ¨æˆåŠŸè·å–é”ä¹‹å‰éœ€è¦ç­‰å¾…çš„æ—¶é—´ã€‚ ç­‰å¾…æ—¶é—´è¾ƒçŸ­ï¼šé€‚åˆé‡‡ç”¨è‡ªæ—‹ç­‰å¾…æ–¹å¼ ç­‰å¾…æ—¶é—´è¾ƒé•¿ï¼šé€‚åˆé‡‡ç”¨çº¿ç¨‹æŒ‚èµ·æ–¹å¼ å‡å°é”çš„ç«äº‰ä¸²è¡Œæ“ä½œä¼šé™ä½å¯ä¼¸ç¼©æ€§ï¼Œå¹¶ä¸”ä¸Šä¸‹æ–‡åˆ‡æ¢ä¹Ÿä¼šé™ä½æ€§èƒ½ã€‚åœ¨é”ä¸Šå‘ç”Ÿç«äº‰æ—¶å°†åŒæ—¶å¯¼è‡´è¿™ä¸¤ç§é—®é¢˜ï¼Œå› æ­¤å‡å°‘é”ç«äº‰ä¼šæé«˜æ€§èƒ½å’Œå¯ä¼¸ç¼©æ€§ã€‚ åœ¨å¹¶å‘ç¨‹åºä¸­ï¼Œå¯¹å¯ä¼¸ç¼©æ€§çš„æœ€ä¸»è¦å¨èƒå°±æ˜¯ç‹¬å æ–¹å¼çš„èµ„æºé”ã€‚ æœ‰ä¸¤ä¸ªå› ç´ å°†å½±å“åœ¨é”ä¸Šå‘ç”Ÿç«äº‰çš„å¯èƒ½æ€§ï¼š é”çš„è¯·æ±‚é¢‘ç‡ æ¯æ¬¡æŒæœ‰é”çš„æ—¶é—´ å¦‚æœä¸¤è€…çš„ä¹˜ç§¯å¾ˆå°ï¼Œé‚£ä¹ˆå¤§å¤šæ•°è·å–é”çš„æ“ä½œéƒ½ä¸ä¼šå‘ç”Ÿç«äº‰ã€‚ æœ‰ä¸‰ç§æ–¹å¼å¯ä»¥é™ä½é”çš„ç«äº‰ç¨‹åº¦ï¼š å‡å°‘é”çš„æŒæœ‰æ—¶é—´ é™ä½é”çš„è¯·æ±‚é¢‘ç‡ ä½¿ç”¨å¸¦æœ‰åè°ƒæœºåˆ¶çš„ç‹¬å é”ï¼Œè¿™äº›æœºåˆ¶å…è®¸æ›´é«˜çš„å¹¶å‘æ€§ ç¼©å°é”çš„èŒƒå›´ï¼ˆâ€œå¿«è¿›å¿«å‡ºâ€ï¼‰å…¶å®è´¨æ˜¯å‡å°‘é”çš„æŒæœ‰æ—¶é—´ã€‚ï¼ŒåŒæ—¶æ ¹æ®Amdahlå®šå¾‹ï¼Œè¿™æ ·æ¶ˆé™¤äº†é™åˆ¶å¯ä¼¸ç¼©æ€§çš„ä¸€ä¸ªå› ç´ ï¼Œå› ä¸ºä¸²è¡Œä»£ç çš„æ€»é‡å‡å°‘äº†ã€‚ æ³¨æ„ï¼š åœ¨å®é™…æƒ…å†µä¸­ï¼Œä»…å½“å¯ä»¥å°†ä¸€äº›â€œå¤§é‡â€çš„è®¡ç®—æˆ–é˜»å¡æ“ä½œä»åŒæ­¥ä»£ç å—ç§»å‡ºæ—¶ï¼Œæ‰åº”è¯¥è€ƒè™‘åŒæ­¥ä»£ç å—çš„å¤§å°ã€‚ å‡å°é”çš„ç²’åº¦å¦ä¸€ç§å‡å°é”çš„æŒæœ‰æ—¶é—´çš„æ–¹å¼æ˜¯é™ä½çº¿ç¨‹è¯·æ±‚çš„é¢‘ç‡ï¼ˆä»è€Œå‡å°å‘ç”Ÿç«äº‰çš„å¯èƒ½æ€§ï¼‰ã€‚è¿™å¯ä»¥é€šè¿‡é”åˆ†è§£å’Œé”åˆ†æ®µç­‰æŠ€æœ¯æ¥å®ç°ã€‚ é”åˆ†è§£å¦‚æœä¸€ä¸ªéœ€è¦ä¿æŠ¤å¤šä¸ªç›¸äº’ç‹¬ç«‹çš„çŠ¶æ€å˜é‡ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™ä¸ªé”åˆ†è§£ä¸ºå¤šä¸ªé”ï¼Œå¹¶ä¸”æ¯ä¸ªé”åªä¿æŠ¤ä¸€ä¸ªå˜é‡ï¼Œä»è€Œæé«˜å¯ä¼¸ç¼©æ€§ï¼Œå¹¶æœ€ç»ˆé™ä½æ¯ä¸ªé”çš„è¯·æ±‚é¢‘ç‡ã€‚çœ‹åˆ°ä¸‹é¢çš„ä»£ç å˜åŒ–ï¼š123456789// åŸä»£ç ï¼šé€šè¿‡å†…ç½®é”ä¿æŠ¤äº†userså’Œqueriesä¸¤ä¸ªçŠ¶æ€å˜é‡public class ServerStatus &#123; public final Set&lt;String&gt; users; public final Set&lt;String&gt; queries; public synchronized void addUser(String u) &#123; users.add(u); &#125; public synchronized void addQuery(String q) &#123; queries.add(q); &#125;&#125; 123456789101112131415161718// ä¿®æ”¹ä»£ç ï¼šé€šè¿‡é”åˆ†è§£åˆ†å¼€ä¿æŠ¤äº†userså’Œqueriesä¸¤ä¸ªçŠ¶æ€å˜é‡public class ServerStatus &#123; public final Set&lt;String&gt; users; public final Set&lt;String&gt; queries; public void addUser(String u) &#123; synchronized (users) &#123; users.add(u); &#125; &#125; public void addQuery(String q) &#123; synchronized (queries) &#123; queries.add(q); &#125; &#125;&#125; å¯¹ç«äº‰é€‚ä¸­çš„é”è¿›è¡Œåˆ†è§£æ—¶ï¼Œå®é™…ä¸Šæ˜¯æŠŠè¿™äº›è½¬å˜ä¸ºéç«äº‰çš„é”ï¼Œä»è€Œæœ‰æ•ˆåœ°æé«˜æ€§èƒ½å’Œå¯ä¼¸ç¼©æ€§ã€‚ é”åˆ†æ®µç”±äºåœ¨ä¸€ä¸ªæ‹¥æœ‰å¤šä¸ªå¤„ç†å™¨çš„ç³»ç»Ÿä¸­ï¼Œé”åˆ†è§£ä»ç„¶æ— æ³•ç»™å¯ä¼¸ç¼©æ€§å¸¦æ¥æå¤§çš„æé«˜ï¼Œè¿™ä¸ªæ—¶å€™å°±å‡ºæ¥é”åˆ†æ®µæŠ€æœ¯ã€‚ é”åˆ†æ®µï¼š å°†é”åˆ†è§£æŠ€æœ¯è¿›ä¸€æ­¥æ‰©å±•ä¸ºå¯¹ä¸€ç»„å¯¹è±¡ä¸Šçš„é”è¿›è¡Œåˆ†è§£ã€‚ ä¾‹å­ï¼šåœ¨ConcurentHashMapçš„å®ç°ä¸­ä½¿ç”¨äº†ä¸€ä¸ªåŒ…å«16ä¸ªé”çš„æ•°ç»„ï¼Œæ¯ä¸ªé”ä¿æŠ¤æ‰€æœ‰æ•£åˆ—æ¡¶çš„1/16ï¼Œå…¶ä¸­ç¬¬Nä¸ªæ•£åˆ—æ¡¶æœ‰ç¬¬ï¼ˆN mod 16ï¼‰ä¸ªé”æ¥ä¿æŠ¤ã€‚æ­£æ˜¯è¿™é¡¹æŠ€æœ¯ä½¿å¾—CouncurentHashMapèƒ½å¤Ÿæ”¯æŒå¤šè¾¾16ä¸ªå¹¶å‘çš„å†™å…¥å™¨ã€‚ é”åˆ†æ®µçš„åŠ£åŠ¿ï¼šä¸é‡‡ç”¨å•ä¸ªé”æ¥å®ç°ç‹¬å è®¿é—®ç›¸æ¯”ï¼Œè¦è·å¾—å¤šä¸ªé”æ¥å®ç°ç‹¬å è®¿é—®å°†æ›´å›°éš¾æ•´ä¸ªå®¹å™¨ï¼Œä¾‹å¦‚å½“ConcurrentHashMapéœ€è¦æ‰©å±•æ˜ å°„èŒƒå›´ç­‰ã€‚ é¿å…çƒ­ç‚¹åŸŸå¦‚æœå°†ä¸€äº›åå¤è®¡ç®—çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œé‚£ä¹ˆå°†ä¼šå¼•å…¥ä¸€äº›â€œçƒ­ç‚¹åŸŸâ€ã€‚è€Œè¿™äº›çƒ­ç‚¹åŸŸå¾€å¾€ä¼šé™åˆ¶å¯ä¼¸ç¼©æ€§ã€‚ ä¾‹å­ï¼šå‚è€ƒConcurrentHashMapé‡Œè¾¹å°†çƒ­ç‚¹åŸŸsizeåˆ†æˆå¤šä¸ªå€¼ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å–å…¨å±€sizeçš„æ—¶å€™ï¼Œå°±ä¸´æ—¶æŠŠè¿™äº›å€¼åŠ èµ·æ¥å°±æ˜¯ï¼Œè™½ç„¶å¯èƒ½å¾—ä¸åˆ°ä¸€ä¸ªå‡†ç¡®çš„å€¼ï¼Œä½†å¤§å¤§æé«˜äº†å¹¶å‘æ€§ï¼Œæ˜¯åˆ’ç®—çš„ã€‚ ä¸€äº›ä»£æ›¿ç‹¬å é”çš„æ–¹æ³•æ”¾å¼ƒä½¿ç”¨ç‹¬å é”ï¼Œä»è€Œæœ‰åŠ©äºä½¿ç”¨ä¸€ç§å‹å¥½å¹¶å‘çš„æ–¹å¼æ¥ç®¡ç†å…±äº«çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å¹¶å‘å®¹å™¨ã€è¯»-å†™é”ã€ä¸å¯å˜å¯¹è±¡ä»¥åŠåŸå­å˜é‡ã€‚ ç›‘æµ‹CPUçš„åˆ©ç”¨ç‡å½“æµ‹è¯•å¯ä¼¸ç¼©æ€§æ—¶ï¼Œé€šå¸¸è¦ç¡®ä¿å¤„ç†å™¨å¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚ å¦‚æœCPUæ²¡æœ‰å¾—åˆ°å……åˆ†åˆ©ç”¨ï¼Œé‚£ä¹ˆéœ€è¦æ‰¾å‡ºå…¶ä¸­çš„åŸå› ï¼ˆvmstat,mpstatæŸ¥è¯¢CPUä½¿ç”¨æƒ…å†µï¼‰ã€‚å¯èƒ½çš„åŸå› å¦‚ä¸‹ï¼š è´Ÿè½½ä¸å……è¶³ã€‚å¯ä»¥åœ¨æµ‹è¯•æ—¶å¢åŠ è´Ÿè½½ï¼Œå¹¶æ£€æŸ¥åˆ©ç”¨ç‡ï¼Œå“åº”æ—¶é—´å’ŒæœåŠ¡æ—¶é—´ç­‰æŒ‡æ ‡çš„å˜åŒ–ã€‚å¦‚æœäº§ç”Ÿè¶³å¤Ÿå¤šçš„è´Ÿè½½ä½¿åº”ç”¨ç¨‹åºè¾¾åˆ°é¥±å’Œï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦å¤§é‡çš„è®¡ç®—æœºèƒ½è€—ï¼Œå¹¶ä¸”é—®é¢˜å¯èƒ½åœ¨äºå®¢æˆ·ç«¯ç³»ç»Ÿæ˜¯å¦å…·æœ‰è¶³å¤Ÿçš„èƒ½åŠ›ï¼Œè€Œä¸æ˜¯è¢«æµ‹è¯•ç³»ç»Ÿã€‚ IOå¯†é›†ã€‚å¯ä»¥é€šè¿‡iostatæˆ–è€…perfmonæ¥åˆ¤æ–­æŸä¸ªåº”ç”¨ç¨‹åºæ˜¯å¦æ˜¯ç£ç›˜I/Oå¯†é›†å‹çš„ï¼Œæˆ–è€…é€šè¿‡ç›‘æµ‹åº”ç”¨çš„é€šä¿¡æµé‡æ¥åˆ¤æ–­å®ƒæ˜¯å¦éœ€è¦é«˜å¸¦å®½ã€‚ å¤–éƒ¨é™åˆ¶ã€‚å¦‚æœåº”ç”¨ç¨‹åºä¾èµ–äºå¤–éƒ¨æœåŠ¡ï¼Œæ¯”å¦‚æ•°æ®åº“æˆ–webæœåŠ¡ï¼Œé‚£ä¹ˆæ€§èƒ½ç“¶é¢ˆå¯èƒ½å¹¶ä¸åœ¨ä½ è‡ªå·±çš„ä»£ç ä¸­ã€‚ é”ç«äº‰ã€‚ä½¿ç”¨åˆ†æå·¥å…·å¯ä»¥çŸ¥é“åœ¨ç¨‹åºä¸­å­˜åœ¨ä½•ç§ç¨‹åº¦çš„é”ç«äº‰ã€‚æ¯”å¦‚è¿›è¡Œçº¿ç¨‹æ ˆå¸§è½¬å‚¨ï¼Œæ¥è§‚å¯Ÿæ˜¯ä¸æ˜¯æœ‰â€œwaiting to lock monitorâ€ä¹‹ç±»çš„å…³é”®å­—ã€‚ åœ¨CPUä¿æŒå¿™ç¢ŒçŠ¶æ€ä¹‹åï¼Œæˆ‘ä»¬è¯•è¯•å¢åŠ CPUçš„æ•°é‡ï¼Œæ¯”å¦‚ä»4æ ¸æ¢åˆ°8æ ¸ï¼Œçœ‹æ˜¯å¦èƒ½å¢åŠ å¤„ç†èƒ½åŠ›ï¼Œå¦‚æ­¤å°±å¯ä»¥å¾—å‡ºç»“è®ºï¼šå¢åŠ CPUå¯ä»¥æé«˜ç¨‹åºçš„å¤„ç†èƒ½åŠ›ï¼Œç±»ä¼¼çš„å…¶å®ƒèµ„æºéªŒè¯è¿‡ç¨‹ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚ å‘å¯¹è±¡æ± è¯´â€œä¸â€æ—©æœŸåƒåœ¾å›æ”¶æœºåˆ¶å¾ˆæ…¢ï¼Œæ•ˆç‡å¾ˆä½ï¼Œå¾ˆå¤šç¨‹åºé€šè¿‡å¯¹è±¡æ± æ¥é™ä½åƒåœ¾å›æ”¶çš„å‹åŠ›ã€‚ä½†ç°åœ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶å·²ç»å¾ˆå¿«äº†ã€‚åœ¨å¹¶å‘ç¨‹åºä¸­ï¼Œå¯¹è±¡æ± çš„è¡¨ç°æ›´åŠ ç³Ÿç³•ã€‚ å‡å°ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ä¼ ç»Ÿç½‘ç»œæ¨¡å¼ä¸‹ï¼ŒåŒæ­¥é˜»å¡IOå°†å¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒåŒæ—¶ï¼Œä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹å°†å¯¼è‡´æ›´å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ”¹è¿›æ–¹æ³•å¦‚ä¸‹ï¼š å°†é˜»å¡IOæ“ä½œä»å¤„ç†è¯·æ±‚çš„çº¿ç¨‹åˆ†ç¦»å‡ºæ¥ï¼Œæ”¾åˆ°ä¸“é—¨çš„çº¿ç¨‹ä¸­å»å¤„ç†ã€‚ ä½¿ç”¨nioï¼Œå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œå®ç°å¯ä»¥ç”±æœ‰é™çº¿ç¨‹æ± æ¥å¤„ç†æ‰€æœ‰çš„è¿æ¥è¯·æ±‚ã€‚ æ€»ç»“ç”±äºä½¿ç”¨çº¿ç¨‹é€šå¸¸æ˜¯ä¸ºäº†å……åˆ†åˆ©ç”¨å¤šä¸ªå¤„ç†å™¨çš„è®¡ç®—èƒ½åŠ›ï¼Œå› æ­¤åœ¨å¹¶å‘ç¨‹åºæ€§èƒ½çš„å¥—è·¯é‚£ç§ï¼Œé€šå¸¸æ›´å¤šåœ°å°†é‡ç‚¹æ”¾åœ¨ååé‡å’Œå¯ä¼¸ç¼©æ€§ä¸Šï¼Œè€Œä¸æ˜¯æœåŠ¡æ—¶é—´ã€‚Amdahlå®šå¾‹å‘Šè¯‰æˆ‘ä»¬ï¼Œç¨‹åºçš„å¯ä¼¸ç¼©æ€§å–å†³äºåœ¨æ‰€æœ‰ä»£ç ä¸­å¿…é¡»è¢«ä¸²è¡ŒåŒ–æ‰§è¡Œçš„ä»£ç æ¯”ä¾‹ã€‚å› ä¸ºJavaç¨‹åºä¸­ä¸²è¡Œæ“ä½œçš„ä¸»è¦æ¥æºæ˜¯ç‹¬å æ–¹å¼çš„èµ„æºé”ï¼Œå› æ­¤é€šå¸¸å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥æé«˜å¯ä¼¸ç¼©æ€§ï¼šå‡å°‘é”çš„æŒæœ‰æ—¶é—´ï¼Œé™ä½é”çš„ç²’åº¦ï¼Œä»¥åŠé‡‡ç”¨éç‹¬å çš„é”æˆ–éé˜»å¡é”æ¥ä»£æ›¿ç‹¬å é”ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ å¹¶å‘ç¼–ç¨‹å®æˆ˜å­¦ä¹ ç¬”è®°ï¼ˆå…«ï¼‰â€”â€”æ€§èƒ½ä¸å¯ä¼¸ç¼©æ€§]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_8_é¿å…æ´»è·ƒæ€§å±é™©]]></title>
    <url>%2F2018%2F01%2F22%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-8-%E9%81%BF%E5%85%8D%E6%B4%BB%E8%B7%83%E6%80%A7%E5%8D%B1%E9%99%A9%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨å®‰å…¨æ€§å’Œæ´»è·ƒæ€§ä¹‹é—´é€šå¸¸å­˜åœ¨ç€æŸäº›åˆ¶è¡¡ã€‚æˆ‘ä»¬ä½¿ç”¨åŠ é”æœºåˆ¶æ¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä½†å¦‚æœè¿‡åº¦åœ°ä½¿ç”¨åŠ é”ï¼Œåˆ™å¯èƒ½å¯¼è‡´é¡ºåºæ­»é”ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨çº¿ç¨‹æ± å’Œä¿¡å·é‡æ¥é™åˆ¶å¯¹èµ„æºçš„ä½¿ç”¨ï¼Œä½†è¿™äº›è¢«é™åˆ¶çš„è¡Œä¸ºå¯èƒ½ä¼šå¯¼è‡´èµ„æºæ­»é”ã€‚Javaåº”ç”¨ç¨‹åºæ— æ³•ä»æ­»é”ä¸­æ¢å¤è¿‡æ¥ï¼Œå› æ­¤åœ¨è®¾è®¡æ—¶ä¸€å®šè¦æ’é™¤é‚£äº›å¯èƒ½å¯¼è‡´æ­»é”å‡ºç°çš„æ¡ä»¶ã€‚ æ­»é”æœ€ç®€å•çš„æ­»é”ï¼šå½“çº¿ç¨‹AæŒæœ‰é”Lå¹¶æƒ³è·å¾—é”Mçš„åŒæ—¶ï¼Œçº¿ç¨‹BæŒæœ‰é”Må¹¶å°è¯•è·å¾—é”Lï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªçº¿ç¨‹å°†æ°¸è¿œç­‰å¾…ä¸‹å»ã€‚ æ•°æ®åº“è§£å†³æ­»é”é—®é¢˜ï¼š å½“å®ƒæ£€æµ‹åˆ°ä¸€ç»„äº‹åŠ¡å‘ç”Ÿäº†æ­»é”æ—¶ï¼ˆé€šè¿‡åœ¨è¡¨ç¤ºç­‰å¾…å…³ç³»çš„æœ‰å‘å›¾ä¸­æœç´¢å¾ªç¯ï¼‰ï¼Œå°†é€‰æ‹©ä¸€ä¸ªç‰ºç‰²è€…å¹¶æ”¾å¼ƒè¿™ä¸ªäº‹åŠ¡ã€‚ä½œä¸ºç‰ºç‰²è€…çš„äº‹åŠ¡ä¼šé‡Šæ”¾å®ƒæ‰€æŒæœ‰çš„èµ„æºï¼Œä»è€Œä½¿å…¶ä»–äº‹åŠ¡ç»§ç»­è¿›è¡Œã€‚åº”ç”¨ç¨‹åºå¯ä»¥é‡æ–°æ‰§è¡Œè¢«å¼ºåˆ¶ç»ˆæ­¢çš„äº‹åŠ¡ï¼Œè€Œè¿™ä¸ªäº‹åŠ¡ç°åœ¨å¯ä»¥æˆåŠŸå®Œæˆï¼Œå› ä¸ºæ‰€æœ‰è·Ÿå®ƒç«äº‰èµ„æºçš„äº‹åŠ¡éƒ½å·²ç»å®Œæˆäº†ã€‚ JVMè§£å†³æ­»é”é—®é¢˜ï¼šå½“ä¸€ç»„Javaçº¿ç¨‹å‘ç”Ÿæ­»é”æ—¶ï¼Œâ€œæ¸¸æˆâ€å°†åˆ°æ­¤ç»“æŸâ€”â€”è¿™äº›çº¿ç¨‹æ°¸è¿œä¸èƒ½ä½¿ç”¨äº†ã€‚ é”é¡ºåºæ­»é”ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122// æ³¨æ„ï¼šå®¹æ˜“å‘ç”Ÿæ­»é”ï¼public class LeftRightDeadLock &#123; private final Object left = new Object(); private final Object right = new Object(); public void leftRight() &#123; synchronized (left) &#123; synchronized (right) &#123; doSomething(); &#125; &#125; &#125; public void rightLeft() &#123; synchronized (right) &#123; synchronized (left) &#123; doSomething(); &#125; &#125; &#125;&#125; è§£å†³æ–¹æ³•ï¼š å¦‚æœæ‰€æœ‰çº¿ç¨‹ä»¥å›ºå®šçš„é¡ºåºæ¥è·å¾—é”ï¼Œé‚£ä¹ˆåœ¨ç¨‹åºä¸­å°±ä¸ä¼šå‡ºç°é”é¡ºåºæ­»é”é—®é¢˜ã€‚ åŠ¨æ€æ­»é”é—®é¢˜ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š123456789101112131415// æ³¨æ„ï¼šå®¹æ˜“å‘ç”Ÿæ­»é”ï¼public void transferMoney(Account fromAccount, Account toAccount, DollarAmount amount) throws InsufficientFundsException&#123; synchronized (fromAccount) &#123; synchronized (fromAccount) &#123; if (fromAccount.getBalance().compareTo(amount)) &#123; throw new InsufficientFundsException(); &#125; else &#123; fromAccount.debit(amount); toAccount.credit(amount); &#125; &#125; &#125;&#125; è§£å†³æ–¹æ³•ï¼š é€šè¿‡ä¸€è‡´å“ˆå¸Œç®—æ³•æˆ–è€…å…¶å®ƒæ–¹å¼æ¥ç»Ÿä¸€é”é¡ºåºï¼Œä½¿æœªçŸ¥é¡ºåºå˜ä¸ºå·²çŸ¥é¡ºåºã€‚å¯¹äºæå°‘æ•°çš„å“ˆå¸Œå†²çªï¼Œå¯ä»¥ä½¿ç”¨â€œåŠ æ—¶èµ›â€é”æ¥è§£å†³ã€‚è§£å†³ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142private static final Object tieLock = new Object();public void transferMoney(final Account fromAcct, final Account toAcct, final DollarAmount amount) throws InsufficientFundsException&#123; class Helper&#123; public void transfer throws InsufficientFundsException&#123; if(fromAcct.getBalance().compareTo(amount) &lt; 0)&#123; throw new InsufficientFundsException(); &#125;else&#123; fromAcct.debit(amount); toAcct.credit(amount); &#125; &#125; &#125; int fromHash = System.identifyHashCode(fromAcct); int toHash = System.identityHashCode(toAcct); if(fromHash &lt; toHash)&#123; synchronized(fromAcct)&#123; synchronized(toAcct)&#123; new Helper.transfer(); &#125; &#125; &#125;else if (fromHash &gt; toHash) &#123; synchronized(toAcct)&#123; synchronized(fromAcct)&#123; new Helper().transfer(); &#125; &#125; &#125; else &#123; synchronized(tieLock)&#123;//åŠ æ—¶èµ›é”æ¥è§£å†³é—®é¢˜ synchronized(fromAcct)&#123; synchronized(toAcct)&#123; new Helper().transfer(); &#125; &#125; &#125; &#125;&#125; åœ¨åä½œå¯¹è±¡ä¹‹é—´å‘ç”Ÿçš„æ­»é”ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// æ³¨æ„ï¼šåŒæ­¥æ–¹æ³•è·å¾—çš„æ˜¯å¯¹è±¡é”class Taxi &#123; @GuardedBy("this") private Point location, destination; private final Dispatcher dispatcher; public Taxi(Dispatcher dispatcher) &#123; this.dispatcher = dispatcher; &#125; public synchronized Point getLocation() &#123; return location; &#125; public synchronized void setLocation(Point location) &#123; this.location = location; if (location.equals(destination)) dispatcher.notifyAvailable(this); &#125; public synchronized Point getDestination() &#123; return destination; &#125; public synchronized void setDestination(Point destination) &#123; this.destination = destination; &#125;&#125;class Dispatcher &#123; @GuardedBy("this") private final Set&lt;Taxi&gt; taxis; @GuardedBy("this") private final Set&lt;Taxi&gt; availableTaxis; public Dispatcher() &#123; taxis = new HashSet&lt;Taxi&gt;(); availableTaxis = new HashSet&lt;Taxi&gt;(); &#125; public synchronized void notifyAvailable(Taxi taxi) &#123; availableTaxis.add(taxi); &#125; public synchronized Image getImage() &#123; Image image = new Image(); for (Taxi t : taxis) image.drawMarker(t.getLocation()); return image; &#125;&#125; å°½ç®¡æ²¡æœ‰ä»»ä½•æ–¹æ³•ä¼šæ˜¾å¼åœ°è·å¾—ä¸¤ä¸ªé”ï¼Œä½†æ˜¯setLocationå’ŒgetImageç­‰æ–¹æ³•çš„è°ƒç”¨è€…éƒ½ä¼šè·å¾—ä¸¤ä¸ªé”ï¼Œæ‰€ä»¥æœ‰å¯èƒ½é€ æˆæ­»é”ã€‚ æ³¨æ„ï¼š å¦‚æœåœ¨æŒæœ‰é”çš„æƒ…å†µä¸‹è°ƒç”¨æŸä¸ªå¤–éƒ¨æ–¹æ³•æ—¶ï¼Œé‚£ä¹ˆå°±éœ€è¦è­¦æƒ•æ­»é”ã€‚ å¼€æ”¾è°ƒç”¨å¼€æ”¾è°ƒç”¨ï¼š å¦‚æœåœ¨è°ƒç”¨æŸä¸ªæ–¹æ³•æ—¶ä¸éœ€è¦æŒæœ‰é”ï¼Œé‚£ä¹ˆè¿™ç§è°ƒç”¨è¢«ç§°ä¸ºå¼€æ”¾è°ƒç”¨ã€‚ é€šè¿‡å¼€æ”¾è°ƒç”¨è§£å†³åœ¨åä½œå¯¹è±¡ä¹‹é—´å‘ç”Ÿçš„æ­»é”ï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940class Taxi &#123; @GuardedBy("this") private Point location, destination; private final Dispatcher dispatcher; ... public synchronized Point getLocation() &#123; return location; &#125; public void setLocation(Point location) &#123; boolean reachedDestination; synchronized (this) &#123; this.location = location; reachedDestination = location.equals(destination); &#125; if (reachedDestination) dispatcher.notifyAvailable(this); &#125;&#125;class Dispatcher &#123; @GuardedBy("this") private final Set&lt;Taxi&gt; taxis; @GuardedBy("this") private final Set&lt;Taxi&gt; availableTaxis; ... public synchronized void notifyAvailable(Taxi taxi) &#123; availableTaxis.add(taxi); &#125; public synchronized Image getImage() &#123; Set&lt;Taxi&gt; copy; sychronized (this) &#123; copy = new HashSet&lt;Taxi&gt;(taxis); &#125; Image image = new Image(); for (Taxi t : copy) image.drawMarker(t.getLocation()); return image; &#125;&#125; è§£å†³çš„æ–¹æ³•æ€è·¯å°±æ˜¯ï¼šç¼©å°é”çš„ç²’åº¦ã€‚ ç¼ºç‚¹ï¼šå¯èƒ½ä¸¢å¤±æ“ä½œåŸå­æ€§ï¼Œæ­¤æ—¶éœ€è¦é€šè¿‡åè®®æ¥å®ç°åŸå­æ€§ï¼Œè€Œä¸æ˜¯é€šè¿‡åŠ é”ã€‚ èµ„æºæ­»é”ç‹¬å ç±»å‹çš„è®¿é—®éƒ½å¯ä»¥å’ŒåŠ é”æ“ä½œç±»æ¯”ï¼Œçœ‹èµ·æ¥å°±åƒéœ€è¦è·å¾—é”æ‰èƒ½è®¿é—®ã€‚ å¦‚æœä¸€ä¸ªä»»åŠ¡éœ€è¦è¿æ¥ä¸¤ä¸ªæ•°æ®åº“ï¼Œå¹¶ä¸”åœ¨è¯·æ±‚è¿™ä¸¤ä¸ªèµ„æºæ—¶ä¸ä¼šå§‹ç»ˆéµå¾ªç›¸åŒçš„é¡ºåºï¼Œé‚£ä¹ˆçº¿ç¨‹Aå¯èƒ½æŒæœ‰ä¸æ•°æ®åº“D1çš„è¿æ¥ï¼Œå¹¶ç­‰å¾…ä¸æ•°æ®åº“D2çš„è¿æ¥ï¼Œè€Œçº¿ç¨‹BæŒæœ‰D2çš„è¿æ¥å¹¶ç­‰å¾…ä¸D1çš„è¿æ¥ã€‚èµ„æºæ± è¶Šå¤§ï¼Œå°±è¶Šä¸å®¹æ˜“å‡ºç°è¿™ç§ç±»å‹çš„æ­»é”ã€‚ çº¿ç¨‹é¥¥é¥¿æ­»é”ã€‚å¦‚æœæŸäº›ä»»åŠ¡éœ€è¦ç­‰å¾…å…¶å®ƒä»»åŠ¡çš„ç»“æœï¼Œé‚£ä¹ˆè¿™äº›ä»»åŠ¡å¾€å¾€æ˜¯äº§ç”Ÿçº¿ç¨‹é¥¥é¥¿æ­»é”çš„ä¸»è¦æ¥æºï¼Œæœ‰ç•Œçº¿ç¨‹æ± /èµ„æºæ± ä¸ç›¸äº’ä¾èµ–çš„ä»»åŠ¡ä¸èƒ½ä¸€èµ·ä½¿ç”¨ã€‚ æ­»é”çš„é¿å…ä¸è¯Šæ–­å¦‚æœå¿…é¡»è·å–å¤šä¸ªé”ï¼Œé‚£ä¹ˆåœ¨è®¾è®¡æ—¶å¿…é¡»è€ƒè™‘é”çš„é¡ºåºï¼šå°½é‡å‡å°‘æ½œåœ¨çš„åŠ é”äº¤äº’æ•°é‡ï¼Œå°†è·å–é”æ—¶éœ€è¦éµå¾ªçš„åè®®å†™å…¥æ­£å¼æ–‡æ¡£å¹¶å§‹ç»ˆéµå¾ªè¿™äº›åè®®ã€‚ åœ¨ç»†ç²’åº¦é”çš„ç¨‹åºä¸­ï¼Œå¯ä»¥é€šè¿‡ä¸€ç§ä¸¤é˜¶æ®µç­–ç•¥æ¥æ£€æŸ¥ä»£ç ä¸­çš„æ­»é”ï¼šé¦–å…ˆï¼Œæ‰¾å‡ºåœ¨ä»€ä¹ˆåœ°æ–¹å°†è·å–å¤šä¸ªé”ï¼ˆä½¿è¿™ä¸ªé›†åˆå°½é‡å°ï¼‰ï¼Œç„¶åå¯¹æ‰€æœ‰è¿™äº›å®ä¾‹è¿›è¡Œå…¨å±€åˆ†æï¼Œä»è€Œç¡®ä¿ä»–ä»¬åœ¨æ•´ä¸ªç¨‹åºä¸­è·å–é”çš„é¡ºåºä¿æŒä¸€è‡´ã€‚å°½å¯èƒ½ä½¿ç”¨å¼€å‘è°ƒç”¨ã€‚ æ”¯æŒå®šæ—¶çš„é”å½“å®šæ—¶é”å¤±è´¥æ—¶ï¼Œä½ å¹¶ä¸éœ€è¦çŸ¥é“å¤±è´¥çš„åŸå› ã€‚è‡³å°‘ä½ èƒ½è®°å½•æ‰€å‘ç”Ÿçš„å¤±è´¥ï¼Œä»¥åŠå…³äºè¿™æ¬¡æ“ä½œçš„å…¶å®ƒæœ‰ç”¨ä¿¡æ¯ï¼Œå¹¶é€šè¿‡ä¸€ç§æ›´å¹³ç¼“çš„æ–¹å¼æ¥é‡æ–°å¯åŠ¨è®¡ç®—ï¼Œè€Œä¸æ˜¯å…³é—­æ•´ä¸ªè¿›ç¨‹ã€‚ å¦‚æœåœ¨è·å–é”æ—¶è¶…æ—¶ï¼Œé‚£ä¹ˆå¯ä»¥é‡Šæ”¾è¿™ä¸ªé”ï¼Œç„¶ååé€€å¹¶åœ¨ä¸€æ®µæ—¶é—´åå¹¶å†æ¬¡å°è¯•ï¼Œä»è€Œæ¶ˆé™¤äº†æ­»é”å‘ç”Ÿçš„æ¡ä»¶ï¼Œä½¿ç¨‹åºæ¢å¤è¿‡æ¥ã€‚ï¼ˆè¿™é¡¹æŠ€æœ¯åªæœ‰åœ¨åŒæ—¶è·å–ä¸¤ä¸ªé”æ—¶æ‰æœ‰æ•ˆï¼Œå¦‚æœåœ¨åµŒå¥—çš„æ–¹æ³•è°ƒç”¨ä¸­è¯·æ±‚å¤šä¸ªé”ï¼Œé‚£ä¹ˆå³ä½¿ä½ çŸ¥é“å·²ç»æŒæœ‰äº†å¤–å±‚çš„é”ï¼Œä¹Ÿæ— æ³•é‡Šæ”¾å®ƒã€‚ï¼‰ é€šè¿‡çº¿ç¨‹è½¬å‚¨ä¿¡æ¯æ¥åˆ†ææ­»é”JVMä¼šé€šè¿‡çº¿ç¨‹è½¬å‚¨æ¥å¸®åŠ©æ˜¯è¢«æ­»é”çš„å‘ç”Ÿã€‚åœ¨ç”Ÿæˆçº¿ç¨‹è½¬å‚¨ä¿¡æ¯ä¹‹å‰ï¼ŒJVMå°†åœ¨ç­‰å¾…å…³ç³»å›¾ä¸­é€šè¿‡æœç´¢å¾ªç¯æ¥æ‰¾å‡ºæ­»é”ã€‚å¦‚æœå‘ç°äº†ä¸€ä¸ªæ­»é”ï¼Œåˆ™è·å–ç›¸åº”çš„æ­»é”ä¿¡æ¯ï¼Œç†ç”±åœ¨æ­»é”ä¸­æ¶‰åŠå“ªäº›é”å’Œçº¿ç¨‹ï¼Œä»¥åŠè¿™ä¸ªé”çš„è·å–æ“ä½œä½äºç¨‹åºçš„å“ªäº›ä½ç½®ã€‚ å…¶ä»–æ´»è·ƒå±é™©é¥¥é¥¿å½“çº¿ç¨‹ç”±äºæ— æ³•è®¿é—®å®ƒæ‰€éœ€è¦çš„èµ„æºè€Œä¸èƒ½ç»§ç»­æ‰§è¡Œæ—¶ï¼Œå°±å‘ç”Ÿäº†â€œé¥¥é¥¿â€ï¼Œå¼•å‘é¥¥é¥¿çš„æœ€å¸¸è§èµ„æºå°±æ˜¯CPUæ—¶é’Ÿå‘¨æœŸã€‚ è¦é¿å…ä½¿ç”¨çº¿ç¨‹ä¼˜å…ˆçº§ï¼Œå› ä¸ºè¿™ä¼šå¢åŠ å¹³å°ä¾èµ–æ€§ï¼Œå¹¶å¯èƒ½å¯¼è‡´æ´»è·ƒæ€§é—®é¢˜ï¼Œåœ¨å¤§å¤šæ•°å¹¶å‘åº”ç”¨ç¨‹åºä¸­ï¼Œéƒ½å¯ä»¥ä½¿ç”¨é»˜è®¤çš„çº¿ç¨‹ä¼˜å…ˆçº§ã€‚ æ´»é”æ´»é”æ˜¯å¦ä¸€ç§å½¢å¼çš„æ´»è·ƒæ€§é—®é¢˜ï¼Œè¯¥é—®é¢˜å°½ç®¡ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œä½†ä¹Ÿä¸èƒ½ç»§ç»­æ‰§è¡Œï¼Œå› ä¸ºçº¿ç¨‹å°†ä¸æ–­é‡å¤æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œè€Œä¸”æ€»ä¼šå¤±è´¥ã€‚ æ´»é”é€šå¸¸å‘ç”Ÿåœ¨å¤„ç†äº‹åŠ¡æ¶ˆæ¯çš„åº”ç”¨ç¨‹åºä¸­ï¼šå¦‚æœä¸èƒ½æˆåŠŸåœ°å¤„ç†æŸä¸ªæ¶ˆæ¯ï¼Œé‚£ä¹ˆæ¶ˆæ¯å¤„ç†æœºåˆ¶å°†ä¼šå›æ»šæ•´ä¸ªäº‹åŠ¡ï¼Œå¹¶å°†å®ƒé‡æ–°æ”¾åˆ°é˜Ÿåˆ—çš„å¼€å¤´ã€‚å¦‚æœæ¶ˆæ¯å¤„ç†å™¨åœ¨å¤„ç†æŸç§ç‰¹å®šç±»å‹çš„æ¶ˆæ¯æ—¶å­˜åœ¨é”™è¯¯å¹¶å¯¼è‡´å®ƒå¤±è´¥ï¼Œé‚£ä¹ˆä¼šå‡ºä¸€ç›´å­˜åœ¨â€œå¤„ç†-å‡ºé”™-å›æ»š-å¤„ç†â€çš„å¾ªç¯ä¸­ã€‚ è§£å†³æ–¹æ³•ï¼šåœ¨é‡è¯•æœºåˆ¶ä¸­å¼•ç”¨éšæœºæ€§ã€‚ æ€»ç»“æ´»è·ƒæ€§æ•…éšœæ˜¯ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ï¼Œå› ä¸ºå½“å‡ºç°æ´»è·ƒæ€§æ•…éšœæ—¶ï¼Œé™¤äº†ä¸­æ­¢åº”ç”¨ç¨‹åºä¹‹å¤–æ²¡æœ‰å…¶ä»–ä»»ä½•æœºåˆ¶å¯ä»¥å¸®åŠ©ä»è¿™ç§æ•…éšœæ¢å¤è¿‡æ¥ã€‚æœ€å¸¸è§çš„æ´»è·ƒæ€§æ•…éšœæ˜¯é”é¡ºåºæ­»é”ã€‚åœ¨è®¾è®¡æ—¶åº”è¯¥é¿å…é”é¡ºåºæ­»é”ï¼šç¡®ä¿çº¿ç¨‹åœ¨è·å–å¤šä¸ªé”é‡‡ç”¨ä¸€è‡´çš„é¡ºåºã€‚æœ€å¥½çš„è§£å†³æ–¹æ³•æ˜¯åœ¨ç¨‹åºä¸­å§‹ç»ˆä½¿ç”¨å¼€æ”¾è°ƒç”¨ã€‚è¿™å°†å¤§å¤§å‡å°‘éœ€è¦åŒæ—¶æŒæœ‰å¤šä¸ªé”çš„åœ°æ–¹ï¼Œä¹Ÿæ›´å®¹æ˜“å‘ç°è¿™äº›åœ°æ–¹ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_7_çº¿ç¨‹æ± çš„ä½¿ç”¨]]></title>
    <url>%2F2018%2F01%2F22%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-7-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¹‹å‰ä»‹ç»äº†Executorä»»åŠ¡æ‰§è¡Œæ¡†æ¶çš„ä½¿ç”¨ï¼Œå®ƒä¸ä»…ç®€åŒ–äº†ä»»åŠ¡ä¸çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œè€Œä¸”è¿˜æä¾›äº†ä¸€ç§ç®€å•çµæ´»çš„æ–¹å¼å°†ä»»åŠ¡çš„æäº¤å’Œä»»åŠ¡çš„æ‰§è¡Œç­–ç•¥è§£è€¦å¼€æ¥ã€‚ä½†æ˜¯æ·±å…¥ä¸‹å»ï¼Œæˆ‘ä»¬éœ€è¦å¯¹çº¿ç¨‹æ± è¿›è¡Œé…ç½®å’Œè°ƒä¼˜ï¼Œå¹¶ä¸”åˆ†æå†ä½¿ç”¨ä»»åŠ¡æ‰§è¡Œæ¡†æ¶æ—¶éœ€è¦æ³¨æ„çš„å„ç§å±é™©ã€‚ åœ¨ä»»åŠ¡ä¸æ‰§è¡Œç­–ç•¥ä¹‹é—´çš„éšæ€§è€¦åˆä¸æ˜¯æ‰€æœ‰ä»»åŠ¡éƒ½èƒ½é€‚ç”¨æ‰€æœ‰çš„æ‰§è¡Œç­–ç•¥çš„ï¼Œæœ‰äº›ç±»å‹çš„ä»»åŠ¡éœ€è¦æ˜ç¡®åœ°æŒ‡å®šæ‰§è¡Œç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼š ä¾èµ–æ€§ä»»åŠ¡ï¼šæäº¤ç»™çº¿ç¨‹æ± çš„ä»»åŠ¡éœ€è¦ä¾èµ–å…¶ä»–çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦é¿å…çº¿ç¨‹é¥¥é¥¿æ­»é”ã€‚ ä½¿ç”¨çº¿ç¨‹å°é—­æœºåˆ¶çš„ä»»åŠ¡ï¼šä»»åŠ¡è¦æ±‚å…¶æ‰§è¡Œç­–ç•¥æ‰€åœ¨çš„Executoræ˜¯å•çº¿ç¨‹çš„ã€‚ å¯¹å“åº”æ—¶é—´æ•æ„Ÿçš„ä»»åŠ¡ï¼šGUIåº”ç”¨ç¨‹åºå¯¹äºå“åº”æ—¶é—´æ˜¯æ•æ„Ÿçš„ã€‚ ä½¿ç”¨ThreadLocalçš„ä»»åŠ¡ï¼šExecutorä¼šé‡ç”¨çº¿ç¨‹ï¼Œæ‰€å¶ä¸€ä½¿ç”¨ThreadLocalä¼šæ²¡æœ‰æ„ä¹‰ã€‚ åªæœ‰å½“ä»»åŠ¡éƒ½æ˜¯åŒç±»å‹çš„å¹¶ä¸”æ˜¯ç›¸äº’ç‹¬ç«‹æ—¶ï¼Œçº¿ç¨‹æ± çš„æ€§èƒ½æ‰èƒ½è¾¾åˆ°æœ€ä½³ã€‚ åœ¨ä¸€äº›ä»»åŠ¡ä¸­ï¼Œéœ€è¦æ‹¥æœ‰æˆ–æ’é™¤æŸç§ç‰¹å®šçš„æ‰§è¡Œç­–ç•¥ã€‚å¦‚æœæŸäº›ä»»åŠ¡ä¾èµ–äºå…¶ä»–çš„ä»»åŠ¡ï¼Œé‚£ä¹ˆä¼šè¦æ±‚çº¿ç¨‹æ± è¶³å¤Ÿå¤§ï¼Œä»è€Œç¡®ä¿ä»–ä»¬ä¾èµ–ä»»åŠ¡ä¸ä¼šè¢«æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­æˆ–è¢«æ‹’ç»ï¼Œè€Œé‡‡ç”¨çº¿ç¨‹å°é—­æœºåˆ¶çš„ä»»åŠ¡éœ€è¦ä¸²è¡Œæ‰§è¡Œã€‚ çº¿ç¨‹é¥¥é¥¿æ­»é”åœ¨çº¿ç¨‹æ± ä¸­ï¼Œå¦‚æœä»»åŠ¡ä¾èµ–äºå…¶ä»–ä»»åŠ¡ï¼Œé‚£ä¹ˆå¯èƒ½äº§ç”Ÿæ­»é”ã€‚åœ¨å•çº¿ç¨‹çš„Executorä¸­ï¼Œå¦‚æœä¸€ä¸ªä»»åŠ¡å°†å¦ä¸€ä¸ªä»»åŠ¡æäº¤åˆ°åŒä¸€ä¸ªExecutorï¼Œå¹¶ä¸”ç­‰å¾…è¿™ä¸ªè¢«æäº¤ä»»åŠ¡çš„ç»“æœï¼Œé‚£ä¹ˆé€šå¸¸ä¼šå¼•å‘æ­»é”ã€‚ç¬¬äºŒä¸ªä»»åŠ¡åœç•™åœ¨å·¥ä½œé˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ç¬¬ä¸€ä¸ªä»»åŠ¡å®Œæˆï¼Œè€Œç¬¬ä¸€ä¸ªä»»åŠ¡åˆæ— æ³•å®Œæˆï¼Œå› ä¸ºå®ƒåœ¨ç­‰å¾…ç¬¬äºŒä¸ªä»»åŠ¡çš„å®Œæˆã€‚åœ¨æ›´å¤§çš„çº¿ç¨‹æ± ä¸­ï¼Œå¦‚æœæ‰€æœ‰æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹éƒ½ç”±äºç­‰å¾…å…¶ä»–ä»å¤„äºå·¥ä½œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è€Œé˜»å¡ï¼Œä¹Ÿä¼šå‘ç”ŸåŒæ ·çš„é—®é¢˜ã€‚è¿™ç§ç°è±¡å«åšçº¿ç¨‹é¥¥é¥¿æ­»é”ï¼ˆThread Starvation Deadlockï¼‰ï¼Œåªè¦çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡éœ€è¦æ— é™æœŸç­‰å¾…ä¸€äº›å¿…é¡»ç”±æ± ä¸­å…¶ä»–ä»»åŠ¡æ‰èƒ½æä¾›çš„èµ„æºæˆ–æ¡ä»¶ï¼Œä¾‹å¦‚æŸä¸ªä»»åŠ¡ç­‰å¾…å¦ä¸€ä¸ªä»»åŠ¡çš„è¿”å›å€¼æˆ–æ‰§è¡Œç»“æœï¼Œé‚£ä¹ˆé™¤éçº¿ç¨‹æ± è¶³å¤Ÿå¤§ï¼Œå¦åˆ™å°†å‘ç”Ÿçº¿ç¨‹é¥¥é¥¿æ­»é”ã€‚ æ¯å½“æäº¤äº†ä¸€ä¸ªæœ‰ä¾èµ–æ€§çš„Executorä»»åŠ¡æ—¶ï¼Œè¦æ¸…æ¥šåœ°çŸ¥é“å¯èƒ½ä¼šå‡ºç°çº¿ç¨‹é¥¥é¥¿æ­»é”ï¼Œå› æ­¤éœ€è¦åœ¨ä»£ç æˆ–é…ç½®Executorçš„é…ç½®æ–‡ä»¶ä¸­è®°å½•çº¿ç¨‹æ± çš„å¤§å°é™åˆ¶æˆ–é…ç½®é™åˆ¶ã€‚ è¿è¡Œæ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡å¦‚æœä»»åŠ¡é˜»å¡æ—¶é—´è¿‡é•¿ï¼Œé‚£ä¹ˆå³ä½¿ä¸å‡ºç°æ­»é”ï¼Œçº¿ç¨‹æ± çš„å“åº”æ€§ä¹Ÿä¼šå˜å¾—ç³Ÿç³•ã€‚æ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡ä¸ä»…ä¼šé€ æˆçº¿ç¨‹æ± å µå¡ï¼Œç”šè‡³ä¼šå¢åŠ æ‰§è¡Œæ—¶é—´è¾ƒçŸ­ä»»åŠ¡çš„æœåŠ¡æ—¶é—´ã€‚å¦‚æœçº¿ç¨‹æ± ä¸­çš„æ•°é‡è¿œå°äºåœ¨ç¨³å®šçŠ¶æ€ä¸‹æ‰§è¡Œæ—¶é—´è¾ƒé•¿ä»»åŠ¡çš„æ•°é‡ï¼Œé‚£ä¹ˆåˆ°æœ€åå¯èƒ½æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè¿è¡Œè¿™äº›æ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„ä»»åŠ¡ï¼Œä»è€Œå½±å“æ•´ä½“çš„å“åº”æ€§ã€‚ ç¼“è§£è¿™ä¸ªé—®é¢˜çš„æŠ€æœ¯å°±æ˜¯é™å®šç­‰å¾…èµ„æºçš„æ—¶é—´ï¼Œè€Œä¸æ˜¯æ— é™åˆ¶ç­‰å¾…ã€‚ä¾‹å¦‚Thraed.join(),BlockingQueue.put()ã€CountDownLatch.await()ç­‰ï¼Œå¦‚æœç­‰å¾…è¶…æ—¶ï¼Œå¯ä»¥æŠŠä»»åŠ¡æ ‡è¯†ä¸ºå¤±è´¥ï¼Œç„¶åç»ˆæ­¢ä»»åŠ¡æˆ–å°†ä»»åŠ¡é‡æ–°æ”¾å›é˜Ÿåˆ—ä»¥ä¾¿éšåæ‰§è¡Œã€‚ è®¾ç½®çº¿ç¨‹æ± çš„å¤§å°çº¿ç¨‹æ± çš„ç†æƒ³å¤§å°å–å†³äºè¢«æäº¤ä»»åŠ¡çš„ç±»å‹ä»¥åŠæ‰€éƒ¨ç½²ç³»ç»Ÿçš„ç‰¹æ€§ã€‚ åªè¦é¿å…è¿‡å¤§å’Œè¿‡å°ä¸¤ç§æç«¯æƒ…å†µï¼Œå¦‚æœçº¿ç¨‹æ± è¿‡å¤§ï¼Œé‚£ä¹ˆå¤§é‡çš„çº¿ç¨‹å°†åœ¨ç›¸å¯¹å¾ˆå°‘çš„CPUå’Œå†…å­˜èµ„æºä¸Šå‘ç”Ÿç«äº‰ï¼Œè¿™ä¸ä»…ä¼šå¯¼è‡´æ›´é«˜çš„å†…å­˜ä½¿ç”¨é‡ï¼Œè€Œä¸”è¿˜å¯èƒ½è€—å°½èµ„æºã€‚å¦‚æœçº¿ç¨‹æ± è¿‡å°ï¼Œé‚£ä¹ˆå¯¼è‡´è®¸å¤šç©ºé—²çš„å¤„ç†å™¨æ— æ³•æ‰§è¡Œå·¥ä½œï¼Œä»è€Œé™ä½ååç‡ã€‚ è¦æƒ³æ­£ç¡®è®¾ç½®çº¿ç¨‹æ± çš„å¤§å°ï¼Œå¿…é¡»åˆ†æè®¡ç®—ç¯å¢ƒã€èµ„æºé¢„ç®—å’Œä»»åŠ¡çš„ç‰¹æ€§ã€‚ å¯¹äºè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼Œåœ¨æ‹¥æœ‰Nä¸ªå¤„ç†å™¨çš„ç³»ç»Ÿä¸Šï¼Œå½“çº¿ç¨‹æ± çš„å¤§å°ä¸ºN + 1æ—¶ï¼Œé€šå¸¸èƒ½å®ç°æœ€ä¼˜çš„åˆ©ç”¨ç‡ã€‚ å¯¹äºåŒ…å«I/Oæ“ä½œæˆ–è€…å…¶ä»–é˜»å¡æ“ä½œçš„ä»»åŠ¡ï¼Œç”±äºçº¿ç¨‹å¹¶ä¸ä¼šä¸€ç›´æ‰§è¡Œï¼Œå› æ­¤çº¿ç¨‹æ± çš„è§„æ¨¡åº”è¯¥æ›´å¤§ã€‚è¦æ­£ç¡®åœ°è®¾ç½®çº¿ç¨‹æ± çš„å¤§å°ï¼Œå¿…é¡»ä¼°ç®—å‡ºä»»åŠ¡çš„ç­‰å¾…æ—¶é—´ä¸è®¡ç®—æ—¶é—´çš„æ¯”å€¼ã€‚æœ‰ä¸ªå…¬å¼ï¼š1234N = CPUçš„æ•°é‡ = Runtime.getRuntime().availableProcessors();U = é¢„æœŸCPUåˆ©ç”¨ç‡W/C = ç­‰å¾…æ—¶é—´,è®¡ç®—æ—¶é—´ä¹‹æ¯”ï¼ˆwait time / compute timeï¼‰çº¿ç¨‹æ± çš„æœ€ä¼˜å¤§å° = N * U * ï¼ˆ1 + W/Cï¼‰ é…ç½®ThreadPoolExecutorå¦‚æœnewCachedThreadPoolã€newFixedTheadPoolå’ŒnewScheduledTheadPoolç­‰å·¥å‚æ–¹æ³•è¿”å›çš„ThreadPoolExecutoræ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œå¯ä»¥é€šè¿‡ThreadPoolExecutorçš„æ„é€ å‡½æ•°æ¥å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶æ ¹æ®è‡ªå·±éœ€æ±‚æ¥å®šåˆ¶ã€‚æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š1234567public ThreadPoolExecutor(int corePoolSize, //çº¿ç¨‹æ± çš„åŸºæœ¬å¤§å° int maximumPoolSize, //æœ€å¤§å¤§å° long keepAliveTime, //å­˜æ´»æ—¶é—´ TimeUnit unit, //æ—¶é—´å•ä½ BlockingQueue&lt;Runnable&gt; workQueue, //å·¥ä½œé˜Ÿåˆ— ThreadFactory threadFactory, //çº¿ç¨‹å·¥å‚ RejectedExecutionHandler handler) &#123;...&#125; çº¿ç¨‹çš„åˆ›å»ºä¸é”€æ¯é€šè¿‡è°ƒèŠ‚çº¿ç¨‹æ± çš„åŸºæœ¬å¤§å°å’Œå­˜æ´»æ—¶é—´ï¼Œå¯ä»¥å¸®åŠ©çº¿ç¨‹æ± å›æ”¶ç©ºé—²çº¿ç¨‹å æœ‰çš„èµ„æºï¼Œä»è€Œä½¿å¾—è¿™äº›èµ„æºå¯ä»¥ç”¨äºæ‰§è¡Œå…¶ä»–å·¥ä½œã€‚ ç®¡ç†é˜Ÿåˆ—ä»»åŠ¡å¦‚æœæ–°è¯·æ±‚çš„åˆ°è¾¾é€Ÿç‡è¶…è¿‡äº†çº¿ç¨‹æ± çš„å¤„ç†é€Ÿç‡ï¼Œé‚£ä¹ˆæ–°åˆ°æ¥çš„è¯·æ±‚å°†ä¼šåœ¨ä¸€ä¸ªç”±Executorç®¡ç†çš„Runnableé˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œè€Œä¸ä¼šåƒçº¿ç¨‹é‚£æ ·å»ç«äº‰CPUèµ„æºã€‚ ThreadPoolExecutorå…è®¸æä¾›ä¸€ä¸ªBlockingQueueæ¥ä¿å­˜ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚åŸºæœ¬çš„ä»»åŠ¡æ’é˜Ÿæ–¹æ³•æœ‰3ç§ï¼šæ— ç•Œé˜Ÿåˆ—ã€æœ‰ç•Œé˜Ÿåˆ—å’ŒåŒæ­¥ç§»äº¤ã€‚ ä¸€ç§æ›´ç¨³å¦¥çš„èµ„æºç®¡ç†ç­–ç•¥æ—¶ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ï¼Œä¾‹å¦‚ArrayBlockingQueueã€æœ‰ç•ŒLinkedBlockingQueueã€PriorityBlockingQueueã€‚æœ‰ç•Œé˜Ÿåˆ—æœ‰åŠ©äºé¿å…èµ„æºè€—å°½çš„æƒ…å†µå‘ç”Ÿï¼Œä½†åˆå¸¦æ¥æ–°çš„é—®é¢˜ï¼šå½“é˜Ÿåˆ—æ»¡åï¼Œæ–°çš„ä»»åŠ¡æ€ä¹ˆåŠï¼Ÿåœ¨ä½¿ç”¨æœ‰ç•Œçš„å·¥ä½œé˜Ÿåˆ—æ—¶ï¼Œé˜Ÿåˆ—çš„å¤§å°å’Œçº¿ç¨‹æ± çš„å¤§å°å¿…é¡»ä¸€èµ·è°ƒèŠ‚ï¼Œå¦‚æœçº¿ç¨‹æ± è¾ƒå°è€Œé˜Ÿåˆ—è¾ƒå¤§ï¼Œé‚£ä¹ˆæœ‰åŠ©äºå‡å°‘å†…å­˜ä½¿ç”¨é‡ï¼Œé™ä½CPUä½¿ç”¨ç‡ï¼ŒåŒæ—¶å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä½†ä»£ä»·æ˜¯é™åˆ¶äº†ååé‡ã€‚ å¯¹äºéå¸¸å¤§çš„æˆ–è€…æ— ç•Œçš„çº¿ç¨‹æ± ï¼Œå¯ä»¥ä½¿ç”¨SynchronousQueueæ¥é¿å…ä»»åŠ¡æ’é˜Ÿï¼Œå®ƒå¯ä»¥ç›´æ¥å°†ä»»åŠ¡ä»ç”Ÿäº§è€…ç§»äº¤ç»™å·¥ä½œè€…çº¿ç¨‹ã€‚SynchronousQueueå¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„é˜Ÿåˆ—ï¼Œè€Œæ˜¯ä¸€ç§åœ¨çº¿ç¨‹ä¹‹é—´è¿›è¡Œç§»äº¤çš„æœºåˆ¶ã€‚è¦å°†ä¸€ä¸ªå…ƒç´ æ”¾å…¥SynchronousQueueä¸­ï¼Œå¿…é¡»ç”±å¦ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç­‰å¾…æ¥å—è¿™ä¸ªå…ƒç´ ã€‚å¦‚æœæ²¡æœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾…ï¼Œå¹¶ä¸”çº¿ç¨‹æ± çš„å½“å‰å¤§å°å°äºæœ€å¤§å€¼ï¼Œé‚£ä¹ˆThreadPoolExecutorä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªä»»åŠ¡ã€‚å¦åˆ™ï¼Œæ ¹æ®é¥±å’Œç­–ç•¥ï¼Œè¿™ä¸ªä»»åŠ¡å°†è¢«æ‹’ç»ã€‚ç›´æ¥ä½¿ç”¨ç§»äº¤å°†æ›´é«˜æ•ˆï¼Œå› ä¸ºä»»åŠ¡ç›´æ¥ç§»äº¤ç»™æ‰§è¡Œå®ƒçš„çº¿ç¨‹ï¼Œè€Œä¸æ˜¯å…ˆæ”¾åˆ°é˜Ÿåˆ—ï¼Œç„¶åå†ç”±å·¥ä½œçº¿ç¨‹ä»é˜Ÿåˆ—ä¸­æå–ä»»åŠ¡ã€‚åªæœ‰å½“çº¿ç¨‹æ± æ˜¯æ— ç•Œçš„æˆ–è€…å¯ä»¥æ‹’ç»ä»»åŠ¡æ—¶ï¼ŒSynchronousQueueæ‰æœ‰å®é™…ä»·å€¼ã€‚åœ¨newCachedThreadPoolä¸­å°±æ˜¯ä½¿ç”¨äº†SynchronousQueueã€‚ å½“ä½¿ç”¨åƒLinkedBlockingQueueæˆ–ArrayBlockingQueueè¿™æ ·FIFOé˜Ÿåˆ—æ—¶ï¼Œä»»åŠ¡çš„æ‰§è¡Œé¡ºåºä¸å®ƒä»¬çš„åˆ°è¾¾é¡ºåºç›¸åŒã€‚å¦‚æœæƒ³è¿›ä¸€æ­¥æ§åˆ¶ä»»åŠ¡æ‰§è¡Œé¡ºåºï¼Œè¿˜å¯ä»¥ä½¿ç”¨PriorityBlockingQueueï¼Œè¿™ä¸ªé˜Ÿåˆ—æ ¹æ®ä¼˜å…ˆçº§æ¥å®‰æ’ä»»åŠ¡ï¼Œä»»åŠ¡çš„ä¼˜å…ˆçº§æ˜¯é€šè¿‡è‡ªç„¶é¡ºåºæˆ–è€…Comparatoræ¥å®šä¹‰çš„ã€‚ åªæœ‰å½“ä»»åŠ¡ç›¸äº’ç‹¬ç«‹æ—¶ï¼Œä¸ºçº¿ç¨‹æ± æˆ–å·¥ä½œé˜Ÿåˆ—è®¾ç½®ç•Œé™æ‰æ˜¯åˆç†çš„ ã€‚å¦‚æœä»»åŠ¡ä¹‹é—´æœ‰ä¾èµ–æ€§ï¼Œé‚£ä¹ˆæœ‰ç•Œçš„çº¿ç¨‹æ± æˆ–é˜Ÿåˆ—ä¼šå¯¼è‡´çº¿ç¨‹é¥¥é¥¿æ­»é”é—®é¢˜ï¼Œæ­¤æ—¶åº”è¯¥ä½¿ç”¨æ— ç•Œçš„çº¿ç¨‹æ± ï¼Œå¦‚newCachedThreadPoolã€‚ å¯¹äºExecutorï¼ŒnewCachedThreadPoolå·¥å‚æ–¹æ³•æ˜¯ä¸€ç§å¾ˆå¥½çš„é»˜è®¤é€‰æ‹©ï¼Œä»–èƒ½æä¾›æ¯”å›ºå®šå¤§å°çš„çº¿ç¨‹æ± æ›´å¥½çš„æ’é˜Ÿæ€§èƒ½ã€‚å½“éœ€è¦é™åˆ¶å½“å‰ä»»åŠ¡çš„æ•°é‡ä»¥æ»¡è¶³èµ„æºç®¡ç†éœ€è¦æ±‚æ—¶ï¼Œå¯ä»¥é€‰æ‹©å›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚ é¥±å’Œç­–ç•¥å½“æœ‰ç•Œé˜Ÿåˆ—è¢«å¡«æ»¡åï¼Œé¥±å’Œç­–ç•¥å¼€å§‹å‘æŒ¥ä½œç”¨ï¼ŒThreadPoolExecutorçš„é¥±å’Œç­–ç•¥å¯ä»¥é€šè¿‡è°ƒç”¨setRejectedExecutionHandleræ¥ä¿®æ”¹ã€‚ å½“å·¥ä½œé˜Ÿåˆ—è¢«å¡«æ»¡åï¼Œæ²¡æœ‰é¢„å®šä¹‰çš„é¥±å’Œç­–ç•¥æ¥é˜»å¡ececuteã€‚é€šè¿‡ä½¿ç”¨Semaphoreï¼ˆä¿¡å·é‡ï¼‰æ¥é™åˆ¶ä»»åŠ¡çš„åˆ°è¾¾ç‡å¯ä»¥å®ç°é¥±å’Œç­–ç•¥çš„åŠŸèƒ½ã€‚ çº¿ç¨‹å·¥å‚æ¯å½“çº¿ç¨‹æ± éœ€è¦åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œéƒ½æ˜¯é€šè¿‡çº¿ç¨‹å·¥å‚æ–¹æ³•æ¥å®Œæˆçš„ã€‚åœ¨TheadFactoryä¸­åªå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•newThreadï¼Œæ¯å½“çº¿ç¨‹æ± éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ—¶éƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ åœ¨è°ƒç”¨æ„é€ å‡½æ•°åå†å®šåˆ¶ThreadPoolExecutoråœ¨è°ƒç”¨å®ŒThreadPoolExecutorçš„æ„é€ å‡½æ•°åï¼Œä»ç„¶å¯ä»¥é€šè¿‡è®¾ç½®å‡½æ•°æ¥ä¿®æ”¹å¤§å¤šæ•°ä¼ é€’ç»™ä»–çš„æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œå¦‚æœExecutoræ˜¯é€šè¿‡Executorsä¸­çš„æŸä¸ªå·¥å‚æ–¹æ³•åˆ›å»ºçš„ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å°†ç»“æœçš„ç±»å‹è½¬æ¢ä¸ºThreadPoolExecutorä»¥è®¿é—®è®¾ç½®å™¨ã€‚ æ‰©å±•ThreadPoolExecutorThreadPoolExecutoræ˜¯å¯æ‰©å±•çš„ï¼Œå®ƒæä¾›äº†å‡ ä¸ªå¯ä»¥åœ¨å­ç±»åŒ–ä¸­æ”¹å†™çš„æ–¹æ³•ï¼šbeforeExcuteï¼ŒafterExecuteå’Œterminatedï¼Œè¿™äº›æ–¹æ³•å¯ä»¥ç”¨äºæ‰©å±•ThreadPoolExecutorçš„è¡Œä¸ºã€‚ åœ¨è¿™é‡Œæ–¹æ³•ä¸­å¯ä»¥æ·»åŠ æ—¥å¿—ã€è®¡æ—¶ã€ç›‘è§†æˆ–ç»Ÿè®¡ä¿¡æ¯æ”¶é›†åŠŸèƒ½ã€‚ æ€»ç»“å¯¹äºå¹¶å‘æ‰§è¡Œçš„ä»»åŠ¡ï¼ŒExecutoræ¡†æ¶æ˜¯ä¸€ç§å¼ºå¤§ä¸”çµæ´»çš„æ¡†æ¶ã€‚å®ƒæä¾›äº†å¤§é‡å¯è°ƒèŠ‚çš„é€‰é¡¹ã€‚æˆ‘ä»¬è¦æ ¹æ®å®é™…æƒ…å†µå¯¹è¿™äº›å‚æ•°è¿›è¡Œè°ƒèŠ‚ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_6_å–æ¶ˆä¸å…³é—­]]></title>
    <url>%2F2018%2F01%2F22%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-6-%E5%8F%96%E6%B6%88%E4%B8%8E%E5%85%B3%E9%97%AD%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä»»åŠ¡å’Œçº¿ç¨‹çš„å¯åŠ¨å¾ˆå®¹æ˜“ï¼Œåœ¨å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¼šè®©ä»–ä»¬è¿è¡Œç›´åˆ°ç»“æŸï¼Œç„¶è€Œï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›æå‰ç»“æŸä»»åŠ¡æˆ–çº¿ç¨‹ï¼Œä½†æ˜¯Javaæ²¡æœ‰æä¾›ä»»ä½•æœºåˆ¶æ¥å®‰å…¨åœ°ç»ˆæ­¢çº¿ç¨‹ï¼Œåªæ˜¯æä¾›äº†ä¸­æ–­ï¼Œè¿™æ˜¯ä¸€ç§åä½œæœºåˆ¶ï¼Œèƒ½å¤Ÿä½¿ä¸€ä¸ªçº¿ç¨‹ç»ˆæ­¢å¦ä¸€ä¸ªçº¿ç¨‹çš„å·¥ä½œã€‚æ‰€ä»¥éœ€è¦æˆ‘ä»¬èƒ½å¾ˆå®Œå–„åœ°å¤„ç†å¤±è´¥ã€å…³é—­å’Œå–æ¶ˆç­‰è¿‡ç¨‹ã€‚ ä»»åŠ¡å–æ¶ˆå¦‚æœå¤–éƒ¨ä»£ç èƒ½åœ¨æŸä¸ªæ“ä½œæ­£å¸¸å®Œæˆä¹‹å‰å°†å…¶ç½®å…¥â€œå®Œæˆâ€çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œå°±å¯ä»¥ç§°ä¸ºå¯å–æ¶ˆçš„ã€‚å–æ¶ˆè¿™ä¸ªæ“ä½œçš„åŸå› æœ‰å¾ˆå¤šï¼š ç”¨æˆ·è¯·æ±‚å–æ¶ˆã€‚ç”¨æˆ·ç‚¹å‡»å›¾å½¢ç•Œé¢ç¨‹åºçš„â€œå–æ¶ˆâ€æŒ‰é’®ã€‚ æœ‰æ—¶é—´é™åˆ¶çš„æ“ä½œã€‚æŸä¸ªç¨‹åºéœ€è¦åœ¨æœ‰é™æ—¶é—´å†…å®Œæˆæœç´¢ä»»åŠ¡ï¼Œå½“è¶…æ—¶æ—¶ï¼Œéœ€è¦å–æ¶ˆæœç´¢ä»»åŠ¡ã€‚ é”™è¯¯ã€‚å½“ä¸€ä¸ªçˆ¬è™«ç¨‹åºå‘ç”Ÿé”™è¯¯æ—¶ï¼Œé‚£ä¹ˆæœç´¢ä»»åŠ¡éƒ½ä¼šå–æ¶ˆã€‚ å…³é—­ã€‚åœ¨ç«‹å³å…³é—­çš„è¿‡ç¨‹ä¸­ï¼Œå½“å‰çš„ä»»åŠ¡åˆ™å¯èƒ½è¢«å–æ¶ˆã€‚ åœ¨Javaä¸­æ²¡æœ‰ä¸€ç§å®‰å…¨çš„æŠ¢å å¼æ–¹æ³•æ¥åœæ­¢çº¿ç¨‹ï¼Œå› æ­¤ä¹Ÿå°±æ²¡æœ‰å®‰å…¨çš„æŠ¢å å¼æ–¹æ³•æ¥åœæ­¢ä»»åŠ¡ï¼Œåªæœ‰ä¸€äº›åä½œå¼çš„æœºåˆ¶ï¼Œä½¿è¯·æ±‚å–æ¶ˆçš„ä»»åŠ¡å’Œä»£ç éƒ½éµå¾ªä¸€ç§åå•†å¥½çš„åè®®ã€‚ å…¶ä¸­ä¸€ç§åä½œæœºåˆ¶èƒ½è®¾ç½®æŸä¸ªâ€œå·²è¯·æ±‚å–æ¶ˆâ€æ ‡å¿—ï¼Œè€Œä»»åŠ¡å°†å®šæœŸåœ°æŸ¥çœ‹è¯¥æ ‡å¿—ã€‚å¦‚æœè®¾ç½®äº†è¿™ä¸ªæ ‡å¿—ï¼Œé‚£ä¹ˆä»»åŠ¡å°†æå‰ç»“æŸã€‚ä»£ç å¦‚ä¸‹:12345678910111213141516public class Task implement Runnable &#123; // ä¸ºäº†ä½¿è¿™ä¸ªè¿‡ç¨‹èƒ½å¯é å¾—å·¥ä½œï¼Œæ ‡å¿—cancelledå¿…é¡»ä¸ºvolatileç±»å‹ private volatile boolean cancelled; public void run() &#123; while(!cancelled) &#123; &#125; &#125; public void cancel() &#123; cancelled = true; &#125;&#125; ä¸­æ–­å¦‚æœåœ¨ä¸Šé¢ä»£ç ä¸­whileé‡Œé¢å‡ºç°äº†ä¸€ä¸ªé˜»å¡çš„æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨cancelæ–¹æ³•æ¥è®¾ç½®cancelledçŠ¶æ€ï¼Œå½“å´æ£€æŸ¥ä¸åˆ°æ ‡å¿—ï¼Œå› ä¸ºå®ƒæ— æ³•ä»é˜»å¡çš„æ–¹æ³•æ¢å¤è¿‡æ¥ã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼š123456789101112131415161718192021222324public class BrokenPrimeProducer extends Thread &#123; private final BlockingQueue&lt;BigInteger&gt; queue; private volatile boolean cancelled = false; BrokenPrimeProducer(BlockingQueue&lt;BigInteger&gt; queue) &#123; this.queue = queue; &#125; public void run() &#123; try &#123; BigInteger p = BigInteger.ONE; while (!cancelled) &#123; // å¦‚æœç”Ÿäº§è€…çš„é€Ÿåº¦è¶…è¿‡æ¶ˆè´¹è€…çš„å¤„ç†é€Ÿåº¦ï¼Œé˜Ÿåˆ—å°†è¢«å¡«æ»¡ï¼Œputæ–¹æ³•ä¼šè¢«é˜»å¡ queue.put(p = p.nextProbablePrime()); &#125; &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; public void cancel() &#123; cancelled = true; &#125;&#125; æ‰€ä»¥æˆ‘ä»¬ä¼šæƒ³åˆ°ä¸€äº›çº¿ç¨‹ä¸­æ–­è¿™ç§åä½œæœºåˆ¶ï¼Œå®ƒåˆ©ç”¨äº†ç‰¹æ®Šçš„é˜»å¡åº“ç”¨æ¥æ˜¯å®ç°ä»»åŠ¡å–æ¶ˆï¼Œæ³¨æ„ï¼šå¦‚æœåœ¨å–æ¶ˆä¹‹å¤–çš„å…¶ä»–æ“ä½œä¸­ä½¿ç”¨ä¸­æ–­ï¼Œéƒ½æ˜¯ä¸åˆé€‚çš„ï¼Œå¹¶ä¸”å¾ˆéš¾æ”¯æ’‘èµ·æ›´å¤§çš„åº”ç”¨ã€‚ä¸‹é¢æ˜¯Threadçš„ä¸­æ–­æ–¹æ³•:123456789101112// æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªbooleanç±»å‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå½“ä¸­æ–­çº¿ç¨‹æ—¶ï¼Œè¿™ä¸ªçº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€å°†è¢«è®¾ç½®ä¸ºtruepublic class Thread &#123; // ä¸­æ–­ç›®æ ‡çº¿ç¨‹ public void interrupt() &#123;&#125; // æ¸…é™¤å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ public static boolean interrupted() &#123;&#125; // è¿”å›ç›®æ ‡çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ public boolean isInterrupted() &#123;&#125;&#125; é˜»å¡åº“çš„æ–¹æ³•ï¼Œå¦‚Thread.sleepå’ŒObject.waitç­‰éƒ½ä¼šæ£€æŸ¥çº¿ç¨‹ä½•æ—¶ä¸­æ–­ï¼Œå¹¶ä¸”åœ¨å‘ç”Ÿä¸­æ–­æ—¶è¿”å›ã€‚å“åº”ä¸­æ–­æ‰§è¡Œçš„æ“ä½œåŒ…æ‹¬ï¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€ï¼ŒæŠ›å‡ºInterruptedExceptionã€‚JVMä¸ä¿è¯é˜»å¡æ–¹æ³•æ£€æµ‹åˆ°ä¸­æ–­çš„é€Ÿåº¦ï¼Œä½†é€šå¸¸å“åº”é€Ÿåº¦è¿˜æ˜¯éå¸¸å¿«çš„ã€‚ æ³¨æ„ï¼šè°ƒç”¨interruptå¹¶ä¸æ„å‘³ç€ç«‹å³åœæ­¢ç›®æ ‡çº¿ç¨‹æ­£åœ¨è¿›è¡Œçš„å·¥ä½œï¼Œè€Œåªæ˜¯ä¼ é€’äº†è¯·æ±‚ä¸­æ–­çš„æ¶ˆæ¯ã€‚ç„¶åç”±çº¿ç¨‹åœ¨ä¸‹ä¸€ä¸ªåˆé€‚çš„æ—¶åˆ»ä¸­æ–­è‡ªå·±ï¼ˆè¿™äº›æ—¶åˆ»ä¹Ÿè¢«ç§°ä¸ºå–æ¶ˆç‚¹ï¼‰ã€‚æœ‰äº›æ–¹æ³•ï¼Œä¾‹å¦‚waitã€sleepå’Œjoinç­‰ï¼Œå°†ä¸¥æ ¼å¤„ç†è¿™ç§è¯·æ±‚ï¼Œå½“ä»–ä»¬æ”¶åˆ°ä¸­æ–­è¯·æ±‚æˆ–è€…åœ¨å¼€å§‹æ‰§è¡Œæ—¶å‘ç°æŸä¸ªå·²è¢«è®¾ç½®å¥½çš„ä¸­æ–­çŠ¶æ€ï¼Œå°†æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920212223public class BrokenPrimeProducer extends Thread &#123; private final BlockingQueue&lt;BigInteger&gt; queue; BrokenPrimeProducer(BlockingQueue&lt;BigInteger&gt; queue) &#123; this.queue = queue; &#125; public void run() &#123; try &#123; BigInteger p = BigInteger.ONE; // åœ¨é˜»å¡çš„putæ–¹æ³•è°ƒç”¨ä¸­ä»¥åŠåœ¨å¾ªç¯å¼€å§‹å¤„æŸ¥è¯¢ä¸­æ–­çŠ¶æ€æ—¶ï¼Œéƒ½ä¼šæ£€æŸ¥ä¸­æ–­æ ‡å¿— while (!Thread.currentThread().isInterrupted()) &#123; queue.put(p = p.nextProbablePrime()); &#125; &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; public void cancel() &#123; interrupt(); &#125;&#125; ä¸­æ–­ç­–ç•¥æœ€åˆç†çš„ä¸­æ–­ç­–ç•¥æ˜¯æŸç§å½¢å¼çš„çº¿ç¨‹çº§å–æ¶ˆæ“ä½œæˆ–è€…æœåŠ¡çº§å–æ¶ˆæ“ä½œï¼šå°½å¿«é€€å‡ºï¼Œåœ¨å¿…è¦æ—¶æ¸…ç†ï¼Œé€šçŸ¥æŸä¸ªæ‰€æœ‰è€…è¯¥çº¿ç¨‹å·²ç»é€€å‡ºã€‚æ­¤å¤–è¿˜å¯ä»¥å»ºç«‹å…¶ä»–çš„ä¸­æ–­ç­–ç•¥ï¼Œä¾‹å¦‚æš‚åœæœåŠ¡æˆ–é‡æ–°å¼€å§‹æœåŠ¡ã€‚ ä»»åŠ¡ä¸åº”è¯¥å¯¹æ‰§è¡Œè¯¥ä»»åŠ¡çš„çº¿ç¨‹çš„ä¸­æ–­ç­–ç•¥åšå‡ºå‡è®¾ã€‚æ— è®ºä»»åŠ¡æŠŠä¸­æ–­è§†ä¸ºå–æ¶ˆï¼Œè¿˜æ˜¯å…¶ä»–æŸä¸ªä¸­æ–­å“åº”æ“ä½œï¼Œéƒ½åº”è¯¥å°å¿ƒçš„ä¿å­˜çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œå¦‚æœé™¤äº†å°†InterruptExceptionä¼ é€’ç»™è°ƒç”¨è€…å¤–è¿˜éœ€è¦æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œé‚£ä¹ˆåº”è¯¥åœ¨æ•è·InterruptExceptionä¹‹åæ¢å¤ä¸­æ–­çŠ¶æ€ã€‚ çº¿ç¨‹åªèƒ½ç”±å…¶æ‰€æœ‰è€…ä¸­æ–­ï¼Œæ‰€æœ‰è€…å¯ä»¥å°†çº¿ç¨‹çš„ä¸­æ–­ç­–ç•¥ä¿¡æ¯å°è£…åˆ°æŸä¸ªåˆé€‚çš„å–æ¶ˆæœºåˆ¶ä¸­ï¼Œä¾‹å¦‚å…³é—­æ–¹æ³•ä¸­ã€‚ å“åº”ä¸­æ–­åœ¨è°ƒç”¨å¯ä¸­æ–­çš„é˜»å¡å‡½æ•°æ—¶ï¼Œæœ‰ä¸¤ç§å®ç”¨ç­–ç•¥å¯ç”¨äºå¤„ç†InterruptExceptionï¼š ä¼ é€’å¼‚å¸¸ï¼šä»è€Œä½¿ä½ çš„æ–¹æ³•ä¹Ÿç§°ä¸ºäº†å¯ä¸­æ–­çš„é˜»å¡æ–¹æ³•ã€‚ æ¢å¤ä¸­æ–­çŠ¶æ€ï¼šä»è€Œä½¿è°ƒç”¨æ ˆä¸­çš„ä¸Šå±‚ä»£ç èƒ½å¤Ÿå¯¹å…¶è¿›è¡Œå¤„ç†ã€‚ åªæœ‰æ˜¯å®ç°äº†çº¿ç¨‹ä¸­æ–­ç­–ç•¥çš„ä»£ç æ‰å¯ä»¥å±è”½ä¸­æ–­è¯·æ±‚ã€‚åœ¨å¸¸è§„çš„ä»»åŠ¡å’Œåº“ä»£ç ä¸­éƒ½ä¸åº”è¯¥å±è”½ä¸­æ–­è¯·æ±‚ã€‚ é€šè¿‡Futureæ¥å®ç°å–æ¶ˆä½¿ç”¨ExecuorService.submitæ–¹æ³•å°†è¿”å›ä¸€ä¸ªFutureæ¥æè¿°ä»»åŠ¡ï¼ŒFutureæœ‰ä¸€ä¸ªcancelæ–¹æ³•ã€‚cancleæ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°mayInterruptIfRunning,å¦‚æœè®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆå°±è¡¨ç¤ºå–æ¶ˆæ“ä½œæ˜¯å¦æˆåŠŸï¼ˆè¿™åªæ˜¯è¡¨ç¤ºä»»åŠ¡æ˜¯å¦èƒ½å¤Ÿæ¥å—ä¸­æ–­ï¼Œè€Œä¸æ˜¯è¡¨ç¤ºä»»åŠ¡æ˜¯å¦èƒ½å¤Ÿæ£€æµ‹å¹¶å¤„ç†ä¸­æ–­ï¼‰ã€‚å¦‚æœä¸ºfalseï¼Œè¡¨ç¤ºå¦‚æœä»»åŠ¡è¿˜æ²¡æœ‰è¿è¡Œï¼Œé‚£ä¹ˆå°±ä¸è¦è¿è¡Œå®ƒã€‚ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819public class TimedRun &#123; private static final ExecutorService taskExec = Executors.newCachedThreadPool(); public static void timedRun(Runnable r,long timeout, TimeUnit unit) throws InterruptedException &#123; Future&lt;?&gt; task = taskExec.submit(r); try &#123; task.get(timeout, unit); &#125; catch (TimeoutException e) &#123; // æ¥ä¸‹æ¥ä»»åŠ¡å°†è¢«å–æ¶ˆ &#125; catch (ExecutionException e) &#123; // å¦‚æœåœ¨ä»»åŠ¡æ‰§è¡Œå’Œä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œé‚£ä¹ˆé‡æ–°æŠ›å‡ºè¯¥å¼‚å¸¸ throw launderThrowable(e.getCause()); &#125; finally &#123; //å¦‚æœä»»åŠ¡å·²ç»ç»“æŸï¼Œé‚£ä¹ˆæ‰§è¡Œå–æ¶ˆæ“ä½œä¹Ÿä¸ä¼šå¸¦æ¥ä»»ä½•å½±å“ task.cancel(true); // å¦‚æœä»»åŠ¡æ­£åœ¨è¿è¡Œï¼Œé‚£ä¹ˆå°†è¢«ä¸­æ–­ &#125; &#125; &#125; å¤„ç†ä¸å¯ä¸­æ–­çš„é˜»å¡åœ¨javaåº“ä¸­ï¼Œå¾ˆå¤šé˜»å¡çš„æ–¹æ³•éƒ½æ˜¯é€šè¿‡æå‰è¿”å›æˆ–è€…æ˜¯æŠ›å‡ºInterruptedExceptionæ¥å“åº”ä¸­æ–­è¯·æ±‚çš„ï¼Œç„¶è€Œå¹¶éæ‰€æœ‰çš„å¯é˜»å¡æ–¹æ³•æˆ–è€…é˜»å¡æœºåˆ¶éƒ½èƒ½å“åº”ä¸­æ–­ã€‚ æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹ç”±äºæ‰§è¡ŒåŒæ­¥çš„Socket IO æˆ–è€…ç­‰å¾…è·å¾—å†…ç½®é”è€Œé˜»å¡ï¼Œé‚£ä¹ˆä¸­æ–­è¯·æ±‚åªèƒ½è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰å…¶ä»–ä»»ä½•ä½œç”¨ï¼Œå¯¹äºé‚£äº›æ‰§è¡Œä¸å¯ä¸­æ–­æ“ä½œè€Œè¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼äºä¸­æ–­çš„æ‰‹æ®µæ¥åœæ­¢è¿™äº›çº¿ç¨‹ï¼Œä½†è¿™è¦æ±‚æˆ‘ä»¬å¿…é¡»çŸ¥é“çº¿ç¨‹é˜»å¡çš„åŸå› ï¼Œç„¶åé€šè¿‡é‡å†™éæ ‡å‡†çš„å–æ¶ˆæ“ä½œã€‚ åœæ­¢åŸºç¡€çº¿ç¨‹çš„æœåŠ¡åº”ç”¨ç¨‹åºé€šå¸¸ä¼šåˆ›å»ºå¤šä¸ªçº¿ç¨‹çš„æœåŠ¡ï¼Œä¾‹å¦‚çº¿ç¨‹æ± ã€‚æ­£ç¡®åœ°å°è£…åŸåˆ™æ˜¯ï¼šé™¤éæ‹¥æœ‰æŸä¸ªçº¿ç¨‹ï¼Œå¦åˆ™ä¸èƒ½å¯¹è¯¥çº¿ç¨‹è¿›è¡Œæ“æ§ï¼Œçº¿ç¨‹æ± æ˜¯å…¶å·¥ä½œçº¿ç¨‹çš„æ‰€æœ‰è€…ï¼Œå¦‚æœè¦ä¸­æ–­è¿™äº›çº¿ç¨‹ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨çº¿ç¨‹æ± ã€‚çº¿ç¨‹çš„æ‰€æœ‰æƒæ˜¯ä¸å¯ä»¥ä¼ é€’çš„ï¼šåº”ç”¨ç¨‹åºå¯ä»¥æ‹¥æœ‰æœåŠ¡ï¼ŒæœåŠ¡å¯ä»¥æ‹¥æœ‰å·¥ä½œè€…çº¿ç¨‹ï¼Œä½†åº”ç”¨ç¨‹åºå¹¶ä¸èƒ½æ‹¥æœ‰å·¥ä½œè€…çº¿ç¨‹ï¼Œå› æ­¤åº”ç”¨ç¨‹åºä¸èƒ½ç›´æ¥åœæ­¢å·¥ä½œè€…çº¿ç¨‹ã€‚ç›¸åï¼ŒæœåŠ¡åº”ç”¨æä¾›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ¥å…³é—­å®ƒè‡ªå·±ä»¥åŠå®ƒæ‰€æ‹¥æœ‰çš„çº¿ç¨‹ï¼Œåœ¨ExecutorServiceä¸­æä¾›äº†shutdownå’ŒshutdownNowæ–¹æ³•ã€‚ ä¾‹å­ï¼šæ—¥å¿—æœåŠ¡ æ–¹å¼ï¼šé€šè¿‡è°ƒç”¨logæ–¹æ³•å°†æ—¥å¿—æ¶ˆæ¯æ”¾å…¥æŸä¸ªé˜Ÿåˆ—ä¸­ï¼Œå¹¶ç”±å…¶ä»–çº¿ç¨‹æ¥å¤„ç†ï¼› åœæ­¢è¯¥æœåŠ¡çš„æ–¹å¼ï¼šé€šè¿‡åŸå­æ–¹å¼æ¥æ£€æŸ¥å…³é—­è¯·æ±‚ï¼Œå¹¶ä¸”æœ‰æ¡ä»¶åœ°é€’å¢ä¸€ä¸ªè®¡æ•°å™¨æ¥ä¿å­˜æäº¤ä¿¡æ¯çš„æƒåˆ©ï¼› å…³é—­ExecutorService Serviceå°è£…åœ¨æŸä¸ªæ›´é«˜çº§åˆ«çš„æœåŠ¡ä¸­ï¼Œå¹¶ä¸”è¯¥æœåŠ¡èƒ½æä¾›å…¶è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ æ¯’ä¸¸å¯¹è±¡ æ¯’ä¸¸æ˜¯æŒ‡ä¸€ä¸ªæ”¾åœ¨é˜Ÿåˆ—ä¸Šçš„å¯¹è±¡ï¼Œå…¶å«ä¹‰æ˜¯ï¼šå½“å¾—åˆ°è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œç«‹å³åœæ­¢ï¼› é™åˆ¶ï¼šåªæœ‰åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„æ•°é‡éƒ½å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œæ‰å¯ä»¥ä½¿ç”¨â€œæ¯’ä¸¸â€å¯¹è±¡ï¼› å½“ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ•°ç›®è¾ƒå¤§æ—¶ï¼Œè¿™ç§æ–¹æ³•å˜å¾—éš¾ä»¥ä½¿ç”¨ã€‚ ä¾‹å­ï¼šåªæ‰§è¡Œä¸€æ¬¡çš„æœåŠ¡ åœºæ™¯ï¼šæŸä¸ªæ–¹æ³•éœ€è¦å¤„ç†ä¸€æ‰¹ä»»åŠ¡ï¼Œå¹¶ä¸”å½“æ‰€æœ‰ä»»åŠ¡éƒ½å¤„ç†å®Œåæ‰è¿”å›ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªç§æœ‰çš„Executoræ¥ç®€åŒ–æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œå…¶ä¸­è¯¥Executorçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç”±è¿™ä¸ªæ–¹æ³•æ§åˆ¶çš„ shutdownNowçš„å±€é™æ€§ å½“é€šè¿‡shutdownNowæ¥å¼ºè¡Œå…³é—­ExecutorServiceæ—¶ï¼Œå°è¯•å–æ¶ˆæ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶è¿”å›æ‰€æœ‰å·²ç»æäº¤ä½†æœªå¼€å§‹çš„ä»»åŠ¡ã€‚ä½†æ— æ³•åœ¨å…³é—­è¿‡ç¨‹ä¸­çŸ¥é“æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡çš„çŠ¶æ€ã€‚é™¤éä»»åŠ¡æœ¬èº«ä¼šæ‰§è¡ŒæŸç§æ£€æŸ¥ã€‚ å¤„ç†éæ­£å¸¸çš„çº¿ç¨‹ç»ˆæ­¢åœ¨å¹¶å‘ç¨‹åºä¸­,æ˜¯æ— æ³•åšåˆ°ä¸€ç›´è§‚å¯Ÿæ§åˆ¶å°çš„, ä¾‹å¦‚:ä½ çš„webåº”ç”¨éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š,éš¾é“ä½ è¦æ´¾ä¸ªäººä¸€ç›´å»è§‚å¯Ÿæ§åˆ¶å°? ä»»ä½•ä»£ç éƒ½å¯èƒ½æŠ›å‡ºä¸€ä¸ªRuntimeExecption,æ¯å½“è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•æ—¶,éƒ½è¦å¯¹å®ƒçš„è¡Œä¸ºä¿æŒæ€€ç–‘,ä¸è¦ç›²ç›®åœ°è®¤ä¸ºå®ƒä¸€å®šä¼šæŠ›å‡ºåœ¨æ–¹æ³•åŸå‹ä¸­å£°æ˜çš„æŸä¸ªå·²æ£€æŸ¥å¼‚å¸¸ã€‚å¯¹è°ƒç”¨çš„ä»£ç è¶Šä¸ç†Ÿæ‚‰,å°±è¶Šåº”è¯¥å¯¹å…¶ä»£ç è¡Œä¸ºä¿æŒæ€€ç–‘ã€‚ å…¸å‹çš„çº¿ç¨‹æ± å·¥ä½œè€…çº¿ç¨‹ç»“æ„ä»£ç å¦‚ä¸‹ï¼š123456789101112public void run()&#123; Throwable throw = null; try&#123; while(!isInterrupted)&#123; runTask(getTaskFromWorkQueue()); &#125; &#125; catch (Throwable e)&#123; thrown = e; &#125; finally&#123; threadExited(this,thrown); &#125;&#125; å¦‚æœä»»åŠ¡æŠ›å‡ºäº†ä¸€ä¸ªæœªæ£€æŸ¥çš„å¼‚å¸¸,é‚£ä¹ˆå®ƒå°†ä½¿çº¿ç¨‹ç»ˆç»“,ä½†ä¼šé¦–å…ˆé€šçŸ¥æ¡†æ¶è¯¥çº¿ç¨‹å·²ç»ç»ˆç»“.ç„¶å,æ¡†æ¶å¯èƒ½ä¼šç”¨æ–°çš„çº¿ç¨‹æ¥ä»£æ›¿è¿™ä¸ªå·¥ä½œçº¿ç¨‹ã€‚ å°†å¼‚å¸¸å†™å…¥æ—¥å¿—çš„UncaughtExecptionHandlerä»£ç å¦‚ä¸‹ï¼š123456public class Thread.UncaughtExecptionHandler&#123; public void uncaughtException(Thread t,Throwable e)&#123; Logger logger = Logger.getAnonymousLogger(); Logger.log(Level.SEVERE,"Thread terminated with exception: "+ t.getName(),e); &#125;&#125; åœ¨è¿è¡Œæ—¶é—´è¾ƒé•¿çš„åº”ç”¨ç¨‹åºä¸­,é€šå¸¸ä¼šä¸ºæ‰€æœ‰çº¿ç¨‹çš„æœªæ•è·å¼‚å¸¸æŒ‡å®šåŒä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨,å¹¶ä¸”è¯¥å¼‚å¸¸å¤„ç†å™¨è‡³å°‘ä¼šå°†å¼‚å¸¸ä¿¡æ¯è®°å½•åˆ°æ—¥å¿—ä¸­ã€‚ JVMå…³é—­JVMæ—¢å¯ä»¥æ­£å¸¸å…³é—­ï¼Œä¹Ÿå¯ä»¥å¼ºè¡Œå…³é—­ã€‚æ­£å¸¸å…³é—­çš„è§¦å‘æ–¹å¼æœ‰å¤šç§ï¼ŒåŒ…æ‹¬ï¼šå½“æœ€åä¸€ä¸ªâ€œæ­£å¸¸ï¼ˆéå®ˆæŠ¤ï¼‰â€çº¿ç¨‹ç»“æŸæ—¶ï¼Œæˆ–è€…è°ƒç”¨äº†System.exitæ—¶ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–ç‰¹å®šäºå¹³å°çš„æ–¹æ³•å…³é—­æ—¶ï¼ˆä¾‹å¦‚å‘é€äº†SIGINTä¿¡å·æˆ–Ctrl-Cï¼‰ã€‚è™½ç„¶å¯ä»¥é€šè¿‡è¿™äº›æ ‡å‡†æ–¹æ³•æ¥æ­£å¸¸å…³é—­JVMï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨Runtime.haltæˆ–è€…åœ¨æ“ä½œç³»ç»Ÿä¸­â€œæ€æ­»â€JVMè¿›ç¨‹æ¥å¼ºè¡Œå…³é—­JVMã€‚ å…³é—­é’©å­åœ¨æ­£å¸¸å…³é—­ä¸­ï¼ŒJVMé¦–å…ˆè°ƒç”¨æ‰€æœ‰å·²æ³¨å†Œçš„å…³é—­é’©å­ï¼Œå…³é—­é’©å­æ˜¯æŒ‡é€šè¿‡Runtime.addShutdownHookæ³¨å†Œçš„ä½†å°šæœªå¼€å§‹çš„çº¿ç¨‹ã€‚JVMä¸èƒ½ä¿è¯å…³é—­é’©å­çš„è°ƒç”¨é¡ºåºã€‚åœ¨å…³é—­åº”ç”¨ç¨‹åºçº¿ç¨‹æ—¶,å¦‚æœæœ‰çº¿ç¨‹ä»ç„¶åœ¨è¿è¡Œ,é‚£ä¹ˆè¿™äº›çº¿ç¨‹æ¥ä¸‹æ¥å°†ä¸å…³é—­è¿›ç¨‹å¹¶å‘æ‰§è¡Œ. å…³é—­é’©å­åº”è¯¥æ˜¯çº¿ç¨‹å®‰å…¨:å®ƒä»¬åœ¨è®¿é—®å…±äº«æ•°æ®æ—¶,å¿…é¡»ä½¿ç”¨åŒæ­¥æœºåˆ¶,å°å¿ƒé¿å…æ­»é”ã€‚ å…³é—­é’©å­å¯ä»¥ç”¨äºå®ç°æœåŠ¡æˆ–åº”ç”¨ç¨‹åºçš„æ¸…ç†å·¥ä½œï¼Œä¾‹å¦‚åˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œæˆ–è€…æ¸…é™¤æ— æ³•ç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨æ¸…é™¤çš„èµ„æºã€‚ å®ˆæŠ¤çº¿ç¨‹æœ‰æ—¶å€™ï¼Œä½ å¸Œæœ›åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œä¸€äº›è¾…åŠ©å·¥ä½œï¼Œä½†åˆä¸å¸Œæœ›è¿™ä¸ªçº¿ç¨‹é˜»ç¢äº†JVMçš„å…³é—­ï¼Œè¿™ç§æƒ…å†µå°±éœ€è¦ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹ã€‚ çº¿ç¨‹åˆ†ä¸ºä¸¤ç§: æ™®é€šçº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹,åœ¨JVMå¯åŠ¨æ—¶å¯åŠ¨åˆ›å»ºçš„æ‰€æœ‰çº¿ç¨‹ä¸­,é™¤äº†ä¸»çº¿ç¨‹ä»¥å¤–ï¼Œå…¶ä»–çš„çº¿ç¨‹éƒ½æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚ä¾‹å¦‚åƒåœ¾å›æ”¶å™¨ï¼Œå½“åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ—¶ï¼Œå®ƒå°†ç»§æ‰¿åˆ›å»ºå®ƒçš„çº¿ç¨‹çš„ç±»å‹ã€‚ æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å°‘åœ°ä½¿ç”¨å®ˆæŠ¤çº¿ç¨‹â€“å¾ˆå°‘æœ‰æ“ä½œèƒ½å¤Ÿåœ¨ä¸è¿›è¡Œæ¸…ç†çš„æƒ…å†µä¸‹è¢«å®‰å…¨åœ°æŠ›å¼ƒ,ç‰¹åˆ«æ˜¯åœ¨æ‰§è¡ŒI/Oæ“ä½œçš„ä»»åŠ¡,é‚£ä¹ˆå°†æ˜¯ä¸€ç§éå¸¸å±é™©çš„è¡Œä¸º; å¹¶ä¸”å®ˆæŠ¤çº¿ç¨‹ä¸èƒ½ç”¨æ¥æ›¿ä»£åº”ç”¨ç¨‹åºç®¡ç†ç¨‹åºä¸­å„ä¸ªæœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸ ç»ˆç»“å™¨å½“ä¸å†éœ€è¦å†…å­˜èµ„æºæ—¶ï¼Œå¯ä»¥é€šè¿‡åƒåœ¾å›æ”¶å™¨æ¥å›æ”¶å®ƒä»¬ï¼Œä½†å¯¹äºå…¶ä»–ä¸€äº›èµ„æºï¼Œä¾‹å¦‚æ–‡ä»¶å¥æŸ„æˆ–å¥—æ¥å­—å¥æŸ„ï¼Œå½“ä¸å†éœ€è¦å®ƒä»¬æ—¶,å¿…é¡»æ˜¾å¼äº¤è¿˜ç»™æ“ä½œç³»ç»Ÿã€‚ä¸ºäº†å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œåƒåœ¾å›æ”¶å™¨å¯¹é‚£äº›å®šä¹‰äº†finalizeæ–¹æ³•çš„å¯¹è±¡ä¼šè¿›è¡Œç‰¹æ®Šå¤„ç†: åœ¨åƒåœ¾å›æ”¶æœŸé‡Šæ”¾å®ƒä»¬åï¼Œè°ƒç”¨å®ƒä»¬çš„finalizeæ–¹æ³•ï¼Œä»è€Œä¿è¯ä¸€äº›æŒä¹…åŒ–çš„èµ„æºè¢«é‡Šæ”¾ã€‚ ç”±äºç»ˆç»“å™¨å¯ä»¥åœ¨æŸä¸ªJVMç®¡ç†çš„çº¿ç¨‹ä¸­è¿è¡Œï¼Œå› æ­¤ç»ˆç»“å™¨è®¿é—®ä»»ä½•çŠ¶æ€éƒ½å¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œè¿™æ ·å°±å¿…é¡»å¯¹å…¶è®¿é—®æ“ä½œè¿›è¡ŒåŒæ­¥ã€‚ç»ˆç»“å™¨å¹¶ä¸èƒ½ä¿è¯å®ƒä»¬å°†åœ¨ä½•æ—¶ç”šè‡³æ˜¯å¦ä¼šè¿è¡Œï¼Œå¹¶ä¸”å¤æ‚çš„ç»ˆç»“å™¨å¸¦æ¥æ€§èƒ½ä¸Šçš„å·¨å¤§å¼€é”€ã€‚ç¼–å†™æ­£ç¡®çš„ç»ˆç»“å™¨æ˜¯éå¸¸å›°éš¾çš„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé€šè¿‡ä½¿ç”¨finallyä»£ç å—å’Œæ˜¾å¼çš„closeæ–¹æ³•èƒ½å¤Ÿæ¯”ç»ˆç»“å™¨æ›´å¥½çš„ç®¡ç†èµ„æºã€‚ é¿å…ä½¿ç”¨ç»ˆç»“å™¨ æ€»ç»“åœ¨ä»»åŠ¡ã€çº¿ç¨‹ã€æœåŠ¡ä»¥åŠåº”ç”¨ç¨‹åºç­‰æ¨¡å—ä¸­çš„ç”Ÿå‘½å‘¨æœŸç»“æŸé—®é¢˜ï¼Œå¯èƒ½ä¼šå¢åŠ ä»–ä»¬åœ¨è®¾è®¡å’Œå®ç°æ—¶çš„å¤æ‚æ€§ã€‚Javaå¹¶æ²¡æœ‰æä¾›æŸç§æŠ¢å å¼çš„æœºåˆ¶æ¥å–æ¶ˆæ“ä½œæˆ–è€…æ€»ç»“çº¿ç¨‹ã€‚ç›¸åï¼Œå®ƒæä¾›äº†ä¸€ç§åä½œå¼çš„ä¸­æ–­æœºåˆ¶æ¥å®ç°å–æ¶ˆæ“ä½œï¼Œä½†è¿™è¦ä¾èµ–äºå¦‚ä½•æ„å»ºå–æ¶ˆæ“ä½œçš„åè®®ï¼Œä»¥åŠèƒ½å¦å§‹ç»ˆéµå¾ªè¿™äº›åè®®ã€‚é€šè¿‡ä½¿ç”¨FutureTaskå’ŒExecutoræ¡†æ¶ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ„å»ºå¯å–æ¶ˆçš„ä»»åŠ¡å’ŒæœåŠ¡ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_5_ä»»åŠ¡æ‰§è¡Œ]]></title>
    <url>%2F2018%2F01%2F15%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-5-%E4%BB%BB%E5%8A%A1%E6%89%A7%E8%A1%8C%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨å¤§å¤šæ•°å¹¶å‘åº”ç”¨ç¨‹åºéƒ½æ˜¯å›´ç»•â€œä»»åŠ¡æ‰§è¡Œâ€æ¥æ„é€ çš„ï¼šä»»åŠ¡é€šå¸¸æ˜¯ä¸€äº›æŠ½è±¡ä¸”ç¦»æ•£çš„å·¥ä½œå•å…ƒã€‚é€šè¿‡æŠŠåº”ç”¨ç¨‹åºçš„å·¥ä½œåˆ†è§£åˆ°å¤šä¸ªä»»åŠ¡ä¸­ï¼Œå¯ä»¥ç®€åŒ–ç¨‹åºçš„ç»„ç»‡ç»“æ„ï¼Œæä¾›ä¸€ç§è‡ªç„¶çš„äº‹åŠ¡è¾¹ç•Œæ¥ä¼˜åŒ–é”™è¯¯æ¢å¤è¿‡ç¨‹ï¼Œä»¥åŠæä¾›ä¸€ç§è‡ªç„¶çš„å¹¶è¡Œå·¥ä½œç»“æ„æ¥æå‡å¹¶å‘æ€§ã€‚ åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡è¦ä½¿æœåŠ¡å™¨åº”ç”¨ç¨‹åºåŒæ—¶è¡¨ç°å‡ºè‰¯å¥½çš„ååé‡å’Œå¿«é€Ÿçš„å“åº”æ€§ï¼Œåº”è¯¥é€‰æ‹©æ¸…æ™°çš„ä»»åŠ¡è¾¹ç•Œä»¥åŠæ˜ç¡®çš„ä»»åŠ¡æ‰§è¡Œç­–ç•¥ï¼ˆè§åé¢ï¼‰ã€‚ ä¸²è¡Œåœ°æ‰§è¡Œä»»åŠ¡æœ€ç®€å•çš„è°ƒåº¦ä»»åŠ¡ç­–ç•¥å°±æ˜¯åœ¨å•ä¸ªçº¿ç¨‹ä¸­ä¸²è¡Œåœ°æ‰§è¡Œå„é¡¹ä»»åŠ¡ã€‚ä½†ä¸²è¡Œå¤„ç†æœºåˆ¶é€šå¸¸éƒ½æ— æ³•æä¾›é«˜ååç‡æˆ–å¿«é€Ÿå“åº”æ€§ã€‚ æ˜¾ç¤ºåœ°ä¸ºä»»åŠ¡åˆ›å»ºçº¿ç¨‹é€šè¿‡ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æä¾›æœåŠ¡ï¼Œä»è€Œå®ç°æ›´é«˜çš„å“åº”æ€§ã€‚ä½†ä¸ºæ¯ä¸ªä»»åŠ¡åˆ†é…ä¸€ä¸ªçº¿ç¨‹ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºé™·ã€‚ æ— é™åˆ›å»ºçº¿ç¨‹çš„ä¸è¶³ çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„å¼€é”€éå¸¸é«˜ã€‚çº¿ç¨‹çš„åˆ›å»ºè¿‡ç¨‹éœ€è¦æ—¶é—´ï¼Œè¿™å°±å»¶è¿Ÿäº†è¯·æ±‚çš„å¤„ç†ï¼Œå¹¶ä¸”éœ€è¦JVMå’Œæ“ä½œç³»ç»Ÿæä¾›ä¸€äº›è¾…åŠ©æ“ä½œã€‚ èµ„æºæ¶ˆè€—ã€‚å¦‚æœå¯è¿è¡Œçº¿ç¨‹æ•°é‡å¤šäºå¯ç”¨å¤„ç†å™¨çš„æ•°é‡ï¼Œé‚£ä¹ˆæœ‰äº›çº¿ç¨‹ä¼šé—²ç½®å°±ä¼šå ç”¨è®¸å¤šå†…å­˜ï¼Œå¦‚æœå¤§é‡çº¿ç¨‹åœ¨ç«äº‰CPUè¿˜ä¼šäº§ç”Ÿå…¶ä»–çš„æ€§èƒ½æ¶ˆè€—ã€‚ ç¨³å®šæ€§ã€‚åœ¨å¯åˆ›å»ºçº¿ç¨‹çš„æ•°é‡ä¸Šæœ‰ä¸€ä¸ªé˜ˆå€¼ï¼Œè¿™ä¸ªé˜ˆå€¼éšç€å¹³å°ä¸åŒè€Œä¸åŒï¼Œå¹¶ä¸”å—å¤šä¸ªå› ç´ åˆ¶çº¦ï¼ŒåŒ…æ‹¬JVMçš„å¯åŠ¨å‚æ•°ã€Threadæ„é€ å‡½æ•°ä¸­è¯·æ±‚çš„æ ˆå¤§å°ï¼Œä»¥åŠåº•å±‚æ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„é™åˆ¶ç­‰ã€‚å¦‚æœè¶…è¿‡è¿™ä¸ªé™åˆ¶ï¼Œå°±å¾ˆå¯èƒ½æœ‰OOMå¼‚å¸¸ã€‚ Executoræ¡†æ¶çº¿ç¨‹æ± ç®€åŒ–äº†çº¿ç¨‹çš„ç®¡ç†å·¥ä½œï¼Œå¹¶ä¸”java.util.concurrentæä¾›äº†ä¸€ç§çµæ´»çš„çº¿ç¨‹æ± ä½œä¸ºExecutoræ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚åœ¨javaç±»åº“ä¸­ï¼Œä»»åŠ¡æ‰§è¡Œçš„ä¸æ˜¯Threadï¼Œè€Œæ˜¯Executorã€‚å…¶ä»£ç å¦‚ä¸‹ï¼š123public interface Executor &#123; void execute(Runnable command);&#125; Executoræ¡†æ¶æä¾›äº†ä¸€ç§æ ‡å‡†çš„æ–¹æ³•å°†ä»»åŠ¡çš„æäº¤è¿‡ç¨‹ä¸æ‰§è¡Œè¿‡ç¨‹è§£è€¦å¼€æ¥ï¼Œå¹¶ç”¨Runnableæ¥è¡¨ç¤ºä»»åŠ¡ã€‚Executorçš„å®ç°è¿˜æä¾›äº†å¯¹ç”Ÿå‘½å‘¨æœŸçš„æ”¯æŒï¼Œä»¥åŠç»Ÿè®¡ä¿¡æ¯æ”¶é›†/åº”ç”¨ç¨‹åºç®¡ç†æœºåˆ¶å’Œæ€§èƒ½ç›‘è§†ç­‰æœºåˆ¶ã€‚ExecutoråŸºäºç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œæäº¤ä»»åŠ¡çš„æ“ä½œç›¸å½“äºç”Ÿäº§è€…ï¼Œæ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ç›¸å½“äºæ¶ˆè´¹è€…ã€‚ ç¤ºä¾‹ï¼šåŸºäºExecutorçš„WebæœåŠ¡å™¨å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä»£ç ï¼š1234567891011121314151617class TaskExecutorWebServer &#123; private static final int NTHREAD = 100; private static final Executor exe = Executors.newFixedThreadPool(NTHREAD); public static void main(String[] args) &#123; ServerSocket socket = new ServerSocket(80); while(true) &#123; final Socket connection = socket.accept(); Runnable task = new Runnable() &#123; public void run() &#123; handleRequest(connection); &#125; &#125;; exec.execute(task); &#125; &#125;&#125; åœ¨TaskExecutionWebServerä¸­ï¼Œé€šè¿‡ä½¿ç”¨Executorï¼Œå°†è¯·æ±‚å¤„ç†ä»»åŠ¡çš„æäº¤ä¸ä»»åŠ¡çš„å®é™…æ‰§è¡Œè§£è€¦å¼€æ¥ï¼Œå¹¶ä¸”åªéœ€è¦é‡‡ç”¨å¦ä¸€ç§ä¸åŒçš„Executorå®ç°ï¼Œå°±å¯ä»¥æ”¹å˜æœåŠ¡å™¨çš„è¡Œä¸ºã€‚ å°†TaskExecutorWebServeræ”¹ä¸ºæ˜¾ç¤ºåœ°ä¸ºä»»åŠ¡åˆ›å»ºçº¿ç¨‹ï¼š123456// ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½åˆ›å»ºæ–°çº¿ç¨‹çš„Executorpublic class ThreadPerTaskExecutor implements Executor &#123; public void execute(Runnable r) &#123; new Thread(r).start(); &#125;&#125; å°†TaskExecutorWebServeræ”¹ä¸ºä¸²è¡Œåœ°æ‰§è¡Œä»»åŠ¡ï¼š123456// ä»¥åŒæ­¥æ–¹å¼æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡çš„Executorpublic class WithinThreadExecutor implements Executor &#123; public void execute(Runnable r) &#123; r.run(); &#125;&#125; æ‰§è¡Œç­–ç•¥å„ç§æ‰§è¡Œç­–ç•¥éƒ½æ˜¯ä¸€ç§èµ„æºç®¡ç†å·¥å…·ï¼Œæœ€ä½³ç­–ç•¥å–å†³äºå¯ç”¨çš„è®¡ç®—èµ„æºä»¥åŠå¯¹æœåŠ¡è´¨é‡çš„éœ€æ±‚ã€‚é€šè¿‡é™åˆ¶å¹¶å‘ä»»åŠ¡çš„æ•°é‡ï¼Œå¯ä»¥ç¡®ä¿åº”ç”¨ç¨‹åºä¸ä¼šç”±äºèµ„æºè€—å°½è€Œå¤±è´¥ï¼Œæˆ–è€…ç”±äºåœ¨ç¨€ç¼ºèµ„æºå‘ç”Ÿç«äº‰è€Œä¸¥é‡å½±å“æ€§èƒ½ã€‚é€šè¿‡å°†ä»»åŠ¡çš„æäº¤äºä»»åŠ¡çš„æ‰§è¡Œåˆ†ç¦»å¼€æ¥ï¼Œæœ‰åŠ©äºåœ¨éƒ¨ç½²é˜¶æ®µé€‰æ‹©ä¸å¯ç”¨ç¡¬ä»¶èµ„æºæœ€åŒ¹é…çš„æ‰§è¡Œç­–ç•¥ã€‚ æ¯å½“çœ‹åˆ°ä¸‹é¢å½¢å¼çš„ä»£ç æ—¶ï¼Œå¹¶ä¸”å¸Œæœ›è·å¾—ä¸€ç§æ›´çµæ´»çš„æ‰§è¡Œç­–ç•¥æ—¶ï¼Œè€ƒè™‘ä½¿ç”¨Executoræ¥ä»£æ›¿Threadï¼š1new Thread(runnable).start(); çº¿ç¨‹æ± çº¿ç¨‹æ± æ˜¯æŒ‡ç®¡ç†ä¸€ç»„ç›¸åŒå·¥ä½œçº¿ç¨‹çš„èµ„æºæ± ã€‚çº¿ç¨‹æ± æ˜¯ä¸å·¥ä½œé˜Ÿåˆ—å¯†åˆ‡ç›¸å…³çš„ï¼Œå…¶ä¸­åœ¨å·¥ä½œé˜Ÿåˆ—ä¸­ä¿å­˜äº†æ‰€æœ‰ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚å·¥ä½œçº¿ç¨‹çš„ä»»åŠ¡å¾ˆç®€å•ï¼š ä»å·¥ä½œé˜Ÿåˆ—ä¸­è·å–ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡ï¼Œæ‰§è¡Œå®Œåè¿”å›çº¿ç¨‹æ± å¹¶ç­‰å¾…ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚ â€œåœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œä»»åŠ¡â€æ¯”â€œä¸ºæ¯ä¸ªä»»åŠ¡åˆ†é…ä¸€ä¸ªçº¿ç¨‹â€ä¼˜åŠ¿æ›´å¤šã€‚é€šè¿‡é‡ç”¨ç°æœ‰çš„çº¿ç¨‹è€Œä¸æ˜¯åˆ›å»ºæ–°çº¿ç¨‹ï¼Œå¯ä»¥å‡å°‘åœ¨çº¿ç¨‹åˆ›å»ºä¸é”€æ¯çš„å¼€é”€ã€‚å¦ä¸€ä¸ªå¥½å¤„æ˜¯è¯·æ±‚åˆ°æ¥æ—¶ï¼Œä¸ä¼šå†å› ä¸ºè¦ç­‰å¾…çº¿ç¨‹åˆ›å»ºè€Œå»¶è¿Ÿï¼Œä¹Ÿå°±æé«˜äº†å“åº”æ€§ã€‚é€šè¿‡é€‚å½“è°ƒæ•´çº¿ç¨‹æ± çš„å¤§å°ï¼Œå¯ä»¥åˆ›å»ºè¶³å¤Ÿå¤šçš„çº¿ç¨‹ä»¥ä¾¿å¤„ç†å™¨ä¿æŒå¿™ç¢ŒçŠ¶æ€ï¼ŒåŒæ—¶è¿˜å¯ä»¥é˜²æ­¢è¿‡å¤šçº¿ç¨‹äº’ç›¸ç«äº‰èµ„æºè€Œä½¿åº”ç”¨ç¨‹åºè€—å°½å†…å­˜ã€‚ ç±»åº“æä¾›äº†ä¸€ä¸ªçµæ´»çš„çº¿ç¨‹æ± ä»¥åŠä¸€äº›æœ‰ç”¨çš„é»˜è®¤é…ç½®ã€‚å¯ä»¥é€šè¿‡è°ƒç”¨Executorsä¸­çš„é™æ€å·¥å‚æ–¹æ³•ä¹‹ä¸€æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼š newFixedThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„çº¿ç¨‹æ± ï¼Œæ¯å½“æäº¤ä¸€ä¸ªä»»åŠ¡æ—¶å°±åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç›´åˆ°è¾¾åˆ°çº¿ç¨‹æ± çš„æœ€å¤§æ•°é‡ï¼Œè¿™æ—¶çº¿ç¨‹æ± çš„è§„æ¨¡å°†ä¸å†å˜åŒ–ã€‚ï¼ˆå¦‚æœæŸä¸ªçº¿ç¨‹ç”±äºå‘ç”Ÿäº†æœªé¢„æœŸçš„Exceptionè€Œç»“æŸï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¼šè¡¥å……ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼‰ã€‚ newCachedThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± çš„å½“å‰è§„æ¨¡è¶…è¿‡äº†å¤„ç†éœ€æ±‚æ—¶ï¼Œé‚£ä¹ˆå°†å›æ”¶ç©ºé—²çš„çº¿ç¨‹ï¼Œè€Œå½“éœ€æ±‚å¢åŠ æ—¶ï¼Œåˆ™å¯ä»¥æ·»åŠ æ–°çš„çº¿ç¨‹ï¼Œçº¿ç¨‹æ± çš„è§„æ¨¡ä¸å­˜åœ¨ä»»ä½•é™åˆ¶ã€‚ newSingleThreadExecutorï¼šæ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„Executorï¼Œå®ƒåˆ›å»ºå•ä¸ªå·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœè¿™ä¸ªçº¿ç¨‹å¼‚å¸¸ç»“æŸï¼Œä¼šåˆ›å»ºå¦ä¸€ä¸ªçº¿ç¨‹æ¥æ›¿ä»£ã€‚å®ƒèƒ½ç¡®ä¿ä¾ç…§ä»»åŠ¡åœ¨é˜Ÿåˆ—ä¸­çš„é¡ºåºæ¥ä¸²è¡Œæ‰§è¡Œã€‚ newScheduledThreadPoolï¼šåˆ›å»ºäº†ä¸€ä¸ªå›ºå®šé•¿åº¦çš„çº¿ç¨‹æ± ï¼Œè€Œä¸”ä»¥å»¶è¿Ÿæˆ–å®šæ—¶çš„æ–¹å¼æ‰§è¡Œä»»åŠ¡ï¼Œç±»ä¼¼äºTimerã€‚ ä»â€œä¸ºæ¯ä¸ªä»»åŠ¡åˆ†é…ä¸€ä¸ªçº¿ç¨‹â€ç­–ç•¥å˜ä¸ºåŸºäºçº¿ç¨‹æ± çš„ç­–ç•¥ï¼Œå°†å¯¹åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§äº§ç”Ÿé‡å¤§å½±å“ï¼šWebæœåŠ¡å™¨ä¸ä¼šå†åœ¨é«˜è´Ÿè½½æƒ…å†µä¸‹å¤±è´¥ã€‚ç”±äºæœåŠ¡å™¨ä¸ä¼šåˆ›å»ºæ•°åƒä¸ªçº¿ç¨‹æ¥äº‰å¤ºæœ‰é™çš„CPUå’Œå†…å­˜èµ„æºï¼Œå› æ­¤æœåŠ¡å™¨çš„æ€§èƒ½å°†å¹³ç¼“åœ°é™ä½ã€‚é€šè¿‡ä½¿ç”¨Executorï¼Œå¯ä»¥å®ç°å„ç§è°ƒä¼˜/ç®¡ç†/ç›‘è§†/è®°å½•æ—¥å¿—/é”™è¯¯æŠ¥å‘Šå’Œå…¶ä»–åŠŸèƒ½ï¼Œå¦‚æœä¸ä½¿ç”¨ä»»åŠ¡æ‰§è¡Œæ¡†æ¶ï¼Œé‚£ä¹ˆè¦å¢åŠ è¿™äº›åŠŸèƒ½æ˜¯éå¸¸å›°éš¾çš„ã€‚ Executorçš„ç”Ÿå‘½å‘¨æœŸExecutorçš„å®ç°é€šå¸¸ä¼šåˆ›å»ºçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä½†JVMåªæœ‰åœ¨æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹å…¨éƒ¨ç»ˆæ­¢ä¹‹åæ‰ä¼šé€€å‡ºï¼Œå¦‚æœæ— æ³•æ­£ç¡®å…³é—­Executorï¼Œé‚£ä¹ˆJVMå°†æ— æ³•ç»“æŸã€‚ ç”±äºExecutorä»¥å¼‚æ­¥æ–¹å¼æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå› æ­¤åœ¨ä»»ä½•æ—¶åˆ»ï¼Œä¹‹å‰æäº¤ä»»åŠ¡çš„çŠ¶æ€ä¸æ˜¯ç«‹å³å¯è§çš„ã€‚æœ‰äº›ä»»åŠ¡å¯èƒ½å·²ç»å®Œæˆï¼Œæœ‰äº›å¯èƒ½æ­£åœ¨è¿è¡Œï¼Œè€Œå…¶ä»–çš„ä»»åŠ¡å¯èƒ½åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œã€‚å½“å…³é—­åº”ç”¨ç¨‹åºæ—¶ï¼Œå¯èƒ½é‡‡ç”¨å¹³ç¼“çš„æ–¹å¼ï¼ˆå®Œæˆæ‰€æœ‰å·²ç»å¯åŠ¨çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¸å†æ¥å—ä»»ä½•æ–°çš„ä»»åŠ¡ï¼‰ï¼Œä¹Ÿå¯èƒ½é‡‡ç”¨ç²—æš´æ–¹å¼ï¼ˆç›´æ¥æ‰€æœ‰éƒ½å…³æ‰ï¼‰ã€‚Executorè§†ä¸ºåº”ç”¨ç¨‹åºæä¾›æœåŠ¡çš„ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿæ˜¯å¯å…³é—­çš„ï¼Œå¹¶æŠŠåœ¨å…³é—­æ“ä½œä¸­å—å½±å“çš„ä»»åŠ¡çš„çŠ¶æ€è¿”å›ç»™åº”ç”¨ç¨‹åºã€‚ ä¸ºäº†è§£å†³æ‰§è¡Œä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸé—®é¢˜ï¼ŒExecutorServiceæ¥å£æ‰©å±•äº†Executorï¼Œæ·»åŠ äº†ä¸€äº›ç”¨äºç”Ÿå‘½å‘¨æœŸç®¡ç†çš„æ–¹æ³•ï¼š12345678public interface ExecutorService extends Executor &#123; void shutdown(); List&lt;Runnable&gt; shutDownNow(); boolean isShutdown(); boolean isTerminated(); boolean awaitTermination(long timeout, TimeUnit unit) throws InterruptedException; // ......å…¶ä»–ç”¨äºä»»åŠ¡æäº¤çš„ä¾¿åˆ©æ–¹æ³•&#125; ExectuorServiceçš„ç”Ÿå‘½å‘¨æœŸæœ‰ä¸‰ç§çŠ¶æ€ï¼šè¿è¡Œã€å…³é—­å’Œå·²ç»ˆæ­¢ã€‚ExecutorServiceåœ¨åˆ›å»ºæ—¶å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œshutdownæ–¹æ³•æ‰§è¡Œä¼˜é›…åœ°å…³é—­:ä¸å†æ¥å—æ–°çš„ä»»åŠ¡ï¼ŒåŒæ—¶ç­‰å¾…å·²ç»æäº¤çš„ä»»åŠ¡æ‰§è¡Œå®Œæˆâ€“åŒ…æ‹¬é‚£äº›è¿˜æœªå¼€å§‹æ‰§è¡Œçš„ä»»åŠ¡ã€‚shutdownNowæ–¹æ³•æ‰§è¡Œç²—æš´çš„å…³é—­ï¼šå®ƒå°†å°è¯•å–æ¶ˆæ‰€æœ‰è¿è¡Œä¸­çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¸å†å¯åŠ¨é˜Ÿåˆ—ä¸­å°šæœªå¼€å§‹æ‰§è¡Œçš„ä»»åŠ¡ã€‚ ä¾‹å¦‚æ”¯æŒå…³é—­æ“ä½œçš„WebæœåŠ¡å™¨ï¼š12345678910111213141516171819202122232425262728293031323334class LifecycleWebServer &#123; private final ExecutorService exec = ...; public void start() throws IOException &#123; ServerSocket socket = new ServerSocket(80); while(!exec.isShutdown()) &#123; try &#123; final Socket conn = socket.accept(); exec.execute(new Runnable() &#123; public void run() &#123; handleRequest(conn); &#125; &#125; ); &#125; catch (RejectedExecutonException e) &#123; if (!exec.isShutdown()) &#123; log("task submission rejected", e); &#125; &#125; &#125; &#125; public void stop() &#123; exec.shutdown(); &#125; void handleRequest(Socket connection) &#123; Request req = readRequest(connection); if (isShutdownRequest(req)) &#123; stop(); &#125; else &#123; dispatchRequest(req); &#125; &#125;&#125; å»¶è¿Ÿä»»åŠ¡ä¸å‘¨æœŸä»»åŠ¡Timerç±»è´Ÿè´£ç®¡ç†å»¶è¿Ÿä»»åŠ¡ä»¥åŠå‘¨æœŸä»»åŠ¡ï¼Œç„¶è€Œï¼ŒTimerå­˜åœ¨ä¸€äº›ç¼ºé™·ï¼Œå› æ­¤åº”è¯¥è€ƒè™‘ä½¿ç”¨ScheduledThreadPoolExecutoræ¥ä»£æ›¿å®ƒï¼Œå¯ä»¥é€šè¿‡ScheduledThreadPoolExecutorçš„æ„é€ å‡½æ•°æˆ–Executors.newScheduledThreadPoolå·¥å‚æ–¹æ³•æ¥åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡ã€‚å®ƒå¾ˆå°‘è¢«ä½¿ç”¨ï¼Œä¸»è¦çš„ç¼ºé™·æœ‰ï¼š Timeåœ¨æ‰§è¡Œæ‰€æœ‰å®šæ—¶ä»»åŠ¡æ—¶åªä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œä¼šç ´åå…¶ä»–TimeTaskçš„å®šæ—¶ç²¾ç¡®æ€§ã€‚ å¦‚æœTimeTaskæŠ›å‡ºä¸€ä¸ªæœªæ£€æŸ¥çš„å¼‚å¸¸ï¼Œé‚£ä¹ˆTimeå°†è¡¨ç°å‡ºç³Ÿç³•çš„è¡Œä¸ºã€‚ æ‰¾å‡ºå¯åˆ©ç”¨çš„å¹¶è¡Œæ€§ä¸‹é¢å°†å±•ç¤ºä¸€ä¸ªé€æ­¥åˆ©ç”¨å¹¶è¡Œæ€§çš„æµè§ˆå™¨ç¨‹åºä¸­çš„é¡µé¢æ¸²æŸ“åŠŸèƒ½ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†HTMlé¡µé¢å›æ‰§åˆ°å›¾åƒç¼“å­˜ä¸­ã€‚ æœ€ç®€å•çš„æ–¹æ³•æ˜¯å¯¹HTMLæ–‡æ¡£è¿›è¡Œä¸²è¡Œå¤„ç†ï¼Œé‡åˆ°å›¾åƒå¼•ç”¨ï¼Œå°±é€šè¿‡ç½‘ç»œè·å–å®ƒï¼Œç„¶åå†å°†å…¶ç»˜åˆ¶åˆ°å›¾åƒç¼“å­˜ä¸­ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚ å¦ä¸€ç§ä¸²è¡Œæ–¹å¼æ˜¯å…ˆç»˜åˆ¶æ–‡æœ¬å…ƒç´ ï¼Œç„¶åå†å¼€å§‹ä¸‹è½½å›¾åƒï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š12345678910111213// å›¾ç‰‡ä¸‹è½½è¿‡ç¨‹çš„éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯åœ¨ç­‰å¾…I/Oæ“ä½œæ‰§è¡Œå®Œæˆï¼Œæ²¡æœ‰å……åˆ†åˆ©ç”¨CPUpublic class SingleThreadRenderer &#123; void renderPage(CharSequence source) &#123; renderText(source); List&lt;ImageData&gt; imageData = new ArrayList&lt;ImageData&gt;(); for (ImageInfo imageInfo : scanForImageInfo(source)) &#123; imageData.add(imageInfo.downloadImage()); &#125; for (ImageData data : imageData) &#123; renderImage(data); &#125; &#125;&#125; Executorä½¿ç”¨Runnableä½œä¸ºå…¶åŸºæœ¬çš„ä»»åŠ¡è¡¨ç¤ºå½¢å¼ï¼Œä½†æ˜¯Runnableæ˜¯ä¸€ç§æœ‰å¾ˆå¤§å±€é™çš„æŠ½è±¡ï¼Œè™½ç„¶runèƒ½å†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶æˆ–è€…å°†ç»“æœæ”¾å…¥åˆ°æŸä¸ªå…±äº«çš„æ•°æ®ç»“æ„ï¼Œä½†å®ƒä¸èƒ½è¿”å›ä¸€ä¸ªå€¼æˆ–æŠ›å‡ºä¸€ä¸ªå—æ£€æŸ¥çš„å¼‚å¸¸ã€‚ è®¸å¤šä»»åŠ¡å®é™…ä¸Šéƒ½æ˜¯å­˜åœ¨å»¶è¿Ÿçš„è®¡ç®—â€”â€” æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œä»ç½‘ç»œä¸Šè·å–èµ„æºï¼Œæˆ–è€…è®¡ç®—æŸä¸ªå¤æ‚çš„åŠŸèƒ½ã€‚å¯¹äºè¿™äº›ä»»åŠ¡ï¼ŒCallableæ˜¯ä¸€ç§æ›´å¥½çš„æŠ½è±¡ï¼šå®ƒè®¤ä¸ºä¸»å…¥å£ç‚¹ï¼ˆå³callï¼‰å°†è¿”å›ä¸€ä¸ªå€¼ï¼Œå¹¶å¯èƒ½æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ Runnableå’ŒCallableæè¿°çš„éƒ½æ˜¯æŠ½è±¡çš„è®¡ç®—ä»»åŠ¡ã€‚è¿™äº›ä»»åŠ¡é€šå¸¸éƒ½æ˜¯æœ‰èŒƒå›´çš„ï¼Œå³éƒ½æœ‰ä¸€ä¸ªæ˜ç¡®çš„èµ·ç‚¹ï¼Œå¹¶ä¸”æœ€ç»ˆä¼šç»“æŸã€‚Executoræ‰§è¡Œçš„ä»»åŠ¡åˆå››ä¸ªç”Ÿå‘½å‘¨æœŸé˜¶æ®µï¼šåˆ›å»º/æäº¤/å¼€å§‹/å®Œæˆã€‚ç”±äºæœ‰äº›ä»»åŠ¡å¯èƒ½è¦æ‰§è¡Œå¾ˆé•¿çš„æ—¶é—´ï¼Œå› æ­¤é€šå¸¸å¸Œæœ›èƒ½å¤Ÿå–æ¶ˆè¿™äº›ä»»åŠ¡ã€‚åœ¨Executoræ¡†æ¶ä¸­ï¼Œå·²æäº¤ä½†å°šæœªå¼€å§‹çš„ä»»åŠ¡å¯ä»¥å–æ¶ˆï¼Œä½†å¯¹äºé‚£äº›å·²ç»å¼€å§‹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œåªæœ‰å½“å®ƒä»¬å“åº”ä¸­æ–­æ—¶ï¼Œæ‰èƒ½å–æ¶ˆã€‚ Futureè¡¨ç¤ºä¸€ä¸ªä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶æä¾›äº†ç›¸åº”çš„æ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦å·²ç»å®Œæˆæˆ–å–æ¶ˆï¼Œä»¥åŠè·å–ä»»åŠ¡çš„ç»“æœå’Œå–æ¶ˆä»»åŠ¡ç­‰ã€‚åœ¨Futureè§„èŒƒä¸­åŒ…å«çš„éšå«æ„ä¹‰æ˜¯ï¼Œä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸåªèƒ½å‰è¿›ï¼Œä¸èƒ½åé€€ã€‚å½“æŸä¸ªä»»åŠ¡å®Œæˆåï¼Œå®ƒå°±æ°¸è¿œåœç•™åœ¨â€œå®Œæˆâ€çŠ¶æ€ä¸Šã€‚ å¯ä»¥é€šè¿‡è®¸å¤šæ–¹æ³•åˆ›å»ºä¸€ä¸ªFutureæ¥æè¿°ä»»åŠ¡ã€‚ExecutorServiceä¸­çš„æ‰€æœ‰submitæ–¹æ³•éƒ½å°†è¿”å›ä¸€ä¸ªFutureï¼Œä»è€Œå°†ä¸€ä¸ªRunnableæˆ–Callableæäº¤ç»™Executorï¼Œå¹¶å¾—åˆ°ä¸€ä¸ªFutureç”¨æ¥è·å¾—ä»»åŠ¡çš„æ‰§è¡Œç»“æœæˆ–è€…å–æ¶ˆä»»åŠ¡ã€‚è¿˜å¯ä»¥æ˜¾å¼åœ°ä¸ºæŸä¸ªæŒ‡å®šçš„Runnableæˆ–Callableå®ä¾‹åŒ–ä¸€ä¸ªFutureTaskã€‚ 123456789101112131415161718192021222324252627282930313233343536373839// FutureReadererä½¿å¾—æ¸²æŸ“æ–‡æœ¬ä¸ä¸‹è½½å›¾åƒæ•°æ®çš„ä»»åŠ¡å¹¶å‘æ‰§è¡Œpublic class FutureRenderer &#123; // 1.åˆ›å»ºExecutorService ExecutorService executorService = Executors.newCachedThreadPool(); void renderPage(CharSequence source) &#123; final List&lt;ImageInfo&gt; imageInfos = scanFooImageInfo(source); // 2.åˆ›å»ºCallableä»»åŠ¡ Callable&lt;List&lt;ImageData&gt;&gt; task = new Callable&lt;List&lt;ImageData&gt;&gt;() &#123; public List&lt;ImageData&gt; call() &#123; List&lt;ImageData&gt; result = new ArrayList&lt;ImageData&gt;(); for (ImageInfo imageInfo : imageInfos) &#123; result.add(imageInfo); &#125; return result; &#125; &#125;; // 3. æäº¤Callableä»»åŠ¡ï¼Œè·å¾—Future Future&lt;List&lt;ImageData&gt;&gt; future = (Future) executorService.submit(task); // æ¸²æŸ“æ–‡æœ¬ renderText(source); // 4. è°ƒç”¨getè·å–ç»“æœï¼Œå¹¶å¤„ç†å¼‚å¸¸ try &#123; List&lt;ImageData&gt; imageData = future.get(); for (imageData data : imageData) &#123; RenderableImage(data); &#125; &#125; catch (InterruptedException e) &#123; Thread.currentThread().interrupt(); future.cancel(true); &#125; catch (ExecutionException e) &#123; throw launderThrowable(e.getCause()); &#125; &#125;&#125; getæ–¹æ³•çš„è¡Œä¸ºå–å†³äºä»»åŠ¡çš„çŠ¶æ€ï¼ˆå°šæœªå¼€å§‹ï¼Œæ­£åœ¨æ‰§è¡Œï¼Œå·²å®Œæˆï¼‰ã€‚å¦‚æœä»»åŠ¡å·²ç»å®Œæˆï¼Œé‚£ä¹ˆgetä¼šç«‹å³è¿”å›æˆ–è€…æŠ›å‡ºä¸€ä¸ªExceptionï¼Œå¦‚æœä»»åŠ¡æ²¡æœ‰å®Œæˆï¼Œé‚£ä¹ˆgetå°†é˜»å¡å¹¶ç›´åˆ°ä»»åŠ¡å®Œæˆã€‚å¦‚æœä»»åŠ¡æŠ›å‡ºäº†å¼‚å¸¸ï¼Œé‚£ä¹ˆgetå°†è¯¥å¼‚å¸¸å°è£…ä¸ºExecutionExceptionå¹¶é‡æ–°æŠ›å‡ºã€‚å¦‚æœä»»åŠ¡è¢«å–æ¶ˆï¼Œé‚£ä¹ˆgetå°†æŠ›å‡ºCancellationExceptionã€‚ å¦‚æœå°†ä¸¤ä¸ªä»»åŠ¡Aå’ŒBåˆ†é…ç»™ä¸¤ä¸ªå·¥äººï¼Œä½†Açš„æ‰§è¡Œæ—¶é—´æ˜¯Bçš„10å€ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹ä¹Ÿåªèƒ½åŠ é€Ÿ9%ã€‚æœ€åï¼Œå½“åœ¨å¤šä¸ªå·¥äººä¹‹é—´åˆ†è§£ä»»åŠ¡æ—¶ï¼Œè¿˜éœ€è¦ä¸€å®šçš„ä»»åŠ¡åè°ƒå¼€é”€ï¼šä¸ºäº†ä½¿ä»»åŠ¡åˆ†è§£èƒ½æé«˜æ€§èƒ½ï¼Œè¿™ç§å¼€é”€ä¸èƒ½é«˜äºå¹¶è¡Œæ€§å®ç°çš„æå‡ã€‚æ‰€ä»¥åªæœ‰å½“å¤§é‡äº’ç›¸ç‹¬ç«‹ä¸”åŒæ„çš„ä»»åŠ¡å¯ä»¥å¹¶å‘è¿›è¡Œå¤„ç†æ—¶ï¼Œæ‰èƒ½ä½“ç°å‡ºå°†ç¨‹åºçš„å·¥ä½œè´Ÿè½½åˆ†é…åˆ°å¤šä¸ªä»»åŠ¡ä¸­å¸¦æ¥çš„çœŸæ­£æ€§èƒ½æå‡ã€‚ å¦‚æœå‘Executoræäº¤äº†ä¸€ç»„è®¡ç®—ä»»åŠ¡ï¼Œå¹¶ä¸”å¸Œæœ›åœ¨è®¡ç®—å®Œæˆåè·å¾—ç»“æœï¼Œé‚£ä¹ˆå¯ä»¥ä¿ç•™ä¸æ¯ä¸ªä»»åŠ¡å…³è”çš„Futureï¼Œç„¶ååå¤ä½¿ç”¨getæ–¹æ³•ï¼ŒåŒæ—¶å°†å‚æ•°timeoutæŒ‡å®šä¸º0ï¼Œä»è€Œé€šè¿‡è½®è®­æ¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å®Œæˆã€‚è¿™ç§æ–¹æ³•è™½ç„¶å¯è¡Œï¼Œä½†æœ‰äº›ç¹çã€‚å¹¸å¥½æœ‰CompletionServiceï¼ˆå®ŒæˆæœåŠ¡ï¼‰ã€‚ CompetionServiceå°†Executorå’ŒBlockingQueueçš„åŠŸèƒ½èåˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥å°†Callableä»»åŠ¡æäº¤ç»™å®ƒæ¥æ‰§è¡Œï¼Œç„¶åä½¿ç”¨ç±»ä¼¼äºé˜Ÿåˆ—æ“ä½œçš„takeå’Œpollç­‰æ–¹æ³•æ¥è·å¾—å·²å®Œæˆçš„ç»“æœï¼Œè€Œè¿™äº›ç»“æœä¼šåœ¨å®Œæˆæ—¶è¢«å°è£…ä¸ºFutureã€‚ExecutorCompletionServiceå®ç°äº†CompletionServiceï¼Œå¹¶å°†è®¡ç®—éƒ¨åˆ†å§”æ‰˜ç»™ä¸€ä¸ªExecutorã€‚123456789101112131415161718192021222324252627282930313233343536// é€šè¿‡CompletionServiceä»ä¸¤æ–¹é¢æ¥æé«˜é¡µé¢æ¸²æŸ“å™¨çš„æ€§èƒ½ï¼šç¼©çŸ­æ€»è¿è¡Œæ—¶é—´ä»¥åŠæé«˜å“åº”æ€§ã€‚å…¶å®ç°æ˜¯ä¸ºæ¯ä¸€å¹…å›¾åƒéƒ½åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ä»»åŠ¡ã€‚public class Renderer &#123; // 1.åˆ›å»ºä¸€ä¸ªExecutorService private final ExecutorService executorService = Executors.newCachedThreadPool(); Renderer(ExecutorService executor) &#123; this.executor = executor; &#125; void renderPage (CharSequence source) &#123; List&lt;ImageInfo&gt; info = scanForImageInfo(source); // 2. åˆ›å»ºExecutorCompletionService CompletionService&lt;ImageData&gt; completionService = new ExecutorCompletionService&lt;ImageData&gt;(executorService); // 3. ä¸ºæ¯å¹…å›¾ç‰‡åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ä»»åŠ¡ for(final ImageInfo imageInfo: info) &#123; completionService.submit(new Callable&lt;ImageData&gt;() &#123; public ImageData call() &#123; return imageInfo.downloadImage(); &#125; &#125;); &#125; // æ¸²æŸ“æ–‡æœ¬ renderText(source); // 4. è·å–Futureï¼Œè°ƒç”¨get try &#123; for(int i=0, n=info.size(); t&lt;n; t++) &#123; Future&lt;ImageData&gt; future = completionService.take(); ImageData imageData = future.get(); RenderImage(imageData); &#125; &#125; catch (InterruptedException e) &#123; Thread.currentThread().interrupt(); &#125; catch (ExecutionException e) &#123; throw launderThrowable(e.getCause()); &#125; &#125;&#125; æœ‰æ—¶å€™ï¼Œå¦‚æœæŸä¸ªä»»åŠ¡æ— æ³•åœ¨æŒ‡å®šæ—¶é—´å†…å®Œæˆï¼Œé‚£ä¹ˆå°†ä¸å†éœ€è¦å®ƒçš„ç»“æœï¼Œæ­¤æ—¶å¯ä»¥æ”¾å¼ƒè¿™ä¸ªä»»åŠ¡ã€‚åœ¨æ”¯æŒæ—¶é—´é™åˆ¶çš„Future.getä¸­æ”¯æŒè¿™ç§éœ€æ±‚ï¼šå½“ç»“æœå¯ç”¨æ—¶ï¼Œå®ƒå°†ç«‹å³è¿”å›ï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é™å†…æ²¡æœ‰è®¡ç®—å‡ºç»“æœï¼Œé‚£ä¹ˆå°†æŠ›å‡ºTimeoutExceptionã€‚åœ¨ä½¿ç”¨é™æ—¶ä»»åŠ¡æ—¶éœ€è¦æ³¨æ„ï¼Œå½“è¿™äº›ä»»åŠ¡è¶…æ—¶ååº”è¯¥ç«‹å³åœæ­¢ï¼Œä»è€Œé¿å…ä¸ºç»§ç»­è®¡ç®—ä¸€ä¸ªä¸å†ä½¿ç”¨çš„ç»“æœè€Œæµªè´¹è®¡ç®—èµ„æºã€‚Futureå¦‚æœä¸€ä¸ªé™æ—¶çš„getæ–¹æ³•æŠ›å‡ºäº†TimeoutExceptionï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡Futureæ¥å–æ¶ˆä»»åŠ¡ã€‚1234567891011121314151617Page renderPageWithAd() throws InterruptedException &#123; long endNanos = System.nanoTime() + TIME_BUDGET; Future&lt;Ad&gt; future = exec.submit(new FetchAdTask()); Page page = renderPageBody(); Ad ad; try &#123; long timeLeft = endNanos - System.nanoTime(); ad = f.get(timeLeft, NANOSECONDS); // è®¾å®šæ—¶é—´ &#125; catch (ExecutionException e) &#123; ad = DEFAULT_AD; &#125; catch (TimeoutException e) &#123; ad = DEFAULT_AD; f.cancel(true); //å–æ¶ˆä»»åŠ¡ &#125; page.setAd(ad); return page;&#125; æ€»ç»“Executoræ¡†æ¶å¯ä»¥å°†ä»»åŠ¡æäº¤ä¸æ‰§è¡Œç­–ç•¥è§£è€¦å¼€æ¥ï¼Œå½“éœ€è¦åˆ›å»ºçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Executorï¼ŒåŒæ—¶è€ƒè™‘Callableå’ŒFutureã€‚è¦æƒ³å°†åº”ç”¨ç¨‹åºåˆ†è§£ä¸ºä¸åŒçš„ä»»åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ï¼Œå¿…é¡»å®šä¹‰æ¸…æ™°çš„ä»»åŠ¡è¾¹ç•Œã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_4_åŸºç¡€æ„å»ºæ¨¡å—]]></title>
    <url>%2F2018%2F01%2F14%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-4-%E5%9F%BA%E7%A1%80%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9D%97%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šJDKæä¾›çš„ä¸œè¥¿æ•ˆç‡åº”è¯¥æ˜¯å¯ä»¥ä¿è¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å­¦ä¼šå»ä½¿ç”¨JDKè‡ªå¸¦çš„å¹¶å‘åŸºç¡€æ„å»ºæ¨¡å—ï¼Œä»¥åŠç†è§£åœ¨ä½¿ç”¨è¿™äº›æ¨¡å—æ¥æ„å»ºåº”ç”¨ç¨‹åºæ—¶çš„ä¸€äº›å¸¸ç”¨æ¨¡å¼ã€‚ åŒæ­¥å®¹å™¨ç±»åŒæ­¥å®¹å™¨ç±»åŒ…æ‹¬Vectorå’ŒHashtableã€‚è¿™äº›ç±»å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼æ˜¯ï¼šå°†ä»–ä»¬çš„çŠ¶æ€å°è£…èµ·æ¥ï¼Œå¹¶å¯¹æ¯ä¸ªå…¬æœ‰æ–¹æ³•éƒ½è¿›è¡ŒåŒæ­¥ï¼Œä½¿å¾—æ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®å®¹å™¨çš„çŠ¶æ€ã€‚ åŒæ­¥å®¹å™¨ç±»çš„é—®é¢˜å…ˆçœ‹ä¸‹é¢çš„ä»£ç ï¼š123456789public static Object getLast(Vector list) &#123; int lastIndex = list.size() - 1; return list.get(lastIndex);&#125;public static void deleteLast(Vector list) &#123; int lastIndex = list.size() - 1; list.remove(lastIndex);&#125; è¿™äº›æ–¹æ³•çœ‹èµ·æ¥æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœçº¿ç¨‹Aåœ¨æ‰§è¡ŒdeleteLast, çº¿ç¨‹Båœ¨æ‰§è¡ŒgetLastï¼Œlistä¸­æœ‰10ä¸ªå…ƒç´ ï¼Œåˆšå¥½Båœ¨æ‰§è¡Œlist.size()å’Œget(lastIndex)ä¹‹é—´ï¼Œçº¿ç¨‹Aæ‰§è¡Œå®Œäº†remove(lastIndex), é‚£ä¹ˆçº¿ç¨‹Båœ¨æ‰§è¡Œget(lastIndex)æ—¶å°±ä¼šæŠ›å‡ºArrayIndexOutOfBoundsExceptionã€‚ ç”±äºåŒæ­¥å®¹å™¨ç±»è¦éµå®ˆåŒæ­¥ç­–ç•¥ï¼Œå³å®¢æˆ·ç«¯åŠ é”ï¼Œå› æ­¤åœ¨åˆ›å»ºä¸€äº›æ–°çš„æ“ä½œæ—¶ï¼Œåªè¦æˆ‘ä»¬çŸ¥é“åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªé”ï¼Œé‚£ä¹ˆè¿™äº›æ–°æ“ä½œå°±ä¸å®¹å™¨çš„å…¶ä»–æ“ä½œä¸€æ ·éƒ½æ˜¯åŸå­æ“ä½œã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼š12345678910111213public static Object getLast(Vector list) &#123; synchronized(list) &#123; int lastIndex = list.size() - 1; return list.get(lastIndex); &#125;&#125;public static void deleteLast(Vector list) &#123; synchronized(list) &#123; int lastIndex = list.size() - 1; list.remove(lastIndex); &#125;&#125; åœ¨è°ƒç”¨sizeå’Œç›¸åº”çš„getä¹‹é—´ï¼ŒVectorçš„é•¿åº¦å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™ç§é£é™©åœ¨å¯¹Vectorä¸­çš„å…ƒç´ è¿›è¡Œè¿­ä»£æ—¶ä»ç„¶ä¼šå‡ºç°ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š12345// å¯èƒ½æŠ›å‡ºArrayIndexOutOfBoundsExceptionçš„è¿­ä»£æ“ä½œfor (int i = 0; i &lt; vector.size(); i++) &#123; doSomething(vetor.get(i));&#125; æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨å®¢æˆ·ç«¯åŠ é”æ¥è§£å†³ä¸å¯é è¿­ä»£çš„é—®é¢˜ï¼Œä½†æ˜¯è¦ç‰ºç‰²ä¸€äº›ä¼¸ç¼©æ€§ã€‚é€šè¿‡åœ¨è¿­ä»£æœŸé—´æŒæœ‰Vectorçš„é”ï¼Œå¯ä»¥é˜²æ­¢å…¶ä»–çº¿ç¨‹åœ¨è¿­ä»£æœŸé—´ä¿®æ”¹Vectorã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼š12345synchronized (vector) &#123; for (int i = 0; i &lt; vector.size(); i++) &#123; doSomething(vetor.get(i)); &#125;&#125; è¿­ä»£å™¨ä¸ConcurrentModificationExceptionå¯¹å®¹å™¨ç±»è¿›è¡Œè¿­ä»£çš„æ ‡å‡†æ–¹å¼æ˜¯ä½¿ç”¨Iteratorï¼Œç„¶è€Œï¼Œå¦‚æœæœ‰å…¶ä»–çº¿ç¨‹å¹¶å‘åœ°ä¿®æ”¹å®¹å™¨ï¼Œé‚£ä¹ˆå³ä½¿æ˜¯ä½¿ç”¨è¿­ä»£å™¨ä¹Ÿæ— æ³•é¿å…åœ°éœ€è¦åœ¨åŒæ­¥å®¹å™¨ä¸ŠåŠ é”ã€‚åœ¨è®¾è®¡åŒæ­¥å®¹å™¨ç±»çš„è¿­ä»£å™¨æ—¶å¹¶æ²¡æœ‰è€ƒè™‘åˆ°å¹¶å‘ä¿®æ”¹çš„é—®é¢˜ï¼Œå®ƒä»¬çš„è¿­ä»£å™¨æ˜¯â€œåŠæ—¶å¤±è´¥â€çš„ï¼Œæ‰€ä»¥å½“å®ƒä»¬å‘ç°å®¹å™¨åœ¨è¿­ä»£è¿‡ç¨‹ä¸­å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªConcurrentModificationExceptionå¼‚å¸¸ã€‚è¿™ç§fail-fastæœºåˆ¶å¹¶ä¸æ˜¯ä¸€ç§å®Œå¤‡çš„å¤„ç†æœºåˆ¶ï¼Œè€Œåªæ˜¯â€œå–„æ„åœ°â€æ•è·å¹¶å‘é”™è¯¯ï¼Œå› æ­¤åªèƒ½ä½œä¸ºå¹¶å‘é—®é¢˜çš„é¢„è­¦æŒ‡ç¤ºå™¨ã€‚å®ƒä»¬é‡‡å–çš„å®ç°æ–¹å¼æ˜¯å°†è®¡æ•°å™¨å˜åŒ–ä¸å®¹å™¨å…³è”èµ·æ¥ï¼šå¦‚æœåœ¨è¿­ä»£æœŸé—´è®¡æ•°å™¨è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆhasNextæˆ–nextå°†æŠ›å‡ºConcurrentModificationExceptionã€‚ç„¶è€Œï¼Œè¿™ç§æ£€æŸ¥æ˜¯åœ¨æ²¡æœ‰åŒæ­¥çš„æƒ…å†µä¸‹è¿›è¡Œçš„ï¼Œå› æ­¤å¯èƒ½ä¼šçœ‹åˆ°å¤±æ•ˆçš„å€¼ï¼Œè€Œè¿­ä»£å™¨å¯èƒ½å¹¶æ²¡æœ‰æ„è¯†åˆ°å·²ç»å‘ç”Ÿäº†ä¿®æ”¹ã€‚è¦æƒ³é¿å…å‡ºç°ConcurrentModificationExceptionï¼Œå°±å¿…é¡»åœ¨è¿­ä»£è¿‡ç¨‹ä¸­æŒæœ‰å®¹å™¨çš„é”ã€‚ ç„¶è€Œï¼Œæœ‰æ—¶å€™å¼€å‘äººå‘˜å¹¶ä¸å¸Œæœ›åœ¨è¿­ä»£å™¨é—´å¯¹å®¹å™¨åŠ é”ã€‚ä¾‹å¦‚ï¼ŒæŸäº›çº¿ç¨‹åœ¨å¯ä»¥è®¿é—®å®¹å™¨ä¹‹å‰ï¼Œå¿…é¡»ç­‰å¾…è¿­ä»£è¿‡ç¨‹ç»“æŸï¼Œå¦‚æœå®¹å™¨è§„æ¨¡å¾ˆå¤§ï¼Œæˆ–è€…åœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œæ“ä½œçš„æ—¶é—´å¾ˆé•¿ï¼Œé‚£ä¹ˆè¿™äº›çº¿ç¨‹å°±éœ€è¦é•¿æ—¶é—´ç­‰å¾…ã€‚æŒæœ‰é”çš„æ—¶é—´è¶Šé•¿ï¼Œé‚£ä¹ˆåœ¨é”ä¸Šçš„ç«äº‰å°±è¶Šæ¿€çƒˆï¼Œå¦‚æœè®¸å¤šçº¿ç¨‹éƒ½åœ¨ç­‰å¾…é”è¢«é‡Šæ”¾ï¼Œé‚£ä¹ˆå°†æå¤§åœ°é™ä½ååé‡å’ŒCPUçš„åˆ©ç”¨ç‡ã€‚ å¦ä¸€ç§æ›¿ä»£æ–¹æ³•æ˜¯â€œå…‹éš†â€å®¹å™¨ï¼Œå¹¶åœ¨å‰¯æœ¬ä¸Šè¿›è¡Œè¿­ä»£ã€‚ç”±äºå‰¯æœ¬è¢«å°é—­åœ¨çº¿ç¨‹å†…ï¼Œå› æ­¤å…¶ä»–çº¿ç¨‹ä¸ä¼šåœ¨è¿­ä»£æœŸé—´å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ ·å°±é¿å…äº†æŠ›å‡ºConcurrentModificationExceptionï¼Œä¸è¿‡åœ¨å…‹éš†è¿‡ç¨‹ä¸­ä»ç„¶è¦åŠ é”ï¼ˆä»¥é˜²åœ¨æ­¤æœŸé—´è¢«å…‹éš†å®¹å™¨è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼Œé‚£æ ·å…‹éš†å‡ºæ¥çš„å®¹å™¨å°±æ˜¯å¤±æ•ˆçš„å®¹å™¨ï¼‰ï¼Œæ‰€ä»¥ä¹Ÿä¼šå¢åŠ æ€§èƒ½å¼€é”€ã€‚æ‰€ä»¥è¿™ç§æ–¹æ³•çš„å¥½åå–å†³äºå¤šä¸ªå› ç´ ï¼šå®¹å™¨çš„å¤§å°ï¼Œåœ¨æ¯ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œçš„æ“ä½œï¼Œè¿­ä»£æ“ä½œç›¸å¯¹äºå®¹å™¨ä¸Šå…¶ä»–æ“ä½œè¢«è°ƒç”¨çš„é¢‘ç‡ï¼Œä»¥åŠåœ¨å“åº”æ—¶é—´å’Œååé‡ç­‰æ–¹é¢çš„éœ€æ±‚ã€‚ éšè—è¿­ä»£å™¨è™½ç„¶åŠ é”å¯ä»¥é˜²æ­¢è¿­ä»£å™¨æŠ›å‡ºConcurrentModificationExceptionï¼Œä½†å¿…é¡»è®°ä½åœ¨æ‰€æœ‰å¯¹å…±äº«å®¹å™¨è¿›è¡Œè¿­ä»£çš„åœ°æ–¹éƒ½éœ€è¦åŠ é”ã€‚å®é™…æƒ…å†µæ›´å¤æ‚ï¼Œå› ä¸ºåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿­ä»£å™¨ä¼šéšè—èµ·æ¥ã€‚ å¦‚ä¸‹ä¾‹ï¼Œæ ‡å‡†å®¹å™¨çš„toStringæ–¹æ³•å°†è¿­ä»£å®¹å™¨ï¼Œå¹¶åœ¨æ¯ä¸ªå…ƒç´ ä¸Šè°ƒç”¨toStringæ¥ç”Ÿæˆå®¹å™¨å†…å®¹çš„æ ¼å¼åŒ–è¡¨ç¤ºï¼š123456789101112131415161718public class HiddenIterator &#123; @GuardedBy("this") private final Set&lt;Integer&gt; set = new HashSet&lt;Integer&gt;(); public synchronized void add(Integer i) &#123; set.add(i); &#125; public synchronized void remove(Integer i) &#123; set.remove(i); &#125; public void addTenThing() &#123; Random r = new Random(); for (int i=0; i&lt; 10; i++) &#123; set.add(r.nextInt()); &#125; System.out.println("DEBUG: added ten elements to " + set); &#125;&#125; addTenThingsæ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºConcurrentModificationExceptionï¼Œå› ä¸ºtoStringå¯¹setè¿›è¡Œäº†è¿­ä»£ï¼Œè€Œä¸”æ²¡åŠ é”ã€‚å¦‚æœçŠ¶æ€ä¸ä¿æŠ¤å®ƒçš„åŒæ­¥ä»£ç ä¹‹é—´ç›¸éš”è¶Šè¿œï¼Œé‚£å¼€å‘äººå‘˜å°±è¶Šå®¹æ˜“å¿˜è®°åœ¨è®¿é—®çŠ¶æ€æ—¶ä½¿ç”¨æ­£ç¡®çš„åŒæ­¥ã€‚å¦‚æœHiddenIteratorç”¨synchronizedSetæ¥åŒ…è£…HashSetï¼Œå¹¶ä¸”å¯¹åŒæ­¥ä»£ç è¿›è¡Œå°è£…ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæŠ›å‡ºå¼‚å¸¸äº†ã€‚å®¹å™¨çš„hashCodeå’Œequalsç­‰æ–¹æ³•ä¹Ÿä¼šé—´æ¥åœ°æ‰§è¡Œè¿­ä»£æ“ä½œï¼ŒåŒæ ·ï¼ŒcontainsAll, removeAllå’ŒretainAllç­‰æ–¹æ³•ï¼Œä»¥åŠæŠŠå®¹å™¨ä½œä¸ºå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œéƒ½ä¼šå¯¹å®¹å™¨è¿›è¡Œè¿­ä»£ï¼Œæ‰€æœ‰è¿™äº›é—´æ¥çš„è¿­ä»£æ“ä½œéƒ½å¯èƒ½æŠ›å‡ºConcurrentModificationExceptionã€‚ å¹¶å‘å®¹å™¨åŒæ­¥å®¹å™¨å°†æ‰€æœ‰å¯¹å®¹å™¨çŠ¶æ€çš„è®¿é—®éƒ½ä¸²è¡ŒåŒ–ï¼Œä»¥å®ç°å®ƒä»¬çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œè¿™æ ·çš„ä»£ä»·å°±æ˜¯ä¸¥é‡é™ä½å¹¶å‘æ€§ï¼Œå½“å¤šä¸ªçº¿ç¨‹ç«äº‰å®¹å™¨çš„é”æ—¶ï¼Œååé‡å°†ä¸¥é‡é™ä½ã€‚Java 5.0æä¾›äº†å¤šç§å¹¶å‘å®¹å™¨ç±»æ¥æ”¹è¿›åŒæ­¥å®¹å™¨çš„æ€§èƒ½ã€‚é€šè¿‡å¹¶å‘å®¹å™¨æ¥ä»£æ›¿åŒæ­¥å®¹å™¨ï¼Œå¯ä»¥æå¤§åœ°æé«˜ä¼¸ç¼©æ€§å¹¶é™ä½é£é™©ã€‚ Java 5.0å¢åŠ äº†ConcurrentHashMapï¼Œç”¨æ¥æ›¿ä»£åŸºäºhashçš„åŒæ­¥mapï¼Œå¢åŠ äº†CopyOnWriteArrayListï¼Œç”¨æ¥æ›¿ä»£ä»¥éå†æ“ä½œä¸ºä¸»è¦æ“ä½œçš„åŒæ­¥Listã€‚åœ¨æ–°çš„ConcurrentMapæ¥å£ä¸­å¢åŠ äº†ä¸€äº›å¸¸ç”¨çš„å¤åˆæ“ä½œï¼Œä¾‹å¦‚â€œputIfAbsentâ€,replace, å’Œ conditional removeã€‚ Java 5.0è¿˜å¢åŠ äº†ä¸¤ä¸ªæ–°çš„é›†åˆç±»å‹ï¼ŒQueueå’ŒBlockingQueueã€‚ Java 6.0å¢åŠ äº†ConcurrentSkipListMapæ¥æ›¿æ¢åŒæ­¥çš„SortedMapï¼Œå¢åŠ äº†ConcurrentSkipListSetæ›¿æ¢SortedSetï¼ˆä¾‹å¦‚TreeMapå’ŒTreeSetï¼‰ ConcurrentHashMapä¸HashMapä¸€æ ·ï¼ŒConcurrentHashMapä¹Ÿæ˜¯ä¸€ä¸ªåŸºäºHashCodeçš„Mapï¼Œä½†å®ƒä½¿ç”¨äº†ä¸€ç§å®Œå…¨ä¸åŒçš„åŠ é”ç­–ç•¥æ¥æä¾›æ›´é«˜çš„å¹¶å‘æ€§å’Œä¼¸ç¼©æ€§ã€‚ConcurrentHashMapå¹¶ä¸æ˜¯å°†æ¯ä¸ªæ–¹æ³•éƒ½åœ¨åŒä¸€æŠŠé”ä¸ŠåŒæ­¥å¹¶ä½¿å¾—æ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®å®¹å™¨ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªç§ç²’åº¦æ›´ç»†çš„åŠ é”æœºåˆ¶æ¥æ—¶é—´å…±äº«ï¼Œå«åšåˆ†æ®µé”ã€‚åœ¨è¿™ç§æœºåˆ¶ä¸‹ï¼Œä»»æ„æ•°é‡çš„è¯»å–çº¿ç¨‹å¯ä»¥å¹¶å‘åœ°è®¿é—®è¿™ä¸ªmapï¼Œæ‰§è¡Œè¯»å–æ“ä½œçš„çº¿ç¨‹å’Œæ‰§è¡Œå†™å…¥æ“ä½œçš„çº¿ç¨‹å¯ä»¥å¹¶å‘åœ°è®¿é—®mapï¼Œå¹¶ä¸”ä¸€å®šæ•°é‡çš„å†™å…¥çº¿ç¨‹å¯ä»¥å¹¶å‘åœ°ä¿®æ”¹Mapã€‚ è€Œä¸”ConcurrentHashMapæä¾›çš„è¿­ä»£å™¨ä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionï¼Œå› æ­¤ä¸éœ€è¦å†è¿­ä»£è¿‡ç¨‹ä¸­å¯¹å®¹å™¨åŠ é”ã€‚å®ƒè¿”å›çš„è¿­ä»£å™¨å…·æœ‰å¼±ä¸€è‡´æ€§ï¼Œè€Œå¹¶éâ€œåŠæ—¶å¤±è´¥â€ã€‚å¼±ä¸€è‡´æ€§çš„è¿­ä»£å™¨å¯ä»¥å®¹å¿å¹¶å‘çš„ä¿®æ”¹ï¼Œå½“åˆ›å»ºè¿­ä»£å™¨æ—¶ä¼šéå†å·²æœ‰çš„å…ƒç´ ï¼Œå¹¶å¯ä»¥åœ¨è¿­ä»£å™¨è¢«æ„é€ åå°†ä¿®æ”¹æ“ä½œåæ˜ ç»™å®¹å™¨ã€‚ ä¸Hashtableå’Œsynchronized-Mapç›¸æ¯”ï¼ŒConcurrentHashMapæœ‰ç€æ›´å¤šçš„ä¼˜åŠ¿ä»¥åŠæ›´å°‘çš„åŠ£åŠ¿ã€‚å› æ­¤åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç”¨ConcurrentHashMapæ¥ä»£æ›¿åŒæ­¥Mapèƒ½è¿›ä¸€æ­¥æé«˜ä»£ç çš„å¯ä¼¸ç¼©æ€§ï¼Œåªæœ‰å½“åº”ç”¨ç¨‹åºéœ€è¦ç»™mapåŠ é”ä»¥è¿›è¡Œç‹¬å è®¿é—®æ—¶ï¼Œæ‰åº”è¯¥æ”¾å¼ƒä½¿ç”¨ConcurrentHashMapã€‚ é¢å¤–çš„åŸå­Mapæ“ä½œç”±äºConcurrentHashMapä¸èƒ½è¢«åŠ é”æ¥æ‰§è¡Œç‹¬å è®¿é—®ï¼Œå› æ­¤ä¹Ÿæ— æ³•ä½¿ç”¨å®¢æˆ·ç«¯åŠ é”æ¥åˆ›å»ºæ–°çš„åŸå­æ“ä½œã€‚ä½†æ˜¯ä¸€äº›å¸¸è§çš„å¤åˆæ“ä½œï¼Œå¦‚â€œå¦‚æ²¡æœ‰åˆ™æ·»åŠ ï¼ˆput-if-absentï¼‰â€,â€è‹¥ç›¸ç­‰åˆ™ç§»é™¤ï¼ˆremove-if-equalsï¼‰â€,â€è‹¥ç›¸ç­‰åˆ™æ›¿æ¢ï¼ˆreplace-if-equalsï¼‰â€ç­‰ï¼Œéƒ½å·²ç»åœ¨ConcurrentMapæ¥å£ä¸­æœ‰å£°æ˜ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦ä¸ºç°æœ‰çš„åŒæ­¥Mapæ·»åŠ è¿™æ ·çš„åŠŸèƒ½ï¼Œå°±åº”è¯¥è€ƒè™‘ä½¿ç”¨ConcurrentMapäº†ã€‚ CopyOnWriteArrayListCopyOnWriteArrayListç”¨äºæ›¿ä»£åŒæ­¥listï¼Œåœ¨æŸäº›æƒ…å†µä¸‹æä¾›äº†æ›´å¥½çš„å¹¶å‘æ€§èƒ½ï¼Œå¹¶ä¸”åœ¨è¿­ä»£å™¨é—´ä¸éœ€è¦å¯¹å®¹å™¨è¿›è¡ŒåŠ é”æˆ–å¤åˆ¶ã€‚ï¼ˆç±»ä¼¼åœ°ï¼ŒCopyOnWriteArraySetçš„ä½œç”¨æ˜¯æ›¿ä»£åŒæ­¥setï¼‰ Copy-On-Writeå®¹å™¨çš„çº¿ç¨‹å®‰å…¨æ€§åœ¨äºï¼Œåªè¦æ­£ç¡®åœ°å‘å¸ƒä¸€ä¸ªå®é™…ä¸å¯å˜çš„å¯¹è±¡ï¼Œé‚£ä¹ˆåœ¨è®¿é—®è¯¥å¯¹è±¡æ—¶å°±ä¸éœ€è¦è¿›ä¸€æ­¥çš„åŒæ­¥äº†ã€‚ Copy-On-Writeä»å­—é¢ä¸Šçœ‹å°±æ˜¯ï¼ŒWriteçš„æ—¶å€™æ€»æ˜¯è¦Copyï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡ä¿®æ”¹æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºå¹¶é‡æ–°å‘å¸ƒä¸€ä¸ªæ–°çš„å®¹å™¨å‰¯æœ¬ã€‚è€ŒCopyOnWriteArrayListå®¹å™¨çš„è¿­ä»£å™¨ä¼šä¿ç•™ä¸€ä¸ªæŒ‡å‘åŸå§‹æ•°ç»„çš„å¼•ç”¨ï¼Œéå†çš„ä¹Ÿæ˜¯åŸå§‹æ•°ç»„ï¼Œè€Œå…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„æ˜¯è¿™ä¸ªåŸå§‹æ•°ç»„çš„å‰¯æœ¬ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå½±å“åŸå§‹æ•°ç»„ï¼ŒåŸå§‹æ•°ç»„ä¸ä¼šæ”¹å˜ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰ConcurrentModificationExceptionäº†ï¼Œå¹¶ä¸”è¿”å›çš„å…ƒç´ å’Œè¿­ä»£å™¨åˆ›å»ºæ—¶çš„å…ƒç´ å®Œå…¨ä¸€è‡´ã€‚ æ˜¾ç„¶ï¼Œæ¯å½“ä¿®æ”¹å®¹å™¨æ—¶éƒ½ä¼šå¤åˆ¶åŸå§‹æ•°ç»„ï¼Œè¿™éœ€è¦ä¸€å®šå¼€é”€ï¼Œç‰¹åˆ«æ˜¯å½“å®¹å™¨çš„è§„æ¨¡è¾ƒå¤§æ—¶ã€‚ä»…å½“è¿­ä»£å™¨æ“ä½œå¤šäºä¿®æ”¹æ“ä½œæ—¶ï¼Œæ‰åº”è¯¥ä½¿ç”¨â€œå†™å…¥æ—¶å¤åˆ¶â€å®¹å™¨ã€‚ é˜»å¡é˜Ÿåˆ—å’Œç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼åŸºäºé˜»å¡é˜Ÿåˆ—æ„å»ºçš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…è®¾è®¡ä¸­ï¼šå½“æ•°æ®ç”Ÿæˆæ—¶ï¼Œç”Ÿäº§è€…æŠŠæ•°æ®æ”¾å…¥é˜Ÿåˆ—ï¼Œè€Œå½“æ¶ˆè´¹è€…å‡†å¤‡å¤„ç†æ•°æ®æ—¶ï¼Œå°†ä»é˜Ÿåˆ—ä¸­è·å–æ•°æ®ã€‚é˜»å¡é˜Ÿåˆ—ç®€åŒ–äº†ç”Ÿäº§è€…-æ¶ˆè´¹è€…è®¾è®¡çš„å®ç°è¿‡ç¨‹ï¼Œå®ƒæ”¯æŒä»»æ„æ•°é‡çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€‚ åœ¨æ„å»ºé«˜å¯é çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œæœ‰ç•Œé˜Ÿåˆ—æ˜¯ä¸€ç§å¼ºå¤§çš„èµ„æºç®¡ç†å·¥å…·ï¼šå®ƒä»¬èƒ½æŠ‘åˆ¶å¹¶é˜²æ­¢äº§ç”Ÿè¿‡å¤šçš„å·¥ä½œé¡¹ï¼Œä½¿åº”ç”¨ç¨‹åºåœ¨è´Ÿè·è¿‡è½½çš„æƒ…å†µä¸‹å˜å¾—æ›´åŠ å¥å£®ã€‚ BlockingQueueæœ‰å¤šç§å®ç°ï¼šLinkedBlockingQueueå’ŒArrayBlockingQueueæ˜¯FIFOé˜Ÿåˆ—ï¼Œä¸LinkedListå’ŒArrayListç›¸ä¼¼ï¼Œä½†æ¯”åŒæ­¥listæœ‰æ›´å¥½çš„å¹¶å‘æ€§èƒ½ã€‚PriorityBlockingQueueæ˜¯ä¸€ä¸ªæŒ‰ä¼˜å…ˆçº§æ’åºçš„é˜Ÿåˆ—ï¼Œå½“ä½ å¸Œæœ›æŒ‰ç…§æŸç§é¡ºåºè€Œä¸æ˜¯FIFOæ¥å¤„ç†å…ƒç´ æ—¶ï¼Œè¿™ä¸ªé˜Ÿåˆ—éå¸¸æœ‰ç”¨ï¼ŒPriorityBlockingQueueæ—¢å¯ä»¥æ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºæ¥æ¯”è¾ƒå…ƒç´ ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Comparatoræ¥æ¯”è¾ƒã€‚æœ€åä¸€ä¸ªBlockingQueueæ˜¯SynchronousQueueï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„é˜Ÿåˆ—ï¼Œå› ä¸ºå®ƒä¸ä¼šä¸ºé˜Ÿåˆ—ä¸­å…ƒç´ ç»´æŠ¤å­˜å‚¨ç©ºé—´ã€‚å®ƒç»´æŠ¤çš„æ˜¯ä¸€ç»„çº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹åœ¨ç­‰å¾…ç€æŠŠå…ƒç´ åŠ å…¥æˆ–ç§»å‡ºé˜Ÿåˆ—ã€‚ä»¥æ´—ç›˜å­ä¸ºä¾‹ï¼Œç›¸å½“äºæ²¡æœ‰ç›˜æ¶ï¼Œç›´æ¥å°†æ´—å¥½çš„ç›˜å­æ”¾å…¥ä¸‹ä¸€ä¸ªç©ºé—²çš„çƒ˜å¹²æœºä¸­ï¼Œå®ƒå¯ä»¥ç›´æ¥äº¤ä»˜å·¥ä½œï¼Œä»è€Œé™ä½äº†å°†æ•°æ®ä»ç”Ÿäº§è€…ç§»åŠ¨åˆ°æ¶ˆè´¹è€…çš„å»¶è¿Ÿã€‚å› ä¸ºSynchronousQueueæ²¡æœ‰å­˜å‚¨åŠŸèƒ½ï¼Œå› æ­¤putå’Œtakeä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°æœ‰å¦ä¸€ä¸ªçº¿ç¨‹å·²ç»å‡†å¤‡å¥½å‚ä¸åˆ°äº¤ä»˜è¿‡ç¨‹ä¸­ã€‚ä»…å½“æœ‰è¶³å¤Ÿå¤šçš„æ¶ˆè´¹è€…ï¼Œå¹¶ä¸”æ€»æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å‡†å¤‡å¥½è·å–äº¤ä»˜çš„å·¥ä½œæ—¶ï¼Œæ‰é€‚åˆä½¿ç”¨åŒæ­¥é˜Ÿåˆ—ã€‚ ä¸²è¡Œçº¿ç¨‹å°é—­å¯¹äºå¯å˜å¯¹è±¡ï¼Œç”Ÿäº§è€…-æ¶ˆè´¹è€…è¿™ç§è®¾è®¡ä¸é˜»å¡é˜Ÿåˆ—ç»„åˆåœ¨ä¸€èµ·ä½¿å¾—æŠŠå¯¹è±¡ä»ç”Ÿäº§è€…è½¬ç§»ç»™æ¶ˆè´¹è€…å˜å¾—å®¹æ˜“ã€‚çº¿ç¨‹å°é—­å¯¹è±¡åªèƒ½ç”±å•ä¸ªçº¿ç¨‹æ‹¥æœ‰ï¼Œä½†å¯ä»¥é€šè¿‡å®‰å…¨åœ°å‘å¸ƒè¯¥å¯¹è±¡æ¥è½¬ç§»æ‰€æœ‰æƒã€‚åœ¨æ‰€æœ‰æƒè½¬ç§»åï¼Œå°±åªæœ‰æ–°çº¿ç¨‹èƒ½è·å¾—è¿™ä¸ªå¯¹è±¡çš„è®¿é—®æƒé™ï¼Œå¹¶ä¸”å‘å¸ƒå¯¹è±¡çš„çº¿ç¨‹ä¸ä¼šå†è®¿é—®å®ƒã€‚è¿™ç§å®‰å…¨çš„å‘å¸ƒç¡®ä¿äº†å¯¹è±¡çŠ¶æ€å¯¹äºæ–°çš„æ‰€æœ‰è€…æ¥è¯´æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”ç”±äºæœ€åˆçš„æ‰€æœ‰è€…ä¸ä¼šå†è®¿é—®å®ƒï¼Œæ‰€ä»¥è¿™ä¸ªå¯¹è±¡åˆè¢«å°é—­åœ¨æ–°çš„çº¿ç¨‹ä¸­ï¼Œæ–°çº¿ç¨‹å¯ä»¥å¯¹è¯¥å¯¹è±¡åšä»»æ„ä¿®æ”¹ï¼Œå› ä¸ºå®ƒå…·æœ‰ç‹¬å çš„è®¿é—®æƒã€‚ å¯¹è±¡æ± åˆ©ç”¨äº†ä¸²è¡Œçº¿ç¨‹å°é—­ï¼Œå°†å¯¹è±¡å€Ÿç»™ä¸€ä¸ªè¯·æ±‚çº¿ç¨‹ã€‚åªè¦å¯¹è±¡æ± åŒ…å«è¶³å¤Ÿçš„å†…éƒ¨åŒæ­¥æ¥å®‰å…¨åœ°å‘å¸ƒæ± ä¸­çš„å¯¹è±¡ï¼Œå¹¶ä¸”åªè¦å®¢æˆ·ä»£ç æœ¬èº«ä¸ä¼šå‘å¸ƒæ± ä¸­çš„å¯¹è±¡ï¼Œæˆ–è€…åœ¨å°†å¯¹è±¡è¿”å›ç»™å¯¹è±¡æ± åå°±ä¸å†ä½¿ç”¨å®ƒï¼Œé‚£ä¹ˆå°±å¯ä»¥å®‰å…¨åœ°åœ¨çº¿ç¨‹ä¹‹é—´ä¼ é€’æ‰€æœ‰æƒã€‚ åŒç«¯é˜Ÿåˆ—ä¸å·¥ä½œå¯†å–Java 6å¢åŠ äº†ä¸¤ç§å®¹å™¨ç±»å‹ï¼ŒDeque&amp;BlockingQueueã€‚Dequeæ˜¯ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—ï¼Œå®ç°äº†åœ¨é˜Ÿåˆ—å¤´å’Œé˜Ÿåˆ—å°¾çš„é«˜æ•ˆæ’å…¥å’Œç§»é™¤ã€‚ åŒç«¯é˜Ÿåˆ—é€‚ç”¨äºå¦ä¸€ç§ç›¸å…³æ¨¡å¼ï¼Œå³å·¥ä½œå¯†å–ï¼ˆWork Stealingï¼‰ã€‚ï¼ˆä¸æ‡‚ï¼‰ åŒæ­¥å·¥å…·ç±»åŒæ­¥å™¨å¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦å®ƒæ ¹æ®å…¶è‡ªèº«çš„çŠ¶æ€æ¥åè°ƒçº¿ç¨‹çš„æ§åˆ¶æµå°±å¯ä»¥å«åŒæ­¥å™¨ã€‚é˜»å¡é˜Ÿåˆ—å¯ä»¥ä½œä¸ºåŒæ­¥å™¨ï¼Œå…¶ä»–ç±»å‹çš„åŒæ­¥å™¨è¿˜åŒ…æ‹¬ä¿¡å·é‡(Semaphore)/æ …æ ï¼ˆBarrierï¼‰ä»¥åŠé—­é”ï¼ˆLatchï¼‰ã€‚ æ‰€æœ‰çš„åŒæ­¥å™¨éƒ½åŒ…å«ä¸€äº›ç‰¹å®šçš„ç»“æ„åŒ–å±æ€§ï¼šå®ƒä»¬å°è£…äº†ä¸€äº›çŠ¶æ€ï¼Œè¿™äº›çŠ¶æ€å°†å†³å®šä½¿ç”¨åŒæ­¥å™¨çš„çº¿ç¨‹æ˜¯ç»§ç»­æ‰§è¡Œè¿˜æ˜¯ç­‰å¾…ï¼Œæ­¤å¤–è¿˜æä¾›äº†ä¸€äº›æ–¹æ³•å¯¹çŠ¶æ€è¿›è¡Œæ“ä½œï¼Œä»¥åŠå¦ä¸€äº›æ–¹æ³•ç”¨äºé«˜æ•ˆåœ°ç­‰å¾…åŒæ­¥å™¨è¿›å…¥åˆ°é¢„æœŸçŠ¶æ€ã€‚ é—­é”é—­é”æ—¶ä¸€ç§åŒæ­¥å™¨ï¼Œå¯ä»¥å»¶è¿Ÿçº¿ç¨‹çš„è¿›åº¦ç›´åˆ°çº¿ç¨‹åˆ°è¾¾ç»ˆæ­¢çŠ¶æ€ã€‚é—­é”çš„ä½œç”¨ç›¸å½“äºä¸€æ‰‡é—¨ï¼šåœ¨é—­é”åˆ°è¾¾terminalçŠ¶æ€å‰ï¼Œè¿™æ‰‡é—¨ä¸€ç›´æ˜¯å…³é—­çš„ï¼Œæ²¡æœ‰ä»»ä½•çº¿ç¨‹é€šè¿‡ï¼Œè€Œå½“åˆ°è¾¾terminalçŠ¶æ€æ—¶ï¼Œè¿™æ‰‡é—¨å°±ä¼šæ‰“å¼€å…è®¸æ‰€æœ‰çº¿ç¨‹é€šè¿‡ã€‚å½“é—­é”è¾¾åˆ°terminalçŠ¶æ€ï¼Œå®ƒçš„çŠ¶æ€å°±ä¸ä¼šå†æ”¹å˜ï¼Œå› æ­¤è¿™æ‰‡é—¨ä¼šæ°¸è¿œæ‰“å¼€ã€‚é—­é”å¯ä»¥ç”¨æ¥ç¡®ä¿æŸäº›æ´»åŠ¨ç›´åˆ°å…¶ä»–æ´»åŠ¨éƒ½å®Œæˆåæ‰ç»§ç»­æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š ç¡®ä¿æŸä¸ªè®¡ç®—åœ¨å…¶éœ€è¦çš„æ‰€æœ‰èµ„æºéƒ½åˆå§‹åŒ–ä¹‹åæ‰ç»§ç»­æ‰§è¡Œ ç¡®ä¿æŸä¸ªæœåŠ¡åœ¨å…¶ä¾èµ–çš„æ‰€æœ‰å…¶ä»–æœåŠ¡éƒ½å·²ç»å¯åŠ¨ä¹‹åæ‰å¯åŠ¨ ç­‰å¾…æŸä¸ªæ“ä½œçš„æ‰€æœ‰å‚ä¸è€…éƒ½å°±ç»ªå†ç»§ç»­æ‰§è¡Œ CountDownLatchæ˜¯ä¸€ç§çµæ´»çš„é—­é”ï¼Œå¯ä»¥åœ¨ä¸Šè¿°å„ç§æƒ…å†µä¸­ä½¿ç”¨ï¼Œå®ƒå¯ä»¥ä½¿ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…ä¸€ç»„äº‹ä»¶å‘ç”Ÿã€‚countDownæ–¹æ³•é€’å‡è®¡æ•°å™¨ï¼Œè¡¨ç¤ºæœ‰ä¸€ä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿäº†ï¼Œè€Œawaitæ–¹æ³•ç­‰å¾…è®¡æ•°å™¨è¾¾åˆ°é›¶ï¼Œè¿™è¡¨ç¤ºæ‰€æœ‰éœ€è¦ç­‰å¾…çš„äº‹ä»¶éƒ½å·²ç»å‘ç”Ÿã€‚å¦‚æœè®¡æ•°å™¨çš„å€¼éé›¶ï¼Œé‚£ä¹ˆawaitä¼šä¸€ç›´é˜»å¡ç›´åˆ°è®¡æ•°å™¨ä¸ºé›¶ï¼Œæˆ–è€…ç­‰å¾…ä¸­çš„çº¿ç¨‹ä¸­æ–­ï¼Œæˆ–è€…ç­‰å¾…è¶…æ—¶ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class TestHarness &#123; public long timeTasks(int nThreads, final Runnable task) throws InterruptedException &#123; final CountDownLatch startGate = new CountDownLatch(1); final CountDownLatch endGate = new CountDownLatch(nThreads); for(int i = 0; i &lt; nThreads; i++) &#123; Thread t = new Thread() &#123; public void run() &#123; try &#123; startGate.await(); try &#123; task.run(); &#125; finally &#123; endGate.countDown(); &#125; &#125; catch (InterruptedException ignored) &#123;&#125; &#125; &#125;; t.start(); &#125; long start = System.nanoTime(); startGate.countDown(); endGate.await(); long end = System.nanoTime(); return end-start; &#125; public static void main(String[] args) &#123; Runnable task = new Runnable() &#123; @Override public void run() &#123; System.out.println("ing"); &#125; &#125;; try &#123; long interval = new TestHarness().timeTasks(3, task); System.out.println(interval); &#125; catch (InterruptedException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; &#125;&#125; å¯åŠ¨é—¨å°†ä½¿å¾—ä¸»çº¿ç¨‹èƒ½å¤ŸåŒæ—¶é‡Šæ”¾æ‰€æœ‰å·¥ä½œçº¿ç¨‹ï¼Œè€Œç»“æŸé—¨åˆ™ä½¿ä¸»çº¿ç¨‹èƒ½å¤Ÿç­‰å¾…æœ€åä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæˆã€‚ FutureTaskFutureTaskä¹Ÿå¯ä»¥ç”¨ä½œé—­é”ï¼Œå®ƒå¯ä»¥å¤„äºä¸‹é¢3ç§çŠ¶æ€ï¼šç­‰å¾…è¿è¡Œã€æ­£åœ¨è¿è¡Œå’Œè¿è¡Œå®Œæˆã€‚Future.getçš„è¡Œä¸ºå–å†³äºä»»åŠ¡çš„çŠ¶æ€ï¼Œå¦‚æœä»»åŠ¡å·²ç»å®Œæˆï¼Œé‚£ä¹ˆgetä¼šç«‹å³è¿”å›ç»“æœï¼Œå¦åˆ™getå°†é˜»å¡ç›´åˆ°ä»»åŠ¡è¿›è¡Œå®ŒæˆçŠ¶æ€ã€‚ ä¿¡å·é‡è®¡æ•°ä¿¡å·é‡ç”¨æ¥æ§åˆ¶åŒæ—¶è®¿é—®æŸä¸ªç‰¹å®šèµ„æºçš„æ“ä½œæ•°é‡ï¼Œæˆ–è€…åŒæ—¶æ‰§è¡ŒæŸä¸ªæŒ‡å®šæ“ä½œçš„æ•°é‡ã€‚è®¡æ•°ä¿¡å·é‡è¿˜å¯ä»¥ç”¨æ¥å®ç°æŸç§èµ„æºæ± ï¼Œæˆ–è€…å¯¹å®¹å™¨æ–½åŠ è¾¹ç•Œã€‚ Semaphoreç®¡ç†ç€ä¸€ç»„è™šæ‹Ÿçš„permitsï¼Œè®¸å¯çš„åˆå§‹æ•°é‡é€šè¿‡æ„é€ å‡½æ•°æŒ‡å®šã€‚åœ¨æ‰§è¡Œæ“ä½œå‰å…ˆacquire permitsï¼ˆåªè¦æœ‰å‰©ä½™çš„è®¸å¯å°±å¯ä»¥ï¼‰ï¼Œåœ¨ä½¿ç”¨å®Œåä¼šreleaseè¿™ä¸ªè®¸å¯ã€‚å¦‚æœæ²¡æœ‰è·å¾—permitï¼Œacquireæ–¹æ³•å°†ä¸€ç›´é˜»å¡åˆ°æœ‰è®¸å¯æˆ–æŒ‡å¯¼è¢«ä¸­æ–­æˆ–è¶…æ—¶ã€‚releaseæ–¹æ³•å°†è¿”å›ä¸€ä¸ªpermitç»™ä¿¡å·é‡ã€‚ Semaphoreä¹Ÿå¯ä»¥å°†ä»»ä½•ä¸€ç§å®¹å™¨å˜æˆæœ‰ç•Œé˜»å¡å®¹å™¨ã€‚ä¿¡å·é‡çš„è®¡æ•°å€¼ä¼šåˆå§‹åŒ–ä¸ºå®¹å™¨å®¹é‡çš„æœ€å¤§å€¼ï¼Œaddæ“ä½œåœ¨å‘å®¹å™¨æ·»åŠ ä¸€ä¸ªå…ƒç´ ä¹‹å‰ï¼Œé¦–å…ˆè·å–ä¸€ä¸ªpermitï¼Œç„¶åå†æ·»åŠ ï¼Œå¦‚æœæ·»åŠ å¤±è´¥ï¼Œé‚£ä¹ˆä¼šé‡Šæ”¾è®¸å¯ï¼Œå¦‚æœæˆåŠŸå°±ä¸é‡Šæ”¾äº†ã€‚åŒæ ·ï¼Œremoveæ“ä½œä¼šé‡Šæ”¾ä¸€ä¸ªè®¸å¯ï¼Œæ¥ä½¿æ›´å¤šçš„å…ƒç´ èƒ½å¤Ÿæ·»åŠ åˆ°å®¹å™¨ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132public class BoundedHashSet&lt;T&gt; &#123; private final Set&lt;T&gt; set; private final Semaphore sem; public BoundedHashSet(int bound) &#123; this.set = Collections.synchronizedSet(new HashSet&lt;T&gt;()); sem = new Semaphore(bound); &#125; public boolean add(T o) throws InterruptedException &#123; sem.acquire(); boolean wasAdded = false; try &#123; wasAdded = set.add(o); &#125; finally &#123; if (!wasAdded) &#123; sem.release(); &#125; &#125; return wasAdded; &#125; public boolean remove(Object o) &#123; boolean wasRemoved = set.remove(o); if (wasRemoved) &#123; sem.release(); &#125; return wasRemoved; &#125;&#125; æ …æ é—­é”å¯ä»¥å¯åŠ¨ä¸€ç»„ç›¸å…³çš„æ“ä½œï¼Œæˆ–è€…ç­‰å¾…ä¸€ç»„ç›¸å…³çš„æ“ä½œç»“æŸã€‚é—­é”æ—¶ä¸€æ¬¡æ€§å¯¹è±¡ï¼Œä¸€æ—¦è¿›å…¥ç»ˆæ­¢çŠ¶æ€ï¼Œå°±ä¸èƒ½è¢«é‡ç½®ã€‚ æ …æ ç±»ä¼¼äºé—­é”ï¼Œå®ƒèƒ½é˜»å¡ä¸€ç»„çº¿ç¨‹ç›´åˆ°æŸä¸ªäº‹ä»¶å‘ç”Ÿã€‚æ …æ ä¸é—­é”çš„å…³é”®åŒºåˆ«åœ¨äºï¼Œæ‰€æœ‰çº¿ç¨‹å¿…é¡»åŒæ—¶åˆ°è¾¾æ …æ ä½ç½®ï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚é—­é”ç”¨äºç­‰å¾…äº‹ä»¶å‘ç”Ÿï¼Œè€Œæ …æ ç”¨äºç­‰å¾…å…¶ä»–çº¿ç¨‹ã€‚ æ„å»ºé«˜æ•ˆä¸”å¯ä¼¸ç¼©çš„ç»“æœç¼“å­˜ä¸‹é¢çš„å‡ ä¸ªä»£ç æ®µå°†é€æ­¥æ„æ¶ä¸€ä¸ªé«˜æ•ˆä¸”å¯ä¼¸ç¼©çš„ç¼“å­˜ï¼š123456789101112131415161718192021222324252627282930313233// Memoizer1å­˜åœ¨ä¸€ä¸ªå¯ä¼¸ç¼©çš„é—®é¢˜ï¼Œæ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿæ‰§è¡Œcomputeã€‚public interface Computable&lt;A,V&gt; &#123; V compute(A arg) throws InterruptedException;&#125;public class ExpensiveFunction implements Computable&lt;String, BigInteger&gt;&#123; @Override public BigInteger compute(String arg) throws InterruptedException &#123; //åœ¨ç»è¿‡é•¿æ—¶é—´çš„è®¡ç®—å return new BigInteger(arg); &#125;&#125;public class Memoizer1&lt;A, V&gt; implements Computable&lt;A, V&gt; &#123; private final Map&lt;A, V&gt; cache = new HashMap&lt;A, V&gt;(); private final Computable&lt;A, V&gt; c; public Memoizer1(Computable&lt;A, V&gt; c) &#123; this.c = c; &#125; @Override public synchronized V compute(A arg) throws InterruptedException &#123; V result = cache.get(arg); if (result == null) &#123; result = c.compute(arg); cache.put(arg, result); &#125; return result; &#125;&#125; 1234567891011121314151617181920// ä¼šå­˜åœ¨é‡å¤è®¡ç®—çš„é—®é¢˜public class Memoizer2&lt;A, V&gt; implements Computable&lt;A, V&gt; &#123; private final Map&lt;A, V&gt; cache = new ConcurrentHashMap&lt;A, V&gt;(); private final Computable&lt;A, V&gt; c; public Memoizer2(Computable&lt;A, V&gt; c) &#123; this.c = c; &#125; @Override public V compute(A arg) throws InterruptedException &#123; V result = cache.get(arg); if (result == null) &#123; result = c.compute(arg); cache.put(arg, result); &#125; return result; &#125;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748/*åˆ©ç”¨FutureTaskæ¥å‡å°‘é‡å¤è®¡ç®—çš„é—®é¢˜,ä½†æ˜¯ç”±äºifåˆ¤æ–­ä¸­ä¾ç„¶å­˜åœ¨éåŸå­çš„â€œå…ˆæ£€æŸ¥å†æ‰§è¡Œâ€çš„æ“ä½œï¼Œæ‰€ä»¥è¿˜æ˜¯ä¼šå­˜åœ¨é‡å¤è®¡ç®—çš„é—®é¢˜*/ public class Memoizer3&lt;A, V&gt; implements Computable&lt;A, V&gt; &#123; private final Map&lt;A, Future&lt;V&gt;&gt; cache = new ConcurrentHashMap&lt;A, Future&lt;V&gt;&gt;(); private final Computable&lt;A, V&gt; c; public Memoizer3(Computable&lt;A, V&gt; c) &#123; this.c = c; &#125; @Override public V compute(final A arg) throws InterruptedException &#123; Future&lt;V&gt; f = cache.get(arg); if (f == null) &#123; Callable&lt;V&gt; eval = new Callable&lt;V&gt;() &#123; @Override public V call() throws InterruptedException &#123; return c.compute(arg); &#125; &#125;; FutureTask&lt;V&gt; ft = new FutureTask&lt;V&gt;(eval); f = ft; cache.put(arg,ft); ft.run(); &#125; try &#123; return f.get(); &#125; catch (ExecutionException e) &#123; throw launderThrowable(e.getCause()); &#125; &#125; /** * å¼ºåˆ¶å°†æœªæ£€æŸ¥çš„Throwableè½¬åŒ–ä¸ºRuntimeException * @param t * @return */ public static RuntimeException launderThrowable(Throwable t) &#123; if (t instanceof RuntimeException) &#123; return (RuntimeException) t; &#125; else if (t instanceof Error) &#123; throw (Error) t; &#125; else &#123; throw new IllegalStateException("Not unchecked",t); &#125; &#125;&#125; 1234567891011121314151617181920212223242526272829303132333435363738// **æœ€ç»ˆç‰ˆ**// åˆ©ç”¨å¤åˆæ“ä½œâ€œè‹¥æ²¡æœ‰åˆ™æ·»åŠ â€å¯ä»¥è§£å†³Memoizer3çš„é—®é¢˜public class Memoizer4&lt;A, V&gt; implements Computable&lt;A, V&gt; &#123; private final Map&lt;A, Future&lt;V&gt;&gt; cache = new ConcurrentHashMap&lt;A, Future&lt;V&gt;&gt;(); private final Computable&lt;A, V&gt; c; public Memoizer4(Computable&lt;A, V&gt; c) &#123; this.c = c; &#125; @Override public V compute(final A arg) throws InterruptedException &#123; while (true) &#123; Future&lt;V&gt; f = cache.get(arg); if (f == null) &#123; Callable&lt;V&gt; eval = new Callable&lt;V&gt;() &#123; @Override public V call() throws InterruptedException &#123; return c.compute(arg); &#125; &#125;; FutureTask&lt;V&gt; ft = new FutureTask&lt;V&gt;(eval); f = ft; cache.putIfAbsent(arg, ft); ft.run(); &#125; try &#123; return f.get(); &#125; catch (CancellationException e) &#123; cache.remove(arg, f); //ä¸ºäº†è§£å†³ç¼“å­˜æ±¡æŸ“é—®é¢˜ï¼Œå½“è®¡ç®—è¢«å–æ¶ˆæˆ–è€…å¤±è´¥æ—¶ï¼Œå°±ä»ç¼“å­˜ä¸­remove &#125; catch (ExecutionException e) &#123; throw launderThrowable(e.getCause()); &#125; &#125; &#125;&#125; æ€»ç»“æ„å»ºä¸€ä¸ªé«˜æ•ˆä¸”å…·æœ‰ä¼¸ç¼©æ€§çš„åŸºç¡€æ¨¡å—è¿˜æ˜¯æœ‰ç‚¹éš¾åº¦çš„ï¼Œæˆ‘ä»¬è¦è€ƒè™‘çš„ä¸œè¥¿æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬è¦åˆ©ç”¨å·²æœ‰çš„åŸºç¡€æ¨¡å—åˆç†æ„å»ºã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®è·µã€‹ï¼ˆå››ï¼‰â€”- æ„å»ºé˜»å¡ å›¾è§£é›†åˆ3ï¼šCopyOnWriteArrayList]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_3_å¯¹è±¡çš„ç»„åˆ]]></title>
    <url>%2F2018%2F01%2F13%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-3-%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%BB%84%E5%90%88%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæˆ‘ä»¬ä¸å¸Œæœ›æ¯ä¸€æ¬¡è®¿é—®å†…å­˜éƒ½è¿›è¡Œåˆ†æä»¥ç¡®ä¿ç¨‹åºæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œæ˜¯å¸Œæœ›å°†ä¸€äº›ç°æœ‰çš„çº¿ç¨‹å®‰å…¨ç»„ä»¶ç»„åˆä¸ºæ›´å¤§è§„æ¨¡çš„ç»„ä»¶æˆ–ç¨‹åºã€‚ è®¾è®¡çº¿ç¨‹å®‰å…¨çš„ç±» åœ¨è®¾è®¡çº¿ç¨‹å®‰å…¨ç±»çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªåŸºæœ¬è¦ç´ ï¼š æ‰¾å‡ºæ„æˆå¯¹è±¡çŠ¶æ€çš„æ‰€æœ‰å˜é‡ æ‰¾å‡ºçº¦æŸçŠ¶æ€å˜é‡çš„ä¸å˜æ€§æ¡ä»¶ å»ºç«‹å¯¹è±¡çš„å¹¶å‘è®¿é—®ç®¡ç†ç­–ç•¥ åŒæ­¥ç­–ç•¥è§„å®šäº†å¦‚ä½•å°†ä¸å˜æ€§ã€çº¿ç¨‹å°é—­ã€åŠ é”æœºåˆ¶ç­‰ç»“åˆèµ·æ¥ä»¥ç»´æŠ¤çº¿ç¨‹çš„å®‰å…¨æ€§ï¼Œå¹¶ä¸”è§„å®šäº†å“ªäº›å˜é‡ç”±å“ªäº›é”æ¥ä¿æŠ¤ã€‚è¦ç¡®ä¿å¼€å‘äººå‘˜å¯ä»¥å¯¹è¿™ä¸ªç±»è¿›è¡Œåˆ†æä¸ç»´æŠ¤ï¼Œå°±å¿…é¡»å°†åŒæ­¥ç­–ç•¥å†™æˆæ­£å¼æ–‡æ¡£ã€‚ æ”¶é›†åŒæ­¥éœ€æ±‚è¦ç¡®ä¿ç±»çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œå°±éœ€è¦ç¡®ä¿å®ƒçš„ä¸å˜æ€§æ¡ä»¶ä¸ä¼šå†å¹¶å‘è®¿é—®æ—¶è¢«ç ´åï¼Œè¿™å°±éœ€è¦å¯¹å…¶çŠ¶æ€è¿›è¡Œæ¨æ–­ã€‚åœ¨è®¸å¤šç±»ä¸­éƒ½å®šä¹‰äº†ä¸€äº›ä¸å¯å˜æ¡ä»¶ï¼Œç”¨äºåˆ¤æ–­çŠ¶æ€æ˜¯æœ‰æ•ˆçš„è¿˜æ˜¯æ— æ•ˆçš„ã€‚åŒæ ·ï¼Œåœ¨æ“ä½œä¸­è¿˜åŒ…å«ä¸€äº›åéªŒæ¡ä»¶æ¥åˆ¤æ–­çŠ¶æ€è½¬æ¢æ˜¯å¦æœ‰æ•ˆã€‚å½“ä¸‹ä¸€ä¸ªçŠ¶æ€éœ€è¦ä¾èµ–å½“å‰çŠ¶æ€æ—¶ï¼Œè¿™ä¸ªæ“ä½œå°±å¿…é¡»æ˜¯ä¸€ä¸ªå¤åˆæ“ä½œã€‚å¦‚æœä¸äº†è§£å¯¹è±¡çš„ä¸å˜æ€§ä¸åéªŒæ¡ä»¶ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨æ€§ï¼Œè¦æ»¡è¶³çŠ¶æ€å˜é‡çš„æœ‰æ•ˆå€¼æˆ–çŠ¶æ€è½¬æ¢ä¸Šçš„å„ç§çº¦æŸæ¡ä»¶ï¼Œå°±éœ€è¦å€ŸåŠ©äºåŸå­æ€§ä¸å°è£…æ€§ã€‚ ä¾èµ–çŠ¶æ€çš„æ“ä½œç±»çš„ä¸å˜æ€§æ¡ä»¶å’ŒåéªŒæ¡ä»¶é™åˆ¶äº†å¯¹è±¡çš„æœ‰æ•ˆçŠ¶æ€å·²ç»çŠ¶æ€è½¬æ¢çš„æœ‰æ•ˆæ€§ã€‚æœ‰äº›å¯¹è±¡åŒ…å«ä¸€äº›åŸºäºçŠ¶æ€çš„å…ˆéªŒæ¡ä»¶ï¼Œä¾‹å¦‚ï¼Œä¸èƒ½ä»ç©ºé˜Ÿåˆ—ä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœåœ¨æ“ä½œä¸­åŒ…å«åŸºäºçŠ¶æ€çš„å…ˆéªŒæ¡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ“ä½œå°±å«åšä¾èµ–çŠ¶æ€æ“ä½œã€‚ åœ¨å¹¶å‘ç¨‹åºä¸­è¦ä¸€ç›´ç­‰åˆ°å…ˆéªŒæ¡ä»¶ä¸ºçœŸç„¶åå†è¿›è¡Œæ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ç°æœ‰åº“çš„ç±»ï¼ˆé˜»å¡é˜Ÿåˆ—[Blocking Queue]æˆ–ä¿¡å·é‡[Semaphore]ï¼‰æ¥å®ç°ä¾èµ–çŠ¶æ€çš„è¡Œä¸ºã€‚ çŠ¶æ€çš„æ‰€æœ‰æƒå¤šæ•°æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æƒä¸å°è£…æ€§æ˜¯ç›¸äº’å…³è”çš„ï¼šå¯¹è±¡å°è£…å®ƒæ‹¥æœ‰çš„çŠ¶æ€ï¼Œä¹Ÿå¯¹å®ƒå°è£…çš„çŠ¶æ€æ‹¥æœ‰æ‰€æœ‰æƒã€‚çŠ¶æ€å˜é‡çš„æ‰€æœ‰è€…å°†å†³å®šé‡‡ç”¨ä½•ç§åŠ é”åè®®æ¥ç»´æŒå˜é‡çŠ¶æ€çš„å®Œæ•´æ€§ã€‚æ‰€æœ‰æƒæ„å‘³ç€æ§åˆ¶æƒã€‚å¦‚æœå‘å¸ƒäº†æŸä¸ªå¯å˜å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆåŸæ¥çš„æ‰€æœ‰è€…å°±ä¸å†ç‹¬å æ§åˆ¶æƒäº†ï¼Œå°±å˜æˆå…±äº«æ§åˆ¶æƒäº†ã€‚ å®ä¾‹å°é—­å°è£…ç®€åŒ–äº†çº¿ç¨‹å®‰å…¨ç±»çš„å®ç°è¿‡ç¨‹ï¼Œå®ƒæä¾›äº†ä¸€ç§å®ä¾‹å°è£…æœºåˆ¶ï¼Œä¹Ÿç®€ç§°ä¸ºå°é—­ã€‚å°†æ•°æ®å°è£…åœ¨å¯¹è±¡å†…éƒ¨ï¼Œå°±å¯ä»¥å°†æ•°æ®çš„è®¿é—®é™åˆ¶åœ¨å¯¹è±¡çš„æ–¹æ³•ä¸Šï¼Œä»è€Œæ›´å®¹æ˜“ç¡®ä¿çº¿ç¨‹åœ¨è®¿é—®æ•°æ®æ—¶æ€»èƒ½æŒæœ‰æ­£ç¡®çš„é”ã€‚ å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š1234567891011121314@ThreadSafepublic class PersonSet &#123; @GuardedBy("this") private final Set&lt;Person&gt; mySet = new HashSet&lt;&gt;(); public synchronized void addPerson(Person p) &#123; mySet.add(p); &#125; public synchronized boolean containsPerson(Person p) &#123; return mySet.contains(p); &#125;&#125; PersonSetç±»è¯´æ˜äº†å¦‚ä½•é€šè¿‡å°†mySetå°é—­åœ¨ä¸€ä¸ªç±»å±æ€§ä¸­ä»¥åŠä½¿ç”¨åŠ é”æœºåˆ¶ä½¿ä¸€ä¸ªç±»æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ã€‚PersonSetçš„çŠ¶æ€ç”±HashSetæ¥ç®¡ç†ï¼Œè€ŒHashSetä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†ç”±äºmySetæ˜¯ç§æœ‰çš„å¹¶ä¸”ä¸ä¼šé€¸å‡ºï¼Œå› æ­¤HashSetè¢«å°é—­åœ¨PersonSetä¸­ã€‚å”¯ä¸€èƒ½è®¿é—®mySetçš„ä»£ç è·¯å¾„æ˜¯addPersonå’ŒcontainsPersonä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨æ‰§è¡Œå®ƒä»¬æ—¶éƒ½è¦è·å¾—PersonSetçš„å†…ç½®é”ï¼Œæ‰€ä»¥PersonSetçš„çŠ¶æ€å®Œå…¨ç”±å®ƒçš„å†…ç½®é”ä¿æŠ¤ï¼Œå› è€ŒPersonSetæ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç±»ã€‚ çº¿ç¨‹å°é—­çš„ä½œç”¨å¯ä»¥å°†éçº¿ç¨‹å®‰å…¨çš„ç±»è½¬åŒ–ä¸ºçº¿ç¨‹å®‰å…¨çš„ç±»ã€‚å¯ä»¥åˆ©ç”¨åˆ°è£…é¥°å™¨æ¨¡å¼ã€‚å°é—­æœºåˆ¶æ›´æ˜“äºæ„é€ çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œå› ä¸ºåœ¨åˆ†æçº¿ç¨‹å®‰å…¨æ€§æ—¶å¯ä»¥åªåˆ†æè¯¥ç±»è€Œä¸ç”¨æ£€æŸ¥æ•´ä¸ªç¨‹åºã€‚ Javaç›‘è§†å™¨æ¨¡å¼Javaçš„å†…ç½®é”ä¹Ÿç§°ä¸ºç›‘è§†å™¨é”æˆ–ç›‘è§†å™¨ã€‚æ‰€ä»¥ä½¿ç”¨å†…ç½®é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨æ€§çš„æ¨¡å¼å°±å«åšJavaç›‘è§†å™¨æ¨¡å¼ã€‚éµå¾ªJavaç›‘è§†å™¨æ¨¡å¼çš„å¯¹è±¡ä¼šæŠŠå¯¹è±¡çš„æ‰€æœ‰å¯å˜çŠ¶æ€éƒ½å°è£…èµ·æ¥ï¼Œå¹¶ç”±å¯¹è±¡è‡ªå·±çš„å†…ç½®é”æ¥ä¿æŠ¤ã€‚Javaç›‘è§†å™¨æ¨¡å¼ä»…ä»…æ˜¯ä¸€ç§ç¼–å†™ä»£ç çš„ä¹é˜Ÿï¼Œå¯¹äºä»»ä½•ä¸€ç§é”å¯¹è±¡ï¼Œåªè¦è‡ªå§‹è‡³ç»ˆéƒ½ä½¿ç”¨è¯¥é”å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨æ¥ä¿æŠ¤å¯¹è±¡çš„çŠ¶æ€ã€‚ï¼ˆä¸çŸ¥é“æ˜¯ä¸æ˜¯åªè¦è¯»å’Œå†™æ–¹æ³•åªè¦éƒ½ä¿æŒåŒæ­¥å°±å¥½äº†ï¼Ÿï¼‰ çº¿ç¨‹å®‰å…¨çš„å§”æ‰˜ï¼ˆéœ€è¦å¥½å¥½ç†è§£çš„ï¼Œæ—¥ååŠ æ·±ï¼‰åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œé€šè¿‡å¤šä¸ªçº¿ç¨‹ç±»ç»„åˆè€Œæˆçš„ç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ä»…ä»…æ˜¯ä¸€ä¸ªå¥½çš„å¼€ç«¯ï¼Œä½†å´æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼ˆç”±äºæ²¡æœ‰ç»´æŒä¸å˜æ€§çº¦æŸï¼‰ã€‚ å¦‚æœä¸€ä¸ªç±»æ˜¯ç”±å¤šä¸ªç‹¬ç«‹ä¸”çº¿ç¨‹å®‰å…¨çš„çŠ¶æ€å˜é‡ç»„æˆï¼Œå¹¶ä¸”åœ¨æ‰€æœ‰çš„æ“ä½œä¸­éƒ½ä¸åŒ…å«æ— æ•ˆçŠ¶æ€è½¬æ¢ï¼Œé‚£ä¹ˆå¯ä»¥å°†çº¿ç¨‹å®‰å…¨æ€§å§”æ‰˜ç»™è¿™äº›çŠ¶æ€å˜é‡ã€‚ å¦‚æœä¸€ä¸ªçŠ¶æ€å˜é‡æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿä¸å‚ä¸ä»»ä½•ä¸å˜æ€§æ¡ä»¶ï¼Œä¹Ÿæ²¡æœ‰æ“ä½œä¸Šçš„çŠ¶æ€å˜æ¢ï¼Œé‚£è¿™ä¸ªå˜é‡å°±å¯ä»¥å‘å¸ƒå‡ºå»ã€‚ åœ¨ç°æœ‰çš„çº¿ç¨‹å®‰å…¨ç±»ä¸­æ·»åŠ åŠŸèƒ½Javaç±»åº“åŒ…ä¸­åŒ…å«è®¸å¤šæœ‰ç”¨çš„â€œåŸºç¡€æ¨¡å—â€ç±»ï¼Œé€šå¸¸ï¼Œæˆ‘ä»¬åº”è¯¥ä¼˜å…ˆé€‰æ‹©é‡ç”¨è¿™äº›ç°æœ‰çš„ç±»è€Œä¸æ˜¯åˆ›å»ºæ–°çš„ç±»ï¼šé‡ç”¨èƒ½é™ä½å¼€å‘å·¥ä½œé‡ã€å¼€å‘é£é™©ï¼ˆå› ä¸ºç°æœ‰çš„ç±»éƒ½å·²ç»é€šè¿‡æµ‹è¯•ï¼‰ä»¥åŠç»´æŠ¤æˆæœ¬ã€‚æˆ‘ä»¬éœ€è¦åœ¨ä¸ç ´åçº¿ç¨‹å®‰å…¨æ€§çš„æƒ…å†µä¸‹æ·»åŠ ä¸€ä¸ªæ–°çš„æ“ä½œã€‚ è¦æ·»åŠ ä¸€ä¸ªæ–°çš„åŸå­æ“ä½œï¼Œæœ€å®‰å…¨çš„æ–¹æ³•æ˜¯ä¿®æ”¹åŸå§‹ç±»ï¼Œä½†è¿™é€šå¸¸æ— æ³•åšåˆ°ï¼Œå› ä¸ºå¯èƒ½æ— æ³•è®¿é—®æˆ–ä¿®æ”¹ç±»çš„æºä»£ç ã€‚å¦‚æœç›´æ¥å°†æ–°æ–¹æ³•æ·»åŠ åˆ°ç±»ä¸­ï¼Œé‚£ä¹ˆæ„å‘³ç€å®ç°åŒæ­¥ç­–ç•¥çš„æ‰€æœ‰ä»£ç ä»ç„¶å¤„äºä¸€ä¸ªæºæ–‡ä»¶ä¸­ï¼Œä»è€Œæ›´å®¹æ˜“ç»´æŠ¤ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨å­ç±»æ‰©å±•è¿™ä¸ªç±»ï¼Œä½†è¿™æ ·çš„è¯åŒæ­¥ç­–ç•¥çš„å®ç°å°±åˆ†å¸ƒåœ¨äº†å¤šä¸ªéœ€è¦å•ç‹¬ç»´æŠ¤çš„æºæ–‡ä»¶ä¸­ï¼Œå¦‚æœçˆ¶ç±»ä¿®æ”¹äº†åŒæ­¥ç­–ç•¥é€‰æ‹©ä¸åŒçš„é”æ¥ä¿æŠ¤å®ƒçš„çŠ¶æ€å˜é‡ï¼Œé‚£å­ç±»ä¹Ÿéœ€è¦è·Ÿç€å˜ã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼š1234567891011// æ‰©å±•Vectorå¹¶å¢åŠ ä¸€ä¸ªâ€œè‹¥æ²¡æœ‰åˆ™æ·»åŠ â€æ–¹æ³•public class BetterVector&lt;E&gt; extends Vector&lt;E&gt; &#123; public synchronized boolean putIfAbsent(E x) &#123; boolean absent = !contains(x); if (absent) &#123; add(x); &#125; return absent &#125;&#125; å®¢æˆ·ç«¯åŠ é”æœºåˆ¶ç¬¬ä¸‰ç§ç­–ç•¥æ˜¯æ‰©å±•ç±»çš„åŠŸèƒ½ï¼Œä½†å¹¶ä¸æ˜¯æ‰©å±•ç±»æœ¬èº«ï¼Œè€Œæ˜¯å°†æ‰©å±•æ–¹æ³•æ”¾åœ¨ä¸€ä¸ªè¾…åŠ©ç±»ï¼ˆHelper classï¼‰ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š1234567891011public class ListHelper&lt;E&gt; &#123; public List&lt;E&gt; list = Collections.synchronizedList(new ArrayList&lt;E&gt;()); ... public synchronized boolean putIfAbsent(E x) &#123; boolean absent = !list.contains(x); if(absent) &#123; list.add(x); &#125; return absent; &#125;&#125; putIfAbsentç”¨çš„æ˜¯ListHelperçš„å†…ç½®é”ï¼Œä½†listç”¨çš„è‚¯å®šä¸æ˜¯ListHelperçš„é”ï¼Œå°½ç®¡æ‰€æœ‰çš„listæ“ä½œéƒ½è¢«å£°æ˜ä¸ºsynchronizedï¼Œä½†å´æ˜¯ä¸ä¸€æ ·çš„é”ï¼Œè¿™å°±æ— æ³•ç¡®ä¿å½“putIfAbsentæ‰§è¡Œæ—¶å¦ä¸€ä¸ªçº¿ç¨‹ä¸ä¼šä¿®æ”¹è¿™ä¸ªlistã€‚ è¦æƒ³ä½¿è¿™ä¸ªæ–¹æ³•æ­£ç¡®æ‰§è¡Œï¼Œå¿…é¡»ä½¿liståœ¨å®ç°å®¢æˆ·ç«¯åŠ é”æˆ–å¤–éƒ¨åŠ é”æ—¶ä½¿ç”¨åŒä¸€ä¸ªé”ã€‚å®¢æˆ·ç«¯åŠ é”æ˜¯æŒ‡ï¼Œå¯¹äºä½¿ç”¨æŸä¸ªå¯¹è±¡Xçš„å®¢æˆ·ç«¯ä»£ç ï¼Œä½¿ç”¨Xæœ¬èº«ç”¨äºä¿æŠ¤å…¶çŠ¶æ€çš„é”æ¥ä¿æŠ¤è¿™æ®µå®¢æˆ·ç«¯ä»£ç ã€‚è¦ä½¿ç”¨å®¢æˆ·ç«¯åŠ é”ï¼Œå°±å¿…é¡»çŸ¥é“å¯¹è±¡Xä½¿ç”¨çš„æ˜¯å“ªä¸€ä¸ªé”ã€‚åœ¨Vectorå’ŒåŒæ­¥å°è£…å™¨ç±»çš„æ–‡æ¡£ä¸­æŒ‡å‡ºï¼Œå®ƒä»¬é€šè¿‡ä½¿ç”¨Vectoræˆ–å°è£…å™¨å®¹å™¨çš„å†…ç½®é”æ¥æ”¯æŒå®¢æˆ·ç«¯åŠ é”ã€‚æ‰€ä»¥ä¿®æ”¹åçš„putIfAbsentå¦‚ä¸‹ï¼š12345678910111213public class ListHelper&lt;E&gt; &#123; public List&lt;E&gt; list = Collections.synchronizedList(new ArrayList&lt;E&gt;()); ... public boolean putIfAbsent(E x) &#123; synchronized(list) &#123; boolean absent = !list.contains(x); if(absent) &#123; list.add(x); &#125; return absent; &#125; &#125;&#125; ç»„åˆæ›´å¥½åœ°ä¸ºç°æœ‰ç±»æ·»åŠ åŸå­æ“ä½œçš„æ–¹æ³•æ˜¯ï¼šç»„åˆã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617public class ImprovedList&lt;T&gt; implements List&lt;T&gt; &#123; private final list&lt;T&gt; list; public ImprovedList(List&lt;T&gt; list) &#123; this.list = list; &#125; public synchronized boolean putIfAbsent(T x) &#123; boolean contains = list.contains(x); if(!contains) &#123; list.add(x); &#125; return !contains; &#125; public synchronized void clear() &#123; list.clear(); &#125;&#125; ImprovedListé€šè¿‡è‡ªèº«çš„å†…ç½®é”å¢åŠ äº†ä¸€å±‚é¢å¤–çš„åŠ é”ã€‚å®ƒå¹¶ä¸å…³å¿ƒListæ˜¯å¦æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå³ä½¿Listä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„æˆ–è€…ä¿®æ”¹äº†å®ƒçš„åŠ é”å®ç°ï¼ŒImprovedListä¹Ÿä¼šæä¾›ä¸€è‡´çš„åŠ é”æœºåˆ¶æ¥å®ç°çº¿ç¨‹å®‰å…¨æ€§ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Javaç›‘è§†å™¨æ¨¡å¼æ¥å°è£…ç°æœ‰çš„Listï¼Œå¹¶ä¸”åªè¦åœ¨ç±»ä¸­æ‹¥æœ‰æŒ‡å‘åº•å±‚Listçš„å”¯ä¸€å¤–éƒ¨å¼•ç”¨ï¼Œå°±èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨æ€§ã€‚ æ€»ç»“è®¾è®¡ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç±»æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œæåˆ°äº†ä¸‰ç‚¹ï¼šå®ä¾‹å°é—­ã€çº¿ç¨‹å§”æ‰˜ã€å¤ç”¨ç°æœ‰åŸºç¡€ç±»ã€‚ä½†æ˜¯å…·ä½“å®ç°çº¿ç¨‹å®‰å…¨éƒ½ä¸ä¸€æ ·ï¼Œéœ€è¦æŒ‰å®é™…æƒ…å†µæ¥ç¡®å®šã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_2_å¯¹è±¡çš„å…±äº«]]></title>
    <url>%2F2018%2F01%2F13%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-2-%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%85%B1%E4%BA%AB%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸ºäº†èƒ½å¤Ÿå®‰å…¨åœ°ç”±å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®æŸä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±éœ€è¦å­¦ä¼šåœ¨å…±äº«å’Œå‘å¸ƒå¯¹è±¡æ—¶ï¼Œæ„å»ºä¸€ä¸ªçº¿ç¨‹å®‰å…¨ç±»æˆ–è€…é€šè¿‡java.util.concurrentç±»åº“æ¥æ„å»ºã€‚ å¯è§æ€§åœ¨è¯»æ“ä½œå’Œå†™æ“ä½œåœ¨ä¸åŒçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬æ— æ³•ç¡®ä¿æ‰§è¡Œè¯»æ“ä½œçš„çº¿ç¨‹èƒ½é€‚æ—¶åœ°çœ‹åˆ°å…¶ä»–çº¿ç¨‹å†™å…¥çš„å€¼ï¼Œæ‰€è°“â€œä¸å¯è§â€ã€‚ä¸ºäº†ç¡®ä¿å¤šä¸ªçº¿ç¨‹ä¹‹é—´å¯¹å†…å­˜å†™å…¥æ“ä½œçš„å¯è§æ€§ï¼Œå¿…é¡»ä½¿ç”¨åŒæ­¥æœºåˆ¶ã€‚ å…ˆçœ‹ä¸‹é¢çš„ä»£ç ï¼š12345678910111213141516171819public class NoVisibility &#123; private static boolean ready; private static int number; private static class ReaderThread extends Thread &#123; public void run() &#123; while(!ready) &#123; Thread.yield(); &#125; System.out.println(number); &#125; &#125; public static void main(String[] args) &#123; new ReaderThread().start(); number = 42; ready = true; &#125;&#125; è¿™æ®µä»£ç ä¸èƒ½ä¿è¯è¾“å‡º42ï¼Œå¯èƒ½è¾“å‡º0ï¼Œå› ä¸ºè¯»çº¿ç¨‹å¯èƒ½çœ‹åˆ°äº†å†™å…¥readyçš„å€¼ï¼Œä½†å´æ²¡æœ‰çœ‹åˆ°ä¹‹åå†™å…¥çš„numberçš„å€¼ï¼Œè¿™ç§ç°è±¡ç§°ä¸ºâ€œé‡æ’åºâ€ï¼Œå®ƒçš„æ„æ€æ˜¯ä»£ç çš„é¡ºåºå¯èƒ½å› ä¸ºä¼˜åŒ–è€Œå‘ç”Ÿé‡æ’åºã€‚ å¤±æ•ˆæ•°æ®å¤±æ•ˆæ•°æ®ï¼šå½“è¯»çº¿ç¨‹æŸ¥çœ‹ä¸€ä¸ªå˜é‡æ˜¯ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå·²ç»å¤±æ•ˆçš„å€¼ã€‚é™¤éåœ¨æ¯æ¬¡è®¿é—®å˜é‡æ—¶éƒ½ä½¿ç”¨åŒæ­¥ï¼Œå¦åˆ™å¾ˆå¯èƒ½è·å¾—è¯¥å˜é‡çš„ä¸€ä¸ªå¤±æ•ˆå€¼ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¤±æ•ˆå€¼å¯èƒ½ä¸ä¼šåŒæ—¶å‡ºç°ï¼šä¸€ä¸ªçº¿ç¨‹å¯èƒ½å¾—åˆ°æŸä¸ªå˜é‡çš„æœ€æ–°å€¼ï¼Œè€Œè·å¾—å¦ä¸€ä¸ªå˜é‡çš„å¤±æ•ˆå€¼ã€‚ ä¸‹é¢çš„ä»£ç ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼š12345678910111213@NonThreadSafepublic class MutableInteger &#123; private int value; public int get() &#123; return value; &#125; public void set(int value) &#123; this.value = value; &#125;&#125; getå’Œsetéƒ½æ˜¯åœ¨æ²¡æœ‰åŒæ­¥çš„æƒ…å†µä¸‹è®¿é—®valueï¼Œæ‰€ä»¥å¤±æ•ˆå€¼é—®é¢˜å¾ˆå®¹æ˜“å‡ºç°ï¼šå¦‚æœæŸä¸ªçº¿ç¨‹åœ¨è°ƒç”¨äº†getï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªæ­£åœ¨è°ƒç”¨getçš„çº¿ç¨‹å¯èƒ½ä¼šçœ‹åˆ°æ›´æ–°åçš„valueå€¼ï¼Œä¹Ÿå¯èƒ½çœ‹ä¸åˆ°ã€‚è¦ä½¿MutableIntegeræˆä¸ºä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œå¿…é¡»å¯¹setå’Œgetéƒ½è¿›è¡ŒåŒæ­¥ã€‚ éåŸå­çš„64ä½æ“ä½œæœ€ä½å®‰å…¨æ€§ï¼ˆout-of-thin-air-safetyï¼‰:å½“çº¿ç¨‹åœ¨æ²¡æœ‰åŒæ­¥çš„æƒ…å†µä¸‹è¯»å–å˜é‡æ—¶ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå¤±æ•ˆå€¼ï¼Œä½†è‡³å°‘è¿™ä¸ªå€¼æ˜¯ç”±ä¹‹å‰æŸä¸ªçº¿ç¨‹è®¾ç½®çš„å€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªéšæœºå€¼ã€‚ ä¾‹å¤–ï¼šå¯¹äºévolatileç±»å‹çš„longå’Œdoubleå˜é‡ï¼ŒJVMå…è®¸64ä½çš„è¯»æ“ä½œå’Œå†™æ“ä½œåˆ†è§£ä¸ºä¸¤ä¸ª32ä½çš„æ“ä½œã€‚é‚£ä¹ˆå¾ˆæœ‰å¯èƒ½ä¼šè¯»åˆ°æŸä¸ªå€¼çš„é«˜32ä½å’Œå¦ä¸€ä¸ªå€¼çš„ä½32ä½ã€‚æ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ä½¿ç”¨å…±äº«ä¸”å¯å˜çš„longå’Œdoubleç­‰ç±»å‹çš„å˜é‡æ˜¯ä¸å®‰å…¨çš„ï¼Œé™¤éä½¿ç”¨å…³é”®å­—volatileæ¥å£°æ˜ä»–ä»¬ï¼Œæˆ–è€…ç”¨é”ä¿æŠ¤èµ·æ¥ã€‚ volatileå˜é‡volatileå˜é‡å¯ä»¥ç¡®ä¿å°†å˜é‡çš„æ›´æ–°æ“ä½œé€šçŸ¥åˆ°å…¶ä»–çº¿ç¨‹ã€‚å¹¶ä¸”ä¼šç¦æ­¢é‡æ’åºï¼Œå› æ­¤åœ¨è¯»å–volatileç±»å‹çš„å˜é‡æ—¶æ€»ä¼šè¿”å›æœ€æ–°å†™å…¥çš„å€¼ã€‚volatileé€šå¸¸ç”¨ä½œæŸä¸ªæ“ä½œå®Œæˆã€‚å‘ç”Ÿä¸­æ–­æˆ–è€…çŠ¶æ€çš„æ ‡å¿—ã€‚å®ƒåªèƒ½ä¿è¯å¯è§æ€§ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚ å½“ä¸”ä»…å½“æ»¡è¶³æ‰€æœ‰æ¡ä»¶æ—¶ï¼Œæ‰åº”è¯¥ä½¿ç”¨volatileå˜é‡ï¼š å¯¹å˜é‡çš„å†™å…¥æ“ä½œä¸ä¾èµ–å˜é‡çš„å½“å‰å€¼ï¼ˆæ¯”è¯»åˆ°çš„è¿˜è¦æ–°çš„å€¼ï¼‰ï¼Œæˆ–è€…ä½ èƒ½ä¿è¯åªæœ‰å½“ä¸ªçº¿ç¨‹æ›´æ–°å˜é‡çš„å€¼ã€‚ è¯¥å˜é‡ä¸ä¼šä¸å…¶ä»–çŠ¶æ€å˜é‡ä¸€èµ·çº³å…¥ä¸å˜æ€§æ¡ä»¶ä¸­ã€‚ åœ¨è®¿é—®å˜é‡æ—¶ä¸éœ€è¦åŠ é”ã€‚ å‘å¸ƒå’Œé€¸å‡ºâ€œå‘å¸ƒï¼ˆPublishï¼‰â€å¯¹è±¡ï¼šä½¿å¯¹è±¡èƒ½å¤Ÿåœ¨å½“å‰ä½œç”¨åŸŸä¹‹å¤–çš„ä»£ç ä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼šå°†ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°å…¶ä»–ä»£ç å¯ä»¥è®¿é—®çš„åœ°æ–¹ï¼ˆå…¬æœ‰çš„é™æ€å˜é‡ä¸­ï¼‰ â€œé€¸å‡ºï¼ˆEscapeï¼‰â€ï¼šå½“æŸä¸ªä¸åº”è¯¥å‘å¸ƒçš„å¯¹è±¡è¢«å‘å¸ƒã€‚ä¾‹å¦‚ï¼šåœ¨å¯¹è±¡æ„é€ å®Œæˆä¹‹å‰å°±å‘å¸ƒå¯¹è±¡ å‘å¸ƒå¯¹è±¡çš„æœ€ç®€å•æ–¹æ³•æ˜¯å°†å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°ä¸€ä¸ªå…¬æœ‰çš„é™æ€å˜é‡ä¸­ï¼Œä»¥ä¾¿ä»»ä½•ç±»å’Œçº¿ç¨‹éƒ½èƒ½çœ‹è§è¯¥å¯¹è±¡ï¼Œå¦‚ä¸‹é¢ä»£ç ï¼š12345public static Set&lt;Secret&gt; knownSecrets;public void initialize() &#123; knownSecrets = new HashSet&lt;Secret&gt;();&#125; å½“å‘å¸ƒæŸä¸ªå¯¹è±¡æ—¶ï¼Œå¯èƒ½ä¼šé—´æ¥åœ°å‘å¸ƒå…¶ä»–å¯¹è±¡ã€‚å¦‚æœå°†ä¸€ä¸ªSecretå¯¹è±¡æ·»åŠ åˆ°é›†åˆknownSecretsä¸­ï¼Œé‚£ä¹ˆåŒæ ·ä¼šå‘å¸ƒè¿™ä¸ªå¯¹è±¡ï¼Œå› ä¸ºä»»ä½•ä»£ç éƒ½å¯ä»¥éå†è¿™ä¸ªé›†åˆï¼Œå¹¶è·å¾—å¯¹è¿™ä¸ªæ–°Secretå¯¹è±¡çš„å¼•ç”¨ã€‚åŒæ ·ï¼Œå¦‚æœä»éç§æœ‰æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªå¼•ç”¨ï¼Œé‚£ä¹ˆåŒæ ·ä¼šå‘å¸ƒè¿”å›çš„å¯¹è±¡ã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼š123456class UnsafeStates &#123; private String[] states = new String[] &#123;"AK","AL"...&#125;; public String[] getStates() &#123; return states; &#125;&#125; å¦ä¸€ç§å°†ä¸€ä¸ªå¯¹è±¡æˆ–è€…å®ƒå†…éƒ¨çš„çŠ¶æ€publishå‡ºå»çš„æ–¹å¼å°±æ˜¯publishè¿™ä¸ªå¯¹è±¡æ‰€åœ¨ç±»çš„å†…éƒ¨ç±»ï¼Œå¦‚ä¸‹ä¾‹å­,ä½†æ˜¯ä¼šå°†thiså¯¹è±¡çš„å¼•ç”¨escapeå‡ºå»ã€‚å› ä¸ºå½“ThisEscapeå°†EventListener publishå‡ºå»ï¼Œå®ƒå°±æ˜¾ç¤ºåœ°å°†å¤–éƒ¨ç±»ThisEscapeå®ä¾‹å¯¹è±¡ä¹Ÿå…¬å¸ƒå‡ºå»äº†ï¼Œå› ä¸ºå†…éƒ¨ç±»å®ä¾‹ä¿å­˜äº†å¤–éƒ¨ç±»å®ä¾‹çš„éšè—å¼•ç”¨ã€‚æ‰€ä»¥ä¼šæŠŠthis escapeå‡ºå»ã€‚1234567891011public class ThisEscape &#123; public public ThisEscape(EventSource source) &#123; source.registerListener( new EventListener() &#123; public void onEvent(Event o) &#123; doSomething(o);// ç”±äºè¿™ä¸ªçº¿ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€æœ‰EventSourceå¯èƒ½è¿˜æ²¡æœ‰æ„é€ å®Œ &#125; &#125;); &#125;&#125; å½“å†…éƒ¨EventListenerå®ä¾‹å‘å¸ƒæ—¶ï¼Œåœ¨å¤–éƒ¨å°è£…çš„ThisEscapeå®ä¾‹ä¹Ÿé€¸å‡ºäº†ï¼Œå½“ä¸”ä»…å½“å¯¹è±¡çš„æ„é€ å‡½æ•°è¿”å›æ—¶ï¼Œå¯¹è±¡æ‰å¤„äºå¯é¢„æµ‹çš„å’Œä¸€è‡´çš„çŠ¶æ€ã€‚ä¸€ä¸ªå¸¸è§çš„ä½¿thiså¼•ç”¨åœ¨æ„é€ è¿‡ç¨‹ä¸­é€¸å‡ºçš„é”™è¯¯æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ã€‚å¦‚æœæƒ³åœ¨æ„é€ å‡½æ•°ä¸­æ³¨å†Œä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨æˆ–å¯åŠ¨çº¿ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç§æœ‰çš„æ„é€ å‡½æ•°å’Œä¸€ä¸ªå…¬å…±çš„å·¥å‚æ–¹æ³•ï¼Œä»è€Œé¿å…ä¸æ­£ç¡®çš„æ„é€ è¿‡ç¨‹ï¼š123456789101112131415161718public class SafeListener &#123; private final EventListener listener; private SafeListener() &#123; listener = new EventListener() &#123; public void onEvent(Event o) &#123; doSomething(o); &#125; &#125; &#125; public static SafeListener newInstance(EventSource source) &#123; SafeListener safeListener = new SafeListener(); source.registerListener(safeListener); return safeListener; &#125;&#125; çº¿ç¨‹å°é—­å½“è®¿é—®å…±äº«çš„å¯å˜æ•°æ®æ—¶ï¼Œé€šå¸¸éœ€è¦åŒæ­¥ã€‚ä¸€ç§é¿å…ä½¿ç”¨åŒæ­¥çš„æ–¹å¼å°±æ˜¯ä¸å…±äº«æ•°æ®ã€‚å¦‚æœä»…åœ¨å•çº¿ç¨‹å†…è®¿é—®æ•°æ®ï¼Œå°±ä¸éœ€è¦åŒæ­¥ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºçº¿ç¨‹å°é—­ã€‚ çº¿ç¨‹å°é—­çš„ä¸€ä¸ªå¸¸è§åº”ç”¨æ˜¯ä»æ± ä¸­æ‹¿JDBC Connectionã€‚åœ¨å…¸å‹çš„æœåŠ¡å™¨åº”ç”¨ä¸­ï¼Œä¸€ä¸ªçº¿ç¨‹ä»æ± ä¸­è·å–connectionå¯¹è±¡ï¼Œç”¨å®ƒæ¥å¤„ç†ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œå¤„ç†å®Œåå½’è¿˜è¯¥connectionï¼Œåˆæ”¾å…¥æ± ä¸­ã€‚Connectionæ± æ˜¯ä¸ä¼šæŠŠç›¸åŒçš„connectionå¯¹è±¡åˆ†é…ç»™ä¸åŒçš„çº¿ç¨‹çš„ï¼Œè¿™ç§æ¨¡å¼å°±æ˜¾å¼åœ°å°†é‚£ä¸ªconnectionå°é—­åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ã€‚ å±€éƒ¨å˜é‡å’ŒThreadLocalç±»å°±æ˜¯ç”¨æ¥ç»´æŠ¤çº¿ç¨‹å°é—­ç‰¹æ€§çš„ï¼Œä½†å³ä¾¿æœ‰è¿™äº›ç°æˆçš„ç‰¹æ€§ï¼Œç¨‹åºå‘˜ä»æœ‰ä¹‰åŠ¡å»ä¿è¯å°é—­åœ¨çº¿ç¨‹ä¸­çš„å¯¹è±¡ä¸ä¼šä»çº¿ç¨‹ä¸­é€¸å‡º Ad-hocçº¿ç¨‹å°é—­è¿™ç§çº¿ç¨‹å°é—­æ˜¯æŒ‡ï¼Œç»´æŠ¤çº¿ç¨‹å°é—­æ€§çš„èŒè´£å®Œå…¨ç”±ç¨‹åºå®ç°æ¥æ‰¿æ‹…ã€‚è¿™ç§æŠ€æœ¯å¾ˆè„†å¼±ï¼Œå› æ­¤ç¨‹åºä¸­å°½é‡å°‘ç”¨å®ƒã€‚ æ ˆå°é—­æ ˆå°é—­å¼çº¿ç¨‹å°é—­çš„ä¸€ç§ç‰¹ä¾‹ï¼Œåœ¨æ ˆå°é—­ä¸­ï¼Œåªèƒ½é€šè¿‡å±€éƒ¨å˜é‡æ‰èƒ½è®¿é—®å¯¹è±¡ã€‚å±€éƒ¨å˜é‡çš„å›ºæœ‰å±æ€§ä¹‹ä¸€å°±æ˜¯å°é—­åœ¨æ‰§è¡Œçº¿ç¨‹ä¸­ï¼Œå®ƒä»¬ä½äºæ‰§è¡Œçº¿ç¨‹çš„æ ˆä¸­ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®è¿™ä¸ªæ ˆã€‚æ ˆå°é—­æ¯”Ad-hocçº¿ç¨‹å°é—­æ›´æ˜“äºç»´æŠ¤ï¼Œä¹Ÿæ›´åŠ å¥å£®ã€‚å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š123456789101112131415161718public int loadTheArk(Collections&lt;Animal&gt; candidates) &#123; SortedSet&lt;Animal&gt; animals; int numPairs = 0; Animals candidate = null; animals = new TreeSet&lt;Animal&gt;(new SpeciesGenderComparator()); animals.addAll(candidates); for(animals a : animals) &#123; if (candidate == null || !candidate.isPotentialMate(a)) &#123; candidate = a; &#125; else &#123; ark.load(new AnimalPair(candidate, a)); ++numPairs; candidate = null; &#125; &#125; return numPairs; &#125; ä¸Šé¢ä»£ç ä¸­çš„numPairsä¸ä¼šç ´åçº¿ç¨‹å°é—­æ€§ï¼Œå› ä¸ºä»»ä½•æ–¹æ³•éƒ½æ— æ³•è·å¾—å¯¹åŸºæœ¬ç±»å‹çš„å¼•ç”¨ï¼Œæ‰€ä»¥åŸºæœ¬ç±»å‹çš„å±€éƒ¨å˜é‡å§‹ç»ˆå°é—­åœ¨çº¿ç¨‹å†…ã€‚ä½†æ˜¯å¯¹äºå¯¹è±¡å¼•ç”¨çš„çº¿ç¨‹å°é—­ï¼Œå°±éœ€è¦ä¸€äº›é¢å¤–çš„å·¥ä½œç¡®ä¿å¯¹è±¡å¼•ç”¨ä¸ä¼šé€¸å‡ºã€‚åœ¨ä¸Šä¾‹ä¸­å®ä¾‹åŒ–äº†ä¸€ä¸ªTreeSet,å¹¶ç”¨animalså¼•ç”¨æŒ‡å‘å®ƒï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘è¿™ä¸ªSetï¼Œè€Œä¸”è¿™ä¸ªå¼•ç”¨æ˜¯å±€éƒ¨å˜é‡ï¼Œæ‰€ä»¥è¿™ä¸ªå¯¹è±¡å¼•ç”¨ä¹Ÿè¢«å°é—­åœ¨çº¿ç¨‹ä¸­ã€‚ä½†æ˜¯å¦‚æœæŠŠè¿™ä¸ªanimalså…¬å¸ƒï¼ˆpublishï¼‰å‡ºå»ï¼Œçº¿ç¨‹å°é—­æ€§å°±ä¼šç ´åŒ–ã€‚ ThreadLocalç±»ç»´æŠ¤çº¿ç¨‹å°é—­æ€§çš„ä¸€ç§æ›´è§„èŒƒçš„æ–¹å¼æ˜¯ä½¿ç”¨ThreadLocal. ThreadLocalæä¾›äº†getå’Œsetæ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¸ºæ¯ä¸ªä½¿ç”¨è¯¥å˜é‡çš„çº¿ç¨‹éƒ½å­˜æœ‰ä¸€ä»½ç‹¬ç«‹çš„å‰¯æœ¬ï¼Œå› æ­¤getæ€»æ˜¯è¿”å›ç”±å½“å‰æ‰§è¡Œçº¿ç¨‹åœ¨è°ƒç”¨setæ—¶è®¾ç½®çš„æœ€æ–°å€¼ã€‚ ä¾‹å¦‚ï¼Œåœ¨å•çº¿ç¨‹åº”ç”¨ç¨‹åºä¸­å¯èƒ½ä¼šç»´æŒä¸€ä¸ªå…¨å±€çš„æ•°æ®åº“è¿æ¥ï¼Œå¹¶åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–è¿™ä¸ªè¿æ¥å¯¹è±¡ï¼Œä»è€Œé¿å…åœ¨è°ƒç”¨æ¯ä¸ªæ–¹æ³•æ—¶éƒ½è¦ä¼ é€’ä¸€ä¸ªConnectionå¯¹è±¡ã€‚ç”±äºJDBCçš„è¿æ¥å¯¹è±¡ä¸ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤ï¼Œå½“å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºåœ¨æ²¡æœ‰ååŒçš„æƒ…å†µä¸‹ä½¿ç”¨å…¨å±€å˜é‡æ—¶ï¼Œå°±ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚é€šè¿‡å°†JDBCçš„è¿æ¥ä¿å­˜åˆ°ThreadLocalå¯¹è±¡ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæ‹¥æœ‰å±äºè‡ªå·±çš„è¿æ¥ï¼Œå¦‚ä¸‹ï¼š123456789private static ThreadLocal&lt;Connection&gt; connectionHolder = new ThreadLocal&lt;&gt;()&#123; public Connection initialValue() &#123; return DriverManager.getConnection(DB_URL); &#125;&#125;;public static Connection getConnection() &#123; return connectionHolder.get();&#125; å½“æŸä¸ªçº¿ç¨‹åˆæ¬¡è°ƒç”¨ThreadLocal.getæ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨initialValue()æ–¹æ³•æ¥è·å–åˆå§‹å€¼ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œå¯ä»¥å°†ThreadLocalè§†ä¸ºåŒ…å«äº†Mapå¯¹è±¡ï¼Œå…¶ä¸­ä¿å­˜äº†åªå±äºè¯¥çº¿ç¨‹çš„å€¼ã€‚å½“çº¿ç¨‹ç»ˆæ­¢åï¼Œè¿™äº›å€¼å°±ä¼šä½œä¸ºåƒåœ¾è¢«å›æ”¶æ‰ã€‚ ä¸å˜æ€§å¦‚æœæŸä¸ªå¯¹è±¡åœ¨åˆ›å»ºä¹‹åçŠ¶æ€å°±ä¸èƒ½è¢«ä¿®æ”¹ï¼Œé‚£è¿™ä¸ªå¯¹è±¡å°±è¢«ç§°ä¸ºä¸å¯å˜å¯¹è±¡ã€‚ä¸å¯å˜å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸å¯å˜å¯¹è±¡åªæœ‰ä¸€ç§çŠ¶æ€ï¼Œè€Œä¸”è¿™ç§çŠ¶æ€ç”±æ„é€ å‡½æ•°æ¥æ§åˆ¶ã€‚ å½“æ»¡è¶³ä¸€ä¸‹æ¡ä»¶çš„æ—¶å€™ï¼Œå¯¹è±¡æ‰æ˜¯ä¸å¯å˜çš„ï¼š å¯¹è±¡åˆ›å»ºä»¥åå…¶çŠ¶æ€å°±ä¸èƒ½ä¿®æ”¹ å¯¹è±¡çš„æ‰€æœ‰åŸŸéƒ½æ˜¯finalç±»å‹ å¯¹è±¡æ˜¯æ­£ç¡®åˆ›å»ºçš„ï¼ˆåœ¨å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œthiså¼•ç”¨æ²¡æœ‰é€¸å‡ºï¼‰ ä¸å¯å˜å¯¹è±¡ä»ç„¶å¯ä»¥åœ¨å†…éƒ¨ä½¿ç”¨å¯å˜å¯¹è±¡æ¥ç®¡ç†å®ƒä»¬çš„çŠ¶æ€ã€‚å¦‚ä¸‹ä¾‹ï¼š12345678910111213141516@Immutablepublic final class ThreeStooges &#123; private final Set&lt;String&gt; stooges = new HashSet&lt;&gt;(); public ThreeStooges() &#123; stooges.add("Moe"); stooges.add("Larry"); stooges.add("Curly"); &#125; public boolean isStooge(String name)&#123; return stooges.contains(name); &#125;&#125; FinalåŸŸæ­£å¦‚â€œé™¤ééœ€è¦æ›´é«˜çš„å¯è§æ€§ï¼Œå¦åˆ™åº”å°†æ‰€æœ‰çš„åŸŸéƒ½å£°æ˜ä¸ºç§æœ‰åŸŸâ€ä¸€æ ·ï¼Œâ€œé™¤ééœ€è¦æŸä¸ªåŸŸæ˜¯å¯å˜çš„ï¼Œå¦åˆ™åº”å°†å…¶å£°æ˜ä¸ºfinalåŸŸâ€ä¹Ÿæ˜¯ä¸€ä¸ªè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚ ä½¿ç”¨Volatileç±»å‹æ¥å‘å¸ƒä¸å¯å˜å¯¹è±¡ä¸ºäº†ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œå¯ä»¥å°†å¤šä¸ªçŠ¶æ€è½¬åŒ–ä¸ºåŒ…å«å¤šä¸ªçŠ¶æ€çš„ä¸å¯å˜å¯¹è±¡ï¼Œç„¶åä½¿ç”¨volatileæ¥ä¿æŒå¯è§æ€§ï¼Œä»è€Œä¿è¯äº†çº¿ç¨‹å®‰å…¨ã€‚å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š1234567891011121314151617181920212223242526272829303132public class VolatileCachedFactorizer implements Servlet&#123; private volatile OneValueCache cache = new OneValueCache(null, null); public void service(ServletRequest req, ServletResponse resp) &#123; BigInteger i = extractFromRequest(req); BigInteger[] factors = cache.getFactors(i); if (factors == null) &#123; factors = factor(i); cache = new OneValueCache(i, factors); &#125; encodeIntoResponse(resp, factors); &#125;&#125;class OneValueCache &#123; private final BigInteger lastNumber; private final BigInteger[] lastFactos; public OneValueCache(BigInteger i, BigInteger[] factors) &#123; lastNumber = i; lastFactos = Arrays.copyOf(factors, factors.length); &#125; public BigInteger[] getFactors(BigInteger i) &#123; if (lastNumber == null || !lastNumber.equals(i)) &#123; return null; &#125; else &#123; return Arrays.copyOf(lastFactos, lastFactos.length); &#125; &#125;&#125; å®‰å…¨å‘å¸ƒåœ¨æŸäº›æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›åœ¨å¤šä¸ªçº¿ç¨‹é—´å…±äº«å¯¹è±¡ï¼Œæ­¤æ—¶å¿…é¡»ç¡®ä¿å®‰å…¨åœ°è¿›è¡Œå…±äº«ã€‚ ä¸æ­£ç¡®çš„å‘å¸ƒï¼šå¯è§æ€§å‡ºç°é—®é¢˜ä¾‹å­ï¼š12345678910111213141516public Holder hoder;public void initialize() &#123; holder = new Holder(42);&#125;public class Holder &#123; private int n; public Holder(int n) &#123; this.n = n; &#125; public void assertSanity() &#123; if(n != n) &#123; throw new AssertionError("This statement is false"); &#125; &#125;&#125; å› ä¸ºé™¤äº†å‘å¸ƒå¯¹è±¡çš„çº¿ç¨‹å¤–ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥çœ‹åˆ°çš„HolderåŸŸå¯èƒ½æ˜¯ä¸€ä¸ªå¤±æ•ˆå€¼ã€‚ ä¸å¯å˜å¯¹è±¡ä¸åˆå§‹åŒ–å®‰å…¨æ€§ä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥åœ¨ä¸éœ€è¦é¢å¤–åŒæ­¥çš„æƒ…å†µä¸‹å®‰å…¨åœ°è®¿é—®ä¸å¯å˜å¯¹è±¡ï¼Œå³ä½¿åœ¨å‘å¸ƒè¿™äº›å¯¹è±¡æ—¶æ²¡æœ‰ä½¿ç”¨åŒæ­¥ã€‚ å®‰å…¨å‘å¸ƒçš„å¸¸ç”¨æ¨¡å¼è¦å®‰å…¨åœ°å‘å¸ƒä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å®ƒçš„å¼•ç”¨å’ŒçŠ¶æ€å¿…é¡»åŒæ—¶å¯¹å…¶ä»–çº¿ç¨‹å¯è§ã€‚ä¸€ä¸ªæ­£ç¡®æ„é€ çš„å¯¹è±¡å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®‰å…¨åœ°å‘å¸ƒï¼š åœ¨é™æ€åˆå§‹åŒ–å‡½æ•°ä¸­åˆå§‹åŒ–å¯¹è±¡çš„å¼•ç”¨ æŠŠå¯¹è±¡çš„å¼•ç”¨ä¿å­˜åœ¨volatileç±»å‹çš„åŸŸæˆ–è€…AtomicReferenceå¯¹è±¡ä¸­ å°†å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°æŸä¸ªæ­£ç¡®æ„é€ çš„finalå¯¹è±¡çš„åŸŸä¸­ å°†å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°ä¸€ä¸ªç”±é”ä¿æŠ¤çš„åŸŸä¸­ ä½¿ç”¨é™æ€åˆå§‹åŒ–å‡½æ•°é€šå¸¸æ˜¯æœ€ç®€å•æœ€å®‰å…¨çš„å‘å¸ƒæ–¹å¼:1public static Holder holder = new Holder(42); é™æ€åˆå§‹åŒ–å™¨ç”±JVMåœ¨ç±»çš„åˆå§‹åŒ–é˜¶æ®µæ‰§è¡Œï¼Œç”±äºJVMå†…éƒ¨å­˜åœ¨åœ¨åŒæ­¥æœºåˆ¶ï¼Œå› æ­¤é€šè¿‡è¿™ç§æ–¹å¼åˆå§‹åŒ–çš„ä»»ä½•å¯¹è±¡éƒ½å“¦å¯ä»¥è¢«å®‰å…¨å‘å¸ƒã€‚ äº‹å®ä¸å¯å˜å¯¹è±¡å¦‚æœå¯¹è±¡åœ¨æŠ€æœ¯ä¸Šæ¥çœ‹æ˜¯å¯å˜çš„ï¼Œä½†å…¶çŠ¶æ€åœ¨å‘å¸ƒä¹‹åä¸ä¼šå†æ”¹å˜ï¼Œé‚£ä¹ˆè¿™ç§å¯¹è±¡æˆä¸ºâ€œå®é™…ä¸å¯å˜å¯¹è±¡â€ï¼Œåœ¨è¿™äº›å¯¹è±¡å‘å¸ƒä¹‹åï¼Œç¨‹åºä¹‹éœ€è¦å°†å®ƒä»¬è§†ä¸ºä¸å¯å˜å¯¹è±¡å³å¯ã€‚æ‰€ä»¥å¦‚æœç¡®è®¤æŸäº›å¯¹è±¡æ˜¯å®é™…ä¸å¯å˜å¯¹è±¡ï¼Œå°±å¯ä»¥ç®€åŒ–å¼€å‘å‡å°‘åŒæ­¥ä»è€Œæå‡æ€§èƒ½ã€‚ å¯å˜å¯¹è±¡å¦‚æœå¯¹è±¡åœ¨æ„é€ åå¯ä»¥è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆå®‰å…¨å‘å¸ƒåªèƒ½ç¡®ä¿è¿™ä¸ªå¯¹è±¡åœ¨å‘å¸ƒå½“æ—¶çŠ¶æ€çš„å¯è§æ€§ï¼Œä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå°±éœ€è¦åœ¨æ¯æ¬¡å¯¹è±¡è®¿é—®æ—¶ä¹Ÿä½¿ç”¨åŒæ­¥æ¥ç¡®ä¿åç»­ä¿®æ”¹æ“ä½œçš„å¯è§æ€§ã€‚å¯¹è±¡çš„å‘å¸ƒæ–¹å¼å–å†³äºå®ƒçš„å¯å˜æ€§ï¼š ä¸å¯å˜å¯¹è±¡å¯ä»¥é€šè¿‡ä»»ä½•æœºåˆ¶æ¥å‘å¸ƒï¼› äº‹å®ä¸å¯å˜å¯¹è±¡å¿…é¡»é€šè¿‡å®‰å…¨æ–¹å¼æ¥å‘å¸ƒ å¯å˜å¯¹è±¡å¿…é¡»é€šè¿‡å®‰å…¨æ–¹å¼æ¥å‘å¸ƒï¼Œå¹¶ä¸”å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„æˆ–ç”±æŸä¸ªé”ä¿æŠ¤èµ· å®‰å…¨çš„å…±äº«å¯¹è±¡åœ¨å¹¶å‘ç¨‹åºä¸­ä½¿ç”¨å…±äº«å¯¹è±¡æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›å®ç”¨çš„ç­–ç•¥ï¼š çº¿ç¨‹å°é—­ã€‚çº¿ç¨‹å°é—­çš„å¯¹è±¡åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰ï¼Œå¯¹è±¡è¢«å°é—­åœ¨è¯¥çº¿ç¨‹ä¸­ï¼Œå¹¶ä¸”åªèƒ½ç”±è¿™ä¸ªçº¿ç¨‹ä¿®æ”¹ã€‚ åªè¯»å…±äº«ã€‚åœ¨æ²¡æœ‰é¢å¤–åŒæ­¥çš„æƒ…å†µä¸‹ï¼Œå…±äº«çš„åªè¯»å¯¹è±¡å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œä½†ä»»ä½•çº¿ç¨‹éƒ½ä¸èƒ½ä¿®æ”¹å®ƒã€‚å…±äº«çš„åªè¯»å¯¹è±¡åŒ…æ‹¬ä¸å¯å˜å¯¹è±¡å’Œå®é™…ä¸å¯å˜å¯¹è±¡ã€‚ çº¿ç¨‹å®‰å…¨å…±äº«ã€‚çº¿ç¨‹å®‰å…¨çš„å¯¹è±¡åœ¨å…¶å†…éƒ¨å®ç°åŒæ­¥ï¼Œå› æ­¤å¤šä¸ªçº¿ç¨‹å¯ä»¥é€šè¿‡å¯¹è±¡çš„å…¬æœ‰æ¥å£æ¥è¿›è¡Œè®¿é—®è€Œä¸éœ€è¦è¿›ä¸€æ­¥çš„åŒæ­¥ã€‚ ä¿æŠ¤å¯¹è±¡ã€‚è¢«ä¿æŠ¤çš„å¯¹è±¡åªèƒ½é€šè¿‡æŒæœ‰ç‰¹å®šçš„é”æ¥è®¿é—®ã€‚ä¿æŠ¤å¯¹è±¡åŒ…æ‹¬å°è£…åœ¨å…¶ä»–çº¿ç¨‹å®‰å…¨å¯¹è±¡ä¸­çš„å¯¹è±¡ï¼Œä»¥åŠå·²å‘å¸ƒçš„å¹¶ä¸”ç”±æŸä¸ªç‰¹å®šé”ä¿æŠ¤çš„å¯¹è±¡ã€‚ æ€»ç»“ç”±äºå¯¹è±¡éœ€è¦å…±äº«ï¼Œæ‰€ä»¥è¦æ³¨æ„å‘å¸ƒçš„å®‰å…¨æ€§ï¼Œä»¥åŠå¯¹ä¸å¯ä»¥å˜å¯¹è±¡çš„åˆç†åº”ç”¨ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ javaå¹¶å‘ç¼–ç¨‹å®è·µå­¦ä¹ ï¼ˆå››ï¼‰å¯¹è±¡çš„å‘å¸ƒå’Œé€¸å‡ºä¹‹thisé€ƒé€¸]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå¹¶å‘_1_çº¿ç¨‹å®‰å…¨æ€§]]></title>
    <url>%2F2018%2F01%2F12%2FJava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98%2FJava%E5%B9%B6%E5%8F%91-1-%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E6%80%A7%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè¦ç¼–å†™çº¿ç¨‹å®‰å…¨çš„ä»£ç ï¼Œå…¶æ ¸å¿ƒåœ¨äºè¦å¯¹çŠ¶æ€è®¿é—®æ“ä½œè¿›è¡Œç®¡ç†ï¼Œç‰¹åˆ«æ˜¯å¯¹â€œå…±äº«çš„(Shared)â€å’Œâ€œå¯å˜çš„(Mutable)â€çŠ¶æ€çš„è®¿é—®ã€‚è€Œå¯¹è±¡çš„çŠ¶æ€æ˜¯æŒ‡å­˜å‚¨åœ¨çŠ¶æ€å˜é‡ï¼ˆç±»å˜é‡å’Œæˆå‘˜å˜é‡ï¼‰ä¸­çš„æ•°æ®ã€‚â€œå…±äº«â€æ„å‘³ç€å˜é‡å¯ä»¥ç”±å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œè€Œâ€œå¯å˜â€åˆ™æ„å‘³ç€å˜é‡çš„å€¼åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå¯ä»¥å‘ç”Ÿå˜åŒ–ã€‚ ä»€ä¹ˆæ˜¯çº¿ç¨‹çš„å®‰å…¨æ€§çº¿ç¨‹å®‰å…¨æ€§ç®€å•ç‚¹è¯´å°±æ˜¯æ‰€è§å³æ‰€çŸ¥ï¼Œè¿™æ˜¯å¯¹æ­£ç¡®æ€§çš„è®¤è¯†ã€‚åœ¨ä¹¦ä¸­è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒé•¿çš„å®šä¹‰ï¼š å½“å¤šä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªç±»æ—¶ï¼Œä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒé‡‡ç”¨ä½•ç§è°ƒåº¦æ–¹æ³•æˆ–è€…è¿™äº›çº¿ç¨‹å°†å¦‚ä½•äº¤æ›¿æ‰§è¡Œï¼Œ å¹¶ä¸”åœ¨ä¸»è°ƒä»£ç ä¸­ä¸éœ€è¦ä»»ä½•é¢å¤–çš„åŒæ­¥æˆ–ååŒï¼Œè¿™ä¸ªç±»éƒ½èƒ½è¡¨ç°å‡ºæ­£ç¡®åœ°è¡Œä¸ºï¼Œ é‚£ä¹ˆè¿™ä¸ªç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ è‡ªå·±å†å¼€å§‹ä¹Ÿç®€å•ä»‹ç»äº†å¯¹è±¡çš„çŠ¶æ€ï¼Œè¿™é‡Œéœ€è¦æ˜ç¡®ä¸€ç‚¹ï¼š æ— çŠ¶æ€çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ åŸå­æ€§ åŸå­æ“ä½œï¼šä¸å¯å†åˆ†å‰²ä¸ºå‡ ä¸ªæ“ä½œçš„æ“ä½œ ç«æ€æ¡ä»¶ï¼šç”±äºä¸æ°å½“çš„æ‰§è¡Œæ—¶åºè€Œå‡ºç°ä¸æ­£ç¡®çš„ç»“æœï¼ˆä¸æ˜¯åŸå­æ“ä½œå¼•èµ·çš„ï¼‰ ç«æ€æ¡ä»¶çš„ç±»å‹ï¼š å…ˆæ£€æŸ¥åæ‰§è¡Œï¼Œä¾‹å¦‚å»¶è¿Ÿåˆå§‹åŒ– è¯»å–-ä¿®æ”¹-å†™å…¥ï¼Œä¾‹å¦‚ç»Ÿè®¡å‘½ä¸­æ•°æ“ä½œ å¤åˆæ“ä½œï¼šå°†å‡ ä¸ªæ“ä½œå˜ä¸ºä¸€ä¸ªåŸå­æ“ä½œï¼Œåœ¨java.util.concurrent.atomicåŒ…ä¸­åŒ…å«äº†ä¸€äº›åŸå­å˜é‡ç±»ï¼Œç”¨äºå®ç°åœ¨æ•°å€¼å’Œå¯¹è±¡å¼•ç”¨ä¸Šçš„åŸå­çŠ¶æ€è½¬æ¢ã€‚ åœ¨æ— çŠ¶æ€çš„ç±»ä¸­æ·»åŠ ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œå¦‚æœè¯¥çŠ¶æ€å®Œå…¨ç”±çº¿ç¨‹å®‰å…¨çš„å¯¹è±¡æ¥ç®¡ç†ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä»ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ åŠ é”æœºåˆ¶è¦ä¿æŒçŠ¶æ€çš„ä¸€è‡´æ€§ï¼Œå°±éœ€è¦åœ¨å•ä¸ªåŸå­æ“ä½œä¸­æ›´æ–°æ‰€æœ‰ç›¸å…³çš„çŠ¶æ€å˜é‡ã€‚ å†…ç½®é”Javaæä¾›äº†ä¸€ç§å†…ç½®çš„é”æœºåˆ¶æ¥æ”¯æŒåŸå­æ€§ï¼šåŒæ­¥ä»£ç å—ã€‚åŒæ­¥ä»£ç å—åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šä¸€ä¸ªâ€œä½œä¸ºé”â€çš„å¯¹è±¡å¼•ç”¨ï¼Œä¸€ä¸ªâ€œä½œä¸ºç”±è¿™ä¸ªé”ä¿æŠ¤â€çš„ä»£ç å—ã€‚è¿™ä¸ªé”ç§°ä¸ºå†…ç½®é”æˆ–ç›‘è§†å™¨é”ã€‚çº¿ç¨‹åœ¨è¿›å…¥åŒæ­¥ä»£ç å—ä¹‹å‰ä¼šè‡ªåŠ¨è·å¾—é”ï¼Œå¹¶ä¸”åœ¨é€€å‡ºåŒæ­¥ä»£ç å—æ—¶è‡ªåŠ¨é‡Šæ”¾é”ã€‚Javaçš„å†…ç½®é”ç›¸å½“äºä¸€ç§äº’æ–¥ä½“ï¼Œæœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤ŸæŒæœ‰è¿™ç§é”ã€‚ç”±äºæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå†…ç½®é”ä¿æŠ¤çš„ä»£ç å—ï¼Œå› æ­¤ï¼Œæœ‰è¿™ä¸ªé”ä¿æŠ¤çš„åŒæ­¥ä»£ç å—ä¼šä»¥åŸå­æ–¹å¼æ‰§è¡Œã€‚ é‡å…¥å†…ç½®é”æ˜¯å¯é‡å…¥çš„ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹è¯•å›¾è·å¾—ä¸€ä¸ªå·²ç»æœ‰å®ƒè‡ªå·±æŒæœ‰çš„é”ï¼Œè¿™ä¸ªè¯·æ±‚å°†ä¼šæˆåŠŸï¼Œâ€œé‡å…¥â€æ„å‘³ç€è·å–é”çš„æ“ä½œçš„ç²’åº¦æ˜¯â€œçº¿ç¨‹â€ã€‚ é‡å…¥çš„ä¸€ç§æ˜¯å®ç°æ–¹æ³•æ˜¯ï¼šä¸ºæ¯ä¸ªé”å…³è”ä¸€ä¸ªè·å–è®¡æ•°å€¼å’Œä¸€ä¸ªæ‰€æœ‰è€…çº¿ç¨‹ã€‚å½“è®¡æ•°å€¼ä¸º0æ—¶ï¼Œè¿™ä¸ªé”å°±è¢«è®¤ä¸ºæ˜¯æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰ã€‚å½“çº¿ç¨‹è¯·æ±‚ä¸€ä¸ªæœªè¢«æŒæœ‰çš„é”æ—¶ï¼ŒJVMå°†è®°ä¸‹é”çš„æŒæœ‰è€…ï¼Œå¹¶ä¸”å°†è·å–è®¡æ•°å€¼ç½®ä¸º1ã€‚å¦‚æœåŒä¸ªçº¿ç¨‹å†æ¬¡è·å–è¿™ä¸ªé”ï¼Œè®¡æ•°å€¼å°†é€’å¢ï¼Œè€Œå½“çº¿ç¨‹é€€å‡ºåŒæ­¥ä»£ç å—æ—¶ï¼Œè®¡æ•°å™¨ä¼šç›¸åº”åœ°é€’å‡ï¼Œå½“è®¡æ•°å€¼ä¸º0æ—¶ï¼Œè¿™ä¸ªé”å°†è¢«é‡Šæ”¾ã€‚ ç”¨é”æ¥ä¿æŠ¤çŠ¶æ€ åªæŠŠå¤åˆæ“ä½œåŒ…è£…åœ¨synchronizedå—ä¸­å¹¶ä¸å¤Ÿï¼Œå¦‚æœå¯¹ä¸€ä¸ªå˜é‡çš„è®¿é—®éœ€è¦ä½¿ç”¨åŒæ­¥ï¼Œé‚£æ‰€æœ‰è®¿é—®è¯¥å˜é‡çš„åœ°æ–¹éƒ½è¦åŠ ä¸ŠåŒæ­¥ã€‚è€Œä¸”åœ¨ä½¿ç”¨é”æ¥å®ç°å¯¹å˜é‡çš„åŒæ­¥æ—¶ï¼Œæ‰€æœ‰è®¿é—®è¯¥å˜é‡çš„åœ°æ–¹éƒ½è¦ä½¿ç”¨åŒä¸€æŠŠé”ã€‚ è·å–ä¸€ä¸ªå¯¹è±¡å…³è”çš„é”å¹¶ä¸èƒ½é˜»æ­¢å…¶ä»–çº¿ç¨‹è®¿é—®è¯¥å¯¹è±¡ï¼Œåªæœ‰æ‰€æœ‰çº¿ç¨‹éƒ½è·å–çš„æ˜¯ç›¸åŒçš„é”æ‰èƒ½ç¡®ä¿è¯¥å¯¹è±¡è¢«ä¸²è¡Œè®¿é—®ã€‚æ‰€ä»¥æ¯ä¸ªå…±äº«çš„å¯å˜å˜é‡è¦è¢«åŒä¸€æŠŠé”ä¿æŠ¤ã€‚å¹¶éæ‰€æœ‰æ•°æ®éƒ½éœ€è¦é”çš„ä¿æŠ¤ï¼Œåªæœ‰è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®çš„å¯å˜æ•°æ®æ‰éœ€è¦é€šè¿‡é”æ¥ä¿æŠ¤ã€‚ ä¸€ç§å¸¸è§çš„åŠ é”çº¦å®šæ˜¯ï¼Œå°†æ‰€æœ‰çš„å¯å˜çŠ¶æ€éƒ½å°è£…åœ¨å¯¹è±¡å†…éƒ¨ï¼Œå¹¶é€šè¿‡å¯¹è±¡çš„å†…ç½®é”å¯¹æ‰€æœ‰è®¿é—®å¯å˜çŠ¶æ€çš„ä»£ç è¿›è¡ŒåŒæ­¥ï¼Œä½¿å¾—åœ¨è¯¥å¯¹è±¡ä¸Šä¸ä¼šå‘ç”Ÿå¹¶å‘è®¿é—®ã€‚ æ´»è·ƒæ€§ä¸æ€§èƒ½è¿™é‡Œå±•ç¤ºä¸¤ä¸ªä»£ç ï¼š åˆ©ç”¨åŒæ­¥æ–¹æ³•å®ç°é”çš„ä»£ç ï¼š1234567891011121314151617181920import java.math.BigInteger;public class SynchronizedFactorizer implements Servlet &#123; @GuardedBy(this) private BigInteger lastNumber; @GuardedBy(this) private BigInteger[] lastFactors; public synchronized void service(ServletRequest req, ServletResponse resp) &#123; BigInteger i = extractFromRequest(req); if(i.equals(lastNumber)) &#123; encodeIntoResponse(resp, lastFactors); &#125; else &#123; BigInteger[] factors = factor(i); lastNumber = i; lastFactors = factors.clone(); encodeIntoResponse(resp, factors); &#125; &#125;&#125; é€šè¿‡ç¼©å°åŒæ­¥ä»£ç å—çš„ä½œç”¨èŒƒå›´å®ç°é”çš„ä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839import java.math.BigInteger;import com.sun.org.apache.bcel.internal.generic.IF_ACMPEQ;@ThreadSafepublic class CachedFactorizer implements Servlet&#123; @GuardedBy(this) private BigInteger lastNumber; @GuardedBy(this) private BigInteger[] lastFactors; @GuardedBy(this) private long hits; @GuardedBy(this) private long cacheHits; public synchronized long getHits() &#123; return hits; &#125; public synchronized double getCachedHits() &#123; return (double)cacheHits /(double) hits; &#125; public void service(ServletRequest req, ServletResponse resp) &#123; BigInteger i = extractFromRequest(req); BigInteger[] factors = null; synchronized (this) &#123; ++hits; if(i.equals(lastNumber)) &#123; ++cacheHits; factors = lastFactors.clone(); &#125; &#125; if(factors == null) &#123; factors = factor(i); //èŠ±è´¹æ—¶é—´é•¿çš„ä»£ç ä¸è¦æŒæœ‰é”ï¼Œç›¸å½“äºä¸¤ä¸ªåŒæ­¥ä»£ç å—çš„ç•Œé™ synchronized (this) &#123; lastNumber = i; lastFactors = factors.clone(); &#125; &#125; encodeIntoResponse(resp, factors); &#125;&#125; è¦åˆ¤æ–­åŒæ­¥ä»£ç å—çš„åˆç†å¤§å°ï¼Œéœ€è¦åœ¨å„ç§è®¾è®¡éœ€æ±‚ä¹‹é—´è¿›è¡Œæƒè¡¡ï¼ŒåŒ…æ‹¬å®‰å…¨æ€§ï¼ˆè¿™ä¸ªéœ€æ±‚å¿…é¡»è¦æ»¡è¶³ï¼‰ã€ç®€å•æ€§å’Œæ€§èƒ½ã€‚æˆ‘ä»¬éœ€è¦æƒè¡¡ã€‚ tipï¼šå½“æ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„è®¡ç®—æˆ–è€…å¯èƒ½æ— æ³•å¿«é€Ÿå®Œæˆçš„æ“ä½œæ—¶ï¼ˆä¾‹å¦‚ï¼Œç½‘ç»œI/Oæˆ–æ§åˆ¶å°I/Oï¼‰ï¼Œä¸€å®šä¸è¦æŒæœ‰é”ã€‚ æ€»ç»“å®‰å…¨æ€§éœ€è¦ä¿è¯ï¼Œæ´»è·ƒæ€§å’Œæ€§èƒ½ä¹Ÿè¦åœ¨æƒè¡¡ä¹‹ä¸­ã€‚ å‚è€ƒ ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹]]></content>
      <categories>
        <category>Javaå¹¶å‘ç¼–ç¨‹å®æˆ˜</category>
      </categories>
      <tags>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[äººç”Ÿä¹‹è¯­è¨€ä¸æ•°å­¦]]></title>
    <url>%2F2018%2F01%2F11%2F%E7%94%9F%E6%B4%BB%2F%E4%BA%BA%E7%94%9F%E4%B9%8B%E8%AF%AD%E8%A8%80%E4%B8%8E%E6%95%B0%E5%AD%A6%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå…¶å®æœ€è¿‘è‡ªå·±ä¸€ç›´éƒ½åœ¨å‡†å¤‡è€ƒè¯•ï¼Œç»“æœçªç„¶è„‘æµ·å‡ºç°äº†å…³äºå¯¹äººç”Ÿçš„æ‚æƒ³ï¼ˆå¯èƒ½æƒ³çš„é«˜åº¦å¤ªé«˜äº†ï¼‰ï¼Œè‡ªå·±æ²¡æœ‰åŠæ—¶å†™ä¸‹æ¥ï¼Œç°åœ¨åŸºæœ¬ä¸Šè€ƒå®Œäº†ï¼Œæ‰€ä»¥å°±æƒ³è®¤çœŸè°ˆä¸€ä¸‹è‡ªå·±çš„æ€è€ƒã€‚ äººç”Ÿæˆ‘æƒ³å¤§éƒ¨äººéƒ½æ˜¯æƒ³ç€æˆåŠŸå¾—è¿‡å®Œè¿™ä¸€ç”Ÿçš„ï¼Œä½†æ˜¯æ¯ä¸ªäººéƒ½ä¼šè¿·èŒ«ï¼Œéƒ½ä¼šåœ¨æŸä¸ªæ—¶åˆ»ä¸çŸ¥é“è‡ªå·±æƒ³è¦ä»€ä¹ˆï¼Œæˆ–è€…è¯¥æ€ä¹ˆåšã€‚æˆ‘æƒ³ç®€å•å¾—æŠŠä¸–ç•Œä¸Šçš„äººå½’ä¸ºè¿™æ ·ä¸¤ç±»ã€‚ è¯äººç”Ÿè¿™é‡Œæœ‰ä¸€ç±»äººä»–ä»¬æ˜¯é æƒ…å•†å’ŒåŠªåŠ›æ¥è·å¾—æˆåŠŸçš„ï¼Œè¯´çš„é€šä¿—ç‚¹å°±æ˜¯èµ°ä¸Šè¡Œæ”¿æˆ–è€…åšç”Ÿæ„çš„ï¼Œè¿™ç±»äººå¯¹æˆ‘ä»¬çš„ä¸–ç•Œæ˜¯ååˆ†é‡è¦çš„ï¼Œèƒ½è¯´ä¼šé“çš„äººåœ¨å“ªéƒ½èƒ½åƒå¾—å¼€å§ã€‚ è¡Œæ”¿äººç”Ÿè¡Œæ”¿ç°åœ¨å¯¹å­¦å†çš„è¦æ±‚ä¹Ÿè¶Šæ¥è¶Šé«˜äº†ï¼Œæ‰€ä»¥ä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘è§‰å¾—è¿™æ ·çš„äººè¿˜æ˜¯è¦å¯¹è€ƒè¯•ä¿æŒæ•¬ç•ï¼Œæˆ‘ä¸ªäººè§‰å¾—é”»ç‚¼åº”è¯•èƒ½åŠ›æ˜¯ååˆ†æœ‰å¿…è¦çš„ï¼Œå› ä¸ºåœ¨å‡å­¦æˆ–è€…å…¥èŒï¼Œè¿™éƒ½å°†èµ·ç€ç½®å…³é‡è¦çš„ä½œç”¨ï¼Œæˆ‘æƒ³ä¹Ÿè®¸ä¸ç”¨æŠŠæ¯å—çŸ¥è¯†éƒ½å¼„çš„é‚£ä¹ˆæ·±ï¼Œé‚£ä¹ˆé€ï¼Œåè€Œåº”è¯¥æ˜¯å­¦ä¼šæ€»ç»“ï¼Œå­¦ä¼šå½’ç±»ï¼Œå­¦ä¼šé¢„æµ‹ä»¥ä¾¿èŠ±æœ€å°‘çš„æ—¶é—´æˆ–è€…æœ€ä½³çš„ç»“æœã€‚è¿™é‡Œè¦æä¸€ä¸‹å°±æ˜¯æˆ‘ä»¬ä»å°çš„å­¦çš„è¯­æ–‡è¿™é—¨ç§‘ç›®äº†ï¼Œä¸èƒ½è¯´å®ƒå¤šæœ‰ç”¨ï¼Œä½†æ˜¯å¯¹äºæé«˜æˆ‘ä»¬çš„æ–‡ç¬”è¿˜æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œè¿˜æœ‰å°±æ˜¯ä¹¦å†™èƒ½åŠ›ä¹Ÿä¼šæ˜¾å¾—ååˆ†é‡è¦ã€‚ ç”Ÿæ„äººç”Ÿåšç”Ÿæ„æˆ–è€…è¯´åšé”€å”®ï¼Œå…¶å®å¤§éƒ¨åˆ†çš„äººéƒ½èƒ½æ„Ÿè§‰åˆ°å®ä¸šè¶Šæ¥è¶Šéš¾åšäº†ï¼Œæˆ–è€…è¯´æ˜¯å¤ªç¨³å›ºï¼Œå¢™å¤–é¢çš„äººå¾ˆéš¾æŒ¤è¿›å»ï¼Œåè€Œéšç€äº’è”ç½‘çš„å‘å±•ï¼Œçº¿ä¸Šçš„ç”Ÿæ„ç«å¥½ä¸€äº›ã€‚è¿™åªæ˜¯ä¸€ç§å½¢å¼ã€‚çœŸæ­£æƒ³åšå¤§åšå¥½ï¼Œä½ é™¤äº†èƒ½è¯´ä¼šé“ï¼Œæˆ‘æƒ³æŒæ¡ä¸€å£æ ‡å‡†çš„æ™®é€šè¯å’Œä¸€å£æµåˆ©çš„è‹±è¯­å£è¯­å¯¹ç”Ÿæ„çš„å¹¿åº¦å’Œæœªæ¥éƒ½ä¼šæœ‰å¾ˆå¥½çš„å¸®åŠ©ï¼Œæ‰€ä»¥è¯­è¨€èƒ½åŠ›éœ€è¦å¥½å¥½çš„getã€‚ å­¦äººç”Ÿè¿˜æœ‰è¿™ä¸€ç§äººé‚£å°±æ˜¯é€šè¿‡å­¦ä¹ å’ŒåŠªåŠ›æ¥æ”¹å˜äººç”Ÿï¼Œæˆ–è€…è¯´æ˜¯èµ°æŠ€æœ¯è·¯çº¿çš„ï¼Œå½“ç„¶è¿™é‡Œä¹Ÿä¼šåˆ†ä¸ºä¸¤ç§äººã€‚ ç§‘ç ”äººç”Ÿä¸–ç•Œéœ€è¦è¿›æ­¥ï¼Œé‚£è¿›æ­¥ä»ä½•è€Œæ¥ï¼Œæˆ‘æƒ³å…¶ä¸­çš„æ ¸å¿ƒæ˜¯æ¥è‡ªä¸€éƒ¨åˆ†å æ¯”ä¸é«˜çš„äººï¼ˆç§‘å­¦å®¶ï¼Œè‡³å°‘æ˜¯ä¸ªåšå£«å§ï¼‰çš„åŠªåŠ›ã€‚è¿™é‡Œæ•°å­¦å°±ä¼šæ˜¾å¾—é‚£ä¹ˆé‡è¦ã€‚å½“ç„¶æ•°å­¦ä¼šåˆ†å¾ˆå¤šæ–¹é¢ï¼Œä¹‹å‰å¬åˆ°è¿‡ä¸€ç§è¯´æ³•å°±æ˜¯æ•°å­¦å…¶å®ä¸€é—¨å“²å­¦ï¼Œä¿¡äº†å®ƒå°±æ˜¯å¯¹çš„ï¼Œä¸ä¿¡å®ƒå°±æ˜¯é”™çš„ã€‚è¯´çš„å…¶å®ä¹Ÿæ˜¯ååˆ†çš„æœ‰é“ç†ï¼Œæ•°å­¦çš„å¯¹é”™å…¶å®æ˜¯ç›¸å¯¹çš„ï¼Œä¸æ˜¯ç»å¯¹çš„ï¼Œè¦æ ¹æ®æ‰€å¤„çš„é¢†åŸŸåŸºç¡€ï¼Œä½†æ˜¯å¯¹äºå¤§éƒ¨åˆ†æˆ‘ä»¬æ‰€è®¤è¯†åˆ°çš„æ•°å­¦å¤§å¤šæ•°è¿˜æ˜¯åŒä¸€ä¸ªåŸºç¡€ï¼Œå°±æ˜¯æˆ‘ä»¬å¤§éƒ¨åˆ†äººä»å°åˆ°å¤§æ‰€å­¦çš„æ•°å­¦ã€‚ç„¶åæˆ‘æƒ³è¯´è¯´è‡ªå·±å¯¹äºæ•°å­¦çš„è®¤çŸ¥ï¼Œæˆ‘æƒ³è¯´æ•°å­¦å…¶å®æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå¯¹äºæ— è®ºæ˜¯å“ªæ–¹é¢çš„ç§‘ç ”éƒ½æ˜¯å¾ˆé‡è¦çš„ï¼Œæ— è®ºæ˜¯å·¥ç§‘è¿˜æ˜¯ç»æµå­¦ç§‘ã€‚æ‰€ä»¥ä¹Ÿå°±è¯ç”Ÿäº†é‚£ä¹ˆå¤šäº¤å‰å­¦ç§‘ã€‚è¿™é‡Œåˆæƒ³æåˆ°è®¡ç®—æœºç§‘å­¦ï¼Œå…¶å®è®¡ç®—æœºç§‘å­¦åœ¨ç§‘ç ”æ–¹ä¾¿èµ·åˆ°çš„åªæ˜¯å‡å°‘äººç±»çš„å·¥ä½œé‡ä»¥åŠæé«˜äººæ‰€éœ€è¦çš„è®¡ç®—èƒ½åŠ›ã€‚å°±åƒå¤§æ•°æ®å…¶å®æ˜¯å±äºç»Ÿè®¡å­¦ç§‘ï¼Œä½†æ˜¯ç»“åˆåˆ°è®¡ç®—æœºï¼Œé‚£ä¹ˆå°±å˜æˆäº†è®¡ç®—æœºçš„çƒ­é—¨å­¦ç§‘äº†ã€‚ ç»éªŒäººç”Ÿä¸–ç•Œçš„è¿›æ­¥éœ€è¦ç§‘å­¦å®¶ï¼Œä½†æ˜¯ä¹Ÿå°‘ä¸äº†é ç»éªŒè§£å†³é—®é¢˜çš„ä¸“å®¶ï¼Œæ¯”å¦‚æ¶æ„å¸ˆï¼Œæˆ‘æƒ³å¤§æ¦‚å°±æ˜¯é€šè¿‡ä¸æ–­çš„å®è·µæ¥æé«˜è‡ªå·±çš„è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œè€Œè¿™ä¸éœ€è¦å¤šå¥½çš„ç§‘ç ”èƒ½åŠ›æˆ–è€…è¯´ç»å¯¹çš„åˆ›æ–°èƒ½åŠ›ï¼Œåªè¦å¤šåšå¤šæƒ³ï¼Œå­¦ä¼šå¿«åˆå‡†ç¡®åœ°è§£å†³é—®é¢˜å°±å¥½äº†ã€‚æˆ‘ç›¸ä¿¡å¤§éƒ¨åˆ†äººçš„æ™ºå•†éƒ½æ˜¯å·®ä¸å¤šçš„ï¼Œæ‰€ä»¥æƒ³åœ¨ç»éªŒäººç”Ÿä¸Šå–çš„å°å°çš„æˆåŠŸï¼ŒçœŸçš„æ˜¯éœ€è¦èŠ±å¾ˆå¤šæ—¶é—´æ¥æå‡è‡ªå·±çš„ç»éªŒã€‚]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>äººç”Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_14_çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–]]></title>
    <url>%2F2017%2F12%2F14%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-14-%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E4%B8%8E%E9%94%81%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šé¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³æå¤§çš„æå‡äº†ç°åœ¨è½¯ä»¶å¼€å‘çš„ç”Ÿäº§æ•ˆç‡å’Œè½¯ä»¶å¯ä»¥è¾¾åˆ°çš„è§„æ¨¡ï¼Œä½†æ˜¯ç°å®ä¸­å¯¹è±¡åœ¨ä¸€é¡¹å·¥ä½œè¿›è¡ŒæœŸé—´ï¼Œä¼šè¢«ä¸åœåœ°ä¸­æ–­å’Œåˆ‡æ¢ï¼Œå¯¹è±¡çš„å±æ€§å¯èƒ½ä¼šåœ¨ä¸­æ–­æœŸé—´è¢«ä¿®æ”¹å’Œå˜â€œè„â€ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è°ˆâ€œé«˜æ•ˆå¹¶å‘â€ä¹‹å‰å¿…é¡»å…ˆä¿è¯å¹¶å‘çš„æ­£ç¡®æ€§å’Œå¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨ã€‚ çº¿ç¨‹çš„å®‰å…¨åœ¨ã€ŠJava Concurrency In Practiceã€‹ä¸€ä¹¦ä¸­è¿™æ ·å®šä¹‰çº¿ç¨‹å®‰å…¨ï¼šå½“å¤šä¸ªçº¿ç¨‹è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœä¸ç”¨è€ƒè™‘è¿™äº›çº¿ç¨‹åœ¨è¿è¡Œæ—¶ç¯å¢ƒä¸‹å¾—è°ƒåº¦å’Œäº¤æ›¿æ‰§è¡Œï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œé¢å¤–çš„åŒæ­¥ï¼Œæˆ–è€…åœ¨è°ƒç”¨æ–¹è¿›è¡Œä»»ä½•å…¶ä»–çš„åè°ƒæ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸ºéƒ½å¯ä»¥è·å¾—æ­£ç¡®åœ°ç»“æœï¼Œé‚£è¿™ä¸ªå¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ å®ƒè¦æ±‚çº¿ç¨‹å®‰å…¨çš„ä»£ç éƒ½å¿…é¡»å…·å¤‡ä¸€ä¸ªç‰¹å¾ï¼šä»£ç æœ¬èº«å°è£…äº†æ‰€æœ‰å¿…è¦çš„æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µï¼ˆå¦‚äº’æ–¥åŒæ­¥ç­‰ï¼‰ï¼Œä»¤è°ƒç”¨è€…æ— éœ€å…³å¿ƒå¤šçº¿ç¨‹çš„é—®é¢˜ï¼Œæ›´æ— éœ€è‡ªå·±é‡‡ç”¨ä»»ä½•æªæ–½æ¥ä¿éšœå¤šçº¿ç¨‹çš„æ­£ç¡®è°ƒç”¨ã€‚ Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨åœ¨è®¨è®ºçº¿ç¨‹å®‰å…¨çš„æ—¶å€™ï¼Œéƒ½ä¼šé™å®šäºå¤šä¸ªçº¿ç¨‹ä¹‹é—´å­˜åœ¨å…±äº«æ•°æ®è®¿é—®è¿™ä¸ªå‰æï¼Œæˆ‘ä»¬æŒ‰ç…§çº¿ç¨‹å®‰å…¨çš„â€œå®‰å…¨ç¨‹åº¦â€ç”±å¼ºè‡³å¼±æ¥æ’åºï¼Œå¯ä»¥å°†Javaè¯­è¨€ä¸­å„ç§æ“ä½œå…±äº«çš„æ•°æ®åˆ†ä¸ºä»¥ä¸‹5ç±»ï¼šä¸å¯å˜ã€ç»å¯¹çº¿ç¨‹å®‰å…¨ã€ç›¸å¯¹çº¿ç¨‹å®‰å…¨ã€çº¿ç¨‹å…¼å®¹å’Œçº¿ç¨‹å¯¹ç«‹ã€‚ ä¸å¯å˜åœ¨Javaè¯­è¨€ä¸­ï¼Œä¸å¯å˜å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ— è®ºæ˜¯å¯¹è±¡çš„æ–¹æ³•å®ç°è¿˜æ˜¯æ–¹æ³•è°ƒç”¨è€…éƒ½ä¸éœ€è¦åœ¨é‡‡å–ä»»ä½•çš„çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½ã€‚ Javaè¯­è¨€ä¸­ï¼Œå¦‚æœå…±äº«æ•°æ®æ˜¯ä¸€ä¸ªåŸºæœ¬ç±»å‹æ•°æ®ï¼Œé‚£ä¹ˆåªè¦åœ¨å®šä¹‰æ—¶ä½¿ç”¨finalå…³é”®å­—ä¿®é¥°å®ƒå°±å¯ä»¥ä¿è¯å®ƒæ˜¯ä¸å¯å˜çš„ã€‚å¦‚æœå…±äº«æ•°æ®æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å°±éœ€è¦ä¿è¯å¯¹è±¡çš„è¡Œä¸ºä¸ä¼šå¯¹å…¶çŠ¶æ€äº§ç”Ÿä»»ä½•å½±å“æ‰è¡Œã€‚å¦‚Stringç±»ã€æšä¸¾ç±»ç­‰ï¼ˆæœ‰éœ€è¦ç»§ç»­æ¢ç©¶çš„å¯ä»¥å»çœ‹çœ‹è¿™äº›ç±»çš„æºç ï¼‰ï¼Œä¿è¯å¯¹è±¡è¡Œä¸ºä¸å½±å“è‡ªå·±çŠ¶æ€æœ€ç®€å•çš„é€”å¾„å°±æ˜¯è®²å¯¹è±¡å¸¦æœ‰çŠ¶æ€çš„å˜é‡éƒ½å£°æ˜ä¸ºfinalã€‚ ç»å¯¹çº¿ç¨‹å®‰å…¨ç»å¯¹çº¿ç¨‹å®‰å…¨éœ€è¦å®Œå…¨æ»¡è¶³ã€ŠJava Concurrency In Practiceã€‹ä¸€ä¹¦å¯¹çº¿ç¨‹å®‰å…¨çš„å®šä¹‰ã€‚è¿™ä¸ªå®šä¹‰å…¶å®æ˜¯å¾ˆä¸¥æ ¼çš„ï¼Œä¸€ä¸ªç±»è¦è¾¾åˆ°â€œä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒå¦‚ä½•ï¼Œè°ƒç”¨è€…éƒ½ä¸è¦ä»»ä½•é¢å¤–çš„åŒæ­¥æªæ–½â€é€šå¸¸éœ€è¦ä»˜å‡ºå¾ˆå¤§çš„ä»£ä»·ï¼Œåœ¨Java APIä¸­æ ‡æ³¨è‡ªå·±æ˜¯çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œå¤§å¤šæ•°éƒ½ä¸æ˜¯ç»å¯¹çš„çº¿ç¨‹å®‰å…¨ã€‚ ç›¸å¯¹çº¿ç¨‹å®‰å…¨ç›¸å¯¹çº¿ç¨‹å®‰å…¨å°±æ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸Šçš„çº¿ç¨‹å®‰å…¨ï¼Œå®ƒéœ€è¦ä¿è¯è¿™ä¸ªå¯¹è±¡å•ç‹¬æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨çš„æ—¶å€™ä¸éœ€è¦åšé¢å¤–çš„ä¿éšœæªæ–½ï¼Œä½†æ˜¯å¯¹äºä¸€äº›ç‰¹å®šé¡ºåºçš„è”ç³»è°ƒç”¨ï¼Œå°±å¯èƒ½éœ€è¦åœ¨è°ƒç”¨ç«¯ä½¿ç”¨é¢å¤–çš„åŒæ­¥æ‰‹æ®µæ¥ä¿éšœè°ƒç”¨çš„æ­£ç¡®æ€§ã€‚ä¸‹é¢å°±å±•ç¤ºjava.util.Vectorï¼ˆVectoråªæ˜¯åŠ äº†ä¸ªæ–¹æ³•é”ï¼Œä¿è¯ä¸€ä¸ªæ—¶é—´åªèƒ½è°ƒç”¨æ–¹æ³•ä¸€æ¬¡ï¼‰è¿™ä¸ªçº¿ç¨‹å®‰å…¨çš„å®¹å™¨çš„ä¸å®‰å…¨å¯èƒ½ï¼Œã€‚123456789101112131415161718192021222324252627282930313233343536// é”™è¯¯ä»£ç public class VectorTest &#123; private static Vector&lt;Integer&gt; vector = new Vector&lt;&gt;(); public static void main(String[] args) &#123; while (true) &#123; for (int i = 0; i &lt; 10; i++) &#123; vector.add(i); &#125; Thread removeThread = new Thread(new Runnable() &#123; @Override public void run() &#123; for (int i = 0; i &lt; vector.size(); i++) &#123; vector.remove(i); &#125; &#125; &#125;); Thread printThread = new Thread(new Runnable() &#123; @Override public void run() &#123; for (int i = 0; i &lt; vector.size(); i++) &#123; System.out.println(vector.get(i)); &#125; &#125; &#125;); removeThread.start(); printThread.start(); while (Thread.activeCount() &gt; 20); &#125; &#125;&#125; è¿è¡Œåˆ†æï¼šæˆ‘åœ¨è‡ªå·±æœºå™¨ä¸Šæ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼Œä½†æ˜¯æŒ‰ç…§ä½œè€…æ‰€è¯´çš„æ˜¯åº”è¯¥ä¼šå‡ºç°æ•°ç»„è¶Šç•Œå¼‚å¸¸çš„ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹æ°å¥½åœ¨é”™è¯¯çš„æ—¶é—´åˆ é™¤äº†ä¸€ä¸ªå…ƒç´ ï¼Œå¯¼è‡´åºå·ä¸ºiå·²ç»ä¸å†å¯ç”¨çš„è¯ï¼Œå†ç”¨iè®¿é—®æ•°ç»„å°±ä¼šæŠ›å‡ºä¸€ä¸ªArrayIndexOutOfBoundsExceptionï¼Œå¦‚æœè¦ä¿è¯è¿™æ®µä»£ç èƒ½æ­£ç¡®æ‰§è¡Œä¸‹å»ï¼Œéœ€è¦æ”¹æˆå¦‚ä¸‹ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940// å¯¹vectoræ“ä½œåŠ ä¸Šé”public class VectorTest &#123; private static Vector&lt;Integer&gt; vector = new Vector&lt;&gt;(); public static void main(String[] args) &#123; while (true) &#123; for (int i = 0; i &lt; 10; i++) &#123; vector.add(i); &#125; Thread removeThread = new Thread(new Runnable() &#123; @Override public void run() &#123; synchronized (vector) &#123; for (int i = 0; i &lt; vector.size(); i++) &#123; vector.remove(i); &#125; &#125; &#125; &#125;); Thread printThread = new Thread(new Runnable() &#123; @Override public void run() &#123; synchronized (vector) &#123; for (int i = 0; i &lt; vector.size(); i++) &#123; System.out.println(vector.get(i)); &#125; &#125; &#125; &#125;); removeThread.start(); printThread.start(); while (Thread.activeCount() &gt; 20); &#125; &#125;&#125; åœ¨Javaè¯­è¨€ä¸­ï¼Œå¤§éƒ¨åˆ†çº¿ç¨‹å®‰å…¨ç±»éƒ½å±äºè¿™ç§ç±»å‹ï¼Œä¾‹å¦‚Vectorã€HashTableç­‰ã€‚ çº¿ç¨‹å…¼å®¹çº¿ç¨‹å…¼å®¹æ˜¯æŒ‡å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨è°ƒç”¨ç«¯æ­£ç¡®åœ°ä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯å¯¹è±¡åœ¨å¹¶å‘ç¯å¢ƒä¸­å¯ä»¥å®‰å…¨ä½¿ç”¨ï¼Œæˆ‘ä»¬å¹³å¸¸è¯´çš„ä¸€ä¸ªç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç»å¤§å¤šæ•°æ—¶å€™æ˜¯æŒ‡è¿™ä¸€ç§æƒ…å†µã€‚Java APIä¸­å¤§éƒ¨åˆ†çš„ç±»éƒ½æ˜¯å±äºçº¿ç¨‹å…¼å®¹çš„ï¼Œå¦‚ä¸å‰é¢Vectorå’ŒHashTableç›¸å¯¹åº”çš„é›†åˆç±»ArrayListå’ŒHashTableç­‰ã€‚ çº¿ç¨‹å¯¹ç«‹çº¿ç¨‹å¯¹ç«‹æ˜¯æŒ‡æ— è®ºè°ƒç”¨ç«¯æ˜¯å¦é‡‡å–äº†åŒæ­¥æªæ–½ï¼Œéƒ½æ— æ³•å†å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¹¶å‘ä½¿ç”¨ä»£ç ï¼Œå¤§éƒ¨åˆ†åŸå› æ˜¯ä¼šäº§ç”Ÿæ­»é”ã€‚ çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•çº¿ç¨‹å®‰å…¨çš„å®ç°æ˜¯é€šè¿‡ä»£ç ç¼–å†™ä»¥åŠåˆ©ç”¨è™šæ‹Ÿæœºæä¾›çš„åŒæ­¥å’Œé”æœºåˆ¶ï¼Œè€Œæˆ‘ä»¬è¿™ä¸»è¦æ˜¯è¯´ä¸€ä¸‹è™šæ‹Ÿæœºçº¿ç¨‹å®‰å…¨æ‰‹æ®µçš„è¿ä½œè¿‡ç¨‹ã€‚ äº’æ–¥åŒæ­¥ï¼ˆé˜»å¡åŒæ­¥ï¼‰åŒæ­¥æ˜¯æŒ‡åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶ï¼Œä¿è¯å…±äº«æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶åˆ»åªè¢«ä¸€ä¸ªï¼ˆæˆ–è€…æ˜¯ä¸€äº›ï¼Œä½¿ç”¨ä¿¡å·é‡çš„æ—¶å€™ï¼‰çº¿ç¨‹ä½¿ç”¨ã€‚è€Œäº’æ–¥æ˜¯å®ç°åŒæ­¥çš„ä¸€ç§æ‰‹æ®µï¼Œä¸´ç•ŒåŒºã€ä¿¡å·é‡ï¼ˆéƒ½æ²¡ç”¨è¿‡ï¼‰ã€äº’æ–¥é‡éƒ½æ˜¯ä¸»è¦çš„äº’æ–¥å®ç°æ–¹å¼ã€‚äº’æ–¥æ˜¯å› ï¼ŒåŒæ­¥æ˜¯æœï¼›äº’æ–¥æ˜¯æ–¹æ³•ï¼ŒåŒæ­¥æ˜¯ç›®çš„ã€‚ä¸»è¦çš„äº’æ–¥åŒæ­¥æ‰‹æ®µæœ‰ä¸‹é¢ä¸¤ç§ï¼š ä½¿ç”¨synchronizdå…³é”®å­—ï¼Œsynchronizedå…³é”®å­—ç»è¿‡ç¼–è¯‘ä¹‹åï¼Œä¼šåœ¨åŒæ­¥å—çš„å‰ååˆ†åˆ«å½¢æˆ monitorenter å’Œ monitorexit è¿™ä¸ªä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤ï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚ç éƒ½éœ€è¦ä¸€ä¸ª referenceç±»å‹çš„å‚æ•°æ¥æŒ‡æ˜è¦é”å®šå’Œè§£é”çš„å¯¹è±¡ï¼›å¦‚æœjavaç¨‹åºä¸­çš„synchronizedæ˜ç¡®æŒ‡å®šäº†å¯¹è±¡å‚æ•°ï¼Œé‚£å°±æ˜¯è¿™ä¸ªå¯¹è±¡çš„referenceï¼›å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šï¼Œé‚£å°±æ ¹æ®synchronizedä¿®é¥°çš„å®ä¾‹æ–¹æ³•è¿˜æ˜¯ç±»æ–¹æ³•ï¼Œå»å–å¯¹åº”çš„å¯¹è±¡å®ä¾‹æˆ–Classå¯¹è±¡æ¥ä½œä¸ºé”å¯¹è±¡ã€‚åœ¨æ‰§è¡ŒmonitorenteræŒ‡ä»¤æ—¶ï¼Œå¦‚æœè¿™ä¸ªå¯¹è±¡æ²¡æœ‰é”å®šæˆ–å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†é‚£ä¸ªå¯¹è±¡çš„é”ï¼Œé”çš„è®¡æ•°å™¨åŠ 1ï¼Œç›¸åº”çš„ï¼Œåœ¨æ‰§è¡ŒmonitorexitæŒ‡ä»¤æ—¶ä¼šå°†é”è®¡æ•°å™¨å‡1ï¼›å½“è®¡æ•°å™¨ä¸º0æ—¶ï¼Œé”å°±è¢«é‡Šæ”¾äº†ã€‚å¯¹äºmonitorenter å’Œ monitorexitçš„è¡Œä¸ºæè¿°ä¸­ï¼Œæœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š synchronizedåŒæ­¥å—å¯¹åŒä¸€æ¡çº¿ç¨‹æ¥è¯´æ˜¯å¯é‡å…¥çš„ï¼Œä¸ä¼šå‡ºç°è‡ªå·±æŠŠè‡ªå·±é”æ­»çš„é—®é¢˜ã€‚ åŒæ­¥å—åœ¨å·²è¿›å…¥çš„çº¿ç¨‹æ‰§è¡Œå®Œä¹‹å‰ï¼Œä¼šé˜»å¡åé¢å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ã€‚ ä½¿ç”¨java.util.concurrentï¼ˆJ.U.Cï¼‰åŒ…ä¸­çš„é‡å…¥é”ï¼ˆReentrantLockï¼‰ã€‚synchronized å’Œ ReentrantLock çš„åŒºåˆ«ï¼š ä¸€ä¸ªè¡¨ç°ä¸º API å±‚é¢çš„äº’æ–¥é”ï¼ˆlock() å’Œ unlock() æ–¹æ³•é…åˆ try/finallyè¯­å¥å—æ¥å®Œæˆï¼‰ï¼Œå¦ä¸€ä¸ªè¡¨ç°ä¸ºåŸç”Ÿè¯­æ³•å±‚é¢çš„äº’æ–¥é”ï¼›ReentrantLockå¢åŠ äº†ä¸€äº›é«˜çº§åŠŸèƒ½ä¸»è¦æœ‰ä»¥ä¸‹3é¡¹ï¼š ç­‰å¾…å¯ä¸­æ–­ï¼šæŒ‡å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾é”çš„æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ï¼Œå¯ä¸­æ–­ç‰¹æ€§å¯¹å¤„ç†æ‰§è¡Œæ—¶é—´éå¸¸é•¿çš„åŒæ­¥å—å¾ˆæœ‰å¸® åŠ© ã€‚ å…¬å¹³é”ï¼šæŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºæ¥ä¾æ¬¡è·å¾—é”ã€‚ é”ç»‘å®šå¤šä¸ªæ¡ä»¶ï¼šæŒ‡ä¸€ä¸ª ReentrantLockå¯¹è±¡å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ª Conditionå¯¹è±¡ï¼Œè€Œåœ¨ synchronizedä¸­ï¼Œé”å¯¹è±¡çš„wait() å’Œ notify() æˆ– notifyAll() æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªéšå«çš„æ¡ä»¶ï¼Œå¦‚æœè¦å’Œå¤šäºä¸€ä¸ªçš„æ¡ä»¶å…³è”çš„æ—¶å€™ï¼Œå°±ä¸å¾—ä¸é¢å¤–åœ°æ·»åŠ ä¸€ä¸ªé”ï¼Œè€ŒReentrantLock åˆ™æ— éœ€è¿™æ ·åšï¼Œåªéœ€è¦å¤šæ¬¡è°ƒç”¨ newCondition() æ–¹æ³•å³å¯ã€‚ å…³äºä¸¤è€…çš„æ€§èƒ½åœ¨JDK1.6ä»¥åï¼Œä¸¤è€…åŸºæœ¬æŒå¹³äº†ï¼Œæ‰€ä»¥æå€¡åœ¨synchronizedèƒ½å®ç°éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨sychronizedæ¥è¿›è¡ŒåŒæ­¥é”ã€‚ éé˜»å¡åŒæ­¥ é˜»å¡åŒæ­¥ä¸éé˜»å¡åŒæ­¥çš„å¯¹æ¯”ï¼šé˜»å¡åŒæ­¥æ˜¯ä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œæ€»æ˜¯è®¤ä¸ºåªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½ï¼ˆä¾‹å¦‚åŠ é”ï¼‰å°±ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥ä¼šå¸¦æ¥è¿›è¡Œçº¿ç¨‹é˜»å¡å’Œå”¤é†’çš„æ€§èƒ½é—®é¢˜ï¼›éé˜»å¡åŒæ­¥æ˜¯ä¸€ç§åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚çš„å¹¶å‘ç­–ç•¥ï¼Œå®ƒæ˜¯å…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œé‚£æ“ä½œå°±æ˜¯æˆåŠŸçš„ï¼Œå¦‚æœå…±äº«æ•°æ®æœ‰äº‰ç”¨ï¼Œäº§ç”Ÿäº†å†²çªï¼Œé‚£å°±å†é‡‡å–å…¶ä»–çš„è¡¥å¿æªæ–½ï¼ˆæœ€å¸¸è§çš„è¡¥å¿æªæ–½å°±æ˜¯ä¸æ–­åœ°é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼‰ã€‚ éé˜»å¡åŒæ­¥éœ€è¦ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼šå› ä¸ºéœ€è¦ä¿è¯æ“ä½œå’Œå†²çªæ£€æµ‹è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡åŸå­æ€§ï¼Œè€Œè¿™é‡ŒåŸå­æ€§çš„å®ç°æ˜¯é€šè¿‡ä¸€æ¡å¤„ç†å™¨æŒ‡ä»¤å®Œæˆçš„ã€‚è¿™ç±»æŒ‡ä»¤å¸¸ç”¨çš„æœ‰ï¼š æµ‹è¯•å¹¶è®¾ç½® è·å–å¹¶å¢åŠ  äº¤æ¢ æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare-and-set,CASï¼‰ åŠ è½½é“¾æ¥/æ¡ä»¶å­˜å‚¨ æˆ‘ä»¬å¯ä»¥ä»J.U.Cä¸‹å¾—åŸå­ç±»çš„æ“ä½œæ¥è¯æ˜è¿™ä¸€ç‚¹ã€‚ æ— åŒæ­¥æ–¹æ¡ˆå¦‚æœä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±æ— é¡»ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯æ­£ç¡®æ€§ï¼Œå› æ­¤ä¼šæœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸‹é¢ä»‹ç»ä¸¤ç±»çº¿ç¨‹å®‰å…¨ä»£ç ï¼š å¯é‡å…¥ä»£ç ï¼ˆçº¯ä»£ç ï¼‰ï¼šï¼Œå¯ä»¥åœ¨ä»£ç æ‰§è¡Œçš„ä»»ä½•æ—¶åˆ»ä¸­æ–­å®ƒï¼Œè½¬è€Œå»æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç ï¼Œè€Œåœ¨æ§åˆ¶æƒè¿”å›åï¼ŒåŸæ¥çš„ç¨‹åºä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚å¦‚ä½•åˆ¤æ–­ä»£ç æ˜¯å¦å…·å¤‡å¯é‡å…¥æ€§ï¼šå¦‚æœä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„è¿”å›ç»“æœæ˜¯å¯ä»¥é¢„æµ‹çš„ï¼Œåªè¦è¾“å…¥äº†ç›¸åŒçš„æ•°æ®ï¼Œå°±éƒ½èƒ½è¿”å›ç›¸åŒçš„ç»“æœï¼Œé‚£å®ƒå°±æ»¡è¶³å¯é‡å…¥æ€§çš„è¦æ±‚ï¼Œå½“ç„¶ä¹Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ çº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼šå¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½å¤Ÿä¿è¯åœ¨åŒä¸€çº¿ç¨‹ä¸­æ‰§è¡Œï¼Ÿå¦‚æœèƒ½ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…ï¼Œè¿™æ ·ï¼Œæ— éœ€åŒæ­¥ä¹Ÿå¯ä»¥ä¿è¯çº¿ç¨‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨é—®é¢˜ã€‚ é”ä¼˜åŒ–å„ç§é”ä¼˜åŒ–æŠ€æœ¯éƒ½æ˜¯ä¸ºäº†åœ¨çº¿ç¨‹ä¹‹é—´æ›´åŠ é«˜æ•ˆåœ°å…±äº«æ•°æ®ï¼Œä»¥åŠè§£å†³ç«äº‰é—®é¢˜ã€‚ è‡ªæ—‹é” ä¸ºä»€ä¹ˆéœ€è¦è‡ªæ—‹é”ï¼šäº’æ–¥åŒæ­¥å¯¹æ€§èƒ½æœ€å¤§çš„å½±å“æ˜¯é˜»å¡çš„å®ç°ï¼ŒæŒ‚èµ·çº¿ç¨‹å’Œæ¢å¤çº¿ç¨‹çš„æ“ä½œéƒ½éœ€è¦è½¬å…¥å†…æ ¸æ€ä¸­å®Œæˆï¼Œå…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ï¼Œä¸ºäº†è¿™æ®µæ—¶é—´å»æŒ‚èµ·å’Œæ¢å¤çº¿ç¨‹å¾ˆä¸å€¼å¾—ã€‚ ä»€ä¹ˆæ˜¯è‡ªæ—‹é”ï¼šä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…ï¼Œæˆ‘ä»¬åªéœ€è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯ï¼ˆè‡ªæ—‹ï¼‰è€Œä¸æ”¾å¼ƒå¤„ç†å™¨æ—¶é—´ï¼Œè¿™é¡¹æŠ€æœ¯å°±æ˜¯æ‰€è°“çš„è‡ªæ—‹é”ã€‚ è‡ªæ—‹æ—¶é—´æœ‰ä¸€å®šé™åº¦ï¼šå¦‚æœè‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°ä»ç„¶æ²¡æœ‰æˆåŠŸè·å¾—é”ï¼Œå°±åº”å½“ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å»æŒ‚èµ·çº¿ç¨‹äº†ã€‚è‡ªæ—‹æ¬¡æ•°çš„é»˜è®¤å€¼æ˜¯10ï¼Œç”¨æˆ·å¯ä»¥ç”¨å‚æ•° -XX:PreBlockSpin æ¥æ›´æ”¹ã€‚ è‡ªé€‚åº”è‡ªæ—‹é”ï¼šjdk1.6ä¸­å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šï¼› é”æ¶ˆé™¤é”æ¶ˆé™¤æ˜¯æŒ‡è™šæ‹Ÿæœºå³æ—¶ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶ï¼Œå¯¹ä¸€äº›ä»£ç ä¸Šè¦æ±‚åŒæ­¥ï¼Œä½†æ˜¯è¢«æ£€æŸ¥åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é”è¿›è¡Œæ¶ˆé™¤ã€‚é”æ¶ˆé™¤çš„ä¸»è¦åˆ¤å®šä¾æ®ï¼šæ¥æºäºé€ƒé€¸åˆ†æçš„æ•°æ®æ”¯æŒï¼Œå¦‚æœåˆ¤å®šåœ¨ä¸€æ®µä»£ç ä¸­ï¼Œå †ä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½ä¸ä¼šé€ƒé€¸å‡ºå»ä»è€Œè¢«å…¶ä»–çº¿ç¨‹è®¿é—®åˆ°ï¼Œé‚£å°±å¯ä»¥æŠŠå®ƒä»¬å½“åšæ ˆä¸Šæ•°æ®å¯¹å¾…ï¼Œè®¤ä¸ºå®ƒä»¬æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼ŒåŒæ­¥åŠ é”è‡ªç„¶å°±æ— é¡»è¿›è¡Œäº†ã€‚å…¶ä¸­å¾ˆå¤šæ— ç”¨çš„åŒæ­¥æªæ–½éƒ½æ˜¯Java APIè‡ªå¸¦çš„ã€‚ é”ç²—åŒ–å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”ï¼Œç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„ï¼Œé‚£å³ä½¿æ²¡æœ‰çº¿ç¨‹ç«äº‰ï¼Œé¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æŸè€—ã€‚å¦‚æœè™šæ‹Ÿæœºæ¢æµ‹åˆ°æœ‰è¿™æ ·ä¸€ä¸²é›¶ç¢çš„æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œå°†ä¼šæŠŠåŠ é”åŒæ­¥çš„èŒƒå›´æ‰©å±•ï¼ˆç²—åŒ–ï¼‰åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ã€‚ è½»é‡çº§é” è½»é‡çº§é”ï¼šä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡æ¥å®ç°çš„ä¼ ç»Ÿé”é€šå¸¸è¢«ç§°ä¸ºé‡é‡çº§é”ï¼Œè€Œè¿™ä¸ªè½»é‡çº§é”çš„å‡ºç°å°±æ˜¯æ˜¯åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹ï¼Œå‡å°‘ä¼ ç»Ÿçš„é‡é‡çº§é”ä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—ã€‚ HotSpotè™šæ‹Ÿæœºå¤´Mark Wordï¼šå®ƒæ˜¯å®ç°è½»é‡çº§é”å’Œåå‘é”çš„å…³é”®ï¼Œå®ƒçš„å†…å®¹å¦‚ä¸‹è¡¨ï¼š å­˜å‚¨å†…å®¹ æ ‡å¿—ä½ è½¬æ€ å¯¹è±¡å“ˆå¸Œç ã€å¯¹è±¡å¹´é¾„åˆ†ä»£ 01 æœªé”å®š æŒ‡å‘æ‰€è®°å½•çš„æŒ‡é’ˆ 00 è½»é‡çº§é”å®š æŒ‡å‘é‡é‡çº§é”çš„æŒ‡é’ˆ 10 è†¨èƒ€ï¼ˆé‡é‡çº§é”å®šï¼‰ ç©ºï¼Œä¸éœ€è¦è®°å½•ä¿¡æ¯ 11 GCæ ‡è®° åå‘çº¿ç¨‹IDã€åå‘æ—¶é—´æˆ³ã€å¯¹è±¡åˆ†ä»£å¹´é¾„ 01 å¯åå‘ åœ¨è¿›å…¥åŒæ­¥ä»£ç å—æ—¶ï¼Œè½»é‡çº§é”åŠ é”è¿‡ç¨‹ï¼š å¦‚æœæ­¤åŒæ­¥å¯¹è±¡æ²¡æœ‰è¢«é”å®šï¼ˆé”æ ‡å¿—ä½ä¸º01çŠ¶æ€ï¼‰ï¼šè™šæ‹Ÿæœºé¦–å…ˆå°†åœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­å»ºç«‹ä¸€ä¸ªåä¸ºé”è®°å½•çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨å¯¹è±¡ç›®å‰çš„Mark Wordçš„æ‹·è´ï¼ˆDisplace Mark Wordï¼‰ã€‚ ç„¶åï¼Œè™šæ‹Ÿæœºå°†ä½¿ç”¨CAS æ“ä½œå°è¯•å°†å¯¹è±¡çš„ Mark Word æ›´æ–°ä¸ºæŒ‡å‘Lock Recordçš„æŒ‡é’ˆã€‚ å¦‚æœè¿™ä¸ªæ›´æ–°å·¥ä½œæˆåŠŸäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°±æ‹¥æœ‰äº†è¯¥å¯¹è±¡çš„é”ï¼Œå¹¶ä¸”å¯¹è±¡Mark Wordçš„é”æ ‡å¿—ä½å°†è½¬å˜ä¸º 00ï¼Œå³è¡¨ç¤ºæ­¤å¯¹è±¡å¤„äºè½»é‡çº§é”å®šçŠ¶æ€ï¼› å¦‚æœè¿™ä¸ªæ›´æ–°å¤±è´¥äº†ï¼Œè™šæ‹Ÿæœºé¦–å…ˆä¼šæ£€æŸ¥å¯¹è±¡çš„Mark Wordæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¦‚æœåªè¯´æ˜å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œé‚£å°±å¯ä»¥ç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è¯´æ˜è¿™ä¸ªé”å¯¹è±¡ä»¥åŠè¢«å…¶ä»–çº¿ç¨‹æŠ¢å äº†ã€‚å¦‚æœæœ‰ä¸¤æ¡ä»¥ä¸Šçš„çº¿ç¨‹äº‰ç”¨åŒä¸€ä¸ªé”ï¼Œé‚£è½»é‡çº§é”å°±ä¸å†æœ‰æ•ˆï¼Œè¦è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œé”æ ‡å¿—çš„çŠ¶æ€å€¼å˜ä¸º 10ï¼ŒMark Wordä¸­å­˜å‚¨çš„å°±æ˜¯æŒ‡å‘é‡é‡çº§ï¼ˆäº’æ–¥é‡ï¼‰çš„æŒ‡é’ˆï¼Œåé¢ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿè¦è¿›å…¥é˜»å¡ çŠ¶æ€ã€‚ è½»é‡çº§é”è§£é”è¿‡ç¨‹ï¼š å¦‚æœå¯¹è±¡çš„Mark Wordä»ç„¶æŒ‡å‘ç€çº¿ç¨‹çš„é”è®°å½•ï¼Œé‚£å°±ç”¨CAS æ“ä½œæŠŠå¯¹è±¡å½“å‰çš„Mark Wordå’Œçº¿ç¨‹ä¸­å¤åˆ¶çš„ Displaced Mark Wordæ›¿æ¢å›æ¥ã€‚ å¦‚æœæ›¿æ¢æˆåŠŸï¼Œæ•´ä¸ªåŒæ­¥è¿‡ç¨‹å°±å®Œæˆäº†ã€‚ å¦‚æœæ›¿æ¢å¤±è´¥ï¼Œè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è¿‡è·å–è¯¥é”ï¼Œé‚£å°±è¦åœ¨é‡Šæ”¾é”çš„åŒæ—¶ï¼Œå”¤é†’è¢«æŒ‚èµ·çš„çº¿ç¨‹ã€‚ è½»é‡çº§é”èƒ½æå‡ç¨‹åºåŒæ­¥æ€§èƒ½çš„ä¾æ®æ˜¯ï¼šå¯¹äºç»å¤§éƒ¨åˆ†çš„é”ï¼Œåœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½æ˜¯ä¸å­˜åœ¨ç«äº‰çš„ã€‚ åå‘é” åå‘é”çš„ç›®çš„ï¼šæ¶ˆé™¤æ•°æ®åœ¨æ— ç«äº‰æƒ…å†µä¸‹çš„åŒæ­¥åŸè¯­ï¼Œè¿›ä¸€æ­¥æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½ã€‚å¦‚æœè¯´è½»é‡çº§é”æ˜¯åœ¨æ— ç«äº‰çš„æƒ…å†µä½¿ç”¨CASæ“ä½œå»æ¶ˆé™¤åŒæ­¥ä½¿ç”¨çš„äº’æ–¥é‡ï¼Œé‚£åå‘é”å°±æ˜¯åœ¨æ— ç«äº‰çš„æƒ…å†µä¸‹æŠŠæ•´ä¸ªåŒæ­¥éƒ½æ¶ˆé™¤æ‰ï¼Œè¿CAS æ“ä½œéƒ½ä¸åšäº†ã€‚ åå‘é”çš„åï¼šå®ƒçš„æ„æ€æ˜¯è¿™ä¸ªé”ä¼šåå‘äºç¬¬ä¸€ä¸ªè·å¾—å®ƒçš„çº¿ç¨‹ï¼Œå¦‚æœåœ¨æ¥ä¸‹æ¥çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¯¥é”æ²¡æœ‰è¢«å…¶ä»–çš„çº¿ç¨‹è·å–ï¼Œåˆ™æŒæœ‰åå‘é”çš„çº¿ç¨‹å°†æ°¸è¿œä¸éœ€è¦å†è¿›è¡ŒåŒæ­¥ã€‚ åå‘é”è¿‡ç¨‹ï¼šè‹¥å½“å‰è™šæ‹Ÿæœºå¯ç”¨äº†åå‘é”ï¼Œé‚£ä¹ˆï¼Œå½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å–çš„æ—¶å€™ï¼Œè™šæ‹Ÿæœºå°†ä¼šæŠŠå¯¹è±¡å¤´ä¸­çš„æ ‡å¿—ä½è®¾ä¸º01ï¼Œå³åå‘æ¨¡å¼ï¼›åŒæ—¶ä½¿ç”¨CASæ“ä½œæŠŠè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹çš„ID è®°å½•åœ¨å¯¹è±¡çš„ Mark Wordä¹‹ä¸­ï¼Œå¦‚æœCASæ“ä½œæˆåŠŸï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œã€‚å½“æœ‰å¦ä¸€ä¸ªçº¿ç¨‹å»å°è¯•è·å–è¿™ä¸ªé”æ—¶ï¼Œåå‘æ¨¡å¼å°±ç»“æŸäº†ï¼Œæ ¹æ®é”å¯¹è±¡ç›®å‰æ˜¯å¦å¤„äºè¢«é”å®šçš„çŠ¶æ€ï¼Œæ’¤é”€åå‘åæ¢å¤åˆ°æœªé”å®šï¼ˆæ ‡å¿—ä½ä¸º01ï¼‰æˆ–è½»é‡çº§é”å®šï¼ˆæ ‡å¿—ä½ä¸º00ï¼‰çš„çŠ¶æ€ï¼Œåç»­çš„åŒæ­¥æ“ä½œå°±å¦‚ä¸Šé¢ä»‹ç»çš„è½»é‡çº§é”é‚£æ ·æ‰§è¡Œã€‚ åå‘é”æ˜¯ä¸€ä¸ªå¸¦æœ‰æ•ˆç›Šæƒè¡¡æ€§è´¨çš„ä¼˜åŒ–ï¼šåå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ï¼Œä½†æ˜¯å¦‚æœç¨‹åºä¸­å¤§å¤šæ•°çš„é”æ€»æ˜¯è¢«å¤šä¸ªä¸åŒçš„çº¿ç¨‹è®¿é—®ï¼Œé‚£åå‘æ¨¡å¼æ˜¯å¤šä½™çš„ã€‚ æ€»ç»“å…³äºçº¿ç¨‹å®‰å…¨æˆ‘ä»¬å¯ä»¥æœ‰æ˜ç¡®çš„å®šä¹‰ï¼Œç„¶åæˆ‘ä»¬ä¹ŸçŸ¥é“äº†çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹å¼ï¼Œä»¥åŠè™šæ‹Ÿæœºä¸ºæˆ‘ä»¬æä¾›çš„å„ç§é”ä¼˜åŒ–ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_13_Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹]]></title>
    <url>%2F2017%2F12%2F13%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-13-Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¹¶å‘å¤„ç†çš„å¹¿æ³›åº”ç”¨æ˜¯ä½¿å¾—é˜¿å§†å¾·å°”å®šå¾‹æ›¿ä»£æ‘©å°”å®šå¾‹æˆä¸ºè®¡ç®—æœºæ€§èƒ½å‘å±•åŸåŠ¨åŠ›çš„æ ¹æœ¬åŸå› ã€‚ç”±äºè®¡ç®—æœºçš„è¿ç®—é€Ÿåº¦å’Œå®ƒçš„å­˜å‚¨å’Œé€šä¿¡å­ç³»ç»Ÿé€Ÿåº¦å·®è·å¤ªå¤§ï¼Œæ‰€ä»¥æ‰å‡ºç°äº†å¹¶å‘ï¼Œè€Œå¹¶å‘ç»å¯¹æ˜¯Javaè¿ç”¨å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚æˆ‘ä»¬ç»å¯¹éœ€è¦ç†è§£ï¼ ç¡¬ä»¶çš„æ•ˆç‡ä¸ä¸€è‡´æ€§ç”±äºè®¡ç®—æœºçš„å­˜å‚¨è®¾å¤‡ä¸å¤„ç†å™¨çš„è¿ç®—é€Ÿåº¦æœ‰å‡ ä¸ªæ•°é‡çº§çš„å·®è·ï¼Œæ‰€ä»¥ç°ä»£è®¡ç®—æœºç³»ç»Ÿéƒ½ä¸å¾—ä¸åŠ å…¥ä¸€å±‚è¯»å†™é€Ÿåº¦å°½å¯èƒ½æ¥è¿‘å¤„ç†å™¨è¿ç®—é€Ÿåº¦çš„å‘Šè¯‰ç¼“å­˜æ¥ä½œä¸ºå†…å­˜ä¸å¤„ç†å™¨ä¹‹é—´çš„ç¼“å†²ï¼šå°†è¿ç®—éœ€è¦ä½¿ç”¨åˆ°çš„æ•°æ®å¤åˆ¶åˆ°ç¼“å­˜ä¸­ï¼Œè®©è¿ç®—èƒ½å¿«é€Ÿè¿›è¡Œï¼Œå½“è¿ç®—ç»“æŸåå†ä»ç¼“å­˜åŒæ­¥åˆ°å†…å­˜ä¹‹ä¸­ï¼Œè¿™æ ·å¤„ç†å™¨å°±æ— é¡»ç­‰å¾…ç¼“æ…¢çš„å†…å­˜è¯»å†™äº†ã€‚ åŸºäºé«˜é€Ÿç¼“å­˜çš„å­˜å‚¨äº¤äº’å¾ˆå¥½åœ°è§£å†³äº†å¤„ç†å™¨ä¸å†…å­˜çš„é€Ÿåº¦çŸ›ç›¾ï¼Œä½†æ˜¯ä¹Ÿä¸ºè®¡ç®—æœºç³»ç»Ÿå¸¦æ¥æ›´é«˜çš„å¤æ‚åº¦ï¼Œå› ä¸ºå¼•å…¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç¼“å­˜ä¸€è‡´æ€§ã€‚ä¸ºäº†è§£å†³ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œéœ€è¦å„ä¸ªå¤„ç†å™¨è®¿é—®ç¼“å­˜æ—¶éƒ½éµå¾ªä¸€äº›åè®®ï¼Œåœ¨è¯»å†™æ—¶è¦æ ¹æ®åè®®æ¥è¿›è¡Œæ“ä½œã€‚ä¸‹é¢æ˜¯å¸¸ç”¨çš„å†…å­˜æ¨¡å‹å›¾ï¼š é™¤äº†å¢åŠ é«˜é€Ÿç¼“å­˜ä¹‹å¤–ï¼Œä¸ºäº†ä½¿å¾—å¤„ç†å™¨çš„å†…éƒ¨çš„è¿ç®—å•å…ƒèƒ½å°½é‡è¢«å……åˆ†åˆ©ç”¨ï¼Œå¤„ç†å™¨å¯èƒ½ä¼šå¯¹è¾“å…¥ä»£ç è¿›è¡Œä¹±åºæ‰§è¡Œä¼˜åŒ–ã€‚ Javaå†…å­˜æ¨¡å‹ç›®çš„ï¼šè®©Javaç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚ ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜Javaå†…å­˜æ¨¡å‹çš„ä¸»è¦ç›®æ ‡æ˜¯å®šä¹‰ç¨‹åºä¸­å„ä¸ªå˜é‡çš„è®¿é—®è§„åˆ™ï¼Œå³åœ¨è™šæ‹Ÿæœºä¸­å°†å˜é‡å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­å–å‡ºå˜é‡è¿™æ ·çš„åº•å±‚ç»†èŠ‚ã€‚æ­¤å¤„çš„å˜é‡ä¸Javaç¼–ç¨‹ä¸­æ‰€è¯´çš„å˜é‡æœ‰æ‰€åŒºåˆ«ï¼Œå®ƒåŒ…æ‹¬å®ä¾‹å­—æ®µã€é™æ€å­—æ®µå’Œæ„æˆæ•°ç»„å¯¹è±¡çš„å…ƒç´ ï¼Œä½†ä¸åŒ…æ‹¬å±€éƒ¨å˜é‡ä¸æ–¹æ³•å‚æ•°ï¼Œå› ä¸ºåè€…æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œä¸ä¼šè¢«å…±äº«ã€‚ Javaå†…å­˜æ¨¡å‹è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­ï¼ˆæ­¤å¤„çš„ä¸»å†…å­˜ä¸ä»‹ç»ç‰©ç†ç¡¬ä»¶æ—¶çš„ä¸»å†…å­˜å¯ä»¥ç±»æ¯”ï¼Œä½†æ˜¯æ­¤å¤„ä»…ä»…æ˜¯è™šæ‹Ÿæœºå†…å­˜çš„ä¸€éƒ¨åˆ†ï¼‰ã€‚æ¯æ¡çº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼ˆå¯ä»¥ä¸å¤„ç†å™¨é«˜é€Ÿç¼“å­˜ç±»æ¯”ï¼‰ï¼Œçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚ä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œçº¿ç¨‹é—´å˜é‡å€¼çš„ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆï¼Œçº¿ç¨‹ã€ä¸»å†…å­˜ã€å·¥ä½œå†…å­˜ä¸‰è€…çš„äº¤äº’å…³ç³»å¦‚ä¸‹å›¾ï¼š è¿™é‡Œçš„Javaå†…å­˜æ¨¡å‹å¦‚æœå’ŒJavaè¿è¡Œæ—¶å†…å­˜å‹‰å¼ºå¯¹åº”ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼šä¸»å†…å­˜ä¸»è¦å¯¹åº”Javaå †ä¸­çš„å¯¹è±¡å®ä¾‹æ•°æ®éƒ¨åˆ†ï¼Œè€Œå·¥ä½œå†…å­˜åˆ™å¯¹åº”äºè™šæ‹Ÿæœºæ ˆä¸­çš„éƒ¨åˆ†åŒºåŸŸã€‚ä»æ›´ä½å±‚æ¬¡ä¸Šè¯´ï¼Œä¸»å†…å­˜ç›´æ¥å¯¹åº”äºç‰©ç†ç¡¬ä»¶å†…å­˜ï¼Œè€Œå·¥ä½œå†…å­˜ä¼˜å…ˆå­˜å‚¨äºå¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜ä¸­ã€‚ å†…å­˜é—´çš„äº¤äº’æ“ä½œJavaå†…å­˜æ¨¡å‹ä¸­å®šä¹‰äº†ä»¥ä¸‹8ç§æ“ä½œæ¥å®Œæˆï¼Œè™šæ‹Ÿæœºå®ç°æ—¶å¿…é¡»ä¿è¯ä¸‹é¢æåŠçš„æ¯ä¸€ç§æ“ä½œéƒ½æ˜¯åŸå­çš„ã€ä¸å¯å†åˆ†çš„ã€‚ lockï¼ˆé”å®šï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºä¸€æ¡çº¿ç¨‹ç‹¬å çš„çŠ¶æ€ã€‚ unlockï¼ˆè§£é”ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®šã€‚ readï¼ˆè¯»å–ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„loadåŠ¨ä½œä½¿ç”¨ã€‚ loadï¼ˆè½½å…¥ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠreadæ“ä½œä»ä¸»å†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ã€‚ useï¼ˆä½¿ç”¨ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªéœ€è¦ä½¿ç”¨å˜é‡çš„å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶å°†ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚ assignï¼ˆèµ‹å€¼ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹å€¼ç»™å·¥ä½œå†…å­˜çš„å˜é‡ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªç»™å˜é‡èµ‹å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚ storeï¼ˆå­˜å‚¨ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„writeçš„æ“ä½œã€‚ writeï¼ˆå†™å…¥ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠstoreæ“ä½œä»å·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜çš„å˜é‡ä¸­ã€‚ å¦‚æœè¦æŠŠä¸€ä¸ªå˜é‡ä»ä¸»å†…å­˜å¤åˆ¶åˆ°å·¥ä½œå†…å­˜ï¼Œé‚£å°±è¦æŒ‰é¡ºåºæ‰§è¡Œreadå’Œloadæ“ä½œï¼Œå¦‚æœè¦æŠŠå˜é‡ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ï¼Œå°±è¦æŒ‰ç…§é¡ºåºåœ°æ‰§è¡Œstoreå’Œwriteæ“ä½œã€‚æ³¨æ„ï¼ŒJavaå†…å­˜æ¨¡å‹åªè¦æ±‚ä¸Šè¿°ä¸¤ä¸ªæ“ä½œå¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œï¼Œè€Œæ²¡æœ‰ä¿è¯å¿…é¡»æ˜¯è¿ç»­æ‰§è¡Œã€‚Javaå†…å­˜æ¨¡å‹è§„å®šäº†åœ¨æ‰§è¡Œä¸Šè¿°å…«ç§åŸºæœ¬æ“ä½œæ—¶å¿…é¡»æ»¡è¶³æ—¶å¿…é¡»æ»¡è¶³å¦‚ä¸‹è§„åˆ™ï¼š ä¸å…è®¸readå’Œloadã€storeå’Œwriteæ“ä½œä¹‹ä¸€å•ç‹¬å‡ºç°ã€‚ ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹ä¸¢å¼ƒå®ƒçš„æœ€è¿‘çš„assignæ“ä½œã€‚ ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹æ— åŸå› çš„ï¼ˆæ²¡æœ‰å‘ç”Ÿè¿‡ä»»ä½•assignæ“ä½œï¼‰æŠŠæ•°æ®ä»çº¿ç¨‹çš„å·¥ä½œå†…å­˜åŒæ­¥åˆ°ä¸»å†…å­˜ä¸­ ä¸€ä¸ªæ–°çš„å˜é‡åªèƒ½åœ¨ä¸»å†…å­˜ä¸­è¯ç”Ÿï¼Œä¸å…è®¸åœ¨å·¥ä½œå†…å­˜ä¸­ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–ï¼ˆloadæˆ–assignï¼‰çš„å˜é‡ã€‚ ä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€æ¡çº¿ç¨‹å¯¹å…¶è¿›è¡Œlockæ“ä½œï¼Œä½†lockæ“ä½œå¯ä»¥è¢«åŒä¸€æ¡çº¿ç¨‹é‡å¤æ‰§è¡Œå¤šæ¬¡ï¼Œå¤šæ¬¡æ‰§è¡Œlockåï¼Œåªæœ‰æ‰§è¡Œç›¸åŒæ¬¡æ•°çš„unlockæ“ä½œï¼Œå˜é‡æ‰ä¼šè¢«è§£é”ã€‚ å¦‚æœå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œlockæ“ä½œï¼Œå°†ä¼šæ¸…ç©ºå·¥ä½œå†…å­˜ä¸­æ­¤å˜é‡çš„å€¼ï¼Œåœ¨æ‰§è¡Œå¼•æ“ä½¿ç”¨è¿™ä¸ªå˜é‡å‰ï¼Œéœ€è¦é‡æ–°æ‰§è¡Œloadæˆ–assignæ“ä½œåˆå§‹åŒ–å˜é‡çš„å€¼ã€‚ å¦‚æœä¸€ä¸ªå˜é‡äº‹å…ˆæ²¡æœ‰è¢«locké”å®šï¼Œåˆ™ä¸å…è®¸å¯¹å®ƒæ‰§è¡Œunlockæ“ä½œï¼›ä¹Ÿä¸å…è®¸å»unlockä¸€ä¸ªè¢«å…¶ä»–çº¿ç¨‹é”å®šä½çš„å˜é‡ã€‚ å¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œunlockæ“ä½œä¹‹å‰ï¼Œå¿…é¡»å…ˆæŠŠæ­¤å˜é‡åŒæ­¥å›ä¸»å†…å­˜ä¸­ï¼ˆæ‰§è¡Œstoreå’Œwriteï¼‰ã€‚ è¿™8ç§å†…å­˜è®¿é—®æ“ä½œä»¥åŠä¸Šè¿°è§„åˆ™é™å®šï¼Œå†åŠ ä¸Švolatileçš„ä¸€äº›ç‰¹æ®Šè§„å®šï¼Œå°±å·²ç»å®Œå…¨ç¡®å®šäº†Javaç¨‹åºä¸­å“ªäº›å†…å­˜è®¿é—®æ“ä½œæ˜¯å¹¶å‘æ˜¯å®‰å…¨çš„ã€‚ å¯¹äºvolatileä¿®é¥°çš„å˜é‡çš„ç‰¹æ®Šè§„åˆ™å…³é”®å­—volatileæ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚Javaå†…å­˜æ¨¡å‹å †volatileä¸“é—¨å®šä¹‰äº†ä¸€äº›ç‰¹æ®Šçš„è®¿é—®è§„åˆ™ã€‚å½“ä¸€ä¸ªå˜é‡å®šä¹‰ä¸ºvolatileä¹‹åï¼Œå®ƒå°†å…·å¤‡ä»¥ä¸‹ä¸¤ç§ç‰¹æ€§ï¼š ä¿è¯æ­¤å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§ï¼šå½“ä¸€æ¡çº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œæ–°å€¼å¯¹äºå…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯å¯ä»¥ç«‹å³å¾—çŸ¥çš„ã€‚ç”±äºvolatileå˜é‡åªèƒ½ä¿è¯å¯è§æ€§ï¼Œåœ¨ä¸ç¬¦åˆä»¥ä¸‹ä¸¤æ¡è§„åˆ™çš„è¿ç®—åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶è¦é€šè¿‡åŠ é”æ¥ä¿è¯åŸå­æ€§ã€‚ è¿ç®—ç»“æœä¸ä¾èµ–å˜é‡çš„å½“å‰å€¼ï¼Œæˆ–è€…åªèƒ½ä¿è¯åªæœ‰å•ä¸€çš„çº¿ç¨‹æ¥ä¿è¯åŸå­æ€§ã€‚ å˜é‡ä¸éœ€è¦ä¸å…¶ä»–çŠ¶æ€å˜é‡å…±åŒå‚ä¸ä¸å˜çº¦æŸã€‚ï¼ˆç›®å‰ä¸ç†è§£ï¼‰ ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼šå¦‚æœæœ‰ä¸¤ä¸ªæˆ–è€…æ›´å¤šCPUè®¿é—®åŒä¸€å—å†…å­˜ï¼Œä¸”å…¶ä¸­æœ‰ä¸€ä¸ªåœ¨è§‚æµ‹å¦ä¸€ä¸ªï¼Œé‚£ä¹ˆå®ƒä¼šé€šè¿‡è®¾ç½®å†…å­˜å±éšœæ¥ä½¿é‡æ’åºæ—¶ä¸èƒ½æŠŠåé¢çš„æŒ‡ä»¤é‡æ’åºåˆ°å†…å­˜å±éšœä¹‹å‰è®¿é—®ã€‚ volatileçš„æ„ä¹‰ï¼švolatileå˜é‡è¯»æ“ä½œçš„æ¶ˆè€—ä¸æ™®é€šå˜é‡å‡ ä¹æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Œä½†æ˜¯å†™æ“ä½œåˆ™å¯èƒ½æ…¢ä¸€ç‚¹ï¼Œå› ä¸ºå®ƒéœ€è¦åœ¨æœ¬åœ°ä»£ç ä¸­æ’å…¥è®¸å¤šå†…å­˜å±éšœæŒ‡ä»¤æ¥ä¿è¯å¤„ç†å™¨ä¸å‘ç”Ÿä¹±åºæ‰§è¡Œï¼Œä¸è¿‡å³ä¾¿å¦‚æ­¤ï¼Œå¤§å¤šæ•°åœºæ™¯ä¸‹volatileå¾—æ€»å¼€é”€ä»ç„¶æ¯”é”ä½ã€‚ volatileçš„ç‰¹æ®Šè§„åˆ™å°±æ˜¯ï¼šuse/assignã€load/storeã€read/writeæ“ä½œå¿…é¡»è¿ç»­ä¸€èµ·å‡ºç°ï¼Œå³volatileä¿®é¥°çš„å˜é‡ä¸ä¼šè¢«æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚ å¯¹äºlongå’Œdoubleç±»å‹çš„å˜é‡çš„ç‰¹æ®Šè§„åˆ™Javaå†…å­˜æ¨¡å‹è¦æ±‚å¯¹äºlockã€unlockã€readã€loadã€assignã€useã€storeå’Œwriteè¿™å…«ä¸ªæ“ä½œéƒ½å…·æœ‰åŸå­æ€§ï¼Œä½†æ˜¯å¯¹äº64ä½çš„æ•°æ®ç±»å‹ï¼ˆlongå’Œdoubleï¼‰ï¼Œå…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢«volatileä¿®é¥°çš„64ä½æ•°æ®çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡32ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œå³å…è®¸è™šæ‹Ÿæœºå®ç°é€‰æ‹©å¯ä»¥ä¸ä¿è¯64ä½æ•°æ®ç±»å‹çš„loadã€storeã€readå’Œwriteè¿™å››ä¸ªæ“ä½œçš„åŸå­æ€§ï¼Œä½†æ˜¯å¼ºçƒˆå»ºè®®è™šæ‹Ÿæœºå®ç°ä¸ºå…·æœ‰åŸå­æ€§çš„æ“ä½œã€‚ åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§åŸå­æ€§ç”±Javaå†…å­˜æ¨¡å‹æ¥ç›´æ¥ä¿è¯çš„åŸå­æ€§å˜é‡æ“ä½œåŒ…æ‹¬readã€loadã€assignã€useã€storeå’Œwriteè¿™å…­ä¸ªï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥è®¤ä¸ºåŸºæœ¬æ•°æ®ç±»å‹çš„è®¿é—®è¯»å†™æ˜¯å…·å¤‡åŸå­æ€§çš„ã€‚synchronizedå…³é”®å­—å¯ä»¥å®ç°åŸå­æ€§ã€‚ å¯è§æ€§å¯è§æ€§å°±æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚volatileã€synchronizedä»¥åŠfinalå…³é”®å­—éƒ½èƒ½å®ç°å¯è§æ€§ã€‚ æœ‰åºæ€§Javaç¨‹åºä¸­å¤©ç„¶çš„æœ‰åºæ€§å¯ä»¥æ€»ç»“ä¸ºä¸€å¥è¯ï¼šå¦‚æœåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼›å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— åºçš„ã€‚å‰åŠå¥æ˜¯æŒ‡â€œçº¿ç¨‹å†…è¡¨ç°ä¸ºä¸²è¡Œçš„è¯­ä¹‰â€ï¼ŒååŠå¥æ˜¯æŒ‡â€œæŒ‡ä»¤é‡æ’åºâ€ç°è±¡å’Œâ€œå·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜åŒæ­¥å»¶è¿Ÿâ€ç°è±¡ã€‚volatileå’Œsynchronizedå…³é”®å­—éƒ½èƒ½å®ç°æœ‰åºæ€§ã€‚ å…ˆè¡Œå‘ç”ŸåŸåˆ™å…ˆè¡Œå‘ç”Ÿæ˜¯Javaå†…å­˜æ¨¡å‹ä¸­å®šä¹‰çš„ä¸¤é¡¹æ“ä½œä¹‹é—´çš„ååºå…³ç³»ï¼Œå¦‚æœè¯´æ“ä½œAå…ˆè¡Œå‘ç”Ÿäºæ“ä½œBï¼Œå…¶å®å°±æ˜¯è¯´åœ¨å‘ç”Ÿæ“ä½œBä¹‹å‰ï¼Œæ“ä½œAäº§ç”Ÿçš„å½±å“èƒ½è¢«æ“ä½œBè§‚å¯Ÿåˆ°ï¼Œâ€œå½±å“â€åŒ…æ‹¬ä¿®æ”¹äº†å†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼ã€å‘é€äº†å°å†™ã€è°ƒç”¨äº†æ–¹æ³•ç­‰ã€‚ ä¸‹é¢æ˜¯Javaå†…å­˜æ¨¡å‹ä¸‹ä¸€äº›â€œå¤©ç„¶çš„â€å…ˆè¡Œå‘ç”Ÿå…³ç³»ï¼Œè¿™äº›å…ˆè¡Œå‘é€å…³ç³»æ— é¡»ä»»ä½•åŒæ­¥å™¨ååŠ©å°±å·²ç»å­˜åœ¨ï¼Œå¯ä»¥åœ¨ç¼–ç ä¸­ç›´æ¥ä½¿ç”¨ã€‚å¦‚æœä¸¤ä¸ªæ“ä½œä¹‹é—´çš„å…³ç³»ä¸åœ¨æ­¤åˆ—ï¼Œå¹¶ä¸”æ— æ³•ä»ä¸‹åˆ—è§„åˆ™æ¨å¯¼å‡ºæ¥çš„è¯ï¼Œä»–ä»¬å°±æ²¡æœ‰é¡ºåºæ€§ä¿éšœï¼Œè™šæ‹Ÿæœºå¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œéšæ„é‡æ–°æ’åºï¼š ç¨‹åºæ¬¡åºè§„åˆ™ï¼ˆProgram Order Ruleï¼‰ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ç¨‹åºä»£ç é¡ºåºï¼Œä¹¦å†™åœ¨å‰çš„æ“ä½œå…ˆäºä¹¦å†™åœ¨åé¢çš„æ“ä½œã€‚å‡†ç¡®åœ°è¯´åº”è¯¥æ˜¯æ§åˆ¶æµé¡ºåºè€Œä¸æ˜¯ç¨‹åºä»£ç é¡ºåºï¼Œå› ä¸ºè¦è€ƒè™‘åˆ†æ”¯ã€å¾ªç¯ç­‰ç»“æ„ã€‚ ç®¡ç¨‹é”å®šè§„åˆ™ï¼ˆMonitor Lock Ruleï¼‰ï¼šä¸€ä¸ªunlockæ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œã€‚è¿™é‡Œå¿…é¡»å¼ºè°ƒçš„æ˜¯åŒä¸€ä¸ªé”ï¼Œè€Œâ€œåé¢â€æ˜¯æŒ‡æ—¶é—´ä¸Šçš„å…ˆåé¡ºåºã€‚ volatileå˜é‡è§„åˆ™ï¼ˆVolatile Variable Ruleï¼‰ï¼šå¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œã€‚â€œåé¢â€æ˜¯æŒ‡æ—¶é—´ä¸Šçš„å…ˆåé¡ºåºã€‚ çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼ˆThread Start Ruleï¼‰ï¼šThreadå¯¹è±¡çš„start()æ–¹æ³•å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚ çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ï¼ˆThread Termination Ruleï¼‰ï¼šçº¿ç¨‹ä¸­æ‰€æœ‰æ“ä½œéƒ½å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹ã€‚ çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼ˆThread Interruption Ruleï¼‰ï¼šå¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿã€‚ å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼ˆFinalizer Ruleï¼‰ï¼šä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆï¼ˆæ„é€ å‡½æ•°æ‰§è¡Œç»“æŸï¼‰å…ˆè¡Œå‘ç”Ÿäºå®ƒçš„finalize()æ–¹æ³•çš„å¼€å§‹ã€‚ ä¼ é€’æ€§ï¼ˆTransitivityï¼‰ï¼šå¦‚æœæ“ä½œAå…ˆè¡Œå‘ç”Ÿäºæ“ä½œBï¼Œæ“ä½œBå…ˆè¡Œå‘ç”Ÿäºæ“ä½œCï¼Œé‚£å°±å¯ä»¥å¾—åˆ°æ“ä½œAå…ˆè¡Œå‘ç”Ÿäºæ“ä½œCã€‚ Javaä¸çº¿ç¨‹åœ¨Javaé‡Œé¢è°ˆè®ºå¹¶å‘ï¼Œå¤§å¤šæ•°éƒ½ä¸çº¿ç¨‹è„±ä¸å¼€å…³ç³»ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨Javaçº¿ç¨‹åœ¨è™šæ‹Ÿæœºçš„å®ç°ã€‚ çº¿ç¨‹çš„å®ç°çº¿ç¨‹æ˜¯æ¯”è¿›ç¨‹æ›´è½»é‡çº§çš„è°ƒåº¦æ‰§è¡Œå•ä½ï¼Œçº¿ç¨‹çš„å¼•å…¥ï¼Œå¯ä»¥æŠŠä¸€ä¸ªè¿›ç¨‹çš„èµ„æºåˆ†é…å’Œæ‰§è¡Œè°ƒåº¦åˆ†å¼€ï¼Œå„ä¸ªçº¿ç¨‹æ—¢å¯ä»¥å…±äº«è¿›ç¨‹èµ„æºï¼Œåˆå¯ä»¥ç‹¬ç«‹è°ƒåº¦ï¼ˆçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼‰ã€‚ å®ç°çº¿ç¨‹ä¸»è¦æœ‰3ç§æ–¹å¼ï¼šä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°ã€ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°å’Œä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§çº¿ç¨‹æ··åˆå®ç°ã€‚ Javaçº¿ç¨‹è°ƒåº¦çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡ç³»ç»Ÿä¸ºçº¿ç¨‹åˆ†é…å¤„ç†å™¨ä½¿ç”¨æƒçš„è¿‡ç¨‹ï¼Œä¸»è¦è°ƒåº¦æ–¹å¼æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ååŒå¼çº¿ç¨‹è°ƒåº¦å’ŒæŠ¢å å¼çº¿ç¨‹è°ƒåº¦ã€‚ ååŒå¼çº¿ç¨‹è°ƒåº¦ï¼šçº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ç”±çº¿ç¨‹æœ¬èº«æ¥æ§åˆ¶ï¼Œçº¿ç¨‹æŠŠè‡ªå·±çš„å·¥ä½œæ‰§è¡Œå®Œæ¯•åï¼Œè¦ä¸»åŠ¨é€šçŸ¥ç³»ç»Ÿåˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ä¸Šå»ã€‚å¥½å¤„æ˜¯å®ç°ç®€å•ï¼Œæ²¡æœ‰çº¿ç¨‹åŒæ­¥é—®é¢˜ï¼›ç¼ºç‚¹æ˜¯ï¼šçº¿ç¨‹æ‰§è¡Œæ—¶é—´ä¸å¯æ§åˆ¶ï¼Œå®¹æ˜“å¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒã€‚ æŠ¢å å¼çº¿ç¨‹è°ƒåº¦ï¼šæ¯ä¸ªçº¿ç¨‹å°†ç”±ç³»ç»Ÿæ¥åˆ†é…æ‰§è¡Œæ—¶é—´ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ç”±çº¿ç¨‹æœ¬èº«æ¥å†³å®šã€‚å¥½å¤„æ˜¯çº¿ç¨‹æ‰§è¡Œä¹‹é—´å¯æ§ï¼Œä¸ä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¼è‡´æ•´ä¸ªè¿›ç¨‹é˜»å¡çš„é—®é¢˜ï¼ŒJavaä½¿ç”¨çš„çº¿ç¨‹è°ƒåº¦æ–¹å¼å°±æ˜¯æŠ¢å å¼è°ƒåº¦ã€‚è¿™é‡Œè¯´ä¸€ä¸‹å°±æ˜¯javaçº¿ç¨‹ä¼˜å…ˆçº§ä¸å¤ªé è°±ï¼ŒåŸå› æ˜¯Javaçš„çº¿ç¨‹æ˜¯é€šè¿‡æ˜ å°„åˆ°ç³»ç»Ÿçš„åŸç”Ÿçº¿ç¨‹ä¸Šæ¥å®ç°çš„ï¼Œæ‰€ä»¥çº¿ç¨‹è°ƒåº¦æœ€ç»ˆè¿˜æ˜¯å–å†³äºæ“ä½œç³»ç»Ÿã€‚ çº¿ç¨‹çŠ¶æ€è½¬æ¢Javaè¯­è¨€å®šä¹‰äº†5ç§çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸”åªæœ‰å…¶ä¸­çš„ä¸€ç§çŠ¶æ€ï¼Œè¿™5ç§çŠ¶æ€åˆ†åˆ«æ˜¯ï¼šæ–°å»ºï¼Œè¿è¡Œï¼Œæ— é™æœŸç­‰å¾…ï¼Œé™æœŸç­‰å¾…ï¼Œé˜»å¡ï¼Œç»“æŸã€‚ä¸Šè¿°5ç§çŠ¶æ€åœ¨é‡åˆ°ç‰¹å®šæ—¶é—´å‘ç”Ÿçš„æ—¶å€™å›äº’ç›¸è½¬æ¢ï¼Œä»–ä»¬çš„è½¬æ¢å…³ç³»å¦‚ä¸‹å›¾ï¼š æ€»ç»“è™šæ‹Ÿæœºæœ¬èº«å…·æœ‰ä¸€å¥—å’Œçº¿ç¨‹ç›¸å…³å†…å­˜æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨å¥½å®ƒï¼Œç‰¹åˆ«æ˜¯è¦ç†è§£çº¿æ€§å‘ç”ŸåŸåˆ™ä»¥åŠvolatilçš„ä¸€äº›ç‰¹æ®Šè§„åˆ™ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ Javaå†…å­˜æ¨¡å‹]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_12_æ™šæœŸï¼ˆè¿è¡ŒæœŸï¼‰ä¼˜åŒ–]]></title>
    <url>%2F2017%2F12%2F12%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-12-%E6%99%9A%E6%9C%9F%EF%BC%88%E8%BF%90%E8%A1%8C%E6%9C%9F%EF%BC%89%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¹‹å‰è¯´è¿‡Javaä¸­çš„JITå³æ—¶ç¼–è¯‘å™¨åœ¨è¿è¡ŒæœŸçš„ä¼˜åŒ–å¯¹äºç¨‹åºè¿è¡Œæ¥è¯´æ›´é‡è¦ï¼Œé‚£æˆ‘ä»¬å°±æ¥çœ‹çœ‹è¿™ä¸ªå³æ—¶ç¼–è¯‘å™¨ã€‚æœ¬æ–‡æåŠçš„ç¼–è¯‘å™¨ã€å³æ—¶ç¼–è¯‘å™¨éƒ½æ˜¯æŒ‡HotSpotè™šæ‹Ÿæœºå†…çš„å³æ—¶ç¼–è¯‘å™¨ï¼Œè™šæ‹Ÿæœºä¹Ÿç‰¹æŒ‡HotSpotè™šæ‹Ÿæœºã€‚ ä»€ä¹ˆæ˜¯å³æ—¶ç¼–è¯‘å™¨åœ¨éƒ¨åˆ†çš„å•†ç”¨è™šæ‹Ÿæœºä¸­ï¼ŒJavaç¨‹åºæœ€åˆæ˜¯é€šè¿‡è§£é‡Šå™¨æ¥è§£é‡Šæ‰§è¡Œçš„ï¼Œå½“è™šæ‹Ÿæœºå‘ç°æŸä¸ªæ–¹æ³•æˆ–ä»£ç å—çš„è¿è¡Œç‰¹åˆ«é¢‘ç¹æ—¶ï¼Œå°±ä¼šæŠŠè¿™äº›ä»£ç è®¤å®šä¸ºâ€œçƒ­ç‚¹ä»£ç â€ï¼ˆHot Spot Codeï¼‰,ä¸ºäº†æé«˜ çƒ­ç‚¹ä»£ç çš„æ‰§è¡Œæ•ˆç‡ï¼Œåœ¨è¿è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºå°†ä¼šæŠŠè¿™äº›ä»£ç ç¼–è¯‘æˆä¸æœ¬åœ°å¹³å°ç›¸å…³çš„æœºå™¨ç ï¼Œå¹¶è¿›è¡Œå„ç§å±‚æ¬¡çš„ä¼˜åŒ–ï¼Œå®Œæˆè¿™ä¸ªä»»åŠ¡çš„ç¼–è¯‘å™¨ ç§°ä¸ºå³æ—¶ç¼–è¯‘å™¨ï¼ˆJust In Time Compiler,ç®€ç§°JITç¼–è¯‘å™¨ï¼‰ã€‚ HotSpotè™šæ‹Ÿæœºå†…çš„å³æ—¶ç¼–è¯‘å™¨ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è§£é‡Šå™¨ä¸ç¼–è¯‘å™¨å¹¶å­˜çš„æ¶æ„ è§£é‡Šå™¨ä¸ç¼–è¯‘å™¨å„æœ‰ä¼˜åŠ¿ï¼šå½“ç¨‹åºéœ€è¦è¿…é€Ÿå¯åŠ¨å’Œæ‰§è¡Œçš„æ—¶å€™ï¼Œè§£é‡Šå™¨å¯ä»¥é¦–å…ˆå‘æŒ¥ä½œç”¨ï¼Œçœå»ç¼–è¯‘çš„æ—¶é—´ï¼Œç«‹å³æ‰§è¡Œã€‚åœ¨ç¨‹åºè¿è¡Œåï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œç¼–è¯‘å™¨é€æ¸å‘æŒ¥ä½œç”¨ï¼ŒæŠŠè¶Šæ¥è¶Šå¤šçš„ä»£ç ç¼–è¯‘æˆæœ¬åœ°ä»£ç ä¹‹åï¼Œå¯ä»¥è·å¾—æ›´é«˜çš„æ‰§è¡Œæ•ˆç‡ï¼Œå½“ç¨‹åºè¿è¡Œç¯å¢ƒä¸­å†…å­˜èµ„æºé™åˆ¶è¾ƒå¤§æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è§£é‡Šæ‰§è¡ŒèŠ‚çº¦å†…å­˜ï¼Œåä¹‹å¯ä»¥ä½¿ç”¨ç¼–è¯‘æ‰§è¡Œæ¥æé«˜æ•ˆç‡ã€‚ è§£é‡Šå™¨å¯ä»¥ä½œä¸ºç¼–è¯‘å™¨æ¿€è¿›ä¼˜åŒ–æ—¶çš„ä¸€ä¸ªâ€œé€ƒç”Ÿé—¨â€ï¼Œå¯ä»¥é€šè¿‡é€†ä¼˜åŒ–é€€å›åˆ°è§£é‡Šå™¨çŠ¶æ€ç»§ç»­æ‰§è¡Œã€‚ HotSpotè™šæ‹Ÿæœºå†…ç½®ç¼–è¯‘å™¨ Client Compiler(C1ç¼–è¯‘å™¨)ï¼šä½¿ç”¨â€œ-clientâ€ å‚æ•°å»å¼ºåˆ¶æŒ‡å®šè™šæ‹Ÿæœºè¿è¡Œåœ¨Clientæ¨¡å¼ã€‚ Server Compiler(C2ç¼–è¯‘å™¨)ï¼šä½¿ç”¨â€œ-serverâ€ å‚æ•°å»å¼ºåˆ¶æŒ‡å®šè™šæ‹Ÿæœºè¿è¡Œåœ¨Serveræ¨¡å¼ã€‚ è™šæ‹Ÿæœºé»˜è®¤é‡‡ç”¨è§£é‡Šå™¨ä¸ç¼–è¯‘å™¨æ­é…ä½¿ç”¨çš„æ–¹å¼ï¼ˆæ··åˆæ¨¡å¼ï¼‰ã€‚ä¸ºäº†åœ¨ç¨‹åºå“åº”é€Ÿåº¦å’Œè¿è¡Œæ•ˆç‡ä¹‹é—´è¾¾åˆ°æœ€ä½³å¹³è¡¡ï¼ŒHotSpotè™šæ‹Ÿæœºä¼šé€æ¸å¯ç”¨åˆ†å±‚ç¼–è¯‘ç­–ç•¥ï¼š ç¬¬0å±‚ï¼šç¨‹åºè§£é‡Šæ‰§è¡Œï¼Œè§£é‡Šå™¨ä¸å¼€å¯æ€§èƒ½ç›‘æ§åŠŸèƒ½ï¼Œå¯è§¦å‘ç¬¬1å±‚ç¼–è¯‘ã€‚ ç¬¬1å±‚ï¼šä¹Ÿç§°ä¸ºC1ç¼–è¯‘ï¼Œå°†å­—èŠ‚ç ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç ï¼Œè¿›è¡Œç®€å•ï¼Œå¯é çš„ä¼˜åŒ–ï¼Œå¦‚æœå¿…è¦å°†åŠ å…¥æ€§èƒ½ç›‘æ§çš„é€»è¾‘ã€‚ ç¬¬2å±‚ï¼ˆæˆ–2å±‚ä»¥ä¸Šï¼‰ï¼šä¹Ÿç§°ä¸ºC2ç¼–è¯‘ï¼Œä¹Ÿæ˜¯å°†å­—èŠ‚ç ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç ï¼Œä½†æ˜¯ä¼šå¯ç”¨ä¸€äº›ç¼–è¯‘è€—æ—¶è¾ƒé•¿çš„ä¼˜åŒ–ï¼Œç”šè‡³ä¼šæ ¹æ®æ€§èƒ½ç›‘æ§ä¿¡æ¯è¿›è¡Œä¸€äº›ä¸å¯é çš„æ¿€è¿›ä¼˜åŒ–ã€‚ ç¼–è¯‘å¯¹è±¡ä¸è§¦å‘æ¡ä»¶ç¼–è¯‘å¯¹è±¡ï¼ˆçƒ­ç‚¹ä»£ç ï¼‰ è¢«å¤šæ¬¡è°ƒç”¨çš„æ–¹æ³•ï¼ˆJITç¼–è¯‘æ–¹å¼ï¼‰ è¢«å¤šæ¬¡æ‰§è¡Œçš„å¾ªç¯ä½“ï¼ˆOSRç¼–è¯‘æ–¹å¼ï¼‰ çƒ­ç‚¹æ¢æµ‹ åŸºäºé‡‡æ ·çš„çƒ­ç‚¹æ¢æµ‹ï¼šè™šæ‹Ÿæœºå‘¨æœŸåœ°æ£€æŸ¥å„ä¸ªçº¿ç¨‹çš„æ ˆé¡¶ï¼Œå¦‚æœå‘ç°æŸä¸ªï¼ˆæˆ–æŸäº›ï¼‰æ–¹æ³•ç»å¸¸å‡ºç°åœ¨æ ˆé¡¶ï¼Œé‚£è¿™ä¸ªæ–¹æ³•å°±æ˜¯â€œçƒ­ç‚¹æ–¹æ³•â€ã€‚ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ã€é«˜æ•ˆï¼Œè¿˜å¯ä»¥å¾ˆå®¹æ˜“è·å–æ–¹æ³•çš„è°ƒç”¨å…³ç³»ï¼ˆå°†è°ƒç”¨å †æ ˆå±•å¼€å³å¯ï¼‰ï¼Œç¼ºç‚¹å°±æ˜¯å¾ˆéš¾ç²¾ç¡®å¾—ç¡®è®¤ä¸€ä¸ªæ–¹æ³•çš„çƒ­åº¦ï¼Œå®¹æ˜“å› ä¸ºå—åˆ°çº¿ç¨‹é˜»å¡æˆ–è€…åˆ«çš„å¤–ç•Œå› ç´ çš„å½±å“è€Œæ‰°ä¹±çƒ­ç‚¹æ¢æµ‹ã€‚ åŸºäºè®¡æ•°å™¨çš„çƒ­ç‚¹æ¢æµ‹ï¼šè™šæ‹Ÿæœºä¼šæ¯ä¸€ä¸ªæ–¹æ³•ï¼ˆç”šè‡³æ˜¯ä»£ç å—ï¼‰å»ºç«‹è®¡æ•°å™¨ï¼Œç»Ÿè®¡æ–¹æ³•çš„æ‰§è¡Œæ¬¡æ•°ï¼Œå¦‚æœæ‰§è¡Œæ¬¡æ•°è¶…è¿‡ä¸€å®šçš„é˜ˆå€¼å°±è®¤å®šå®ƒæ˜¯â€œçƒ­ç‚¹æ–¹æ³•â€ã€‚ç¼ºç‚¹æ˜¯å®ç°éº»çƒ¦ï¼Œéœ€è¦ä¸ºæ¯ä¸ªæ–¹æ³•å»ºç«‹å¹¶ç»´æŠ¤è®¡æ•°å™¨ï¼Œè€Œä¸”ä¸èƒ½ç›´æ¥è·å–åˆ°æ–¹æ³•çš„è°ƒç”¨å…³ç³»ï¼Œä¼˜ç‚¹æ˜¯ç»Ÿè®¡ç»“æœæ›´åŠ ç²¾ç¡®å’Œä¸¥è°¨ã€‚ åœ¨HotSpotè™šæ‹Ÿæœºä¸­ä½¿ç”¨çš„æ˜¯åŸºäºè®¡æ•°å™¨çš„çƒ­ç‚¹æ¢æµ‹æ–¹æ³•ã€‚å› æ­¤å®ƒä¸ºæ¯ä¸ªæ–¹æ³•å‡†å¤‡äº†ä¸¤ç±»è®¡æ•°å™¨ï¼šæ–¹æ³•è°ƒç”¨è®¡æ•°å™¨ï¼ˆç”¨äºæ¢æµ‹æ–¹æ³•ï¼‰å’Œå›è¾¹è®¡æ•°å™¨ï¼ˆç”¨äºæ¢æµ‹å¾ªç¯ä½“ï¼‰ã€‚è¿™ä¸¤ä¸ªè®¡æ•°å™¨éƒ½æœ‰ä¸€ä¸ªç¡®å®šçš„é˜ˆå€¼ï¼Œå½“è®¡æ•°å™¨è¶…è¿‡äº†é˜ˆå€¼ï¼Œå°±ä¼šæäº¤ç¼–è¯‘è¯·æ±‚ã€‚ ç¼–è¯‘è¿‡ç¨‹åœ¨é»˜è®¤è®¾ç½®ä¸‹ï¼Œæ— è®ºæ˜¯æ–¹æ³•è°ƒç”¨äº§ç”Ÿçš„å³æ—¶ç¼–è¯‘è¯·æ±‚ï¼Œè¿˜æ˜¯OSRç¼–è¯‘è¯·æ±‚ï¼Œè™šæ‹Ÿæœºä»£ç ç¼–è¯‘å™¨è¿˜æœªå®Œæˆä¹‹å‰ï¼Œéƒ½ä¾ç„¶å°†æŒ‰ç…§è§£é‡Šæ–¹å¼ç»§ç»­æ‰§è¡Œï¼Œè€Œç¼–è¯‘åŠ¨ä½œåˆ™åœ¨åå°çš„ç¼–è¯‘çº¿ç¨‹ä¸­è¿›è¡Œã€‚ Client Compilerå®ƒæ˜¯ä¸ªä¸‰æ®µå¼ç¼–è¯‘å™¨ï¼Œä¸»è¦å…³æ³¨ç‚¹åœ¨å±€éƒ¨æ€§çš„ä¼˜åŒ–ï¼Œæ”¾å¼ƒäº†è®¸å¤šè€—æ—¶è¾ƒé•¿çš„å…¨å±€ä¼˜åŒ–æ‰‹æ®µã€‚ä¸‹é¢æ˜¯ä¸‰ä¸ªé˜¶æ®µ å­—èŠ‚ç -&gt;é«˜çº§ä¸­é—´ä»£ç ï¼ˆHIRï¼‰:ä½¿ç”¨é™æ€å•åˆ†é…çš„å½¢å¼æ¥ä»£è¡¨ä»£ç å€¼ï¼Œå…¶ä¸­ä¼šå®Œæˆæ–¹æ³•å†…è”ã€å¸¸é‡ä¼ æ’­ç­‰ä¼˜åŒ–ã€‚ HIR-&gt;ä½çº§ä¸­é—´ä»£ç ï¼ˆLIRï¼‰ï¼šä¼šåœ¨HIRä¸Šå®Œæˆç©ºå€¼æ£€æŸ¥æ¶ˆé™¤ã€èŒƒå›´æ£€æŸ¥æ¶ˆé™¤ç­‰ä¼˜åŒ–ï¼Œä»¥ä¾¿è®©HIRè¾¾åˆ°æ›´é«˜æ•ˆçš„ä»£ç çš„è¡¨ç¤ºå½¢å¼ã€‚ LIR-&gt;æœºå™¨ä»£ç ï¼šåœ¨å¹³å°ç›¸å…³çš„åç«¯ä½¿ç”¨çº¿æ€§æ‰«æç®—æ³•åœ¨LIRä¸Šåˆ†é…å¯„å­˜å™¨ï¼Œå¹¶åœ¨LIRä¸Šåšçª¥å­”ä¼˜åŒ–ã€‚ Server Compilerå®ƒæ˜¯ä¸“é—¨é¢å‘æœåŠ¡ç«¯çš„å…¸å‹åº”ç”¨å¹¶ä¸ºæœåŠ¡å™¨ç«¯çš„æ€§èƒ½é…ç½®ç‰¹åˆ«è°ƒæ•´è¿‡çš„ç¼–è¯‘å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå……åˆ†ä¼˜åŒ–è¿‡çš„é«˜çº§ç¼–è¯‘å™¨ã€‚å®ƒä¼šæ‰§è¡Œæ‰€æœ‰ç»å…¸çš„ä¼˜åŒ–å·¥ä½œã€‚å®ƒçš„å¯„å­˜å™¨åˆ†é…å™¨æ˜¯ä¸€ä¸ªå…¨å±€å›¾ç€è‰²åˆ†é…å™¨ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨æŸäº›å¤„ç†å™¨æ¶æ„ä¸Šçš„å¤§å¯„å­˜å™¨é›†åˆã€‚ æŸ¥çœ‹åŠåˆ†æå³æ—¶ç¼–è¯‘ç»“æœè¿™ä¸€å—æˆ‘æ²¡æœ‰å»å®è·µï¼Œä½†æ˜¯è¿™é‡Œå†™ä¸€ä¸ªç»“è®ºï¼šåœ¨Javaä¸­ç©ºå¾ªç¯ä¸èƒ½ç”¨ä½œç¨‹åºå»¶æ—¶çš„æ‰‹æ®µï¼Œå› ä¸ºç©ºå¾ªç¯ä¼šè¢«ä¼˜åŒ–æ¶ˆé™¤ã€‚ ç¼–è¯‘ä¼˜åŒ–æŠ€æœ¯Javaç¨‹åºå‘˜æœ‰ä¸€ä¸ªå…±è¯†ï¼šä»¥ç¼–è¯‘æ–¹å¼æ‰§è¡Œæœ¬åœ°ä»£ç æ¯”è§£é‡Šæ–¹å¼æ›´å¿«ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºè™šæ‹Ÿæœºè®¾è®¡å›¢é˜Ÿå‡ ä¹æŠŠå¯¹ä»£ç çš„æ‰€æœ‰ä¼˜åŒ–æªæ–½éƒ½é›†ä¸­åœ¨ç¼–è¯‘å™¨ä¹‹ä¸­äº†ã€‚å…³äºHotSpotçš„ä¼˜åŒ–æŠ€æœ¯åˆ—è¡¨å¯ä»¥å‚è€ƒã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ä¸€ä¹¦ï¼Œè¿™é‡Œä¹Ÿæ ¹æ®ä¹¦ä¸Šä¸¾çš„å‡ ä¸ªä¾‹å­æ¥çœ‹çœ‹å…¶ä¸­çš„ä¼˜åŒ–æŠ€æœ¯ã€‚ å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤å«ä¹‰æ˜¯ï¼šå¦‚æœä¸€ä¸ªè¡¨è¾¾å¼Eå·²ç»è®¡ç®—è¿‡äº†ï¼Œå¹¶ä¸”ä»å…ˆå‰çš„è®¡ç®—åˆ°ç°åœ¨Eä¸­æ‰€æœ‰çš„å˜é‡çš„å€¼éƒ½æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆEçš„è¿™æ¬¡å‡ºç°å°±æˆä¸ºäº†å…¬å…±å­è¡¨è¾¾å¼ã€‚å¯¹äºè¿™ç§è¡¨è¾¾å¼ï¼Œæ²¡æœ‰å¿…è¦èŠ±æ—¶é—´å†å¯¹å®ƒè¿›è¡Œè®¡ç®—ï¼Œåªéœ€è¦ç›´æ¥ç”¨å‰é¢è®¡ç®—è¿‡çš„è¡¨è¾¾å¼ç»“æœä»£æ›¿Eå³å¯ã€‚å¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä¼˜åŒ–å†ç¨‹ï¼š12345678// æºä»£ç int d = (c * b) * 12 + a + (a + b * c);// ç¼–è¯‘å™¨æ£€æµ‹åˆ°â€œc * bâ€å’Œâ€œb * câ€æ˜¯ä¸€æ ·çš„è¡¨è¾¾å¼ï¼Œè¿™æ¡è¡¨è¾¾å¼å°±å˜æˆä¸‹é¢è¿™æ ·äº†int d = E * 12 + a + (a + E);// ç¼–è¯‘å™¨è¿˜å¯èƒ½è¿›è¡Œä»£æ•°ç®€åŒ–ï¼ŒæŠŠè¡¨è¾¾å¼å˜ä¸ºï¼šint d = E * 13 + a * 2; å¤§å®¶è‚¯å®šèƒ½å‘ç°ï¼Œæœ€åçš„è¡¨è¾¾å¼è®¡ç®—èµ·æ¥å°±å¯ä»¥èŠ‚çœæ—¶é—´äº†ã€‚ æ•°ç»„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤å«ä¹‰ï¼šè™šæ‹Ÿæœºæ‰§è¡Œå­ç³»ç»Ÿæ¯æ¬¡æ•°ç»„çš„è¯»å†™éƒ½å¸¦æœ‰ä¸€æ¬¡éšå«çš„æ¡ä»¶åˆ¤æ–­æ“ä½œï¼Œè¿™å¯¹äºæ‹¥æœ‰å¤§é‡ æ•°ç»„è®¿é—®çš„ç¨‹åºä»£ç ï¼Œæ— ç–‘æ˜¯ä¸€ç§æ€§èƒ½è´Ÿæ‹…ã€‚è§£å†³æ€è·¯é™¤äº†å°†æ•°ç»„è¾¹ç•Œæ£€æŸ¥ä¼˜åŒ–å°½å¯èƒ½æŠŠè¿è¡ŒæœŸæ£€æŸ¥æåˆ°ç¼–è¯‘æœŸå®Œæˆä¹‹å¤–ï¼Œè¿˜æœ‰å¦ä¸€ç§æ€è·¯â€”â€”éšå¼å¼‚å¸¸å¤„ç†ï¼ˆtry - catchï¼‰ã€‚å¯ä»¥çœ‹çœ‹ä»£ç ï¼š12345678910111213// æºä»£ç if (foo != null) &#123; return foo.value&#125; else &#123; throw new NullPointException();&#125;// ç¼–è¯‘å™¨è½¬æ¢ä»£ç try &#123; return foo.value;&#125; catch(segment_fault) &#123; uncommon_trap();&#125; è¿™æ ·å¯ä»¥é¿å…æ¯æ¬¡å»åšéç©ºæ£€æŸ¥ã€‚ æ–¹æ³•å†…è”å®ƒé™¤äº†æ¶ˆé™¤æ–¹æ³•è°ƒç”¨æˆæœ¬ä¹‹å¤–ï¼Œå®ƒæ›´é‡è¦çš„æ˜¯ä½å…¶ä»–ä¼˜åŒ–æ‰‹æ®µå»ºç«‹è‰¯å¥½çš„åŸºç¡€ï¼Œå¦‚æœä¸åšå†…è”ï¼Œå°±å‘ç°ä¸äº†æ— ç”¨ä»£ç ã€‚ã€‚å†…è”å…·æœ‰ä¸¤ç§æƒ…å†µï¼š å¯¹äºéè™šæ–¹æ³•ï¼šç›´æ¥å†…è” å¯¹äºè™šæ–¹æ³•ï¼šä¼šä½¿ç”¨â€œç±»å‹ç»§æ‰¿å…³ç³»åˆ†æâ€ï¼ˆCHAï¼‰æŠ€æœ¯ï¼Œè™šæ‹Ÿæœºå¦‚æœé‡åˆ°è™šæ–¹æ³•å°±ä¼šå‘CHAæŸ¥è¯¢æ­¤æ–¹æ³•åœ¨å½“å‰ç¨‹åºä¸‹æ˜¯å¦æœ‰å¤šä¸ªç›®æ ‡ç‰ˆæœ¬å¯ä¾›é€‰æ‹©ï¼Œå¦‚æœæŸ¥è¯¢ç»“æœåªæœ‰ä¸€ä¸ªç‰ˆæœ¬ï¼Œå°±å¯ä»¥è¿›è¡Œå†…è”ï¼Œä¸è¿‡è¿™ç§å†…è”å±äºæ¿€è¿›ä¼˜åŒ–ï¼Œéœ€è¦ä½™ç•™ä¸€ä¸ªâ€œé€ƒç”Ÿé—¨â€ï¼Œç§°ä¸ºå®ˆæŠ¤å†…è”ï¼›å¦‚æœæŸ¥å‡ºæœ‰å¤šä¸ªç‰ˆæœ¬çš„ç›®æ ‡æ–¹æ³•å¯ä¾›é€‰æ‹©ï¼Œåˆ™ç¼–è¯‘å™¨è¿˜ä¼šä½¿ç”¨å†…è”ç¼“å­˜æ¥å®Œæˆæ–¹æ³•å†…è”ã€‚ é€ƒé€¸åˆ†æå®ƒä¹Ÿæ˜¯ä¸ºå…¶ä»–ä¼˜åŒ–æ‰‹æ®µæä¾›ä¾æ®çš„æŠ€æœ¯ï¼Œå®ƒçš„åŸºæœ¬è¡Œä¸ºå°±æ˜¯åˆ†æå¯¹è±¡åŠ¨æ€ä½œç”¨åŸŸï¼šå½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå®ƒå¯èƒ½è¢«å¤–éƒ¨æ–¹æ³•æ‰€å¼•ç”¨ï¼Œä¾‹å¦‚ä½œä¸ºè°ƒç”¨å‚æ•°ä¼ é€’åˆ°å…¶ä»–æ–¹æ³•ä¸­ï¼Œç§°ä¸ºæ–¹æ³•é€ƒé€¸ã€‚ç”šè‡³è¿˜æœ‰å¯èƒ½è¢«å¤–éƒ¨çº¿ç¨‹è®¿é—®åˆ°ï¼Œä¾‹å¦‚å¤åˆ¶ç»™ç±»å˜é‡æˆ–å¯ä»¥åœ¨å…¶ä»–çº¿ç¨‹ä¸­è®¿é—®çš„å®ä¾‹å˜é‡ï¼Œç§°ä¸ºçº¿ç¨‹é€ƒé€¸ã€‚ å¦‚æœèƒ½è¯æ˜ä¸€ä¸ªå¯¹è±¡ä¸ä¼šé€ƒé€¸åˆ°æ–¹æ³•æˆ–è€…çº¿ç¨‹ä¹‹å¤–ï¼Œåˆ™å¯èƒ½ä¸ºè¿™ä¸ªå˜é‡è¿›è¡Œä¸€äº›é«˜æ•ˆçš„ä¼˜åŒ–ï¼š æ ˆä¸Šåˆ†é…ï¼šè®©å¯¹è±¡ç›´æ¥åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œè¿™æ ·å¤§é‡å¯¹è±¡å°±ä¼šéšç€æ–¹æ³•çš„ç»“æŸè€Œè‡ªåŠ¨é”€æ¯äº†ï¼Œåƒåœ¾æ”¶é›†ç³»ç»Ÿçš„å‹åŠ›å°†ä¼šå°å¾ˆå¤šã€‚ åŒæ­¥æ¶ˆé™¤ï¼šå¯¹å˜é‡å®æ–½çš„åŒæ­¥æªæ–½å¯ä»¥æ¶ˆé™¤æ‰ æ ‡é‡æ›¿æ¢ï¼šä¸èƒ½å†åˆ†è§£çš„é‡ç§°ä¸ºæ ‡é‡ï¼ˆå¦‚ï¼šæ•°å€¼ç±»å‹ï¼‰ï¼Œå¯ä»¥ç»§ç»­åˆ†è§£çš„ç§°ä¸ºèšåˆé‡ï¼ˆå¦‚ï¼šå¯¹è±¡ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†å¯¹è±¡æ‹†åˆ†æˆæ ‡é‡å­˜åœ¨æ ˆä¸Šã€‚ æ€»ç»“é€šè¿‡å¯¹äºJITç¼–è¯‘çš„å­¦ä¹ ï¼Œæˆ‘ä¹ˆå¯ä»¥çŸ¥é“å“ªäº›ä»£ç ç¼–è¯‘å™¨æ˜¯å¯ä»¥å¸®æˆ‘ä»¬ä¼˜åŒ–çš„ï¼Œä»¥åŠå“ªäº›ä»£ç æ˜¯éœ€è¦è‡ªå·±è°ƒèŠ‚ä»¥ä¾¿æ›´åˆé€‚ç¼–è¯‘å™¨çš„ä¼˜åŒ–ã€‚è¿™æ ·æˆ‘ä»¬æ‰å¯ä»¥å†™å‡ºæ›´é«˜æ•ˆçš„ä»£ç ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_11_æ—©æœŸï¼ˆç¼–è¯‘æœŸï¼‰ä¼˜åŒ–]]></title>
    <url>%2F2017%2F12%2F10%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-11-%E6%97%A9%E6%9C%9F%EF%BC%88%E7%BC%96%E8%AF%91%E6%9C%9F%EF%BC%89%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¹‹å‰ç®€å•çš„æåˆ°è¿‡javaç¨‹åºçš„ä½¿ç”¨é¦–å…ˆè¦ç»è¿‡ç¼–è¯‘ï¼Œç„¶åå†â€œè§£é‡Šâ€æ‰§è¡Œï¼Œè¿™é‡Œæˆ‘ä»¬å°±å…ˆçœ‹çœ‹å®ƒåœ¨ç¼–è¯‘æœŸçš„è¿‡ç¨‹ã€‚ ç¼–è¯‘æ¦‚è¿°javaçš„ç¼–è¯‘æœŸå…¶å®æ˜¯ä¸€æ®µâ€œä¸ç¡®å®šâ€çš„æ“ä½œè¿‡ç¨‹ï¼Œå®ƒæœ‰ä¸€ä¸‹å‡ ç§å½¢å¼ï¼š å‰ç«¯ç¼–è¯‘å™¨ï¼šæŠŠ.javaæ–‡ä»¶è½¬å˜ä¸º.classæ–‡ä»¶çš„è¿‡ç¨‹ï¼Œå¦‚ï¼šSunçš„javacã€Eclipse JDTä¸­çš„å¢é‡å¼ç¼–è¯‘å™¨ã€‚ è™šæ‹Ÿæœºçš„åç«¯è¿è¡ŒæœŸç¼–è¯‘å™¨ï¼ˆJITç¼–è¯‘å™¨ï¼‰ï¼šæŠŠå­—èŠ‚ç è½¬å˜æˆæœºå™¨ç çš„è¿‡ç¨‹ï¼Œå¦‚HotSpotVMçš„C1ã€C2ç¼–è¯‘å™¨ã€‚ é™æ€æå‰ç¼–è¯‘å™¨ï¼ˆAOTç¼–è¯‘å™¨ï¼‰ï¼šç›´æ¥æŠŠ*.javaæ–‡æœ¬ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ä»£ç çš„è¿‡ç¨‹ï¼šGNU Compiler for the Javaã€Excelsior JETã€‚ æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„ç¼–è¯‘åŸºæœ¬ä¸Šéƒ½æ˜¯æŒ‡ç¬¬ä¸€ç±»ï¼Œå‰ç«¯ç¼–è¯‘å™¨ã€‚æ€»çš„æ¥è¯´ï¼ŒJavaä¸­çš„JITå³æ—¶ç¼–è¯‘å™¨åœ¨è¿è¡ŒæœŸçš„ä¼˜åŒ–å¯¹äºç¨‹åºè¿è¡Œæ¥è¯´æ›´é‡è¦ï¼Œè€Œå‰ç«¯ç¼–è¯‘å™¨åœ¨ç¼–è¯‘å™¨çš„ä¼˜åŒ–è¿‡ç¨‹å¯¹äºç¨‹åºç¼–ç æ¥è¯´å…³ç³»æ›´å¯†åˆ‡ï¼Œç›¸å½“å¤šæ–°ç”Ÿçš„Javaè¯­æ³•ç‰¹æ€§ï¼Œéƒ½æ˜¯é ç¼–è¯‘å™¨çš„â€œè¯­æ³•ç³–â€æ¥å®ç°çš„ã€‚ Javacç¼–è¯‘å™¨ç¼–è¯‘è¿‡ç¨‹å¤§è‡´åˆ†ä¸º3ä¸ªè¿‡ç¨‹ï¼š è§£æä¸å¡«å……ç¬¦å·è¡¨è¿‡ç¨‹ æ’å…¥å¼æ³¨è§£å¤„ç†å™¨çš„æ³¨è§£å¤„ç†è¿‡ç¨‹ åˆ†æä¸å­—èŠ‚ç ç”Ÿæˆè¿‡ç¨‹ è¿™3ä¸ªè¿‡ç¨‹ä¹‹é—´çš„å…³ç³»ä¸äº¤äº’é¡ºåºå¦‚ä¸‹å›¾ï¼š è§£æä¸å¡«å……ç¬¦å·è¡¨è¿‡ç¨‹å…¶ä¸­è§£ææ­¥éª¤åŒ…æ‹¬äº†ç»å…¸ç¨‹åºç¼–è¯‘åŸç†æ‰¾é‚£ä¸ªçš„è¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æä¸¤ä¸ªè¿‡ç¨‹ã€‚ è¯æ³•ã€è¯­æ³•åˆ†æ è¯æ³•åˆ†æï¼šå°†æºä»£ç çš„å­—ç¬¦æµè½¬å˜ä¸ºæ ‡è®°ï¼ˆTokenï¼‰é›†åˆï¼Œå•ä¸ªå­—ç¬¦æ˜¯ç¨‹åºç¼–å†™è¿‡ç¨‹çš„æœ€å°å…ƒç´ ï¼Œè€Œæ ‡è®°æ˜¯ç¼–è¯‘è¿‡ç¨‹çš„æœ€å°å…ƒç´ ï¼Œå…³é”®å­—ã€å˜é‡åã€å­—é¢é‡ã€è¿ç®—ç¬¦éƒ½å¯ä»¥æˆä¸ºæ ‡è®°ã€‚ è¯­æ³•åˆ†æï¼šæ ¹æ®Tokenåºåˆ—æ„é€ æŠ½è±¡è¯­æ³•æ ‘ï¼ŒæŠ½è±¡è¯­æ³•æ ‘æ˜¯ä¸€ç§ç”¨æ¥æè¿°ç¨‹åºä»£ç è¯­æ³•ç»“æ„çš„æ ‘å½¢è¡¨ç¤ºæ–¹å¼ï¼Œè¯­æ³•æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä»£è¡¨ç€ç¨‹åºä»£ç ä¸­çš„ä¸€ä¸ªè¯­æ³•ç»“æ„ï¼Œä¾‹å¦‚åŒ…ã€ç±»å‹ã€ä¿®é¥°ç¬¦ã€è¿ç®—ç¬¦ã€è¿ç®—ç¬¦ã€æ¥å£ã€è¿”å›å€¼ç”šè‡³ä»£ç æ³¨é‡Šéƒ½å¯ä»¥æ˜¯ä¸€ä¸ªè¯­æ³•ç»“æ„ã€‚å¦‚ä¸‹å›¾ï¼š ç»è¿‡ä¸Šé¢ä¸¤ä¸ªæ­¥éª¤ç¼–è¯‘å™¨å°±åŸºæœ¬ä¸ä¼šå†å¯¹æºæ–‡ä»¶è¿›è¡Œæ“ä½œäº†ã€‚ å¡«å……ç¬¦å·è¡¨ ç¬¦å·è¡¨æ˜¯ç”±ä¸€ç»„ç¬¦å·åœ°å€å’Œç¬¦å·ä¿¡æ¯æ„æˆçš„è¡¨æ ¼ï¼Œç±»ä¼¼k-vå½¢å¼ã€‚ç¬¦å·è¡¨ä¸­ç™»è®°çš„ä¿¡æ¯åœ¨ç¼–è¯‘çš„ä¸åŒé˜¶æ®µéƒ½è¦ç”¨åˆ°ã€‚åœ¨è¯­ä¹‰åˆ†æä¸­ï¼Œç¬¦å·è¡¨æ‰€ç™»è®°çš„å†…å®¹å°†ç”¨äºè¯­ä¹‰æ£€æŸ¥å’Œäº§ç”Ÿä¸­é—´ä»£ç ã€‚åœ¨ç›®æ ‡ä»£ç ç”Ÿæˆé˜¶æ®µï¼Œå½“å¯¹ç¬¦å·åè¿›è¡Œåœ°å€åˆ†é…æ—¶ï¼Œç¬¦å·è¡¨æ˜¯åœ°å€åˆ†é…çš„ä¾æ®ã€‚ åœ¨Javaæºä»£ç ä¸­ï¼Œå¡«ç©ºç¬¦å·è¡¨è¿‡ç¨‹çš„å‡ºå£æ˜¯ä¸€ä¸ªå¾…å¤„ç†åˆ—è¡¨ï¼ŒåŒ…å«äº†æ¯ä¸€ä¸ªç¼–è¯‘å•å…ƒçš„æŠ½è±¡è¯­æ³•æ•°çš„é¡¶çº§èŠ‚ç‚¹ï¼Œä»¥åŠpackage-info.javaï¼ˆå¦‚æœå­˜åœ¨ï¼‰çš„é¡¶çº§èŠ‚ç‚¹ã€‚ æ³¨è§£å¤„ç†å™¨JDK1.6ä¹‹ä¸­æä¾›äº†ä¸€ç»„æ’å…¥å¼æ³¨è§£å¤„ç†å™¨çš„æ ‡å‡†APIåœ¨ç¼–è¯‘æœŸé—´å¯¹æ³¨è§£è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥æŠŠå®ƒçœ‹åšæ˜¯ä¸€ç»„ç¼–è¯‘å™¨æ’ä»¶ï¼Œåœ¨è¿™äº›æ’ä»¶ä¸­ï¼Œå¯ä»¥è¯»å–ã€ä¿®æ”¹ã€æ·»åŠ æŠ½è±¡è¯­æ³•æ ‘ä¸­çš„ä»»æ„å…ƒç´ ã€‚è‹¥è¿™äº›æ’ä»¶åœ¨å¤„ç†æ³¨è§£æœŸé—´å¯¹è¯­æ³•æ ‘è¿›è¡Œäº†ä¿®æ”¹ï¼Œç¼–è¯‘å™¨å°†å›åˆ°è§£æåŠå¡«å……ç¬¦å·è¡¨çš„è¿‡ç¨‹é‡æ–°å¤„ç†ï¼Œç›´åˆ°æ‰€æœ‰æ’å…¥å¼æ³¨è§£å¤„ç†å™¨éƒ½æ²¡æœ‰å†å¯¹è¯­æ³•æ ‘è¿›è¡Œä¿®æ”¹ä¸ºæ­¢ï¼Œæ¯ä¸€æ¬¡å¾ªç¯ç§°ä¸ºä¸€ä¸ªRoundã€‚å¦‚ç¼–è¯‘è¿‡ç¨‹å›¾çš„å›ç¯è¿‡ç¨‹ã€‚ è¯­ä¹‰åˆ†æä¸å­—èŠ‚ç ç”Ÿæˆè¯­æ³•åˆ†æä¹‹åï¼Œç¼–è¯‘å™¨è·å¾—ç¨‹åºä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘è¡¨ç¤ºï¼Œè¯­æ³•æ ‘èƒ½è¡¨ç¤ºä¸€ä¸ªç»“æ„æ­£ç¡®çš„æºç¨‹åºçš„æŠ½è±¡ï¼Œä½†æ— æ³•ä¿è¯æºç¨‹åºæ˜¯ç¬¦åˆé€»è¾‘çš„ï¼Œè€Œè¯­ä¹‰åˆ†æçš„ä¸»è¦ä»»åŠ¡æ˜¯å¯¹ç»“æ„ä¸Šæ­£ç¡®åœ°æºç¨‹åºè¿›è¡Œä¸Šä¸‹æ–‡æœ‰å…³æ€§è´¨çš„å®¡æŸ¥ï¼Œå¦‚ç±»å‹å®¡æŸ¥ã€‚è¯­ä¹‰åˆ†æè¿‡ç¨‹åˆ†ä¸ºæ ‡æ³¨æ£€æŸ¥ä»¥åŠæ•°æ®åŠæ§åˆ¶æµåˆ†æä¸¤ä¸ªæ­¥éª¤ã€‚ æ ‡æ³¨æ£€æŸ¥æ ‡æ³¨æ£€æŸ¥æ­¥éª¤æ£€æŸ¥çš„å†…å®¹åŒ…æ‹¬è¯¸å¦‚å˜é‡ä½¿ç”¨å‰æ˜¯å¦å·²è¢«å£°æ˜ï¼Œå˜é‡ä¸èµ‹å€¼ä¹‹å‰çš„æ•°æ®ç±»å‹èƒ½å¦åŒ¹é…ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„åŠ¨ä½œæ˜¯å¸¸é‡æŠ˜å ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä»£ç å†™äº†å¦‚ä¸‹å®šä¹‰ï¼š1int a = 1 + 2; åœ¨ç»è¿‡å˜é‡æŠ˜å ä¹‹åï¼Œ1 + 2ä¼šè¢«æŠ˜å ä¸ºå­—é¢é‡3ã€‚æ‰€ä»¥åœ¨ä»£ç é‡Œå®šä¹‰int a = 1 + 2æ¯”èµ·ç›´æ¥å®šä¹‰int a = 3å¹¶ä¸ä¼šå¢åŠ ç¨‹åºè¿è¡ŒæœŸçš„è¿ç®—é‡ã€‚ æ•°æ®åŠæ§åˆ¶æµåˆ†ææ•°æ®åŠæ§åˆ¶æµåˆ†ææ˜¯å¯¹ç¨‹åºä¸Šä¸‹æ–‡é€»è¾‘æ›´è¿›ä¸€æ­¥çš„éªŒè¯ï¼Œå®ƒå¯ä»¥æ£€æŸ¥å‡ºè¯¸å¦‚ç¨‹åºå±€éƒ¨å˜é‡åœ¨ä½¿ç”¨å‰æ˜¯å¦æœ‰èµ‹å€¼ã€æ–¹æ³•çš„æ¯æ¡è·¯å¾„æ˜¯å¦éƒ½æœ‰è¿”å›å€¼ã€æ˜¯å¦æ‰€æœ‰çš„å—æ£€å¼‚å¸¸éƒ½è¢«æ­£ç¡®å¤„ç†äº†ç­‰é—®é¢˜ï¼Œç¼–è¯‘æœŸçš„æ•°æ®åŠæ§åˆ¶æµåˆ†æä¸ç±»åŠ è½½æ—¶çš„æ•°æ®åŠæ§åˆ¶æµåˆ†æçš„ç›®çš„åŸºæœ¬ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œä½†æ ¡éªŒèŒƒå›´æœ‰æ‰€åŒºåˆ«ï¼Œæœ‰ä¸€äº›æ ¡éªŒé¡¹åªæœ‰åœ¨ç¼–è¯‘æœŸæˆ–è€…è¿è¡ŒæœŸæ‰èƒ½è¿›è¡Œï¼Œå¦‚æ–¹æ³•çš„å‚æ•°ä»¥åŠå±€éƒ¨å˜é‡çš„æ£€æŸ¥å°±åªä¼šåœ¨ç¼–è¯‘å™¨æ£€æŸ¥ã€‚ è§£è¯­æ³•ç³– è¯­æ³•ç³–ï¼šæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€çš„åŠŸèƒ½å¹¶æ²¡æœ‰å½±å“ï¼Œå½“æ—¶æ›´æ–¹ä¾¿ä½¿ç”¨ï¼ŒJavaæœ€å¸¸ç”¨çš„è¯­æ³•ç³–ä¸»è¦æœ‰æ³›å‹ã€å˜é•¿å‚æ•°ã€è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ç­‰ è§£è¯­æ³•ç³–ï¼šè™šæ‹Ÿæœºè¿è¡Œæ—¶ä¸æ”¯æŒè¿™äº›è¯­æ³•ï¼Œä»–ä»¬ä¼šåœ¨ç¼–è¯‘é˜¶æ®µè¿˜åŸå›ç®€å•çš„åŸºç¡€è¯­æ³•ç»“æ„ã€‚ å­—èŠ‚ç ç”Ÿæˆå­—èŠ‚ç ç”Ÿæˆæ˜¯Javacç¼–è¯‘è¿‡ç¨‹çš„æœ€åä¸€ä¸ªé˜¶æ®µï¼Œæ­¤é˜¶æ®µç¼–è¯‘å™¨è¿˜è¿›è¡Œäº†å°‘é‡çš„ä»£ç æ·»åŠ å’Œè½¬æ¢å·¥ä½œã€‚å®ä¾‹æ„é€ å™¨()ï¼ˆä¸æ˜¯é»˜è®¤æ„é€ å‡½æ•°ï¼‰å’Œç±»æ„é€ å™¨()å°±æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µæ·»åŠ åˆ°è¯­æ³•æ ‘ä¸­çš„ã€‚å®Œæˆäº†å¯¹è¯­æ³•æ ‘çš„éå†å’Œè°ƒæ•´ä¹‹åï¼Œç”Ÿæˆæœ€ç»ˆçš„Classæ–‡ä»¶ã€‚ Javaè¯­æ³•ç³–çš„å‘³é“æ³›å‹ä¸ç±»å‹æ“¦é™¤ æœ¬è´¨ï¼šå‚æ•°åŒ–ç±»å‹çš„åº”ç”¨ï¼Œå°±æ˜¯æ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ï¼Œè¿™ç§å‚æ•°ç±»å‹å¯ä»¥ç”¨åœ¨ç±»ã€æ¥å£å’Œæ–¹æ³•ä¸Šï¼Œåˆ†åˆ«ç§°ä¸ºæ³›å‹ç±»ã€æ³›å‹æ¥å£å’Œæ³›å‹æ–¹æ³•ã€‚ æå‡ºåŸå› ï¼šå…ˆçœ‹ä¸‹é¢çš„ä»£ç  12Object object = new Object();String str = (String)object; ç”±äºç¼–è¯‘å™¨æ— æ³•æ£€æŸ¥è¿™ä¸ªObjectå¼ºåˆ¶è½¬æ¢èƒ½å¦æˆåŠŸï¼Œä¸ºäº†é˜²æ­¢ä¿éšœå¼ºåˆ¶ç±»å‹çš„è½¬æ¢æˆåŠŸï¼Œé¿å…ClassCaseExceptionçš„é£é™©è½¬å«åˆ°ç¨‹åºè¿è¡ŒæœŸä¹‹ä¸­ï¼Œæ‰€ä»¥æå‡ºäº†æ³›å‹ã€‚ çœŸå®æ³›å‹ï¼šå‚æ•°åŒ–ç±»å‹æ— è®ºåœ¨æºç ä¸­è¿˜æ˜¯ç¼–è¯‘åçš„ä¸­é—´è¯­è¨€éƒ½æ˜¯å­˜åœ¨çš„ã€‚ ä¼ªæ³›å‹ï¼šå‚æ•°åŒ–ç±»å‹åªåœ¨æºç ä¸­å­˜åœ¨ï¼Œè€Œåœ¨ä¸­é—´è¯­è¨€ä¸å­˜åœ¨ã€‚å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä¾‹å­ï¼š 123456789101112// æ³›å‹æ“¦é™¤çš„ä¾‹å­public class GenericTest &#123;public static void main(String[] args) &#123; Map&lt;String, String&gt; map = new HashMap&lt;&gt;(); map.put("hello", "æ‚¨å¥½"); map.put("how are you?", "æœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ"); System.out.println(map.get("hello")); System.out.println(map.get("how are you?")); &#125;&#125; åˆ©ç”¨Beyond Compareåç¼–è¯‘å¯ä»¥å¾—åˆ°ä¸‹é¢çš„ä»£ç : 123456789101112// åç¼–è¯‘åçš„ä»£ç public class GenericTest &#123;public static void main(String[] args) &#123; Map map = new HashMap&lt;&gt;(); map.put("hello", "æ‚¨å¥½"); map.put("how are you?", "æœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ"); System.out.println(map.get("hello")); System.out.println(map.get("how are you?")); &#125;&#125; æœ‰äººå¯èƒ½åƒæˆ‘ä¸€æ ·ï¼Œç”¨jdåç¼–è¯‘ï¼Œå‘ç°æ³›å‹æ²¡æœ‰è¢«æ“¦é™¤ï¼Œæˆ‘ä¸€å¼€å§‹å¾ˆæƒŠè®¶ï¼Œåæ¥æ‰¾äº†å‚è€ƒï¼Œå¤§å®¶å¯ä»¥ä»å‚è€ƒéƒ¨åˆ†çœ‹åˆ°è¯¥ç°è±¡çš„è§£é‡Šï¼Œè¿™é‡Œéœ€è¦è¯´æ˜ä¸€ç‚¹ï¼Œå°±æ˜¯ç”±äºJavaæ³›å‹çš„å¼•å…¥ï¼Œå„ç§åœºæ™¯ï¼ˆè™šæ‹Ÿæœºè§£æã€åå°„ç­‰ï¼‰ä¸‹çš„æ–¹æ³•è°ƒç”¨éƒ½å¯èƒ½å¯¹åŸæœ‰çš„åŸºç¡€äº§ç”Ÿå½±å“å’Œæ–°çš„éœ€æ±‚ï¼Œæ‰€ä»¥JCPï¼ˆJava Community Processï¼‰ç»„ç»‡å¯¹è™šæ‹Ÿæœºè§„èŒƒåšå‡ºäº†ç›¸åº”çš„ä¿®æ”¹ï¼Œå¼•å…¥äº†è¯¸å¦‚Signatureã€LocalVariabelTypeTableç­‰æ–°çš„å±æ€§ç”¨äºè§£å†³ä¼´éšæ³›å‹è€Œæ¥çš„å‚æ•°ç±»å‹è¯†åˆ«é—®é¢˜ï¼Œä»Signatureå±æ€§çš„å‡ºç°æˆ‘ä»¬è¿˜å¯ä»¥å¾—å‡ºç»“è®ºï¼šæ“¦é™¤æ³›å‹æ‰€è°“çš„æ“¦é™¤ï¼Œä»…ä»…æ˜¯å¯¹æ–¹æ³•çš„Codeå±æ€§ä¸­çš„å­—èŠ‚ç è¿›è¡Œåˆ é™¤ï¼Œå®é™…ä¸Šå…ƒæ•°æ®ä¸­è¿˜æ˜¯ä¿ç•™äº†æ³›å‹ä¿¡æ¯ã€‚ è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ä¸éå†å¾ªç¯æˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™äº›è¯­æ³•ç³–ï¼Œç¼–è¯‘çš„è¿‡ç¨‹ä¸­åšäº†ä»€ä¹ˆå¤„ç†ï¼š12345678910111213// æºä»£ç public class BoxProcessTest &#123; public static void main(String[] args) &#123; List&lt;Integer&gt; list = Arrays.asList(1,2,3,4); int sum = 0; for (int i : list) &#123; sum += i; &#125; System.out.println(sum); &#125;&#125; 12345678910111213141516// åç¼–è¯‘åçš„ä»£ç public class BoxProcessTest&#123; public static void main(String[] args) &#123; List list = Arrays.asList(new Integer[] &#123; Integer.valueOf(1), Integer.valueOf(2), Integer.valueOf(3), Integer.valueOf(4) &#125;); int sum = 0; for (Iterator localIterator = list.iterator(); localIterator.hasNext();) &#123; int i = ((Integer)localIterator.next()).intValue(); sum += i; &#125; System.out.println(sum); &#125;&#125; æˆ‘ä»¬æ¸…æ¥šçš„çœ‹åˆ°å…¶å®è¯­æ³•ç³–çš„æœ€åè¿˜æ˜¯ç”¨æœ€åŸºæœ¬çš„è¯­æ³•å®ç°çš„ï¼Œåªæ˜¯æ›´åˆ©äºæˆ‘ä»¬å†™ä»£ç äº†ã€‚ å†æ¥çœ‹çœ‹è‡ªåŠ¨è£…ç®±çš„é™·é˜±ï¼š1234567891011121314151617public class BoxTest &#123; public static void main(String[] args) &#123; Integer a = 1; Integer b = 2; Integer c = 3; Integer d = 3; Integer e = 321; Integer f = 321; Long g= 3L; System.out.println(c == d); //true System.out.println(e == f); //falseï¼Œå¦‚æœIntegeråœ¨-128åˆ°127ä¹‹é—´ä¼šä¿å­˜åˆ°å¸¸é‡æ± ï¼Œæ­¤æ—¶Integerç›´æ¥ç­‰äºæ•°å­— System.out.println(c == (a + b)); //true System.out.println(c.equals(a + b)); //true System.out.println(g == (a + b)); //true System.out.println(g.equals(a + b)); //false &#125;&#125; å¦‚æœä½ å¯¹ä¸Šé¢åˆ†ä¸æ¸…æ¥šçš„è¯ï¼ŒåŠ ä¸Šé‰´äºåŒ…è£…ç±»çš„â€œ==â€è¿ç®—åœ¨ä¸é‡åˆ°ç®—æœ¯è¿ç®—çš„æƒ…å†µä¸‹ä¸ä¼šè‡ªåŠ¨æ‹†ç®±ï¼Œä»¥åŠå®ƒä»¬çš„equals()æ–¹æ³•ä¸å¤„ç†æ•°æ®ç±»å‹è½¬å‹çš„å…³ç³»ï¼Œå»ºè®®åœ¨å®é™…ç¼–ç æ‰¾é‚£ä¸ªå°½é‡é¿å…è¿™æ ·ä½¿ç”¨è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±ã€‚ æ¡ä»¶ç¼–è¯‘Javaè¯­è¨€å®ç°æ¡ä»¶ç¼–è¯‘çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ¡ä»¶ä¸ºå¸¸é‡çš„ifè¯­å¥ï¼Œæ¡ˆä¾‹å¦‚ä¸‹ï¼š123456789101112// æºä»£ç public class ConditionCompilerTest &#123; public static void main(String[] args) &#123; if (true) &#123; System.out.println("block 1"); &#125; else &#123; System.out.println("block 2"); &#125; &#125;&#125; 123456789// åç¼–è¯‘ä»£ç public class ConditionCompilerTest&#123; public static void main(String[] args) &#123; System.out.println("block 1"); &#125;&#125; æˆ‘ä»¬å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ç¼–è¯‘åçš„ä»£ç å°±åªå‰©trueé‡Œé¢çš„ä»£ç å—äº†ï¼Œä»è€Œå®ç°äº†æ¡ä»¶ç¼–è¯‘ã€‚ æ€»ç»“é€šè¿‡ä¸Šé¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç¼–è¯‘å™¨çš„å±‚æ¬¡ä¸Šäº†è§£Javaæºä»£ç ç¼–è¯‘ä¸ºå­—èŠ‚ç çš„è¿‡ç¨‹ï¼Œä»¥åŠå„ç§è¯­æ³•ç³–çš„å‰å› åæœã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ æ—©æœŸï¼ˆç¼–è¯‘æœŸï¼‰ä¼˜åŒ– å…³äºjavaæ³›å‹æ“¦é™¤åç¼–è¯‘åæ³›å‹ä¼šå‡ºç°é—®é¢˜]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_10_è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“]]></title>
    <url>%2F2017%2F12%2F09%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-10-%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AD%97%E8%8A%82%E7%A0%81%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæˆ‘ä»¬çŸ¥é“æ–¹æ³•çš„ä»£ç çš„å­—èŠ‚ç æ˜¯æ”¾åœ¨æ–¹æ³•åŒºçš„Codeå±æ€§è¡¨é‡Œé¢ï¼Œä½†æ˜¯é‡Œé¢çš„å­—èŠ‚ç æ˜¯æ€ä¹ˆæ‰§è¡Œæˆ‘ä»¬å´ä¸çŸ¥é“ï¼Œè¿™é‡Œé€šè¿‡ç†è§£è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“å»çœ‹çœ‹è¿™äº›å­—èŠ‚ç æ˜¯æ€ä¹ˆèµ°çš„ï¼Ÿ æ¦‚è¿°ç‰©ç†æœºä¸è™šæ‹Ÿæœº ç‰©ç†æœºçš„æ‰§è¡Œå¼•æ“ï¼šç›´æ¥å»ºç«‹åœ¨å¤„ç†å™¨ã€ç¡¬ä»¶ã€æŒ‡ä»¤é›†ã€å’Œæ“ä½œç³»ç»Ÿå±‚é¢ä¸Šã€‚ è™šæ‹Ÿæœºçš„æ‰§è¡Œå¼•æ“ï¼šè‡ªå·±å®ç°ï¼Œå¯ä»¥è‡ªè¡Œåˆ¶å®šæŒ‡ä»¤é›†ä¸æ‰§è¡Œå¼•æ“çš„ç»“æ„ä½“ç³»ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰§è¡Œé‚£äº›ä¸è¢«ç¡¬ä»¶ç›´æ¥æ”¯æŒçš„æŒ‡ä»¤é›†æ ¼å¼ã€‚ è™šæ‹Ÿæœºæ€ä¹ˆæ‰§è¡Œä»£ç  è§£é‡Šæ‰§è¡Œï¼šé€šè¿‡è§£é‡Šå™¨æ‰§è¡Œ ç¼–è¯‘æ‰§è¡Œï¼šé€šè¿‡å³æ—¶ç¼–è¯‘å™¨äº§ç”Ÿæœ¬åœ°ä»£ç æ‰§è¡Œ è¿è¡Œæ—¶æ ˆå¸§ç»“æ„æ ˆå¸§æ˜¯ç”¨äºæ”¯æŒè™šæ‹Ÿæœºè¿›è¡Œæ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œçš„æ•°æ®ç»“æ„ï¼Œä»–æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºä¸­çš„è™šæ‹Ÿæœºæ ˆçš„æ ˆå…ƒç´ ï¼Œæ ˆå¸§å­˜å‚¨äº†æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥å’Œæ–¹æ³•è¿”å›åœ°å€ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨å¼€å§‹è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œéƒ½å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆé‡Œé¢ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚ ä¸€ä¸ªçº¿ç¨‹çš„æ–¹æ³•çš„è°ƒç”¨é“¾å¯èƒ½ä¼šå¾ˆé•¿ï¼Œå¾ˆå¤šæ–¹æ³•åŒæ—¶å¤„äºæ‰§è¡ŒçŠ¶æ€ã€‚å¯¹äºæ‰§è¡Œå¼•æ“æ¥è¯´ï¼Œåœ¨æ´»åŠ¨çº¿ç¨‹ä¸­ï¼Œåªæœ‰ä½äºæ ˆé¡¶çš„æ ˆå¸§æ‰æ˜¯æœ‰æ•ˆçš„ï¼Œç§°ä¸ºå½“å‰æ ˆå¸§ï¼Œä¸è¿™ä¸ªæ ˆå¸§ç›¸å…³è”çš„æ–¹æ³•ç§°ä¸ºå½“å‰æ–¹æ³•ï¼Œæ‰§è¡Œå¼•æ“è¿è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤éƒ½åªé’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œï¼Œåœ¨æ¦‚å¿µæ¨¡å‹ä¸Šï¼Œå…¸å‹çš„æ ˆå¸§ç»“æ„å¦‚ä¸‹å›¾ï¼š æ¥ä¸‹æ¥å…·ä½“è§£é‡Šä¸€ä¸‹æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ä»¥åŠæ–¹æ³•è°ƒç”¨ã€‚ å±€éƒ¨å˜é‡è¡¨ å±€éƒ¨å˜é‡è¡¨ç¤ºä¸€ç»„å˜é‡å€¼å­˜å‚¨ç©ºé—´ï¼Œç”¨äºå­˜æ”¾æ–¹æ³•å’Œæ–¹æ³•å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡ã€‚ å±€éƒ¨å˜é‡è¡¨çš„å®¹é‡ä»¥å˜é‡æ§½Slotä¸ºå•ä½ã€‚è™šæ‹Ÿæœºè§„èŒƒè¯´æ¯ä¸ªSlotéƒ½åº”è¯¥å­˜æ”¾ä¸€ä¸ªbooleanã€byteã€charã€intã€floatã€referenceæˆ–returnAddressç±»å‹çš„æ•°æ®ã€‚longå’Œdoubleä½¿ç”¨ä¸¤ä¸ªSlotã€‚ referenceç±»å‹åœ¨è™šæ‹Ÿæœºä¸­è‡³å°‘è¦å®ç°èƒ½ä»è¯¥å¼•ç”¨ä¸­ç›´æ¥æˆ–é—´æ¥åœ°æŸ¥æ‰¾åˆ°å¯¹è±¡åœ¨Javaå †ä¸­çš„æ•°æ®å­˜æ”¾çš„èµ·å§‹åœ°å€ç´¢å¼•ä»¥åŠä»è¯¥å¼•ç”¨ç›´æ¥æˆ–è€…é—´æ¥æŸ¥æ‰¾åˆ°å¯¹è±¡æ‰€å±æ•°æ®ç±»å‹åœ¨æ–¹æ³•åŒºä¸­å­˜å‚¨çš„ç±»å‹ä¿¡æ¯ã€‚ è™šæ‹Ÿæœºé€šè¿‡ç´¢å¼•å®šä½çš„æ–¹å¼ä½¿ç”¨å±€éƒ¨å˜é‡è¡¨ï¼Œå¦‚æœæ‰§è¡Œçš„å®ä¾‹æ–¹æ³•ï¼Œé‚£å±€éƒ¨å˜é‡è¡¨ä¸­ç¬¬0ä½ç´¢å¼•çš„Sloté»˜è®¤æ˜¯ç”¨äºä¼ é€’æ–¹æ³•æ‰€å±å¯¹è±¡å®ä¾‹çš„å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨â€œthisâ€æ¥è®¿é—®ï¼Œå…¶ä½™å‚æ•°æŒ‰ç…§å‚æ•°è¡¨é¡ºåºæ’åˆ—ã€‚ å±€éƒ¨å˜é‡è¡¨ä¸­çš„Slotæ˜¯å¯ä»¥é‡ç”¨çš„ï¼Œå½“æŸä¸ªå˜é‡é™¤äº†å®ƒçš„ä½œç”¨åŸŸï¼Œé‚£è¿™ä¸ªå˜é‡æ‰€å¯¹åº”çš„Slotå°±å¯ä»¥å¤ç”¨äº†ï¼ŒSlotçš„å¤ç”¨ä¼šç›´æ¥å½±å“åˆ°ç³»ç»Ÿçš„åƒåœ¾æ”¶é›†è¡Œä¸ºï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š 123456789101112// ä¾‹1// VM args : -verbose:gcpublic class StackFrameTest &#123; public static void main(String[] args) &#123; byte[] placeholder = new byte[64 * 1024 * 1024]; System.gc(); &#125;&#125; è¾“å‡ºç»“æœï¼š 12[GC (System.gc()) 68209K-&gt;66072K(125952K), 0.0019584 secs][Full GC (System.gc()) 66072K-&gt;65962K(125952K), 0.0069900 secs] 123456789101112// ä¾‹2// VM args : -verbose:gcpublic class StackFrameTest &#123; public static void main(String[] args) &#123; &#123; byte[] placeholder = new byte[64 * 1024 * 1024]; &#125; System.gc(); &#125;&#125; è¾“å‡ºç»“æœ 12[GC (System.gc()) 68875K-&gt;66072K(125952K), 0.0010138 secs][Full GC (System.gc()) 66072K-&gt;65962K(125952K), 0.0069811 secs] 12345678910111213// ä¾‹3// VM args : -verbose:gcpublic class StackFrameTest &#123; public static void main(String[] args) &#123; &#123; byte[] placeholder = new byte[64 * 1024 * 1024]; &#125; int a = 0; System.gc(); &#125;&#125; è¾“å‡ºç»“æœ 12[GC (System.gc()) 68875K-&gt;66072K(125952K), 0.0016694 secs][Full GC (System.gc()) 66072K-&gt;426K(125952K), 0.0054452 secs] placeholdeèƒ½å¦è¢«å›æ”¶çš„æ ¹æœ¬åŸå› æ˜¯ï¼šå±€éƒ¨å˜é‡çš„Slotæ˜¯å¦è¿˜å­˜æœ‰å…³äºplaceholderæ•°ç»„å¯¹è±¡çš„å¼•ç”¨ã€‚ä¾‹1æ²¡æœ‰åƒåœ¾å›æ”¶ï¼Œä¾‹2ä»£ç è™½ç„¶å·²ç»ç¦»å¼€äº†placeholderçš„ä½œç”¨åŸŸï¼Œä½†æ˜¯ä¹‹åæ²¡æœ‰ä»»ä½•å¯¹å±€éƒ¨å˜é‡è¡¨çš„è¯»å†™æ“ä½œï¼Œæ‰€æœ‰placeholderåŸæ¥çš„Slotè¿˜æ²¡æœ‰è¢«å…¶ä»–å˜é‡å¤ç”¨ï¼Œæ‰€ä»¥GC Rootsä¸€éƒ¨åˆ†çš„å±€éƒ¨å˜é‡è¡¨ä»ç„¶ä¿æŒç€å¯¹å®ƒçš„å…³è”ï¼Œå½“ä¾‹3ä¿®æ”¹äº†å±€éƒ¨å˜é‡è¡¨ï¼Œé‚£ä¹ˆå°±ä¼šè¿›è¡Œåƒåœ¾å›æ”¶äº†ã€‚ è¿™é‡Œè§£é‡Šä¸€ä¸ªç¼–ç å»ºè®®ï¼šä¸ä½¿ç”¨çš„å¯¹è±¡åº”æ‰‹åŠ¨èµ‹å€¼null æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š 123456789101112// ä¾‹1// VM args : -verbose:gcpublic class StackFrameTest &#123; public static void main(String[] args) &#123; byte[] placeholder = new byte[64 * 1024 * 1024]; placeholder = null; System.gc(); &#125;&#125; è¾“å‡ºç»“æœï¼š 12[GC (System.gc()) 68875K-&gt;66072K(125952K), 0.0016915 secs][Full GC (System.gc()) 66072K-&gt;426K(125952K), 0.0058140 secs] æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“placeholderèµ‹å€¼ä¸ºnullï¼Œä¼šå‘ç”Ÿåƒåœ¾å›æ”¶ã€‚ å±€éƒ¨å˜é‡è¡¨æ²¡æœ‰èµ‹åˆå§‹å€¼ä¸èƒ½ä½¿ç”¨ã€‚ æ“ä½œæ•°æ ˆ æ“ä½œæ•°æ ˆå¸¸è¢«ç§°ä¸ºæ“ä½œæ ˆï¼Œä¸€ä¸ªæ–¹æ³•åˆšå¼€å§‹æ‰§è¡Œçš„æ—¶å€™æ˜¯ç©ºçš„ï¼Œåœ¨æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å„ç§å­—èŠ‚ç æŒ‡ä»¤å¾€æ“ä½œæ•°æ ˆä¸­å†™å…¥å’Œæå–å†…å®¹ï¼Œä¾‹å¦‚ï¼Œåœ¨åšç®—æœ¯è¿ç®—çš„æ—¶å€™æ˜¯é€šè¿‡æ“ä½œæ•°æ ˆæ¥ è¿›è¡Œçš„ï¼Œåˆæˆ–è€…æ˜¯åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™é€šè¿‡æ“ä½œæ•°æ ˆæ¥è¿›è¡Œå‚æ•°ä¼ é€’çš„ã€‚ åœ¨æ¦‚å¿µæ¨¡å‹ä¸­ï¼Œä¸¤ä¸ªæ ˆå¸§æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œä½†åœ¨å¤§å¤šè™šæ‹Ÿæœºçš„å®ç°é‡Œä¼šåšä¸€äº›ä¼˜åŒ–å¤„ç†ï¼Œä»¤ä¸¤ä¸ªæ ˆå¸§çš„éƒ¨åˆ†æ“ä½œæ•°å‡ºç°ä¸€éƒ¨åˆ†é‡å ï¼Œé¿å…æ–¹æ³•è°ƒç”¨æ—¶é¢å¤–çš„å‚æ•°å¤åˆ¶ï¼Œå¦‚ä¸‹å›¾ï¼š Javaè™šæ‹Ÿæœºçš„è§£é‡Šæ‰§è¡Œå¼•æ“ç§°ä¸ºâ€œåŸºäºæ ˆçš„æ‰§è¡Œå¼•æ“â€ï¼Œå…¶ä¸­çš„æ ˆå°±æ˜¯æ“ä½œæ•°æ ˆã€‚ åŠ¨æ€é“¾æ¥ æ¯ä¸ªæ ˆå¸§éƒ½åŒ…å«ä¸€ä¸ªæ‰§è¡Œè¿è¡Œæ—¶å¸¸é‡æ± ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨ï¼ŒæŒæœ‰è¿™ä¸ªå¼•ç”¨å°±æ˜¯ä¸ºäº†æ”¯æŒæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­çš„åŠ¨æ€é“¾æ¥ã€‚ Classæ–‡ä»¶çš„å¸¸é‡æ± å­˜æœ‰å¤§é‡çš„ç¬¦å·å¼•ç”¨ï¼Œä¸€éƒ¨åˆ†æ˜¯åœ¨ç±»åŠ è½½ä¸­çš„è§£æé˜¶æ®µå®Œæˆçš„ï¼Œç§°ä¸ºé™æ€è§£æï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯åœ¨æ¯ä¸€æ¬¡è¿è¡ŒæœŸé—´è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ï¼Œç§°ä¸ºåŠ¨æ€é“¾æ¥ã€‚ æ–¹æ³•è¿”å›åœ°å€å½“ä¸€ä¸ªæ–¹æ³•å¼€å§‹æ‰§è¡Œåï¼Œåªæœ‰ä¸¤ç§æ–¹å¼é€€å‡ºè¿™ä¸ªæ–¹æ³•ã€‚ æ­£å¸¸å®Œæˆå‡ºå£ï¼šæ‰§è¡Œå¼•æ“é‡åˆ°ä¸€ä¸ªæ–¹æ³•è¿”å›çš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œè°ƒç”¨è€…çš„PCè®¡æ•°å™¨çš„å€¼å¯ä»¥ä½œä¸ºè¿”å›åœ°å€ å¼‚å¸¸å®Œæˆå‡ºå£ï¼šåœ¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°å¼‚å¸¸ï¼Œå¹¶ä¸”è¿™ä¸ªå¼‚å¸¸æ²¡æœ‰åœ¨æ–¹æ³•ä½“å¾—åˆ°å¤„ç†ï¼Œå®ƒä¸ä¼šç»™è°ƒç”¨è€…äº§ç”Ÿä»»ä½•è¿”å›å€¼ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯è¦é€šè¿‡å¼‚å¸¸å¤„ç†å™¨è¡¨æ¥ç¡®å®šçš„ã€‚ æ–¹æ³•è°ƒç”¨æ–¹æ³•è°ƒç”¨ä¸ç­‰åŒäºæ–¹æ³•æ‰§è¡Œï¼Œæ–¹æ³•è°ƒç”¨é˜¶æ®µå”¯ä¸€çš„ä»»åŠ¡å°±æ˜¯ç¡®å®šè¢«è°ƒç”¨æ–¹æ³•çš„ç‰ˆæœ¬ã€‚Classæ–‡ä»¶çš„ç¼–è¯‘è¿‡ç¨‹ä¸åŒ…å«ä¼ ç»Ÿç¼–è¯‘æ‰¾é‚£ä¸ªçš„é“¾æ¥æ­¥éª¤ï¼Œæ‰€ä»¥Javaæ–¹æ³•è°ƒç”¨è¿‡ç¨‹éœ€è¦åœ¨ç±»åŠ è½½æœŸé—´ï¼Œç”šè‡³åˆ°è¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šç›®æ ‡æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ã€‚ è§£æè§£æï¼š æ–¹æ³•åœ¨ç¨‹åºçœŸæ­£è¿è¡Œä¹‹å‰å°±æœ‰ä¸€ä¸ªå¯ç¡®å®šçš„è°ƒç”¨ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨åœ¨è¿è¡ŒæœŸæ˜¯ä¸å¯å˜çš„ï¼Œè¿™ç±»æ–¹æ³•çš„è°ƒç”¨æˆä¸ºè§£æã€‚ æ‰€æœ‰æ–¹æ³•å¯ä»¥åˆ†ä¸ºä¸¤ç±»è™šæ–¹æ³•å’Œéè™šæ–¹æ³•ï¼Œå…¶ä¸­éè™šæ–¹æ³•éƒ½å¯ä»¥åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±ä¼šæŠŠç¬¦å·å¼•ç”¨è§£æä¸ºè¯¥æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ã€‚ éè™šæ–¹æ³•ï¼šé™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€å®ä¾‹æ„é€ å™¨ã€çˆ¶ç±»æ–¹æ³•å’Œfinalæ–¹æ³• è™šæ–¹æ³•ï¼šä¸éè™šæ–¹æ³•ç›¸å è§£æè°ƒç”¨ä¸€å®šæ˜¯ä¸ªé™æ€çš„è¿‡ç¨‹ï¼Œåœ¨ç¼–è¯‘å™¨å°±å®Œå…¨ç¡®å®šï¼Œåœ¨ç±»è£…è½½çš„è§£æé˜¶æ®µå°±ä¼šæŠŠæ¶‰åŠçš„ç¬¦å·å¼•ç”¨å…¨éƒ¨è½¬å˜ä¸ºå¯ç¡®å®šçš„ç›´æ¥å¼•ç”¨ï¼Œä¸ä¼šå»¶è¿Ÿåˆ°è¿è¡ŒæœŸå†å»å®Œæˆã€‚è€Œåˆ†æ´¾è°ƒç”¨åˆ™å¯èƒ½æ˜¯é™æ€ä¹Ÿå¯èƒ½æ˜¯åŠ¨æ€çš„ï¼Œæ ¹æ®åˆ†æ´¾çš„å®—æ•°é‡ï¼ˆæ–¹æ³•çš„æ¥æ”¶è€…ä¸æ–¹æ³•çš„å‚æ•°ç»Ÿç§°ä¸ºæ–¹æ³•çš„æ€»é‡ï¼‰å¯åˆ†ä¸ºå•åˆ†æ´¾å’Œå¤šåˆ†æ´¾ï¼Œè¿™ä¸¤ç§åˆ†æ´¾æ–¹å¼åœ°ç»„åˆå¯åˆ†ä¸ºé™æ€å•åˆ†æ´¾ã€é™æ€å¤šåˆ†æ´¾ã€åŠ¨æ€å•åˆ†æ´¾ã€åŠ¨æ€å¤šåˆ†æ´¾ã€‚ åˆ†æ´¾é™æ€åˆ†æ´¾1Human man = new Man(); ä¸Šé¢ä»£ç ä¸­Humanç§°ä¸ºå˜é‡çš„é™æ€ç±»å‹ï¼Œæˆ–è€…å«åšå¤–è§‚ç±»å‹ï¼Œåé¢çš„Manç§°ä¸ºå®é™…ç±»å‹ï¼Œé™æ€ç±»å‹æ˜¯ç¼–è¯‘å™¨å¯çŸ¥ï¼Œå®é™…ç±»å‹æ˜¯è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šçš„ã€‚è™šæ‹Ÿæœºåœ¨é‡è½½æ—¶æ˜¯é€šè¿‡å‚æ•°çš„é™æ€ç±»å‹è€Œä¸æ˜¯å®é™…ç±»å‹æ¥ä½œä¸ºåˆ¤æ–­ä¾æ®çš„ã€‚ æ‰€æœ‰ä¾èµ–é™æ€ç±»å‹æ¥å®šä½æ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„åˆ†æ´¾åŠ¨ä½œç§°ä¸ºé™æ€åˆ†æ´¾ï¼Œé™æ€åˆ†æ´¾çš„å…¸å‹åº”ç”¨æ˜¯æ–¹æ³•é‡è½½ã€‚é™æ€åˆ†æ´¾å‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µï¼Œå› æ­¤ç¡®å®šé™æ€åˆ†æ´¾çš„åŠ¨ä½œå®é™…ä¸Šä¸æ˜¯ç”±è™šæ‹Ÿæœºæ¥æ‰§è¡Œçš„ï¼Œå¦å¤–ï¼Œç¼–è¯‘å™¨è™½ç„¶èƒ½ç¡®å®šå‡ºæ–¹æ³•çš„é‡è½½ç‰ˆæœ¬ï¼Œå½“åœ¨å¾ˆå¤šæƒ…å†µä¸‹è¿™ä¸ªé‡è½½ç‰ˆæœ¬ä¸æ˜¯â€œå”¯ä¸€çš„â€ï¼Œå¾€å¾€åªèƒ½ç¡®å®šä¸€ä¸ªâ€œæ›´åŠ åˆé€‚çš„â€ç‰ˆæœ¬ï¼Œå…·ä½“ä¾‹å­å¯ä»¥çœ‹çœ‹ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ã€‚ åŠ¨æ€åˆ†æ´¾åœ¨è¿è¡ŒæœŸæ ¹æ®å®é™…ç±»å‹ç¡®å®šæ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„åˆ†æ´¾è¿‡ç¨‹ç§°ä¸ºåŠ¨æ€åˆ†æ´¾ï¼Œå…¸å‹åº”ç”¨æ˜¯æ–¹æ³•é‡å†™ã€‚å®ƒä¸»è¦æ˜¯é€šè¿‡invokevirturlæŒ‡ä»¤æ¥å®ç°çš„ã€‚invokevirtualæŒ‡ä»¤çš„è¿è¡Œæ—¶è§£æè¿‡ç¨‹å¤§è‡´åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š æ‰¾åˆ°æ“ä½œæ•°æ ˆé¡¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè®°ä½œCã€‚ å¦‚æœåœ¨ç±»å‹Cä¸­æ‰¾åˆ°ä¸å¸¸é‡ä¸­çš„æè¿°ç¬¦åˆç®€å•åç§°éƒ½ç›¸ç¬¦çš„æ–¹æ³•ï¼Œåˆ™è¿›è¡Œè®¿é—®æƒé™æ ¡éªŒï¼Œå¦‚æœé€šè¿‡åˆ™è¿”å›è¿™ä¸ªæ–¹æ³•çš„ç›´æ¥å¼•ç”¨ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹ç»“æŸï¼›å¦‚æœä¸é€šè¿‡ï¼Œåˆ™è¿”å›java.lang.IllegalAccessErrorå¼‚å¸¸ã€‚ å¦åˆ™ï¼ŒæŒ‰ç…§ç»§æ‰¿å…³ç³»ä»ä¸‹å¾€ä¸Šä¾æ¬¡å¯¹Cçš„å„ä¸ªçˆ¶ç±»è¿›è¡Œç¬¬2æ­¥çš„æœç´¢å’ŒéªŒè¯è¿‡ç¨‹ã€‚ å¦‚æœå§‹ç»ˆæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ–¹æ³•ï¼Œåˆ™æŠ›å‡ºjava.lang.AbstractMethodErrorå¼‚å¸¸ã€‚ å•åˆ†æ´¾å’Œå¤šåˆ†æ´¾å•åˆ†æ´¾æ˜¯æ ¹æ®ä¸€ä¸ªå®—é‡å¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œé€‰æ‹©ï¼Œå¤šåˆ†æ´¾åˆ™æ˜¯æ ¹æ®ä¸€ä¸ªå®—é‡å¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œé€‰æ‹©ã€‚æˆ‘ä»¬ç»“åˆä¸‹é¢çš„ä»£ç æ¥ç†è§£ï¼š12345678910111213141516171819202122232425262728293031323334public class Dispatch &#123; static class QQ &#123;&#125; static class _360 &#123;&#125; public static class Father &#123; public void hardChoice(QQ arg) &#123; System.out.println("father choose qq"); &#125; public void hardChoice(_360 arg) &#123; System.out.println("father choose _360"); &#125; &#125; public static class Son extends Father &#123; public void hardChoice(QQ arg) &#123; System.out.println("son choose qq"); &#125; public void hardChoice(_360 arg) &#123; System.out.println("son choose _360"); &#125; &#125; public static void main(String[] args) &#123; Father father = new Father(); Father son = new Son(); father.hardChoice(new _360()); son.hardChoice(new QQ()); &#125;&#125; è¾“å‡ºç»“æœï¼š12father choose _360son choose qq ç¼–è¯‘é˜¶æ®µç¼–è¯‘å™¨çš„é€‰æ‹©è¿‡ç¨‹ï¼ˆé™æ€åˆ†æ´¾è¿‡ç¨‹ï¼‰ï¼šè¿™æ—¶é€‰æ‹©ç›®æ ‡æ–¹æ³•çš„ä¾æ®æœ‰ä¸¤ç‚¹ï¼šä¸€æ˜¯é™æ€ç±»å‹æ˜¯Fatherè¿˜æ˜¯Sonï¼ŒäºŒæ˜¯æ–¹æ³•å‚æ•°æ˜¯QQè¿˜æ˜¯360ã€‚å› ä¸ºæ˜¯æ ¹æ®ä¸¤ä¸ªå®—é‡è¿›è¡Œé€‰æ‹©ï¼Œæ‰€æœ‰Javaè¯­è¨€çš„é™æ€åˆ†æ´¾å±äºå¤šåˆ†æ´¾ç±»å‹ã€‚ è¿è¡Œé˜¶æ®µè™šæ‹Ÿæœºçš„é€‰æ‹©è¿‡ç¨‹ï¼ˆåŠ¨æ€åˆ†æ´¾è¿‡ç¨‹ï¼‰ï¼šç”±äºç¼–è¯‘å™¨å·²ç»å·²ç»å†³å®šç›®æ ‡æ–¹æ³•çš„ç­¾åå¿…é¡»ä¸ºhardChoice(QQ)ï¼Œæ‰€ä»¥è¿™æ—¶å‚æ•°çš„é™æ€ç±»å‹ï¼Œå®é™…ç±»å‹éƒ½å¯¹æ–¹æ³•çš„é€‰æ‹©ä¸ä¼šæ„æˆå½±å“ï¼Œå”¯ä¸€å¯ä»¥å½±å“è™šæ‹Ÿæœºé€‰æ‹©çš„å› ç´ åªæœ‰æ­¤æ–¹æ³•çš„æ¥å—è€…çš„å®é™…ç±»å‹æ˜¯Fatherè¿˜æ˜¯Son,å› ä¸ºåªæœ‰ä¸€ä¸ªå®—é‡ä½œä¸ºé€‰æ‹©ä¾æ®ï¼Œæ‰€ä»¥Javaè¯­è¨€çš„åŠ¨æ€åˆ†æ´¾å±äºå•åˆ†æ´¾ç±»å‹ã€‚ jdk1.8ä¹‹å‰çš„Javaè¯­è¨€æ˜¯ä¸€é—¨é™æ€å¤šåˆ†æ´¾ï¼ŒåŠ¨æ€å•åˆ†æ´¾çš„è¯­è¨€ã€‚ è™šæ‹ŸæœºåŠ¨æ€åˆ†æ´¾çš„å®ç°ç”±äºåŠ¨æ€åˆ†æ´¾æ˜¯éå¸¸é¢‘ç¹çš„æ“ä½œï¼Œè€Œä¸”åŠ¨æ€åˆ†æ´¾çš„æ–¹æ³•ç‰ˆæœ¬é€‰æ‹©è¿‡ç¨‹éœ€è¦è¿è¡Œæ—¶åœ¨ç±»çš„æ–¹æ³•å…ƒæ•°æ®ä¸­æœç´¢åˆé€‚çš„ç›®æ ‡æ–¹æ³•ï¼Œå› æ­¤è™šæ‹Ÿæœºä¼šè¿›è¡Œä¼˜åŒ–ã€‚å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯ä¸ºç±»åœ¨æ–¹æ³•åŒºä¸­å»ºç«‹ä¸€ä¸ªè™šæ–¹æ³•è¡¨ï¼ˆVirtual Method Tableï¼Œåœ¨invokeinterfaceæ‰§è¡Œæ—¶ä¹Ÿä¼šç”¨åˆ°æ¥å£æ–¹æ³•è¡¨ï¼ŒInterface Method Tableï¼‰ï¼Œä½¿ç”¨è™šæ–¹æ³•è¡¨ç´¢å¼•æ¥æ›¿ä»£å…ƒæ•°æ®æŸ¥æ‰¾ä»¥æå‡æ€§èƒ½ã€‚ä¸‹å›¾å°±æ˜¯å‰é¢ä»£ç çš„è™šæ–¹æ³•è¡¨ç»“æ„ï¼š è™šæ–¹æ³•è¡¨ä¸­å­˜æ”¾ç€å„ä¸ªæ–¹æ³•çš„å®é™…å…¥å£åœ°å€ã€‚å¦‚æœæŸä¸ªæ–¹æ³•åœ¨å­ç±»ä¸­æ²¡æœ‰è¢«é‡å†™ï¼Œé‚£å­ç±»çš„è™šæ–¹æ³•è¡¨é‡Œé¢çš„åœ°å€å…¥å£å’Œçˆ¶ç±»ç›¸åŒæ–¹æ³•çš„åœ°å€å…¥å£æ˜¯ä¸€è‡´çš„ï¼Œéƒ½æŒ‡å‘çˆ¶ç±»çš„å®ç°å…¥å£ã€‚å¦‚æœå­ç±»é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œå­ç±»æ–¹æ³•è¡¨ä¸­çš„åœ°å€ä¼šæ›¿æ¢ä¸ºæŒ‡å‘å­ç±»å®ç°ç‰ˆæœ¬çš„å…¥å£åœ°å€ã€‚åœ¨ä¸Šå›¾ä¸­ï¼ŒSoné‡å†™äº†Fatherçš„å…¨éƒ¨æ–¹æ³•ï¼Œæ‰€ä»¥Sonçš„æ–¹æ³•è¡¨æ›¿æ¢äº†çˆ¶ç±»çš„åœ°å€ã€‚ä½†æ˜¯Sonå’ŒFatheréƒ½æ²¡æœ‰é‡å†™Objectçš„æ–¹æ³•ï¼Œæ‰€ä»¥æ–¹æ³•è¡¨éƒ½æŒ‡å‘äº†Objectçš„æ•°æ®ç±»å‹ã€‚ä¸ºäº†ç¨‹åºå®ç°ä¸Šçš„æ–¹ä¾¿ï¼Œå…·æœ‰ç›¸åŒç­¾åçš„æ–¹æ³•ï¼Œåœ¨çˆ¶ç±»å’Œå­ç±»çš„è™šæ–¹æ³•è¡¨ä¸­éƒ½åº”è¯¥å…·æœ‰ä¸€æ ·çš„ç´¢å¼•å·ï¼Œè¿™æ ·å½“ç±»å‹å˜æ¢æ—¶ï¼Œä»…ä»…éœ€è¦å˜æ›´æŸ¥æ‰¾çš„æ–¹æ³•è¡¨ï¼Œå°±å¯ä»¥ä»ä¸åŒçš„è™šæ–¹æ³•è¡¨ä¸­æŒ‰ç´¢å¼•è½¬æ¢å‡ºæ‰€éœ€çš„å…¥å£åœ°å€ã€‚æ–¹æ³•è¡¨ä¸€èˆ¬åœ¨ç±»åŠ è½½çš„è¿æ¥é˜¶æ®µè¿›è¡Œåˆå§‹åŒ–ï¼Œå‡†å¤‡äº†ç±»çš„å˜é‡åˆå§‹å€¼åï¼Œè™šæ‹Ÿæœºä¼šæŠŠè¯¥ç±»çš„æ–¹æ³•è¡¨ä¹Ÿåˆå§‹åŒ–å®Œæ¯•ã€‚ åŠ¨æ€ç±»å‹è¯­è¨€æ”¯æŒåŠ¨æ€ç±»å‹è¯­è¨€çš„å…³é”®ç‰¹å¾æ˜¯å®ƒçš„ç±»å‹æ£€æŸ¥çš„ä¸»ä½“è¿‡ç¨‹æ˜¯åœ¨è¿è¡ŒæœŸé—´è€Œä¸æ˜¯ç¼–è¯‘æœŸé—´ï¼Œå¯ä»¥ç†è§£ä¸ºå˜é‡æ— ç±»å‹è€Œå˜é‡å€¼æ‰æœ‰ç±»å‹ï¼ŒJavascriptå°±æ˜¯è¿™æ ·çš„è¯­è¨€ï¼Œè€Œç›®å‰Javaå±äºé™æ€ç±»å‹è¯­è¨€ã€‚å½“ç„¶Javaä¹Ÿæœ‰å®ƒå®ç°åŠ¨æ€æ€§çš„æ–¹æ³•ï¼Œè¿™å—çŸ¥è¯†ç‚¹è›®å¤§ï¼Œå°±ä¸å±•å¼€è¯´äº†ã€‚ åŸºäºæ ˆçš„å­—èŠ‚ç è§£é‡Šæ‰§è¡Œå¼•æ“è§£é‡Šæ‰§è¡Œå…ˆçœ‹çœ‹ç¼–è¯‘è¿‡ç¨‹æµå›¾ï¼š ä¸Šå›¾æœ€ä¸‹é¢çš„é‚£ä¸€æ¡å°±æ˜¯ä¼ ç»Ÿç¼–è¯‘åŸç†ä¸­ç¨‹åºä»£ç åˆ°ç›®æ ‡æœºå™¨ä»£ç ç”Ÿæˆè¿‡ç¨‹ï¼ˆCï¼‰ ä¸Šå›¾ä¸­é—´é‚£ä¸€æ¡å°±æ˜¯è§£é‡Šæ‰§è¡Œçš„è¿‡ç¨‹ï¼ˆJavaï¼‰ åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›† åŸºäºæ ˆçš„æŒ‡ä»¤é›†ï¼šæŒ‡ä»¤æµä¸­çš„å¤§éƒ¨åˆ†éƒ½æ˜¯é›¶åœ°å€æŒ‡ä»¤ï¼ˆæ— æ˜¾ç¤ºå‚æ•°ï¼‰ï¼Œä»–ä»¬ä¾èµ–æ“ä½œæ•°æ ˆè¿›è¡Œå·¥ä½œã€‚ ä¼˜ç‚¹ï¼šå¯ç§»æ¤æ€§ï¼Œä»£ç ç´§å‡‘ï¼Œç¼–è¯‘å™¨å®ç°ç®€å• ç¼ºç‚¹ï¼šæ‰§è¡Œé€Ÿåº¦ç¨æ…¢ï¼ˆé¢‘ç¹è®¿é—®å†…å­˜ï¼‰ åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†ï¼šæŒ‡ä»¤é›†ä¾èµ–å¯„å­˜å™¨è¿›è¡Œå·¥ä½œ åŸºäºæ ˆçš„è§£é‡Šå™¨æ‰§è¡Œæµç¨‹å…¶å®å°±æ˜¯æŒ‰ç…§æŒ‡ä»¤è§£é‡Šæ‰§è¡Œï¼Œéšä¾¿çœ‹äº†ä¾‹å­åº”è¯¥å°±èƒ½æ˜ç™½ã€‚ æ€»ç»“å…¶å®è¿™é‡Œè°ˆçš„ä¸»è¦è¿˜æ˜¯è§£é‡Šæ‰§è¡Œï¼Œå…¶ä¸­æœ‰ä¸€ç‚¹å¾ˆé‡è¦å°±æ˜¯åˆ†æ´¾çš„æ¦‚å¿µï¼Œæ˜ç™½invokevirtualæŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_9_ç±»åŠ è½½å™¨]]></title>
    <url>%2F2017%2F12%2F06%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-9-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¹‹å‰ä¸€ç›´åœ¨è¯´ç±»åŠ è½½ï¼Œç±»åŠ è½½å°±éœ€è¦ç±»åŠ è½½å™¨ï¼Œç±»åŠ è½½æœ€åˆæ˜¯ä¸ºäº†æ»¡è¶³Java Appletï¼Œç°åœ¨åŸºæœ¬å·²ç»æ­»æ‰äº†ï¼Œä½†æ˜¯ç±»åŠ è½½å´åœ¨ç±»å±‚æ¬¡åˆ’åˆ†ã€OSGiã€çƒ­éƒ¨ç½²ã€ä»£ç åŠ å¯†ç­‰é¢†åŸŸå¤§æ”¾å¼‚å½©ï¼Œæˆä¸ºJavaä½“ç³»ä¸­ä¸€å—é‡è¦çš„åŸºçŸ³ï¼Œå¯è°“å¤±ä¹‹æ¡‘æ¦†ï¼Œæ”¶ä¹‹ä¸œéš…ã€‚ ä»€ä¹ˆæ˜¯ç±»åŠ è½½å™¨ï¼Ÿè™šæ‹Ÿæœºè®¾è®¡å›¢é˜ŸæŠŠç±»åŠ è½½é˜¶æ®µçš„â€œé€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµâ€è¿™ä¸ªåŠ¨ä½œæ”¾åˆ°Javaè™šæ‹Ÿæœºå¤–éƒ¨å»å®ç°ï¼Œä»¥ä¾¿è®©åº”ç”¨ç¨‹åºè‡ªå·±å»å†³å®šå¦‚ä½•å»è·å–æ‰€éœ€è¦çš„ç±»ï¼Œå®ç°è¿™ä¸ªåŠ¨ä½œçš„ä»£ç æ¨¡å—ç§°ä¸ºâ€œç±»åŠ è½½å™¨â€ã€‚ åŒä¸€ä¸ªClassæ–‡ä»¶ï¼Œä¸åŒçš„ç±»å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½éœ€è¦ç”±åŠ è½½å®ƒçš„ç±»åŠ è½½å™¨å’Œè¿™ä¸ªç±»æœ¬èº«ä¸€åŒç¡®ç«‹å…¶åœ¨Javaè™šæ‹Ÿæœºä¸­çš„å”¯ä¸€æ€§ï¼Œæ¯ä¸€ä¸ªç±»åŠ è½½å™¨ï¼Œéƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»åç§°ç©ºé—´ã€‚æ¢ä¸ªè¯´æ³•ï¼šæ¯”è¾ƒä¸¤ä¸ªç±»æ˜¯å¦â€œç›¸ç­‰â€ï¼Œåªæ˜¯åœ¨è¿™ä¸¤ä¸ªç±»æ˜¯ç”±åŒä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½çš„å‰æä¸‹æ‰æœ‰æ„ä¹‰ï¼Œå¦‚æœè¿™ä¸¤ä¸ªç±»æºäºåŒä¸€ä¸ªClassæ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½ä»–ä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£è¿™ä¸¤ä¸ªç±»å°±å¿…å®šä¸ç›¸ç­‰ã€‚ è¿™é‡Œçš„ç›¸ç­‰åŒ…æ‹¬ï¼šä»£è¡¨ç±»çš„Classå¯¹è±¡çš„equals()æ–¹æ³•ã€isAssignableFrom()æ–¹æ³•ã€isInstance()æ–¹æ³•è¿”å›ç»“æœï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†ä¸åŒçš„ç±»åŠ è½½å™¨å¯¹instanceofå…³é”®å­—è¿ç®—çš„ç»“æœçš„å½±å“ã€‚(ä¸‹é¢çš„ä»£ç å±äºç ´ååŒäº²å§”æ´¾æ¨¡å‹ï¼Œåªæ˜¯ä¸ºäº†éªŒè¯ç±»çš„å‘½åç©ºé—´)1234567891011121314151617181920212223242526272829303132public class ClassLoaderTest &#123; public static void main(String[] args) throws Exception &#123; ClassLoader myLoader = new ClassLoader() &#123; @Override public Class&lt;?&gt; loadClass(String name) throws ClassNotFoundException &#123; try &#123; String fileName = name.substring(name.lastIndexOf(".") + 1) + ".class"; InputStream is = getClass().getResourceAsStream(fileName); if (is == null) &#123; return super.loadClass(name); &#125; byte[] b = new byte[is.available()]; is.read(b); return defineClass(name,b,0,b.length); &#125; catch (IOException e) &#123; throw new ClassNotFoundException(name); &#125; &#125; &#125;; Object obj = myLoader.loadClass("com.todorex.demo.ClassLoaderTest").newInstance(); System.out.println(obj.getClass()); System.out.println(obj instanceof com.todorex.demo.ClassLoaderTest ); &#125;&#125; è¿è¡Œç»“æœï¼š12class com.todorex.demo.ClassLoaderTestfalse è¿™é‡Œçš„falseå°±è¯æ˜äº†ä¸¤ä¸ªç±»è™½ç„¶æ¥è‡ªäºåŒä¸€ä¸ªClassæ–‡ä»¶ï¼Œä½†æ˜¯ç”±äºä½¿ç”¨çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œå°±ä¾ç„¶æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„ç±»ã€‚ åŒäº²å§”æ´¾æ¨¡å‹ç±»åŠ è½½å™¨çš„ç±»å‹Javaè™šæ‹Ÿæœºè§’åº¦ å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå®ƒæœ¬èº«æ˜¯ç”±C++è¯­è¨€å®ç°ï¼Œæˆ–è€…åº•å±‚çš„å…³é”®æ–¹æ³•æ˜¯ç”¨Cå®ç°çš„ã€‚ æ‰€æœ‰å…¶ä»–ç±»åŠ è½½å™¨ï¼Œè¿™äº›ç±»åŠ è½½å™¨éƒ½ç”±Javaè¯­è¨€å®ç°ã€‚ Javaå¼€å‘äººå‘˜è§’åº¦ å¯åŠ¨ç±»åŠ è½½å™¨ï¼šè¿™ä¸ªç±»åŠ è½½å™¨è´Ÿè´£å°†å­˜æ”¾åœ¨\libç›®å½•ä¸­çš„ï¼Œæˆ–è€…è¢«-Xbootclasspathå‚æ•°æ‰€æŒ‡å®šçš„è·¯å¾„æ‰¾é‚£ä¸ªçš„ï¼Œå¹¶ä¸”æ˜¯è™šæ‹Ÿæœºè¯†åˆ«çš„ï¼ˆæŒ‰ç…§æ–‡ä»¶åè¯†åˆ«çš„ï¼‰ç±»åº“åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­ã€‚å¯åŠ¨ç±»åŠ è½½å™¨æ— æ³•è¢«Javaç¨‹åºç›´æ¥ä½¿ç”¨ï¼Œç”¨æˆ·åœ¨ç¼–å†™è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ—¶ï¼Œå¦‚æœéœ€è¦æŠŠåŠ è½½è¯·æ±‚å§”æ´¾ç»™å¼•å¯¼ç±»åŠ è½½å™¨ï¼Œç›´æ¥ä½¿ç”¨nullå³å¯ã€‚ï¼ˆä¸çŸ¥é“æ€ä¹ˆç”¨ï¼ŒçŸ¥é“çš„å¤§ä½¬è¯·å‘ŠçŸ¥ï¼ï¼ï¼ï¼ï¼‰ æ‰©å±•ç±»åŠ è½½å™¨ï¼šè¿™ä¸ªåŠ è½½å™¨ç”±sun.misc.Launcher$ExtClassLoaderå®ç°ï¼Œå®ƒè´Ÿè´£åŠ è½½\lib\extç›®å½•ä¸­çš„ï¼Œæˆ–è€…è¢«java.ext.dirsç³»ç»Ÿå˜é‡æ‰€æŒ‡å®šçš„è·¯å¾„ä¸­çš„æ‰€æœ‰ç±»åº“ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨æ‰©å±•ç±»åŠ è½½å™¨ã€‚ åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼šè¿™ä¸ªç±»åŠ è½½å™¨ç”±sun.misc.Launcher$AppClassLoaderå®ç°ï¼Œä¹Ÿç§°ç³»ç»Ÿç±»åŠ è½½å™¨ã€‚å®ƒè´Ÿè´£åŠ è½½ç”¨æˆ·æ‰€æŒ‡å®šçš„ç±»è·¯å¾„java -classpathæˆ–-Djava.class.pathçš„æ‰€æœ‰ç±»ï¼Œå¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªç±»åŠ è½½å™¨ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰è‡ªå®šä¹‰è¿‡è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªå°±æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ã€‚ ç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å‹æ¨¡å‹å›¾ åŒäº²å§”æ´¾æ¨¡å‹è¦æ±‚é™¤äº†é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨å¤–ï¼Œå…¶ä½™çš„ç±»åŠ è½½å™¨éƒ½åº”å½“æœ‰è‡ªå·±çš„çˆ¶ç±»åŠ è½½å™¨ã€‚è¿™é‡Œçš„ç±»åŠ è½½å™¨ä¹‹é—´çš„çˆ¶å­å…³ç³»ä¸€èˆ¬ä¸ä¼šä»¥ç»§æ‰¿çš„å…³ç³»æ¥å®ç°ï¼Œè€Œæ˜¯éƒ½ä½¿ç”¨ç»„åˆå…³ç³»æ¥å¤ç”¨çˆ¶åŠ è½½å™¨çš„ä»£ç ã€‚ï¼ˆç»„åˆå°±æ˜¯åœ¨ä¸€ä¸ªç±»ä¸­è°ƒç”¨å¦ä¸€ä¸ªç±»çš„ä»£ç ï¼‰ å·¥ä½œè¿‡ç¨‹æˆ‘ç›¸ä¿¡è¿™å¼ å›¾æœ€æ¸…æ¥šäº†ï¼š æˆ‘ä»¬å¯ä»¥ç”±å›¾çœ‹åˆ°ä»¥ä¸‹è¿‡ç¨‹ï¼š è‡ªåº•å‘ä¸Šæ£€æŸ¥ç±»æ˜¯å¦å·²ç»åŠ è½½ï¼Œè‹¥å·²åŠ è½½ï¼Œç›´æ¥è¿”å›ã€‚ è‹¥æ‰€æœ‰çˆ¶ç±»éƒ½æ²¡æœ‰åŠ è½½è¯¥ç±»ï¼Œåˆ™è‡ªé¡¶å‘ä¸‹å°è¯•åŠ è½½è¯¥ç±»ã€‚ å¦‚æœåŠ è½½ä¸æˆåŠŸï¼Œåˆ™æŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ã€‚ æˆ‘ä»¬å¯ä»¥ä»ä»£ç çœ‹çœ‹ä»–æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ å…ˆçœ‹ClassLoaderå‡½æ•°çš„loadClasså‡½æ•°1234567891011121314151617181920212223242526272829303132333435363738protected Class&lt;?&gt; loadClass(String name, boolean resolve) throws ClassNotFoundException &#123; synchronized (getClassLoadingLock(name)) &#123; // å…ˆä»ç¼“å­˜æŸ¥æ‰¾è¯¥classå¯¹è±¡ï¼Œæ‰¾åˆ°å°±ä¸ç”¨é‡æ–°åŠ è½½ Class&lt;?&gt; c = findLoadedClass(name); if (c == null) &#123; long t0 = System.nanoTime(); try &#123; if (parent != null) &#123; //å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™å§”æ‰˜ç»™çˆ¶ç±»åŠ è½½å™¨å»åŠ è½½ c = parent.loadClass(name, false); &#125; else &#123; //å¦‚æœæ²¡æœ‰çˆ¶ç±»ï¼Œåˆ™å§”æ‰˜ç»™å¯åŠ¨åŠ è½½å™¨å»åŠ è½½ c = findBootstrapClassOrNull(name); &#125; &#125; catch (ClassNotFoundException e) &#123; // ClassNotFoundException thrown if class not found // from the non-null parent class loader &#125; if (c == null) &#123; // If still not found, then invoke findClass in order // å¦‚æœéƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™é€šè¿‡è‡ªå®šä¹‰å®ç°çš„findClasså»æŸ¥æ‰¾å¹¶åŠ è½½ c = findClass(name); // this is the defining class loader; record the stats sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0); sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1); sun.misc.PerfCounter.getFindClasses().increment(); &#125; &#125; if (resolve) &#123;//æ˜¯å¦éœ€è¦åœ¨åŠ è½½æ—¶è¿›è¡Œè§£æ resolveClass(c); &#125; return c; &#125; &#125; ä»è¯¥å‡½æ•°æˆ‘ä»¬å¯ä»¥å¾—çŸ¥åŒäº²å§”æ´¾æ¨¡å‹ä¼šå…ˆé€’å½’å»æŸ¥æ‰¾çˆ¶åŠ è½½å™¨æ˜¯å¦å·²ç»åŠ è½½è¿‡è¯¥ç±»äº†ã€‚å¦‚æœçˆ¶åŠ è½½å™¨éƒ½æ²¡æœ‰åŠ è½½è¿‡è¯¥ç±»ï¼Œåˆ™å¼€å§‹è°ƒç”¨fandClass()å°è¯•å»åŠ è½½è¯¥ç±»ã€‚ç”±äºå¯åŠ¨ç±»åŠ è½½å™¨ä¸å¯çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥å»çœ‹çœ‹æ‰©å±•ç±»åŠ è½½å™¨çš„findClass()ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç±»å›¾ï¼š æˆ‘æ¥ç€æˆ‘æƒ³å»çœ‹çœ‹ExtClassLoaderç±»é‡Œé¢çš„findClass()æ–¹æ³•ï¼Œç»“æœå‘ç°æ²¡æœ‰ï¼Œåªè¦å»ä»–çš„çˆ¶ç±»URLClassLoaderå»æ‰¾æ‰¾ï¼Œè¿˜å¥½æ‰¾åˆ°äº†ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š123456789101112131415161718192021222324252627282930protected Class&lt;?&gt; findClass(final String name) throws ClassNotFoundException&#123; final Class&lt;?&gt; result; try &#123; result = AccessController.doPrivileged( new PrivilegedExceptionAction&lt;Class&lt;?&gt;&gt;() &#123; public Class&lt;?&gt; run() throws ClassNotFoundException &#123; String path = name.replace('.', '/').concat(".class"); Resource res = ucp.getResource(path, false); if (res != null) &#123; try &#123; //defineClass()æ–¹æ³•æ˜¯ç”¨æ¥å°†byteå­—èŠ‚æµè§£ææˆJVMèƒ½å¤Ÿè¯†åˆ«çš„Classå¯¹è±¡ return defineClass(name, res); &#125; catch (IOException e) &#123; throw new ClassNotFoundException(name, e); &#125; &#125; else &#123; return null; &#125; &#125; &#125;, acc); &#125; catch (java.security.PrivilegedActionException pae) &#123; throw (ClassNotFoundException) pae.getException(); &#125; if (result == null) &#123; throw new ClassNotFoundException(name); &#125; return result;&#125; å…¶å®AppClassLoaderçš„findClass()ä¹Ÿæ˜¯ç»§æ‰¿è‡ªURLCLassLoaderï¼Œæ‰€ä»¥éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å†ç»“åˆæœ€å¼€å§‹çš„loadClass()å°±å¯ä»¥å¾ˆå¥½çš„ç†è§£äº†ä¸Šé¢åŒäº²å§”æ´¾æ¨¡å‹çš„å·¥ä½œæµç¨‹äº†ã€‚ å¥½å¤„javaéšç€å®ƒçš„ç±»åŠ è½½ä¸€èµ·å…·å¤‡äº†ä¸€ç§å¸¦æœ‰ä¼˜å…ˆçº§çš„å±‚æ¬¡å…³ç³»ï¼Œå®ƒèƒ½ä¿è¯ä¸€ä¸ªç±»åœ¨ç¨‹åºä¸­å„ç§ç±»åŠ è½½å™¨ç¯å¢ƒä¸­éƒ½æ˜¯åŒä¸€ä¸ªç±»ã€‚ åŒäº²å§”æ´¾æ¨¡å‹çš„â€œåŒäº²â€åœ¨Javaè™šæ‹Ÿæœºè‹±æ–‡æ–‡ç« é‡ŒåŒäº²å§”æ´¾æ¨¡å‹çš„è‹±æ–‡æ˜¯Parent-Delegation Modelï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸­æ–‡ç¿»è¯‘ä¼šç§°ä»–ä¸ºåŒäº²å§”æ´¾æ¨¡å‹ï¼Œå¯èƒ½æ˜¯ä»–ä¸€èˆ¬éƒ½ä¼šæ‰¾åˆ°ä¸€ä¸ªçˆ¸çˆ¸å»å§”æ‰˜å»å¤„ç†å§ã€‚ ç ´ååŒäº²å§”æ´¾æ¨¡å‹ç›®å‰ä¸ºæ­¢ï¼ŒåŒäº²å§”æ´¾æ¨¡å‹ä¸»è¦å‡ºç°è¿‡3æ¬¡è¾ƒå¤§çš„â€œè¢«ç ´åâ€çš„æƒ…å†µã€‚ åœ¨JDK1.2ä¹‹å‰ï¼Œæ–°å»ºåŠ è½½å™¨éƒ½æ˜¯é€šè¿‡é‡å†™loadClass()æ–¹æ³•æ¥åŒºåˆ†ä¸åŒçš„åŠ è½½å™¨,ä»¥åŠä¿®æ”¹åŠ è½½é€»è¾‘ï¼Œè¿™æ ·å°±ç ´åäº†åŒäº²å§”æ´¾æ¨¡å‹çš„å‘ä¸Šå¯»æ‰¾çˆ¶åŠ è½½å™¨å»åŠ è½½çš„è§„èŒƒï¼Œåœ¨JDK1.2ä¹‹åä¸ºäº†å‘å‰å…¼å®¹ï¼ŒClassLoaderæ·»åŠ äº†æ–°çš„protectæ–¹æ³•findCLass()æ–¹æ³•ï¼Œä»è€Œå®ç°äº†åœ¨åŒäº²å§”æ´¾æ¨¡å‹ä¸Šå®ç°åŠ è½½é€»è¾‘çš„ä¿®æ”¹ã€‚ çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼Œå¦‚JNDIæœåŠ¡(æ²¡ç”¨è¿‡) å®ç°åŠ¨æ€æ€§ï¼Œå¦‚OSGi(æ²¡ç”¨è¿‡) æ€»ç»“æœ‰æ—¶å€™åˆ†æä¸œè¥¿æŸ¥çœ‹æºç æ˜¯å¿…è¦çš„ï¼Œè¿˜è¦åˆ©ç”¨ä¸€äº›å·¥å…·å»åˆ†æä»–ä»¬çš„ç»§æ‰¿å…³ç³»ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ æ·±å…¥ç†è§£Javaç±»åŠ è½½å™¨(ClassLoader) æ·±å…¥ç†è§£Javaç±»åŠ è½½å™¨(ä¸€)ï¼šJavaç±»åŠ è½½åŸç†è§£æ]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_8_è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶]]></title>
    <url>%2F2017%2F12%2F02%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-8-%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨Classæ–‡ä»¶ä¸­æè¿°çš„å„ç§ä¿¡æ¯æœ€ç»ˆéƒ½éœ€è¦åŠ è½½åˆ°è™šæ‹Ÿæœºä¹‹ä¸­ä¹‹åæ‰èƒ½è¿è¡Œå’Œä½¿ç”¨ã€‚è€Œè™šæ‹Ÿæœºå¦‚ä½•åŠ è½½è¿™äº›Classæ–‡ä»¶ï¼ŸClassæ–‡ä»¶ä¸­çš„ä¿¡æ¯è¿›å…¥åˆ°è™šæ‹Ÿæœºåä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿ æ¦‚è¿°è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶ï¼šè™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä»Classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è½¬æ¢è§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„Javaç±»å‹ã€‚ C/C++å’ŒJavaé“¾æ¥çš„ä¸åŒï¼š C/C++ï¼šåœ¨ç¼–è¯‘æ—¶å®Œæˆé“¾æ¥å·¥ä½œï¼›é™ä½äº†è¿è¡Œæ—¶çš„æ€§èƒ½å¼€é”€ï¼Œä½†æ˜¯ä¹Ÿé™ä½äº†è¿è¡Œæ—¶çš„çµæ´»æ€§ã€‚ Javaï¼šç±»å‹çš„åŠ è½½ã€é“¾æ¥å’Œåˆå§‹åŒ–è¿‡ç¨‹éƒ½æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å®Œæˆçš„ï¼›å¢åŠ äº†è¿è¡Œæ—¶çš„æ€§èƒ½å¼€é”€ï¼Œä½†æ˜¯å¢å¼ºäº†è¿è¡Œæ—¶çš„çµæ´»æ€§ï¼Œä½¿Javaå˜æˆäº†å¯ä»¥åŠ¨æ€æ‰©å±•çš„è¯­è¨€ã€‚è¿™é‡Œçš„åŠ¨æ€æ‰©å±•å¯ä»¥åˆ†ä¸ºä¸¤ç‚¹ï¼š åŠ¨æ€åŠ è½½ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡Javaé¢„å®šä¹‰çš„æˆ–è€…è‡ªå®šä¹‰çš„ç±»åŠ è½½ï¼Œè®©ä¸€ä¸ªæœ¬åœ°çš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨è¿è¡Œæ—¶åœ¨ä»ç½‘ç»œæˆ–å…¶ä»–åœ°æ–¹åŠ è½½ä¸€ä¸ªäºŒè¿›åˆ¶æµä½œä¸ºç¨‹åºä»£ç çš„ä¸€éƒ¨åˆ†ã€‚ åŠ¨æ€é“¾æ¥ï¼šå¦‚æœç¼–å†™ä¸€ä¸ªé¢å‘æ¥å£çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ç­‰åˆ°è¿è¡Œæ—¶å†æŒ‡å®šå…¶å®é™…çš„å®ç°ç±»ã€‚ ç±»åŠ è½½çš„æ—¶æœºç±»çš„ç”Ÿå‘½å‘¨æœŸç±»ä»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­å¼€å§‹ï¼Œåˆ°å¸è½½å‡ºå†…å­˜ä¸ºæ­¢ï¼Œå®ƒçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ï¼š å…¶ä¸­é“¾æ¥åŒ…æ‹¬ä¸‹é¢ä¸‰ä¸ªéƒ¨åˆ†ï¼š ç”Ÿå‘½å‘¨æœŸä¸­åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€åˆå§‹åŒ–å’Œå¸è½½è¿™5ä¸ªé˜¶æ®µé¡ºåºæ˜¯ç¡®å®šçš„ï¼Œä½†æ˜¯åˆæ˜¯å¯ä»¥äº’ç›¸äº¤å‰æ··åˆå¼è¿›è¡Œçš„ã€‚ ç±»çš„åˆå§‹åŒ–æ—¶æœºä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¼€å§‹ç±»åŠ è½½è¿‡ç¨‹çš„ç¬¬ä¸€é˜¶æ®µï¼šåŠ è½½ï¼ŸJavaè™šæ‹Ÿæœºè§„èŒƒæ²¡æœ‰è¿›è¡Œå¼ºåˆ¶çº¦æŸï¼Œä½†æ˜¯å¯¹åˆå§‹åŒ–é˜¶æ®µï¼Œè™šæ‹Ÿæœºè§„èŒƒåˆ™æ˜¯ä¸¥æ ¼è§„å®šäº†æœ‰ä¸”åªæœ‰5ç§æƒ…å†µå¿…é¡»ç«‹å³å¯¹ç±»â€œåˆå§‹åŒ–â€ã€‚ é‡åˆ°newã€getstaticã€putstaticæˆ–è€…invokestaticè¿™4æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦è§¦å‘å…¶åˆå§‹åŒ–ï¼Œç”Ÿæˆè¿™4æ¡æŒ‡ä»¤çš„æœ€å¸¸è§çš„Javaä»£ç åœºæ™¯æ˜¯ï¼šä½¿ç”¨newå…³é”®å­—å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ï¼Œè¯»å–æˆ–è®¾ç½®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µï¼ˆè¢«finalä¿®é¥°å¹¶ä¸”å·²åœ¨ç¼–è¯‘å™¨æŠŠç»“æœæ”¾åœ¨å¸¸é‡æ± çš„é™æ€å­—æ®µé™¤å¤–ï¼‰çš„æ—¶å€™ï¼Œä»¥åŠè°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚ ä½¿ç”¨java.lang.reflectåŒ…çš„æ—¶å€™å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦è§¦å‘å…¶åˆå§‹åŒ–ã€‚ å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚ å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦åˆ¶å®šä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±»ï¼ˆåŒ…å«mainæ–¹æ³•çš„é‚£ä¸ªç±»ï¼‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªç±»ã€‚ å¦‚æœä¸€ä¸ªjava.lang.invoke.MethodHandleå®ä¾‹è§£æç»“æœæ˜¯REF_getStaic,REF_putStatic,REF_invokeStaticçš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªå¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚ï¼ˆè¿˜æ²¡ç”¨è¿‡ï¼‰ ä¸Šé¢5ç§åœºæ™¯ä¸­çš„è¡Œä¸ºæˆä¸ºå¯¹ä¸€ä¸ªç±»çš„ä¸»åŠ¨å¼•ç”¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæ‰€æœ‰åº”ç”¨ç±»çš„æ–¹å¼éƒ½ä¸ä¼šè§¦å‘åˆå§‹åŒ–ï¼Œæˆä¸ºè¢«åŠ¨å¼•ç”¨ã€‚ä¸‹é¢æ˜¯å‡ ä¸ªè¢«åŠ¨å¼•ç”¨çš„åœºæ™¯ï¼š é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–ã€‚ é€šè¿‡æ•°ç»„æ¥å®šä¹‰å¼•ç”¨ç±»ï¼Œä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–ã€‚ å¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰ç›´æ¥å¼•ç”¨åˆ°å®šä¹‰å¸¸é‡çš„ç±»ï¼Œä¸ä¼šè§¦å‘è¯¥ç±»çš„åˆå§‹åŒ–ï¼Œå› ä¸ºåœ¨ç¼–è¯‘é˜¶æ®µé€šè¿‡å¸¸é‡ä¼ æ’­ä¼˜åŒ–ï¼Œå·²ç»å°†å…¶ä»–ç±»çš„å¸¸é‡å­˜å…¥åˆ°è°ƒç”¨ç±»çš„å¸¸é‡æ± äº†ã€‚ è¯´ä¸€ç‚¹æ¥å£ä¸ç±»åˆå§‹åŒ–ä¸–æ—¶æœºçš„ä¸åŒï¼šåœ¨æœ‰ä¸”åªæœ‰çš„5æ¡ä¸­çš„ç¬¬3æ¡,å½“ä¸€ä¸ªç±»åœ¨åˆå§‹åŒ–æ—¶ï¼Œè¦æ±‚å…¶çˆ¶ç±»å…¨éƒ¨éƒ½å·²ç»åˆå§‹åŒ–è¿‡äº†ï¼Œä½†æ˜¯æ¥å£åœ¨åˆå§‹åŒ–æ—¶ï¼Œä¸è¦æ±‚å…¶çˆ¶æ¥å£å…¨éƒ¨éƒ½å®Œæˆäº†åˆå§‹åŒ–ï¼Œåªæœ‰çœŸæ­£ä½¿ç”¨åˆ°çˆ¶æ¥å£çš„æ—¶å€™ï¼ˆå¦‚å¼•ç”¨æ¥å£ä¸­å®šä¹‰çš„å¸¸é‡ï¼‰æ‰ä¼šåˆå§‹åŒ–ã€‚ ç±»åŠ è½½çš„è¿‡ç¨‹Javaè™šæ‹Ÿæœºä¸­ç±»åŠ è½½çš„å…¨è¿‡ç¨‹ä¸ºï¼š åŠ è½½è™šæ‹Ÿæœºåœ¨åŠ è½½é˜¶æ®µè¦å¹²ä»€ä¹ˆ é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ å°†è¿™ä¸ªç±»çš„å­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚ äºŒè¿›åˆ¶å­—èŠ‚æµçš„æ¥æº ä»ZIPåŒ…ä¸­è¯»å–ï¼Œæœ€ç»ˆæˆä¸ºäº†æ—¥åJARã€EARã€WARæ ¼å¼çš„åŸºç¡€ã€‚ ä»ç½‘ç»œä¸­è·å–ï¼Œè¿™ä¸ªåœºæ™¯æœ€å…¸å‹çš„åº”ç”¨å°±æ˜¯Appletï¼ˆæ²¡ç”¨è¿‡ï¼‰ã€‚ è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆï¼Œè¿™ä¸ªåœºæ™¯ä½¿ç”¨çš„æœ€å¤šçš„å°±æ˜¯åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œç”Ÿæˆä»£ç†ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ ç”±å…¶ä»–æ–‡ä»¶ç”Ÿæˆï¼Œå…¸å‹åœºæ™¯æ˜¯JSPåº”ç”¨ï¼Œå³ç”±JSPæ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„Classç±»ã€‚ åŠ è½½é˜¶æ®µçš„æ³¨æ„ç‚¹ éæ•°ç»„ç±»çš„åŠ è½½é˜¶æ®µæ˜¯å¼€å‘äººå‘˜å¯æ§æ€§æœ€å¼ºçš„ï¼ŒåŠ è½½é˜¶æ®µæ—¢å¯ä»¥ä½¿ç”¨ç³»ç»Ÿæä¾›çš„å¼•å¯¼ç±»åŠ è½½å™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ã€‚ æ•°ç»„ç±»æœ¬èº«ä¸é€šè¿‡ç±»åŠ è½½å™¨åˆ›å»ºï¼Œå®ƒæ˜¯ç”±Javaè™šæ‹Ÿæœºç›´æ¥åˆ›å»ºçš„ï¼Œä½†æ˜¯æœ€ç»ˆè¿˜æ˜¯è¦é ç±»åŠ è½½å™¨æ˜¯åˆ›å»ºæ•°ç»„ç±»é‡Œé¢çš„å…ƒç´ ç±»å‹ï¼Œæ¯ä¸ªæ•°ç»„éƒ½ä¼šåœ¨åŠ è½½æ•°ç»„å…ƒç´ çš„ç±»åŠ è½½å™¨çš„ç±»åç§°ç©ºé—´ä¸Šè¢«æ ‡è¯†ã€‚ Javaè™šæ‹Ÿæœºè§„èŒƒæ²¡æœ‰è§„å®šç±»åœ¨æ–¹æ³•åŒºçš„å…·ä½“æ•°æ®ç»“æ„ï¼Œä¹Ÿæ²¡æœ‰è§„å®šç”Ÿæˆçš„Classå¯¹è±¡å­˜å‚¨åœ¨å“ªé‡Œï¼Œå¯¹äºHotSpotè™šæ‹Ÿæœºè€Œè¨€ï¼Œå®ƒè¢«å­˜æ”¾åœ¨æ–¹æ³•åŒºé‡Œé¢ï¼Œjdk1.8ä»¥ååº”è¯¥åœ¨ç›´æ¥å†…å­˜ä¸­å§ã€‚ åŠ è½½é˜¶æ®µä¸è¿æ¥é˜¶æ®µçš„éƒ¨åˆ†å†…å®¹ï¼ˆä¸€éƒ¨åˆ†å­—èŠ‚ç æ–‡ä»¶æ ¼å¼éªŒè¯å·¥ä½œï¼‰æ˜¯äº¤å‰è¿›è¡Œçš„ã€‚ éªŒè¯éªŒè¯ç›®çš„ç”±äºClassæ–‡ä»¶å¹¶ä¸ä¸€å®šè¦æ±‚ç”¨Javaæºç ç¼–è¯‘è€Œæ¥ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•é€”å¾„äº§ç”Ÿï¼Œæ‰€ä»¥å®‰å…¨æ€§å¾—ä¸åˆ°ä¿è¯ï¼Œè€ŒéªŒè¯çš„ç›®çš„å°±æ˜¯ä¸ºäº†ç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµåŒ…å«çš„ä¿¡æ¯ç¬¦åˆè™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚ éªŒè¯è¿‡ç¨‹ æ–‡ä»¶æ ¼å¼éªŒè¯ ä¸»è¦ç›®çš„æ˜¯ä¿è¯è¾“å…¥çš„å­—èŠ‚æµèƒ½æ­£ç¡®åœ°è§£æå¹¶å­˜å‚¨äºæ–¹æ³•åŒºä¹‹å†…ï¼Œæ ¼å¼ä¸Šè´Ÿè·ä¸€ä¸ªJavaç±»å‹ä¿¡æ¯çš„è¦æ±‚ï¼Œè¿™ä¸ªé˜¶æ®µçš„éªŒè¯æ˜¯åŸºäºäºŒè¿›åˆ¶å­—èŠ‚æµè¿›è¡Œçš„ï¼Œåªæœ‰é€šè¿‡è¿™ä¸ªé˜¶æ®µçš„éªŒè¯åï¼Œå­—èŠ‚æµæ‰ä¼šè¿›å…¥å†…å­˜çš„æ–¹æ³•åŒºä¸­è¿›è¡Œå­˜å‚¨ï¼Œæ‰€ä»¥åé¢çš„3ä¸ªéªŒè¯é˜¶æ®µå…¨éƒ¨æ˜¯åŸºäºæ–¹æ³•åŒºçš„å­˜å‚¨ç»“æ„è¿›è¡Œçš„ï¼Œä¸ä¼šå†ç›´æ¥æ“ä½œå­—ç¬¦æµã€‚ å…ƒæ•°æ®éªŒè¯ ä¸»è¦ç›®çš„æ˜¯å¯¹ç±»çš„å…ƒæ•°æ®ä¿¡æ¯è¿›è¡Œè¯­ä¹‰æ ¡éªŒï¼Œä¿è¯ä¸å­˜åœ¨ä¸ç¬¦åˆJavaè¯­è¨€è§„èŒƒçš„å…ƒæ•°æ®ä¿¡æ¯ã€‚ å­—èŠ‚ç éªŒè¯ ä¸»è¦ç›®çš„æ˜¯é€šè¿‡æ•°æ®æµå’Œæ§åˆ¶æµåˆ†æï¼Œç¡®å®šç¨‹åºè¯­ä¹‰æ˜¯åˆæ³•çš„ï¼Œç¬¦åˆé€»è¾‘çš„ï¼Œä¿è¯è¢«æ ¡éªŒç±»çš„æ–¹æ³•åœ¨è¿è¡Œæ—¶ä¸ä¼šåšå‡ºå±å®³è™šæ‹Ÿæœºå®‰å…¨çš„äº‹ä»¶ã€‚ ç¬¦å·å¼•ç”¨éªŒè¯ å‘ç”Ÿåœ¨è§£æé˜¶æ®µï¼ˆå°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ï¼‰ï¼Œä¸»è¦ç›®çš„æ˜¯ç¡®ä¿è§£æåŠ¨ä½œèƒ½æ­£å¸¸æ‰§è¡Œã€‚ è°ƒä¼˜çš„åœ°æ–¹å¦‚æœæ‰€è¿è¡Œçš„ä»£ç éƒ½å·²ç»è¢«åå¤ä½¿ç”¨å’ŒéªŒè¯è¿‡ï¼Œé‚£ä¹ˆåœ¨å®æ–½é˜¶æ®µå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨-Xverify:noneå‚æ•°æ¥å…³é—­å¤§éƒ¨åˆ†çš„ç±»éªŒè¯æªæ–½ï¼Œä»¥ç¼©çŸ­è™šæ‹Ÿæœºç±»åŠ è½½çš„æ—¶é—´ã€‚ å‡†å¤‡å‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µï¼Œä½†æ˜¯è¿™é‡Œçš„åˆå§‹å€¼éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼š é€šå¸¸æƒ…å†µï¼šåˆå§‹å€¼æ˜¯æ•°æ®ç±»å‹çš„é›¶å€¼ ç±»å˜é‡æœ‰fianlå…³é”®å­—ä¿®é¥°ï¼šåˆå§‹å€¼æ˜¯ConstantValueå±æ€§æ‰€æŒ‡å®šçš„å€¼ è§£æè§£æé˜¶æ®µæ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚è¿™é‡Œè§£é‡Šä¸€ä¸‹ç›´æ¥å¼•ç”¨å’Œç¬¦å·å¼•ç”¨ï¼š ç¬¦å·å¼•ç”¨ï¼šç¬¦å·å¼•ç”¨ä»¥ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ï¼Œç¬¦å·å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„å­—é¢é‡ã€‚å®ƒçš„å­—é¢é‡å½¢å¼æ˜ç¡®å®šä¹‰åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒçš„Classæ–‡ä»¶æ ¼å¼ä¸­ã€‚ç¬¦å·å¼•ç”¨äºè™šæ‹Ÿæœºå®ç°çš„å†…å­˜å¸ƒå±€æ— å…³ï¼Œå¼•ç”¨çš„ç›®æ ‡å¹¶ä¸ä¸€å®šå·²ç»åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ ç›´æ¥å¼•ç”¨ï¼šå®ƒå¯ä»¥æ˜¯ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹åç§»é‡æˆ–è€…æ˜¯ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ã€‚ç›´æ¥å¼•ç”¨å’Œè™šæ‹Ÿæœºå®ç°çš„å†…å­˜å¸ƒå±€ç›¸å…³ï¼Œæœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£ä¹ˆå¼•ç”¨çš„ç›®æ ‡å¿…å®šå·²ç»åœ¨å†…å­˜ä¸­å­˜åœ¨ã€‚ è™šæ‹Ÿæœºè§„èŒƒä¸­å¹¶æœªè§„å®šè§£æé˜¶æ®µå‘ç”Ÿçš„å…·ä½“æ—¶é—´ã€‚æ‰€ä»¥è™šæ‹Ÿæœºå¯ä»¥æ ¹æ®éœ€è¦æ¥åˆ¤æ–­åˆ°åº•æ˜¯åœ¨ç±»è¢«åŠ è½½å™¨åŠ è½½æ—¶å°±å¯¹å¸¸é‡æ± çš„ç¬¦å·å¼•ç”¨è¿›è¡Œè§£æï¼Œè¿˜æ˜¯ç­‰åˆ°ä¸€ä¸ªç¬¦å·å¼•ç”¨è¢«ä½¿ç”¨å‰å†å»è§£æå®ƒã€‚ è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ã€æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦7ç±»ç¬¦å·å¼•ç”¨è¿›è¡Œã€‚ åˆå§‹åŒ–ç±»åˆå§‹åŒ–æ—¶ç±»åŠ è½½è¿‡ç¨‹çš„æœ€åä¸€æ­¥ï¼Œåˆ°äº†åˆå§‹åŒ–é˜¶æ®µï¼Œæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„Javaç¨‹åºä»£ç ã€‚åœ¨å‡†å¤‡é˜¶æ®µï¼Œå˜é‡å·²ç»èµ‹è¿‡ä¸€æ¬¡ç³»ç»Ÿè¦æ±‚çš„åˆå§‹å€¼ï¼Œè€Œåœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œåˆ™æ ¹æ®ç¨‹åºå‘˜é€šè¿‡ç¨‹åºåˆ¶å®šçš„ä¸»è§‚è®¡åˆ’å»åˆå§‹åŒ–å˜é‡å’Œå…¶ä»–èµ„æºï¼Œä»å¦ä¸€ä¸ªè§’åº¦æ¥è¡¨è¾¾ï¼šåˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨clinit()æ–¹æ³•çš„è¿‡ç¨‹ã€‚ä¸‹é¢æ˜¯clinit()æ–¹æ³•çš„æ³¨æ„ç‚¹ï¼š clinit()æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å—ä¸­è¯­å¥åˆå¹¶äº§ç”Ÿçš„ï¼Œæ”¶é›†çš„é¡ºåºæ˜¯æœ‰è¯­å¥åœ¨æºæ–‡ä»¶å‡ºç°çš„é¡ºåºå†³å®šçš„ï¼Œè¿™é‡Œæœ‰å¾ˆç‰¹åˆ«çš„ä¸€ç‚¹ï¼šé™æ€è¯­å¥å—ä¸­åªèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨é™æ€è¯­å¥å—ä¹‹å‰çš„å˜é‡ï¼Œå®šä¹‰åœ¨ä¹‹åçš„å˜é‡ï¼Œåœ¨å‰é¢çš„é™æ€è¯­å¥å—å¯ä»¥èµ‹å€¼ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789public class Test &#123; static &#123; i =0; //æ­£å¸¸ç¼–è¯‘ System.out.println(i); //æç¤ºâ€œéæ³•å‘å‰å¼•ç”¨â€ &#125; static int i =1;&#125; clinit()æ–¹æ³•ä¸éœ€è¦æ˜¾å¼åœ°è°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œè™šæ‹Ÿæœºä¼šä¿è¯åœ¨å­ç±»çš„clinit()æ–¹æ³•æ‰§è¡Œå‰ï¼Œçˆ¶ç±»çš„clinit()æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚ ç”±äºçˆ¶ç±»çš„clinit()æ–¹æ³•å…ˆæ‰§è¡Œï¼Œæ‰€ä»¥çˆ¶ç±»å®šä¹‰çš„é™æ€è¯­å¥å—è¦ä¼˜å…ˆäºå­ç±»çš„å˜é‡èµ‹å€¼æ“ä½œã€‚ è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„clinit()æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸­è¢«æ­£ç¡®åœ°åŠ é”ã€åŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶å»åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ªç±»çš„clinit()æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹éƒ½è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œclinit()æ–¹æ³•å®Œæ¯•ã€‚ æ€»ç»“ç±»åŠ è½½çš„5ä¸ªé˜¶æ®µéƒ½å¾ˆé‡è¦ï¼Œå¯¹ç†è§£å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹æœ‰äº†æ›´å¥½çš„ç†è§£ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_7_æ¢ç§˜ç±»æ–‡ä»¶]]></title>
    <url>%2F2017%2F12%2F01%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-7-%E6%8E%A2%E7%A7%98%E7%B1%BB%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šjavaä»£ç ç¼–è¯‘çš„ç»“æœä»æœ¬åœ°æœºå™¨ç è½¬å˜ä¸ºå­—èŠ‚ç ï¼Œå¹¶ä¸”ç”Ÿæˆäº†ç±»æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»æ–‡ä»¶é‡Œé¢æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ JVMçš„æ— å…³æ€§ä¸€èˆ¬æåˆ°Javaçš„å¥½å¤„ï¼Œå…¶ä¸­å¿…å®šæœ‰ä¸€æ¡æ˜¯å¹³å°æ— å…³æ€§ï¼Œä½†æ˜¯è¿™ä¸ªå¤ªç‹­éš˜äº†ï¼Œå…¶å®å®ƒæœ‰ä¸¤ç‚¹æ— å…³æ€§ã€‚ å¹³å°æ— å…³æ€§Javaåœ¨åˆšåˆšè¯ç”Ÿä¹‹æ—¶å°±æœ‰ä¸€ä¸ªè‘—åçš„å®£ä¼ å£å·ï¼šâ€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œï¼ˆWrite Once, Run Anywhereï¼‰â€ã€‚â€œä¸å¹³å°æ— å…³â€çš„ç†æƒ³æœ€ç»ˆå®ç°åœ¨æ“ä½œç³»ç»Ÿçš„åº”ç”¨å±‚ä¸Šï¼šå…¶å®å°±æ˜¯Javaè™šæ‹Ÿæœºäº†ï¼Œä»–å¯ä»¥è½½å…¥å’Œæ‰§è¡ŒåŒä¸€ç§å¹³å°æ— å…³çš„å­—èŠ‚ç ï¼Œä»è€Œå®ç°äº†ç¨‹åºçš„â€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚ è¯­è¨€æ— å…³æ€§ç›®å‰å·²ç»ä¸€å¤§æ‰¹èƒ½å¤Ÿåœ¨JVMè¿è¡Œè¯­è¨€äº†ï¼Œå°±æˆ‘è‡ªå·±çŸ¥é“å¹¶ä¸”ä½¿ç”¨è¿‡å°±æœ‰Groovyã€Jythonã€Scalaç­‰ã€‚å®ç°è¯­è¨€æ— å…³æ€§çš„åŸºç¡€ä»ç„¶æ˜¯è™šæ‹Ÿæœºå’Œå­—èŠ‚ç å­˜å‚¨æ ¼å¼ã€‚å…¶ä»–è¯­è¨€é€šè¿‡è‡ªå·±çš„ç¼–è¯‘æŠŠç¨‹åºä»£ç ç¼–ç¨‹æˆç¬¦åˆJavaè™šæ‹Ÿæœºè§„èŒƒçš„Classæ–‡ä»¶å³å¯ã€‚ ç±»æ–‡ä»¶çš„ç»“æ„Classæ–‡ä»¶æ˜¯ä¸€ç»„ä»¥8ä½å­—èŠ‚ä¸ºåŸºç¡€å•ä½çš„äºŒè¿›åˆ¶æµï¼Œå„ä¸ªæ•°æ®é¡¹ç›®ä¸¥æ ¼æŒ‰ç…§é¡ºåºç´§å‡‘æ’åˆ—åœ¨Classæ–‡ä»¶ä¹‹ä¸­ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•åˆ†éš”ç¬¦ã€‚Classæ–‡ä»¶åªæœ‰ä¸¤ç§æ•°æ®ç±»å‹ï¼šæ— ç¬¦å·æ•°å’Œè¡¨ æ— ç¬¦å·æ•°ï¼šä»¥u1ï¼Œu2ï¼Œu4ï¼Œu8æ¥åˆ†åˆ«ä»£è¡¨1ä¸ªå­—èŠ‚ï¼Œ2ä¸ªå­—èŠ‚ï¼Œ4ä¸ªå­—èŠ‚å’Œ8ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•°ï¼Œæ— ç¬¦å·æ•°å¯ä»¥ç”¨æ¥æè¿°æ•°å­—ã€ç´¢å¼•å¼•ç”¨ã€æ•°å€¼é‡æˆ–è€…æŒ‰ç…§UTF-8ç¼–ç æ„æˆå­—ç¬¦ä¸²å€¼ã€‚ è¡¨ï¼šå®ƒæ˜¯ç”±å¤šä¸ªæ— ç¬¦å·æ•°æˆ–è€…å…¶ä»–è¡¨ä½œä¸ºæ•°æ®é¡¹æ„æˆçš„å¤åˆæ•°æ®ç±»å‹ï¼Œæ‰€æœ‰è¡¨ä¹ æƒ¯åœ°ä»¥â€œ_infoâ€ç»“å°¾ã€‚ æ•´ä¸ªClassæ–‡ä»¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å¼ è¡¨ï¼Œå®ƒç”±ä¸‹è¡¨æ‰€ç¤ºçš„æ•°æ®é¡¹æ„æˆã€‚ ç±»å‹ åç§° æ•°é‡ u4 é­”æ•° 1 u2 æ¬¡ç‰ˆæœ¬å· 1 u2 ä¸»ç‰ˆæœ¬å· 1 u2 å¸¸é‡æ•°é‡ 1 cp_info å¸¸é‡æ±  å¸¸é‡æ•°é‡-1 u2 è®¿é—®æ ‡å¿— 1 u2 ç±»ç´¢å¼• 1 u2 çˆ¶ç±»ç´¢å¼• 1 u2 æ¥å£æ•°é‡ 1 u2 æ¥å£ç´¢å¼•é›†åˆ æ¥å£æ•°é‡ u2 å­—æ®µæ•°é‡ 1 field_info å­—æ®µè¡¨ å­—æ®µæ•°é‡ u2 æ–¹æ³•æ•°é‡ 1 method_info æ–¹æ³•è¡¨ æ–¹æ³•æ•°é‡ u2 å±æ€§æ•°é‡ 1 attribute_info å±æ€§è¡¨ å±æ€§æ•°é‡ æ¥ä¸‹é‡Œç¨å¾®è¯¦ç»†çœ‹çœ‹ä¸Šé¢çš„æ•°æ®ï¼š ä¸è¿‡æŒ‰ä¾‹å­æ¥å§ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„Javaç±»1234567891011package com.todorex.demo;public class TestClass &#123; private int m; public int inc() &#123; return m+1; &#125;&#125; å…ˆç¼–è¯‘è¿™ä¸ªç±»å¾—åˆ°TestClass.classæ–‡ä»¶ï¼Œæ‰“å¼€å®ƒå¯ä»¥ä¸‹é¢çš„16è¿›åˆ¶æ•°ï¼š12345678910111213141516171819cafe babe 0000 0034 0013 0a00 0400 0f090003 0010 0700 1107 0012 0100 016d 01000149 0100 063c 696e 6974 3e01 0003 28295601 0004 436f 6465 0100 0f4c 696e 654e756d 6265 7254 6162 6c65 0100 0369 6e630100 0328 2949 0100 0a53 6f75 7263 6546696c 6501 000e 5465 7374 436c 6173 732e6a61 7661 0c00 0700 080c 0005 0006 01001a63 6f6d 2f74 6f64 6f72 6578 2f64 656d6f2f 5465 7374 436c 6173 7301 0010 6a617661 2f6c 616e 672f 4f62 6a65 6374 00210003 0004 0000 0001 0002 0005 0006 00000002 0001 0007 0008 0001 0009 0000 001d0001 0001 0000 0005 2ab7 0001 b100 00000100 0a00 0000 0600 0100 0000 0600 01000b00 0c00 0100 0900 0000 1f00 0200 01000000 072a b400 0204 60ac 0000 0001 000a0000 0006 0001 0000 0009 0001 000d 00000002 000e ç„¶åç”¨javap è§£æTestClass.classæ–‡ä»¶ï¼Œå¾—åˆ°ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253Classfile /Users/rex/IdeaProjects/JVMTest/src/com/todorex/demo/TestClass.class Last modified 2017-12-1; size 292 bytes MD5 checksum 337a51d3bebe0e9a82142a352eb0977e Compiled from "TestClass.java"public class com.todorex.demo.TestClass minor version: 0 major version: 52 flags: ACC_PUBLIC, ACC_SUPERConstant pool: #1 = Methodref #4.#15 // java/lang/Object."&lt;init&gt;":()V #2 = Fieldref #3.#16 // com/todorex/demo/TestClass.m:I #3 = Class #17 // com/todorex/demo/TestClass #4 = Class #18 // java/lang/Object #5 = Utf8 m #6 = Utf8 I #7 = Utf8 &lt;init&gt; #8 = Utf8 ()V #9 = Utf8 Code #10 = Utf8 LineNumberTable #11 = Utf8 inc #12 = Utf8 ()I #13 = Utf8 SourceFile #14 = Utf8 TestClass.java #15 = NameAndType #7:#8 // "&lt;init&gt;":()V #16 = NameAndType #5:#6 // m:I #17 = Utf8 com/todorex/demo/TestClass #18 = Utf8 java/lang/Object&#123; public com.todorex.demo.TestClass(); descriptor: ()V flags: ACC_PUBLIC Code: stack=1, locals=1, args_size=1 0: aload_0 1: invokespecial #1 // Method java/lang/Object."&lt;init&gt;":()V 4: return LineNumberTable: line 6: 0 public int inc(); descriptor: ()I flags: ACC_PUBLIC Code: stack=2, locals=1, args_size=1 0: aload_0 1: getfield #2 // Field m:I 4: iconst_1 5: iadd 6: ireturn LineNumberTable: line 9: 0&#125;SourceFile: "TestClass.java" é­”æ•° æ¯ä¸ªClassæ–‡ä»¶çš„å¤´4ä¸ªå­—èŠ‚æˆä¸ºé­”æ•° ä½¿ç”¨é­”æ•°æ¥è¿›è¡Œèº«ä»½è¯†åˆ«ï¼ˆæ–‡ä»¶ç±»åˆ«ï¼‰ï¼Œå› ä¸ºå¦‚æœä½¿ç”¨æ–‡ä»¶åæ¥è¯†åˆ«ï¼Œå®‰å…¨æ€§å¤ªä½ï¼Œç”±äºæ–‡ä»¶åå¯ä»¥éšæ„æ”¹åŠ¨ã€‚ Classæ–‡ä»¶çš„é­”æ•°çš„è·å¾—å°±æœ‰â€œæµªæ¼«æ°”æ¯â€ï¼Œå€¼ä¸º0xcafebabe,ä¸Šé¢16è¿›åˆ¶æ–‡ä»¶ä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚è¿™è®©è‡ªå·±æƒ³èµ·äº†é«˜ä¸­ç”¨çš„ä¸‰æ˜Ÿæ‰‹æœºæ‰“å¼€qqå°±æ˜¯ä¸€æ¯å’–å•¡çš„æ ‡å¿—ã€‚ Classæ–‡ä»¶çš„ç‰ˆæœ¬æ¥ä¸‹æ¥ç¬¬5ï¼Œ6ä¸ªå­—èŠ‚æ˜¾ç¤ºçš„æ˜¯æ¬¡ç‰ˆæœ¬å·ï¼Œ7ï¼Œ8å­—èŠ‚æ˜¾ç¤ºçš„æ˜¯ä¸»ç‰ˆæœ¬å·ã€‚ é«˜ç‰ˆæœ¬çš„JDKå¯ä»¥å‘ä¸‹å…¼å®¹ä»¥å‰ç‰ˆæœ¬çš„Classæ–‡ä»¶ï¼Œä½†ä¸èƒ½è¿è¡Œä»¥åç‰ˆæœ¬çš„Classæ–‡ä»¶ã€‚ å¸¸é‡æ± åœ¨ç‰ˆæœ¬å·ä¹‹åçš„æ˜¯å¸¸é‡æ± å…¥å£ã€‚ å¸¸é‡æ± æ˜¯Classæ–‡ä»¶ç»“æ„ä¸­ä¸å…¶ä»–é¡¹ç›®å…³è”æœ€å¤§çš„æ•°æ®ç±»å‹ï¼Œä¹Ÿæ˜¯å Classæ–‡ä»¶ç©ºé—´æœ€å¤§çš„æ•°æ®é¡¹ç›®ä¹‹ä¸€ã€‚ å¸¸é‡æ± å¸¸é‡çš„æ•°æ®ä¸æ˜¯å›ºå®šçš„ï¼Œåœ¨æœ€å‰é¢çš„Classæ–‡ä»¶ç»„æˆå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªå¸¸é‡æ•°é‡é¡¹ï¼Œè¿™ä¸ªå®¹é‡è®¡æ•°æ˜¯ä»1è€Œä¸æ˜¯0å¼€å§‹çš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„åå…­è¿›åˆ¶çš„å€¼ä¸º0x0013(19)å°±ä»£è¡¨æœ‰18ä¸ªå¸¸é‡ã€‚ å¸¸é‡æ± ä¸»è¦å­˜æ”¾ä¸¤å¤§ç±»å˜é‡ å­—é¢é‡ï¼šæ–‡æœ¬å­—ç¬¦ä¸²ã€å£°æ˜ä¸ºfinalçš„å¸¸é‡å€¼ç­‰ ç¬¦å·å¼•ç”¨ï¼šï¼ˆç¼–è¯‘åŸç†çš„æ¦‚å¿µï¼‰ ç±»å’Œæ¥å£çš„å…¨é™å®šå å­—æ®µçš„åç§°å’Œæè¿°ç¬¦ æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦ å¸¸é‡æ± çš„æ¯ä¸€é¡¹å¸¸é‡éƒ½æ˜¯è¡¨ï¼Œå¸¸é‡çš„é¡ºåºå¯ä»¥å‚ç…§javapè§£æå‡ºæ¥çš„å¸¸é‡é¡ºåºï¼Œåœ¨JDK1.7ä»¥åå…±æœ‰14ç§ä¸åŒç±»å‹çš„è¡¨ï¼Œä»–ä»¬å…±åŒç‚¹æ˜¯è¡¨çš„ç¬¬ä¸€ä½æ˜¯ä¸€ä¸ªu1ç±»å‹çš„æ ‡å¿—ä½ï¼ˆtagï¼‰ï¼Œå…·ä½“çš„æ ‡å¿—å¯¹åº”çš„ç±»å‹å‚ç…§ä¹¦ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ã€‚è¿™é‡Œæä¸€ä¸‹CONSTANT_UTF8_infoè¿™ä¸ªè¡¨ï¼š ç±»å‹ åç§° æ•°é‡ u1 tag 1 u2 length 1 u1 bytes length lengthå€¼è¯´æ˜äº†UTF-8ç¼–ç çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¤šå°‘å­—èŠ‚ï¼Œä»–åé¢è·Ÿç€çš„é•¿åº¦ä¸ºlengthå­—èŠ‚çš„è¿ç»­æ•°æ®æ˜¯ä¸€ä¸ªä½¿ç”¨UTF-8ç¼©ç•¥ç¼–ç è¡¨ç¤ºçš„å­—ç¬¦ä¸²ã€‚è€Œu2æœ€å¤§å€¼æ˜¯65535ï¼Œæ‰€ä»¥è¯´å¦‚æœJavaç¨‹åºå¦‚æœå®šä¹‰äº†è¶…è¿‡64KBï¼ˆå¤§çº¦ï¼‰è‹±æ–‡å­—ç¬¦çš„å˜é‡æˆ–è€…æ–¹æ³•åï¼Œå°†æ— æ³•ç¼–è¯‘ã€‚ UTF-8ç¼©ç•¥ç¼–ç å’ŒUTF-8ç¼–ç çš„åŒºåˆ«ï¼šUTF-8ç¼–ç éƒ½æ˜¯ä½¿ç”¨3ä¸ªå­—èŠ‚ç¼–ç ï¼Œè€ŒUTF-8ç¼©ç•¥ç¼–ç å¯ä»¥ä½¿ç”¨1æˆ–2æˆ–3ä¸ªå­—èŠ‚ç¼–ç ã€‚ è®¿é—®æ ‡å¿—åœ¨å¸¸é‡æ± ç»“æŸä¹‹åï¼Œç´§æ¥ç€çš„ä¸¤ä¸ªå­—èŠ‚ä»£è¡¨è®¿é—®æ ‡å¿—ï¼Œè¿™ä¸ªæ ‡å¿—ç”¨äºè¯†åˆ«ä¸€äº›ç±»æˆ–è€…æ¥å£å±‚æ¬¡çš„è®¿é—®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šè¿™ä¸ªClassæ˜¯ç±»è¿˜æ˜¯æ¥å£ï¼›æ˜¯å¦å®šä¹‰publicç±»å‹ï¼›æ˜¯å¦å®šä¹‰ä¸ºabstractç±»å‹ï¼›å¦‚æœæ˜¯ç±»çš„è¯ï¼Œæ˜¯å¦è¢«å£°æ˜ä¸ºfinalç­‰ï¼Œè®¿é—®æ ‡å¿—ä¸€å…±æœ‰16ä¸ªæ ‡å¿—ä½å¯ä»¥ä½¿ç”¨ï¼Œå½“å‰åªå®šä¹‰äº†8ä¸ªã€‚ ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•é›†åˆ ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•éƒ½æ˜¯u2ç±»å‹çš„æ•°æ®ï¼Œç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•éƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªCONSTANT_Class_infoçš„ç±»æè¿°ç¬¦å¸¸é‡ æ¥å£ç´¢å¼•é›†åˆæ˜¯ä¸€ç»„u2ç±»å‹çš„æ•°æ®çš„é›†åˆï¼Œå®ƒå…¥å£çš„ç¬¬ä¸€é¡¹æ˜¯u2çš„æ¥å£è®¡æ•°å™¨ï¼Œåé¢å°±æ˜¯å…·ä½“æ¥å£ç´¢å¼• Classæ–‡ä»¶æœ‰è¿™ä¸‰é¡¹æ•°æ®æ¥ç¡®å®šè¿™ä¸ªç±»çš„ç»§æ‰¿å…³ç³» å­—æ®µè¡¨é›†åˆæ¥ä¸‹æ¥æ˜¯å­—æ®µè¡¨ï¼Œå­—æ®µè¡¨ç”¨äºæè¿°æ¥å£æˆ–è€…ç±»ä¸­å£°æ˜çš„å˜é‡ï¼ŒåŒ…æ‹¬ç±»çº§å˜é‡ä»¥åŠå®ä¾‹çº§å˜é‡ï¼Œä¸åŒ…æ‹¬æ–¹æ³•å†…éƒ¨å£°æ˜çš„å±€éƒ¨å˜é‡ã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€ä¸ªå­—æ®µè¡¨çš„æ„æˆï¼š ç±»å‹ åç§° æ•°é‡ u2 è®¿é—®æ ‡å¿— 1 u2 ç®€å•åç§°ç´¢å¼• 1 u2 æè¿°ç¬¦ç´¢å¼• 1 u2 å±æ€§æ•°é‡ 1 attribute_info å±æ€§è¡¨ å±æ€§æ•°é‡ æ ¹æ®ä¸Šè¡¨æˆ‘ä»¬è§£æä¸€ä¸‹å…¶ä¸­çš„å«ä¹‰ï¼š è®¿é—®æ ‡å¿—ï¼šå®ƒå’Œä¹‹å‰çš„è®¿é—®æ ‡å¿—å¾ˆç±»ä¼¼ã€‚ ç®€å•åç§°ç´¢å¼•ï¼šå®ƒæŒ‡å‘ä¸€ä¸ªCONSTANT_UTF8_infoç±»å‹çš„å¸¸é‡ï¼Œè¿™é‡Œé¢å­˜å‚¨äº†æœ¬å­—æ®µçš„åå­—ä¿¡æ¯ï¼Œåƒjavapè§£æåçš„ç¬¬5ä¸ªå¸¸é‡mã€‚ æè¿°ç¬¦ç´¢å¼•ï¼šç”¨æ¥æè¿°å­—æ®µçš„æ•°æ®ç±»å‹ï¼Œåƒjavapè§£æåçš„ç¬¬6ä¸ªå¸¸é‡I,ä»£è¡¨äº†åŸºæœ¬ç±»å‹int å±æ€§è¡¨ï¼ˆå¯èƒ½æœ‰ConstantValueè¡¨ ä¸‹é¢æ˜¯å­—ç¬¦è¡¨çš„æ³¨æ„ç‚¹ï¼š å­—æ®µè¡¨é›†åˆä¸ä¼šåˆ—å‡ºä»è¶…ç±»æˆ–è€…çˆ¶æ¥å£ç»§æ‰¿è€Œæ¥çš„å­—æ®µã€‚ å­—æ®µè¡¨æœ‰å¯èƒ½åˆ—å‡ºåŸæœ¬Javaä»£ç ä¹‹ä¸­ä¸å­˜åœ¨çš„å­—æ®µï¼Œè­¬å¦‚åœ¨å†…éƒ¨ç±»ä¸­ä¸ºäº†ä¿æŒå¯¹å¤–éƒ¨ç±»çš„è®¿é—®æ€§ï¼Œä¼šè‡ªåŠ¨æ·»åŠ æ‰§è¡Œå¤–éƒ¨ç±»å®ä¾‹çš„å­—æ®µã€‚ï¼ˆä¸æ‡‚ï¼Œå¤§ä½¬è¯·æŒ‡æ•™ï¼‰ Javaè¯­è¨€ä¸­å­—æ®µæ˜¯æ— æ³•é‡è½½çš„ï¼Œåç§°å¿…é¡»ä¸ä¸€æ ·ï¼Œä½†æ˜¯å¯¹äºå­—èŠ‚ç æ¥è¯´ï¼Œå¦‚æœä¸¤ä¸ªå­—æ®µçš„æè¿°ç¬¦ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆå­—æ®µé‡åæ˜¯åˆæ³•çš„ã€‚ æ–¹æ³•è¡¨é›†åˆæ¥ä¸‹æ¥æ˜¯æ–¹æ³•è¡¨ï¼Œæ–¹æ³•è¡¨çš„å†…å®¹å’Œå­—æ®µè¡¨å‡ ä¹å®Œå…¨ä¸€è‡´ã€‚å…¶ä¸­å‘é¡¶ä¹Ÿçœ‹ä¸€ä¸‹æ–¹æ³•è¡¨çš„æ„æˆï¼š ç±»å‹ åç§° æ•°é‡ u2 è®¿é—®æ ‡å¿— 1 u2 ç®€å•åç§°ç´¢å¼• 1 u2 æè¿°ç¬¦ç´¢å¼• 1 u2 å±æ€§æ•°é‡ 1 attribute_info å±æ€§è¡¨ å±æ€§æ•°é‡ è¿™é‡Œè§£é‡Šä¸€ä¸‹å’Œå­—æ®µè¡¨ä¸ä¸€æ ·çš„åœ°æ–¹ ç®€å•åç§°ç´¢å¼•ï¼šå®ƒæŒ‡å‘ä¸€ä¸ªCONSTANT_UTF8_infoç±»å‹çš„å¸¸é‡ï¼Œè¿™é‡Œé¢å­˜å‚¨äº†æœ¬å­—æ®µçš„åå­—ä¿¡æ¯ï¼Œåƒjavapè§£æåçš„ç¬¬11ä¸ªå¸¸é‡incã€‚ æè¿°ç¬¦ç´¢å¼•ï¼šå®ƒçš„ä½œç”¨æ˜¯ç”¨æ¥ææ–¹æ³•çš„å‚æ•°åˆ—è¡¨ï¼ˆåŒ…æ‹¬æ•°é‡ã€ç±»å‹ä»¥åŠé¡ºåºï¼‰å’Œè¿”å›å€¼ï¼Œåƒjavapè§£æåçš„ç¬¬12ä¸ªå¸¸é‡()I,è¡¨ç¤ºçš„å°±æ˜¯ä¸€ä¸ªè¿”å›å€¼ä¸ºintçš„æ–¹æ³•ã€‚ å±æ€§è¡¨ï¼šè¿™é‡Œè‚¯å®šå­˜æ”¾äº†Codeå±æ€§è¡¨ï¼ˆæ–¹æ³•é‡Œçš„Javaä»£ç ï¼‰ ä¸‹é¢æ˜¯æ–¹æ³•è¡¨çš„æ³¨æ„ç‚¹ï¼š å¦‚æœçˆ¶ç±»æ–¹æ³•åœ¨å­ç±»æ²¡æœ‰è¢«é‡å†™ï¼Œæ–¹æ³•è¡¨é›†åˆä¸­å°±ä¸ä¼šå‡ºç°æ¥è‡ªçˆ¶ç±»çš„æ–¹æ³•ä¿¡æ¯ã€‚ å¯èƒ½ä¼šå‡ºç°ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ·»åŠ çš„æ–¹æ³•ï¼Œæœ€å…¸å‹çš„æœ‰ç±»æ„é€ å™¨â€œâ€æ–¹æ³•å’Œå®ä¾‹æ„é€ å™¨â€œâ€æ–¹æ³•ï¼Œå°±åƒjavapè§£æåçš„ç¬¬11ä¸ªå¸¸é‡ã€‚ åœ¨Javaè¯­è¨€ä¸­ï¼Œè¦é‡è½½ä¸€ä¸ªæ–¹æ³•ï¼Œéœ€è¦ç›¸åŒçš„ç®€å•åç§°å’Œä¸åŸæ–¹æ³•ä¸åŒçš„Javaä»£ç çš„æ–¹æ³•ç‰¹å¾ç­¾åï¼Œè¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹Javaç‰¹å¾ç­¾åå’ŒJVMç‰¹å¾ç­¾åï¼š Javaç‰¹å¾ç­¾åï¼šæ–¹æ³•åç§°ã€å‚æ•°é¡ºåº JVMç‰¹å¾ç­¾åï¼šJavaç‰¹å¾ç­¾åã€æ–¹æ³•è¿”å›å€¼ä»¥åŠå—æŸ¥å¼‚å¸¸è¡¨ å±æ€§è¡¨é›†åˆæœ€åå°±æ˜¯å±æ€§è¡¨é›†åˆäº†ï¼Œåœ¨Classæ–‡ä»¶ã€å­—æ®µè¡¨ã€æ–¹æ³•è¡¨éƒ½å¯ä»¥æºå¸¦è‡ªå·±çš„å±æ€§è¡¨é›†åˆï¼Œä»¥åŠç”¨äºæè¿°æŸäº›åœºæ™¯ä¸“æœ‰çš„ä¿¡æ¯ã€‚å±æ€§è¡¨é›†åˆä¸è¦æ±‚å„ä¸ªå±æ€§å…·æœ‰ä¸¥æ ¼çš„é¡ºåºï¼Œå¹¶ä¸”åªè¦ä¸ä¸å·²æœ‰å±æ€§åé‡å¤å°±å¥½ã€‚ ä¸Šé¢ç¨‹åºçš„ä¾‹å­å‡ºç°è¿‡å‡ ä¸ªå±æ€§è¡¨ï¼šCodeã€LineNumberTableã€SourceFileã€ConstantValueï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†è¯´ä¸€ä¸‹ï¼š Codeå±æ€§Javaç¨‹åºæ–¹æ³•ä½“ä¸­çš„ä»£ç ç»è¿‡Javacç¼–è¯‘å™¨å¤„ç†åï¼Œæœ€ç»ˆå˜ä¸ºå­—èŠ‚ç æŒ‡ä»¤å­˜å‚¨åœ¨Codeå±æ€§å†…ï¼ŒCodeå±æ€§å‡ºç°åœ¨æ–¹æ³•è¡¨å±æ€§é›†åˆä¹‹ä¸­ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹Codeå±æ€§è¡¨çš„ç»“æ„ï¼š ç±»å‹ åç§° æ•°é‡ u2 å±æ€§åç´¢å¼• 1 u4 å±æ€§é•¿åº¦ 1 u2 æ“ä½œæ•°æ ˆæ·±åº¦çš„æœ€å¤§å€¼ 1 u2 å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å­˜å‚¨ç©ºé—´ 1 u4 Javaæ–¹æ³•ä»£ç å­—èŠ‚ç æŒ‡ä»¤é•¿åº¦ 1 u1 Javaæ–¹æ³•ä»£ç å­—èŠ‚ç  Javaæ–¹æ³•ä»£ç å­—èŠ‚ç æŒ‡ä»¤é•¿åº¦ u2 æ˜¾å¼å¼‚å¸¸è¡¨é•¿åº¦ 1 exception_info æ˜¾å¼å¼‚å¸¸è¡¨ æ˜¾å¼å¼‚å¸¸è¡¨é•¿åº¦ u2 å±æ€§ä¸ªæ•° 1 attribute_info å±æ€§è¡¨ å±æ€§ä¸ªæ•° æ¥ä¸‹æ¥æˆ‘ä»¬è¯´æ˜ä¸€ä¸‹å‡ ä¸ªå…³é”®é¡¹ï¼š å±æ€§åç´¢å¼•ï¼šå®ƒæ˜¯ä¸€é¡¹æŒ‡å‘CONSTANT_UTF8_infoå‹çš„ç´¢å¼•ï¼Œå¸¸é‡å€¼å›ºå®šä¸ºâ€œCodeâ€ï¼Œå°±åƒä¸Šé¢javapè§£æå‡ºæ¥çš„å¸¸é‡æ± çš„ç¬¬9ä¸ªã€‚ å±æ€§é•¿åº¦ï¼šå›ºå®šä¸ºæ•´ä¸ªå±æ€§è¡¨é•¿åº¦å‡å»6ä¸ªå­—èŠ‚ã€‚ æ“ä½œæ•°æ ˆæ·±åº¦çš„æœ€å¤§å€¼ï¼šåœ¨æ–¹æ³•æ‰§è¡Œçš„ä»»æ„æ—¶åˆ»ï¼Œæ“ä½œæ•°æ ˆéƒ½ä¸ä¼šè¶…è¿‡è¿™ä¸ªæ·±åº¦ï¼Œè™šæ‹Ÿæœºè¿è¡Œçš„æ—¶å€™éœ€è¦æ ¹æ®è¿™ä¸ªå€¼æ¥åˆ†é…æ ˆæ ˆä¸­çš„æ“ä½œæ•°æ ˆæ·±åº¦ã€‚ å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å­˜å‚¨ç©ºé—´ï¼šå®ƒçš„å•ä½æ˜¯Slotï¼Œå±€éƒ¨å˜é‡è¡¨å­˜å‚¨äº†æ–¹æ³•å‚æ•°ï¼ˆåŒ…æ‹¬å®ä¾‹æ–¹æ³•ä¸­çš„éšè—å‚æ•°thisï¼‰ã€æ˜¾ç¤ºå¼‚å¸¸å¤„ç†å™¨çš„å‚æ•°ï¼ˆtry-catchæ£€æŸ¥çš„å¼‚å¸¸ï¼‰ã€æ–¹æ³•ä½“ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼ŒJavacç¼–è¯‘å™¨ä¼šæ ¹æ®å˜é‡çš„ä½œç”¨åŸŸæ¥åˆ†é…Slotï¼Œç„¶åè®¡ç®—å‡ºéœ€è¦çš„å­˜å‚¨ç©ºé—´å¤§å°ã€‚ Javaæ–¹æ³•ä»£ç å­—èŠ‚ç æŒ‡ä»¤é•¿åº¦å’ŒJavaæ–¹æ³•ä»£ç å­—èŠ‚ç ï¼šå­˜å‚¨äº†Javaæºç¨‹åºç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œç›®å‰Javaè™šæ‹Ÿæœºè§„èŒƒå·²ç»å®šä¹‰äº†çº¦200æ¡ç¼–ç å€¼å¯¹åº”çš„æŒ‡ä»¤å«ä¹‰ã€‚ PSï¼šå¦‚æœæŠŠä¸€ä¸ªJavaç¨‹åºä¸­çš„ä¿¡æ¯åˆ†ä¸ºä»£ç ï¼ˆCodeï¼Œæ–¹æ³•ä½“é‡Œé¢çš„Javaä»£ç ï¼‰å’Œå…ƒæ•°æ®ï¼ˆMetadataï¼ŒåŒ…æ‹¬ç±»ã€å­—æ®µã€æ–¹æ³•å®šä¹‰ä»¥åŠå…¶ä»–ä¿¡æ¯ï¼‰ä¸¤éƒ¨åˆ†ï¼Œé‚£ä¹ˆåœ¨æ•´ä¸ªClassæ–‡ä»¶ï¼ŒCodeå±æ€§ç”¨æ¥æè¿°ä»£ç ï¼Œæ‰€æœ‰å…¶ä»–æ•°æ®é¡¹ç›®éƒ½ç”¨äºæè¿°å…ƒæ•°æ®ã€‚ æ˜¾å¼å¼‚å¸¸è¡¨ï¼šç”¨äºæ˜¾ç¤ºtry-catchä»£ç å—è¦æ£€æŸ¥çš„å¼‚å¸¸ LineNumberTableå®ƒçš„ä½¿ç”¨ä½ç½®æ˜¯åœ¨Codeå±æ€§ï¼Œç”¨äºæè¿°Javaæºç è¡Œå·ä¸å­—èŠ‚ç è¡Œå·ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œå½“æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™å †æ ˆä¼šæ˜¾ç¤ºå‡ºé”™çš„è¡Œå·ã€‚ SourceFileå®ƒçš„ä½¿ç”¨ä½ç½®æ˜¯ç±»æ–‡ä»¶ï¼Œç”¨äºè®°å½•ç”Ÿæˆè¿™ä¸ªClassæ–‡ä»¶çš„æºç æ–‡ä»¶åç§°ï¼Œå½“æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™ä¼šæ˜¾ç¤ºå‡ºé”™ä»£ç æ‰€å±çš„æ–‡ä»¶åã€‚ ConstantValueå®ƒçš„ä½¿ç”¨ä½ç½®æ˜¯å­—æ®µè¡¨ï¼Œä½œç”¨æ˜¯é€šçŸ¥è™šæ‹Ÿæœºè‡ªåŠ¨ä¸ºé™æ€å˜é‡èµ‹å€¼ï¼Œåªæœ‰staticå…³é”®å­—ä¿®é¥°çš„å˜é‡ï¼ˆç±»å˜é‡ï¼‰æ‰å¯ä»¥ä½¿ç”¨è¿™é¡¹å±æ€§ï¼Œè™šæ‹Ÿæœºå¯¹äºç±»å˜é‡å’Œå®ä¾‹å˜é‡èµ‹å€¼çš„æ–¹å¼æœ‰æ‰€ä¸ç”¨ã€‚ å®ä¾‹å˜é‡ï¼šåœ¨å®ä¾‹æ„é€ å™¨æ–¹æ³•ä¸­è¿›è¡Œ ç±»å˜é‡ï¼šåœ¨ç±»æ„é€ å™¨æ–¹æ³•ä¸­æˆ–è€…ä½¿ç”¨ConstantValueå±æ€§ ç›®å‰Sun Javacç¼–è¯‘å™¨çš„é€‰æ‹©æ˜¯ï¼šå¦‚æœåŒæ—¶ä½¿ç”¨finalå’Œstaticæ¥ä¿®é¥°ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”è¿™ä¸ªå¸¸é‡çš„æ•°æ®ç±»å‹æ˜¯åŸºæœ¬ç±»å‹æˆ–è€…Stringç±»å‹ï¼Œå°±ç”ŸæˆConstantValueå±æ€§æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœè¿™ä¸ªå˜é‡æ²¡æœ‰è¢«finalä¿®é¥°ï¼Œæˆ–è€…å¹¶éåŸºæœ¬ç±»å‹æˆ–è€…å­—ç¬¦ä¸²ï¼Œåˆ™å°†ä¼šé€‰æ‹©åœ¨æ–¹æ³•ä¸­è¿›è¡Œåˆå§‹åŒ–ã€‚ æ€»ç»“é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬ä¸€å®šèƒ½æ¸…æ¥šçš„çŸ¥é“Classæ–‡ä»¶æ˜¯ä»€ä¹ˆä»¥åŠClassæ–‡ä»¶åŒ…å«ä»€ä¹ˆä¸œè¥¿ï¼Œå†ä¹Ÿä¸æ€•äº†ï¼ï¼ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_6_JVMè°ƒä¼˜å®æˆ˜]]></title>
    <url>%2F2017%2F11%2F30%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-6-JVM%E8%B0%83%E4%BC%98%E5%AE%9E%E6%88%98%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¸¦ç€æµ…å°åŸºæœ¬çš„Javaè¯Šæ–­å·¥å…·å°±è¿™æ ·æŠŠã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹çš„è°ƒä¼˜éƒ¨åˆ†çœ‹å®Œäº†ï¼Œä¼¼æ‡‚éæ‡‚ï¼Œæˆ‘æƒ³å¾…è‡ªå·±ç»å†è¿‡ä¸€æ¬¡æ€§èƒ½è°ƒä¼˜ï¼Œç»“åˆè‡ªèº«ç»å†å†æ¥å¥½å¥½æ€»ç»“ä¸€ç•ªå§ã€‚ æ­¤å¤„æš‚æ—¶çœç•¥ä¸€ä¸‡å­—ã€‚ã€‚ã€‚]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_5_å†…å­˜åˆ†é…ç­–ç•¥]]></title>
    <url>%2F2017%2F11%2F30%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-5-%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸€ç›´åœ¨è¯´Javaçš„åƒåœ¾å›æ”¶ï¼Œæ—¢ç„¶æœ‰å›æ”¶ï¼Œé‚£ä¹ˆå½“ç„¶ä¼šæœ‰åˆ†é…ã€‚ JavaæŠ€æœ¯ä½“ç³»ä¸­æ‰€æå€¡çš„è‡ªåŠ¨å†…å­˜ç®¡ç†å¯ä»¥å½’ç»“ä¸ºè‡ªåŠ¨åŒ–åœ°è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š ç»™å¯¹è±¡åˆ†é…å†…å­˜ å›æ”¶åˆ†é…ç»™å¯¹è±¡çš„å†…å­˜ ä¹‹å‰åƒåœ¾å›æ”¶å·²ç»è®²äº†å¾ˆå¤šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†åœ°æ¥çœ‹çœ‹å†…å­˜åˆ†é… å†…å­˜åˆ†é…æ€»è¯´å¯¹è±¡çš„å†…å­˜åˆ†é…ï¼Œä¸»è¦æ˜¯åœ¨å †ä¸Šåˆ†é…ï¼Œå¯¹è±¡ä¸»è¦åˆ†é…åœ¨æ–°ç”Ÿä»£çš„EdenåŒºä¸Šï¼Œå¦‚æœå¯åŠ¨äº†æœ¬åœ°çº¿ç¨‹çš„åˆ†é…ç¼“å†²ï¼Œå°†æŒ‰çº¿ç¨‹ä¼˜å…ˆåœ¨TLABä¸Šåˆ†é…ï¼Œå°‘æ•°æƒ…å†µä¸‹ï¼ˆå¤§å¯¹è±¡ï¼‰ä¹Ÿå¯èƒ½ç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ä¸­ï¼Œåˆ†é…çš„è§„åˆ™ä¸æ˜¯ç™¾åˆ†ç™¾å›ºå®šçš„ï¼Œå…¶ç»†èŠ‚å–å†³äºå½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸€ç§åƒåœ¾æ”¶é›†å™¨ç»„åˆï¼Œè¿˜æœ‰è™šæ‹Ÿæœºä¸­ä¸å†…å­˜ç›¸å…³çš„å‚æ•°çš„è®¾ç½®ã€‚ å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é… å¤§å¤šæ•°æƒ…å†µï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£EdenåŒºåˆ†é…ã€‚å½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºä¼šå‘èµ·ä¸€æ¬¡MinorGCã€‚ å½“MinorGCå‘ç°å¤åˆ¶çš„å¯¹è±¡å¤§äºSurvivoråŒºæ—¶ï¼Œä¼šé€šè¿‡åˆ†é…æ‹…ä¿æœºåˆ¶æå‰è½¬ç§»åˆ°è€å¹´ä»£ä¸­ã€‚ å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£æ‰€è°“å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„Javaå¯¹è±¡ï¼Œå¦‚æ•°ç»„ã€‚ è™šæ‹Ÿæœºæä¾›äº†ä¸€ä¸ª-XX:PretenureSizeThresholdå‚æ•°ï¼Œä»¤å¤§äºè¿™ä¸ªè®¾ç½®å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ï¼Œé¿å…äº†åœ¨EdenåŒºåŠSurvivoråŒºä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜å¤åˆ¶ã€‚ï¼ˆæ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•æ”¶é›†å†…å­˜ï¼‰ é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£è™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å¹´é¾„è®¡æ•°å™¨ã€‚å¦‚æœå¯¹è±¡åœ¨Edenå‡ºç”Ÿå¹¶ç»è¿‡ç¬¬ä¸€æ¬¡MinorGCåä»ç„¶å­˜æ´»ï¼Œå¹¶ä¸”èƒ½è¢«Survivorå®¹çº³çš„è¯ï¼Œå°†è¢«ç§»åŠ¨åˆ°Survivorç©ºé—´ä¸­ï¼Œå¹¶ä¸”å¯¹è±¡å¹´é¾„è®¾ç½®ä¸º1.å¯¹è±¡åœ¨Survivorä¸­æ¯åº¦è¿‡ä¸€æ¬¡MinorGCï¼Œå¹´é¾„å°±å¢åŠ ä¸€å²ï¼Œå½“ä»–çš„å¹´é¾„è¾¾åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤15å²ï¼‰ï¼Œå°±å°†è¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚å¯¹è±¡çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•°-XXï¼šMaxTenuringThresholdè®¾ç½®ã€‚ åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®šè™šæ‹Ÿæœºä¸æ˜¯æ°¸è¿œè¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ°MaxTenuringThresholdæ‰æ™‹å‡åˆ°è€å¹´ä»£ï¼Œå¦‚æœSurvivorç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°æ€»å’Œå¤§äºSurvivorç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºæ”¹å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚ ç©ºé—´åˆ†é…æ‹…ä¿ç­–ç•¥è™½ç„¶æœ‰ç©ºé—´åˆ†é…æ‹…ä¿ï¼Œä½†æ˜¯ä¹Ÿéœ€è¦è€ƒè™‘è€å¹´ä»£èƒ½å¦è£…ä¸‹ç”±äºæ‹…ä¿è½¬å­˜çš„å†…å­˜å¤§å°ï¼Œæ‰€ä»¥è¿™ä¸ªç©ºé—´åˆ†é…æ‹…ä¿ä¹Ÿéœ€è¦ä¸€å®šçš„ç­–ç•¥ã€‚ åœ¨å‘ç”ŸMinorGCä¹‹å‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ å¦‚æœä¸Šé¢æ¡ä»¶æˆç«‹ï¼Œé‚£ä¹ˆMinorGCå°±æ˜¯å®‰å…¨çš„ï¼Œå¯ä»¥è¿›è¡Œ å¦‚æœä¸Šé¢æ¡ä»¶ä¸æˆç«‹ï¼Œè™šæ‹Ÿæœºä¼šæŸ¥çœ‹HandlePromotionFailureè®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ã€‚ å¦‚æœå…è®¸æ‹…ä¿å¤±è´¥ï¼Œå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å° å¦‚æœå¤§äºï¼Œå°†å°è¯•è¿›è¡Œä¸€æ¬¡MinorGC å¦‚æœå°äºï¼Œæˆ–è€…HandlePromotionFailureè®¾ç½®ä¸ºä¸å…è®¸å†’é™©ï¼Œé‚£è¿™æ—¶éœ€è¦è¿›è¡Œä¸€æ¬¡FullGC åœ¨jdk 6 update 24ä¹‹åçš„è§„åˆ™æ˜¯åªè¦è€å¹´ä»£çš„è¿ç»­ç©ºé—´å¤§äºæ–°ç”Ÿä»£å¯¹è±¡çš„æ€»å¤§å°æˆ–è€…å†æ¬¡æ™‹å‡å¹³å‡å¤§å°å°±ä¼šè¿›è¡ŒMinorGCï¼Œå¦åˆ™è¿›è¡ŒFullGCã€‚ æ€»ç»“é€šè¿‡ä¸Šé¢æˆ‘ä»¬å¯ä»¥çŸ¥é“JAVAè™šæ‹Ÿæœºæ˜¯æ€ä¹ˆè‡ªåŠ¨è¿›è¡Œå†…å­˜åˆ†é…çš„ï¼Œç„¶ååœ¨è¿›è¡ŒGCä¹‹åï¼Œå†…å­˜æ˜¯æ€ä¹ˆè½¬æ¢çš„ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£JAVAè™šæ‹Ÿæœºã€‹]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_4_åƒåœ¾æ”¶é›†ç­–ç•¥]]></title>
    <url>%2F2017%2F11%2F29%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-4-%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%AD%96%E7%95%A5%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šJavaä¸C++ä¹‹é—´æœ‰ä¸€å µå†…å­˜åŠ¨æ€åˆ†é…ä¸åƒåœ¾æ”¶é›†æŠ€æœ¯æ‰€å›´æˆçš„â€œé«˜å¢™â€ï¼Œå¢™å¤–é¢çš„äººæƒ³è¿›å»ï¼Œå¢™é‡Œé¢çš„äººå´æƒ³å‡ºæ¥ã€‚é‚£æˆ‘ä»¬å°±å…ˆæ¥çœ‹çœ‹JVMåˆ°åº•æ˜¯æ€ä¹ˆè¿›è¡Œåƒåœ¾æ”¶é›†çš„ï¼Ÿ åƒåœ¾å›æ”¶ï¼Œå›æ”¶å“ªé‡Œï¼Ÿä¹‹å‰ä»‹ç»è¿‡Javaå†…å­˜è¿è¡Œæ—¶åŒºåŸŸçš„å„ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆ3ä¸ªåŒºåŸŸéšçº¿ç¨‹è€Œç”Ÿï¼Œéšçº¿ç¨‹è€Œç­ï¼Œè¿™å‡ ä¸ªåŒºåŸŸçš„å†…å­˜åˆ†é…å’Œå›æ”¶éƒ½å…·æœ‰ç¡®å®šæ€§ï¼Œæ–¹æ³•ç»“æŸæˆ–è€…çº¿ç¨‹ç»“æŸï¼Œå†…å­˜è‡ªç„¶å°±è·Ÿç€å›æ”¶äº†ï¼Œä½†æ˜¯Javaå †å’Œæ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰åˆ™ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬åªæœ‰åœ¨è¿è¡ŒæœŸé—´æ‰çŸ¥é“ä¼šåˆ›å»ºå“ªäº›å¯¹è±¡ï¼Œè¿™éƒ¨åˆ†å†…å­˜çš„åˆ†é…å’Œå›æ”¶éƒ½æ˜¯åŠ¨æ€çš„ï¼Œæ‰€æœ‰åƒåœ¾å›æ”¶å°±æ˜¯å›æ”¶è¿™é‡Œã€‚ å¯¹è±¡å·²æ­»ä¹ˆï¼Ÿåƒåœ¾æ”¶é›†å™¨åœ¨å¯¹å †è¿›è¡Œå›æ”¶å‰ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¦ç¡®å®šè¿™äº›å¯¹è±¡ä¹‹ä¸­è¿˜æœ‰é‚£äº›è¿˜â€œå­˜æ´»â€è€…ï¼Œå“ªäº›å·²ç»â€œæ­»å»â€ï¼ˆå³ä¸å¯èƒ½å†è¢«ä»»ä½•é€”å¾„ä½¿ç”¨çš„å¯¹è±¡ï¼‰ã€‚ å¼•ç”¨è®¡æ•°ç®—æ³• ç»™æ¯ä¸ªå¯¹è±¡æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒæ—¶ï¼Œè®¡æ•°å™¨å°±åŠ ä¸€ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å€¼å°±å‡ä¸€ï¼›ä»»ä½•æ—¶åˆ»è®¡æ•°å™¨ä¸º0çš„å¯¹è±¡å°±æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„ã€‚ å¯è¾¾æ€§åˆ†æç®—æ³•ï¼ˆJavaä½¿ç”¨ï¼‰ é€šè¿‡ä¸€ç³»åˆ—ç§°ä¸ºâ€œGC Rootsâ€çš„å¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„è¢«ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚ åœ¨Javaè¯­è¨€ä¸­ï¼Œå¯ä½œä¸ºGC Rootsçš„å¯¹è±¡åŒ…æ‹¬ä¸‹é¢å‡ ç§ï¼š è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§åº”ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆå³ä¸€èˆ¬è¯´çš„Nativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ å¼•ç”¨ç±»å‹ å¼ºå¼•ç”¨ï¼šç±»ä¼¼â€Object obj = new Object()â€è¿™ç±»çš„å¼•ç”¨ï¼Œåªè¦å¼ºå¼•ç”¨è¿˜å­˜åœ¨ï¼Œåƒåœ¾æ”¶é›†å™¨æ°¸è¿œä¸ä¼šå›æ”¶æ‰è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚ è½¯å¼•ç”¨ï¼šç”¨æ¥æè¿°è¿˜æœ‰ç”¨ä½†éå¿…é¡»çš„å¯¹è±¡ï¼Œå¯¹äºè½¯å¼•ç”¨å…³è”ç€çš„å¯¹è±¡ï¼Œåœ¨ç³»ç»Ÿå°†è¦å‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ä¹‹å‰ï¼Œå°†ä¼šæŠŠè¿™äº›å¯¹è±¡åˆ—è¿›å›æ”¶èŒƒå›´ä¹‹ä¸­è¿›è¡Œç¬¬äºŒæ¬¡å›æ”¶ã€‚å¦‚æœè¿™æ¬¡å›æ”¶è¿˜æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œæ‰ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚å®ƒæ˜¯é€šè¿‡SoftReferenceç±»æ¥å®ç°è½¯å¼•ç”¨çš„ã€‚ å¼±å¼•ç”¨ï¼šç”¨æ¥æè¿°éå¿…éœ€å¯¹è±¡çš„ï¼Œè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å‘ç”Ÿä¹‹å‰ã€‚å½“åƒåœ¾æ”¶é›†å™¨å·¥ä½œæ—¶ï¼Œæ— è®ºå½“å‰å†…å­˜æ˜¯å¦è¶³å¤Ÿï¼Œéƒ½ä¼šå›æ”¶æ‰åªè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ï¼Œå®ƒæ˜¯é€šè¿‡WeakReferenceç±»æ¥å®ç°å¼±å¼•ç”¨çš„ã€‚ è™šå¼•ç”¨ï¼šåªè¦å‘ç”Ÿåƒåœ¾å›æ”¶ï¼Œå®ƒå°±ä¼šè¢«æ”¶é›†ï¼Œå®ƒå”¯ä¸€çš„ç›®çš„å°±æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼Œå®ƒæ˜¯ç”¨è¿‡PhantomReferenceç±»æ¥å®ç°è™šå¼•ç”¨ã€‚ æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰çš„å›æ”¶ç±»å’Œå…¶å…ƒæ•°æ®çš„ç”Ÿå‘½å‘¨æœŸå’Œå…¶å¯¹åº”çš„ç±»åŠ è½½å™¨æ˜¯ç›¸åŒçš„ã€‚è¯å¥è¯è¯´ï¼Œåªè¦ç±»åŠ è½½å™¨å­˜æ´»ï¼Œå…¶åŠ è½½çš„ç±»çš„å…ƒæ•°æ®ä¹Ÿæ˜¯å­˜æ´»çš„ï¼Œå› è€Œä¸ä¼šè¢«å›æ”¶æ‰ã€‚å‡†ç¡®çš„æ¥è¯´ï¼Œæ¯ä¸€ä¸ªç±»åŠ è½½å™¨çš„å­˜å‚¨åŒºåŸŸéƒ½ç§°ä½œä¸€ä¸ªå…ƒç©ºé—´ï¼Œæ‰€æœ‰çš„å…ƒç©ºé—´åˆåœ¨ä¸€èµ·å°±æ˜¯æˆ‘ä»¬ä¸€ç›´è¯´çš„å…ƒç©ºé—´ã€‚å½“ä¸€ä¸ªç±»åŠ è½½å™¨è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ä¸ºä¸å†å­˜æ´»ï¼Œå…¶å¯¹åº”çš„å…ƒç©ºé—´ä¼šè¢«å›æ”¶ã€‚åœ¨å…ƒç©ºé—´çš„å›æ”¶è¿‡ç¨‹ä¸­æ²¡æœ‰é‡å®šä½å’Œå‹ç¼©ç­‰æ“ä½œã€‚ä½†æ˜¯å…ƒç©ºé—´å†…çš„å…ƒæ•°æ®ä¼šè¿›è¡Œæ‰«ææ¥ç¡®å®šJavaå¼•ç”¨ã€‚ åƒåœ¾æ”¶é›†ç®—æ³•æ ‡è®°-æ¸…é™¤ç®—æ³•æµç¨‹ï¼š æ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ åœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ ä¸è¶³ï¼š æ•ˆç‡é—®é¢˜ æ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªè¿‡ç¨‹æ•ˆç‡éƒ½ä¸é«˜ ç©ºé—´é—®é¢˜ æ ‡è®°æ¸…é™¤ä»¥åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„ç©ºé—´ç¢ç‰‡ï¼Œæ— æ³•å­˜å‚¨å¤§å¯¹è±¡ å¤åˆ¶ç®—æ³•æµç¨‹ï¼š å°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ†ä¸ºå¤§å°ç›¸åŒçš„ä¸¤å— åœ¨ç¬¬ä¸€å—åˆ†é…å†…å­˜ï¼Œå¹¶æ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ å½“ç¬¬ä¸€å—å†…å­˜ç”¨å®Œäº†ï¼Œå°†æ‰€æœ‰æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Š å°†ç¬¬ä¸€å—æ‰€ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ€§æ¸…é™¤ å¥½å¤„ï¼šè§£å†³äº†ç©ºé—´ç¢ç‰‡é—®é¢˜ ä¸è¶³ï¼šé™ä½äº†ç©ºé—´åˆ©ç”¨ç‡ ç°åœ¨çš„å•†ä¸šè™šæ‹Ÿæœºéƒ½ç”¨è¿™ç§æ”¶é›†ç®—æ³•æ¥å›æ”¶æ–°ç”Ÿä»£ï¼Œå› ä¸ºæ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡98%æ˜¯â€œæœç”Ÿå¤•æ­»â€çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦1:1åˆ’åˆ†ç©ºé—´,è€Œæ˜¯å°†å†…å­˜åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„Edenç©ºé—´å’Œä¸¤å—è¾ƒå°çš„Survivorç©ºé—´ï¼Œæ¯æ¬¡ä½¿ç”¨Edenå’Œå…¶ä¸­ä¸€å—Survivorã€‚å½“å›æ”¶æ—¶ï¼Œå°†Edenå’ŒSurvivorä¸­è¿˜æ´»ç€çš„å¯¹è±¡é‚£ä¸ªä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦ä¸€å—Survivorç©ºé—´ä¸Šï¼Œæœ€åæ¸…ç†æ‰å‰ä¸¤å—ç©ºé—´ã€‚HotSpotè™šæ‹Ÿæœºé»˜è®¤Edenå’ŒSurvivorçš„å¤§å°æ¯”ä¾‹ä¸º8:1ï¼Œæ‰€ä»¥åªæœ‰10%çš„å†…å­˜ä¼šè¢«â€œæµªè´¹â€ï¼Œå½“Survivorç©ºé—´ä¸å¤Ÿç”¨æ—¶ï¼Œéœ€è¦ä¾èµ–å…¶ä»–å†…å­˜ï¼ˆè¿™é‡ŒæŒ‡è€å¹´ä»£ï¼‰è¿›è¡Œåˆ†é…æ‹…ä¿ã€‚ å†…å­˜çš„åˆ†é…æ‹…ä¿æ˜¯æŒ‡å¦‚æœæ”¾ç€å­˜æ´»å¯¹è±¡çš„Survivorç©ºé—´æ²¡æœ‰è¶³å¤Ÿç©ºé—´æ”¾ä¸Šä¸€æ¬¡æ–°ç”Ÿä»£æ”¶é›†ä¸‹æ¥çš„å­˜æ´»å¯¹è±¡æ—¶ï¼Œè¿™äº›å¯¹è±¡å°†ç›´æ¥é€šè¿‡åˆ†é…æ‹…ä¿æœºåˆ¶è¿›å…¥è€å¹´ä»£ã€‚ æ ‡è®°-æ•´ç†ç®—æ³•é€‚åˆè€å¹´ä»£ æµç¨‹ï¼š æ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ ç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ åˆ†ä»£æ”¶é›†ç®—æ³•å°†å†…å­˜åˆ’åˆ†ä¸ºè€å¹´ä»£å’Œæ–°ç”Ÿä»£ã€‚è€å¹´ä»£ä¸­å­˜æ”¾å¯¿å‘½è¾ƒé•¿çš„å¯¹è±¡ï¼Œæ–°ç”Ÿä»£ä¸­å­˜æ”¾â€œæœç”Ÿå¤•æ­»â€çš„å¯¹è±¡ã€‚ç„¶ååœ¨ä¸åŒçš„åŒºåŸŸä½¿ç”¨ä¸åŒçš„åƒåœ¾æ”¶é›†ç®—æ³•ã€‚ æ€»ç»“ä»ä¸Šé¢æˆ‘ä»¬äº†è§£äº†å¯¹è±¡å­˜æ´»åˆ¤å®šç®—æ³•å’Œåƒåœ¾å›æ”¶ç®—æ³•ï¼Œä½†æ˜¯ä¸åŒè™šæ‹Ÿæœºçš„å…·ä½“å®ç°è¿˜æ˜¯ä¸åŒçš„ï¼Œè€Œä¸”ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨çš„å†…å­˜å›æ”¶çš„å…·ä½“å®ç°ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œæˆ‘ä»¬è¦å› æœºè€Œè®®ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ JDK8 ä»æ°¸ä¹…ä»£åˆ°å…ƒç©ºé—´]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_3_OutOfMemoryErrorå¼‚å¸¸ç°åœº]]></title>
    <url>%2F2017%2F11%2F29%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-3-OutOfMemoryError%E5%BC%82%E5%B8%B8%E7%8E%B0%E5%9C%BA%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¹‹å‰é¢å¯¹JVMè¿è¡Œå†…å­˜çš„åˆ†æï¼Œæ€»ä¼šæåˆ°å‡ºç°OutMemoryErrorå¼‚å¸¸ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†çœ‹ä¸‹å¸¸å‡ºç°è¿™ç§å¼‚å¸¸çš„ç°åœºã€‚ Javaå †æº¢å‡ºæˆ‘ä»¬é€šè¿‡é™åˆ¶Javaå †å¾—å¤§å°ä¸º20MB,ä¸å¯æ‰©å¼ ï¼ˆå°†å †å¾—æœ€å°å€¼-Xmså‚æ•°ä¸æœ€å¤§å€¼-Xmxå‚æ•°è®¾ç½®ä¸ºä¸€æ ·å³å¯é¿å…å †è‡ªåŠ¨æ‰©å±•ï¼‰ï¼Œé€šè¿‡å‚æ•°-XXï¼š+HeapDumpOnOutOfMemoryErrorå¯ä»¥è®©è™šæ‹Ÿæœºåœ¨å‡ºç°å†…å­˜æº¢å‡ºå¼‚å¸¸æ—¶Dumpï¼ˆå¤‡ä»½ï¼‰å‡ºå½“å‰çš„å†…å­˜å †è½¬å‚¨å¿«ç…§ä»¥ä¾¿æ—¶å€™åˆ†æå¤„ç†ã€‚ ä»£ç å¦‚ä¸‹ï¼š1234567891011121314//VM Args: -Xms20m -Xmx20m -XX:+HeapDumpOnOutOfMemoryErrorpublic class HeapOOM &#123; static class OOMobject &#123; &#125; public static void main(String[] args) &#123; List&lt;OOMobject&gt; list = new ArrayList&lt;&gt;(); while (true) &#123; list.add(new OOMobject()); &#125; &#125;&#125; è¿è¡Œç»“æœï¼š12345java.lang.OutOfMemoryError: Java heap spaceDumping heap to java_pid81611.hprof ...Heap dump file created [27573572 bytes in 0.121 secs]Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space at java.util.Arrays.copyOf(Arrays.java:3210)... æˆ‘ä»¬å¾ˆå®¹æ˜“åœ¨è¾“å‡ºç»“æœä¸­çœ‹åˆ°Java heap space OOMå‡ºç°åœ¨å †ä¸­ã€‚æˆ‘ä»¬è¦è§£å†³è¿™ä¸ªåŒºåŸŸçš„å¼‚å¸¸ä¸»è¦æ˜¯é€šè¿‡å†…å­˜æ˜ åƒåˆ†æå·¥å…·ï¼ˆå¾ˆå¤šï¼‰å¯¹Dumpå‡ºæ¥çš„å †è½¬å‚¨å¿«ç…§è¿›è¡Œåˆ†æï¼Œé‡ç‚¹ç¡®è®¤æ˜¯å†…å­˜æ³„æ¼ï¼ˆMemory leakï¼‰è¿˜æ˜¯å†…å­˜æº¢å‡ºï¼ˆMemory Overflowï¼‰ã€‚ å†…å­˜æ³„æ¼ï¼šè¢«åˆ†é…çš„å†…å­˜çš„å¯¹è±¡ä¸ä¼šè¢«å›æ”¶ï¼Œæ°¸ä¹…å æ®å†…å­˜ã€‚ è§£å†³æ–¹æ³•ï¼šé€šè¿‡å·¥å…·æŸ¥çœ‹æ³„æ¼å¯¹è±¡åˆ°GC Rootsçš„å¼•ç”¨é“¾ã€‚ å†…å­˜æº¢å‡ºï¼šæ— æ³•ç”³è¯·åˆ°å†…å­˜ã€‚ è§£å†³æ–¹æ³•ï¼šæ£€æŸ¥è™šæ‹Ÿæœºçš„å †å‚æ•°ï¼ˆ-Xmxä¸-Xmsï¼‰ï¼Œä¸æœºå™¨ç‰©ç†å†…å­˜å¯¹æ¯”çœ‹æ˜¯å¦è¿˜å¯ä»¥è°ƒå¤§ï¼Œä»ä»£ç ä¸Šæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŸäº›å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡é•¿çš„æƒ…å†µï¼Œå°è¯•å‡å°‘ç¨‹åºè¿è¡ŒæœŸçš„å†…å­˜æ¶ˆè€—ã€‚ è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆæº¢å‡ºæˆ‘ä»¬è¯´è¿‡HotSpotè™šæ‹Ÿæœºä¸­å¹¶ä¸åŒºåˆ†è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œæ‰€ä»¥è®¾ç½®æœ¬åœ°æ–¹æ³•æ ˆå¤§å°æ˜¯æ— æ•ˆçš„ï¼Œæ ˆå®¹é‡åªç”±-Xsså‚æ•°è®¾å®šï¼Œåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æè¿°äº†ä¸¤ç§å¼‚å¸¸ StackOverflowErrorå¼‚å¸¸ï¼šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æœ€å¤§æ·±åº¦ï¼Œå°†æŠ›å‡ºæ­¤å¼‚å¸¸ã€‚ OutOfMemoryErrorå¼‚å¸¸ï¼šå¦‚æœè™šæ‹Ÿæœºåœ¨æ‰©å±•æ ˆä½¿æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ï¼Œå°†æŠ›å‡ºæ­¤å¼‚å¸¸ã€‚ æˆ‘ä¸ªäººæƒ³å¦‚æœå•çº¿ç¨‹ä¸­æ ˆçš„å†…å­˜å¤§å°ç­‰äºæ€»å†…å­˜å¤§å°ï¼Œé‚£ä¹ˆä¸Šé¢ä¸¤ç§å¼‚å¸¸åº”è¯¥æ˜¯ç­‰ä»·çš„å§ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ã€‚æ‰€ä»¥å•çº¿ç¨‹ä¸­å‡ºç°å¾—åŸºæœ¬ä¸Šéƒ½æ˜¯StackOverflowErrorå¼‚å¸¸ã€‚ å•çº¿ç¨‹ä»£ç å¦‚ä¸‹ï¼š1234567891011121314// VM args: -Xss128kpublic class HeapOOM &#123; static class OOMobject &#123; &#125; public static void main(String[] args) &#123; List&lt;OOMobject&gt; list = new ArrayList&lt;&gt;(); while (true) &#123; list.add(new OOMobject()); &#125; &#125;&#125; è¿è¡Œç»“æœï¼š123stack lenth:18855Exception in thread &quot;main&quot; java.lang.StackOverflowError at com.todorex.demo.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:10) è¿™é‡ŒæŠ„ä¸€ä¸‹ä¹¦çš„ç»“è®ºï¼šåœ¨å•ä¸ªçº¿ç¨‹ä¸‹ï¼Œæ— è®ºæ˜¯ç”±äºæ ˆå¸§å¤ªå¤§è¿˜æ˜¯è™šæ‹Ÿæœºå®¹é‡å¤ªå°ï¼Œå½“å†…å­˜æ— æ³•åˆ†é…çš„æ—¶å€™ï¼Œè™šæ‹ŸæœºæŠ›å‡ºçš„éƒ½æ˜¯StackOverflowErrorå¼‚å¸¸ã€‚ å¤šçº¿ç¨‹ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425// VM args: -Xss2Mpublic class JavaVMStackOOM &#123; private void dontStop() &#123; while (true) &#123; &#125; &#125; public void stackLeakByThread() &#123; while (true) &#123; Thread thread = new Thread(new Runnable() &#123; @Override public void run() &#123; dontStop(); &#125; &#125;); thread.start(); &#125; &#125; public static void main(String[] args) &#123; JavaVMStackOOM javaVMStackOOM = new JavaVMStackOOM(); javaVMStackOOM.stackLeakByThread(); &#125;&#125; æˆ‘åœ¨è‡ªå·±çš„æœºå™¨ä¸Šæ²¡æœ‰è¿è¡Œå‡ºæ¥ï¼Œå¯èƒ½éœ€è¦ç‚¹æ—¶é—´ï¼Œä¸è¿‡æœºå™¨å˜å¡äº†ï¼Œæˆ‘æƒ³å…¶å®è¿™é‡Œè§£é‡Šä¸€ä¸‹å°±å¥½ï¼Œå®ƒåº”è¯¥ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ è§£é‡Šï¼šé¦–å…ˆæ“ä½œç³»ç»Ÿåˆ†ç»™æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ‰€ä»¥æ€»çš„æ–¹æ³•æ ˆçš„å¤§å°ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼Œä½†æ˜¯æ¯ä¸ªçº¿ç¨‹éƒ½éœ€è¦æ–¹æ³•æ ˆï¼Œæ‰€ä»¥çº¿ç¨‹å»ºç«‹çš„è¶Šå¤šï¼Œå‰©ä½™çš„æ–¹æ³•æ ˆå†…å­˜å°±è¶Šå°ï¼Œä¸€ç›´åˆ›å»ºçº¿ç¨‹ï¼Œè¿›ç¨‹æ‰€æ‹¥æœ‰çš„å†…å­˜ç»ˆå°†è¢«è€—å°½ï¼Œåˆ°æœ€åå°±ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æ³¨æ„ï¼šçº¿ç¨‹æ•°å’Œæ–¹æ³•æ ˆå¤§å°æ˜¯æˆåæ¯”çš„ï¼Œæ‰€ä»¥åœ¨å¼€å‘å¤šçº¿ç¨‹çš„åº”ç”¨æ—¶åº”è¯¥ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœä¸èƒ½å‡å°‘çº¿ç¨‹æ•°æˆ–è€…æ›´æ¢64ä½è™šæ‹Ÿæœºçš„æƒ…å†µä¸‹ï¼Œå°±åªèƒ½é€šè¿‡å‡å°‘æœ€å¤§å †å’Œå‡å°‘æ ˆå®¹é‡æ¥æ¢å–æ›´å¤šçš„çº¿ç¨‹äº†ã€‚ æ–¹æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰å’Œè¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡ºè¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡ºåœ¨ä¹‹å‰çš„åšå®¢ä¹Ÿæåˆ°è¿‡åœ¨jdk1.6ä»¥åŠä¹‹å‰è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ”¾åœ¨æ–¹æ³•åŒºä¸­çš„ï¼Œå­˜çš„æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®è™šæ‹Ÿæœºå‚æ•°-XX:PermSizeå’Œ-XX:MaxPermSizeæ¥é™åˆ¶æ–¹æ³•åŒºçš„å¤§å°ï¼Œæ¥æ¨¡æ‹Ÿå¸¸é‡æ± æº¢å‡ºï¼Œä½†æ˜¯jdk1.7åŠä»¥åè¿è¡Œæ—¶å¸¸é‡æ± è¢«ç§»é™¤äº†æ–¹æ³•åŒºï¼Œå¸¸é‡æ± å­˜å‚¨çš„ä¸å†æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼ŒçœŸæ­£çš„å¯¹è±¡å­˜å‚¨åœ¨å †ä¸­ï¼Œæˆ‘ä»¬æ”¹å˜è™šæ‹Ÿæœºå‚æ•°ä¸ºï¼š-Xms20m -Xmx20m -XX:+HeapDumpOnOutOfMemoryErrorè¿è¡Œä¸‹é¢ç¨‹åºï¼š1234567891011// VM args:-Xms20m -Xmx20m -XX:+HeapDumpOnOutOfMemoryErrorpublic class RuntimeConstantPoolOOM &#123; public static void main(String[] args) &#123; List&lt;String&gt; list = new ArrayList&lt;&gt;(); int i = 0; while (true) &#123; list.add(String.valueOf(i++).intern()); &#125; &#125;&#125; è¿è¡Œç»“æœï¼š123java.lang.OutOfMemoryError: GC overhead limit exceededDumping heap to java_pid10818.hprof ...Heap dump file created [25172419 bytes in 0.251 secs] ä¸Šé¢ç»“æœæç¤ºGCå¼€é”€è¶…è¿‡é™åˆ¶ï¼Œé»˜è®¤çš„è¯ï¼Œå¦‚æœä½ 98%çš„æ—¶é—´éƒ½èŠ±åœ¨GCä¸Šå¹¶ä¸”å›æ”¶äº†æ‰ä¸åˆ°2%çš„ç©ºé—´çš„è¯ï¼Œè™šæ‹Ÿæœºå°±ä¼šæŠ›è¿™ä¸ªå¼‚å¸¸ã€‚ å…¶å®æˆ‘ä»¬ä¹‹å‰ä¹Ÿæèµ·è¿‡åœ¨JDK1.8åŠä»¥åï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä»æ°¸ä¹…ä»£ç§»åˆ°åˆ°å…ƒç©ºé—´ä¸­ï¼Œå…ƒç©ºé—´ä¸æ°¸ä¹…ä»£ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šå…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ã€‚å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç©ºé—´çš„å¤§å°ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶ï¼Œä½†å¯ä»¥é€šè¿‡ä»¥ä¸‹å‚æ•°æ¥æŒ‡å®šå…ƒç©ºé—´çš„å¤§å°ï¼š-XX:MetaspaceSizeï¼Œåˆå§‹ç©ºé—´å¤§å°ï¼Œè¾¾åˆ°è¯¥å€¼å°±ä¼šè§¦å‘åƒåœ¾æ”¶é›†è¿›è¡Œç±»å‹å¸è½½ï¼ŒåŒæ—¶GCä¼šå¯¹è¯¥å€¼è¿›è¡Œè°ƒæ•´ï¼Œå¦‚æœé‡Šæ”¾äº†å¤§é‡çš„ç©ºé—´ï¼Œå°±é€‚å½“é™ä½è¯¥å€¼ï¼›å¦‚æœé‡Šæ”¾äº†å¾ˆå°‘çš„ç©ºé—´ï¼Œé‚£ä¹ˆåœ¨ä¸è¶…è¿‡MaxMetaspaceSizeæ—¶ï¼Œé€‚å½“æé«˜è¯¥å€¼ã€‚-XX:MaxMetaspaceSizeï¼Œæœ€å¤§ç©ºé—´ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚é™¤äº†ä¸Šé¢ä¸¤ä¸ªæŒ‡å®šå¤§å°çš„é€‰é¡¹ä»¥å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªä¸ GC ç›¸å…³çš„å±æ€§ï¼š-XX:MinMetaspaceFreeRatioï¼Œåœ¨GCä¹‹åï¼Œæœ€å°çš„Metaspaceå‰©ä½™ç©ºé—´å®¹é‡çš„ç™¾åˆ†æ¯”ï¼Œå‡å°‘ä¸ºåˆ†é…ç©ºé—´æ‰€å¯¼è‡´çš„åƒåœ¾æ”¶é›†ï¼Œ-XX:MaxMetaspaceFreeRatioï¼Œåœ¨GCä¹‹åï¼Œæœ€å¤§çš„Metaspaceå‰©ä½™ç©ºé—´å®¹é‡çš„ç™¾åˆ†æ¯”ï¼Œå‡å°‘ä¸ºé‡Šæ”¾ç©ºé—´æ‰€å¯¼è‡´çš„åƒåœ¾æ”¶é›†ï¼Œå…·ä½“éªŒè¯ä»£ç å¦‚ä¸‹ï¼š1234567891011// VM args: -XX:MetaspaceSize=4M -XX:MaxMetaspaceSize=4Mpublic class RuntimeConstantPoolOOM &#123; public static void main(String[] args) &#123; List&lt;String&gt; list = new ArrayList&lt;&gt;(); int i = 0; while (true) &#123; list.add(String.valueOf(i++).intern()); &#125; &#125;&#125; è¿è¡Œç»“æœï¼š12Error occurred during initialization of VMOutOfMemoryError: Metaspace å…³äºè¿™ä¸ªå­—ç¬¦ä¸²å¸¸é‡æ± çš„å®ç°é—®é¢˜ï¼Œè¿˜çœŸçš„ä¼šå‡ºç°ä¸€ä¸ªå¾ˆæ„æ€çš„é—®é¢˜æˆ–è€…è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ã€‚ä»£ç å¦‚ä¸‹ï¼š123456789101112131415// jdk:1.8public class RuntimeConstantPoolOOM &#123; public static void main(String[] args) &#123; String str1 = new StringBuilder("è®¡ç®—æœº").append("è½¯ä»¶").toString(); System.out.println(str1.intern() == str1); String str2 = new StringBuilder("ja").append("va").toString(); System.out.println(str2.intern() == str2); String str3 = new StringBuilder("ma").append("in").toString(); System.out.println(str3.intern() == str3); &#125;&#125; è¿è¡Œç»“æœï¼š123truefalsefalse jdk1.6ä¸­ï¼Œintern()æ–¹æ³•ä¼šæŠŠé¦–æ¬¡é‡åˆ°çš„å­—ç¬¦ä¸²å®ä¾‹å¤åˆ¶åœ¨æ°¸ä¹…ä»£ï¼Œè¿”å›çš„ä¹Ÿæ˜¯æ°¸ä¹…ä»£ä¸­è¿™ä¸ªå­—ç¬¦ä¸²å®ä¾‹çš„å¼•ç”¨ï¼Œè€Œç”±StringBuilderåˆ›å»ºçš„å­—ç¬¦ä¸²å®ä¾‹åœ¨Javaå †ä¸Šï¼Œæ‰€ä»¥å¿…ç„¶ä¸æ˜¯åŒä¸€ä¸ªå¼•ç”¨ã€‚è€Œåœ¨jdk1.7åŠä»¥åï¼Œintern()çš„å®ç°ä¸ä¼šå†å¤åˆ¶å®ä¾‹ï¼Œåªæ˜¯åœ¨å¸¸é‡æ± ä¸­è®°å½•é¦–æ¬¡å‡ºç°å¾—å®ä¾‹çš„å¼•ç”¨ï¼Œå› æ­¤intern()è¿”å›çš„ç”±StringBuilderåˆ›å»ºçš„é‚£ä¸ªå­—ç¬¦ä¸²æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼Œè€Œå…³äºä¸Šé¢çš„è¿è¡Œç»“æœï¼Œæˆ‘æƒ³javaå’Œmainä¹‹å‰éƒ½æ˜¯åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­éƒ½æœ‰ä»–çš„å¼•ç”¨äº†ï¼Œæ‰€ä»¥è¿”å›çš„éƒ½æ˜¯falseã€‚ æ–¹æ³•åŒºæº¢å‡ºæ–¹æ³•åŒºç”¨äºå­˜æ”¾Classçš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç±»åï¼Œè®¿é—®ä¿®é¥°ç¬¦ï¼Œå¸¸é‡æ± ï¼Œå­—æ®µæè¿°ï¼Œæ–¹æ³•æè¿°ç­‰ï¼ŒåŸºæœ¬çš„æ€è·¯æ˜¯è¿è¡Œæ—¶äº§ç”Ÿå¤§é‡çš„ç±»å»å¡«å……æ–¹æ³•åŒºï¼Œä¸‹é¢æ˜¯å€ŸåŠ©CGLibï¼ˆcglibå’Œasmçš„ä¾èµ–æœ‰ä¸ªå‘ï¼Œé€‰æ‹©cglib2.2,asm3.1äº²æµ‹å¯ç”¨ï¼‰æ¥æ“ä½œå­—èŠ‚ç è¿è¡Œæ—¶ç”Ÿæˆå¤§é‡çš„åŠ¨æ€ç±»ï¼Œè¿™ç§åœºæ™¯åœ¨Springï¼ŒHibernateä¸­ç»å¸¸å‡ºç°ï¼Œéœ€è¦å¤šæ³¨æ„ï¼Œæœ¬äººä½¿ç”¨çš„JDK1.8ï¼Œæ‰€ä»¥æµ‹è¯•çš„æ˜¯æ–¹æ³•åŒºçš„å˜è¿å…ƒç©ºé—´ï¼Œä»£ç å®ç°å¦‚ä¸‹ï¼š123456789101112131415161718192021222324// VM args:-XX:MetaspaceSize=4M -XX:MaxMetaspaceSize=4Mpublic class JavaMethodAreaOOM &#123; public static void main(String[]args) &#123; while (true) &#123; Enhancer enhancer = new Enhancer(); enhancer.setSuperclass(OOMObject.class); enhancer.setUseCache(false); enhancer.setCallback(new MethodInterceptor() &#123; public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable &#123; return methodProxy.invokeSuper(o, objects); &#125; &#125;); OOMObject oomObject = (OOMObject) enhancer.create(); oomObject.sayHi(); &#125; &#125; static class OOMObject&#123; public void sayHi()&#123; System.out.println("hi"); &#125; &#125;&#125; ç»“æœè¾“å‡ºï¼š12Error occurred during initialization of VMOutOfMemoryError: Metaspace è¿™ç±»å¼‚å¸¸ç»å¸¸å‡ºç°åœ¨webåº”ç”¨ä¸­ï¼Œéœ€è¦å¤šæ³¨æ„ã€‚ æœ¬æœºç›´æ¥å†…å­˜æº¢å‡ºDirectMemoryå®¹é‡å¯é€šè¿‡-XX:MaxDirectMemorySizeæŒ‡å®šï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸Javaå †æœ€å¤§å€¼ï¼ˆ-XmxæŒ‡å®šï¼‰ä¸€æ ·ï¼Œåœ¨ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ä¸­ç”¨äº†ä»¥ä¸‹ä»£ç ï¼š1234567891011121314// VM args:-Xmx20M -XX:MaxDirectMemorySize=10Mpublic class DirectMemoryOOM &#123; private static final int _1MB = 1024*1024; public static void main(String[] args) throws Exception&#123; Field unsafeField = Unsafe.class.getDeclaredFields()[0]; unsafeField.setAccessible(true); Unsafe unsafe = (Unsafe) unsafeField.get(null); while (true) &#123; unsafe.allocateMemory(_1MB); &#125; &#125;&#125; ä½†æ˜¯åœ¨è‡ªå·±ç”µè„‘ä¸­æ²¡æœ‰è¿è¡ŒæˆåŠŸï¼Œåè€Œè®©è‡ªå·±çš„ç”µè„‘æ­»æœºäº†ï¼Œè¿™ä¸ªåœ°æ–¹è¿˜æ˜¯æ²¡æœ‰å¼„æ‡‚ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Œå¸Œæœ›æ‡‚çš„å¤§ä½¬ç»™æˆ‘ç‚¹æ”¯æŒã€‚ è¿™ä¸ªå¼‚å¸¸åœ¨ä½¿ç”¨NIOä¸­å¯èƒ½ä¼šå‡ºç°ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦å¤šæ³¨æ„ã€‚ æ€»ç»“åœ¨æ€»ç»“å¾—è¿‡ç¨‹ä¸­ï¼ŒçŸ¥é“äº†å„ä¸ªå†…å­˜åŒºåŸŸå¯èƒ½ä¼šå‡ºç°OOMçš„æƒ…å†µï¼Œé‡è¦çš„æ˜¯äº†è§£äº†æ–¹æ³•åŒºåœ¨jdk1.6åˆ°1.7åˆ°1.8çš„å˜è¿ï¼Œæœ‰å…´è¶£çš„äººå¯ä»¥æ·±å…¥äº†è§£ã€‚ å‚è€ƒ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ CGLIBä»‹ç»ä¸åŸç† Java8å†…å­˜æ¨¡å‹â€”æ°¸ä¹…ä»£(PermGen)å’Œå…ƒç©ºé—´(Metaspace) æ·±å…¥æ¢ç©¶JVM | æ¢ç§˜Metaspace]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_2_HotSpotå¯¹è±¡æ­ç§˜]]></title>
    <url>%2F2017%2F11%2F21%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-2-HotSpot%E5%AF%B9%E8%B1%A1%E6%8F%AD%E7%A7%98%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ€»æœ‰äº›äººä¼šæ€è€ƒå¯¹è±¡æ˜¯å¦‚æœåˆ›å»ºã€å¦‚ä½•å¸ƒå±€ã€ä»¥åŠå¦‚ä½•è®¿é—®çš„ï¼Ÿå¯¹äºè¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠè®¨è®ºèŒƒå›´é™å®šåœ¨å…·ä½“çš„è™šæ‹Ÿæœºå’Œé›†ä¸­åœ¨æŸä¸€ä¸ªå†…å­˜åŒºåŸŸæ‰æœ‰æ„ä¹‰ã€‚åŸºäºå®ç”¨åŸåˆ™ï¼Œæˆ‘ä»¬ä»¥å¸¸ç”¨çš„è™šæ‹ŸæœºHotSpotå’Œå¸¸ç”¨çš„å†…å­˜åŒºåŸŸJavaå †ä¸ºä¾‹ã€‚ å¯¹è±¡çš„åˆ›å»ºJavaç¨‹åºåˆ›å»ºå¯¹è±¡ä¸è¿‡æ˜¯ä¸€ä¸ªnewå…³é”®å­—è€Œå·²ï¼Œè€Œåœ¨è™šæ‹Ÿæœºä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡å´ç»å†äº†ä¸€ç³»åˆ—è¿‡ç¨‹ã€‚ è™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡newæŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆå»æ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°ä¸€ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šæŠ›å‡ºClassNotFoundExceptionï¼Œå¹¶ä¸”æ£€æŸ¥è¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½ã€è§£æå’Œåˆå§‹åŒ–è¿‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£å¿…é¡»å…ˆæ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹ã€‚ ç±»åŠ è½½æ£€æŸ¥é€šè¿‡åï¼Œè™šæ‹Ÿæœºä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ï¼Œå¯¹è±¡æ‰€éœ€å†…å­˜çš„å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯ä»¥å®Œå…¨ç¡®å®šã€‚ è¿™é‡Œæœ‰ä¸¤ç§å†…å­˜åˆ†é…æ–¹å¼ï¼šï¼ˆç”±é‡‡ç”¨çš„åƒåœ¾æ”¶é›†å™¨æ˜¯å¦å¸¦æœ‰å‹ç¼©æ•´ç†çš„åŠŸèƒ½å†³å®šï¼‰ æŒ‡é’ˆç¢°æ’ å‡è®¾Javaå †çš„å†…å­˜æ˜¯ç»å¯¹è§„æ•´çš„ï¼Œæ‰€æœ‰ç”¨è¿‡çš„å†…å­˜éƒ½æ”¾åœ¨ä¸€è¾¹ï¼Œç©ºé—²çš„å†…å­˜æ”¾åœ¨å¦ä¸€è¾¹ï¼Œä¸­é—´æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºåˆ†ç•Œç‚¹çš„æŒ‡ç¤ºå™¨ï¼Œé‚£æ‰€åˆ†é…å†…å­˜å°±ä»…ä»…æ˜¯æŠŠé‚£ä¸ªæŒ‡é’ˆå‘ç©ºé—²ç©ºé—´é‚£è¾¹æŒªåŠ¨ä¸€æ®µä¸å¯¹è±¡å¤§å°ç›¸ç­‰çš„è·ç¦»ã€‚ ç©ºé—²åˆ—è¡¨ å‡å¦‚Javaå †ä¸­çš„å†…å­˜å¹¶ä¸æ˜¯å®Œæ•´çš„ï¼Œå·²ä½¿ç”¨çš„å†…å­˜å’Œç©ºé—²çš„å†…å­˜ç›¸äº’äº¤é”™ï¼Œè™šæ‹Ÿæœºå°±å¿…é¡»ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œè®°å½•é‚£äº›å†…å­˜å—æ˜¯å¯ç”¨çš„ï¼Œåœ¨åˆ†é…çš„æ—¶å€™ä»åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´åˆ’åˆ†ç»™å®ä¾‹ï¼Œå¹¶æ›´æ–°åˆ—è¡¨ä¸Šçš„è®°å½•ã€‚ è§£å†³åœ¨å¹¶å‘æƒ…å†µä¸‹ä¸å®‰å…¨çš„æ–¹æ¡ˆ: å¯¹åˆ†é…å†…å­˜ç©ºé—´çš„åŠ¨ä½œè¿›è¡ŒåŒæ­¥å¤„ç†â€”â€”è™šæ‹Ÿæœºé‡‡ç”¨CASé…ä¸Šå¤±è´¥é‡è¯•çš„æ–¹å¼ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ æŠŠå†…å­˜åˆ†é…çš„åŠ¨ä½œæŒ‰çº¿ç¨‹åˆ’åˆ†åœ¨ä¸åŒçš„ç©ºé—´ä¹‹ä¸­è¿›è¡Œï¼Œå³æ¯ä¸ªçº¿ç¨‹åœ¨Javaå †ä¸­é¢„å…ˆåˆ†é…ä¸€å°å—å†…å­˜ï¼Œç§°ä¸ºæœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²ï¼Œåªæœ‰éœ€è¦é‡æ–°åˆ†é…çš„æ—¶å€™æ‰åŒæ­¥é”å®š è™šæ‹Ÿæœºå°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆé»˜è®¤åˆå§‹åŒ–ï¼‰ï¼Œä¿è¯äº†å¯¹è±¡å®ä¾‹åœ¨Javaä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±å¯ä»¥ä½¿ç”¨ã€‚ è®¾ç½®å¯¹è±¡å¤´ åˆ©ç”¨æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ– å¯¹è±¡çš„å†…å­˜å¸ƒå±€å¯¹è±¡å¤´ å­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼ˆå“ˆå¸Œç ï¼ŒGCåˆ†ä»£å¹´é¾„ã€é”çŠ¶æ€æ ‡å¿—ã€çº¿ç¨‹æŒæœ‰çš„é”ã€åå‘çº¿ç¨‹IDã€åå‘æ—¶é—´æˆ³ç­‰ï¼‰ï¼Œå®˜æ–¹ç§°ä¸ºâ€œMark Wordâ€ï¼Œå®ƒè¢«è®¾è®¡æˆä¸€ä¸ªéå›ºå®šçš„æ•°æ®ç»“æ„ä»¥ä¾¿åœ¨æå°çš„ç©ºé—´å†…å­˜å‚¨å°½é‡å¤šçš„ä¿¡æ¯ï¼Œä»–ä¼šæ ¹æ®å¯¹è±¡çš„çŠ¶æ€å¤ç”¨è‡ªå·±çš„å­˜å‚¨ç©ºé—´ï¼Œå…·ä½“è§ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ã€‚ ç±»å‹æŒ‡é’ˆï¼ˆå¯é€‰ï¼‰å³å¯¹è±¡æŒ‡å‘å®ƒçš„å…ƒæ•°æ®ï¼ˆæ–¹æ³•åŒºï¼‰çš„æŒ‡é’ˆï¼Œè™šæ‹Ÿæœºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ æ•°ç»„é•¿åº¦ï¼ˆå¯é€‰ï¼‰å¦‚æœå¯¹è±¡æ˜¯ä¸€ä¸ªJavaæ•°ç»„ï¼Œé‚£åœ¨å¯¹è±¡å¤´ä¸­è¿˜å¿…é¡»æœ‰ä¸€å—ç”¨äºè®°å½•æ•°ç»„é•¿åº¦çš„æ•°æ®ï¼Œå› ä¸ºè™šæ‹Ÿæœºå¯ä»¥é€šè¿‡æ™®é€šjavaå¯¹è±¡å…ƒæ•°æ®ä¿¡æ¯ç¡®å®šJavaå¯¹è±¡çš„å¤§å°ï¼Œä½†æ˜¯ä»æ•°ç»„æ•°æ®æ— æ³•ç¡®å®šæ•°æ®å¤§å° å®ä¾‹æ•°æ®å­˜å‚¨æ‰€æœ‰æˆå‘˜å˜é‡ï¼Œæ— è®ºæ˜¯çˆ¶ç±»ç»§æ‰¿ä¸‹æ¥çš„ï¼Œè¿˜æ˜¯åœ¨å­ç±»å®šä¹‰çš„ã€‚ å­˜å‚¨é¡ºåºä¼šå—åˆ°è™šæ‹Ÿæœºåˆ†é…ç­–ç•¥å‚æ•°å’Œå­—æ®µåœ¨æºç å®šä¹‰çš„é¡ºåºçš„å½±å“ã€‚HotSpoté»˜è®¤çš„åˆ†é…ç­–ç•¥ä¸ºç›¸åŒç‹‚èµŒçš„å­—æ®µæ€»æ˜¯è¢«åˆ†é…åˆ°ä¸€èµ·ï¼ˆå¦‚longå’Œdoubleï¼‰ï¼Œåœ¨è¿™ä¸ªå‰æä¸‹ï¼Œçˆ¶ç±»å…ˆäºå­ç±»ï¼Œè‹¥CompactFieldså‚æ•°ä¸ºtrueï¼Œé‚£ä¹ˆå­ç±»ä¹‹ä¸­è¾ƒçª„çš„å˜é‡ä¹Ÿå¯èƒ½æ’å…¥åˆ°çˆ¶ç±»å˜é‡çš„ç©ºéš™ä¸­ï¼ˆæ˜¯å› ä¸ºä¸€ä¸ªslotå¤ªå¤§ï¼‰ å¯¹é½å¡«å……ï¼ˆå¯é€‰ï¼‰èµ·åˆ°å ä½ç¬¦çš„ä½œç”¨ï¼Œç¡®ä¿å¯¹è±¡çš„é•¿åº¦ä¸º8å­—èŠ‚çš„æ•´æ•°å€ HotSpot VMçš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿè¦æ±‚å¯¹è±¡èµ·å§‹ä½ç½®å¿…é¡»æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ï¼Œç”±äºå¯¹è±¡å¤´ä¸€å®šæ˜¯8å­—èŠ‚çš„æ•´æ•°å€ï¼Œæ‰€ä»¥åˆ©ç”¨å ä½ç¬¦å¯ä»¥è¾¾åˆ°æ•°æ®éƒ¨åˆ†ä¹Ÿæ˜¯8å­—èŠ‚çš„æ•´æ•°å€ã€‚ä»è€Œè¾¾åˆ°å¯¹è±¡çš„é•¿åº¦æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ã€‚ï¼ˆæœ‰ç‚¹ç»•å£å•Šï¼Œå“ˆå“ˆï¼‰ å¯¹è±¡çš„è®¿é—®å®šä½æˆ‘ä»¬é€šå¸¸éƒ½ä¼šä½¿ç”¨Javaå¯¹è±¡ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šéƒ½æ˜¯é€šè¿‡è™šæ‹Ÿæœºæ ˆä¸Šçš„referenceæ•°æ®æ¥æ“ä½œå †ä¸Šçš„å…·ä½“å¯¹è±¡ï¼Œè€Œæ ˆä¸Šåªæ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ï¼Œå¯¹è±¡çš„å…·ä½“è®¿é—®æ–¹å¼å–å†³äºè™šæ‹Ÿæœºï¼Œç›®å‰æœ‰ä»¥ä¸‹ä¸¤ç§è®¿é—®æ–¹å¼ï¼š é€šè¿‡å¥æŸ„è®¿é—®å¯¹è±¡å¯ä»¥çœ‹ä¸‹é¢çš„å›¾ï¼šä½¿ç”¨å¥æŸ„è®¿é—®ï¼ŒJavaå †ä¸­ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜æ¥ä½œä¸ºå¥æŸ„æ± ï¼Œreferenceå­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªçš„å…·ä½“åœ°å€ä¿¡æ¯ã€‚ é€šè¿‡ç›´æ¥æŒ‡é’ˆè®¿é—®å¯¹è±¡å¯ä»¥çœ‹ä¸‹é¢çš„å›¾ï¼šä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®ï¼ŒJavaå †å¯¹è±¡çš„å¸ƒå±€ä¸­å°±è¦è€ƒè™‘å¦‚ä½•æ”¾ç½®è®¿é—®ç±»å‹æ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œreferenceä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡åœ°å€ã€‚ ä¸¤è€…å¯¹æ¯” é€šè¿‡å¥æŸ„è®¿é—®å¯¹è±¡å¯ä»¥å½“å¯¹è±¡è¢«ç§»åŠ¨ä¹‹ååªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œreferenceæœ¬èº«ä¸éœ€è¦æ”¹å˜ã€‚ ä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®å¯ä»¥åŠ å¿«Javaå¯¹è±¡çš„è®¿é—®ï¼ŒHotSpotå°±æ˜¯ä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®å¯¹è±¡çš„æ–¹å¼ã€‚ æ€»ç»“è¿™é‡Œè®²çš„å¯¹è±¡é‡ç‚¹è¿˜æ˜¯åœ¨è™šæ‹Ÿæœºæ‰§è¡Œéƒ¨åˆ†ï¼Œå…³äºClassæ–‡ä»¶çš„è®²è§£æ²¡æœ‰æ¶‰åŠåˆ°ï¼Œä½†å®ƒå´æ˜¯ååˆ†é‡è¦çš„ï¼Œæ—¥åä¼šæåŠã€‚ å‚è€ƒ æ·±å…¥ç†è§£JVM(äºŒ)â€”â€”æ­å¼€HotSpotå¯¹è±¡åˆ›å»ºçš„å¥¥ç§˜]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£JVM_1_JVMå†…å­˜æ¨¡å‹]]></title>
    <url>%2F2017%2F11%2F20%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%2F%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM-1-JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ€»æ˜¯æåˆ°å †å‘€ï¼Œæ ˆå‘€ï¼Œå¸¸é‡æ± å‘€ï¼Œä½†æ˜¯Javaè™šæ‹Ÿæœºå†…çš„Javaæ¨¡å‹å´æ€»æ˜¯ç†è§£ä¸æ¸…æ¥šï¼Œè¿™æ¬¡å°±æ€»ç»“ä¸€ä¸‹ã€‚ Javaå†…å­˜æ¨¡å‹ç»„æˆè¿™é‡Œè®²çš„æ˜¯Javaè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠå®ƒæ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†äº”å¤§åŒºåŸŸã€‚ ç¨‹åºè®¡ç®—å™¨ Javaè™šæ‹Ÿæœºæ ˆ æœ¬åœ°æ–¹æ³•æ ˆ Javaå † æ–¹æ³•åŒº ä¸‹é¢ä¹ŸæŠŠæ¥è‡ªæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºçš„å›¾ç‰‡è´´ä¸€ä¸‹ï¼š æ¥ç€æˆ‘ä»¬é‡ç‚¹ç†è§£ä¸€ä¸‹è¿™äº”å¤§åŒºåŸŸã€‚ ç¨‹åºè®¡æ•°å™¨ä»€ä¹ˆæ˜¯ç¨‹åºè®¡æ•°å™¨ ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œä»–å¯ä»¥çœ‹åšå½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚ å¦‚æœçº¿ç¨‹åœ¨æ‰§è¡Œä¸€ä¸ªJavaæ–¹æ³•çš„æ—¶å€™ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼Œå¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨å€¼åˆ™ä¸ºç©ºã€‚ ç¨‹åºè®¡æ•°å™¨çš„ä½œç”¨ å•çº¿ç¨‹çš„æ—¶å€™ï¼šé€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œä»è€Œå®ç°åˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹å›å¤ç­‰åŸºç¡€åŠŸèƒ½ã€‚ å¤šçº¿ç¨‹çš„æ—¶å€™ï¼šå½“æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œåˆ™çº¿ç¨‹åˆ‡æ¢åå°±èƒ½å›å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ã€‚PSï¼š Javaè™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢å¹¶åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ–¹å¼æ¥å®ç°çš„ã€‚ ç¨‹åºè®¡æ•°å™¨çš„ç‰¹ç‚¹ å­˜å‚¨ç©ºé—´è¾ƒå° çº¿ç¨‹ç§æœ‰ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ å”¯ä¸€ä¸€ä¸ªæ²¡æœ‰è§„å®šä»»ä½•OutOfMemoryErroræƒ…å†µçš„åŒºåŸŸ ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ Javaè™šæ‹Ÿæœºæ ˆä»€ä¹ˆæ˜¯Javaè™šæ‹Ÿæœºæ ˆJavaè™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼ˆåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯¹è±¡å¼•ç”¨å’ŒreturnAddress,å…¶ä¸­longå’Œdoubleä¼šå æ®2ä¸ªå±€éƒ¨å˜é‡ç©ºé—´ï¼Œå…¶ä»–åªå ç”¨ä¸€ä¸ªï¼‰ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚ Psï¼š äººä»¬å¸¸è¯´çš„Javaå†…å­˜åŒºåˆ†ä¸ºâ€œå †â€å’Œâ€œæ ˆâ€ï¼Œâ€œå †â€å­˜æ”¾å¯¹è±¡ï¼ˆå¯ä»¥ï¼‰ï¼Œâ€œæ ˆâ€åªæ˜¯å€¼å…¶ä¸­çš„å±€éƒ¨å˜é‡è¡¨ï¼ˆä¸å¯ä»¥ï¼‰ï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„ã€‚ Javaè™šæ‹Ÿæœºæ ˆçš„ç‰¹ç‚¹ çº¿ç¨‹ç§æœ‰ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ è™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œä¹Ÿå¯ä»¥å›ºå®šé•¿åº¦ï¼Œåœ¨åŠ¨æ€æ‰©å±•çš„æ—¶å€™å¦‚æœæ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œå°±ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ æœ¬åœ°æ–¹æ³•æ ˆä»€ä¹ˆæ˜¯æœ¬åœ°æ–¹æ³•æ ˆæœ¬åœ°æ–¹æ³•æ ˆæè¿°çš„æ˜¯æœ¬åœ°æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œå®ƒå‘æŒ¥çš„ä½œç”¨ä¸è™šæ‹Ÿæœºæ ˆå‘æŒ¥çš„ä½œç”¨æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œå¦‚Sun HotSpotè™šæ‹Ÿæœºç›´æ¥æŠŠæœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ï¼Œå®ƒä¸è™šæ‹Ÿæœºæ ˆä¸€æ ·ï¼Œæœ¬åœ°æ–¹æ³•æ ˆåŒºåŸŸä¹Ÿä¼šæŠ›å‡ºStackOverflowErrorå’ŒOutOfMemoryErrorå¼‚å¸¸ã€‚ Javaå †ä»€ä¹ˆæ˜¯Javaå † Javaå †æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹çš„å†…å­˜åŒºåŸŸ å‡ ä¹æ‰€æœ‰å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ Javaå †çš„ç‰¹ç‚¹ Javaè™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å— çº¿ç¨‹å…±äº«ï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»º åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œä»å†…å­˜å›æ”¶çš„è§’åº¦æ¥çœ‹ï¼Œç”±äºç°åœ¨æ”¶é›†å™¨éƒ½é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œæ‰€ä»¥å¯åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œå†ç»†è‡´ä¸€ç‚¹å¯ä»¥åˆ†ä¸ºEdenç©ºé—´ã€From Survivorç©ºé—´å’ŒTo Survivorç©ºé—´ç­‰ã€‚ä»å†…å­˜åˆ†é…æ¥çœ‹ï¼Œçº¿ç¨‹å…±äº«çš„Javaå †å¯èƒ½åˆ’åˆ†å‡ºå¤šä¸ªçº¿ç¨‹ç§æœ‰çš„åˆ†é…ç¼“å­˜åŒºTLAB,è¿›ä¸€æ­¥åˆ’åˆ†çš„ç›®çš„æ˜¯ä¸ºäº†æ›´å¥½åœ°å›æ”¶å†…å­˜ï¼Œæˆ–è€…æ›´å¿«çš„åˆ†é…å†…å­˜ å®ç°ä¸­å¯ä»¥å›ºå®šå¤§å°ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯æ‰©å±•çš„ï¼Œå¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜å®Œæˆå®ä¾‹çš„åˆ†é…ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•å†æ‰©å±•æ—¶ï¼Œå°±ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ æ–¹æ³•åŒºä»€ä¹ˆæ˜¯æ–¹æ³•åŒº Javaè™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ã€‚ ä»–ç”¨äºå­˜å‚¨è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç  æ–¹æ³•åŒºçš„ç‰¹ç‚¹ çº¿ç¨‹å…±äº«ï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»º æ°¸ä¹…ä»£æ˜¯å› ä¸ºHotSpoté€‰æ‹©å°†GCåˆ†ä»£æ”¶é›†å™¨æ‰©å±•åˆ°æ–¹æ³•åŒºï¼Œæˆ–è€…ä½¿ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºï¼Œå¯¹äºHotSpotå®˜æ–¹å‘å¸ƒçš„è·¯çº¿å›¾ä¿¡æ¯ï¼Œç°åœ¨ä¹Ÿæœ‰æ”¾å¼ƒæ°¸ä¹…ä»£é€æ­¥é‡‡ç”¨Native Memoryæ¥å®ç°æ–¹æ³•åŒºçš„è§„åˆ’äº†ï¼Œå¹¶ä¸”å·²ç»æŠŠåŸæœ¬æ”¾åœ¨æ°¸ä¹…ä»£çš„å­—ç¬¦ä¸²å¸¸é‡æ± ç§»é™¤ ä¸éœ€è¦è¿ç»­çš„å†…å­˜ï¼Œå¯ä»¥é€‰æ‹©å›ºå®šå¤§å°æˆ–è€…å¯æ‰©å±•ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä¸å®ç°åƒåœ¾å›æ”¶ å†…å­˜å›æ”¶çš„ä¸»è¦ç›®æ ‡ä¸»è¦æ˜¯é’ˆå¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»å‹çš„å¸è½½ï¼Œä½†æ˜¯å›æ”¶æ•ˆç‡ä½ å½“æ–¹æ³•åŒºæ— æ³•æ»¡è¶³å†…å­˜åˆ†é…çš„éœ€æ±‚çš„æ—¶å€™ï¼Œå°†æŠ›å‡ºOutOfMemoryErrorçš„å¼‚å¸¸ è¿è¡Œæ—¶å¸¸é‡æ±  Classæ–‡ä»¶é™¤äº†åŒ…å«ç±»çš„ç‰ˆæœ¬å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯å¸¸é‡æ±  å¸¸é‡æ± ç”¨äºå­˜æ”¾ç¼–è¯‘æœŸé—´ç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹åœ¨ç±»åŠ è½½åè¿›å…¥è¿è¡Œæ—¶å¸¸é‡æ± ä¸­å­˜æ”¾ è¿è¡Œæ—¶å¸¸é‡æ± ç›¸å¯¹äºClassæ–‡ä»¶å¸¸é‡æ± å…·æœ‰åŠ¨æ€æ€§ï¼ŒJavaè¯­è¨€ä¸è¦æ±‚åªæœ‰Classæ–‡ä»¶ä¸­çš„å¸¸é‡æ± çš„å†…å®¹æ‰èƒ½è¿›å…¥è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œè¿è¡Œæ—¶ä¹Ÿå¯èƒ½å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼Œå¦‚Stringç±»çš„internæ–¹æ³• å½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·å†…å­˜æ—¶å°†ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ PSï¼š jdk1.7çš„å¸¸é‡æ± ç§»åˆ°äº†å †ä¸­ï¼ŒåŒæ—¶åœ¨jdk1.8ä¸­ç§»é™¤æ•´ä¸ªæ°¸ä¹…ä»£ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¸€ä¸ªå«å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰çš„åŒºåŸŸ ç›´æ¥å†…å­˜ é€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨Javaå †ä¸­çš„DirectByteBufferå¯¹è±¡æœ€ä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œï¼Œè¿™ä¸ªå¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åœ¨Javaå †å’ŒNativeå †ä¸­æ¥å›å¤åˆ¶æ•°æ® æ¡ˆä¾‹æ˜¯NIOç±»å¼•å…¥ä¸€ç§åŸºäºé€šé“ä¸ç¼“å­˜åŒºçš„I/Oæ–¹å¼ï¼Œå®ƒå¯ä»¥ä½¿ç”¨Nativeå‡½æ•°åº“ç›´æ¥åˆ†é…å¯¹å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡DirectByteBufferè¿›è¡Œæ“ä½œ æœ¬æœºç›´æ¥å†…å­˜çš„åˆ†é…ä¸ä¼šå—åˆ°Javaå †å¤§å°çš„é™åˆ¶ï¼Œä½†æ˜¯ä¼šå—åˆ°æœ¬æœºæ€»å†…å­˜å¤§å°å’Œå¤„ç†å™¨å¯»å€ç©ºé—´çš„é™åˆ¶ï¼Œä¹Ÿå¯èƒ½ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ æ€»ç»“æœ¬ç¯‡æ–‡ç« æ˜¯å‚è€ƒã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ç¬¬äºŒç‰ˆæ‰€å†™ï¼Œå½“æ—¶ä½œè€…ç”¨çš„æ˜¯jdk1.7ï¼Œç»“æœç°åœ¨jdk1.9éƒ½å‡ºäº†ï¼Œæœ€å¤§çš„æ”¹å˜å°±æ˜¯æ–¹æ³•åŒºäº†ï¼Œç›®å‰è¿˜æ²¡æœ‰èƒ½åŠ›æ”¹æ­£ï¼Œä¹Ÿå°±å°†å°±äº†ï¼Œæœ›ä½œè€…æ—©æ—¥æ›´æ–°ï¼Œæˆ–è€…è‡ªå·±æˆä¸ºå¤§ç‰›ï¼Œå°†è¿™éƒ¨åˆ†é‡æ–°æ•´ç†ã€‚ å‚è€ƒ æ·±å…¥ç†è§£JVM(ä¸€)â€”â€”JVMå†…å­˜æ¨¡å‹ Java 8: ä»æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰åˆ°å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰]]></content>
      <categories>
        <category>æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº</category>
      </categories>
      <tags>
        <tag>JVM</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[springbooté™æ€èµ„æºçš„å¤„ç†]]></title>
    <url>%2F2017%2F10%2F20%2F%E7%BC%96%E7%A8%8B%2Fspringboot%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9A%84%E5%A4%84%E7%90%86%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç”±äºspringbootæ¶æ„é‡åˆ°äº†å›¾ç‰‡çš„ä¸Šä¼ å¤„ç†ï¼Œä»¥åŠä¹‹åçš„å‰å°æ˜¾ç¤ºï¼Œæ‰€ä»¥å°±ç†è§£äº†ä¸€ä¸‹å…¶ä¸­å…³äºé™æ€èµ„æºçš„å¤„ç†ã€‚ é»˜è®¤çš„é™æ€èµ„æºå¤„ç†åœ¨æ¯æ¬¡å¯åŠ¨springbootçš„é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åœ¨æ§åˆ¶å°çœ‹è§ä¸‹é¢çš„è¯­å¥è¾“å‡ºï¼š1232017-10-20 16:06:50.540 INFO 36443 --- [ restartedMain] o.s.w.s.handler.SimpleUrlHandlerMapping : Mapped URL path [/webjars/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]2017-10-20 16:06:50.540 INFO 36443 --- [ restartedMain] o.s.w.s.handler.SimpleUrlHandlerMapping : Mapped URL path [/**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]2017-10-20 16:06:50.569 INFO 36443 --- [ restartedMain] o.s.w.s.handler.SimpleUrlHandlerMapping : Mapped URL path [/**/favicon.ico] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler] è¿™é‡Œé¢å°±ç”¨åˆ°äº†springbooté»˜è®¤çš„é™æ€èµ„æºå¤„ç†ã€‚ å…¶ä¸­é»˜è®¤é…ç½®çš„/**æ˜ å°„åˆ°/staticï¼ˆæˆ–/publicã€/resourcesã€/META-INF/resourcesï¼‰ å…¶ä¸­é»˜è®¤é…ç½®çš„/webjars/**æ˜ å°„åˆ°classpath:/META-INF/resources/webjars/ PSï¼šä¸Šé¢çš„ staticã€publicã€resources ç­‰ç›®å½•éƒ½åœ¨ classpath: ä¸‹é¢ï¼ˆå¦‚ src/main/resources/staticï¼‰ åœ¨è®¿é—®é™æ€èµ„æºçš„æ—¶å€™ï¼Œè¿™äº›ç›®å½•ä¹Ÿä¼šæœ‰ä¸€ä¸ªæŸ¥æ‰¾é¡ºåºï¼ˆä¼˜å…ˆçº§ï¼‰ï¼šè¿™é‡Œæµ‹è¯•è¿‡å‘ç°ä»–ä»¬çš„ä¼˜å…ˆçº§æ˜¯ï¼šMETA/resources &gt; resources &gt; static &gt; public è‡ªå®šä¹‰é™æ€èµ„æºå¤„ç†é…ç½®æ–¹å¼ é€šè¿‡é…ç½®æ–‡ä»¶ï¼ˆapplication.propertiesï¼‰é…ç½®1234# é»˜è®¤å€¼ä¸º /**spring.mvc.static-path-pattern=# é»˜è®¤å€¼ä¸º classpath:/META-INF/resources/,classpath:/resources/,classpath:/static/,classpath:/public/ spring.resources.static-locations=è¿™é‡Œè®¾ç½®è¦æŒ‡å‘çš„è·¯å¾„ï¼Œå¤šä¸ªä½¿ç”¨è‹±æ–‡é€—å·éš”å¼€ï¼Œ å½“æˆ‘ä»¬è¦è®¾ç½®æˆæˆ‘ä»¬çš„ç›®å½•ï¼š/myresource/**ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·è®¾ç½®:12spring.mvc.static-path-pattern=/**spring.resources.static-locations=classpath:/META-INF/resources/,classpath:/resources/,classpath:/static/,classpath:/public/,classpath:/myresource/ å½“æˆ‘ä»¬è®¾ç½®è¿‡æ˜ å°„è·¯å¾„æ—¶å€™ï¼Œå¦‚æœè¿˜æ˜¯/**,é‚£ä¹ˆé»˜è®¤çš„æ˜ å°„å°±å¤±æ•ˆäº†ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°æŠŠåŸæ¥çš„è·¯å¾„ä¹Ÿæ·»åŠ ä¸Šã€‚è¿™é‡Œçš„é…ç½®è·¯å¾„åªå¯ä»¥è®¾ç½®ä¸€ä¸ªã€‚ é€šè¿‡é…ç½®ç±»é…ç½®12345678@Configurationpublic class MyWebAppConfigurer extends WebMvcConfigurerAdapter&#123; @Override public void addResourceHandlers(ResourceHandlerRegistry registry) &#123; registry.addResourceHandler("/myresource/**").addResourceLocations("file:/var/alldata/image/"); super.addResourceHandlers(registry); &#125;&#125; å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹å¼è®¾ç½®å¤šä¸ªé…ç½®è·¯å¾„ã€‚ é…ç½®å†…å¤–ç›®å½• å†…éƒ¨ç›®å½• åšæ³•æ˜¯æ·»åŠ æ˜ å°„è·¯å¾„ classpath:/è·¯å¾„ æ–¹å¼è§é€šè¿‡é…ç½®æ–‡ä»¶é…ç½® å¤–éƒ¨ç›®å½• æƒ³ä¸€æƒ³å¦‚æœå°†ä¸Šä¼ çš„å›¾ç‰‡ç»§ç»­å­˜åœ¨jaråŒ…ä¸­ä¼šæœ‰é‚£äº›é—®é¢˜ï¼Ÿ ç½‘ç»œæ•°æ®ä¸ç¨‹åºä»£ç ä¸èƒ½åˆ†ç¦» æ•°æ®ä¼ åˆ°jaré‡Œé€Ÿåº¦æ…¢ æ•°æ®å¤‡ä»½éº»çƒ¦ æœ‰äº†ä»¥ä¸Šçš„è€ƒè™‘æˆ‘ä»¬ä¼šæƒ³åˆ°å°†ä¸Šä¼ çš„æ•°æ®æ”¾åœ¨ç£ç›˜çš„ç›®å½•ä¸Šã€‚ åšæ³•æ˜¯æ·»åŠ æ˜ å°„è·¯å¾„ file:/var/alldata/images æ–¹å¼è§é€šè¿‡é…ç½®ç±»é…ç½® æ€»ç»“springbootå€¡å¯¼çš„æ˜¯ä¹ æƒ¯ä¼˜äºé…ç½®ï¼Œå¤§éƒ¨åˆ†æ—¶å€™æˆ‘ä»¬ç”¨ä»–é»˜è®¤çš„é…ç½®å°±å¥½äº†ï¼Œä½†æ˜¯ä»–ä¹Ÿæä¾›äº†æ–¹ä¾¿çš„é…ç½®ç±»ï¼Œéœ€è¦æˆ‘ä»¬å¥½å¥½å­¦ä¹ ã€‚ å‚è€ƒ Spring Boot é™æ€èµ„æºå¤„ç† Springboot ä¹‹ é™æ€èµ„æºè·¯å¾„é…ç½®]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>springboot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[macä¸­ç¯å¢ƒå˜é‡çš„é…ç½®]]></title>
    <url>%2F2017%2F09%2F21%2F%E5%B7%A5%E5%85%B7%2Fmac%E4%B8%AD%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨ä½¿ç”¨ubuntuå’Œmacè¿™ä¹ˆä¹…ä¹‹åï¼Œç¯å¢ƒå˜é‡çš„å‡ ä¸ªæ–‡ä»¶è¿˜å¼„ä¸æ¸…æ¥šï¼ŒçœŸæ˜¯æ±—é¢œï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ï¼Œä¸‹æ¬¡ä¸ä¼šä¹±æ”¹ã€‚ ç¯å¢ƒå˜é‡çš„ä½œç”¨ ä½¿ç”¨åœºæ™¯åœ¨å‘½ä»¤è¡Œç›´æ¥é€šè¿‡å‘½ä»¤æ‰§è¡Œç¨‹åºï¼Œè¿™äº›ç¨‹åºå°±å¤šäº†ï¼Œæœ€å¸¸è§å°±æœ‰javaï¼Œnpmï¼Œmavenï¼Œgit,å¦‚æœæˆ‘ä»¬ä¸é…ç½®ç¯å¢ƒå˜é‡çš„è¯ï¼Œå°±éœ€è¦åˆ°ç¨‹åºçš„å®‰è£…ç›®å½•å»æ‰§è¡Œç›¸å…³å‘½ä»¤ï¼Œå¤§å®¶éƒ½ä¼šæ„Ÿè§‰è¶…çº§éº»çƒ¦ï¼ŒåŠ å…¥è¦ä½¿ç”¨å¤šä¸ªç¨‹åºçš„è¯ï¼Œè¦ä¹ˆå»åˆ‡æ¢ç›®å½•ï¼Œè¦ä¹ˆå°±å¤šå¼€å‡ ä¸ªå‘½ä»¤è¡Œçª—å£ã€‚é¡¿æ—¶å°±ä¼šæ„Ÿè§‰è¶…çº§æ— å¥ˆæœ‰ä¹ˆæœ‰ï¼Ÿ å…·ä½“ä½œç”¨é…ç½®å®Œç¨‹åºçš„ç¯å¢ƒå˜é‡ä¹‹åå°±å¯ä»¥æ— æ‰€æ¬²ä¸ºäº†ï¼Œå¯ä»¥åœ¨ä»»ä½•ç›®å½•ä¸‹ç›´æ¥æ‰§è¡Œæˆ‘ä»¬æ‰€è¦çš„ç¨‹åºäº†ï¼Œæ˜¯ä¸æ˜¯é¡¿æ—¶æ„Ÿè§‰æ–¹ä¾¿è®¸å¤šï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰äººéƒ½çŸ¥é“å§ã€‚ ç¯å¢ƒå˜é‡çš„é…ç½®å•æ¬¡ç¯å¢ƒå˜é‡é…ç½®å‡å¦‚ä½ å‡ºäº†ä¸ªæ„å¤–ï¼Œåœ¨å‘½ä»¤è¡Œä¸­çªç„¶ä¸èƒ½ä½¿ç”¨å„ç§å‘½ä»¤äº†ï¼Œä¹Ÿæ²¡äº‹ï¼Œè‡³å°‘æ¥ä¸‹æ¥å¯ä»¥è®©ä½ çŸ­æš‚çš„ä½¿ç”¨ä¸€äº›å‘½ä»¤ï¼Œå‘½ä»¤è¡Œçª—å£å…³é—­ä¹‹åå°±å¤±æ•ˆäº†ï¼Œæˆ‘ä»¬è¦åšçš„åªæ˜¯ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š export PATH=/usr/bin:/usr/sbin:/bin:/sbin å½“ç„¶åé¢ä½ ä¹Ÿèƒ½å¤Ÿæ·»åŠ ä¸€äº›ä½ è‡ªå·±æƒ³è¦ä½¿ç”¨çš„ç¨‹åºå‘½ä»¤ã€‚ ç¯å¢ƒå˜é‡æ–‡ä»¶é…ç½® ç¯å¢ƒå˜é‡çš„å†™æ³• export PATH=$JAVA_HOME/bin:$PATH ç¯å¢ƒå˜é‡æ–‡ä»¶ä¼˜å…ˆçº§ /etc/profile /etc/bashrc /etc/paths ~/.bash_profile ~/.bash_login ~/.profile ~/.bashrcå…¶å®åä¸‰ä¸ªæ–‡ä»¶æˆ‘ä¹Ÿæ²¡æ€ä¹ˆçœ‹åˆ°è¿‡ï¼Œä¸»è¦è®²ä¸€ä¸‹å‰é¢ä¸‰ä¸ª ç¯å¢ƒå˜é‡æ–‡ä»¶è¯¦è§£ /etc/profileï¼šå…¨å±€é…ç½®æ–‡ä»¶ï¼Œä¸ç®¡æ˜¯å“ªä¸€ä¸ªç”¨æˆ·ç™»å½•ï¼Œéƒ½ä¼šè¯»å–è¯¥æ–‡ä»¶ï¼ˆä½†æ˜¯è¶…çº§ä¸å»ºè®®ä¿®æ”¹ï¼Œå®¹æ˜“å‡ºç°å¤§é—®é¢˜ï¼Œæƒ³è¯•è¯•ä»€ä¹ˆå¤§é—®é¢˜ï¼Œè‡ªå·±ä½“ä¼šï¼‰ /etc/bashrc å…¨å±€é…ç½®æ–‡ä»¶ï¼Œbash shellæ‰§è¡Œæ—¶ï¼Œä¸ç®¡æ˜¯ä½•ç§æ–¹å¼ï¼Œéƒ½ä¼šè¯»å–æ­¤æ–‡ä»¶ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç³»ç»Ÿçº§ç¯å¢ƒå˜é‡ï¼‰ ~/.bash_profileï¼šæ¯ä¸ªç”¨æˆ·éƒ½å¯ä½¿ç”¨è¯¥æ–‡ä»¶è¾“å…¥ä¸“ç”¨äºè‡ªå·±ä½¿ç”¨çš„shellä¿¡æ¯,å½“ç”¨æˆ·ç™»å½•æ—¶,è¯¥æ–‡ä»¶ä»…ä»…æ‰§è¡Œä¸€æ¬¡!ï¼ˆä¸€èˆ¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ç”¨æˆ·çº§ç¯å¢ƒå˜é‡ï¼‰ ç«‹å³ç”Ÿæ•ˆç¯å¢ƒå˜é‡é…ç½® source ~/.bash_profile è½¯è¿æ¥è‡ªå·±ä¸€å¼€å§‹ä¹Ÿä¼šç‰¹åˆ«çš„æƒŠè®¶ï¼Œè‡ªå·±åœ¨macä¸Šæ²¡æœ‰è®¾ç½®ç¯å¢ƒå˜é‡æœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥ç›´æ¥å°±è®¿é—®åˆ°äº†æŸäº›æ–‡ä»¶ã€‚è¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ç”¨äº†è½¯è¿æ¥ã€‚ æŸ¥çœ‹åŠ è½½æ–‡ä»¶rexdeMacBook-Pro:etc rex$ cat /etc/paths /usr/local/bin /usr/bin /bin /usr/sbin /sbin ç„¶åå°±å¯ä»¥å»çœ‹è¿™äº›æ–‡ä»¶å¤¹ä¸‹é¢çš„ä¸œè¥¿äº†ï¼Œå¼„ä¸æ¸…æ¥šä¹Ÿæ²¡å…³ç³»ï¼Œå…¶å®å°±æ˜¯è½¯é“¾æ¥ã€‚å¼€æœºåï¼Œmacä¼šè‡ªåŠ¨åŠ è½½pathsæ–‡ä»¶ä¸‹é¢çš„è¿™äº›ç›®å½•ã€‚åœ¨è¿™äº›æ–‡ä»¶å¤¹ä¸‹é¢å»ºç«‹è½¯è¿æ¥ï¼Œå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼ˆæ—¥åå­¦ä¹ ï¼‰ã€‚ è½¯è¿æ¥æŸ¥çœ‹åœ¨æ‹¥æœ‰è½¯è¿æ¥çš„ç›®å½•ä¸‹ä½¿ç”¨ä¸‹é¢å‘½ä»¤ ls -li 406876 lrwxr-xr-x 1 root wheel 73 7 9 2016 jar -&gt; /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/jar 406877 lrwxr-xr-x 1 root wheel 79 7 9 2016 jarsigner -&gt; /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/jarsigner 406878 lrwxr-xr-x 1 root wheel 74 7 9 2016 java -&gt; /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/java 406879 lrwxr-xr-x 1 root wheel 75 7 9 2016 javac -&gt; /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/javac 406880 lrwxr-xr-x 1 root wheel 77 7 9 2016 javadoc -&gt; /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/javadoc å»ºç«‹è½¯è¿æ¥ç­‰è‡ªå·±çœ‹äº†linuxçš„ç›¸å…³çŸ¥è¯†å†æ¥è¯´å§ã€‚ æ€»ç»“å¸Œæœ›ä¸‹æ¬¡è‡ªå·±å†ä¹Ÿä¸è¦å› ä¸ºç¯å¢ƒå˜é‡é…ç½®é”™å‡ºå„ç§é—®é¢˜äº†ï¼Œthanks godï¼ å‚è€ƒï¼šMac ä¸­ç¯å¢ƒå˜é‡çš„é…ç½®å’Œç†è§£]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>mac</tag>
        <tag>ç¯å¢ƒå˜é‡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Github Pages+Hexo SEOå¼•æ“ä¼˜åŒ–]]></title>
    <url>%2F2017%2F07%2F16%2F%E5%B7%A5%E5%85%B7%2FGithub-Pages-Hexo-SEO%E5%BC%95%E6%93%8E%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå†™çš„åšå®¢è‡ªç„¶æƒ³è®©äººçœ‹åˆ°ï¼Œä½†æ˜¯ä½†æ˜¯è‡ªå·±ä¸ºäº†æƒ³ç‹¬ç«‹ç®¡ç†ï¼ˆå† å†•å ‚çš‡ï¼‰é€‰æ‹©äº†GIthub Pages+Hexoæ¥æ­å»ºè‡ªå·±çš„åšå®¢ï¼Œç»“æœå‘ç°è‡ªå·±çš„åšå®¢åœ¨ç™¾åº¦ï¼Œè°·æ­Œéƒ½æ— æ³•æœåˆ°ï¼Œé‚£æ—¶å€™æˆ‘æ‰çŸ¥é“è‡ªå·±ç¼ºå°‘äº†SEOã€‚ ç™¾åº¦ä¼˜åŒ–ç™»å½•ç™¾åº¦ç«™é•¿ åœ¨é‡Œé¢æˆ‘ä»¬å¯ä»¥å‘ç°å„ç§å‘ç™¾åº¦æäº¤çš„æ–¹æ³•ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†è®©ç™¾åº¦çš„çˆ¬è™«æ›´å¥½çš„çˆ¬å–æˆ‘ä»¬çš„ç½‘é¡µã€‚ é€šè¿‡baidumapsite.xmlè‡ªåŠ¨æäº¤ è¿™é‡Œæ¨èä¸€ä¸ªåšæ–‡ï¼šHexo NexT ä¸»é¢˜SEOä¼˜åŒ–æŒ‡å— é€šè¿‡ä¸»åŠ¨æäº¤ è¿™é‡Œæ¨èä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼šexoæ’ä»¶ä¹‹ç™¾åº¦ä¸»åŠ¨æäº¤é“¾æ¥ è°·æ­Œä¼˜åŒ–ç™»å½•è°·æ­Œç«™é•¿ é€šè¿‡map.siteè‡ªåŠ¨æäº¤ è¿™é‡Œé¢æ¨èä¸€ä¸ªåšæ–‡ï¼šç”Ÿæˆsitemapç«™ç‚¹åœ°å›¾ æ€»ç»“è‡ªå·±åœ¨è°·æ­Œé…ç½®æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯åœ¨ç™¾åº¦å¹¶æ²¡æœ‰æˆåŠŸï¼Œå¯èƒ½æ˜¯å› ä¸ºgithubçœŸçš„æŠŠç™¾åº¦ç»™å¹²äº†ã€‚è‡ªå·±è¿˜æ˜¯ç­‰å¼€å­¦è½¬åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå§ã€‚æ…¢æ…¢SEOï¼ï¼ï¼ï¼ PS:Hexoåšå®¢çš„æ­å»ºçš„å¯ä»¥å‚è€ƒè¿™ä¸€ç¯‡ æ­å»ºHexoåšå®¢ä¸­ç¢°åˆ°çš„å‘]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>seo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ–°ç³»ç»Ÿå¼€å‘ç¯å¢ƒçš„ä¸€ç³»åˆ—é…ç½®]]></title>
    <url>%2F2017%2F07%2F15%2F%E7%94%9F%E6%B4%BB%2F%E6%96%B0%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E7%9A%84%E4%B8%80%E7%B3%BB%E5%88%97%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ€»æ˜¯ä¸å¯é¿å…çš„é‡è£…ç³»ç»Ÿï¼Œäººçš„è„‘å­ä¸å¯èƒ½é‚£ä¹ˆå¥½è®°ä½æ‰€æœ‰çš„æ“ä½œï¼Œæ—¢ç„¶ä¸æƒ³è‡ªå·±è‡ªå·±ç”¨åšå®¢è®°ä¸‹æ‰€æœ‰æ“ä½œï¼Œé‚£ä¹ˆå°±æŠŠåˆ«äººçš„åšå®¢ï¼ˆè‡ªå·±è¸©è¿‡ï¼‰è®°å½•ä¸‹æ¥ï¼Œä»¥åå¤‡ç”¨ã€‚ windowç¯‡ JDKâ€”â€”javaå¼€å‘è€…èµ·æ­¥ JDKçš„å®‰è£…ä¸ç¯å¢ƒå˜é‡çš„é…ç½® Nodeâ€”â€”å‰ç«¯å¥½åŸºå‹ Node.jså®‰è£…åŠç¯å¢ƒé…ç½®ä¹‹Windowsç¯‡ Sublime3â€”â€”è½»é‡çº§ç¼–è¾‘å™¨ Sublime Text3å®‰è£…ä¸æ’ä»¶é…ç½® gitâ€”â€”åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶å·¥å…· Gitå®‰è£…æ•™ç¨‹ Ideaâ€”â€”javaå¼€å‘åˆ©å™¨ IntelliJ IDEAæ³¨å†Œç  Mavenâ€”â€”é¡¹ç›®ä¾èµ–ç®¡ç†åˆ©å™¨ Maven Windows10å®‰è£… Macç¯‡å¾…å†™ Ubuntuç¯‡å¾…å†™ åŒç³»ç»ŸWin10å’ŒUbuntu16.04åŒç³»ç»Ÿå®‰è£…è¯¦è§£]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>ç³»ç»Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æµ…å°Apache Camel]]></title>
    <url>%2F2017%2F07%2F15%2F%E7%BC%96%E7%A8%8B%2F%E6%B5%85%E5%B0%9DApache-Camel%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæœ€è¿‘é¡¹ç›®æœ‰ä¸€ä¸ªéœ€æ±‚å°±æ˜¯å®šæ—¶å°†ä¸€å°æœåŠ¡å™¨çš„æ–‡ä»¶ä¼ åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¸€å¼€å§‹æƒ³çš„ç«Ÿç„¶æƒ³çš„æ˜¯ç”¨httpå»ä¸‹è½½ï¼Œåæ¥åœ¨ä¸‡è€å¸ˆçš„æŒ‡ç‚¹ä¸‹ï¼Œé‡‡å–ç”¨ftpæœåŠ¡å™¨ï¼ˆæºæ–‡ä»¶æ‰€åœ¨åœ°ï¼‰ä¸ftpå®¢æˆ·ç«¯ï¼ˆæºæ–‡ä»¶å»å‘ï¼‰çš„å½¢å¼æ¥å¤„ç†ï¼Œè‡ªå·±å°è¯•äº†ä¸€ä¸‹ï¼Œè¿˜ä¸é”™ï¼ Apache Camelç®€ä»‹Apache Camelæ˜¯ApacheåŸºé‡‘ä¼šä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®,å®ƒæ˜¯ä¸€ä¸ªåŸºäºè§„åˆ™è·¯ç”±å’Œå¤„ç†çš„å¼•æ“ï¼Œæä¾›ä¼ä¸šé›†æˆæ¨¡å¼çš„Javaå¯¹è±¡çš„å®ç°ï¼Œé€šè¿‡åº”ç”¨ç¨‹åºæ¥å£ æˆ–ç§°ä¸ºé™ˆè¿°å¼çš„Javaé¢†åŸŸç‰¹å®šè¯­è¨€(DSL)æ¥é…ç½®è·¯ç”±å’Œå¤„ç†çš„è§„åˆ™ã€‚å…¶æ ¸å¿ƒçš„æ€æƒ³å°±æ˜¯ä»ä¸€ä¸ªfromæºå¤´å¾—åˆ°æ•°æ®,é€šè¿‡processorå¤„ç†,å†å‘åˆ°ä¸€ä¸ªtoç›®çš„çš„ã€‚ è¿™ä¸ªfromå’Œtoå¯ä»¥æ˜¯æˆ‘ä»¬åœ¨é¡¹ç›®é›†æˆä¸­ç»å¸¸ç¢°åˆ°çš„ç±»å‹:ä¸€ä¸ªFTPæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶,ä¸€ä¸ªMQçš„queueï¼ˆjmsï¼‰,ä¸€ä¸ªHTTP request/response,ä¸€ä¸ªwebserviceç­‰ç­‰. Apache Camelæ¶æ„ å…¶å®ç†è§£èµ·æ¥å¾ˆç®€å•ï¼šå§‹ç«¯ã€‹ï¼ˆè¿‡æ»¤å™¨+è·¯ç”±å¤„ç†å™¨ï¼‰ã€‹ç»ˆç«¯ Apache Camelæ ¸å¿ƒæ¦‚å¿µ endpoint,æ‰€è°“çš„endpoint,å°±æ˜¯ä¸€ç§å¯ä»¥æ¥æ”¶æˆ–å‘é€æ•°æ®çš„ç»„ä»¶ã€‚å¯ä»¥æ”¯æŒå¤šç§åè®®ï¼Œå¦‚jms,http,fileç­‰ã€‚ processor,å®ƒæ˜¯ç”¨æ¥å¤„ç†å…·ä½“ä¸šåŠ¡é€»è¾‘çš„ç»„ä»¶ã€‚ route,ç”¨æ¥è·¯ç”±ï¼ŒæŒ‡ç¤ºæ•°æ®ä»å“ªé‡Œæ¥åˆ°å“ªé‡Œå»ï¼Œä¸­é—´ç”¨å“ªä¸ªprocessorå¤„ç†ã€‚ exchange,processorä¹‹é—´ç”¨exchangeå¯¹è±¡æ¥ä¼ é€æ•°æ®ï¼Œæœ‰ç‚¹åƒjms,é€šä¿—ä¸€ç‚¹å°±åƒä¸Šå­¦æ—¶ä¼ çš„å°çº¸æ¡,æ‰€ä»¥ï¼šexchangeå¯¹è±¡å°±æ˜¯processorï¼Œendpointæ‰€æœ‰camelç»„ä»¶ä¹‹é—´ä¼ é€æ•°æ®çš„å°çº¸æ¡:)ã€‚ filterï¼Œç”¨æ¥ç¡®å®šå“ªäº›ä¸œè¥¿å¯ä»¥ä¼ é€’ï¼Œå“ªäº›ä¸œè¥¿ä¸å¯ä»¥ä¼ é€’ã€‚ Apache Camelä¾‹å­ï¼ˆä»¥ftpä¸ºä¾‹ï¼‰è€å¸ˆæŒ‡å¯¼çš„ä¾‹å­ï¼Œæ˜¯ç»“åˆSpringbootçš„ï¼Œæ”¾åœ¨githubä¸Šäº†ã€‚ApacheCamleDemo é‡Œé¢åŒ…æ‹¬äº†åŠ¨æ€è·¯ç”±å’Œå•è·¯ç”±çš„ä¾‹å­ï¼Œç¨å¾®ç»“åˆSpringbootå°±å¯ä»¥ç†è§£å¹¶æ”¹æˆè‡ªå·±çš„ä»£ç ã€‚ ä»€ä¹ˆæ—¶å€™ç”¨Apache Camelå‚è€ƒç½‘ä¸Šçš„è¯´æ³•ï¼šcamelå°±æ˜¯ä¼ä¸šä¿¡æ¯é›†æˆæ¡†æ¶ï¼Œå®ƒæä¾›äº†å¾ˆå¤šç®€å•å¥½ç”¨è€Œåˆå¼ºå¤§çš„ç»„ä»¶ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®åœºæ™¯æ¥é€‰æ‹©ä¸åŒçš„EIPï¼ˆä¼ä¸šé›†æˆæ¨¡å¼ï¼‰æ¥å®ç°è‡ªå·±çš„éœ€æ±‚ï¼Œä»¥å“åº”å¿«é€Ÿå˜åŒ–çš„ä¸šåŠ¡ã€‚å¯ä»¥æŠŠå®ƒå½“æˆä¼ä¸šä¿¡æ¯æ€»çº¿ï¼ˆESBï¼‰çš„è½»é‡çº§å®ç°ã€‚]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>Springboot</tag>
        <tag>ApacheCamel</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[java ftp ä¸Šä¼ ä¸‹è½½çš„å‘]]></title>
    <url>%2F2017%2F07%2F15%2F%E7%BC%96%E7%A8%8B%2Fjava-ftp-%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%9D%91%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šè¿˜æ˜¯é¡¹ç›®éœ€è¦ï¼Œè¦å®šæ—¶æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ä¸‹è½½ä¸šåŠ¡ï¼Œä¸€å¼€å§‹æ–¹å‘æœ‰ç‚¹é”™ï¼Œä½†æ˜¯è¿˜å¥½çº æ­£è¿‡æ¥äº†ï¼Œé‡‡ç”¨ftpä¸‹è½½ï¼Œä½†æ˜¯ftpä¸‹è½½ä¹Ÿæœ‰å„ç§å‘ï¼ å‡†å¤‡jaråŒ…ï¼šcommons-net ftpä¸Šä¼ ç¨‹åºï¼š1234567891011121314151617181920212223242526272829303132333435363738public static boolean uploadFile( String url,//æœåŠ¡å™¨ä¸»æœºå· int port,//æœåŠ¡å™¨ç«¯å£ String username,//ç”¨æˆ·å String password,//å¯†ç  String path, //ä¸Šä¼ è·¯å¾„Mar String filename,//ä¸Šä¼ ä¸ºæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å InputStream //inputæœ¬åœ°ä¸Šä¼ çš„æ–‡ä»¶æµ) &#123; boolean success = false; FTPClient ftp = new FTPClient(); try &#123; int reply;MarkDown ftp.connect(url, port);//è¿æ¥FTPæœåŠ¡å™¨ //å¦‚æœé‡‡ç”¨é»˜è®¤ç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨ftp.connect(url)çš„æ–¹å¼ç›´æ¥è¿æ¥FTPæœåŠ¡å™¨ ftp.login(username, password);//ç™»å½• reply = ftp.getReplyCode(); if (!FTPReply.isPositiveCompletion(reply)) &#123; ftp.disconnect(); return success; &#125; ftp.changeWorkingDirectory(path); ftp.storeFile(filename, input); input.close(); ftp.logout(); success = true; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; finally &#123; if (ftp.isConnected()) &#123; try &#123; ftp.disconnect(); &#125; catch (IOException ioe) &#123; &#125; &#125; &#125; return success;&#125; æµ‹è¯•ä»£ç ï¼š123File file = new File(&quot;/var/test.txt&quot;);InputStream is = new FileInputStream(file);uploadFile(&quot;127.0.0.1&quot;,21,&quot;test&quot;,&quot;123456&quot;,&quot;/var/data/test&quot;,&quot;testdemo.txt&quot;,is); ftpä¸‹è½½ç¨‹åºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263public static boolean downFile(String url, //FTPæœåŠ¡å™¨hostnameint port,//FTPæœåŠ¡å™¨ç«¯å£String username, //FTPç™»å½•è´¦å·String password, //FTPç™»å½•å¯†ç String remotePath,//FTPæœåŠ¡å™¨ä¸Šçš„ç›¸å¯¹è·¯å¾„String fileName,//è¦ä¸‹è½½æ–‡ä»¶å…³é”®å­—String localPath//ä¸‹è½½åä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„) &#123; FTPClient ftpClient = null; boolean success = false; try &#123; ftpClient = new FTPClient(); ftpClient.connect(url, port);// è¿æ¥FTPæœåŠ¡å™¨ ftpClient.login(username, password);// ç™»é™†FTPæœåŠ¡å™¨ ftpClient.setControlEncoding("gb2312"); // ä¸­æ–‡æ”¯æŒ ftpClient.setFileType(FTPClient.BINARY_FILE_TYPE);//è®¾ç½®æ–‡ä»¶æ ¼å¼ ftpClient.enterLocalPassiveMode(); logger.info(ftpClient.getReplyCode()); if (!FTPReply.isPositiveCompletion(ftpClient.getReplyCode())) &#123; logger.warn("æœªè¿æ¥åˆ°FTPï¼Œç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ã€‚"); ftpClient.disconnect(); &#125; else &#123; logger.info("FTPè¿æ¥æˆåŠŸã€‚"); &#125; ftpClient.changeWorkingDirectory(remotePath); FTPFile[] fs = ftpClient.listFiles(); File file = new File(localPath); if(!file.exists())&#123; file.mkdirs(); &#125; for(FTPFile ff:fs)&#123; if(ff.getName().contains(fileName))&#123; File localFile = new File(localPath+"/"+ff.getName()); if (localFile.exists())&#123; continue; &#125; OutputStream os = new FileOutputStream(localFile); long time1 = System.currentTimeMillis(); boolean b = ftpClient.retrieveFile(new String(ff.getName().getBytes("gb2312"),"ISO8859-1"), os); os.flush(); os.close(); &#125; &#125; ftpClient.logout(); success = true; &#125; catch (SocketException e) &#123; e.printStackTrace(); logger.warn("FTPçš„IPåœ°å€å¯èƒ½é”™è¯¯ï¼Œè¯·æ­£ç¡®é…ç½®ã€‚"); &#125; catch (IOException e) &#123; e.printStackTrace(); logger.warn("FTPçš„ç«¯å£é”™è¯¯,è¯·æ­£ç¡®é…ç½®ã€‚"); &#125; finally &#123; if (ftpClient.isConnected()) &#123; try &#123; ftpClient.disconnect(); &#125; catch (IOException ioe) &#123; &#125; &#125; &#125; return success;&#125; æµ‹è¯•ç¨‹åºï¼š1downFile(&quot;127.0.0.1&quot;,21,&quot;test&quot;,&quot;123456&quot;,&quot;ã€var/data/test&quot;,&quot;demo&quot;,&quot;/var/alldata&quot;); ä¸€äº›å‘ å®¢æˆ·ç«¯æ¥å—çš„ç¼–ç  1ftpClient.setControlEncoding(&quot;gb2312&quot;); // ä¸­æ–‡æ”¯æŒ å¦‚æœæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶åæœ‰ä¸­æ–‡ï¼Œä¸€å®šè¦åŠ ä¸Šè¿™ä¸€å¥ï¼Œå…·ä½“ç¼–ç è¦æ ¹æ®æœåŠ¡å™¨çš„ç¼–ç ã€‚ å®¢æˆ·ç«¯æ¥å—çš„æ–‡ä»¶ç±»å‹ 1ftpClient.setFileType(FTPClient.BINARY_FILE_TYPE);//è®¾ç½®æ–‡ä»¶æ ¼å¼ æ–‡ä»¶ç±»å‹è¦æ ¹æ®ä¸‹è½½çš„æ–‡ä»¶æ ¼å¼æ¥å®š æœåŠ¡å™¨ç«¯å£è®¾ç½® 1ftpClient.enterLocalPassiveMode(); è°ƒç”¨FTPClient.enterLocalPassiveMode();è¿™ä¸ªæ–¹æ³•çš„æ„æ€å°±æ˜¯æ¯æ¬¡æ•°æ®è¿æ¥ä¹‹å‰ï¼Œftp clientå‘Šè¯‰ftp serverå¼€é€šä¸€ä¸ªç«¯å£æ¥ä¼ è¾“æ•°æ®ï¼Œé˜²æ­¢åœ¨æ–°ç«¯å£å¯¹å¤–éƒ¨ä¸é€šï¼Œå› ä¸ºftp serverå¯èƒ½æ¯æ¬¡å¼€å¯ä¸åŒçš„ç«¯å£æ¥ä¼ è¾“æ•°æ®ï¼Œä½†æ˜¯åœ¨linuxä¸Šï¼Œç”±äºå®‰å…¨é™åˆ¶ï¼Œå¯èƒ½æŸäº›ç«¯å£æ²¡æœ‰å¼€å¯ï¼Œæ‰€ä»¥å°±å‡ºç°é˜»å¡ã€‚ æœ€å¤§çš„å‘ï¼ˆä¸‹è½½å‡º0kbçš„æ–‡ä»¶ï¼šå®è´¨å°±æ˜¯retrieveFileæ–¹æ³•æ‰§è¡Œå¤±è´¥ï¼‰ 1ftpClient.retrieveFile(new String(ff.getName().getBytes(&quot;gb2312&quot;),&quot;ISO8859-1&quot;), os) ä¸€å®šè¦ç»™æ–‡ä»¶åæ¢ç¼–ç ï¼Œè®©å®ƒè¯†åˆ«ä¸­æ–‡ï¼Œå…·ä½“ç¼–ç ä¹Ÿæ˜¯æ ¹æ®å®é™…æƒ…å†µè€Œå®šã€‚ æ€»ç»“ftpå®¢æˆ·ç«¯çš„é€Ÿåº¦ä¹Ÿæ˜¯è¦æ ¹æ®ç½‘é€Ÿæ¥çš„ï¼Œå¯èƒ½æ¯”ä¸€èˆ¬httpå¿«ï¼Œä½†æ˜¯é¢å¯¹ç½‘é€Ÿæ…¢çš„æƒ…å†µä¹Ÿæ˜¯æ— å¯å¥ˆä½•ï¼]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ftp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jsåŸå‹å’ŒåŸå‹é“¾]]></title>
    <url>%2F2017%2F07%2F13%2F%E7%BC%96%E7%A8%8B%2Fjs%E5%8E%9F%E5%9E%8B%E5%92%8C%E5%8E%9F%E5%9E%8B%E9%93%BE%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåˆšåˆšè¯´äº†é—­åŒ…ï¼Œé‚£å°±ä¸æ”¾è¿‡jsçš„å¦ä¸€å¤§éš¾ç‚¹äº†â€”â€”jsåŸå‹ä»¥åŠåŸå‹é“¾ã€‚ è°ˆè°ˆç¥å›¾é•‡æ¥¼ï¼šè‡ªå·±å†™äº†å¥½å‡ éå†…å®¹ï¼Œä½†æ˜¯è‡ªå·±å‘ç°è¿˜æ˜¯ä¸èƒ½ç³»ç»Ÿçš„ç†è§£ï¼Œè‡ªå·±ä¹Ÿå†™ä¸äº†å¤šå¥½ï¼Œçœ‹æ¥è¦åˆ°è‡ªå·±å®‰å¿ƒå†™å‰ç«¯çš„æ—¶å€™ï¼Œå†æ¥è¡¥ä¸Šäº†ã€‚ å‚è€ƒ æœ€è¯¦å°½çš„ JS åŸå‹ä¸åŸå‹é“¾ç»ˆæè¯¦è§£ï¼ˆä¸€ï¼‰ æœ€è¯¦å°½çš„ JS åŸå‹ä¸åŸå‹é“¾ç»ˆæè¯¦è§£ï¼ˆäºŒï¼‰ æœ€è¯¦å°½çš„ JS åŸå‹ä¸åŸå‹é“¾ç»ˆæè¯¦è§£ï¼ˆä¸‰ï¼‰ ä¸ªäººæ„Ÿè§‰ä¸Šé¢çš„æ–‡ç« è¿˜ä¸é”™ï¼Œå¯èƒ½è¿˜ç¼ºäº†ç»§æ‰¿é‚£å—çš„è®²è§£ï¼Œç­‰è‡ªå·±å†æ¥çš„æ—¶å€™ä¸€èµ·è¡¥ä¸Šå§ï¼ï¼ï¼ï¼]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŸå‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æµ…è°ˆjsé—­åŒ…]]></title>
    <url>%2F2017%2F07%2F12%2F%E7%BC%96%E7%A8%8B%2F%E6%B5%85%E8%B0%88js%E9%97%AD%E5%8C%85%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæœ€è¿‘é¡¹ç›®å‰ç«¯ç”¨äº†angular2ï¼Œé‡Œé¢ä½¿ç”¨çš„TypeScript,å…¶å®å¾ˆå¤šå’ŒJavaæŒºåƒçš„ï¼Œå­¦èµ·æ¥è¿˜æ˜¯æŒºå¿«çš„ã€‚ä½†æ˜¯é‡Œé¢çš„å¾ˆå¤šå˜é‡çš„åŸç†éƒ½æ˜¯æ ¹æ®é—­åŒ…æ¥å®ç°çš„ï¼Œé‚£å°±å¥½å¥½äº†è§£ä¸€ä¸‹é—­åŒ…ã€‚ é—­åŒ…å®šä¹‰æ ¹æ®Mozillaå¼€å‘è€…æ–‡æ¡£å®šä¹‰ï¼š é—­åŒ…æ˜¯æŒ‡å‘ç‹¬ç«‹å˜é‡çš„â€œå‡½æ•°â€,ç”¨é€šä¿—çš„è¯è¯´å°±æ˜¯ä¼šâ€œè®°ä½â€å®ƒåˆ›å»ºæ—¶çš„ç¯å¢ƒã€‚ é—­åŒ…æ¶‰åŠçš„ä¸»è¦æ¦‚å¿µ ä½œç”¨åŸŸé“¾ ä½œç”¨åŸŸé“¾æ˜¯å‡½æ•°åœ¨å®šä¹‰çš„æ—¶å€™åˆ›å»ºçš„,ç”¨äºå¯»æ‰¾ä½¿ç”¨åˆ°çš„å˜é‡çš„å€¼çš„ä¸€ä¸ªç´¢å¼•ã€‚å®ƒå†…éƒ¨çš„è§„åˆ™æ˜¯,æŠŠå‡½æ•°è‡ªèº«çš„æœ¬åœ°å˜é‡æ”¾åœ¨æœ€å‰é¢,æŠŠè‡ªèº«çš„çˆ¶çº§å‡½æ•°ä¸­çš„å˜é‡æ”¾åœ¨å…¶æ¬¡,æŠŠå†é«˜ä¸€çº§å‡½æ•°ä¸­çš„å˜é‡æ”¾åœ¨æ›´åé¢,ä»¥æ­¤ç±»æ¨ç›´è‡³å…¨å±€å¯¹è±¡ä¸ºæ­¢.å½“å‡½æ•°ä¸­éœ€è¦æŸ¥è¯¢ä¸€ä¸ªå˜é‡çš„å€¼çš„æ—¶å€™,jsè§£é‡Šå™¨ä¼šå»ä½œç”¨åŸŸé“¾å»æŸ¥æ‰¾,ä»æœ€å‰é¢çš„æœ¬åœ°å˜é‡ä¸­å…ˆæ‰¾,å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„å˜é‡,åˆ™åˆ°ä¸‹ä¸€çº§çš„é“¾ä¸Šæ‰¾,ä¸€æ—¦æ‰¾åˆ°äº†å˜é‡,åˆ™ä¸å†ç»§ç»­.å¦‚æœæ‰¾åˆ°æœ€åä¹Ÿæ²¡æ‰¾åˆ°éœ€è¦çš„å˜é‡,åˆ™è§£é‡Šå™¨è¿”å›undefined. å†…å­˜å›æ”¶æœºåˆ¶ ä¸€ä¸ªå‡½æ•°åœ¨æ‰§è¡Œå¼€å§‹çš„æ—¶å€™,ä¼šç»™å…¶ä¸­å®šä¹‰çš„å˜é‡åˆ’åˆ†å†…å­˜ç©ºé—´ä¿å­˜,ä»¥å¤‡åé¢çš„è¯­å¥æ‰€ç”¨,ç­‰åˆ°å‡½æ•°æ‰§è¡Œå®Œæ¯•è¿”å›äº†,è¿™äº›å˜é‡å°±è¢«è®¤ä¸ºæ˜¯æ— ç”¨çš„äº†.å¯¹åº”çš„å†…å­˜ç©ºé—´ä¹Ÿå°±è¢«å›æ”¶äº†.ä¸‹æ¬¡å†æ‰§è¡Œæ­¤å‡½æ•°çš„æ—¶å€™,æ‰€æœ‰çš„å˜é‡åˆå›åˆ°æœ€åˆçš„çŠ¶æ€,é‡æ–°èµ‹å€¼ä½¿ç”¨.ä½†æ˜¯å¦‚æœè¿™ä¸ªå‡½æ•°å†…éƒ¨åˆåµŒå¥—äº†å¦ä¸€ä¸ªå‡½æ•°,è€Œè¿™ä¸ªå‡½æ•°æ˜¯æœ‰å¯èƒ½åœ¨å¤–éƒ¨è¢«è°ƒç”¨åˆ°çš„.å¹¶ä¸”è¿™ä¸ªå†…éƒ¨å‡½æ•°åˆä½¿ç”¨äº†å¤–éƒ¨å‡½æ•°çš„æŸäº›å˜é‡çš„è¯.è¿™ç§å†…å­˜å›æ”¶æœºåˆ¶å°±ä¼šå‡ºç°é—®é¢˜.å¦‚æœåœ¨å¤–éƒ¨å‡½æ•°è¿”å›å,åˆç›´æ¥è°ƒç”¨äº†å†…éƒ¨å‡½æ•°,é‚£ä¹ˆå†…éƒ¨å‡½æ•°å°±æ— æ³•è¯»å–åˆ°ä»–æ‰€éœ€è¦çš„å¤–éƒ¨å‡½æ•°ä¸­å˜é‡çš„å€¼äº†.æ‰€ä»¥jsè§£é‡Šå™¨åœ¨é‡åˆ°å‡½æ•°å®šä¹‰çš„æ—¶å€™,ä¼šè‡ªåŠ¨æŠŠå‡½æ•°å’Œä»–å¯èƒ½ä½¿ç”¨çš„å˜é‡(åŒ…æ‹¬æœ¬åœ°å˜é‡å’Œçˆ¶çº§å’Œç¥–å…ˆçº§å‡½æ•°çš„å˜é‡(è‡ªç”±å˜é‡))ä¸€èµ·ä¿å­˜èµ·æ¥.ä¹Ÿå°±æ˜¯æ„å»ºä¸€ä¸ªé—­åŒ…,è¿™äº›å˜é‡å°†ä¸ä¼šè¢«å†…å­˜å›æ”¶å™¨æ‰€å›æ”¶,åªæœ‰å½“å†…éƒ¨çš„å‡½æ•°ä¸å¯èƒ½è¢«è°ƒç”¨ä»¥å(ä¾‹å¦‚è¢«åˆ é™¤äº†,æˆ–è€…æ²¡æœ‰äº†æŒ‡é’ˆ),æ‰ä¼šé”€æ¯è¿™ä¸ªé—­åŒ…,è€Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ªé—­åŒ…å¼•ç”¨çš„å˜é‡æ‰ä¼šè¢«ä¸‹ä¸€æ¬¡å†…å­˜å›æ”¶å¯åŠ¨æ—¶æ‰€å›æ”¶. é—­åŒ…ç°è±¡123456789var results = [];for (var i = 0; i &lt;3; i++) &#123;results[i] = function() &#123;console.log(i);&#125;&#125;results[0](); //3results[1](); //3results[2](); //3 è§£æï¼šå…¶å®è¿™é‡Œreturnå‡ºæ¥çš„æ˜¯ä¸€ä¸ªfunctionï¼ˆæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºä»–æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿˜æ²¡æœ‰æ‰§è¡Œï¼‰ï¼Œç­‰åˆ°æˆ‘ä»¬å»æ‰§è¡Œä»–çš„æ—¶å€™ï¼Œåªä¿å­˜äº†ä»–ä¸Šä¸€çº§çš„ä½œç”¨åŸŸé“¾é‡Œé¢çš„içš„ç´¢å¼•,é‚£ä¸ªæ—¶å€™iå·²ç»æ˜¯3äº†ã€‚ é—­åŒ…è§£å†³è®©å†…éƒ¨å‡½æ•°åœ¨å¾ªç¯åˆ›å»ºçš„æ—¶å€™ç«‹å³æ‰§è¡Œ,å¹¶ä¸”æ•æ‰å½“å‰çš„ç´¢å¼•å€¼,ç„¶åè®°å½•åœ¨è‡ªå·±çš„ä¸€ä¸ªæœ¬åœ°å˜é‡é‡Œ.ç„¶ååˆ©ç”¨è¿”å›å‡½æ•°çš„æ–¹æ³•,é‡å†™å†…éƒ¨å‡½æ•°,è®©ä¸‹ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™,è¿”å›æœ¬åœ°å˜é‡çš„å€¼,æ”¹è¿›åçš„ä»£ç :1234567891011var results = [];for (var i = 0; i &lt;3; i++) &#123;results[i] = (function(j) &#123;return function()&#123;console.log(j);&#125;&#125;)(i);&#125;results[0](); //0results[1](); //1results[2](); //2 æˆ‘ä»¬å‘ç°é€šè¿‡ç«‹å³æ‰§è¡Œè¡¨è¾¾å¼å°±å¯ä»¥è§£å†³é—­åŒ…çš„ç°è±¡å¾—åˆ°æˆ‘ä»¬æƒ³è¦å¾—åˆ°çš„ç°è±¡ã€‚ é—­åŒ…åº”ç”¨é—­åŒ…ä¸é™æ€å˜é‡å‰é¢å°±è¯´TypeScriptä¸Javaå¾ˆåƒï¼Œæ‰€ä»¥ç±»ä¸­çš„é™æ€å˜é‡ä¹Ÿæ˜¯æœ‰çš„ã€‚ TypeScriptä»£ç ï¼š12345678910111213141516class Counter &#123;private static COUNTER = 0;constructor() &#123;&#125;private changeBy(val) &#123;Counter.COUNTER +=val;&#125;public increment() &#123;this.changeBy(1);&#125;public decrement() &#123;this.changeBy(-1);&#125;public value() &#123;return Counter.COUNTER;&#125;&#125; ç¼–è¯‘ä¹‹åçš„jsä»£ç :123456789101112131415161718var Counter = (function () &#123;function Counter() &#123;&#125;Counter.prototype.changeBy = function (val) &#123;Counter.COUNTER += val;&#125;;Counter.prototype.increment = function () &#123;this.changeBy(1);&#125;;Counter.prototype.decrement = function () &#123;this.changeBy(-1);&#125;;Counter.prototype.value = function () &#123;return Counter.COUNTER;&#125;;Counter.COUNTER = 0;return Counter;&#125;()); ä»jsä»£ç å¯ä»¥çœ‹ä¹¦é™æ€å˜é‡COUNTERæ˜¯å±äºCounterç±»çš„ï¼Œå¹¶ä¸å±äºå¯¹è±¡åŸå‹ã€‚æ‰€æœ‰Counterå®ä¾‹éƒ½å…±äº«Counterçš„åŒä¸€ä¸ªé—­åŒ…ä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆCOUNTERï¼‰ã€‚æ‰€ä»¥COUNTERä¼šè¡¨ç°åƒå•ä¾‹ä¸€æ ·ã€‚ é—­åŒ…å’Œç§æœ‰æˆå‘˜TypeScriptç”±äºæ€§èƒ½åŸå› å¹¶æ²¡æœ‰ä½¿ç”¨é—­åŒ…æ¥æ¨¡æ‹Ÿç§æœ‰å˜é‡ï¼Œä»–ä½¿ç”¨è¿‡ç¼–è¯‘æ£€æŸ¥æœºåˆ¶æ¥å½¢æˆç§æœ‰å˜é‡çš„ç‰¹æ€§ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é—­åŒ…æ¥å®ç°ç§æœ‰å˜é‡ã€‚ jsä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718function makeCounter() &#123;var COUNTERR = 0;function Counter() &#123;&#125;function changeBy(val) &#123;COUNTER += val;&#125;;Counter.prototype.increment = function () &#123;this.changeBy(1);&#125;;Counter.prototype.decrement = function () &#123;this.changeBy(-1);&#125;;Counter.prototype.value = function () &#123;return COUNTER;&#125;;return new Counter();&#125;; ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸€ä¸ªæ–°çš„makeCounterå®ä¾‹éƒ½æ‹¥æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå…¶ä»–å®ä¾‹è®¿é—®ä¸äº†ã€‚ æ€»ç»“å­¦ä¹ è¿™ä¹ˆä¹…çš„jså‘ç°ï¼Œå…¶å®é—­åŒ…çœŸçš„æ— å¤„ä¸åœ¨ï¼Œéœ€è¦å¥½å¥½å­¦ä¹ ï¼Œå¥½å¥½æ€»ç»“ï¼Œå¦‚æœ‰ä¸å¯¹ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶èƒ½å¤ŸæŒ‡å‡ºã€‚ å‚è€ƒé“¾æ¥ï¼šjsä¸­é—­åŒ…åŸç†è°ˆå’ŒåŸå‹åŠä¾‹å­ ä¹¦ç±ï¼šLearning TypeScriptä¸­æ–‡ç‰ˆ]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>é—­åŒ…</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaæ—¥å¿—é‚£äº›äº‹]]></title>
    <url>%2F2017%2F07%2F12%2F%E7%BC%96%E7%A8%8B%2FJava%E6%97%A5%E5%BF%97%E9%82%A3%E4%BA%9B%E4%BA%8B%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸€ç›´éƒ½çŸ¥é“æ—¥å¿—æ–‡ä»¶å¾ˆé‡è¦ï¼Œå¯ä»¥è®°å½•ä¸€äº›ç›¸å…³ä¿¡æ¯ï¼Œä½†æ˜¯å¯èƒ½æ˜¯ç¨‹åºéœ€è¦è°ƒè¯•çš„å†…å®¹å¤ªå°‘ï¼Œä¹Ÿæˆ–è€…æ˜¯é¡¹ç›®å¤ªå°ï¼Œæ‰€ä»¥çœ‹çœ‹æ§åˆ¶å°çš„ä¿¡æ¯å°±å¤Ÿäº†ï¼Œä½†æ˜¯è¿™æ¬¡æ¥è§¦çš„é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œæ§åˆ¶å°é¢ä¿¡æ¯è¶Šæ¥è¶Šå¤šï¼Œç»å¸¸ä¼šçœ‹ä¸åˆ°è‡ªå·±æƒ³è¦çœ‹åˆ°çš„ä¿¡æ¯æ—¶ï¼Œè¿™ä¸ªæ—¶å€™ä½¿ç”¨æ—¥å¿—å°±å‘ç°ååˆ†å¾—æœ‰å¿…è¦äº†ï¼ æ—¥å¿—çš„å¥½å¤„ æ–¹ä¾¿è°ƒè¯•(å¦‚ä¸Š) æ–¹ä¾¿å‘ç°ç³»ç»Ÿè¿è¡Œä¸­çš„é”™è¯¯ å­˜å‚¨ä¸šåŠ¡æ•°æ®ï¼Œä¾¿äºæ—¥ååˆ†æ æ—¥å¿—å®ç°æ–¹å¼ è‡ªå·±å®ç°ç±»é€šè¿‡ioå­˜å‚¨åˆ°æ–‡ä»¶ä¸­ ä½¿ç”¨log4jå°†æ—¥å¿—è¾“å…¥åˆ°æ§åˆ¶å°ï¼Œæ–‡æœ¬æ–‡ä»¶ï¼Œä¸€é›†æ•°æ®åº“ä¸­ã€‚ ä½¿ç”¨jdkè‡ªå¸¦çš„logging.jaråŒ…ä¸­æ–¹æ³•ï¼ˆåŒä¸€ä½œè€…è¿˜æœ‰lognbackï¼‰ ä½¿ç”¨slfjï¼Œå®ƒæä¾›äº†ä¸Šè¿°ä¸¤ç§æ–¹æ³•çš„æ¥å£ã€‚ æ—¥å¿—çš„è¾“å‡º(ä»¥log4jä¸ºä¾‹) è¾“å…¥åˆ°æ§åˆ¶å° è¿è¡Œç¨‹åºï¼š1234567891011public class LoggerTest &#123;public static Logger logger1 = Logger.getLogger(LoggerTest.class);public static void main(String[] args) &#123;logger1.trace(&quot;æˆ‘æ˜¯logger1ï¼Œtrace&quot;);logger1.debug(&quot;æˆ‘æ˜¯logger1ï¼Œdebug&quot;);logger1.info(&quot;æˆ‘æ˜¯logger1ï¼Œinfo&quot;);logger1.warn(&quot;æˆ‘æ˜¯logger1ï¼Œwarn&quot;);logger1.error(&quot;æˆ‘æ˜¯logger1ï¼Œerror&quot;);logger1.fatal(&quot;æˆ‘æ˜¯logger1ï¼Œfatal&quot;);&#125;&#125; é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š123456789### è®¾ç½®çº§åˆ«å’Œç›®çš„åœ°(è¿™é‡Œå¤šä¸ªç›®çš„åœ°) ###log4j.rootLogger = DEBUG,CONSOLE### è¿™é‡Œçš„com.todorexæ˜¯åŒ…ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªåŒ…è®°å½•æ—¥å¿—æ—¶ï¼Œæ˜¯åªè®°å½•debugåŠä»¥ä¸Šçº§åˆ«çš„æ—¥å¿—log4j.logger.com.todorex=DEBUG### è¾“å‡ºåˆ°æ§åˆ¶å° ###log4j.appender.CONSOLE = org.apache.log4j.ConsoleAppenderlog4j.appender.CONSOLE.Target = System.outlog4j.appender.CONSOLE.layout = org.apache.log4j.PatternLayoutlog4j.appender.CONSOLE.layout.ConversionPattern = %d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n æ§åˆ¶å°è¾“å‡º:1234511:35:09,969 DEBUG LoggerTest:12 [main:0]- æˆ‘æ˜¯logger1ï¼Œdebug11:35:09,972 INFO LoggerTest:13 [main:3]- æˆ‘æ˜¯logger1ï¼Œinfo11:35:09,972 WARN LoggerTest:14 [main:3]- æˆ‘æ˜¯logger1ï¼Œwarn11:35:09,972 ERROR LoggerTest:15 [main:3]- æˆ‘æ˜¯logger1ï¼Œerror11:35:09,972 FATAL LoggerTest:16 [main:3]- æˆ‘æ˜¯logger1ï¼Œfatal è¾“å…¥åˆ°æ—¥å¿—æ–‡ä»¶è¿è¡Œç¨‹åºåŒä¸Šï¼›é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š1234567891011121314151617181920### è®¾ç½®çº§åˆ«å’Œç›®çš„åœ°(è¿™é‡Œå¯ä»¥å¤šä¸ªç›®çš„åœ°) ###log4j.rootLogger = trace,demoLoglog4j.logger.com.todorex=DEBUG### è¾“å‡ºåˆ°æ§åˆ¶å° ###log4j.appender.CONSOLE = org.apache.log4j.ConsoleAppenderlog4j.appender.CONSOLE.Target = System.outlog4j.appender.CONSOLE.layout = org.apache.log4j.PatternLayoutlog4j.appender.CONSOLE.layout.ConversionPattern = %d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L [%t:%r]- %m%n### è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ï¼ˆæ–‡ä»¶ç›®å½•ä¸€å®šè¦æ˜¯ç»å¯¹è·¯å¾„ä¸”å­˜åœ¨ï¼‰ ###log4j.appender.demoLog = org.apache.log4j.DailyRollingFileAppenderlog4j.appender.demoLog.File =/var/alldata/mylog.loglog4j.appender.demoLog.Append = true## åªè¾“å‡ºDEBUGçº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—log4j.appender.demoLog.Threshold = DEBUG#&apos;.&apos;yyyy-MM-dd: æ¯å¤©äº§ç”Ÿä¸€ä¸ªæ–°çš„æ–‡ä»¶log4j.appender.demoLog.DatePattern = &apos;.&apos;yyyy-MM-ddlog4j.appender.demoLog.layout = org.apache.log4j.PatternLayoutlog4j.appender.demoLog.layout.ConversionPattern = %-d&#123;yyyy-MM-dd HH:mm:ss&#125; [%t:%r] - [%p] [%c&#123;1&#125;:%L] [%M] %m%n æ–‡ä»¶å†…å®¹åŒæ§åˆ¶å°è¾“å‡ºï¼Œä½†æ˜¯å´æ¯”æ§åˆ¶å°æ¸…æ¥šå¾—å¤šï¼Œä¸ä¼šè¢«ä¹±ä¸ƒå…«ç³Ÿçš„ä¿¡æ¯ç»™é®ç›–ã€‚ è¾“å…¥åˆ°æ•°æ®åº“ è¿è¡Œç¨‹åº:1234567public class LoggerTest &#123;public static void main(String[] args) &#123;Logger logger = Logger.getLogger(LoggerTest.class);logger.info(&quot;good&quot;);logger.debug(&quot;success&quot;);&#125;&#125; é…ç½®æ–‡ä»¶ï¼š1234567891011log4j.rootLogger=trace,CONSOLE,demoLog# com.todorexåŒ…ä¸‹é¢æ‰€æœ‰çš„æ—¥å¿—è¾“å‡ºçš„çº§åˆ«è®¾ä¸ºDEBUGlog4j.logger.com.todorex=DEBUG# æ•°æ®åº“è¾“å‡ºlog4j.appender.demoLog=org.apache.log4j.jdbc.JDBCAppenderlog4j.appender.demoLog.driver=com.mysql.jdbc.Driverlog4j.appender.demoLog.URL=jdbc:mysql://127.0.0.1:3306/testlog4j.appender.demoLog.user=rootlog4j.appender.demoLog.password=root# åœ¨æ•°æ®åº“å¯¹åº”çš„ä½ç½®å»ºä¸€ä¸ªå¯¹åº”çš„logè¡¨log4j.appender.demoLog.sql=insert into log(level,category,thread,time,location,note) values(&apos;%p&apos;,&apos;%c&apos;,&apos;%t&apos;,&apos;%d&#123;yyyy-MM-dd HH:mm:ss:SSS&#125;&apos;,&apos;%l&apos;,&apos;%m&apos;) æ•°æ®åº“çš„å…·ä½“å†…å®¹å°±ä¸è´´å‡ºæ¥äº†ï¼Œå’Œæ™®é€šçœ‹åˆ°çš„ä¸€æ ·ã€‚ æ€»ç»“å…¶å®æ—¥å¿—ç”¨å‡ æ¬¡å°±çŸ¥é“å®ƒçš„å¥½äº†ï¼Œè‡ªå·±ä¹Ÿæ˜¯åœ¨æ…¢æ…¢å­¦ä¹ ï¼]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>æ—¥å¿—</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jpaå®ä½“æ˜ å°„å…³ç³»]]></title>
    <url>%2F2017%2F06%2F15%2F%E7%BC%96%E7%A8%8B%2Fjpa%E5%AE%9E%E4%BD%93%E6%98%A0%E5%B0%84%E5%85%B3%E7%B3%BB%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå…¶å®è·ç¦»è‡ªå·±ä¸Šæ¬¡å†™æ•°æ®åº“æ“ä½œå·²ç»1ä¸ªå¤šæœˆäº†ï¼Œä¹‹å‰æ¥è§¦çš„å°±æ˜¯Hibernateï¼Œè¿™æ¬¡æ¥è§¦jpaï¼Œå°±æŠŠå‡ ç§å¯¹åº”å…³ç³»ç†æ¸…ã€‚ æ˜ å°„ç­–ç•¥æ³¨ï¼šè¿™æ¬¡ä¸¾çš„ä¾‹å­éƒ½æ˜¯Userå’ŒCarçš„ å¤–é”®å…³è”ç®€ä»‹ï¼šä¸¤ä¸ªè¡¨çš„å…³ç³»å®šä¹‰åœ¨å…¶ä¸­ä¸€ä¸ªè¡¨ä¸­ @OneToOneæ–¹æ³•ä¸€ï¼š123@OneToOne(cascade=CascadeType.ALL, fetch=FetchType.EAGER)@JoinColumn(name = &quot;user_id&quot;)private Car car; é€šè¿‡åœ¨Carè¡¨ä¸­åŠ å…¥ä¸€ä¸ªå¤–é”®ï¼Œå®ç°ä¸¤è€…å…³ç³»ã€‚æ–¹æ³•äºŒï¼š12@OneToOne(cascade = CascadeType.ALL,fetch = FetchType.EAGER,mappedBy = &quot;Car&quot;)private User user; é€šè¿‡åœ¨Carç±»ä¸­ç”¨MappedByå£°æ˜è®©Userè¿›è¡Œç»´æŠ¤ã€‚ @OneToMany123@OneToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)@JoinColumn(name = &quot;user_id&quot;)private Set&lt;Car&gt; cars; é€šè¿‡åœ¨Carè¡¨ä¸­åŠ å…¥ä¸€ä¸ªå¤–é”®ï¼Œå®ç°ä¸€å¯¹å¤šå…³ç³»ã€‚ @ManyToMany12@OneToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)private Set&lt;Car&gt; cars; è¿™ä¸ªæ˜¯é‡‡ç”¨é»˜è®¤çš„è¡¨å…³è” è¡¨å…³è”ç®€ä»‹ï¼šä¸¤ä¸ªè¡¨çš„å…³ç³»é€šè¿‡ä¸€å¼ ä¸­é—´è¡¨æ¥æ¥å…³è” @OneToMany12345@OneToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)@JoinTable(name = &quot;user_car&quot;,joinColumns=&#123;@JoinColumn(name = &quot;user_id&quot;)&#125;,inverseJoinColumns = &#123;@JoinColumn(name = &quot;car_id&quot;)&#125;)private Set&lt;Car&gt; cars; é€šè¿‡JoinTableæ¥ç¡®å®šä¸€å¼ ä¸­é—´è¡¨ï¼ŒjoinColumnsé‡Œé¢æ”¾çˆ¶è¡¨çš„å±æ€§ï¼ŒinverseJoinColumnsæ”¾å­è¡¨çš„å±æ€§ @ManyToMany12345@ManyToMany(cascade=CascadeType.ALL, fetch=FetchType.EAGER)@JoinTable(name = &quot;user_car&quot;,joinColumns=&#123;@JoinColumn(name = &quot;user_id&quot;)&#125;,inverseJoinColumns = &#123;@JoinColumn(name = &quot;car_id&quot;)&#125;)private Set&lt;Car&gt; cars; è§£é‡Šå¦‚@OneToMany ä¸€äº›å±æ€§cascadeå±æ€§ CascadeType.PERSISTï¼šçº§è”æ–°å»º CascadeType.REMOVEï¼šçº§è”åˆ é™¤ CascadeType.REFRESHï¼šçº§è”åˆ·æ–° CascadeType.MERGEï¼šçº§è”æ›´æ–° CascadeType.ALLï¼šåŒ…æ‹¬ä¸Šé¢å››é¡¹ fetchå±æ€§ FetchType.EAGERï¼šç›¸å½“äºç¦ç”¨æ‡’åŠ è½½ï¼Œæ¨èå¼€å‘ä½¿ç”¨ FetchType.LAZYï¼šæ‡’åŠ è½½ï¼Œé»˜è®¤å€¼ï¼Œæ¨èéƒ¨ç½²ä½¿ç”¨ æ€»ç»“çˆ¶è¡¨æ˜¯æä¾›ä¸»é”®çš„ï¼Œå­è¡¨æ˜¯åˆ©ç”¨çˆ¶è¡¨çš„ä¸»é”®æ¥è®¾ç½®å¤–é”®çš„ï¼Œç»´æŠ¤æ–¹æ˜¯Ownerï¼Œè¢«ç»´æŠ¤æ–¹æ˜¯Ownedã€‚æç¤ºè‡ªå·±ä¸€ä¸ªå‚»é€¼çš„é—®é¢˜ï¼Œæ’å…¥æ•°æ®è¦å…ˆå¾€ä¸¤å¼ è¡¨ä¸­æ’å…¥æ•°æ®ï¼Œåœ¨å¾€ä¸­é—´è¡¨æ’å…¥æ•°æ®ï¼Œä¸ç„¶ä¼šæŠ¥é”™~]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>sping</tag>
        <tag>jpa</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[springbooté¡¹ç›®è°ƒè¯•angular2]]></title>
    <url>%2F2017%2F06%2F01%2F%E7%BC%96%E7%A8%8B%2Fspringboot%E9%A1%B9%E7%9B%AE%E8%B0%83%E8%AF%95angular2%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šåœ¨æ¥è§¦ springbootå’Œangular2çš„å‰åç«¯é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘å‘ç°è‡ªå·±ä¼šå…ˆæŠŠangular2çš„é¡¹ç›®ç¼–è¯‘å¥½ä¹‹åæ”¾åœ¨springbootçš„resourceç›®å½•ä¸‹çš„staticæ–‡ä»¶å¤¹ä¸‹è¿è¡Œï¼Œè™½ç„¶è¿™æ ·å¯ä»¥ï¼Œä½†æ˜¯å¯¹äºå‰ç«¯æ¥è°ƒè¯•ä»£ç å®åœ¨ä¸æ–¹ä¾¿ã€‚åœ¨ç™¾åº¦ç½‘ä¸Šçš„æ–¹æ³•ä¹‹åå¯ä»¥é‡‡ç”¨å¦‚ä¸‹ä»£ç†çš„æ–¹å¼ã€‚ é—®é¢˜ angular2å¯åŠ¨çš„æœåŠ¡é»˜è®¤ä¸ºhttp://localhost:4200 springbootå¯åŠ¨çš„æœåŠ¡é»˜è®¤ä¸ºhttp://localhost:8080 å¦‚æœæˆ‘ä»¬ç›´æ¥è®¾ç½®angular2è®¿é—®çš„è·¯å¾„ä¸ºhttp://localhost:8080å°±ä¼šå‡ºç°è·¨åŸŸè®¿é—®çš„é—®é¢˜ã€‚è¯·æ±‚ä¸åˆ°æ•°æ®ã€‚ è§£å†³åœ¨angular2é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹é¢æ–°å»ºä¸€ä¸ªproxy.config.json123456&#123;&quot;/api&quot;: &#123;&quot;target&quot;: &quot;http://localhost:8081&quot;,&quot;secure&quot;: false&#125;&#125; ç„¶ååœ¨å¯åŠ¨é¡¹ç›®çš„æ—¶å€™é‡‡ç”¨ä¸‹é¢çš„å‘½ä»¤ ng serve â€“proxy-config proxy.config.json é€šè¿‡è¿™æ ·çš„ä»£ç†è®¿é—®å°±èƒ½èƒ½å¤Ÿå®ç°è·¨åŸŸè®¿é—®è¯·æ±‚æ•°æ®ã€‚ æ€»ç»“é€šè¿‡ä¸Šé¢çš„æ–¹æ³•æ–¹ä¾¿äº†å¼€å‘è°ƒè¯•ï¼Œä¸é”™ï¼Œç»ˆäºè¦å¼€å§‹å†™ä»£ç äº†ï¼]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>springboot</tag>
        <tag>angular2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Angular2å…¥é—¨]]></title>
    <url>%2F2017%2F05%2F24%2F%E7%BC%96%E7%A8%8B%2FAngular2%E5%85%A5%E9%97%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç”±äºè€å¸ˆæš‘å‡çš„é¡¹ç›®å‰ç«¯ä»£ç éœ€è¦ç”¨åˆ°Angular2ï¼Œä½œä¸ºä¸€ä¸ªåç«¯å¼€å‘è€…ä¹Ÿæ˜¯éœ€è¦äº†è§£ä¸€ä¸¢ä¸¢çš„ã€‚ Angularç®€ä»‹åœ¨ç»è¿‡ç®€å•çš„äº†è§£ä¸ä½¿ç”¨ä¹‹åï¼Œæ„Ÿè§‰ åˆ°Angular2çš„å¼ºå¤§ä¸ä¼Ÿå¤§ï¼Œé…çš„ä¸Šè¯´æ˜¯ä¸€ä¸ªä¼˜ç§€çš„å‰ç«¯æ¡†æ¶ã€‚Angular2å®ç°äº†å‰ç«¯ä¸€ç›´æå€¡çš„ç»„ä»¶åŒ–å¼€å‘è¿˜è§£å†³äº†å¤§éƒ¨åˆ†é¡¹ç›®è·¯ç”±æ··ä¹±çš„é—®é¢˜ã€‚å®ƒè¿˜æœ‰å…·æœ‰MVCåˆ†å±‚æ¶æ„å’Œä¾èµ–æ³¨å…¥ç­‰ä¸€ç³»åˆ—ä¼˜ç§€çš„ç‰¹æ€§ã€‚ç°åœ¨è´´ä¸ŠAngular2çš„ä¸€å¼ æ¶æ„å›¾ï¼šä¸Šå›¾æè¿°äº†Angular2ä¸­8å¤§ä¸»è¦æ„é€ å—çš„å…³ç³»ï¼Œä»–ä»¬å…·ä½“çš„ç†è§£ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡åšæ–‡ã€‚å¦‚æœè¿˜æœ‰ä»€ä¹ˆä¸ç†è§£ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç›¸ä¿¡å®è·µè§çœŸçŸ¥ã€‚ Angularèµ·æ­¥åœ¨è¿™æ¬¡å­¦ä¹ ä¸­ï¼Œæˆ‘ç»ˆäºç†è§£äº†å‰è¾ˆä»¬æ‰€è¯´çš„å…¥é—¨ä¸€é—¨æŠ€æœ¯å°±å¥½çš„æ–¹æ³•å°±æ˜¯å»çœ‹å®˜æ–¹æ–‡æ¡£äº†ï¼ŒAngular2çš„å®˜ç½‘æ–‡æ¡£é‡Œé¢æœ‰ä¸­æ–‡ç‰ˆçš„ï¼Œç›¸ä¿¡å¤§å®¶ä¸€å®šå¾ˆå¼€å¿ƒå§ã€‚å½“ç„¶æ²¡æœ‰ä¸­æ–‡ç‰ˆä¹Ÿæ˜¯è¦çœ‹çš„ï¼Œæ¯”è¾ƒéƒ½æ˜¯æœ€åŸºç¡€çš„å…¥é—¨ï¼Œä¸è¦æƒ§æ€•è‹±æ–‡ã€‚ åœ¨è¿™æ¬¡æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„æ•™ç¨‹ï¼ˆè‹±é›„ç¼–è¾‘å™¨ï¼‰å‡ºç°äº†ä¸¤ä¸ªé—®é¢˜ï¼Œè¿™é‡Œä¹Ÿè¯´æ˜ä¸€ä¸‹ï¼š angular-in-memory-web-apiaæ¨¡å—ä¸å­˜åœ¨ è§£å†³æ–¹æ³•ï¼šé€šè¿‡å‘½ä»¤è¡Œå®‰è£… npm i angular-in-memory-web-api 1234567create(name: string): Promise&lt;Hero&gt; &#123;return this.http.post(this.heroesUrl, JSON.stringify(&#123;name: name&#125;), this.headers).toPromise().then(res =&gt; res.json().data as Hero).catch(this.handleError);&#125; è¿™é‡Œçš„postæ–¹æ³•ä¸­çš„ç¬¬ä¸‰ä¸ªå‚æ•°åº”è¯¥æ˜¯this.headers,è€Œä¸æ˜¯åƒå®˜æ–¹æ–‡æ¡£ä¸­çš„é‚£æ ·ã€‚ æ€»ç»“å¦‚æœé‡åˆ°ä¸æ‡‚å¾—é—®å€™å¤šçœ‹çœ‹æ–‡æ¡£å§ï¼Œç›¸ä¿¡è‡ªå·±å¯ä»¥çš„ï¼Œç„¶åå°±æ˜¯å®è·µè§çœŸçŸ¥äº†ã€‚]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>Angular2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç®€è°ˆentityï¼Œmodelï¼Œdomain]]></title>
    <url>%2F2017%2F05%2F23%2F%E7%BC%96%E7%A8%8B%2F%E7%AE%80%E8%B0%88entity%EF%BC%8Cmodel%EF%BC%8Cdomain%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå‰ä¸¤å¤©å¬åˆ°å…³äºentityå’ŒdomainåŒ…çš„åŒºåˆ«ï¼Œå¥½åƒä¹‹å‰è‡ªå·±ä¹Ÿæ²¡æœ‰åœ¨æ„è¿‡ï¼Œä»Šå¤©çœ‹çœ‹ç½‘ä¸Šçš„ä¿¡æ¯æ€»ç»“ä¸€ä¸‹ã€‚ entityï¼ˆå®ä½“ï¼‰è¿™å¥½åƒæ˜¯æœ€å¸¸ç”¨çš„packageå‘½åäº†ï¼Œpackageçš„ç±»ä¸€èˆ¬éƒ½æ˜¯å’Œæ•°æ®åº“çš„è¡¨å¯¹åº”çš„ã€‚ä¸€ä¸ªå®ä½“ï¼Œä¸€å¼ è¡¨ï¼Œå…¶å­—æ®µçš„ç±»å‹ä¹Ÿæ˜¯å¯¹åº”çš„ã€‚ modelï¼ˆæ¨¡å‹ï¼‰æœ€åˆæ¥è§¦åˆ°å®ƒçš„æ—¶å€™æ˜¯Strutsçš„æ¨¡å‹é©±åŠ¨ï¼Œç”¨äºæ¥å—å’Œæ˜¾ç¤ºå‰å°çš„æ•°æ®å¯¹è±¡ã€‚æˆ‘ä»¬è¦æ ¹æ®å®é™…æƒ…å†µæ¥ç¡®å®šæ¨¡å‹çš„ç±»ã€‚ domainï¼ˆåŸŸï¼‰è¯´å®è¯ï¼Œè¿™ä¸ªåŒ…åç”¨å¾—ä¸æ€ä¹ˆå¤šï¼Œåœ¨ç½‘ä¸Šæ˜¾ç¤ºå®ƒåœ¨å›½å¤–çš„ç½‘ç«™ç”¨çš„æ¯”è¾ƒå¤šï¼Œå®ƒä¸»è¦æ˜¯ç”¨äºå­˜å‚¨ä¸€ä¸ªä¸šåŠ¡å¯¹è±¡ï¼ˆæ¨¡å—å¯¹è±¡ï¼‰ã€‚ æ€»ç»“æ­£ç¡®å‘½ååŒ…åï¼Œæœ‰åŠ©äºåç»­ä»£ç çš„ç»´æŠ¤ï¼Œä»¥åŠåæ¥å¼€å‘è€…çš„ç»´æŠ¤ï¼Œæœ€é‡è¦çš„æ˜¯èƒ½è¡”æ¥è¡Œä¸šçš„è§„èŒƒã€‚æ…¢æ…¢æ¥ï¼]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è´ªå¿ƒç®—æ³•]]></title>
    <url>%2F2017%2F05%2F17%2F%E7%AE%97%E6%B3%95%2F%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šä¸Šæ¬¡çœ‹åˆ°è¿‡é’Ÿåè€å¸ˆçš„ä¸€ä¸ªåŸºäºè´ªå¿ƒç®—æ³•çš„æ¯•ä¸šè®¾è®¡ï¼Œä¸€ç›´å¾ˆå¥½å¥‡ï¼Œä»Šå¤©ç»ˆäºèƒ½çœ‹çœ‹å®ƒäº†ï¼Œåªæ˜¯çŸ¥å…¶ç„¶ï¼Œä¸çŸ¥æ‰€ä»¥ç„¶ã€‚ è´ªå¿ƒç®—æ³•æ€»è¯´è´ªå¿ƒç®—æ³•åœ¨æ¯ä¸€æ­¥éƒ½ä¼šåšå‡ºçœ‹èµ·æ¥æ˜¯æœ€ä½³çš„é€‰æ‹©ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šåšå‡ºå±€éƒ¨æœ€ä¼˜çš„é€‰æ‹©ï¼Œå¸Œæœ›ä»¥æ­¤èƒ½å¤Ÿå¾—åˆ°æœ€ä¼˜è§£ã€‚ æ´»åŠ¨é€‰æ‹©é—®é¢˜è´ªå¿ƒé€‰æ‹©æˆ‘ä»¬è¦é€‰æ‹©è¿™æ ·ä¸€ä¸ªæ´»åŠ¨ï¼Œé€‰å‡ºå®ƒä¹‹åèº«ä¸‹çš„èµ„æºèƒ½å¤Ÿè¢«å°½é‡å¤šçš„å…¶ä»–ä»»åŠ¡æ‰€ç”¨ï¼Œå³é€‰æ‹©æœ€æ—©ç»“æŸçš„æ´»åŠ¨ã€‚ é€’å½’è´ªå¿ƒç®—æ³•ç®—æ³•æ€è·¯ï¼šç”¨ä¸¤ä¸ªæ•°ç»„så’Œfè¡¨ç¤ºæ´»åŠ¨çš„å¼€å§‹å’Œç»“æŸæ—¶é—´ã€‚ä¸‹è¡¨kæ˜¯æˆ‘ä»¬è¦æ±‚è§£çš„å­é—®é¢˜ï¼Œä»¥åŠé—®é¢˜è§„æ¨¡nï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031import java.util.ArrayList;import java.util.List;public class ActivitySelector &#123;public int[] s = new int[]&#123;1,3,0,5,3,5,6,8,8,2,12&#125;;public int[] f = new int[]&#123;4,5,6,7,9,9,10,11,12,14,16&#125;;public List&lt;Integer&gt; list = new ArrayList&lt;&gt;();public void recursiveActivitySelector(int[] s, int[] f,int k,int n)&#123;if(list.size()==0)&#123;list.add(1);&#125;int m = k+1;while (m&lt;n &amp;&amp; s[m]&lt;f[k])&#123;m = m+1;&#125;if(m&lt;n)&#123;list.add(m+1);recursiveActivitySelector(s, f, m, n);&#125; else &#123;return ;&#125; &#125;public static void main(String[] args) &#123;ActivitySelector activitySelector = new ActivitySelector();activitySelector.recursiveActivitySelector(activitySelector.s, activitySelector.f, 0, activitySelector.f.length);for (Integer i : activitySelector.list) &#123;System.out.println(i);&#125;&#125;&#125; è¿­ä»£è´ªå¿ƒç®—æ³•è¿™ä¸ªè¿‡ç¨‹æ˜¯å‡è®¾è¾“å…¥æ´»åŠ¨çš„ç»“æŸæ—¶é—´æ˜¯å·²ç»æ’å¥½åºçš„ï¼Œä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627import java.util.ArrayList;import java.util.List;public class GreedyActivitySelector &#123;public int[] s = new int[]&#123;1,3,0,5,3,5,6,8,8,2,12&#125;;public int[] f = new int[]&#123;4,5,6,7,9,9,10,11,12,14,16&#125;;public List&lt;Integer&gt; list = new ArrayList&lt;&gt;();public void greedActivitySelector(int[] s,int[] f)&#123;int n = s.length;list.add(1);int k = 1;for (int m = 1; m &lt; n; m++) &#123;if(s[m]&gt;=f[k])&#123;list.add(k);k = m;&#125;&#125;&#125;public static void main(String[] args) &#123;ActivitySelector activitySelector = new ActivitySelector();activitySelector.recursiveActivitySelector(activitySelector.s, activitySelector.f, 0, activitySelector.f.length);for (Integer i : activitySelector.list) &#123;System.out.println(i);&#125;&#125;&#125; è´ªå¿ƒç®—æ³•åŸç†è®¾è®¡è´ªå¿ƒç®—æ³•çš„è¿‡ç¨‹ ç¡®å®šé—®é¢˜çš„æœ€ä¼˜å­ç»“æ„ è®¾è®¡ä¸€ä¸ªé€’å½’ç®—æ³• è¯æ˜ä¸€ä¸ªè´ªå¿ƒé€‰æ‹©ï¼Œåˆ™åªå‰©ä¸‹ä¸€ä¸ªå­é—®é¢˜ è¯æ˜è´ªå¿ƒé€‰æ‹©æ€»æ˜¯å®‰å…¨çš„ è®¾è®¡ä¸€ä¸ªé€’å½’ç®—æ³•å®ç°è´ªå¿ƒç­–ç•¥ å°†é€’å½’ç®—æ³•è½¬æ¢ä¸ºè¿­ä»£ç®—æ³• è¯æ˜ä¸€ä¸ªè´ªå¿ƒç®—æ³•æ˜¯å¦èƒ½æ±‚è§£ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜ï¼Ÿå…·æœ‰ä¸‹é¢æ€§è´¨å°±okï¼Ÿ è´ªå¿ƒé€‰æ‹©æ€§è´¨ æˆ‘ä»¬å¯ä»¥é€šè¿‡åšå‡ºå±€éƒ¨æœ€ä¼˜é€‰æ‹©æ¥æ„é€ å…¨å±€æœ€ä¼˜è§£ æœ€ä¼˜å­ç»“æ„ å¦‚æœä¸€ä¸ªé—®é¢˜çš„æœ€ä¼˜è§£åŒ…å«å­é—®é¢˜çš„æœ€ä¼˜è§£ æ€»ç»“ä¸€æ­¥ä¸€æ­¥æ…¢æ…¢è´ªå¿ƒï¼Œå’Œåšäººæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ€»çš„æ¥è¯´è¿˜æ˜¯è¦è€ƒè™‘å…¨å±€çš„ï¼ï¼ï¼]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ç®—æ³•å¯¼è®º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŠ¨æ€è§„åˆ’]]></title>
    <url>%2F2017%2F05%2F17%2F%E7%AE%97%E6%B3%95%2F%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ…¢æ…¢å°±æ­¥å…¥äº†ç®—æ³•å¯¼è®ºçš„é«˜çº§è®¾è®¡ä¸åˆ†ææŠ€æœ¯æ¨¡å—ï¼Œå…ˆæ¥çœ‹çœ‹åŠ¨æ€è§„åˆ’ã€‚ps:å¿«æ¯•ä¸šçš„å¿ƒæƒ…orgã€‚ åŠ¨æ€è§„åˆ’æ€»è¯´åŠ¨æ€è§„åˆ’è™½ç„¶ä¸åˆ†æ²»æ–¹æ³•ç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒèƒ½å¤Ÿè§£å†³å­é—®é¢˜é‡å çš„æƒ…å†µï¼Œè¿™æ ·å°±æé«˜äº†æ•ˆç‡ã€‚å®ƒé€šå¸¸æ˜¯ç”¨æ¥æ±‚è§£æœ€ä¼˜åŒ–çš„é—®é¢˜ã€‚æ±‚å¾—æ˜¯ä¸€ä¸ªæœ€ä¼˜è§£ã€‚ä¸€èˆ¬æŒ‰å¦‚ä¸‹4ä¸ªæ­¥éª¤æ¥è®¾è®¡ä¸€ä¸ªåŠ¨æ€è§„åˆ’ç®—æ³•ã€‚ åˆ»ç”»ä¸€ä¸ªæœ€ä¼˜è§£çš„ç»“æ„ç‰¹å¾ é€’å½’åœ°å®šä¹‰æœ€ä¼˜è§£çš„å€¼ è®¡ç®—æœ€ä¼˜è§£çš„å€¼ï¼Œé€šå¸¸é‡‡ç”¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³• åˆ©ç”¨è®¡ç®—å‡ºçš„ä¿¡æ¯æ„é€ å‡ºä¸€ä¸ªæœ€ä¼˜è§£ é’¢æ¡åˆ‡å‰²å…ˆçœ‹ä»¥å‰å¸¸ç”¨çš„åˆ†æ²»æ–¹æ³•å³è‡ªé¡¶å‘ä¸‹æ–¹æ³•,ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728public class CutRod &#123;//a[i]è¡¨ç¤ºé•¿åº¦ä¸ºiçš„é’¢æ¡åˆ©æ¶¦æ˜¯å¤šå°‘public int[] a = new int[]&#123;1,5,8,9,10,17,17,20,24,30&#125;;//è‡ªé¡¶å‘ä¸‹é€’å½’è®¾è®¡public int cutRod(int[] a,int n) &#123;if(n == 0)&#123;return 0;&#125;int q = 0;for (int i = 0; i&lt;n; i++)&#123;q = max(q,a[i]+cutRod(a,n-1-i));&#125;return q;&#125;//æ±‚æœ€å¤§å€¼å‡½æ•°public int max(int a, int b)&#123;if(a&gt;b)&#123;return a;&#125; else &#123;return b;&#125;&#125;public static void main(String[] args) &#123;CutRod cut = new CutRod(); int lost = cut.cutRod(cut.a,10);System.out.println(lost);&#125;&#125; é—®é¢˜ï¼šåå¤åœ°ç”¨ç›¸åŒçš„å‚æ•°å€¼å¯¹è‡ªèº«è¿›è¡Œé€’å½’è°ƒç”¨ï¼Œé€ æˆäº†è¿è¡Œæ—¶é—´ä¸ºnçš„æŒ‡æ•°å‡½æ•°ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨åŠ¨æ€è§„åˆ’æ–¹æ³•æ±‚è§£æœ€ä¼˜é’¢æ¡åˆ‡å‰²é—®é¢˜ã€‚ é‡‡ç”¨å¸¦å¤‡å¿˜çš„è‡ªé¡¶å‘ä¸‹æ³•æ ¸å¿ƒæ˜¯åˆ©ç”¨ä¸€ä¸ªæ•°ç»„å­˜å‚¨å·²ç»æ±‚è§£è¿‡çš„æœ€ä¼˜è§£ï¼Œé¿å…äº†é‡å¤çš„è®¡ç®—ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class MemoizedCutRod &#123;//a[i]è¡¨ç¤ºé•¿åº¦ä¸ºiçš„é’¢æ¡åˆ©æ¶¦æ˜¯å¤šå°‘public int[] a = new int[]&#123;1,5,8,9,10,17,17,20,24,30&#125;;//å¸¦å¤‡å¿˜çš„è‡ªé¡¶å‘ä¸‹å‡½æ•°public int memoizedCutRod(int[] a,int n)&#123;//åˆ›å»ºä¸€ä¸ªå¤‡å¿˜çš„æ•°ç»„å­˜å‚¨ä¸€ä¸ªä¹‹å‰è®¡ç®—è¿‡çš„æœ€ä¼˜è§£int[] r = new int[n];//åˆå§‹åŒ–æ•°ç»„for (int i : r) &#123;i = 0;&#125;//å€ŸåŠ©è¾…åŠ©å‡½æ•°è®¡ç®—return memoizedCutRodAux(a, n, r);&#125;//å¸¦å¤‡å¿˜çš„è‡ªé¡¶å‘ä¸‹æ³•è¾…åŠ©å‡½æ•°public int memoizedCutRodAux(int[] a,int n,int[] r) &#123;//å®šä¹‰åˆ©æ¶¦int q = 0;if(n == 0)&#123;return 0;&#125; //åˆ¤æ–­åŸå…ˆæ˜¯å¦å·²ç»è®¡ç®—è¿‡ï¼Œè‹¥è®¡ç®—è¿‡å°±ä¸ç”¨å†è®¡ç®—if(r[n-1] &gt;0)&#123;return r[n-1]; &#125;else &#123;for (int i = 0; i&lt;n; i++)&#123;q = max(q,a[i]+memoizedCutRodAux(a, n-1-i, r));&#125;&#125;r[n-1] = q;return q;&#125;//æ±‚æœ€å¤§å€¼å‡½æ•°public int max(int a, int b)&#123;if(a&gt;b)&#123;return a;&#125; else &#123;return b;&#125;&#125;public static void main(String[] args) &#123;MemoizedCutRod cut = new MemoizedCutRod();int lost = cut.memoizedCutRod(cut.a, 10);System.out.println(lost);&#125;&#125; é‡‡ç”¨ç”±åº•å‘ä¸Šçš„æ–¹æ³•æ ¸å¿ƒæ˜¯ä»å°ç®—åˆ°å¤§ç®—å‡ºæ¯ä¸€ä¸ªé•¿åº¦çš„æœ€ä¼˜è§£ï¼Œç„¶åè¿”å›æƒ³è¦çš„é•¿åº¦çš„æœ€ä¼˜è§£ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930public class BottomUpTopCutRod &#123;//a[i]è¡¨ç¤ºé•¿åº¦ä¸ºiçš„é’¢æ¡åˆ©æ¶¦æ˜¯å¤šå°‘public int[] a = new int[]&#123;1,5,8,9,10,17,17,20,24,30&#125;;public int bottomUpTopCutRod(int[] a, int n)&#123;int[] r = new int[n+1];//é•¿åº¦ä¸º0çš„æ—¶å€™ï¼Œæ”¶ç›Šä¸º0r[0] = 0;int q = 0;for(int i = 0; i&lt;n; i++)&#123;for(int j = 0; j&lt;=i; j++)&#123;q = max(q,a[j]+r[i-j]);&#125;r[i+1] = q;&#125;return r[n];&#125;//æ±‚æœ€å¤§å€¼å‡½æ•°public int max(int a, int b)&#123;if(a&gt;b)&#123;return a;&#125; else &#123;return b;&#125;&#125;public static void main(String[] args) &#123;BottomUpTopCutRod cut = new BottomUpTopCutRod();int lost = cut.bottomUpTopCutRod(cut.a, 10);System.out.println(lost);&#125;&#125; ä¼˜åŠ¿ï¼šå®ç°äº†è¿è¡Œæ—¶é—´å¤æ‚åº¦n*n åŠ¨æ€è§„åˆ’åŸç†é€‚ç”¨åº”ç”¨åŠ¨æ€è§„åˆ’æ–¹æ³•æ±‚è§£çš„æœ€ä¼˜åŒ–é—®é¢˜åº”è¯¥å…·å¤‡çš„ä¸¤ä¸ªè¦ç´ ï¼šæœ€ä¼˜å­ç»“æ„å’Œå­é—®é¢˜é‡å  æœ€ä¼˜å­ç»“æ„å¦‚æœä¸€ä¸ªé—®é¢˜çš„æœ€ä¼˜è§£åŒ…å«å…¶å­é—®é¢˜çš„æœ€ä¼˜è§£ï¼Œæˆ‘ä»¬å°±ç§°è¿™ä¸ªé—®é¢˜å…·æœ‰æœ€ä¼˜å­ç»“æ„æ€§è´¨ã€‚ä¾‹å¦‚ï¼šæ— æƒæœ€çŸ­è·¯å¾„ã€‚ é‡å å­é—®é¢˜å¦‚æœé€’å½’ç®—æ³•åå¤æ±‚è§£ç›¸åŒçš„å­é—®é¢˜ï¼Œæˆ‘ä»¬å°±ç§°æœ€ä¼˜åŒ–é—®é¢˜å…·æœ‰é‡å å­é—®é¢˜æ€§è´¨ã€‚ä¾‹å¦‚é’¢æ¡åˆ‡å‰²ã€‚ æ€»ç»“æ…¢æ…¢æ‡‚ä¸€ç‚¹å°ç®—æ³•æ€æƒ³ã€‚]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ç®—æ³•å¯¼è®º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§‚ã€Šé©´å¾—æ°´ã€‹å‘»åŸ]]></title>
    <url>%2F2017%2F05%2F11%2F%E7%94%9F%E6%B4%BB%2F%E8%A7%82%E3%80%8A%E9%A9%B4%E5%BE%97%E6%B0%B4%E3%80%8B%E5%91%BB%E5%90%9F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå…¶å®å½“èº«è¾¹åŒå­¦éƒ½åœ¨æ‰“æ¸¸æˆçš„æ—¶å€™ï¼Œæˆ‘å´ä¸èƒ½é™ä¸‹å¿ƒæ¥äº†ï¼Œå†…å¿ƒä»ç„¶æ˜¯æµ®èºï¼Œæ—¢ç„¶ä¸èƒ½æ”¹è®ºæ–‡ï¼Œæ‰€ä»¥è‡ªå·±å°±æ‰¾ç”µå½±çœ‹å§ã€‚è‡ªè®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ªä¸æ‡‚å¾—äº«å—çš„äººï¼Œæ‰€ä»¥åœ¨å¤§è„‘æ€ç´¢è‰¯ä¹…ä¹‹åï¼Œå†³å®šè§‚çœ‹å¥½ä¹…ä¹‹å‰è¯„ä»·è¿˜ä¸é”™çš„ç”µå½±ã€Šé©´å¾—æ°´ã€‹ã€‚ æ€»è¯´æˆ‘ä¸çŸ¥é“è¯¥ä»¥ä»€ä¹ˆè§’åº¦æ¥è¯„ä»·è¿™éƒ¨ç”µå½±ï¼Œä½†è¿™éƒ¨ç”µå½±ç»™æˆ‘æ„Ÿå—æ˜¯æ·±åˆ»ï¼Œè‡³å°‘åœ¨çµé­‚ä¸Šè¿˜æ˜¯æœ‰ä¸€å®šçš„å†²å‡»ï¼Œæ„Ÿè§‰ä½œè€…ä¸å¯¼æ¼”æŠŠæ¯ä¸ªè§’è‰²æƒ³è¦è¡¨è¾¾çš„æ€æƒ³åŸºæœ¬ä¸Šéƒ½è¡¨è¾¾å‡ºæ¥äº†ï¼Œä¸‹é¢æˆ‘ä¹Ÿå°†æŒ‰è¿™äº›è§’è‰²æŠŠåœ¨æˆ‘èº«ä¸Šèƒ½å¤Ÿä½“ä¼šåˆ°çš„æ€æƒ³è¯´ä¸€ä¸‹ï¼Œè‡³å°‘åœ¨æˆ‘å¿ƒé‡Œï¼Œè¿™æ˜¯ä¸€éƒ¨å¥½ç”µå½±ã€‚ è§’è‰²æ€æƒ³æ ¡é•¿è¿™ä¸ªä¸€ä¸ªæœ‰æŠ±è´Ÿçš„æ ¡é•¿ï¼Œä½†æ˜¯å´åˆç‰¹åˆ«çš„è‡ªç§ï¼Œä¸ºäº†è¾¾æˆè‡ªå·±çš„æŠ±è´Ÿï¼Œä»–é€‰æ‹©äº†å±ˆæœï¼Œè™½ç„¶åœ¨æŸäº›ç‰‡æ®µæ¥è¯´ï¼Œä»–æœ‰ä¸€ç‚¹æƒ³åæŠ—ï¼Œå¦‚ä»–ä¸èƒ½å¿å—è£´é­å±±å»éª‚å¼ ä¸€æ›¼ï¼Œä½†æ˜¯é‚£ä¸€ç‚¹åæŠ—å´æ˜¯é‚£ä¹ˆæ— åŠ›ï¼Œåˆ°æœ€åä»–é€‰æ‹©äº†å±ˆæœï¼Œå±ˆæœåˆ°äº†è®©è‡ªå·±çš„å¥³å„¿å»åšç‰ºç‰²ã€‚å…³äºè¿™ä¸ªè§’è‰²æˆ‘ä¸æƒ³åšå¤ªå¤šè¯„ä»·ï¼Œä»–æ€»è¯´ä»¥å¤§å±€ä¸ºé‡ï¼Œæˆ–è®¸åœ¨ç”Ÿæ´»ä¸­å¾ˆå¤šäººéƒ½ä¼šè¿™ä¹ˆåšï¼Œè‡ªç§åˆ°å¯ä»¥ç‰ºç‰²æ‰å¾ˆå¤šã€‚ è£´é­å±±è¿™ä¸ªè§’è‰²åº”è¯¥å°±æ˜¯ç°åœ¨å¾ˆå¤šäººæ‰€è¯´çš„è…¹é»‘å§ï¼Œè‡ªå·±å¾—ä¸åˆ°ï¼Œå°±å®æ„¿æŠŠä»–æ¯æ‰ï¼Œä»–ä»ä¸ä»‹æ„å¼ ä¸€æ›¼çš„å‡ºèº«æ„¿æ„å¨¶å¥¹ï¼Œåˆ°æŒ‡ç€ä»–çš„é¼»å­éª‚ï¼Œè¿™ä¸ªè½¬å˜è®©å¾ˆå¤šäººå¿ƒå‡‰ï¼Œè¿½ä¸åˆ°è¿˜èƒ½åšæœ‹å‹ä¹ˆï¼Œä»–çš„å›ç­”å‘Šè¯‰æˆ‘ä»¬ï¼Œä»–ä¸æå¥¹å·²ç»æ˜¯æœ€å¥½çš„ç»“æœäº†ã€‚çˆ±ä¸€ä¸ªå¯ä»¥éšæ—¶ä¸ºå¥¹ç€æƒ³ï¼Œæ¨ä¸€ä¸ªäººå¸Œæœ›æ‰€æœ‰äººéƒ½æ¨ä»–ã€‚ é“œåŒ ä¹Ÿè®¸ä»–åé¢å˜å¾—å¾ˆåï¼Œä½†æ˜¯æˆ‘ä»å¤´åˆ°å°¾éƒ½è®¤ä¸ºä»–æ˜¯è¿™éƒ¨å‰§æœ€å¯æ€œçš„äººï¼Œä»–åŸæ¥æ˜¯ä¸€ä¸ªå•çº¯è‡³æçš„äººï¼Œå‘½è¿ä½¿ç„¶ä»–åŠ å…¥åˆ°äº†ä¸€ä¸ªéª—å­é›†å›¢å§ï¼Œå› ä¸ºå•çº¯æ‰ä¼šè®¤ä¸ºå¼ ä¸€æ›¼ä¼šå–œæ¬¢ä»–å§ï¼Œå› ä¸ºå•çº¯æ‰€ä»¥æœŸæœ›å¤ªé«˜ï¼Œè¿™å¯¼è‡´åœ¨å¼ ä¸€æ›¼éª‚ä»–ç‰²å£ä¹‹åå¼€å§‹æœ€å¼ºçƒˆçš„æŠ±è´Ÿã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹ä»–è¿™ä¸ªè§‰å¾—ä¼ é€’äº†ä¸å¥½çš„æ¦‚å¿µï¼Œæœ‰çŸ¥è¯†ä¸æ˜¯ä¸ºäº†æ›´å¥½çš„æŠ±è´Ÿï¼Œè€Œæ˜¯åº”è¯¥ä¸ºäº†æ›´å¥½çš„å¸®åŠ©åˆ«äººï¼Œè™½ç„¶ä»–çš„è¡Œä¸ºå¯ä»¥ç†è§£ï¼Œä½†æ˜¯å´ä¸æå€¡ï¼Œä»ä»–åˆ°æœ€åè¿˜æ˜¯æƒ³å»ç¾å›½å­¦ä¹ ï¼Œå¯ä»¥çœ‹å‡ºä»–è¿˜æ˜¯å¾ˆæƒ³å­¦ä¹ çš„ï¼Œæƒ³è„±ç¦»æ–‡ç›²è¿™ä¸ªè¡Œåˆ—ã€‚ å¼ ä¸€æ›¼è¿™æ˜¯ä¸€ä¸ªä¸ç•ä¸–ä¿—çš„çœ¼å…‰ï¼Œå‹‡æ•¢è¿½æ±‚è‡ªç”±çš„å¥³å­ï¼Œä¹Ÿä¸èƒ½è¯´æ˜¯é“å¾·è´¥åå§ï¼Œè™½ç„¶å’Œæœ‰å¦‡ä¹‹å¤«æä¸€èµ·ä¸å¤ªå¥½ï¼Œä½†æ˜¯ä»–è‡ªå·±ä¹Ÿæœ‰è‡ªå·±çš„åŸåˆ™ï¼Œå°±åƒä»–ä¸€å¼€å§‹ä¸æ„¿æ„å°†å¥¹å’Œé“œåŒ çš„äº‹æƒ…è¯´å‡ºæ¥ä¸€æ ·ï¼Œä»–æœ‰è‡ªå·±ä¸€å®šçš„åŸåˆ™ã€‚ä½†æ˜¯åœ¨æ ¡é•¿çš„å±ˆæœä¸‹ï¼Œä¹Ÿé€ å°±äº†ä»–çš„æ‚²å‰§ï¼Œæœ€åå¼€æªè‡ªæ€äº†ã€‚ å‘¨é“ç”·è¿™ä¸ªè§’è‰²ä¹Ÿæ˜¯åæ˜ äº†ä¸€éƒ¨åˆ†äººï¼Œä»–å–œæ¬¢å­™ä½³ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰è¯´å‡ºæ¥ï¼Œä¹Ÿç®—å•çº¯è€¿ç›´çš„äººï¼Œå¹³æ—¶è„¾æ°”æŒºå†²ï¼Œåœ¨åˆ«äººè¦åŠ¨å­™ä½³çš„æ—¶å€™ä¹Ÿç«‹é©¬ç«™äº†å‡ºæ¥ï¼Œå¯æƒœåœ¨æ“¦è¿‡æªå­çš„ä¹‹åï¼Œä»–é€‰æ‹©äº†å±ˆæœï¼Œä»–æ…¢æ…¢å¼€å§‹æ”¶æ•›è‡ªå·±ï¼Œåªæ˜¯ä¸ºäº†èƒ½å¤Ÿæ´»ä¸‹å»ï¼Œä»–ç”šè‡³å¯ä»¥è®¤å¿å—å­™ä½³å»å«ç»™é“œåŒ ï¼Œæ‰€ä»¥è¯´ï¼Œæ‰€è°“çš„çˆ±åœ¨ç°å®çš„ç”Ÿä¸æ­»ä¹‹é—´æ˜¯é‚£ä¹ˆçš„ä¸å ªã€‚ å­™ä½³è¿™ä¸ªäººæˆ–è®¸æ˜¯è¿™éƒ¨å‰§ä¸­å®Œå…¨æ²¡æœ‰æ±¡ç‚¹çš„äººå§ï¼Œåº”è¯¥ä¹Ÿæ˜¯å¯¼æ¼”æƒ³è¡¨è¾¾çš„æ­£é¢å½¢è±¡ï¼Œä»–æ˜¯å”¯ä¸€ä¸€ä¸ªæŠŠé©´å¾—æ°´å½“åšäººçœ‹çš„äººï¼Œä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªæƒ³æ­å‘æ•´ä¸ªé˜´è°‹çš„äººï¼Œé¢å¯¹è¿™ä¸€åˆ‡ï¼Œå¥¹è¯´è¿‡å»çš„éƒ½è®©ä»–è¿‡å»çš„è¯ï¼Œé‚£ä¹ˆåªèƒ½è¶Šæ¥è¶Šé”™ï¼Œä¸èƒ½è®©é”™è¯¯ä¸€ç›´å»¶ç»­ä¸‹å»ã€‚è«åæˆ³ä¸­å†…å¿ƒã€‚ ç‰¹æ´¾å‘˜ä¸€ä¸ªç›®ä¸è¯†ä¸ï¼Œå´å‡è£…è‹±å›½ç•™å­¦å›æ¥çš„å®˜å‘˜ï¼Œæ‰€è°“çš„æ°‘é—´æ•™è‚²å®¶çš„è¯„é€‰ï¼Œä¸è¿‡æ˜¯æ•™è‚²éƒ¨æ•›è´¢çš„åå¤´ï¼Œä»è¢«éª—åˆ°ä¸€èµ·éª—è¯´æ˜æ”¿åºœçš„è…è´¥ä¸å¼ºåŠ¿ï¼Œä»åä¸‡åˆ°ä¸‰ä¸‡ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¿ƒå‡‰ã€‚ æ€»ç»“ä¸»è¦äººç‰©å„æœ‰å„çš„è´£ä»»ï¼Œä»–ä»¬éƒ½ååº”äº†è¿™ä¸ªä¸–ç•Œä¸Šçš„ä¸€éƒ¨åˆ†äººï¼Œæ‰€ä»¥æ„Ÿå—å¾ˆæ·±ï¼Œç‚¹è¯„ä¸å½“ä¹‹å¤„ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶æ‹…å¾…ã€‚å¥½å§ï¼Œå‘»åŸåˆ°æ­¤ç»“æŸã€‚]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>ç”µå½±</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€‰æ‹©ç®—æ³•]]></title>
    <url>%2F2017%2F05%2F10%2F%E7%AE%97%E6%B3%95%2F%E9%80%89%E6%8B%A9%E7%AE%97%E6%B3%95%2F</url>
    <content type="text"><![CDATA[å¼•ï¼š300000æ˜¯ä¸æ˜¯ä¸€ä¸ªå°ç›®æ ‡ï¼Œä¸çŸ¥é“ä¸ºäº†ç›®çš„è¿˜æ˜¯ç›®çš„ï¼Œåªæƒ³å¥½å¥½åŠªåŠ›ï¼ŒåŠŸåˆ©ä¹Ÿå¥½ï¼Œå®‰æ…°ä¹Ÿç½¢ï¼ æœŸæœ›ä¸ºçº¿æ€§æ—¶é—´çš„é€‰æ‹©ç®—æ³•ç®—æ³•æ€æƒ³ï¼š æ£€æŸ¥æ•°ç»„æ˜¯å¦åªæœ‰ä¸€ä¸ªæ•°ï¼Œå¦‚æ˜¯ï¼Œåªå¥½è¿”å›è¯¥æ•° é‡‡ç”¨éšæœºåˆ†å‰²å°†æ•°ç»„æ°›å›´a[p..q-1]å’Œa[q+1..r]å¹¶è¿”å›ä¸»å…ƒq æ£€æŸ¥å¦‚æœè¯¥ä¸»å…ƒå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ•°ï¼Œå°±è¿”å› åˆ¤æ–­å‰åŠéƒ¨åˆ†çš„ä¸ªæ•°ï¼Œå¦‚æœè¦æ‰¾çš„é¡ºåºå¤§äºå‰é¢çš„ä¸ªæ•°ï¼Œå°±é€’å½’è°ƒç”¨åé¢çš„æ•°ç»„ï¼Œå¦åˆ™é€’å½’è°ƒç”¨å‰é¢çš„æ•°ç»„ ä»£ç å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859import java.util.Random;public class Randomized_select &#123;public int randomized_select(int[] a,int p, int r,int i)&#123;//å¦‚æœåˆ†å‰²åˆ°åªå‰©ä¸€ä¸ªå…ƒç´ äº†ï¼Œé‚£ä¹ˆå°±æ˜¯è¿™ä¸ªäº†if(p == r)&#123;return a[p];&#125;//éšæœºåˆ†å‰²int q = randompartition(a, p, r);//ç¡®å®šqæ˜¯ç¬¬å‡ å°çš„æ•°int k = q-p+1;if(k == i) &#123;return a[q];&#125;else if(k&lt;i)&#123;//é€’å½’è°ƒç”¨ååŠéƒ¨åˆ†çš„æ•°return randomized_select(a, q+1, r, i-k);&#125; else &#123;//é€’å½’è°ƒç”¨å‰åŠéƒ¨åˆ†çš„æ•°return randomized_select(a, p, q-1, i);&#125; &#125;//åˆ†å‰²å‡½æ•°public int partition(int[] a,int p,int r)&#123;int x = a[r];int i = -1;int temp = 0;for (int j = 0; j &lt; a.length-1; j++) &#123;if(a[j]&lt;x)&#123;i=i+1;temp = a[i];a[i] = a[j];a[j] = temp;&#125;&#125;temp = a[i+1];a[i+1] = x;a[r] = temp;return i+1;&#125;//éšæœºåˆ†å‰² public int randompartition(int[] a,int p,int r)&#123;int temp = 0;Random random = new Random();int i = random.nextInt(r);temp = a[i];a[i] = a[r];a[r] = temp;return partition(a, p, r);&#125;public static void main(String[] args) &#123;int[] a = new int[]&#123;3,2,9,0,7,5,4,8,6,1&#125;;Randomized_select select = new Randomized_select();int num = select.randomized_select(a, 0, a.length-1, 10);System.out.println(num);&#125;&#125; ç®—æ³•åˆ†æï¼šæœŸæœ›æ—¶é—´å¤æ‚åº¦æ˜¯çº¿æ€§çš„O(n),ä½†æ˜¯æœ€åçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n*n) æœ€åæƒ…å†µä¸ºçº¿æ€§æ—¶é—´çš„é€‰æ‹©ç®—æ³•ç®—æ³•æ€æƒ³ï¼š å°†è¾“å…¥æ•°ç»„çš„nä¸ªå…ƒç´ åˆ’åˆ†ä¸ºn/5ç»„ï¼Œæ¯ç»„5ä¸ªå…ƒç´ ï¼Œä¸”è‡³å¤šåªæœ‰ä¸€ç»„ç”±å‰©ä¸‹çš„nmod5ä¸ªå…ƒç´ ç»„æˆã€‚ å¯»æ‰¾æ¯ä¸€ä¸ªç»„çš„ä¸­ä½æ•°ï¼šé¦–å…ˆå¯¹æ¯ç»„å…ƒç´ è¿›è¡Œæ’å…¥æ’åºï¼Œç„¶åç¡®å®šæ¯ç»„çš„ä¸­ä½æ•°ã€‚ å¯¹ç¬¬2éƒ¨çš„ä¸­ä½æ•°æ•°ç»„åˆ©ç”¨é€’å½’è°ƒç”¨å‰é¢çš„random_select()æ±‚å–ä¸­ä½æ•°x åˆ©ç”¨ä¿®æ”¹çš„partition(),æŒ‰ä¸­ä½æ•°xè¿›è¡Œåˆ’åˆ†ï¼Œå¾—åˆ°æ¯”xå°çš„æ•°æœ‰kä¸ª å¦‚æœi=kåˆ™è¿”å›xã€‚å¦‚æœikï¼Œåˆ™åœ¨é«˜åŒºé€’å½’æŸ¥æ‰¾ç¬¬i-kå°çš„å…ƒç´  ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108package select;public class GoodSelect &#123;//æ’å…¥æ’åºpublic void insertsort(int[] a,int p, int r)&#123;for (int i=p+1;i&lt;=r;i++) &#123;int temp = 0;//*ä»åå¾€å‰æ’*for(int j = i;j&gt;p &amp;&amp; a[j]&lt;a[j-1];j--)&#123;temp = a[j];a[j] = a[j-1];a[j-1] = temp;&#125;&#125;&#125;//å¯¹æ•°ç»„A[]åˆ†ç»„ï¼Œæ¯ç»„5ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«è¿›è¡Œæ’å…¥æ’åº,è¿”å›ä¸­ä½æ•°æ•°ç»„public int[] partInsertSort(int[] a,int p,int r) &#123;int i = 0;int[] b;if((r-p+1)%5==0)&#123;b = new int[(r-p+1)/5];&#125; else &#123;b = new int[(r-p+1)/5+1];&#125;int Length = r-p+1;if (Length &lt;= 5) //å…ƒç´ ä¸ªæ•°å°‘äº5ä¸ª&#123; insertsort(a,p,r);b[0]=a[p+(Length-1)/2];&#125;else&#123;for (i=0;i&lt;Length/5;i++)&#123;insertsort(a,p+i*5,p+i*5+4);b[i]=a[i*5+2]; //B[i] å­˜å‚¨å„ç»„ä¸­ä½æ•°&#125;if ( Length%5 != 0 )&#123;insertsort(a,Length-1-(Length-1)%5,Length-1);b[i]=a[Length-1-Length%5/2]; //B[i] å­˜å‚¨æœ€åä¸€ç»„ä¸­ä½æ•°&#125;&#125;return b; // è¿”å›åˆ†ç»„çš„ä¸ªæ•°&#125;//è°ƒç”¨random_selectç®—æ³•ï¼Œé€‰å‡ºä¸­ä½æ•°æ•°ç»„çš„ä¸­ä½æ•°public int selectmid(int[] a)&#123;Randomized_select randomized_select = new Randomized_select();int num = randomized_select.randomized_select(a, 0, a.length-1, (a.length+1)/2);return num; &#125;//å®‰è£…ç²¾å¿ƒæŒ‘é€‰çš„ä¸­ä½æ•°æ¥åˆ†å‰²æ•°ç»„public int partition(int[] a,int p,int r,int x)&#123;int j = p-1;int i = 0;int temp =0;int addr = 0;//è®°å½•æœ€ä½³ä¸­ä½æ•°çš„ä½ç½®for(i = p; i&lt;r+1; i++)&#123;if(a[i]&lt;=x)&#123;j+=1;temp = a[j];a[j] = a[i];a[i] = temp; &#125;if(a[i] == x)&#123;addr = i;&#125; &#125;temp = a[j];a[j] = a[addr];a[addr] = temp;return j;&#125;public int goodselect(int[] a,int p,int r,int i)&#123;//å¦‚æœåˆ†å‰²åˆ°åªå‰©ä¸€ä¸ªå…ƒç´ äº†ï¼Œé‚£ä¹ˆå°±æ˜¯è¿™ä¸ªäº†if(p == r)&#123;return a[p];&#125;int [] b = partInsertSort(a, p, r);int x = selectmid(b);int q = partition(a, p, r, x);//ç¡®å®šqæ˜¯ç¬¬å‡ å°çš„æ•°int k = q-p+1;if(k == i) &#123;return a[q];&#125;else if(k&lt;i)&#123;//é€’å½’è°ƒç”¨ååŠéƒ¨åˆ†çš„æ•°return goodselect(a, q+1, r, i-k);&#125; else &#123;//é€’å½’è°ƒç”¨å‰åŠéƒ¨åˆ†çš„æ•°return goodselect(a, p, q-1, i);&#125;&#125;public static void main(String[] args) &#123;int[] a = new int[]&#123;2,1,4,6,5,8,9,7,11,13,12,15,16&#125;;GoodSelect select = new GoodSelect();int num = select.goodselect(a, 0, a.length-1, 13);System.out.println(num);&#125;&#125; ç®—æ³•æ€»ç»“ï¼šæ¯•ç«Ÿæ˜¯ä¸‰ä¸ªäººå‘æ˜çš„ç®—æ³•ï¼ŒçœŸæ˜¯å¥½ç‰›é€¼çš„ï¼Œå‰å®³ï¼Œå®ç°äº†æœ€åæ—¶é—´è¿˜æ˜¯çº¿æ€§çš„ã€‚å…·ä½“åˆ†æè¯·å‚è€ƒç®—æ³•å¯¼è®ºåŸä¹¦ã€‚ æ€»ç»“ç¬¬äºŒä¸ªç®—æ³•çœŸçš„èŠ±äº†è‡ªå·±å¥½é•¿çš„æ—¶é—´æ¥è°ƒè¯•ï¼Œè¿˜æ˜¯è¯´æ˜è‡ªå·±çš„ç¼–ç èƒ½åŠ›å·®åŠ²ï¼Œè¦å¥½å¥½åŠªåŠ›ï¼Œæ…¢æ…¢æé«˜ï¼ŒåŠ æ²¹ï¼ psï¼šæœ‰ä¸€ç§ä½“ä¼šï¼Œå­¦ç®—æ³•æ˜¯ä¸ºäº†åˆ›é€ ï¼Œå¤§å¤šæ•°äººåªè¦æŠŠä¼˜ç§€çš„æºç åŒ…é‡Œçš„ç®—æ³•ç†è§£äº†å°±å¥½ï¼Œå¹¶åŠ ä»¥ä½¿ç”¨å°±å¥½ï¼]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•å¯¼è®º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[â€œçº¿æ€§æ—¶é—´æ’åºï¼ˆæœªå®Œï¼Œå¾…ç»­ï¼‰â€]]></title>
    <url>%2F2017%2F05%2F10%2F%E7%AE%97%E6%B3%95%2F%E2%80%9C%E7%BA%BF%E6%80%A7%E6%97%B6%E9%97%B4%E6%8E%92%E5%BA%8F%EF%BC%88%E6%9C%AA%E5%AE%8C%EF%BC%8C%E5%BE%85%E7%BB%AD%EF%BC%89%E2%80%9D%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæ’åºæ…¢æ…¢æ¥ï¼Œä»Šå¤©è¦æ¥è§¦åˆ°çº¿æ€§æ—¶é—´æ’åºäº†ï¼šè®¡æ•°æ’åºï¼ŒåŸºæ•°æ’åºï¼Œæ¡¶æ’åºã€‚ è®¡æ•°æ’åºå‰ææ¡ä»¶ï¼šçŸ¥é“è¾“å…¥æ•°ç»„çš„æœ€å¤§å€¼ã€‚ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122public int[] countingsort(int[] a,int k)&#123;//åˆå§‹åŒ–ä¸´æ—¶æ•°ç»„,kä¸ºæ•°ç»„çš„æœ€å¤§å€¼int[] c = new int[k+1];for(int i=0; i&lt;=k; i++) &#123;c[i]=0;&#125;//è·å¾—ç­‰äºiçš„å…ƒç´ ä¸ªæ•°for(int i= 0; i&lt;a.length-1;i++) &#123;c[a[i]] = c[a[i]]+1;&#125;//è·å¾—å°äºç­‰äºiçš„å…ƒç´ ä¸ªæ•°(éšå«äº†é€’å½’è°ƒç”¨)for(int i = 1; i&lt;=k; i++) &#123;c[i] = c[i] +c[i-1];&#125;//æŒ‰é¡ºåºåˆ†åˆ°è¾“å‡ºæ•°ç»„int[] b = new int[a.length];for(int i = a.length-1; i&gt;=0; i--) &#123;b[c[a[i]]] = a[i];c[a[i]] = c[a[i]]-1;&#125;return b;&#125; ä¼˜åŠ£ï¼šå®ç°äº†çº¿æ€§æ—¶é—´ï¼Œä½†æ˜¯ç©ºé—´æŸå¤±æƒ¨é‡ï¼Œåƒæ˜¯å«ä½ æ’åºè¿™ä¸‰ä¸ªæ•°ï¼š1ï¼Œ3ï¼Œ1000000000000ï¼Œé©¬ä¸Šé«˜ä½ç«‹è§ã€‚ åŸºæ•°æ’åºIBMåˆ›å§‹äººå‘æ˜ï¼Œåˆ©ç”¨è¿›åˆ¶æ•°çš„ä½è¿›è¡Œä»ä½åˆ°é«˜æ¯”è¾ƒã€‚å…¶ä¸­ä¼šå°†åŸæ¥çš„æ•°è½¬åŒ–ä¸ºrè¿›åˆ¶æ•°ï¼Œä½¿æ—¶é—´å¤æ‚åº¦å˜ä¸ºçº¿æ€§ã€‚å†™ä¸€ä¸‹ä¼ªä»£ç 123redix-sort(A,d)for i = 1 to duse a stable sort to sort array A on digit i æ¡¶æ’åºæ¡¶æ’åºå‡è®¾æ•°æ®æœä»å‡åŒ€åˆ†å¸ƒï¼Œè®²ä¸€ä¸ªåŒºé—´åˆ†æˆè‹¥å¹²ä¸ªæ¡¶ï¼Œå…ˆå°†æ•°æ®æ”¾åˆ°æ¡¶ä¸­åˆ†å¼€æ’åºå†åˆå¹¶ã€‚ä¼ªä»£ç å¦‚ä¸‹12345678910bucket-sort(A)n = A.lengthlet B[0.. n-1] be a new arrayfor i = 0 to n - 1make B[i] an empty listfor i = 1 to ninsert A[i] into list B[nA[i]]for i = 0 to n - 1sort list B[i] with insertion sortconcatenete the lists B[0],B[1].. B[n-1] together in order å®ƒçš„æœŸæœ›æ—¶é—´ä¸ºçº¿å½¢ã€‚ æ€»ç»“å…¶ä¸­å¯¹äºåŸºæ•°æ’åºå’Œæ¡¶æ’åºç†è§£å¾—ä¸æ˜¯å¾ˆå¥½ï¼Œéœ€è¦åŠ æ·±ç†è§£ï¼Œå†™å‡ºå…·ä½“å®ç°ä»£ç ï¼Œæœªå®Œï¼Œå¾…ç»­â€¦]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•å¯¼è®º</tag>
        <tag>çº¿æ€§æ—¶é—´æ’åº</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å †æ’åº]]></title>
    <url>%2F2017%2F05%2F10%2F%E7%AE%97%E6%B3%95%2F%E5%A0%86%E6%8E%92%E5%BA%8F%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šçœŸçš„æ˜¯çƒ¦ï¼Œè¿ä¸ªhadoopé›†ç¾¤ç¯å¢ƒéƒ½æ­ä¸å¥½ï¼Œå‘ç°ä¸€ä¸ªäººå­¦è¿˜æ˜¯å¾ˆå›°éš¾çš„ï¼Œæƒ³æƒ³è¿˜æ˜¯ä¸€ä¸ªäººçœ‹ç®—æ³•ä¼šç®€å•äº›ï¼Œæ‰€ä»¥æ¥çœ‹çœ‹äº†ï¼Œä»Šå¤©çœ‹å †æ’åºï¼ å †æ’åºç®€å•ä»‹ç»å †æ’åºæ˜¯åŸå€è¿ç®—ï¼Œåæ¥ç”±äºJavaçš„åŸå› æˆ‘ç”¨äº†å˜å€ï¼Œä½†æ˜¯ç®—æ³•çš„æ€æƒ³è¿˜æ˜¯æ²¡æœ‰å˜å¾—çš„.å †åˆ†ä¸ºå¤§é¡¶å †ï¼Œå°é¡¶å †ï¼Œæˆ‘ä»¬ä¸‹é¢ä»¥å¤§é¡¶å †ä¸ºä¾‹ã€‚ ç»´æŠ¤å †æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°åœ¨ä»»ä½•æƒ…å†µä¸‹å­èŠ‚ç‚¹è¦æ¯”æ ¹èŠ‚ç‚¹å°ã€‚å‡½æ•°å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546//å–çˆ¶èŠ‚ç‚¹public int parent(int i)&#123; return (int)Math.ceil(i/2)-1;&#125;//å–å·¦å­æ ‘public int left(int i)&#123; if(i == 0)&#123; return i+1; &#125; else&#123; return 2*i+1; &#125;&#125;//å–å³å­æ ‘public int right(int i)&#123; if(i == 0)&#123; return i+2; &#125; else&#123; return 2*i+2; &#125;&#125;//ç»´æŠ¤å¤§é¡¶å †public int[] max_heapify(int[] a,int i)&#123; int l = left(i); int r = right(i); int largest = 0; int temp = 0; if(l&gt;=a.length &amp;&amp; r&gt;=a.length)&#123; return a; &#125; if(l&lt;a.length &amp;&amp; a[l]&gt;a[i])&#123; largest = l; &#125; else&#123; largest = i; &#125; if(r&lt;a.length &amp;&amp; a[r]&gt;a[largest])&#123; largest = r; &#125; if(largest!=i) &#123; temp = a[i]; a[i] = a[largest]; a[largest] = temp; max_heapify(a, largest); &#125; return a; &#125; å»ºå †åœ¨å¯¹æ•°ç»„éå†å»ºç«‹äºŒå‰æ ‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å®¹æ˜“å¾—å‡ºMath.floor(n/2)åˆ°néƒ½æ˜¯å¶èŠ‚ç‚¹ï¼Œå…¶ä½™æ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å»ºå †å¾—æ—¶å€™å†²æ ¹èŠ‚ç‚¹ä¸æ–­å¾€å‰ç»´æŠ¤å°±å¥½ã€‚ä»£ç å¦‚ä¸‹ï¼š12345678//å»ºå¤§å †public int[] bulid_max_heap(int[] a)&#123; heap_size = a.length; for(int i = (int)Math.floor(a.length/2)-1; i&gt;=0; i--)&#123; max_heapify(a, i); &#125; return a;&#125; å †æ’åºç®—æ³•æ€æƒ³ï¼šå…ˆå–å‡ºé¡¶ï¼Œå†ç»´æŠ¤ï¼Œå†å–é¡¶ï¼Œå†ç»´æŠ¤ï¼ŒçŸ¥é“æœ€åä»£ç å¦‚ä¸‹ï¼š12345678910111213//å †æ’åºç®—æ³•public int[] heapsort(int[] a) &#123; int[] b = new int[a.length];//æ— å¥ˆä¹‹ä¸¾ï¼Œjavaæ²¡æœ‰sizeè¿™ä¸ªå±æ€§ï¼Œæˆ–è€…ç”¨listä¹Ÿå¯ä»¥ bulid_max_heap(a); for(int i = a.length-1; i&gt;=1; i--)&#123; b[i] = a[0]; a[0] = a[i]; a[i] = 0;//ä½¿æœ€åä¸€ä¸ªå…ƒç´ ä¸å‚ä¸æ’åº max_heapify(a, 0); &#125; b[0] = a[0]; return b;&#125; ç®—æ³•æ—¶é—´å¤æ‚åº¦ï¼šnlgn é‡è¦åº”ç”¨â€”â€”ä¼˜å…ˆé˜Ÿåˆ—ä¼˜å…ˆé˜Ÿåˆ—åº”ç”¨äºå…±äº«è®¡ç®—æœºçš„ç³»ç»Ÿçš„ä½œä¸šè°ƒåº¦ï¼Œæœ€å¤§ä¼˜å…ˆé˜Ÿåˆ—è®°å½•å°†è¦æ‰§è¡Œçš„å„ä¸ªä½œä¸šä»¥åŠå®ƒä»¬ä¹‹é—´çš„ç›¸å¯¹ä¼˜å…ˆçº§ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è°ƒç”¨insertæŠŠä¸€ä¸ªæ–°ä½œä¸šåŠ å…¥åˆ°é˜Ÿåˆ—ä¸­æ¥ã€‚è®²ä¸€ä¸‹æœ€å¤§ä¼˜å…ˆåºåˆ—çš„å‡ ä¸ªæ“ä½œã€‚ maximumè·å–æœ€å¤§å€¼ä»£ç å¦‚ä¸‹ï¼š1234 //è·å–æœ€å¤§å€¼public int maximum(int[] a)&#123; return a[1];&#125; å»æ‰å¹¶è¿”å›æ•°ç»„ä¸­çš„æœ€å¤§é”®å€¼å¾—å…ƒç´ ä»£ç å¦‚ä¸‹:12345678910//å»æ‰å¹¶è¿”å›æ•°ç»„ä¸­å…·æœ‰æœ€å¤§é”®å€¼å¾—å…ƒç´ public int extract_max(int[] a)&#123; if(a.length&lt;1)&#123; System.out.println("heap underflow"); &#125; int max = a[0]; a[0] = a[a.length]; max_heapify(a, 0); return max;&#125; æ€»ç»“åŠ æ²¹å‘€åŠ æ²¹ï¼å †æ’åºè¿˜æ˜¯å¼ºå¤§çš„ï¼ŒæœŸå¾…è¿ç”¨ï¼]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•å¯¼è®º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¿«é€Ÿæ’åºåŠéšæœºåŒ–ç®—æ³•]]></title>
    <url>%2F2017%2F05%2F06%2F%E7%AE%97%E6%B3%95%2F%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E5%8F%8A%E9%9A%8F%E6%9C%BA%E5%8C%96%E7%AE%97%E6%B3%95%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šç®—æ³•ä¸€ç›´å¾ˆé‡è¦ï¼Œæœ€è¿‘æ²¡æœ‰å¿ƒæƒ…å»çœ‹é¡¹ç›®çš„ä»£ç ä¸æŠ€æœ¯ï¼Œæ‰€ä»¥å°±æ‹¿èµ·å…¶äº†ç®—æ³•å¯¼è®ºæ¥çœ‹ï¼Œæœ€ç»å…¸çš„å¿«é€Ÿæ’åºåŠéšæœºåŒ–ç®—æ³•ï¼Œjavaå®ç°ã€‚ å¿«é€Ÿæ’åºç®—æ³• æ ¸å¿ƒæ€æƒ³åˆ†æ²»æ€æƒ³å’ŒåŸå€è¿ç®—ï¼šçœ‹ä¸€å¼ å›¾ ç®—æ³•å…·ä½“å®ç° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697 public class QuickSort &#123; public int partition(int[] a,int p,int r)&#123; int x = a[r]; int i = -1; int temp = 0; for (int j = 0; j &lt; a.length-1; j++) &#123; if(a[j]&lt;x)&#123; i=i+1; temp = a[i]; a[i] = a[j]; a[j] = temp; &#125; &#125; temp = a[i+1]; a[i+1] = x; a[r] = temp; return i+1; &#125; public int[] quicksort(int[] b,int p,int r)&#123; if(p&lt;r)&#123; int q = partition(b,p,r); quicksort(b, p, q-1); quicksort(b, q+1, r); &#125; return b; &#125; public static void main(String[] args) &#123; QuickSort sort = new QuickSort(); int[] a = &#123;2,8,7,1,3,5,6,4&#125;; int[] b = sort.quicksort(a, 0, a.length-1); for (int i : b) &#123; System.out.print(i+" "); &#125; &#125; &#125;3.æ—¶é—´å¤æ‚åº¦é€šè¿‡åˆ†ææˆ‘ä»¬æœ€çœ‹é‡çš„å¹³å‡å¤æ‚åº¦æ˜¯nlgn## éšæœºåŒ–ç®—æ³•1. æ ¸å¿ƒæ€æƒ³åœ¨ç®—æ³•åŠ å…¥éšæœºæ€§ï¼Œè¦ä¹ˆåœ¨ä½¿åºåˆ—ç”ŸæˆéšæœºåŒ–ï¼Œè¦ä¹ˆå°±æ˜¯ä½¿ä¸»å…ƒéšæœºåŒ–ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ä¸»å…ƒéšæœºåŒ–ã€‚2. ç®—æ³•å…·ä½“å®ç°&gt; import java.util.Random; public class RandomQuickSort &#123; public int partition(int[] a,int p,int r)&#123; int x = a[r]; int i = -1; int temp = 0; for (int j = 0; j &lt; a.length-1; j++) &#123; if(a[j]&lt;x)&#123; i=i+1; temp = a[i]; a[i] = a[j]; a[j] = temp; &#125; &#125; temp = a[i+1]; a[i+1] = x; a[r] = temp; return i+1; &#125; public int randompartition(int[] a,int p,int r)&#123; int temp = 0; Random random = new Random(); int i = random.nextInt(r); temp = a[i]; a[i] = a[r]; a[r] = temp; return partition(a, p, r); &#125; public int[] randomquicksort(int[] b,int p,int r)&#123; if(p&lt;r)&#123; int q = randompartition(b, p, r); randomquicksort(b, p, q-1); randomquicksort(b, q+1, r); &#125; return b; &#125; public static void main(String[] args) &#123; RandomQuickSort sort = new RandomQuickSort(); int[] a = &#123;2,8,7,1,3,5,6,4&#125;; int[] b = sort.randomquicksort(a, 0, a.length-1); for (int i : b) &#123; System.out.print(i+" "); &#125; &#125; &#125; æ—¶é—´å¤æ‚åº¦ é€šè¿‡åˆ†ææˆ‘ä»¬æœ€çœ‹é‡çš„å¹³å‡å¤æ‚åº¦æ˜¯nlgn åŸºæœ¬æ’åºç®—æ³• å°ç»“ï¼šåŒç­‰æƒ…å†µä¸‹å¿«é€Ÿæ’åº&gt;éšæœºåŒ–ç®—æ³•&gt;å½’å¹¶æ’åº&gt;æ’å…¥æ’åºï¼›åœ¨æœ‰åºçš„æƒ…å†µä¸‹éšæœºåŒ–ç®—æ³•&gt;å¿«é€Ÿæ’åº æ€»ç»“æ…¢æ…¢èµ°ï¼Œä¸è¦æ€¥ï¼]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>ç®—æ³•å¯¼è®º</tag>
        <tag>æ’åº</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[String,StringBuilder,StringBufferåŒºåˆ«]]></title>
    <url>%2F2017%2F05%2F04%2FJava%E5%9F%BA%E7%A1%80%2FString-StringBuilder-StringBuffer%E5%8C%BA%E5%88%AB%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šæœ€è¿‘å¿ƒæƒ…éå¸¸çš„ä¸é™ï¼Œæˆ‘çŸ¥é“è‡ªå·±éœ€è¦æ²‰ä¸‹å¿ƒå»æ²‰æ·€ï¼Œæ…¢æ…¢æ¥ï¼Œå°æœ‹å‹ã€‚ä»Šå¤©è°ˆè°ˆ3ä¸ªå­—ç¬¦ä¸²ç±» StringæŸ¥çœ‹Stringæºç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹åˆ°&gt; public final class String ä»æºç ä¸­å¯¹Stringçš„å®šä¹‰å¯ä»¥çŸ¥é“å®ƒæ˜¯finalç±»ï¼Œè¿™æ„å‘³ç€å¥¹ä¸å¯è¢«ç»§æ‰¿ï¼Œä¹Ÿä¸å¯è¢«æ›´æ”¹ã€‚è€Œä¸”æ€»å®ƒçš„æ–¹æ³•ä¸­ä¹Ÿæ²¡æœ‰å¯ä»¥æ‹¼æ¥å­—ç¬¦ä¸²çš„å‡½æ•°ã€‚ StringBuilderæŸ¥çœ‹StringBuilderæºç çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°è¿™æ ·çš„å®šä¹‰ï¼š&gt; public final class StringBuilder extends AbstractStringBuilder æˆ‘ä»¬å‘ç°ä»–ä¹Ÿæ˜¯finalç±»ï¼Œä½†æ˜¯å®ƒå´åˆappend()æ–¹æ³•ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬æ‰¾åˆ°å®ƒçš„append(): @Override public StringBuilder append(String str) { super.append(str); return this; } æˆ‘ä»¬çœ‹åˆ°ä»–çš„append()æ–¹æ³•æ˜¯è°ƒç”¨ä»–çš„çˆ¶ç±»æ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­çœ‹çœ‹ä»–çš„çˆ¶ç±»æ˜¯åœ¨æä»€ä¹ˆé¬¼ğŸ‘»&gt; public AbstractStringBuilder append(String str) { if (str == null) return appendNull(); int len = str.length(); ensureCapacityInternal(count + len); str.getChars(0, len, value, count); count += len; return this; } æˆ‘ä»¬ç»ˆäºæ‰¾åˆ°ä»–æ€ä¹ˆåˆè¿™ä¸ªæ·»åŠ å­—ç¬¦ä¸²çš„æ–¹æ³•äº†ã€‚å…·ä½“AbstractStringBuilderæ˜¯æ€ä¹ˆå®ç°æ·»åŠ çš„å°±è®©æƒ³è¦äº†è§£çš„äººç»§ç»­å¾€ä¸‹çœ‹æºç å°±å¥½äº†ã€‚ å¯¹æ¯”string: æˆ‘ä»¬å¯ä»¥ä»æ—¥å¸¸ç¼–å†™çš„ä»£ç å¯ä»¥äº†è§£åˆ°ï¼Œç”¨Stringæ‹¼æ¥ç”±äºæ¯æ¬¡éƒ½æ˜¯æ–°å»ºä¸€ä¸ªå¯¹è±¡æ‰€ä»¥æ•ˆç‡è‡ªç„¶æ˜¯ä½çš„ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™è¿˜æ˜¯ç”¨StringBuilderæ¯”è¾ƒå¥½ï¼Œä½†æ˜¯å¯¹äºå•ä¸ªå¸¸é‡å­—ç¬¦ä¸²æ¥è¯´è¿˜æ˜¯Stringå¥½ï¼Œå› ä¸ºå®ƒæ˜¯æ”¾åœ¨å¸¸é‡æ± é‡Œï¼Œè¯»å–é€Ÿåº¦æ¯”æ”¾åœ¨å †ä¸­çš„å¯¹è±¡è‡ªç„¶æ˜¯è¦å¿«å¾ˆå¤šã€‚ StringBufferè¿™åˆæ˜¯ä¸€ä¸ªä»€ä¹ˆé¬¼ï¼Œç»§ç»­çœ‹æºç å§ public final class StringBuffer extends AbstractStringBuilder è¿™ä¸ªå’ŒStringBuilderä¸€æ ·ä¹Ÿæ˜¯finalç±»ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ä¹Ÿæ˜¯ç»§æ‰¿äº†AbstractStringBuilderï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¹Ÿæœ‰append()æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å®ƒçš„append()æ–¹æ³•ã€‚ public synchronized StringBuffer append(String str) { toStringCache = null; super.append(str); return this; } æˆ‘ä»¬çœ‹åˆ°å®ƒçš„append()æ–¹æ³•åŠ å…¥äº†synchronizedå…³é”®å­—ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸ªçº¿ç¨‹å®‰å…¨çš„ç±» å’ŒStringBuilderçš„åŒºåˆ«ï¼š ç”±äºä»–æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥è‡ªç„¶ç‰ºç‰²äº†æ•ˆç‡ï¼Œåœ¨æ“ä½œé€Ÿåº¦ä¸Šæ²¡æœ‰StringBuilderå¿«ã€‚ æ€»ç»“ï¼šç‚¹ç‚¹æ»´æ»´ç§¯ç´¯]]></content>
      <categories>
        <category>JavaåŸºç¡€</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¯·ä¸è¦æ— è„‘]]></title>
    <url>%2F2017%2F04%2F27%2F%E7%94%9F%E6%B4%BB%2F%E8%AF%B7%E4%B8%8D%E8%A6%81%E6%97%A0%E8%84%91%2F</url>
    <content type="text"><![CDATA[å¤§å–Šä¸€å£°å¯†ç . Decrypt U2FsdGVkX19f9OEiqcvlsO6dzWzQbtVWhE/DgyiFm/2FKPp3KsYDEMgmqx9ydqAlHXi3u2/5lRlM1TDzxp6UQAfwmMGBZuwUANuXqmAjcEja72Tr8iYNrUcVDf91K+bPhusXzp+q0Kxc8PEDxLd8MC4voX1wCvQPdJNsNbLrqu5I8wL3UAQSTYFq/nV3jZqTRAtHgX2BqW2P5aFrJc6XsFcu67zMH4UBXg/jEQPi0fas4UZfhcVWIysg88l2UD9qAwHyZsnS9srv7Jy41iJ5yLOFRhqXunD2IYQoKYWWWnZbOWHgStWcYLDc+Sg4ltCsiwA9KCaE3YRRXyqd0jK8zFMWfRw7sfxCllz2J1m7ZKvlKz6a+NxKDnPmCpiu1n8mmbuvpfGIAhxWYv7q2BCeMyoT8SaUn0SjHvDnVffLPCfhDh6G3B2NWYB3dhFWVStH0LDv0IXayfr1wESPM3Ct5ovRjlzKkvSWcAmPZMie9glqOUO0P3EgWq4OTwDCG5cqDtDiF68icoXeIEulOMwnG4tX+EEV8OEzGiCwqPf6SRWaOaVXeEjGGyDP7ZGRR5zuR6YLv6skko4I3riAGXkLp+IPTWIrRUqrUMMUm6qPVr2LsQLdtS+RcBKlmLFm0XUQR1DNZv73NJ3paSlmNOFwIO0J8n3qfm+qiwB/aeCagGyYFttYyPKHTyLZZC6Vp6/AYS5RLP/YVIUutULhPFH3QV7kYsxaYmKQPArIT6IDsN7r/mWNlRXU1kpoEYRg2H4irAHrooSYoKZICMBxt2wbxIrhyc3UOQM71sRxVFa6gxt1FwMnLq/28N/MtGGZbN0QuHHA/OdDXsFEKL9uYGfqPl/uVQia64sES/fhoYgXYluvG3IVoPyo+q4nglZLqkYVlXXv4EAVluv0WDbum/xjYVsuXQ8cN72C1iM0XC5SUf4l8NVZvfnpSYQUTtofor+26xbFl2Lb14/i+x8COxveBg12z9jJXm77nPRk2AaB0hn1jELW+D/pBo90SpeiPYQd3xRgfVwHZbdaSQWBDH+7WTkANECJNjpoR3+Da/B9F0wuq6k65vUyPPbt2Jnbe9LVFh7nCUD7ojbch+DG7noszlYDdPchYY0tEs5khxRpjH4A3W0cPvZcOlrsxNxcoo/CZBl2/EU8A8PN6SlcYvD5bNJqb2cWEi+IQAntItykbMWZ1jklt9mMAULXYuxIfi+2i5KwnWyZvxu/jmPDEyRWVETN4xAfznFyo65UMquYETVSVb/27AYAdIPh1Zawm7kUtD42z+va4B2ALdzB++M80g74OJVAkw5COnc4hAGaTR8sg1IkNlAGyn1yTn7krSOCftDJWmubWzTgpuEp50GsWwOBNDnBIp3moMROagkWBUaegek9lmq1rOmuw4pgH8dwvvEnF0qFAZiKSoGhTl1ou9la634FZchtcpWD0O8v+3yrjQME/9Jrx1HsURm09ralql4uin3dXq1i+VxAPp649Gt012CCVQCv4RCEHZ2HRCH5IgtFvEK7UwwrmEHV4ii9fWkL5sx+VHVGr5mXO4Q0op4ERFJ386uluCZj/kBhcZXOoMNVamSIJfIKrcg8k2UCBjVk8QcIC6/1eeHp7TQy+XgSFOa2VKMq892wTg1R/9AlkS6FO8N09ZTZhelVrVNxP2UW/aF6wwP6vZ/OLC3Qu0Hu3wTUaMGVBDrvDf6U50myIuCtzdgFyTOGr0uJg5oud60mxFLZjnPQeTsWljRWEg19FwnyKbVGq6KW6YwL3B1+rXezgwHdgJOAXDYveZH2CWInlhfqna9ihrPyJnqXGjqJPla9Duf6jbn+RfHwFSslQD3MQ0qy09JuIxrgOOYrZedvrrtwJetC+51nRSpDMvDKMIiiOJolUeGZLZt2auwIYMqbXZGCxxa3SYYw1P7KvpMD8exfX5btB81p4lM76ZkiVM91lCJ0fWRAx1uXg4sSzDSgN4McsmXoPAULuqmF9RxK8ARLYcXQVe4Aw5pMX66An2JL0bEkIAuynW6egie4ofNyIt3gVbXiTF48N4orpF4qLtX+VKgUS6qqPEM4xESTuCcAI1eiRuP9IEQ62PtuNJy1PsDA/4MboaEdYAqQP+T7IceU+yG/lJYeMthxDVKgu6xer9GYTEGtXmgT/LJUU2Apig93XtW/6L/4HnWoK7N7k44qSbzaK/Asj2wSORJAjHwX1ip8NXn0KGkXcrmqmrsyqibjYkUj2LqkI4YDrCGEbCBMUFM5PFkE2m0n2A4xRSC1jTqHWcqRXqHqeC/RFlA38LFhDQLZALnA45DNfrFqllLELDe9odOm7mmyMJmwU08bHbucnC/1fcFd2HL9N7EQFc+mXPkS4GsE+YUtbMHY5ht7JhQXv8Z4Iv/Qo3RY55dZ+5W0JJbLkVtoF2IEG/XmRm1vOCqgBjKgikKzgNDhgdZP4qerAf2mZ3600WAHdt8JQcWgBB9tW2nC2ujargXloP+BPs+92i+Fl4UgJIovO5jhU0++q9sTVjGlxQ0WjVRgh60bqNeziNoYoLz4MhxLIjOwUz84rjTRsKvvvhZCawXPUKN3Q51LLaCUI/ZYMTE5H5rhwkMLte5RLtsj8vasajJ3NG11ItC8D71UP4sub0tqyS4RFWaZspHKd2AASvL+YDg4O0oLClWfhLRijRAFYaoI3MKJ0Nx6BIOOn5PaM8sVgq8yRiVwN4Mk2A5dlnZsvu6Kk6+8/3YeGSaOvEH/UUXKurC8J9Wh+j9pmF9KGgd6tVCrwoeFLaP4/fz+KnJtbxal1RTlZokQbNJVecKgbfMz8NvwFeulmKcvznn25PGKJ53fqC3KwnVK60JnmUhxsSFj7JkUx8ZuHg/2OF/5QeFSK6L8DuQJHz6FrmkKM1m6GvFsq5q8P3K+Ct0MPL05cyu8Gf2REE6F//WoOltmHTu3lM3UBjuc39tN7wR3iek5c7rM/WY7I9AFa2mS3b32YdoEGAAdq2KSY4468qiPoIErskM/eFKTcOUmv+LCvCGk/f3nqhl+iTv9GPAVccRAhUftXOoxqdVxXsk9Xv+5bLne4PkhfiQ66FETx5k7Z9Z+SP27nbxqEO1gRAkzHE21tX/tLqT5UAGKA3mBIdmm3NTwj89ym6efmfHCYpMtIhlANUSWOEx9fWasVQwPMqNm+IArKTsD18SQahKKsBuR2CZ45cBR2E912lFwjHIJNu7XRhHkPJiMujXNmJOh/TZ0l9a3A3YJQ4kBEUz+N/SDgg8+bkoq+q2r4/PDRcFLk6C++Ab8sKocN4MSrbv6LI8C8SKE6fSjAhYDxCtoxOF//UbEStwjCjUIsjrgJgReSmUenIsuMDD6qu+1mJWPXqoH2bq0F6DNUXCtbzpk/DYUTwuYv058zxt8pTB5r2IsLaaminfJTpnmDkECzjJKaf0ZkMfYzgZ7f1vL+utSWofEqwsc6qAvX2hpMKjww6SxIOtoUIFdStZf4Lbs4gevIjEcVDcbaCSwgc8xH68yX9/7RuKRyXjFJUQmzorLDpz/SazRe+7xdWSPHLLt1cd4g95EBkVZcWEejxz7hjTnbx5kf/TyXW4t5vu2GLYfatWbSNvSwLIgBAPs3+euCEvTtxnV/HfrGkeMThlVIkR/txAfPcLQfkpAmCJtI3aBAyrVCmogHebZLa4ksEVHPTjOrQUc7xhuvSwoodXto/visMKrl9F0BlabXvZ/C5pLQAgOenG7VKF+zWV4eO+icE8FEBF592qtFc75SHdor5kRsOkqVmG04dV9QMwSAhFTzmLKYKZIQJo+CV2ifIbzHgtpjD6FQ7u/Ejy43MJYXnxGDQglLfPTrdq44VKTNKEzVjmQ29yA63TFBMUBdiKc/Pkmva8KI98UdUxW79Wj/71adzTHCiQGUlBUazyItpV/D8CvHHTt+yewey3/zqFpyBG17BO37H31CSsitpyKtFQtXz+kA7p5WsGf2FMMSAc8s/2+Tf2XBlyPOba4wXcwiQRfHoOdPYykagVLkREhSL4NUjzDXW9yrDJ5l3CnLujcN+5rbUdRuhZUxAn5rQMX34KpT9kpe1MrMSYTddfcPMkSt1jf9s605RPJiXiLH7tSI/QqgKR0uIuEkn1EAbTCso/n+re7Mr9WW5EqzuO2ukOjzhKeGwLDqS3uhzsykxGC+6bOPGo5pKq4PL8ZRBmecSikeGvURDcpZNi4hC3fUsJoWXQqwCc5y6Yx5/lSrNN1J84hdCFn29ca/uH7te9HBGlbpAgsPk0CtV+Y0+D4gefl8RvGRPpXo7UCGNmS8PFgKOJVGnMHt8vZh7YhbfJAeRa9a/mSUBmp9M6rdASrhP6bHiBeaRVWhur1TsvFZSmKbJJP33swTNGsBeCAUHxHo7V78+EusNTTPZpHAiVuFzDRymFwCVg1r69kz/io7vsGAcizP4DnccLF79VMhbWJwqpsruqa03CF3cl7BssNjgW5pO88qSn8PJgag7dVuBROV3edzxVrcUV8CsHE6MRcB/rqVFVPOdTd//iGoiOhiBwx1mTSAl6hGdyOFWuN9vNuGMNlD9N3RGpuxwUGf14GKSID6z+iHCKM7D/aNozncwHt57baY4oQN0S4MpY4xGbg/FYBU2UP4yUEaDwmWY29F2Cwc7ONUnIkMTaqy+1TAfGgg1gxq0zEeOFZGaR6zZeYVO4wPCohJoDMus4B5wnuR0BVLEaDXLQJmSruQrMhsLxvuNidQf6UGgJeIrxeyVeoaHt2Yk5FWKkv5gU3vPJM9QwEGuGMtytYZ/qNqLsCfZPd4lLSnnKwKg56wE5qWphTmSQmxVBU2HivuK4tUSWNf+9Pi3LP5wKvZ2CinAE0UKK062EcQqDSjAJox+keNi5fjAld97hl7mqIV14VVw3YjFxYbpoINQuZ1Rtrixpcl7m3wARfBk5Hx5YDxXwc/EO6iHJiNwPjiVz6rsZm8K1fSPdjEb7zhJFhMDqylbpkoA76EcNLRh4XlniuXS8GnB/QEB6EbLjkhMewxAgRyehJ8FzTkCIab4q56dpbQEVFD4WwAiJkqjdqfrt4g6pnxr6YFMcsoa2D72qs+fNWMq5KnaDw+7SynyqcOWNzcKKdWeYlZIcmIYXsnFv1Dhbiq0NjuyZjnvgzHWIPeFdrAQr2CNH2sJk3d3xYaKUSqykGUcxoC2PNVg7sbyGIlLYBK+OhomT/DJE3Jf+W50YClJcGTO5NoS6plHu5Wt29XhwLJt1fNZc6nDOyKTel6obFdf5mHfm4U7gMy4BOYTD01vrg8tN/fR65jIwWSm6GUMt/z4Y=]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[è®°ä¸€æ¬¡å¤±è´¥çš„é¢è¯•]]></title>
    <url>%2F2017%2F04%2F26%2F%E7%94%9F%E6%B4%BB%2F%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84%E9%9D%A2%E8%AF%95%2F</url>
    <content type="text"><![CDATA[å¤§å–Šä¸€å£°å¯†ç . Decrypt U2FsdGVkX19cTvSQREOraWlWIie7KYHxipZvGWRer0YWC3QVCYNl6sd1Z6f3SuEmK0HFVONuccDcOjeiNWTEeNOB+7subrSWuifzhTqnBcusxNm7AXvfCcOLKQp+wZIwbPLcaK7sI2lPkx2gAfAKZyp8RO2UEl44rxtdTfFyF9CiRyyI+/6qOMPwTupvp3ry4KuO/ORVT5aQw57z5jOr9Sl4hope2Z+iFt9Qv6hpPNKwSBX8KJR6IjNKgvmo4qdB0msuHaOx36BGoSwRufEvBtY5JluBYkb1/N6k50Q9TrSxXF273pLN79rtK+ntCOOSYM3W5v+PJZXhF/uydemj5NaOnwbmNZ+6MCDZf6ozPN4uwE0mQHabra69TtdA8TYk2CQSWxu/Gw+1GMYWUPfv+jse1sR7Yam/b4/aRloDY8ydQCJJzK+bKDMdmE8NZmufumNdlOmBEWIpbDBEtlrNFPJ3fGsedPTf4qeK7I20Q/WpdViThCVzsvZD512+coLHgrAOhFAS1RuXIZ343JP6S6orMR039WXQGkiKlx67rZAIZFRmNa4Xwv4o/ARLQSQF/RNM4kw1LtDHNbMgYt5Mt9n1j1xbPhw2NYYp8qlTILJ+84ELk2Db5yynPtLYsk3iT3K+YcKoNx597CCFNarLEp6+6AI3TLIWm1/6DsodKhtyE05Eco/2UfApsPXEgoimmFae68b0pkL/D2Wkobmx5Ss8bxETPYeS4uvv/A4ALogP3LGHbjXSkd1VbvA/GcODfdipid2+G547UNgLFkPAuDpY5DseIg2pD2TiTTeL19Cpa5YGnFqHULMzDWkRQaeCVUJdlGWxHzaHUu8uwn6HyvAQYeqXBTq4Px6YGubGbtxTXD0XmmPbRVkTalXEdT7iNQgkYnfnWmHSeW6klnE+e1/8muL0UcZewDINw2vdhuGjTVV+nMwApoTPyT8PLmL/T5t/2f7wOquttb2NVeVbW3UWJ+Wvu+pymclXtZuwZzpCAQf8POeA8oGI61tWgVDTbZSF4BI+wIPN9zFi7I8snxs7PoRmxAUJggh4SNR85mOl2rvdTZT+tyJPJKHPPtKGQu3HSvIoByIXcRFEwu1IgQuGbHlmbvfGMrOg4a6CtkB646xab04WM75wMcdTDpC/5VKQlX5DUyO0WKqw/FyIcVh1thk6ANL1146ddGMEcTWsWcDvOdX6GIKx1scekQ+IMzjUvMxepqJJ+5taZEBZITGSWv275HwBimJqH5kyxLYAyvLzYeyTh3IHVL61r7XhdAat5puTjSwq48CpC8z9clZZv2LL+TXg01z9y2M42+tobP9ikeW8p6537lAVBKodGZv3D3+0ThRcsqw9jkNRe1ENcAHu48IGCJaiqBRvViI/I75COCOpwqosPuOCbHs7KuI+lBEkUfEGs0T2Hv78hc2fj0urxbmZY/XTY9/Mp6/btYAR5cvh/P/wuS/8adOc8j0j9Nv50HAb5B1oA+UOn26XiD6h+OwxnjA8XkTQYZdIesL088gqnknEuUKNuPXY24rDhF195lT61E5wXdFpQKIO7Op58HtBvuecLjWIFDYOSbgVfiorziHnBnGYRxT76FQELaibHp0acKdSS8cYMlioxHaCsACTpP9rfgl22ZwFZOZHxCKSznPa8+S8bV0loonpMwQTCu2m9VQaOl9pkE05to9C3GqXgvFHXDBA4REDp+Dlf8nriaAINLHVYrEoNrWfU3SuuGkg+hL13L1s1BQIK2SDFJEcnH+0l0M/f1ZBc1mcTIh78eB79FeDjEI4XBo2ap5OX2HfSt2Up1POH1aioRY+vLmbhg4yL1YcxUWS4kRKOSsggeXn1lvtFQywgvQdLRQimcQHtMohM9xHXeV0wxJbPsCJLYS5Sg+/EhpfdGoZWh0iKySALaXlEbtaLRBLo/mGO8hWYwUkwtcZfPSYwb4WB4OBmozrH52ytiFsJkpIFgy6bfpD7i0DRD9rzIY/jcWgn40KQB8doPCYucKstLs2UAzZhRVS0dt+pCZ/aBTF9tAII4w5IeG3khtwJe2YlfY/YBv2Dly4vkCfwn9gwBAwzDZXeeVzaSAGWN8mei992frpspvpN9mJswtL8YMXPIIP3L6ptFznQSUgBS56S77frZPioUmRlO0M8Cs6+b5HWIHUFlhqk5lExuyzytLA3CUVGpkA/0lAf2iGUHU6o+JP8zZxpupmbPvPvduOFse75VNbWzhg1jQNG53eDNDps5v8kRz9jijEv4eLL/cIRI5OGJBJ9bFKKrR0ORECGnga5Cp6/MvsDlQE003ZO57gIPvYhTdqz/K+WXod/z/+yXgb2PCF8bVRoAPK5yWvgVmGdNnKPbQjF2H7fTmqmPqXC2Yjzw/eAvS0imZGR2teUeIY6cdOWQEo4F7vkOAWRzFjAG0stjqCq3DggtH4tIxVAffHgUV3KJPw0JjaB9Y/EUlyttbHF3osy+YInSezAYszEeRBa7yhC3Ju+UKVf/4WWLxIhXWlqkJzBCUCVqDgq9UbVYanupeBAGF970vJS6Uw2nT7mzsKd4P6TI/1MIG1/LpjKISYDNo3EuNwZZrVvXXov7PnEXA2m/apbm8mJfZuokURs/hqQlgajshJ/UUotgORV576LULtC1T0BSXi8WIPtxYGaQ0aC7//opvulnKjGFwcgtC8pwRsKqq6VWzMVHcFB9OVelAy2K/nU6L99GpKC9c3BjzS2WPmQJfKahgkHKFfFRaTqWxfltKaUC+a3fDdv35kTT/o/gk0X3ziH4Tqbbx8EAM/T/DUaVlt3MnKcQWzUJRUNpFlMOQLNCZtM1SFuoOcytbFurOaDkiJrqJ+VLjarpZ81V0xSNYfWzoJG+FOy5yhcbPbP/1n+gDnR3kdemdXg4aGVkchWEqJsc07CjU0zYjdpFgING5JLk79lVqAUI2KMstwZTmZxiPpCRrJmoE5AT75BDTiGmqnLs1Fueq1T9Gan3L/CmznrsTrMzWL0TRwkxJmmHTeyuVnX8x87libkfRm/A3zG9/ljx7NUa6DriwFOywLFRlaYu9Od3qgAwVomBy2f2PWsTYhmDun+3HhzDzltlTmMIQz5h6HErozAs6VWfjGR4TVNI7Ndr69x62RDtjvNZoA+O7laA36mN8hT3psorwwV9utKRzch+Tcru6DpTWCd3n80m/GWDXgUhq9857KmqmCjcYO5qAnznfyDISo77kQJvvWcYu8A0xNzXShPtD2IhB2eoO2HRD6d7iCZuvy+56J2lub5G1SGb3ZND9j/rPl+7a+AHexEpP6IhsqsxZJQaGu/Flp5prp6+zE9QMSfwG8VYOludmnaRXw92gA7nI9ugnEDYG0ESX0MvGx08GQFM8uxK1rXAojg8Xec5ngkFMo2zRNTWVR+Y1iSJ+rV0OhI7vejT66ZK3FzRTMEf4ziKfUnLKkUgkt37ICweyyWaW83NvVLzCIlu0iD3dY3MYIXprEKemw4qbr7A1IF3XqbxUTZN2AQkCbBBFVFGPdZWQ2bglAEPtiLfJSIPzBKBE8EplwcPqTlNSxKZletzEO9qVdt239QUo028WytG/7LYe6XnOREVF0N1gaLdub9Wl9j5hOghhKbTR3t8BWEgnKQYrOICnQGxO012XtYXjfBLdhVCZFkb7453Y3WkkI1Ck7W2I74ZdsdTn8e6b6+ZwDAsGOsw6al4BA+8Lkh7bHJIXjdEfhFtMw4JSMncPcRlYR/iBlWaUcRY6gBm3036BtHk2sVy/mdJjfHnlcziBlG1lLY8CwKQxgkUGbqD26dl58gFSEKq2WW1N5/0+zxRXSlyRmnUU2NO0o/fwqCGteg7EQ9oOzVTlH+AGWkKc0AoNxJ93xHZ/GC1NSMnXCyel5gCvss+vGqWM2dsSQ1iYHJGlGhqkvfreRJiu2R8NM+uWaplURBdhtD5E5ioGkJq9pnUaR8b9xcpskyhTEDLI7fOBlKmlhSfc2Dc6u2oc+K8mO2uSD/llDhTiHbW7H7YMBMMd9TCYmFpV7cpJnuQ/X9pS4EdqbceIY+LpqiUfCGoqP2b+bOne7YwKV7YzOCNY0X9kLtKZS8p64iP5LHWkhkVmKSjZ6Zr1NyIogRt1WTkAWumvxi/KgXpwJPkx82bw1vSRVJOk4n5coprUzph3JtuEtBDmfLDJSvmZQjQOb7bGZK2LC2Vk2FYyGVmMVVPgpUX/jW5wAFaNngk8HL8FiF7Rvxn5ESGlBkYQYtipYw1sJG/9EdRAtifhmluawVn5wH3DlS8Z/dAnqHFaECTnTKCmUgeUYgWUaca+pzJLhCFB+27M7OzIBJ3fd5p1VhIP4WAvxVNZf/erwQZiaGOBLewC9M7dH2snQn+ADH2KDRCfdzg4jV6GE3K1wEvYeSqLArNu41TcEyL09SIzMCyMOiHp3n2NhCDiofhtFyhmBh7Wu6O+wdnajvNSF9kyHbyLnx6fCoLUT8UDKb+uLrsJte6dJ0XLqXzZUQSamNRyNdKJxUIBLljjnGKQhZvtYMg2Aeq4JquP2hlHVkykr/b+Zk0gZbpN5hS224mSGASrdWVem8j99PKTJMJvh7WLudj4T+XguD4aGOewXgzl/C206tJfvBI1fPdYUMzKeHrnORR5UTvqq/UB6aXb6lumsKdDDJ56oLwsAPhrvwbd6G8W4Hl4HXcTy0dtoh4+9QUzwiFHkXAa24Db53+pN2T/R9eHSIafe5OpYCwtBQAfxCYRIDs1klwxVqOkuXhR+ToR/E43xgZJjC/kpMOBpL8nP6kLu7ryzTbZd/cDuNOZw7hWnEmIzaxh95bTSdJxnnbe8pXU5zpnFAvirC+YI3/kmjkt3fvGZsS7MaZyTQrdwGNTJvIa4PC9YKaoVVjJWGsNVZel1YEYTpgMYIfOD7szBm1w/en9QajjV0n7u9ONPHIam9QdBjojpQEwdfRC0cRyzrCq8J1AgMrId65WG6/ewHC5CELcPxumS/+XOgQ4kvQNnxmWDbpGEOrca+OUsUyrrW5zjDZOqCWnMADXHH8p0+Wt1ztp2FXgEBQg8bxF0ocrWPG3Q9yPIK6oBe7Bs7UtpFDcBIiuX9+C6Jx2FtYAksdkH7K/VY6LQhRUJvBY6IT9WWH2cYACBSPqVHmrogtwiXZjjZeQ56Vy6Di9C93LgsRQe7GXoe63ODGJ0jtmXArvf2Jl5yd9MTNrc+73iJv1ufI3+2js31MFQu3QG1b4tK4+ur3RG3Ii/2I8tqeX83QFotOHATV563oKK0PFFjNEq09oCWUjVlcU9WgGI9gq3BRqxTq7VmAyfk1zaCmLWZblkciLcBhE5sbjYIvqnGxhwLcEM9LZBZYtS5yb9LSHgacQZroq7EuuE5BXAb3vp4vi5OBZJ6zQp7BH3jNvqezRt2PoVXaZvwf03GpUvJyyNyhaoqAX8G/3aFef2Tq7gQS6RyQmLk23KvUotWj6Dvx/iXiPufbby70ySinBsbFAxeUmNaF6pJmZyvGULFSGaE96GqlLR5yEzANSKUIgQjw/dMshTa0WNf6+zsWtpooiBgHoeKKqJfJAXH+BVjV/Xcfc2WXkwWB0CKoY88dLB/DHmnECaBYdSsmZu3Zvk0pD4ibto+V8atzdQJ2YOE8MOy7hexDBdsKis0isMcdEksf3FD35pZAPcpO2fiX28ctGfkU0AKtXjddZCoxTQdag3Gqh2YqlNE8OXUAaju8zzBEXPXT+ANfUalKQtdWl7mtQhhXHZCLvG1RWljNEoo795MPwZZF5UVLkwUa2ys6nArz5iDQE3N9H0i8hzy8+7ML8emFUz5yPO8TjzYXUnsJxAcG+0yyuiTSbg5voesctofo1EcU+i012pn7MAf48makT+iixHhKAq8CNHLrReN1H9ko1k+ojJf+9jTP7F6FRcDgmIQPHmPrDAVwqFx0fLECIOK/Wej1pxIJ6VYjJzCaGTHsun+lj6RNA1rXJ8+LWNTyKKX8mn3lkaM0EUq6xBlkmjbNvcdqoT39VWwLmTUjnDWftDcqb5PhARUlnGpW+dEIEgsWdMKdK0kq1xSEma0qcTFSS3FnXFeOFHhsMnGvhhsp7UhQc7NwB5U/hP9eAPQbJaHjcH0QThDS3fiGIqpMDEOUsVWlqquc1NuoH/ssRokWAXLVNXgtzb3YL5Z1osiKKN0oVCYlxpDeuKgeSeR8HV+EoHMxtfc3I1JEJRTusdUO+WvGsGU4vOXn8YFyVoUOQMxFlm3ZxihLNK9DHwQqMR6Sof0C7nymsHukIXxq9PFZGDBn6yASgM8a/0p4UZuWgyxafQJrm6An/fUZ4UAE9maqjx+sUMd30Onudu6uy3decDLX3vBADc61gOOa2xuuvft1B2jLvzm4xf96bB6/9Ndc2wgck0j/sjjStQK2PYKTr8BSnY8b9GbQWQKrfGniavPJA0BKqcxBdXKHiR17fy1OrNnf6FA4WcDrBVhbouPRzYpvkn9kbi1pqIzPDFVZu6COfzGic+71CukuE4sW6mBK5Y6u4o4uWPE6jk/8eiRZc0ha0mbZSwO/7a4tFX8q/EQvWSNszGzcac+v7fs7t5xgesQcOSJybz4PoRsPguOaFodk8BfqN07XtwD5FyIvtWQ6maeZCOgs7to82gGkCwR4dDapIihSAELdSQpln1TVpwte7VVyh0kiu0IEyFcPJQQSFcmNdQKlymJxT/S9IH4suSFCEtdQGJDcX9dMwnE1ZQ19mwCCHmCLNxYSP13kbHVJsxs8tjyghIunb9qn6+APJgcp/Pjj+mMoakdd1iUZ66DoCR4LB55eqxP9lYxHYp+EJ/q4vZtqdsv/gpX/AcFsgEvTHorZ9i8R6XegbyRKOTuira7zoKovdOXXawV/sb2n9D1Z0ntPvso5w3WTEAmnAeEXhg0CCzm2YyeB0MZqYRO12KFGQKEm/NUu7nVolUAyO2AAvhluvLmSEcVf99yjBgpJBubGAOshtfydh9My7ldNv8PMfDgQQxOSotzYUS6b6ky4VKTqhmbR644Pk2VU3CdlMF38I0cXTar3uczvk/7McYpTDBt+h0yavXd1FS5tO9m2iiYYcS6U2j+Jfo8bKOVO+AP2GZzWXAZ3e+y18iIH9MKGJOqLhDyy+GEXsvFJItJDTnZaGfEqAPttOGY87da8/3Lpyp/6a4pEKpYtPbH/NFKZJdEI8tLbh8mYWfkemVRjCrIvBjFbulTdyuhVIVoWNfs3v5jzW5dcJhjIrFlRYIQXbOk4qL07FClT7/54q1RCgRBnnQA9WQ4W0o0m6eHDhK1FwBe2fJlO7IfL77S151Les1hyv4o/Ee4z31UdfLCufAN/NlzNpVvXGBUxcVN7zUbxA/H+hAnLT6mde8vqDWn5FwLDpFjOL5c8IA72CDJkrgqTrQviEKKjkl6YhdgAVTeTHXtMWywVko+cN/6fhYR/BiWLeL4j3+8bfPNKTOx9MaGMkq2dDS0aLGdXUGbOMBERoKaxcN5tMc+u4Yyo8kkrlgi4g3QpPWXp3ugKneQI5pzIb/2WwxrM7PdJfRa5xZy2fTbiYt5hTUyqiro3rzkMc9VP1rC2+F/AuQhYhahY1dbNCd5Uk8RYRASOdGfPHGp5JySHDTi+A0CwBYAStHOe/ybWIq4cXzCTRO2V44SICyL1hM1U8nqZoPNTR6ojUPNR8rVEL30cnGS20zuU/858McoUH19lIW/urNxcTaQ5Jnasl/WKc/LYZ+NQyem9dVTEU927yA9BVvaDTpWiztOdUkU9lG9MiwD7lWgd+M2Z8wciUTFKIeEmaxeM67L/cXd4S6FLBNe6hKq/yk/NPo8iPLdNjlwFkESoycaofdLAT5o3LEFaYZYDsCPRDBkCKapg2DnV/hZo86Dv9fxTB6ZYOX1wvTwszIR2W4ktsp+IXN0o7MYVBwHdz8bHhGwGLg012uOmCmsyOMx65IGN35n4mfHe1jHukhG9FWGF9FZOZPmwXYKRJF8az4okKIes4JhfXVHpWuZ7JpLks5RwdSuc0UVKgpP0ZIqnAwvGRu6r211tZigHGZMY+k/MXzG8d08HA4MZZ5fcz3Pnl/+uRojlJ4STuFaK+/P/vGM5QDM+nBvC2egeE0H61Vt8z8UPtFji3M8zayxAeWz+tEkRPPTmtthTIXJsMxax0SZ41QTavcISQ5A9wo0h9h07gMsntOTigse5YHmvbBPryyXHx+ILT1cHcJKk9gLKEBjyqqw+PnEQO2myDanDLaToqjwZsFlgeUhqLjWlsnFwoAkZZt7tnIWX5fMgVmI0wY6ixLXL+pK+PPvoBBTdMCn/13xM4Vbv54RBiSrrh3U9zh2g862DPpKwoDeohNR1vEBfnWlD5CqXzEna3JCUSRl57jPoNKoOjqhC4qnhrgcd4OH0WhwP7Aee+3GwG7eb2o4UlLTg49rxBs+I8BalamXlqQZRQYOfGEETIlw45XYiS5SJ4qpWnPG9SXgyjow54vcvaQZjw3ONk4pBJjyj8UVoB+1i+ENSWn8ttrMmeJgf0HYIwyYWw3Jn3icRhiJ6XobLS68Y0eg2X1CpbJCW0j7GVsFsyJ6bbLHc4IgsKbt5cuefK6Lvb0WRtiUXfGk52REr/VaJl45cZ/BVIcQ9XVwH344j3Tst1HitSSIWA8ftAyQlyjp6bxv9bL9Ty2v1VWnZC09nshzE7ymIjxgKzVrsNvMpHRuzalXGYqFZ6GE1DxwfTPrB1VToSBfngtFPu1Sdune7UsQJmyNYUt0KwI/J0uwX7gTxy30IfyRjWf0H30eKXPY9ZdMRfuVCBGYkAUqalrXjxjvip6GGeDHF5NllTMhlf/YDV6KD0rhcsDAuKH4LXQB8iuNwbyFGVOOyQY4DMn2KuoiM0dPQSTlMS1VPqExaTypCVUGYAhqDlUNkoodS+ysRWFavQNdZTQEx+s3PXW+zPUBlXPXHzxh7wnuzKbzxiAsR643svkV7qagZAA/QxXrEW4v+onACZBJS4v+N9EgUek99/rdmxwePf/4dz2agMExFjwMFmi9DNu4xfkZdMrU52m9QmlrDdRNYmv7kzNErzHxJ+BbZc0HgmM+uuZ9szP9IglONc7d2HjmvJOzyaifRIB5BUEKzbK0fYPGktTbnM25aEqgiijE/2jjO84qrL5jj5+o86GjrFAWGq36/bLzNfd93DzrNH8qKiEb9NuVcnOANBrvAoTrs8aAUWTORZzMBTH6Am+nvanQvu0AVLQPwL3EY3x9bApMqzosZtj1pYUTl2lxdWp/Ul7lH32++xtbkaNQ7iqZLWsHGv65bhYQfe+uEdZHMSaDMVFhEdmz1iHXr4VWeLmseJnb+IDMPh212Zhul6yVw8TKTphNcLJAfp/1IslgcfO5JdvUvom8h3+FL/g9eAbeKgIoPxxG1ChsHlnmfbulh4NR/58ZH88ohnYIFvbWtAUTGx1oXzx+ymfdBOW1zpQfYb1VwRCTYqvO51Fy1F7AcZ5Ow+d4OABbbhmOrMANeYOiVZUvDF00kmLqCymO4ffpzryGqcoteWmhOwZWRY3kBdHfRnAuMHVMgh3+MoVMh/YNqCN2T3QXmvQjN81fkBOYVGD6bdbBvLJA/KAEhSnrYHfu9sSYIgqwckiJdOlZTO+hdchaQQKQTWSsH/JNIecz1v2ev6kCXUClj49I1D3tlbM+uSf+KZK]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SSHé¡¹ç›®åˆä½“éªŒ]]></title>
    <url>%2F2017%2F04%2F24%2F%E7%BC%96%E7%A8%8B%2FSSH%E9%A1%B9%E7%9B%AE%E5%88%9D%E4%BD%93%E9%AA%8C%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå†æ—¶å››å¤©ï¼Œç»ˆäºåœ¨è§†é¢‘çš„å¸®åŠ©ä¸‹å®Œæˆäº†åŸºäºSSHï¼ˆstruts2+hibernate3+spring4ï¼‰çš„ä¸€ä¸ªç½‘ç«™å•†åŸé¡¹ç›®ï¼Œä¹Ÿæ˜¯è‡ªå·±ç¬¬ä¸€æ¬¡é‡‡ç”¨ideaå¼€å‘é¡¹ç›®ç®€å•ï¼Œè°ˆè°ˆæ”¶è·å’Œæ„Ÿæƒ³ã€‚ ä»£ç æµç¨‹ å¯¼åŒ…ä¸»è¦çš„æ–‡ä»¶ï¼šå¯¼ä¸‰å¤§æ¡†æ¶çš„åŒ…è¿™é‡Œçš„åŒ…æˆ‘ä¹Ÿä¸è´´å›¾äº†ï¼Œéƒ½æ˜¯æœ€åŸºæœ¬çš„jaråŒ… æ¡†æ¶é…ç½®è¿™é‡Œæˆ‘æƒ³è¯´çš„æ˜¯ä¸‰ä¸ªæ–‡ä»¶ï¼š web.xmlï¼šé…ç½®strutsæ ¸å¿ƒè¿‡æ»¤å™¨å’Œé…ç½®Springçš„æ ¸å¿ƒç›‘å¬å™¨ struts.xmlï¼šé…ç½®å„ç§action applicationContext.xmlï¼šä½œä¸ºå¤§ç®¡å®¶äº‹æƒ…ä¹Ÿå°±æ¯”è¾ƒå¤šäº†ï¼Œæœ‰é…ç½®æ•°æ®åº“C3P0è¿æ¥æ± ï¼Œé…ç½®Hibernateå¼•å…¥æ•°æ®æºï¼Œäº‹åŠ¡ç®¡ç†ï¼Œç®¡ç†actionï¼Œserviceï¼Œdao æŒ‰å±‚ç ä»£ç  åˆ†å±‚æ¶æ„ webå±‚ä¸»è¦ä½¿ç”¨actionè¿›è¡Œæ§åˆ¶ï¼Œè¿™é‡Œä½¿ç”¨äº†åŠ¨æ€åŒ¹é…ï¼Œå¦‚userAction_*.actionå…¶ä¸­è¦ç‚¹ï¼š å€¼æ ˆï¼šå¯¹äºå•ä¸ªä¸šåŠ¡é€»è¾‘æ¥è¯´å­˜å–å€¼å®åœ¨æ˜¯å¤ªæ–¹ä¾¿äº†ã€‚ æ¨¡å‹é©±åŠ¨ï¼šå¯¹äºæ¨¡å—çš„å¯¹è±¡ä½¿ç”¨æ¨¡å‹å­˜å€¼ä¹Ÿå¾ˆæ–¹ä¾¿ æ‹¦æˆªå™¨ï¼šå¯¹äºåå°èŒƒå›´ä¸€å®šè¦å¯¹è®¿é—®è¿›è¡Œæ§åˆ¶ï¼Œè‹¥æœªç™»å½•ï¼Œè¯·å…ˆç™»å½• ognlè¡¨è¾¾å¼ï¼šå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œé™¤æ¨¡å‹é©±åŠ¨ä»¥åŠå€¼æ ˆå†…å–å€¼ä¹‹å¤–éƒ½è¦åŠ # serviceå±‚æœ¬æ¬¡é¡¹ç›®å¹¶æœªå¤šå°‘ä½“ç°å‡ºæ¥ï¼Œæˆ‘ä»¬åªè¦æ³¨æ„æ·»åŠ springäº‹åŠ¡æ³¨è§£ daoå±‚æ­¤æ¬¡ä½¿ç”¨çš„hibernateï¼Œè¦ç‚¹å¦‚ä¸‹ å®ä½“æ˜ å°„æ–‡ä»¶ï¼šå¯¹äºä¸»å¤–é”®ä¸€å®šè¦è®¾ç½®æ­£ç¡®ï¼Œæ‡’åŠ è½½é—®é¢˜ï¼Œçº§è”åˆ é™¤é—®é¢˜ hqlè¯­å¥ï¼šjoinçš„ç”¨æ³•ï¼Œé¢å‘å¯¹è±¡çš„è¯­å¥ç¼–å†™ é¡¹ç›®æ¨¡å—è¿™é‡Œåªæ˜¯ç®€å•è¯´è¯´ä½œä¸ºä¸€ä¸ªå•†åœºåº”è¯¥å…·æœ‰çš„æ¨¡å— å‰å°é¦–é¡µï¼›å‰å°ç”¨æˆ· ï¼›ä¸€çº§ç›®å½•ï¼› äºŒçº§ç›®å½•ï¼› å•†å“ï¼› è´­ç‰©è½¦ï¼› è®¢å• åå°åå°ç”¨æˆ·ï¼›ä¸€çº§ç›®å½•ï¼›äºŒçº§ç›®å½•ï¼›å•†å“ï¼›è®¢å• æŸ¥bugæ–¹æ³•å³ä½¿æ˜¯æŒ‰ç€è§†é¢‘æ¥çš„ï¼Œä½†æ˜¯ä¹Ÿè¿˜æ˜¯ä¼šå‡ºé”™ï¼Œæœ‰çš„æ—¶å€™è¿˜æŸ¥äº†ä¸€ä¸ªå¤šå°æ—¶ï¼Œbugï¼šç å†œçš„ä¸€ç”Ÿä¹‹æ•Œå‘€ï¼å›åˆ°æ­£é¢˜ï¼šé¦–å…ˆçœ‹æ§åˆ¶å°é”™è¯¯ï¼Œåˆ†æé”™è¯¯ç±»å‹ å‰å°ä¼ æ•°æ®é”™è¯¯å¯ä»¥å°†è¡¨å•çš„å‘é€æ–¹å¼æ”¹ä¸ºgetï¼Œè¿™ä¸ªå°±å¯ä»¥ä»uriä¸­çœ‹å‡ºé”™è¯¯äº†ï¼Œè‡ªå·±å¥½å‡ æ¬¡å…¥å‘ï¼Œå°±æ˜¯åœ¨å‚æ•°å¡«å†™çš„åœ°æ–¹å¤šäº†ä¸€ä¸ªç©ºæ ¼ï¼Œæ¬²å“­æ— æ³ªã€‚ ä¸šåŠ¡é€»è¾‘ä»£ç é”™è¯¯å…¶å®æœ€ç®€å•ä¹Ÿæœ€çƒ¦ï¼Œå°±æ˜¯åˆ©ç”¨debugã€‚æŒ‰é€»è¾‘é¡ºåºè¿›è¡ŒæŸ¥é”™ã€‚ æ•°æ®åº“æŸ¥è¯¢å‡ºé”™å¯ä»¥å……åˆ†åˆ©ç”¨æ§åˆ¶å°è¾“å‡ºçš„sqlè¯­å¥è¿›è¡Œæ’é”™ï¼Œå°†sqlè¯­å¥æ”¾åˆ°sqlæ¡Œé¢ç¨‹åºä¸­æŸ¥è¯¢ï¼Œæ˜¯å¦ä¸è‡ªå·±æƒ³è¦çš„ç»“æœä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œå°±å¾ˆæœ‰å¯èƒ½æ˜¯è‡ªå·±çš„hqlè¯­å¥å†™é”™ï¼Œæˆ–è€…æ˜ å°„æ–‡ä»¶å‡ºé”™äº†ã€‚ æ„Ÿæƒ³å…³äºè¿™ä¸ªé¡¹ç›®æ¶æ„éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä¸šåŠ¡é€»è¾‘ä¹Ÿéƒ½æ˜¯CRUDä¹Ÿç®—ç®€å•ï¼Œå¯èƒ½è¿˜æœ‰æœ€é‡è¦çš„é«˜å¹¶å‘é—®é¢˜æ²¡æœ‰è€ƒè™‘ï¼Œä½†æ˜¯æ•´ä¸ªé¡¹ç›®åšä¸‹æ¥ï¼Œè‡ªå·±ä¹Ÿç®—ç†è§£äº†æ•´ä¸ªé¡¹ç›®ç³»ç»Ÿï¼Œä½†æ˜¯è‡ªå·±ç»å¯¹ä¸èƒ½ä»¥CRUDä¸ºç»ˆç‚¹ï¼Œç»§ç»­å‘å‰åŠ æ²¹ï¼ï¼ï¼ï¼]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ssh</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iiså®ç°æ‰‹æœºç«¯è®¿é—®ç”µè„‘æœ¬åœ°æœåŠ¡å™¨]]></title>
    <url>%2F2017%2F04%2F24%2F%E5%B7%A5%E5%85%B7%2Fiis%E5%AE%9E%E7%8E%B0%E6%89%8B%E6%9C%BA%E7%AB%AF%E8%AE%BF%E9%97%AE%E7%94%B5%E8%84%91%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%2F</url>
    <content type="text"><![CDATA[å¼•ï¼šå¯¹äºå¾ˆå¤šæ²¡æœ‰æœåŠ¡å™¨çš„äººæ¥è¯´,å®ç°æ‰‹æœºç«¯è®¿é—®è‡ªå·±å†™çš„ç½‘é¡µè¿˜æ˜¯æœ‰å›°éš¾çš„ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥å¯ä»¥åˆ©ç”¨githubpageæ¥å®ç°æŒ‚è½½é¡µé¢ï¼Œä½†æ˜¯è°ƒè¯•èµ·æ¥è¿˜æ˜¯ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥iiså°±æˆä¸ºäº†ä¸€ç§ç®€å•çš„æ–¹å¼ã€‚ iisç®€ä»‹iisï¼ˆInternet Information Servicesï¼‰æ˜¯ç”±å¾®è½¯å…¬å¸æä¾›çš„åŸºäºè¿è¡ŒMicrosoft Windowsçš„äº’è”ç½‘åŸºæœ¬æœåŠ¡,å…¶ä¸­åŒ…æ‹¬WebæœåŠ¡å™¨ã€FTPæœåŠ¡å™¨ã€NNTPæœåŠ¡å™¨å’ŒSMTPæœåŠ¡å™¨ï¼Œåˆ†åˆ«ç”¨äºç½‘é¡µæµè§ˆã€æ–‡ä»¶ä¼ è¾“ã€æ–°é—»æœåŠ¡å’Œé‚®ä»¶å‘é€ç­‰æ–¹é¢ï¼Œå®ƒä½¿å¾—åœ¨ç½‘ç»œï¼ˆåŒ…æ‹¬äº’è”ç½‘å’Œå±€åŸŸç½‘ï¼‰ä¸Šå‘å¸ƒä¿¡æ¯æˆäº†ä¸€ä»¶å¾ˆå®¹æ˜“çš„äº‹ã€‚ iiså®‰è£…è¿™é‡Œæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œç½‘ä¸Šä¸€æœï¼Œå®‰è£…æ•™ç¨‹ä¸€å¤§æŠŠï¼Œè¿™é‡Œæ¨èä¸€ä¸ªé“¾æ¥å®‰è£…iis æœ‰æ— çº¿çš„æ—¶å€™ä½¿ç”¨å¤§éƒ¨åˆ†äººï¼Œå¤§éƒ¨åˆ†æ—¶é—´ï¼Œå¤§éƒ¨åˆ†åœ°æ–¹ï¼Œç›¸ä¿¡å¤§å®¶éƒ½ä¼šèº«å¤„åœ¨æ— çº¿ä¹‹ä¸‹ï¼Œæ‰€ä»¥åªè¦æŒ‰ç…§ä¸Šé¢çš„é“¾æ¥ä½¿ç”¨å°±å¯ä»¥äº†ã€‚ æ²¡æ— çº¿çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªæ—¶å€™å°±è¦å€ŸåŠ©æµé‡ä¸çƒ­ç‚¹äº† æ‰“å¼€æ‰‹æœºçƒ­ç‚¹ æŸ¥çœ‹ç”µè„‘ipåœ°å€ä¸€èˆ¬è¿™ä¸ªæ—¶å€™ipåœ°å€å·²ç»å˜äº†ï¼Œæ‰€æœ‰ä¹‹å‰æŒ‰ç…§æœ‰æ— çº¿çš„æ—¶å€™ç”µè„‘çš„ipè®¾ç½®è®¿é—®åœ°å€å°±æœ‰é—®é¢˜äº†ï¼Œæ‰€ä»¥è¦åˆ©ç”¨æ–°çš„ipåœ°å€è®¾ç½®è®¿é—®åœ°å€ ç”¨æ‰‹æœºè®¿é—®æ–°çš„ipåœ°å€ä¸€ä¸‹å­å°±çˆ½æ­ªæ­ªäº† æ€»ç»“ iiså¯¹äºwindowsç”¨æˆ·æ¥è¯´çœŸæ˜¯å‡ºå®¶æ—…è¡Œï¼Œè°ƒè¯•ä»£ç å¿…å¤‡ä¹‹è‰¯å“ã€‚ å½“ä¸èƒ½è®¿é—®çš„æ—¶å€™ä¸€å®šè¦éšæ—¶å…³æ³¨ç”µè„‘çš„ipåœ°å€æ˜¯å¦å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œåšåˆ°éšæ—¶æ›´æ”¹]]></content>
      <categories>
        <category>ç¼–ç¨‹</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
</search>